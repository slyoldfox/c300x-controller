// =======================================================================================================================
// DO NOT EDIT, this is a generated file, generate it with $ npm run build:homekitbundle:dev or npm run build:homekitbundle:prod
// =======================================================================================================================
(()=>{var e={141:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CiaoService=t.InternalServiceEvent=t.ServiceEvent=t.ServiceState=t.ServiceType=void 0;const i=r(1635),n=i.__importDefault(r(2613)),a=i.__importDefault(r(5753)),o=r(4434),s=i.__importDefault(r(9278)),c=r(1360),u=r(4495),l=r(6343),h=r(482),d=r(8225),p=r(1576),f=r(5231),v=r(8318),g=r(8937),m=r(7585),y=i.__importStar(r(9152)),C=r(9152),S=(0,a.default)("ciao:CiaoService"),E=/^(.*) \((\d+)\)$/,_=/^(.*)-\((\d+)\)(\.\w{2,}.)$/;var T,A,I,D;!function(e){e.AIRDROP="airdrop",e.AIRPLAY="airplay",e.AIRPORT="airport",e.COMPANION_LINK="companion-link",e.DACP="dacp",e.HAP="hap",e.HOMEKIT="homekit",e.HTTP="http",e.HTTP_ALT="http_alt",e.IPP="ipp",e.IPPS="ipps",e.RAOP="raop",e.scanner="scanner",e.TOUCH_ABLE="touch-able",e.DNS_SD="dns-sd",e.PRINTER="printer"}(T||(t.ServiceType=T={})),function(e){e.UNANNOUNCED="unannounced",e.PROBING="probing",e.PROBED="probed",e.ANNOUNCING="announcing",e.ANNOUNCED="announced"}(A||(t.ServiceState=A={})),function(e){e.NAME_CHANGED="name-change",e.HOSTNAME_CHANGED="hostname-change"}(I||(t.ServiceEvent=I={})),function(e){e.PUBLISH="publish",e.UNPUBLISH="unpublish",e.REPUBLISH="republish",e.RECORD_UPDATE="records-update",e.RECORD_UPDATE_ON_INTERFACE="records-update-interface"}(D||(t.InternalServiceEvent=D={}));class w extends o.EventEmitter{constructor(e,t){if(super(),this.serviceState="unannounced",this.destroyed=!1,(0,n.default)(e,"networkManager is required"),(0,n.default)(t,"parameters options is required"),(0,n.default)(t.name,"service options parameter 'name' is required"),(0,n.default)(t.type,"service options parameter 'type' is required"),(0,n.default)(t.type.length<=15,"service options parameter 'type' must not be longer than 15 characters"),this.networkManager=e,this.name=t.name,this.type=t.type,this.subTypes=t.subtypes,this.protocol=t.protocol||"tcp",this.serviceDomain=t.domain||"local",this.fqdn=this.formatFQDN(),this.loweredFqdn=(0,m.dnsLowerCase)(this.fqdn),this.typePTR=y.stringify({type:this.type,protocol:this.protocol,domain:this.serviceDomain}),this.loweredTypePTR=(0,m.dnsLowerCase)(this.typePTR),this.subTypes&&(this.subTypePTRs=this.subTypes.map((e=>y.stringify({subtype:e,type:this.type,protocol:this.protocol,domain:this.serviceDomain}))).map(m.dnsLowerCase)),this.hostname=y.formatHostname(t.hostname||this.name,this.serviceDomain).replace(/ /g,"-"),this.loweredHostname=(0,m.dnsLowerCase)(this.hostname),this.port=t.port,t.restrictedAddresses){(0,n.default)(t.restrictedAddresses.length,"The service property 'restrictedAddresses' cannot be an empty array!"),this.restrictedAddresses=new Map;for(const e of t.restrictedAddresses)if(s.default.isIP(e)){if("0.0.0.0"===e||"::"===e)throw new Error(`[${this.fqdn}] Unspecified ip address (${e}) cannot be used to restrict on to!`);const t=g.NetworkManager.resolveInterface(e);if(!t)throw new Error(`[${this.fqdn}] Could not restrict service to address ${e} as we could not resolve it to an interface name!`);const r=this.restrictedAddresses.get(t);r?r.length&&!r.includes(e)&&r.push(e):this.restrictedAddresses.set(t,[e])}else this.restrictedAddresses.set(e,[])}this.disableIpv6=t.disabledIpv6,this.txt=t.txt?w.txtBuffersFromRecord(t.txt):[],this.incrementName(!0)}advertise(){return(0,n.default)(!this.destroyed,"Cannot publish destroyed service!"),(0,n.default)(this.port,"Service port must be defined before advertising the service on the network!"),0===this.listeners("name-change").length&&S("[%s] WARN: No listeners found for a potential name change on the 'name-change' event!",this.name),new Promise(((e,t)=>{this.emit("publish",(r=>r?t(r):e()))}))}end(){return(0,n.default)(!this.destroyed,"Cannot end destroyed service!"),"unannounced"===this.serviceState?Promise.resolve():new Promise(((e,t)=>{this.emit("unpublish",(r=>r?t(r):e()))}))}async destroy(){await this.end(),this.destroyed=!0,this.removeAllListeners()}getFQDN(){return this.fqdn}getTypePTR(){return this.typePTR}getLowerCasedSubtypePTRs(){return this.subTypePTRs}getHostname(){return this.hostname}getPort(){return this.port||-1}getTXT(){return this.txt}getLowerCasedFQDN(){return this.loweredFqdn}getLowerCasedTypePTR(){return this.loweredTypePTR}getLowerCasedHostname(){return this.loweredHostname}updateTxt(e,t=!1){if((0,n.default)(!this.destroyed,"Cannot update destroyed service!"),(0,n.default)(e,"txt cannot be undefined"),this.txt=w.txtBuffersFromRecord(e),S("[%s] Updating txt record%s...",this.name,t?" silently":""),"announcing"===this.serviceState){if(this.rebuildServiceRecords(),t)return;this.currentAnnouncer.hasSentLastAnnouncement()&&this.currentAnnouncer.awaitAnnouncement().then((()=>{this.queueTxtUpdate()}))}else if("announced"===this.serviceState){if(this.rebuildServiceRecords(),t)return;this.queueTxtUpdate()}}queueTxtUpdate(){this.txtTimer||(this.txtTimer=setTimeout((()=>{this.txtTimer=void 0,"announced"===this.serviceState&&this.emit("records-update",{answers:[this.txtRecord()],additionals:[this.serviceNSECRecord()]})}),50))}updatePort(e){(0,n.default)("unannounced"===this.serviceState,"Port number cannot be changed when service is already advertised!"),this.port=e}updateName(e){return"unannounced"===this.serviceState?(this.name=e,this.fqdn=this.formatFQDN(),this.loweredFqdn=(0,m.dnsLowerCase)(this.fqdn),Promise.resolve()):this.end().then((()=>(this.name=e,this.fqdn=this.formatFQDN(),this.loweredFqdn=(0,m.dnsLowerCase)(this.fqdn),this.advertise())))}static txtBuffersFromRecord(e){const t=[];return Object.entries(e).forEach((([e,r])=>{const i=e+"="+r;t.push(Buffer.from(i))})),t}handleNetworkInterfaceUpdate(e){(0,n.default)(!this.destroyed,"Cannot update network of destroyed service!"),"announced"===this.serviceState?(this.rebuildServiceRecords(),(e.added||e.changes)&&this.emit("republish",(e=>{e&&(console.log("FATAL Error occurred trying to re-announce service "+this.fqdn+"! We can't recover from this!"),console.log(e.stack),process.exit(1))}))):"announcing"===this.serviceState&&(this.rebuildServiceRecords(),this.currentAnnouncer.hasSentLastAnnouncement()&&this.currentAnnouncer.awaitAnnouncement().then((()=>{this.handleNetworkInterfaceUpdate(e)})))}incrementName(e){if("unannounced"!==this.serviceState)throw new Error("Service name can only be incremented when in state UNANNOUNCED!");const t=this.name,r=this.hostname;let i,a,o,s,c;const u=this.name.match(E);u?(i=u[1],a=parseInt(u[2]),(0,n.default)(a,`Failed to extract name number from ${this.name}. Resulted in ${a}`)):(i=this.name,a=1);const l=this.hostname.match(_);if(l)o=l[1],s=l[3],c=parseInt(l[2]),(0,n.default)(c,`Failed to extract hostname number from ${this.hostname}. Resulted in ${c}`);else{const e=this.hostname.substring(0,this.hostname.length-1).lastIndexOf(".");o=this.hostname.slice(0,e),s=this.hostname.slice(e),c=1}e||(a++,c++);const h=Math.max(a,c);this.name=1===h?i:`${i} (${h})`,this.hostname=1===h?`${o}${s}`:`${o}-(${h})${s}`,this.loweredHostname=(0,m.dnsLowerCase)(this.hostname),this.fqdn=this.formatFQDN(),this.loweredFqdn=(0,m.dnsLowerCase)(this.fqdn),this.name===t&&this.hostname===r||S("[%s] Service changed name '%s' -> '%s', '%s' -> '%s'",this.name,t,this.name,r,this.hostname),e||this.rebuildServiceRecords()}informAboutNameUpdates(){const e=this.emit("name-change",this.name),t=this.emit("hostname-change",y.removeTLD(this.hostname));e||t||console.warn(`CIAO: [${this.name}] Service changed name but nobody was listening on the 'name-change' event!`)}formatFQDN(){if("unannounced"!==this.serviceState)throw new Error("Name can't be changed after service was already announced!");const e=y.stringify({name:this.name,type:this.type,protocol:this.protocol,domain:this.serviceDomain});return(0,n.default)(e.length<=255,"A fully qualified domain name cannot be longer than 255 characters"),e}rebuildServiceRecords(){(0,n.default)(this.port,"port must be set before building records"),S("[%s] Rebuilding service records...",this.name);const e={},t={},r={},i={},a={};let o;for(const[n,o]of this.networkManager.getInterfaceMap()){if(!this.advertisesOnInterface(n,!0))continue;let s=this.restrictedAddresses?this.restrictedAddresses.get(n):void 0;s&&0===s.length&&(s=void 0),!o.ipv4||s&&!s.includes(o.ipv4)||(e[n]=new u.ARecord(this.hostname,o.ipv4,!0),a[o.ipv4]=new h.PTRRecord((0,C.formatReverseAddressPTRName)(o.ipv4),this.hostname)),!o.ipv6||this.disableIpv6||s&&!s.includes(o.ipv6)||(t[n]=new c.AAAARecord(this.hostname,o.ipv6,!0),a[o.ipv6]=new h.PTRRecord((0,C.formatReverseAddressPTRName)(o.ipv6),this.hostname)),!o.globallyRoutableIpv6||this.disableIpv6||s&&!s.includes(o.globallyRoutableIpv6)||(r[n]=new c.AAAARecord(this.hostname,o.globallyRoutableIpv6,!0),a[o.globallyRoutableIpv6]=new h.PTRRecord((0,C.formatReverseAddressPTRName)(o.globallyRoutableIpv6),this.hostname)),!o.uniqueLocalIpv6||this.disableIpv6||s&&!s.includes(o.uniqueLocalIpv6)||(i[n]=new c.AAAARecord(this.hostname,o.uniqueLocalIpv6,!0),a[o.uniqueLocalIpv6]=new h.PTRRecord((0,C.formatReverseAddressPTRName)(o.uniqueLocalIpv6),this.hostname))}if(this.subTypePTRs){o=[];for(const e of this.subTypePTRs)o.push(new h.PTRRecord(e,this.fqdn))}this.serviceRecords={ptr:new h.PTRRecord(this.typePTR,this.fqdn),subtypePTRs:o,metaQueryPtr:new h.PTRRecord(v.Responder.SERVICE_TYPE_ENUMERATION_NAME,this.typePTR),srv:new d.SRVRecord(this.fqdn,this.hostname,this.port,!0),txt:new p.TXTRecord(this.fqdn,this.txt,!0),serviceNSEC:new l.NSECRecord(this.fqdn,this.fqdn,[16,33],4500,!0),a:e,aaaa:t,aaaaR:r,aaaaULA:i,reverseAddressPTRs:a,addressNSEC:new l.NSECRecord(this.hostname,this.hostname,[1,28],120,!0)}}advertisesOnInterface(e,t){var r,i,n,a;return!this.restrictedAddresses||this.restrictedAddresses.has(e)&&(t||!!(null===(r=this.serviceRecords)||void 0===r?void 0:r.a[e])||!!(null===(i=this.serviceRecords)||void 0===i?void 0:i.aaaa[e])||!!(null===(n=this.serviceRecords)||void 0===n?void 0:n.aaaaR[e])||!!(null===(a=this.serviceRecords)||void 0===a?void 0:a.aaaaULA[e]))}ptrRecord(){return this.serviceRecords.ptr.clone()}subtypePtrRecords(){return this.serviceRecords.subtypePTRs?f.ResourceRecord.clone(this.serviceRecords.subtypePTRs):[]}metaQueryPtrRecord(){return this.serviceRecords.metaQueryPtr.clone()}srvRecord(){return this.serviceRecords.srv.clone()}txtRecord(){return this.serviceRecords.txt.clone()}aRecord(e){const t=this.serviceRecords.a[e];return t?t.clone():void 0}aaaaRecord(e){const t=this.serviceRecords.aaaa[e];return t?t.clone():void 0}aaaaRoutableRecord(e){const t=this.serviceRecords.aaaaR[e];return t?t.clone():void 0}aaaaUniqueLocalRecord(e){const t=this.serviceRecords.aaaaULA[e];return t?t.clone():void 0}allAddressRecords(){const e=[];return Object.values(this.serviceRecords.a).forEach((t=>{e.push(t.clone())})),Object.values(this.serviceRecords.aaaa).forEach((t=>{e.push(t.clone())})),Object.values(this.serviceRecords.aaaaR).forEach((t=>{e.push(t.clone())})),Object.values(this.serviceRecords.aaaaULA).forEach((t=>{e.push(t.clone())})),e}addressNSECRecord(){return this.serviceRecords.addressNSEC.clone()}serviceNSECRecord(e=!1){const t=this.serviceRecords.serviceNSEC.clone();return e&&(t.ttl=120),t}hasAddress(e){return!!this.serviceRecords.reverseAddressPTRs[e]}}t.CiaoService=w},2361:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MDNSServer=t.SendResultFormatError=t.SendResultFailedRatio=void 0;const i=r(1635),n=i.__importDefault(r(2613)),a=i.__importDefault(r(5753)),o=i.__importDefault(r(7194)),s=r(4119),c=r(8937),u=r(9152),l=r(16),h=r(8390),d=(0,a.default)("ciao:MDNSServer");t.SendResultFailedRatio=function(e){if(0===e.length)return 0;let t=0;for(const r of e)"fulfilled"!==r.status&&t++;return t/e.length},t.SendResultFormatError=function(e,t,r=!1){let i=0;for(const t of e)"fulfilled"!==t.status&&i++;if(t||(t="Failed to send packets"),i<e.length?t+=` (${i}/${e.length}):`:t+=":",r){let r="=============================\n"+t;for(const t of e)"rejected"===t.status?r+="\n--------------------\nFailed to send packet on interface "+t.interface+": "+t.reason.stack:"timeout"===t.status&&(r+="\n--------------------\nSending packet on interface "+t.interface+" timed out!");return r+="\n=============================",r}{let r=t;for(const t of e)"rejected"===t.status?r+="\n- Failed to send packet on interface "+t.interface+": "+t.reason.message:"timeout"===t.status&&(r+="\n- Sending packet on interface "+t.interface+" timed out!");return r}};class p{constructor(e,t){this.sockets=new Map,this.sentPackets=new Map,this.suppressUnicastResponseFlag=!1,this.bound=!1,this.closed=!1,(0,n.default)(e,"handler cannot be undefined"),this.handler=e,this.networkManager=new c.NetworkManager({interface:t&&t.interface,excludeIpv6:t&&t.disableIpv6,excludeIpv6Only:!0}),this.networkManager.on("network-update",this.handleUpdatedNetworkInterfaces.bind(this))}getNetworkManager(){return this.networkManager}getBoundInterfaceNames(){return this.sockets.keys()}async bind(){if(this.closed)throw new Error("Cannot rebind closed server!");this.suppressUnicastResponseFlag=!0,await this.networkManager.waitForInit();const e=[];for(const[t,r]of this.networkManager.getInterfaceMap()){const i=this.createDgramSocket(t,!0),n=this.bindSocket(i,r,"IPv4").catch((e=>{console.log("Could not bind detected network interface: "+e.stack)}));e.push(n)}return Promise.all(e).then((()=>{this.bound=!0}))}shutdown(){this.networkManager.shutdown();for(const e of this.sockets.values())e.close();this.bound=!1,this.closed=!0,this.sockets.clear()}sendQueryBroadcast(e,t){const r=s.DNSPacket.createDNSQueryPackets(e);r.length>1&&d("Query broadcast is split into %d packets!",r.length);const i=[];for(const e of r)i.push(this.sendOnAllNetworksForService(e,t));return Promise.all(i).then((e=>{const t=[];for(const r of e)t.concat(r);return t}))}sendResponseBroadcast(e,t){const r=s.DNSPacket.createDNSResponsePacketsFromRRSet(e);return this.sendOnAllNetworksForService(r,t)}sendResponse(e,t,r){this.send(e,t).then((e=>{"rejected"===e.status?r?r(new Error("Encountered socket error on "+e.reason.name+": "+e.reason.message)):p.logSocketError(e.interface,e.reason):r&&r()}))}sendOnAllNetworksForService(e,t){this.checkUnicastResponseFlag(e);const r=e.encode();this.assertBeforeSend(r,"IPv4");const i=[];for(const[e,n]of this.sockets){if(!t.advertisesOnInterface(e))continue;const a=new Promise((t=>{n.send(r,p.MDNS_PORT,p.MULTICAST_IPV4,(i=>{if(i){if(!p.isSilencedSocketError(i))return void t({status:"rejected",interface:e,reason:i})}else this.maintainSentPacketsInterface(e,r);t({status:"fulfilled",interface:e})}))}));i.push(Promise.race([a,(0,h.PromiseTimeout)(p.SEND_TIMEOUT).then((()=>({status:"timeout",interface:e})))]))}return Promise.all(i)}send(e,t){this.checkUnicastResponseFlag(e);const r=e.encode();let i,n,a;this.assertBeforeSend(r,"IPv4"),"string"==typeof t?(i=p.MULTICAST_IPV4,n=p.MDNS_PORT,a=t):(i=t.address,n=t.port,a=t.interface);const o=this.sockets.get(a);if(!o)throw new l.InterfaceNotFoundError(`Could not find socket for given network interface '${a}'`);return new Promise((e=>{o.send(r,n,i,(t=>{if(t){if(!p.isSilencedSocketError(t))return void e({status:"rejected",interface:a,reason:t})}else this.maintainSentPacketsInterface(a,r);e({status:"fulfilled",interface:a})}))}))}checkUnicastResponseFlag(e){this.suppressUnicastResponseFlag&&0===e.type&&e.questions.forEach((e=>e.unicastResponseFlag=!1))}assertBeforeSend(e,t){if(this.closed)throw new l.ServerClosedError("Cannot send packets on a closed mdns server!");(0,n.default)(this.bound,"Cannot send packets before server is not bound!");const r="IPv4"===t?p.DEFAULT_IP4_HEADER:p.DEFAULT_IP6_HEADER;(0,n.default)(r+p.UDP_HEADER+e.length<=9e3,"DNS cannot exceed the size of 9000 bytes even with IP Fragmentation!")}maintainSentPacketsInterface(e,t){const r=t.toString("base64"),i=this.sentPackets.get(e);i?i.push(r):this.sentPackets.set(e,[r])}checkIfPacketWasPreviouslySentFromUs(e,t){const r=t.toString("base64"),i=this.sentPackets.get(e);if(i){const e=i.indexOf(r);if(-1!==e)return i.splice(e,1),!0}return!1}createDgramSocket(e,t=!1,r="udp4"){const i=o.default.createSocket({type:r,reuseAddr:t});return i.on("message",this.handleMessage.bind(this,e)),i.on("error",(t=>{p.isSilencedSocketError(t)||p.logSocketError(e,t)})),i}bindSocket(e,t,r){return new Promise(((i,a)=>{const o=e=>a(new Error("Failed to bind on interface "+t.name+": "+e.message));e.once("error",o),e.on("close",(()=>{this.sockets.delete(t.name)})),e.bind(p.MDNS_PORT,(()=>{e.setRecvBufferSize(819200),e.removeListener("error",o);const s="IPv4"===r?p.MULTICAST_IPV4:p.MULTICAST_IPV6,c="IPv4"===r?t.ipv4:t.ipv6;(0,n.default)(c,"Interface address for "+t.name+" cannot be undefined!");try{e.addMembership(s,c),e.setMulticastInterface(c),e.setMulticastTTL(p.MDNS_TTL),e.setTTL(p.MDNS_TTL),e.setMulticastLoopback(!0),this.sockets.set(t.name,e),i()}catch(r){try{e.close()}catch(e){d("Error while closing socket which failed to bind. Error may be expected: "+e.message)}a(new Error("Error binding socket on "+t.name+": "+r.stack))}}))}))}handleMessage(e,t,r){if(!this.bound)return;const i=this.networkManager.getInterface(e);if(!i)return void d("Received packet on non existing network interface: %s!",e);if(this.checkIfPacketWasPreviouslySentFromUs(i.name,t))return;const n=(0,u.getNetAddress)(r.address,i.ip4Netmask);if(i.loopback){if(n!==i.ipv4Netaddress)return}else if(this.networkManager.isLoopbackNetaddressV4(n))return void d("Received packet on interface '%s' which is not coming from the same subnet: %o",e,{address:r.address,netaddress:n,interface:i.ipv4});let a;try{a=s.DNSPacket.decode(r,t)}catch(i){return void d("Received a malformed packet from %o on interface %s. This might or might not be a problem. Here is the received packet for debugging purposes '%s'. Packet decoding failed with %s",r,e,t.toString("base64"),i.stack)}if(0!==a.opcode)return;if(0!==a.rcode)return;const o={address:r.address,port:r.port,interface:e};if(0===a.type)try{this.handler.handleQuery(a,o)}catch(t){console.warn("Error occurred handling incoming (on "+e+") dns query packet: "+t.stack)}else if(1===a.type){if(r.port!==p.MDNS_PORT)return;try{this.handler.handleResponse(a,o)}catch(t){console.warn("Error occurred handling incoming (on "+e+") dns response packet: "+t.stack)}}}static isSilencedSocketError(e){const t=e.message.includes("EADDRNOTAVAIL")||e.message.includes("EHOSTDOWN")||e.message.includes("ENETUNREACH")||e.message.includes("EHOSTUNREACH")||e.message.includes("EPERM")||e.message.includes("EINVAL");return t&&d("Silenced and ignored error (This is/should not be a problem, this message is only for informational purposes): "+e.message),t}static logSocketError(e,t){console.warn(`Encountered MDNS socket error on socket '${e}' : ${t.stack}`)}handleUpdatedNetworkInterfaces(e){if(e.removed)for(const t of e.removed){const e=this.sockets.get(t.name);this.sockets.delete(t.name),e&&e.close()}if(e.changes)for(const t of e.changes){const e=this.sockets.get(t.name);if((0,n.default)(e,"Couldn't find socket for network change!"),!t.outdatedIpv4&&t.updatedIpv4)n.default.fail("Reached illegal state! IPv4 address changed from undefined to defined!");else if(t.outdatedIpv4&&!t.updatedIpv4)n.default.fail("Reached illegal state! IPV4 address change from defined to undefined!");else if(t.outdatedIpv4&&t.updatedIpv4){try{e.dropMembership(p.MULTICAST_IPV4,t.outdatedIpv4)}catch(e){d("Thrown expected error when dropping outdated address membership: "+e.message)}try{e.addMembership(p.MULTICAST_IPV4,t.updatedIpv4)}catch(e){d("Thrown expected error when adding new address membership: "+e.message)}e.setMulticastInterface(t.updatedIpv4)}}if(e.added)for(const t of e.added){const e=this.createDgramSocket(t.name,!0);this.bindSocket(e,t,"IPv4").catch((e=>{console.log("Could not bind detected network interface: "+e.stack)}))}}}t.MDNSServer=p,p.DEFAULT_IP4_HEADER=20,p.DEFAULT_IP6_HEADER=40,p.UDP_HEADER=8,p.MDNS_PORT=5353,p.MDNS_TTL=255,p.MULTICAST_IPV4="224.0.0.251",p.MULTICAST_IPV6="FF02::FB",p.SEND_TIMEOUT=200},8937:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkManager=t.NetworkManagerEvent=t.WifiState=t.IPFamily=void 0;const i=r(1635),n=i.__importDefault(r(2613)),a=i.__importDefault(r(5317)),o=i.__importDefault(r(5753)),s=r(4434),c=i.__importDefault(r(2017)),u=i.__importDefault(r(9278)),l=i.__importDefault(r(857)),h=r(9152),d=(0,o.default)("ciao:NetworkManager");var p,f,v;!function(e){e.IPv4="IPv4",e.IPv6="IPv6"}(p||(t.IPFamily=p={})),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.NOT_A_WIFI_INTERFACE=1]="NOT_A_WIFI_INTERFACE",e[e.NOT_ASSOCIATED=2]="NOT_ASSOCIATED",e[e.CONNECTED=3]="CONNECTED"}(f||(t.WifiState=f={})),function(e){e.NETWORK_UPDATE="network-update"}(v||(t.NetworkManagerEvent=v={}));class g extends s.EventEmitter{constructor(e){if(super(),this.currentInterfaces=new Map,this.loopbackInterfaces=new Map,this.setMaxListeners(100),e&&e.interface){let t;if("string"==typeof e.interface)t=[e.interface];else{if(!Array.isArray(e.interface))throw new Error("Found invalid type for 'interfaces' NetworkManager option!");t=e.interface}const r=[];for(const i of t)if(u.default.isIP(i)){const t=g.resolveInterface(i);t?r.push(t):console.log("CIAO: Interface was specified as ip (%s), though couldn't find a matching interface for the given address.",e.interface)}else r.push(i);0===r.length?console.log("CIAO: 'restrictedInterfaces' array was empty. Going to fallback to bind on all available interfaces."):this.restrictedInterfaces=r}this.excludeIpv6=!(!e||!e.excludeIpv6),this.excludeIpv6Only=this.excludeIpv6||!(!e||!e.excludeIpv6Only),e&&d("Created NetworkManager with options: %s",JSON.stringify(e)),this.initPromise=new Promise((e=>{this.getCurrentNetworkInterfaces().then((t=>{this.currentInterfaces=t;const r=Object.keys(l.default.networkInterfaces()),i=[];for(const e of this.currentInterfaces.keys()){i.push(e);const t=r.indexOf(e);-1!==t&&r.splice(t,1)}d("Initial networks [%s] ignoring [%s]",i.join(", "),r.join(", ")),this.initPromise=void 0,e(),this.scheduleNextJob()}))}))}async waitForInit(){this.initPromise&&await this.initPromise}shutdown(){this.currentTimer&&(clearTimeout(this.currentTimer),this.currentTimer=void 0),this.removeAllListeners()}getInterfaceMap(){return this.initPromise&&n.default.fail("Not yet initialized!"),this.currentInterfaces}getInterface(e){return this.initPromise&&n.default.fail("Not yet initialized!"),this.currentInterfaces.get(e)}isLoopbackNetaddressV4(e){for(const t of this.loopbackInterfaces.values())if(t.ipv4Netaddress===e)return!0;return!1}scheduleNextJob(){this.currentTimer=setTimeout(this.checkForNewInterfaces.bind(this),g.POLLING_TIME),this.currentTimer.unref()}async checkForNewInterfaces(){const e=await this.getCurrentNetworkInterfaces();if(!this.currentTimer)return;let t,r,i;for(const[r,n]of e){const e=this.currentInterfaces.get(r);if(e){if(!(0,c.default)(e,n)){const t={name:r};e.ipv4!==n.ipv4&&(e.ipv4&&(t.outdatedIpv4=e.ipv4),n.ipv4&&(t.updatedIpv4=n.ipv4)),e.ipv6!==n.ipv6&&(e.ipv6&&(t.outdatedIpv6=e.ipv6),n.ipv6&&(t.updatedIpv6=n.ipv6)),e.globallyRoutableIpv6!==n.globallyRoutableIpv6&&(e.globallyRoutableIpv6&&(t.outdatedGloballyRoutableIpv6=e.globallyRoutableIpv6),n.globallyRoutableIpv6&&(t.updatedGloballyRoutableIpv6=n.globallyRoutableIpv6)),e.uniqueLocalIpv6!==n.uniqueLocalIpv6&&(e.uniqueLocalIpv6&&(t.outdatedUniqueLocalIpv6=e.uniqueLocalIpv6),n.uniqueLocalIpv6&&(t.updatedUniqueLocalIpv6=n.uniqueLocalIpv6)),this.currentInterfaces.set(r,n),n.loopback&&this.loopbackInterfaces.set(r,n),(null!=i?i:i=[]).push(t)}}else this.currentInterfaces.set(r,n),n.loopback&&this.currentInterfaces.set(r,n),(null!=t?t:t=[]).push(n)}if(this.currentInterfaces.size!==e.size)for(const[t,i]of this.currentInterfaces)e.has(t)||(this.currentInterfaces.delete(t),this.loopbackInterfaces.delete(t),(null!=r?r:r=[]).push(i));if(t||r||i){const e=t?t.map((e=>e.name)).join(","):"",n=r?r.map((e=>e.name)).join(","):"",a=i?i.map((e=>{let t=`{ name: ${e.name} `;return(e.outdatedIpv4||e.updatedIpv4)&&(t+=`, ${e.outdatedIpv4} -> ${e.updatedIpv4} `),(e.outdatedIpv6||e.updatedIpv6)&&(t+=`, ${e.outdatedIpv6} -> ${e.updatedIpv6} `),(e.outdatedGloballyRoutableIpv6||e.updatedGloballyRoutableIpv6)&&(t+=`, ${e.outdatedGloballyRoutableIpv6} -> ${e.updatedGloballyRoutableIpv6} `),(e.outdatedUniqueLocalIpv6||e.updatedUniqueLocalIpv6)&&(t+=`, ${e.outdatedUniqueLocalIpv6} -> ${e.updatedUniqueLocalIpv6} `),t+"}"})).join(","):"";d("Detected network changes: added: [%s], removed: [%s], changes: [%s]!",e,n,a),this.emit("network-update",{added:t,removed:r,changes:i})}this.scheduleNextJob()}async getCurrentNetworkInterfaces(){let e;if(this.restrictedInterfaces){e=this.restrictedInterfaces;const t=g.getLoopbackInterface();e.includes(t)||e.push(t)}else try{e=await g.getNetworkInterfaceNames()}catch(t){d(`WARNING Detecting network interfaces for platform '${l.default.platform()}' failed. Trying to assume network interfaces! (${t.message})`),e=g.assumeNetworkInterfaceNames()}const t=new Map,r=l.default.networkInterfaces();for(const i of e){const e=r[i];if(!e)continue;let a,o,s,c,u=!1;for(const t of e){if(t.internal&&(u=!0),"IPv4"!==t.family&&4!==t.family||a){if("IPv6"===t.family||6===t.family){if(this.excludeIpv6)continue;t.scopeid&&!o?o=t:0===t.scopeid&&(t.address.startsWith("fc")||t.address.startsWith("fd")?c||(c=t):s||(s=t))}}else a=t;if(a&&o&&s&&c)break}if((0,n.default)(a||o,"Could not find valid addresses for interface '"+i+"'"),this.excludeIpv6Only&&!a)continue;const l={name:i,loopback:u,mac:(null==a?void 0:a.mac)||(null==o?void 0:o.mac)};a&&(l.ipv4=a.address,l.ip4Netmask=a.netmask,l.ipv4Netaddress=(0,h.getNetAddress)(a.address,a.netmask)),o&&(l.ipv6=o.address,l.ipv6Netmask=o.netmask),s&&(l.globallyRoutableIpv6=s.address,l.globallyRoutableIpv6Netmask=s.netmask),c&&(l.uniqueLocalIpv6=c.address,l.uniqueLocalIpv6Netmask=c.netmask),t.set(i,l)}return t}static resolveInterface(e){let t;e:for(const[r,i]of Object.entries(l.default.networkInterfaces()))for(const n of null!=i?i:[])if(n.address===e){t=r;break e}return t}static async getNetworkInterfaceNames(){let e,t;switch(l.default.platform()){case"win32":e=g.getWindowsNetworkInterfaces();break;case"linux":e=g.getLinuxNetworkInterfaces();break;case"darwin":e=g.getDarwinNetworkInterfaces();break;case"freebsd":e=g.getFreeBSDNetworkInterfaces();break;case"openbsd":case"sunos":e=g.getOpenBSD_SUNOS_NetworkInterfaces();break;default:return d("Found unsupported platform %s",l.default.platform()),Promise.reject(new Error("unsupported platform!"))}try{t=await e}catch(e){if(e.message!==g.NOTHING_FOUND_MESSAGE)throw e;t=[]}const r=g.getLoopbackInterface();return t.includes(r)||t.unshift(r),e}static assumeNetworkInterfaceNames(){const e=[];return Object.entries(l.default.networkInterfaces()).forEach((([t,r])=>{for(const i of null!=r?r:[])if(i.internal||"IPv4"===i.family||4===i.family||("IPv6"===i.family||6===i.family)&&0===i.scopeid){e.includes(t)||e.push(t);break}})),e}static getLoopbackInterface(){for(const[e,t]of Object.entries(l.default.networkInterfaces()))for(const r of null!=t?t:[])if(r.internal)return e;throw new Error("Could not detect loopback interface!")}static getWindowsNetworkInterfaces(){return new Promise(((e,t)=>{a.default.exec('arp -a | findstr /C:"---"',((r,i)=>{if(r)return void t(r);const n=i.split(l.default.EOL),a=[];for(let e=0;e<n.length-1;e++){const t=n[e].trim().split(" ");t[t.length-3]?a.push(t[t.length-3]):d(`WINDOWS: Failed to read interface name from line ${e}: '${n[e]}'`)}const o=[];for(const e of a){const t=g.resolveInterface(e);t?o.includes(t)||o.push(t):d(`WINDOWS: Couldn't resolve to an interface name from '${e}'`)}o.length?e(o):t(new Error(g.NOTHING_FOUND_MESSAGE))}))}))}static getDarwinNetworkInterfaces(){return new Promise(((e,t)=>{a.default.exec("arp -a -n -l",(async(r,i)=>{if(r)return void t(r);const n=i.split(l.default.EOL),a=[];for(let e=1;e<n.length-1;e++){const t=n[e].trim().split(g.SPACE_PATTERN)[4];t?a.includes(t)||a.push(t):d(`DARWIN: Failed to read interface name from line ${e}: '${n[e]}'`)}const o=[];for(const e of a){const t=g.getDarwinWifiNetworkState(e).then((t=>{if(1!==t&&3!==t){const t=a.indexOf(e);-1!==t&&a.splice(t,1)}}));o.push(t)}await Promise.all(o),a.length?e(a):t(new Error(g.NOTHING_FOUND_MESSAGE))}))}))}static getLinuxNetworkInterfaces(){return new Promise(((e,t)=>{a.default.exec("ip neigh show",((r,i)=>{if(r)return r.message.includes("ip: not found")?(d("LINUX: ip was not found on the system. Falling back to assuming network interfaces!"),void e(g.assumeNetworkInterfaceNames())):void t(r);const n=i.split(l.default.EOL),a=[];for(let e=0;e<n.length-1;e++){const t=n[e].trim().split(g.SPACE_PATTERN);let r=0;for(;r<t.length&&"dev"!==t[r];r++);if(r>=t.length){d(`LINUX: Out of bounds when reading interface name from line ${e}: '${n[e]}'`);continue}const i=t[r+1];i?a.includes(i)||a.push(i):d(`LINUX: Failed to read interface name from line ${e}: '${n[e]}'`)}a.length?e(a):t(new Error(g.NOTHING_FOUND_MESSAGE))}))}))}static getFreeBSDNetworkInterfaces(){return new Promise(((e,t)=>{a.default.exec("arp -a -n",((r,i)=>{if(r)return void t(r);const n=i.split(l.default.EOL),a=[];for(let e=0;e<n.length-1;e++){const t=n[e].trim().split(g.SPACE_PATTERN)[5];t?a.includes(t)||a.push(t):d(`FreeBSD: Failed to read interface name from line ${e}: '${n[e]}'`)}a.length?e(a):t(new Error(g.NOTHING_FOUND_MESSAGE))}))}))}static getOpenBSD_SUNOS_NetworkInterfaces(){return new Promise(((e,t)=>{a.default.exec("arp -a -n",((r,i)=>{if(r)return void t(r);const n="sunos"===l.default.platform()?0:2,a=i.split(l.default.EOL),o=[];for(let e=1;e<a.length-1;e++){const t=a[e].trim().split(g.SPACE_PATTERN)[n];t?o.includes(t)||o.push(t):d(`${l.default.platform()}: Failed to read interface name from line ${e}: '${a[e]}'`)}o.length?e(o):t(new Error(g.NOTHING_FOUND_MESSAGE))}))}))}static getDarwinWifiNetworkState(e){return new Promise((t=>{a.default.exec("networksetup -getairportnetwork "+e,((r,i)=>{if(r)return i.includes("not a Wi-Fi interface")?void t(1):(console.log(`CIAO WARN: While checking networksetup for ${e} encountered an error (${r.message}) with output: ${i.replace(l.default.EOL,"; ")}`),void t(0));let n=0;i.includes("not a Wi-Fi interface")?n=1:i.includes("Current Wi-Fi Network")?n=3:i.includes("not associated")?n=2:i.includes("All Wi-Fi network services are disabled")?n=1:console.log(`CIAO WARN: While checking networksetup for ${e} encountered an unknown output: ${i.replace(l.default.EOL,"; ")}`),t(n)}))}))}}t.NetworkManager=g,g.SPACE_PATTERN=/\s+/g,g.NOTHING_FOUND_MESSAGE="no interfaces found",g.POLLING_TIME=15e3},4288:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Responder=void 0;const i=r(1635),n=i.__importDefault(r(2613)),a=i.__importDefault(r(5753)),o=r(141),s=r(4119),c=r(5682),u=r(1360),l=r(4495),h=r(482),d=r(8225),p=r(1576),f=r(2361),v=r(9983),g=r(2475),m=r(572),y=r(8126),C=r(341),S=r(16),E=r(8390),_=r(5762),T=(0,a.default)("ciao:Responder"),A=(e,t)=>e.estimatedTimeToBeSent-t.estimatedTimeToBeSent;var I;!function(e){e[e.NO_CONFLICT=0]="NO_CONFLICT",e[e.CONFLICTING_RDATA=1]="CONFLICTING_RDATA",e[e.CONFLICTING_TTL=2]="CONFLICTING_TTL"}(I||(I={}));class D{static getResponder(e){const t=e?JSON.stringify(e):"",r=this.INSTANCES.get(t);if(r)return r.refCount++,r;{const r=new D(e);return this.INSTANCES.set(t,r),r.optionsString=t,r}}constructor(e){this.refCount=1,this.optionsString="",this.bound=!1,this.announcedServices=new Map,this.servicePointer=new Map,this.truncatedQueries={},this.delayedMulticastResponses=[],this.server=new f.MDNSServer(this,e),this.promiseChain=this.start(),this.server.getNetworkManager().on("network-update",this.handleNetworkUpdate.bind(this)),this.ignoreUnicastResponseFlag=null==e?void 0:e.ignoreUnicastResponseFlag,(null==e?void 0:e.periodicBroadcasts)&&(this.broadcastInterval=setTimeout(this.handlePeriodicBroadcasts.bind(this),3e4).unref())}handlePeriodicBroadcasts(){this.broadcastInterval=void 0,T("Sending periodic announcement on "+Array.from(this.server.getNetworkManager().getInterfaceMap().keys()).join(", "));for(const e of this.server.getNetworkManager().getInterfaceMap().values()){const t=new c.Question("_hap._tcp.local.",12,!1),r=this.answerQuestion(t,{port:5353,address:e.ipv4Netaddress||e.globallyRoutableIpv6||e.uniqueLocalIpv6||e.ipv6,interface:e.name});m.QueryResponse.combineResponses(r);for(const t of r)t.hasAnswers()&&this.server.sendResponse(t.asPacket(),e.name)}this.broadcastInterval=setTimeout(this.handlePeriodicBroadcasts.bind(this),3e3*Math.random()+27e3).unref()}createService(e){const t=new o.CiaoService(this.server.getNetworkManager(),e);return t.on("publish",this.advertiseService.bind(this,t)),t.on("unpublish",this.unpublishService.bind(this,t)),t.on("republish",this.republishService.bind(this,t)),t.on("records-update",this.handleServiceRecordUpdate.bind(this,t)),t.on("records-update-interface",this.handleServiceRecordUpdateOnInterface.bind(this,t)),t}shutdown(){if(this.refCount--,this.refCount>0)return Promise.resolve();this.currentProber&&this.currentProber.cancel(),this.broadcastInterval&&clearTimeout(this.broadcastInterval),D.INSTANCES.delete(this.optionsString),T("Shutting down Responder...");const e=[];for(const t of this.announcedServices.values())e.push(this.unpublishService(t));return Promise.all(e).then((()=>{this.server.shutdown(),this.bound=!1}))}getAnnouncedServices(){return this.announcedServices.values()}start(){if(this.bound)throw new Error("Server is already bound!");return this.bound=!0,this.server.bind()}advertiseService(e,t){if("announced"===e.serviceState)throw new Error("Can't publish a service that is already announced. Received "+e.serviceState+" for service "+e.getFQDN());return"probing"===e.serviceState?this.promiseChain.then((()=>{if(e.currentAnnouncer)return e.currentAnnouncer.awaitAnnouncement()})):"announcing"===e.serviceState?((0,n.default)(e.currentAnnouncer,"Service is in state ANNOUNCING though has no linked announcer!"),e.currentAnnouncer.isSendingGoodbye()?e.currentAnnouncer.awaitAnnouncement().then((()=>this.advertiseService(e,t))):e.currentAnnouncer.cancel().then((()=>this.advertiseService(e,t)))):(T("[%s] Going to advertise service...",e.getFQDN()),this.promiseChain=this.promiseChain.then((()=>e.rebuildServiceRecords())).then((()=>this.probe(e))),this.promiseChain.then((()=>{this.announce(e).catch((t=>(console.log(`[${e.getFQDN()}] failed announcing with reason: ${t}. Trying again in 2 seconds!`),(0,E.PromiseTimeout)(2e3).then((()=>this.advertiseService(e,(()=>{}))))))),t()}),(r=>{if(r!==g.Prober.CANCEL_REASON)return console.log(`[${e.getFQDN()}] failed probing with reason: ${r}. Trying again in 2 seconds!`),(0,E.PromiseTimeout)(2e3).then((()=>this.advertiseService(e,t)));t()})))}async republishService(e,t,r=!1){if("announced"!==e.serviceState&&"announcing"!==e.serviceState)throw new Error("Can't unpublish a service which isn't announced yet. Received "+e.serviceState+" for service "+e.getFQDN());if(T("[%s] Readvertising service...",e.getFQDN()),"announcing"===e.serviceState){(0,n.default)(e.currentAnnouncer,"Service is in state ANNOUNCING though has no linked announcer!");return(e.currentAnnouncer.isSendingGoodbye()?e.currentAnnouncer.awaitAnnouncement():e.currentAnnouncer.cancel()).then((()=>this.advertiseService(e,t)))}return this.clearService(e),e.serviceState="unannounced",r?(0,E.PromiseTimeout)(1e3).then((()=>this.advertiseService(e,t))):this.advertiseService(e,t)}unpublishService(e,t){if("unannounced"===e.serviceState)throw new Error("Can't unpublish a service which isn't announced yet. Received "+e.serviceState+" for service "+e.getFQDN());if("announced"===e.serviceState||"announcing"===e.serviceState){if("announcing"===e.serviceState)return(0,n.default)(e.currentAnnouncer,"Service is in state ANNOUNCING though has no linked announcer!"),e.currentAnnouncer.isSendingGoodbye()?e.currentAnnouncer.awaitAnnouncement():e.currentAnnouncer.cancel().then((()=>(e.serviceState="announced",this.unpublishService(e,t))));T("[%s] Removing service from the network",e.getFQDN()),this.clearService(e),e.serviceState="unannounced";let r=this.goodbye(e);return t&&(r=r.then((()=>t()),(r=>{console.log(`[${e.getFQDN()}] failed goodbye with reason: ${r}.`),t()}))),r}return"probing"===e.serviceState&&(T("[%s] Canceling probing",e.getFQDN()),this.currentProber&&this.currentProber.getService()===e&&(this.currentProber.cancel(),this.currentProber=void 0),e.serviceState="unannounced"),t&&t(),Promise.resolve()}clearService(e){const t=e.getLowerCasedFQDN(),r=e.getLowerCasedTypePTR(),i=e.getLowerCasedSubtypePTRs();if(this.removePTR(D.SERVICE_TYPE_ENUMERATION_NAME,r),this.removePTR(r,t),i)for(const e of i)this.removePTR(e,t);this.announcedServices.delete(e.getLowerCasedFQDN())}addPTR(e,t){const r=this.servicePointer.get(e);r?r.includes(t)||r.push(t):this.servicePointer.set(e,[t])}removePTR(e,t){const r=this.servicePointer.get(e);if(r){const i=r.indexOf(t);-1!==i&&r.splice(i,1),0===r.length&&this.servicePointer.delete(e)}}probe(e){if("unannounced"!==e.serviceState)throw new Error("Can't probe for a service which is announced already. Received "+e.serviceState+" for service "+e.getFQDN());return e.serviceState="probing",(0,n.default)(void 0===this.currentProber,"Tried creating new Prober when there already was one active!"),this.currentProber=new g.Prober(this,this.server,e),this.currentProber.probe().then((()=>{this.currentProber=void 0,e.serviceState="probed"}),(t=>(e.serviceState="unannounced",this.currentProber=void 0,Promise.reject(t))))}announce(e){if("probed"!==e.serviceState)throw new Error("Cannot announce service which was not probed unique. Received "+e.serviceState+" for service "+e.getFQDN());(0,n.default)(void 0===e.currentAnnouncer,"Service "+e.getFQDN()+" is already announcing!"),e.serviceState="announcing";const t=new v.Announcer(this.server,e,{repetitions:3});e.currentAnnouncer=t;const r=e.getLowerCasedFQDN(),i=e.getLowerCasedTypePTR(),a=e.getLowerCasedSubtypePTRs();if(this.addPTR(D.SERVICE_TYPE_ENUMERATION_NAME,i),this.addPTR(i,r),a)for(const e of a)this.addPTR(e,r);return this.announcedServices.set(r,e),t.announce().then((()=>{e.serviceState="announced",e.currentAnnouncer=void 0}),(t=>{if(e.serviceState="unannounced",e.currentAnnouncer=void 0,this.clearService(e),t!==v.Announcer.CANCEL_REASON)return Promise.reject(t)}))}handleServiceRecordUpdate(e,t,r){var i;if("announced"!==e.serviceState)throw new Error("Cannot update txt of service which is not announced yet. Received "+e.serviceState+" for service "+e.getFQDN());T("[%s] Updating %d record(s) for given service!",e.getFQDN(),t.answers.length+((null===(i=t.additionals)||void 0===i?void 0:i.length)||0)),this.server.sendResponseBroadcast(t,e).then((t=>{const i=(0,f.SendResultFailedRatio)(t);if(1===i)return console.log((0,f.SendResultFormatError)(t,`Failed to send records update for '${e.getFQDN()}'`),!0),void(r&&r(new Error("Updating records failed as of socket errors!")));i>0&&T((0,f.SendResultFormatError)(t,`Some of the record updates for '${e.getFQDN()}' failed`)),r&&r()}))}handleServiceRecordUpdateOnInterface(e,t,r,i){if("announced"!==e.serviceState)throw new Error("Cannot update txt of service which is not announced yet. Received "+e.serviceState+" for service "+e.getFQDN());T("[%s] Updating %d record(s) for given service on interface %s!",e.getFQDN(),r.length,t);const n=s.DNSPacket.createDNSResponsePacketsFromRRSet({answers:r});this.server.sendResponse(n,t,i)}goodbye(e){(0,n.default)(void 0===e.currentAnnouncer,"Service "+e.getFQDN()+" is already announcing!"),e.serviceState="announcing";const t=new v.Announcer(this.server,e,{repetitions:1,goodbye:!0});return e.currentAnnouncer=t,t.announce().then((()=>{e.serviceState="unannounced",e.currentAnnouncer=void 0}),(t=>(e.serviceState="unannounced",e.currentAnnouncer=void 0,Promise.reject(t))))}handleNetworkUpdate(e){for(const t of this.announcedServices.values())t.handleNetworkInterfaceUpdate(e)}handleQuery(e,t){const r=(new Date).getTime(),i=t.address+":"+t.port+":"+t.interface,n=this.truncatedQueries[i];if(n){switch(n.appendDNSPacket(e)){case 1:return delete this.truncatedQueries[i],void T("[%s] Aborting to wait for more truncated queries. Waited a total of %d ms receiving %d queries",i,n.getTotalWaitTime(),n.getArrivedPacketCount());case 2:return void T("[%s] Received a query marked as truncated, waiting for more to arrive",i);case 3:delete this.truncatedQueries[i],e=n.getPacket(),T("[%s] Last part of the truncated query arrived. Received %d packets taking a total of %d ms",i,n.getArrivedPacketCount(),n.getTotalWaitTime())}}else if(e.flags.truncation){T("Received truncated query from "+JSON.stringify(t)+" waiting for more to come!");const r=new C.TruncatedQuery(e);return this.truncatedQueries[i]=r,void r.on("timeout",(()=>{T("[%s] Timeout passed since the last truncated query was received. Discarding %d packets received in %d ms.",i,r.getArrivedPacketCount(),r.getTotalWaitTime()),delete this.truncatedQueries[i]}))}const a=t.port!==f.MDNSServer.MDNS_PORT,o=e.authorities.size>0;let s;for(const t of e.additionals.values())if(41===t.type){s=t.udpPayloadSize;break}const c=[],u=[];if(e.questions.forEach((r=>{const i=this.answerQuestion(r,t,e.answers);a||r.unicastResponseFlag&&!this.ignoreUnicastResponseFlag?u.push(...i):c.push(...i)})),this.currentProber&&this.currentProber.handleQuery(e,t),a)for(let t=0;t<u.length;t++){u[t].markLegacyUnicastResponse(e.id,0===t?Array.from(e.questions.values()):void 0)}m.QueryResponse.combineResponses(c,s),m.QueryResponse.combineResponses(u,s),a&&u.length>1&&(u.splice(1,u.length-1),u[0].markTruncated());for(const e of u){if(!e.hasAnswers())continue;this.server.sendResponse(e.asPacket(),t);const i=(new Date).getTime()-r;T("Sending response via unicast to %s (took %d ms): %s",JSON.stringify(t),i,e.asString(s))}for(const i of c)if(i.hasAnswers())if((i.containsSharedAnswer()||e.questions.size>1)&&!o){const e=(new Date).getTime()-r;this.enqueueDelayedMulticastResponse(i.asPacket(),t.interface,e)}else{let e=!1;for(let n=0;n<this.delayedMulticastResponses.length;n++){const a=this.delayedMulticastResponses[n];if(a.getTimeTillSent()>y.QueuedResponse.MAX_DELAY)break;if(a.combineWithUniqueResponseIfPossible(i,t.interface)){const i=(new Date).getTime()-r;e=!0,T("Multicast response on interface %s containing unique records (took %d ms) was combined with response which is sent out later",t.interface,i);break}}if(!e){this.server.sendResponse(i.asPacket(),t.interface);const e=(new Date).getTime()-r;T("Sending response via multicast on network %s (took %d ms): %s",t.interface,e,i.asString(s))}}}handleResponse(e,t){this.currentProber&&this.currentProber.handleResponse(e,t);for(const r of this.announcedServices.values()){let i=!1,n=0;for(const a of e.answers.values()){const e=D.checkRecordConflictType(r,a,t);if(1===e){i=!0;break}2===e&&n++}if(!i)for(const a of e.additionals.values()){const e=D.checkRecordConflictType(r,a,t);if(1===e){i=!0;break}2===e&&n++}if(i)this.republishService(r,(e=>{e&&(console.log(`FATAL Error occurred trying to resolve conflict for service ${r.getFQDN()}! We can't recover from this!`),console.log(e.stack),process.exit(1))}),!0);else if(n&&!r.currentAnnouncer){r.serviceState="announcing";const e=new v.Announcer(this.server,r,{repetitions:1});r.currentAnnouncer=e,e.announce().then((()=>{r.currentAnnouncer=void 0,r.serviceState="announced"}),(e=>{r.currentAnnouncer=void 0,r.serviceState="announced",e!==v.Announcer.CANCEL_REASON&&console.warn("When trying to resolve a ttl conflict on the network, we were unable to send our response packet: "+e.message)}))}}}static checkRecordConflictType(e,t,r){if(!e.advertisesOnInterface(r.interface))return 0;const i=t.getLowerCasedName();if(i===e.getLowerCasedFQDN()){if(33===t.type){const r=t;if(r.getLowerCasedHostname()!==e.getLowerCasedHostname())return T("[%s] Noticed conflicting record on the network. SRV with hostname: %s",e.getFQDN(),r.hostname),1;if(r.port!==e.getPort())return T("[%s] Noticed conflicting record on the network. SRV with port: %s",e.getFQDN(),r.port),1;if(r.ttl<d.SRVRecord.DEFAULT_TTL/2)return 2}else if(16===t.type){const r=t,i=e.getTXT();if(i.length!==r.txt.length)return T("[%s] Noticed conflicting record on the network. TXT with differing data length",e.getFQDN()),1;for(let t=0;t<i.length;t++){const n=i[t],a=r.txt[t];if(n.length!==a.length||n.toString("hex")!==a.toString("hex"))return T("[%s] Noticed conflicting record on the network. TXT with differing data.",e.getFQDN()),1}if(r.ttl<p.TXTRecord.DEFAULT_TTL/2)return 2}}else if(i===e.getLowerCasedHostname()){if(1===t.type){const r=t;if(!e.hasAddress(r.ipAddress))return T("[%s] Noticed conflicting record on the network. A with ip address: %s",e.getFQDN(),r.ipAddress),1;if(r.ttl<l.ARecord.DEFAULT_TTL/2)return 2}else if(28===t.type){const r=t;if(!e.hasAddress(r.ipAddress))return T("[%s] Noticed conflicting record on the network. AAAA with ip address: %s",e.getFQDN(),r.ipAddress),1;if(r.ttl<u.AAAARecord.DEFAULT_TTL/2)return 2}}else if(12===t.type){const r=t;if(i===e.getLowerCasedTypePTR()){if(r.getLowerCasedPTRName()===e.getLowerCasedFQDN()&&r.ttl<h.PTRRecord.DEFAULT_TTL/2)return 2}else if(i===D.SERVICE_TYPE_ENUMERATION_NAME);else{const t=e.getLowerCasedSubtypePTRs();if(t&&t.includes(i)&&r.getLowerCasedPTRName()===e.getLowerCasedFQDN()&&r.ttl<h.PTRRecord.DEFAULT_TTL/2)return 2}}return 0}enqueueDelayedMulticastResponse(e,t,r){const i=new y.QueuedResponse(e,t);i.calculateRandomDelay(),(0,_.sortedInsert)(this.delayedMulticastResponses,i,A);for(let e=0;e<this.delayedMulticastResponses.length;e++){const t=this.delayedMulticastResponses[e];for(let r=e+1;r<this.delayedMulticastResponses.length;r++){const i=this.delayedMulticastResponses[r];if(!t.delayWouldBeInTimelyManner(i))break;if(t.combineWithNextPacketIfPossible(i)){const r=this.delayedMulticastResponses.indexOf(t);-1!==r&&this.delayedMulticastResponses.splice(r,1),e--;break}}}i.delayed||i.scheduleResponse((()=>{const e=this.delayedMulticastResponses.indexOf(i);-1!==e&&this.delayedMulticastResponses.splice(e,1);try{this.server.sendResponse(i.getPacket(),t),T("Sending (delayed %dms) response via multicast on network interface %s (took %d ms): %s",Math.round(i.getTimeSinceCreation()),t,r,i.getPacket().asLoggingString())}catch(e){if(e.name===S.ERR_INTERFACE_NOT_FOUND)T("Multicast response (delayed %dms) was cancelled as the network interface %s is no longer available!",Math.round(i.getTimeSinceCreation()),t);else{if(e.name!==S.ERR_SERVER_CLOSED)throw e;T("Multicast response (delayed %dms) was cancelled as the server is about to be shutdown!",Math.round(i.getTimeSinceCreation()))}}}))}answerQuestion(e,t,r){if(1!==e.class&&255!==e.class)return[];const i=[];let n;if(12===e.type||255===e.type||5===e.type){const a=this.servicePointer.get(e.getLowerCasedName());if(a){for(const o of a){const a=this.announcedServices.get(o);if(a){if(a.advertisesOnInterface(t.interface)){const n=D.answerServiceQuestion(a,e,t,r);n.hasAnswers()&&i.push(n)}}else n||(n=new m.QueryResponse(r),i.unshift(n)),n.addAnswer(new h.PTRRecord(e.name,o))}return i}}for(const n of this.announcedServices.values()){if(!n.advertisesOnInterface(t.interface))continue;const a=D.answerServiceQuestion(n,e,t,r);a.hasAnswers()&&i.push(a)}return i}static answerServiceQuestion(e,t,r,i){const a=new m.QueryResponse(i),o=t.getLowerCasedName(),s=255===t.type||5===t.type,c=a.addAnswer.bind(a),u=a.addAdditional.bind(a);if(o===e.getLowerCasedTypePTR()){if(s||12===t.type){a.addAnswer(e.ptrRecord())&&(a.addAdditional(e.txtRecord(),e.srvRecord()),this.addAddressRecords(e,r,1,u),this.addAddressRecords(e,r,28,u),a.addAdditional(e.serviceNSECRecord(),e.addressNSECRecord()))}}else if(o===e.getLowerCasedFQDN())if(s){a.addAnswer(e.txtRecord());a.addAnswer(e.srvRecord())&&(this.addAddressRecords(e,r,1,u),this.addAddressRecords(e,r,28,u),a.addAdditional(e.serviceNSECRecord(),e.addressNSECRecord()))}else if(33===t.type){a.addAnswer(e.srvRecord())&&(this.addAddressRecords(e,r,1,u),this.addAddressRecords(e,r,28,u),a.addAdditional(e.serviceNSECRecord(!0),e.addressNSECRecord()))}else 16===t.type&&(a.addAnswer(e.txtRecord()),a.addAdditional(e.serviceNSECRecord()));else if(o===e.getLowerCasedHostname()||o+"local."===e.getLowerCasedHostname()){if(s)this.addAddressRecords(e,r,1,c),this.addAddressRecords(e,r,28,c),a.addAdditional(e.addressNSECRecord());else if(1===t.type){this.addAddressRecords(e,r,1,c)&&this.addAddressRecords(e,r,28,u),a.addAdditional(e.addressNSECRecord())}else if(28===t.type){this.addAddressRecords(e,r,28,c)&&this.addAddressRecords(e,r,1,u),a.addAdditional(e.addressNSECRecord())}}else if(e.getLowerCasedSubtypePTRs()&&(s||12===t.type)){const t=e.getLowerCasedSubtypePTRs().indexOf(o);if(-1!==t){const i=e.subtypePtrRecords()[t];(0,n.default)(o===i.name,"Question Name didn't match selected sub type ptr record!");a.addAnswer(i)&&(a.addAdditional(e.txtRecord(),e.srvRecord()),this.addAddressRecords(e,r,1,u),this.addAddressRecords(e,r,28,u),a.addAdditional(e.serviceNSECRecord(),e.addressNSECRecord()))}}return a}static addAddressRecords(e,t,r,i){if(1===r){const r=e.aRecord(t.interface);return!!r&&i(r)}if(28===r){const r=e.aaaaRecord(t.interface),n=e.aaaaRoutableRecord(t.interface),a=e.aaaaUniqueLocalRecord(t.interface);let o=!1;if(r&&(o=i(r)),n){const e=i(n);o=o||e}if(a){const e=i(a);o=o||e}return o}n.default.fail("Illegal argument!")}}t.Responder=D,D.SERVICE_TYPE_ENUMERATION_NAME="_services._dns-sd._udp.local.",D.INSTANCES=new Map},7352:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NonCompressionLabelCoder=t.DNSLabelCoder=void 0;const i=r(1635).__importDefault(r(2613));class n{constructor(e){this.trackedLengths=[],this.writtenNames=[],this.legacyUnicastEncoding=e||!1}initBuf(e){this.buffer=e}initRRLocation(e,t,r){this.startOfRR=e,this.startOfRData=t,this.rDataLength=r}clearRRLocation(){this.startOfRR=void 0,this.startOfRData=void 0,this.rDataLength=void 0}getUncompressedNameLength(e){if("."===e)return 1;(0,i.default)(e.endsWith("."),"Supplied illegal name which doesn't end with the root label!");let t=0;const r=e.split(".");for(let a=0;a<r.length;a++){const o=r[a];!o&&a<r.length-1&&i.default.fail("Label "+a+" in name '"+e+"' was empty"),t+=n.getLabelLength(o)}return t}getNameLength(e){if(n.DISABLE_COMPRESSION)return this.getUncompressedNameLength(e);if("."===e)return 1;(0,i.default)(e.endsWith("."),"Supplied illegal name which doesn't end with the root label!");const t=e.split(".").map((e=>n.getLabelLength(e))),r={name:e,length:0,labelLengths:t};let a,o=0;for(let t=0;t<this.trackedLengths.length;t++){const r=this.trackedLengths[t],i=n.computeLabelSuffixLength(r.name,e);i>o&&(a=r,o=i)}let s=0;if(a){const e=t.length-1-o;for(let r=0;r<e;r++)s+=t[r];s+=2}else for(let e=0;e<t.length;e++)s+=t[e];return r.length=s,this.trackedLengths.push(r),r.length}encodeUncompressedName(e,t){return this.buffer||i.default.fail("Illegal state. Buffer not initialized!"),n.encodeUncompressedName(e,this.buffer,t)}static encodeUncompressedName(e,t,r){(0,i.default)(e.endsWith("."),"Name does not end with the root label");const n=r,a="."===e?[""]:e.split(".");for(let e=0;e<a.length;e++){const n=a[e];if(""===n){(0,i.default)(e===a.length-1,"Encountered root label being not at the end of the domain name"),t.writeUInt8(0,r++);break}const o=t.write(n,r+1);t.writeUInt8(o,r),r+=o+1}return r-n}encodeName(e,t){if(n.DISABLE_COMPRESSION)return this.encodeUncompressedName(e,t);if(this.buffer||i.default.fail("Illegal state. Buffer not initialized!"),"."===e)return this.buffer.writeUInt8(0,t),1;const r=t,a=e.split("."),o={name:e,writtenLabels:new Array(a.length).fill(-1)};let s,c=0;for(let t=0;t<this.writtenNames.length;t++){const r=this.writtenNames[t],i=n.computeLabelSuffixLength(r.name,e);i>c&&(s=r,c=i)}if(s){const e=a.length-1-c,r=s.writtenLabels.length-1-c;for(let r=0;r<e;r++)o.writtenLabels[r]=t,t+=n.writeLabel(a[r],this.buffer,t);const u=s.writtenLabels[r];(0,i.default)(-1!==u,"Label which was pointed at wasn't yet written to the buffer!"),(0,i.default)(u<=n.NOT_POINTER_MASK,"Pointer exceeds to length of a maximum of 14 bits"),(0,i.default)(u<t,"Pointer can only point to a prior location");const l=n.POINTER_MASK|u;this.buffer.writeUInt16BE(l,t),t+=2}else for(let e=0;e<a.length;e++)o.writtenLabels[e]=t,t+=n.writeLabel(a[e],this.buffer,t);return this.writtenNames.push(o),t-r}decodeName(e,t=!0){this.buffer||i.default.fail("Illegal state. Buffer not initialized!");const r=e;let a="";for(;;){const o=this.buffer.readUInt8(e++);if(0===o){a+=".";break}const s=o&n.POINTER_MASK_ONE_BYTE;if(s){if(s===n.POINTER_MASK_ONE_BYTE){const o=this.buffer.readUInt16BE(e-1)&n.NOT_POINTER_MASK;if(e++,!t){a+=a?".~":"~";break}(0,i.default)(o<r,"Pointer at "+(e-2)+" MUST point to a prior location!"),a+=(a?".":"")+this.decodeName(o).data;break}if(s===n.LOCAL_COMPRESSION_ONE_BYTE){let o=this.buffer.readUInt16BE(e-1)&n.NOT_POINTER_MASK;if(e++,!t){a+=a?".~":"~";break}o>=0&&o<255?((0,i.default)(void 0!==this.startOfRR,"Cannot decompress locally compressed name as record is not initialized!"),o+=this.startOfRR,(0,i.default)(o<r,"LocalPointer <255 at "+(e-2)+" MUST point to a prior location!"),a+=(a?".":"")+this.decodeName(o).data):o>=256?((0,i.default)(void 0!==this.startOfRData&&void 0!==this.rDataLength,"Cannot decompress locally compressed name as record is not initialized!"),o-=-256,o+=this.startOfRData,(0,i.default)(o<r,"LocationPoint >265 at "+(e+2)+" MUST point to a prior location!"),a+=(a?".":"")+this.decodeName(o).data):i.default.fail("Encountered unknown pointer range "+o);break}if(s===n.EXTENDED_LABEL_TYPE_ONE_BYTE){const t=o&n.NOT_POINTER_MASK_ONE_BYTE;i.default.fail("Received extended label type "+t+" at "+(e-1))}else i.default.fail("Encountered unknown pointer type: "+Buffer.from([s>>6]).toString("hex")+" (with original byte "+Buffer.from([o]).toString("hex")+")")}const c=this.buffer.toString("utf-8",e,e+o);e+=o,a+=(a?".":"")+c}return{data:a,readBytes:e-r}}static getLabelLength(e){if(e){const t=Buffer.byteLength(e);return(0,i.default)(t<=63,"Label cannot be longer than 63 bytes ("+e+")"),1+t}return 1}static writeLabel(e,t,r){if(e){const i=t.write(e,r+1);return t.writeUInt8(i,r),i+1}return t.writeUInt8(0,r),1}static computeLabelSuffixLength(e,t){(0,i.default)(0!==e.length&&0!==t.length,"Encountered empty name when comparing suffixes!");const r=e.length-1,n=t.length-1;let a=0,o=!1;for(let s=1;s<=r&&s<=n;s++){const c=e.charAt(r-s),u=t.charAt(n-s);if((0,i.default)(!!c&&!!u,"Seemingly encountered out of bounds trying to calculate suffixes"),c!==u){o=!0;break}"."===c&&a++}return o||a++,a}}t.DNSLabelCoder=n,n.DISABLE_COMPRESSION=!1,n.POINTER_MASK=49152,n.POINTER_MASK_ONE_BYTE=192,n.LOCAL_COMPRESSION_ONE_BYTE=128,n.EXTENDED_LABEL_TYPE_ONE_BYTE=64,n.NOT_POINTER_MASK=16383,n.NOT_POINTER_MASK_ONE_BYTE=63;class a extends n{getNameLength(e){return this.getUncompressedNameLength(e)}encodeName(e,t){return this.encodeUncompressedName(e,t)}}t.NonCompressionLabelCoder=a,a.INSTANCE=new a},4119:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DNSPacket=t.PacketType=t.QClass=t.RClass=t.QType=t.RType=t.RCode=t.OpCode=void 0;const i=r(1635),n=i.__importDefault(r(2613)),a=i.__importDefault(r(2017)),o=r(1673),s=r(7352),c=r(5682);r(9577);const u=r(5231);var l,h,d,p,f,v,g;function m(e){return"answers"in e}!function(e){e[e.QUERY=0]="QUERY"}(l||(t.OpCode=l={})),function(e){e[e.NoError=0]="NoError"}(h||(t.RCode=h={})),function(e){e[e.A=1]="A",e[e.CNAME=5]="CNAME",e[e.PTR=12]="PTR",e[e.TXT=16]="TXT",e[e.AAAA=28]="AAAA",e[e.SRV=33]="SRV",e[e.OPT=41]="OPT",e[e.NSEC=47]="NSEC"}(d||(t.RType=d={})),function(e){e[e.A=1]="A",e[e.CNAME=5]="CNAME",e[e.PTR=12]="PTR",e[e.TXT=16]="TXT",e[e.AAAA=28]="AAAA",e[e.SRV=33]="SRV",e[e.NSEC=47]="NSEC",e[e.ANY=255]="ANY"}(p||(t.QType=p={})),function(e){e[e.IN=1]="IN"}(f||(t.RClass=f={})),function(e){e[e.IN=1]="IN",e[e.ANY=255]="ANY"}(v||(t.QClass=v={})),function(e){e[e.QUERY=0]="QUERY",e[e.RESPONSE=1]="RESPONSE"}(g||(t.PacketType=g={}));class y{constructor(e){this.questions=new Map,this.answers=new Map,this.authorities=new Map,this.additionals=new Map,this.estimatedEncodingLength=0,this.lastCalculatedLength=0,this.lengthDirty=!0,this.id=e.id||0,this.legacyUnicastEncoding=e.legacyUnicast||!1,this.type=e.type,this.opcode=e.opcode||0,this.flags=e.flags||{},this.rcode=e.rCode||0,1===this.type&&(this.flags.authoritativeAnswer=!0),e.questions&&this.addQuestions(...e.questions),e.answers&&this.addAnswers(...e.answers),e.authorities&&this.addAuthorities(...e.authorities),e.additionals&&this.addAdditionals(...e.additionals)}static createDNSQueryPacket(e,t=this.UDP_PAYLOAD_SIZE_IPV4){const r=this.createDNSQueryPackets(e,t);return(0,n.default)(1===r.length,"Cannot user short method createDNSQueryPacket when query packets are more than one: is "+r.length),r[0]}static createDNSQueryPackets(e,t=this.UDP_PAYLOAD_SIZE_IPV4){const r=[],i=new y({type:0,questions:e.questions,additionals:m(e)?e.additionals:void 0});if(r.push(i),i.getEstimatedEncodingLength()>t){const e=i.getEncodingLength();e>t&&n.default.fail("Cannot send query where already the query section is exceeding the udpPayloadSize ("+e+">"+t+")!")}if(m(e)&&e.answers){let n=i,a=0;const o=e.answers.concat([]);for(o.sort(((e,t)=>e.getEncodingLength(s.NonCompressionLabelCoder.INSTANCE)-t.getEncodingLength(s.NonCompressionLabelCoder.INSTANCE)));a<o.length;){for(;a<o.length;a++){const e=o[a],r=e.getEncodingLength(s.NonCompressionLabelCoder.INSTANCE);if(i.getEstimatedEncodingLength()+r<=t)n.addAnswers(e);else{if(!(i.getEncodingLength()+r<=t)){0===n.questions.size&&0===n.answers.size&&i.addAnswers(e);break}n.addAnswers(e)}}a<o.length&&(n.flags.truncation=!0,n=new y({type:0}),r.push(n))}}else if("authorities"in e&&e.authorities){i.addAuthorities(...e.authorities);const r=i.getEncodingLength();r>t&&n.default.fail(`Probe query packet exceeds the mtu size (${r}>${t}). Can't split probe queries at the moment!`)}return r}static createDNSResponsePacketsFromRRSet(e,t=this.UDP_PAYLOAD_SIZE_IPV4){const r=new y({id:e.id,legacyUnicast:e.legacyUnicast,type:1,flags:{authoritativeAnswer:!0},questions:e.questions,answers:e.answers,additionals:e.additionals});return r.getEncodingLength()>t&&n.default.fail("Couldn't construct a dns response packet from a rr set which fits in an udp payload sized packet!"),r}canBeCombinedWith(e,t=y.UDP_PAYLOAD_SIZE_IPV4){return this.id===e.id&&this.type===e.type&&this.opcode===e.opcode&&(0,a.default)(this.flags,e.flags)&&this.rcode===e.rcode&&this.getEncodingLength()+e.getEncodingLength()<=t}combineWith(e){this.setLegacyUnicastEncoding(this.legacyUnicastEncoding||e.legacyUnicastEncoding),this.addRecords(this.questions,e.questions.values()),this.addRecords(this.answers,e.answers.values(),this.additionals),this.addRecords(this.authorities,e.authorities.values()),this.addRecords(this.additionals,e.additionals.values())}addQuestions(...e){return this.addRecords(this.questions,e)}addAnswers(...e){return this.addRecords(this.answers,e,this.additionals)}addAuthorities(...e){return this.addRecords(this.authorities,e)}addAdditionals(...e){return this.addRecords(this.additionals,e)}addRecords(e,t,r){let i=!1;for(const n of t)e.has(n.asString())||(this.estimatedEncodingLength&&(this.estimatedEncodingLength+=n.getEncodingLength(s.NonCompressionLabelCoder.INSTANCE)),e.set(n.asString(),n),i=!0,this.lengthDirty=!0,r&&r.delete(n.asString()));return i}setLegacyUnicastEncoding(e){this.legacyUnicastEncoding!==e&&(this.lengthDirty=!0),this.legacyUnicastEncoding=e}legacyUnicastEncodingEnabled(){return this.legacyUnicastEncoding}getEstimatedEncodingLength(){if(this.estimatedEncodingLength)return this.estimatedEncodingLength;const e=s.NonCompressionLabelCoder.INSTANCE;let t=y.DNS_PACKET_HEADER_SIZE;for(const r of this.questions.values())t+=r.getEncodingLength(e);for(const r of this.answers.values())t+=r.getEncodingLength(e);for(const r of this.authorities.values())t+=r.getEncodingLength(e);for(const r of this.additionals.values())t+=r.getEncodingLength(e);return this.estimatedEncodingLength=t,t}getEncodingLength(e){if(!this.lengthDirty)return this.lastCalculatedLength;const t=e||new s.DNSLabelCoder(this.legacyUnicastEncoding);let r=y.DNS_PACKET_HEADER_SIZE;for(const e of this.questions.values())r+=e.getEncodingLength(t);for(const e of this.answers.values())r+=e.getEncodingLength(t);for(const e of this.authorities.values())r+=e.getEncodingLength(t);for(const e of this.additionals.values())r+=e.getEncodingLength(t);return this.lengthDirty=!1,this.lastCalculatedLength=r,this.estimatedEncodingLength=r,r}encode(){const e=new s.DNSLabelCoder(this.legacyUnicastEncoding),t=this.getEncodingLength(e),r=Buffer.allocUnsafe(t);e.initBuf(r);let i=0;r.writeUInt16BE(this.id,i),i+=2;let a=this.type<<15|this.opcode<<11|this.rcode;this.flags.authoritativeAnswer&&(a|=y.AUTHORITATIVE_ANSWER_MASK),this.flags.truncation&&(a|=y.TRUNCATION_MASK),this.flags.recursionDesired&&(a|=y.RECURSION_DESIRED_MASK),this.flags.recursionAvailable&&(a|=y.RECURSION_AVAILABLE_MASK),this.flags.zero&&(a|=y.ZERO_HEADER_MASK),this.flags.authenticData&&(a|=y.AUTHENTIC_DATA_MASK),this.flags.checkingDisabled&&(a|=y.CHECKING_DISABLED_MASK),r.writeUInt16BE(a,i),i+=2,r.writeUInt16BE(this.questions.size,i),i+=2,r.writeUInt16BE(this.answers.size,i),i+=2,r.writeUInt16BE(this.authorities.size,i),i+=2,r.writeUInt16BE(this.additionals.size,i),i+=2;for(const t of this.questions.values()){i+=t.encode(e,r,i)}for(const t of this.answers.values()){i+=t.encode(e,r,i)}for(const t of this.authorities.values()){i+=t.encode(e,r,i)}for(const t of this.additionals.values()){i+=t.encode(e,r,i)}return(0,n.default)(i===r.length,"Bytes written didn't match the buffer size!"),r}static decode(e,t,r=0){const i=new s.DNSLabelCoder;i.initBuf(t);const a=t.readUInt16BE(r);r+=2;const o=t.readUInt16BE(r);r+=2;const l=t.readUInt16BE(r);r+=2;const h=t.readUInt16BE(r);r+=2;const d=t.readUInt16BE(r);r+=2;const p=t.readUInt16BE(r);r+=2;const f=[],v=[],g=[],m=[];r+=y.decodeList(e,i,t,r,l,c.Question.decode.bind(c.Question),f),r+=y.decodeList(e,i,t,r,h,u.ResourceRecord.decode.bind(u.ResourceRecord),v),r+=y.decodeList(e,i,t,r,d,u.ResourceRecord.decode.bind(u.ResourceRecord),g),r+=y.decodeList(e,i,t,r,p,u.ResourceRecord.decode.bind(u.ResourceRecord),m),(0,n.default)(r===t.length,"Didn't read the full buffer (offset="+r+", length="+t.length+")");const C=o>>15,S=o>>11&15,E=15&o,_={};return o&this.AUTHORITATIVE_ANSWER_MASK&&(_.authoritativeAnswer=!0),o&this.TRUNCATION_MASK&&(_.truncation=!0),o&this.RECURSION_DESIRED_MASK&&(_.recursionDesired=!0),o&this.RECURSION_AVAILABLE_MASK&&(_.recursionAvailable=!0),o&this.ZERO_HEADER_MASK&&(_.zero=!0),o&this.AUTHENTIC_DATA_MASK&&(_.authenticData=!0),o&this.CHECKING_DISABLED_MASK&&(_.checkingDisabled=!0),new y({id:a,type:C,opcode:S,rCode:E,flags:_,questions:f,answers:v,authorities:g,additionals:m})}static decodeList(e,t,r,i,n,a,o){const s=i;for(let s=0;s<n;s++){const n=a(e,t,r,i);i+=n.readBytes,n.data&&o.push(n.data)}return i-s}asLoggingString(e){let t="",r="";for(const e of this.answers.values())t&&(t+=","),t+=(0,o.dnsTypeToString)(e.type);for(const e of this.additionals.values())r&&(r+=","),r+=(0,o.dnsTypeToString)(e.type);const i=[];this.legacyUnicastEncodingEnabled()&&i.push("U"),e&&i.push("UPS: "+e);const n=0!==i.length?` (${i})`:"";return`[${t}] answers and [${r}] additionals with size ${this.getEncodingLength()}B${n}`}}t.DNSPacket=y,y.UDP_PAYLOAD_SIZE_IPV4=process.env.CIAO_UPS?parseInt(process.env.CIAO_UPS):1440,y.UDP_PAYLOAD_SIZE_IPV6=process.env.CIAO_UPS?parseInt(process.env.CIAO_UPS):1440,y.AUTHORITATIVE_ANSWER_MASK=1024,y.TRUNCATION_MASK=512,y.RECURSION_DESIRED_MASK=256,y.RECURSION_AVAILABLE_MASK=128,y.ZERO_HEADER_MASK=64,y.AUTHENTIC_DATA_MASK=32,y.CHECKING_DISABLED_MASK=16,y.DNS_PACKET_HEADER_SIZE=12},5682:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Question=void 0;const i=r(7585);class n{constructor(e,t,r=!1,i=1){this.unicastResponseFlag=!1,e.endsWith(".")||(e+="."),this.name=e,this.type=t,this.class=i,this.unicastResponseFlag=r}getLowerCasedName(){return this.lowerCasedName||(this.lowerCasedName=(0,i.dnsLowerCase)(this.name))}getEncodingLength(e){return e.getNameLength(this.name)+4}encode(e,t,r){const i=r;r+=e.encodeName(this.name,r),t.writeUInt16BE(this.type,r),r+=2;let a=this.class;return this.unicastResponseFlag&&(a|=n.QU_MASK),t.writeUInt16BE(a,r),(r+=2)-i}clone(){return new n(this.name,this.type,this.unicastResponseFlag,this.class)}asString(){return`Q ${this.name} ${this.type} ${this.class}`}static decode(e,t,r,i){const a=i,o=t.decodeName(i);i+=o.readBytes;const s=r.readUInt16BE(i);i+=2;const c=r.readUInt16BE(i);i+=2;const u=c&this.NOT_QU_MASK,l=!!(c&this.QU_MASK);return{data:new n(o.data,s,l,u),readBytes:i-a}}}t.Question=n,n.QU_MASK=32768,n.NOT_QU_MASK=32767},5231:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResourceRecord=void 0;const i=r(1635),n=i.__importDefault(r(2613)),a=i.__importDefault(r(5753)),o=r(7585),s=r(1673),c=r(7352),u=(0,a.default)("ciao:decoder");class l{constructor(e,t,r=l.RR_DEFAULT_TTL,i=!1,n=1){this.flushFlag=!1,"string"==typeof e?(e.endsWith(".")||(e+="."),this.name=e,this.type=t,this.class=n,this.ttl=r,this.flushFlag=i):(this.name=e.name,this.type=e.type,this.class=e.class,this.ttl=e.ttl,this.flushFlag=e.flushFlag)}getLowerCasedName(){return this.lowerCasedName||(this.lowerCasedName=(0,o.dnsLowerCase)(this.name))}getEncodingLength(e){return e.getNameLength(this.name)+10+this.getRDataEncodingLength(e)}encode(e,t,r){const i=r;r+=e.encodeName(this.name,r),t.writeUInt16BE(this.type,r),r+=2;let n=this.class;this.flushFlag&&(n|=l.FLUSH_MASK),t.writeUInt16BE(n,r),r+=2,t.writeUInt32BE(this.ttl,r),r+=4;const a=this.encodeRData(e,t,r+2);return t.writeUInt16BE(a,r),(r+=2+a)-i}getRawData(){const e=c.NonCompressionLabelCoder.INSTANCE,t=this.getRDataEncodingLength(e),r=Buffer.allocUnsafe(t);e.initBuf(r);const i=this.encodeRData(e,r,0);return(0,n.default)(i===r.length,"Didn't completely write to the buffer! ("+i+"!="+r.length+")"),e.initBuf(),r}static clone(e){return e.map((e=>e.clone()))}getRecordRepresentation(){return{name:this.name,type:this.type,class:this.class,ttl:this.ttl,flushFlag:this.flushFlag}}aboutEqual(e){return this.type===e.type&&this.name===e.name&&this.class===e.class&&this.dataEquals(e)}representsSameData(e){return this.type===e.type&&this.name===e.name&&this.class===e.class}asString(){return`RR ${this.name} ${this.type} ${this.class} ${this.dataAsString()}`}static decode(e,t,r,i){const n=i,a=this.decodeRecordHeader(t,r,i);i+=a.readBytes;const o=a.data,c=this.typeToRecordDecoder.get(o.type);if(!c)return{readBytes:i+o.rDataLength-n};t.initRRLocation(n,i,o.rDataLength);const l=r.subarray(0,i+o.rDataLength);let h;try{h=c(t,o,l,i)}catch(t){return u(`Received malformed rdata section for ${(0,s.dnsTypeToString)(o.type)} ${o.name} ${o.ttl} from ${e.address}:${e.port} with data '${l.subarray(i).toString("hex")}': ${t.stack}`),{readBytes:i+o.rDataLength-n}}return i+=h.readBytes,t.clearRRLocation(),{data:h.data,readBytes:i-n}}static decodeRecordHeader(e,t,r){const i=r,n=e.decodeName(r);r+=n.readBytes;const a=t.readUInt16BE(r);r+=2;const o=t.readUInt16BE(r);let s;r+=2;let c=!1;41!==a?(s=o&this.NOT_FLUSH_MASK,c=!!(o&this.FLUSH_MASK)):s=o;const u=t.readUInt32BE(r);r+=4;const l=t.readUInt16BE(r);r+=2;return{data:{name:n.data,type:a,class:s,ttl:u,flushFlag:c,rDataLength:l},readBytes:r-i}}}t.ResourceRecord=l,l.typeToRecordDecoder=new Map,l.FLUSH_MASK=32768,l.NOT_FLUSH_MASK=32767,l.RR_DEFAULT_TTL_SHORT=120,l.RR_DEFAULT_TTL=4500},1673:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dnsTypeToString=void 0,t.dnsTypeToString=function(e){switch(e){case 1:return"A";case 5:return"CNAME";case 12:return"PTR";case 16:return"TXT";case 28:return"AAAA";case 33:return"SRV";case 41:return"OPT";case 47:return"NSEC";case 255:return"ANY"}return"UNSUPPORTED_"+e}},1360:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AAAARecord=void 0;const i=r(1635),n=i.__importDefault(r(2613)),a=i.__importDefault(r(9278)),o=r(9152),s=r(5231);class c extends s.ResourceRecord{constructor(e,t,r,i){"string"==typeof e?super(e,28,i||c.RR_DEFAULT_TTL_SHORT,r):((0,n.default)(28===e.type),super(e)),(0,n.default)(a.default.isIPv6(t),"IP address is not in v6 format!"),this.ipAddress=t}getRDataEncodingLength(){return 16}encodeRData(e,t,r){const i=r,a=(0,o.enlargeIPv6)(this.ipAddress).split(":");(0,n.default)(8===a.length,"invalid ip address");for(const e of a){const i=parseInt(e,16);t.writeUInt16BE(i,r),r+=2}return r-i}static decodeData(e,t,r,i){const n=i,a=new Array(8);for(let e=0;e<8;e++){const t=r.readUInt16BE(i);i+=2,a[e]=t.toString(16)}const s=(0,o.shortenIPv6)(a.join(":"));return{data:new c(t,s),readBytes:i-n}}clone(){return new c(this.getRecordRepresentation(),this.ipAddress)}dataAsString(){return this.ipAddress}dataEquals(e){return this.ipAddress===e.ipAddress}}t.AAAARecord=c,c.DEFAULT_TTL=120},4495:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ARecord=void 0;const i=r(1635),n=i.__importDefault(r(2613)),a=i.__importDefault(r(9278)),o=r(5231);class s extends o.ResourceRecord{constructor(e,t,r,i){"string"==typeof e?super(e,1,i||s.RR_DEFAULT_TTL_SHORT,r):((0,n.default)(1===e.type),super(e)),(0,n.default)(a.default.isIPv4(t),"IP address is not in v4 format!"),this.ipAddress=t}getRDataEncodingLength(){return 4}encodeRData(e,t,r){const i=r,a=this.ipAddress.split(".");(0,n.default)(4===a.length,"invalid ip address");for(const e of a){const i=parseInt(e,10);t.writeUInt8(i,r++)}return r-i}static decodeData(e,t,r,i){const n=i,a=new Array(4);for(let e=0;e<4;e++){const t=r.readUInt8(i++);a[e]=t.toString(10)}const o=a.join(".");return{data:new s(t,o),readBytes:i-n}}clone(){return new s(this.getRecordRepresentation(),this.ipAddress)}dataAsString(){return this.ipAddress}dataEquals(e){return this.ipAddress===e.ipAddress}}t.ARecord=s,s.DEFAULT_TTL=120},5102:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CNAMERecord=void 0;const i=r(1635).__importDefault(r(2613)),n=r(7585),a=r(5231);class o extends a.ResourceRecord{constructor(e,t,r,n){"string"==typeof e?super(e,5,n,r):((0,i.default)(5===e.type),super(e)),t.endsWith(".")||(t+="."),this.cname=t}getLowerCasedCName(){return this.lowerCasedCName||(this.lowerCasedCName=(0,n.dnsLowerCase)(this.cname))}getRDataEncodingLength(e){return e.getNameLength(this.cname)}encodeRData(e,t,r){const i=r;return(r+=e.encodeName(this.cname,r))-i}static decodeData(e,t,r,i){const n=i,a=e.decodeName(i);return i+=a.readBytes,{data:new o(t,a.data),readBytes:i-n}}clone(){return new o(this.getRecordRepresentation(),this.cname)}dataAsString(){return this.cname}dataEquals(e){return this.getLowerCasedCName()===e.getLowerCasedCName()}}t.CNAMERecord=o,o.DEFAULT_TTL=a.ResourceRecord.RR_DEFAULT_TTL},6343:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NSECRecord=void 0;const i=r(1635),n=i.__importDefault(r(2613)),a=i.__importDefault(r(2017)),o=r(7585),s=r(5231);class c extends s.ResourceRecord{constructor(e,t,r,i,a){"string"==typeof e?super(e,47,i||c.RR_DEFAULT_TTL_SHORT,a):((0,n.default)(47===e.type),super(e)),t.endsWith(".")||(t+="."),this.nextDomainName=t,this.rrTypeWindows=c.rrTypesToWindowMap(r)}getLowerCasedNextDomainName(){return this.lowerCasedNextDomainName||(this.lowerCasedNextDomainName=(0,o.dnsLowerCase)(this.nextDomainName))}getRRTypesBitMapEncodingLength(){let e=0;for(const t of this.rrTypeWindows)(0,n.default)(t.rrtypes.length>0,"types array for windowId "+t.windowId+" cannot be empty!"),e+=2+t.bitMapSize;return e}getRDataEncodingLength(e){return e.legacyUnicastEncoding,e.getUncompressedNameLength(this.nextDomainName)+this.getRRTypesBitMapEncodingLength()}encodeRData(e,t,r){const i=r;r+=(e.legacyUnicastEncoding,e.encodeUncompressedName(this.nextDomainName,r));for(const e of this.rrTypeWindows){t.writeUInt8(e.windowId,r++),t.writeUInt8(e.bitMapSize,r++);const i=Buffer.alloc(e.bitMapSize);for(const t of e.rrtypes){const e=(255&t)>>3;let r=i.readUInt8(e);r|=1<<7-(7&t),i.writeUInt8(r,e)}i.copy(t,r),r+=i.length}return r-i}static decodeData(e,t,r,i){const n=i,a=e.decodeName(i,!1);i+=a.readBytes;const o=[];for(;i<r.length;){const e=r.readUInt8(i++),t=r.readUInt8(i++),n=e<<8;for(let e=0;e<t;e++){const t=r.readUInt8(i++);for(let r=0;r<8;r++)if(t&1<<7-r){const t=n|e<<3|r;o.push(t)}}}return{data:new c(t,a.data,o),readBytes:i-n}}clone(){return new c(this.getRecordRepresentation(),this.nextDomainName,c.windowsToRRTypes(this.rrTypeWindows))}dataAsString(){return`${this.nextDomainName} [${c.windowsToRRTypes(this.rrTypeWindows).map((e=>""+e)).join(",")}]`}dataEquals(e){return this.getLowerCasedNextDomainName()===e.getLowerCasedNextDomainName()&&(0,a.default)(this.rrTypeWindows,e.rrTypeWindows)}static rrTypesToWindowMap(e){const t=[];for(const r of e){const e=r>>8;let i;for(const r of t)if(r.windowId===e){i=r;break}if(i){i.rrtypes.push(r);const e=Math.ceil((255&r)/8);e>i.bitMapSize&&(i.bitMapSize=e)}else i={windowId:e,bitMapSize:Math.ceil((255&r)/8),rrtypes:[r]},t.push(i)}return t.sort(((e,t)=>e.windowId-t.windowId)),t.forEach((e=>e.rrtypes.sort(((e,t)=>e-t)))),t}static windowsToRRTypes(e){const t=[];for(const r of e)t.push(...r.rrtypes);return t}}t.NSECRecord=c},6141:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OPTRecord=void 0;const i=r(1635),n=i.__importDefault(r(2613)),a=i.__importDefault(r(2017)),o=r(5231);class s extends o.ResourceRecord{constructor(e,t,r,i,a,o){"number"==typeof e?(super(".",41,o,!1,e),this.udpPayloadSize=e):((0,n.default)(41===e.type),super(e),this.udpPayloadSize=e.class),this.extendedRCode=r||0,this.ednsVersion=a||s.EDNS_VERSION,this.flags={dnsSecOK:(null==i?void 0:i.dnsSecOK)||!1,zero:(null==i?void 0:i.zero)||0,...i},this.options=t||[]}getRDataEncodingLength(){let e=0;for(const t of this.options)e+=4+t.data.length;return e}encodeRData(e,t,r){const i=r,n=r-8,a=r-6;t.writeUInt16BE(this.udpPayloadSize,n),t.writeUInt8(this.extendedRCode,a),t.writeUInt8(this.ednsVersion,a+1);let o=this.flags.zero||0;this.flags.dnsSecOK&&(o|=s.DNS_SEC_OK_MASK),t.writeUInt16BE(o,a+2);for(const e of this.options)t.writeUInt16BE(e.code,r),r+=2,t.writeUInt16BE(e.data.length,r),r+=2,e.data.copy(t,r),r+=e.data.length;return r-i}static decodeData(e,t,r,i){const n=i,a=i-8,o=i-6,c=r.readUInt16BE(a),u=r.readUInt8(o),l=r.readUInt8(o+1),h=r.readUInt16BE(o+2),d={dnsSecOK:!!(h&s.DNS_SEC_OK_MASK),zero:h&s.NOT_DNS_SEC_OK_MASK},p=[];for(;i<r.length;){const e=r.readUInt16BE(i);i+=2;const t=r.readUInt16BE(i);i+=2;const n=r.subarray(i,i+t);i+=t,p.push({code:e,data:n})}return t.class=c,t.ttl=4500,{data:new s(t,p,u,d,l),readBytes:i-n}}clone(){return new s(this.getRecordRepresentation(),this.options,this.extendedRCode,this.flags,this.ednsVersion)}dataAsString(){return`${this.udpPayloadSize} ${this.extendedRCode} ${this.ednsVersion} ${JSON.stringify(this.flags)} [${this.options.map((e=>`${e.code} ${e.data.toString("base64")}`)).join(",")}]`}dataEquals(e){return this.udpPayloadSize===e.udpPayloadSize&&this.extendedRCode===e.extendedRCode&&this.ednsVersion===e.ednsVersion&&s.optionsEquality(this.options,e.options)&&(0,a.default)(this.flags,e.flags)}static optionsEquality(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++){if(e[r].code!==t[r].code)return!1;if(e[r].data.toString("hex")!==t[r].data.toString("hex"))return!1}return!0}}t.OPTRecord=s,s.EDNS_VERSION=0,s.DNS_SEC_OK_MASK=32768,s.NOT_DNS_SEC_OK_MASK=32767},482:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PTRRecord=void 0;const i=r(1635).__importDefault(r(2613)),n=r(7585),a=r(5231);class o extends a.ResourceRecord{constructor(e,t,r,n){"string"==typeof e?super(e,12,n,r):((0,i.default)(12===e.type),super(e)),t.endsWith(".")||(t+="."),this.ptrName=t}getLowerCasedPTRName(){return this.lowerCasedPtrName||(this.lowerCasedPtrName=(0,n.dnsLowerCase)(this.ptrName))}getRDataEncodingLength(e){return e.getNameLength(this.ptrName)}encodeRData(e,t,r){const i=r;return(r+=e.encodeName(this.ptrName,r))-i}static decodeData(e,t,r,i){const n=i,a=e.decodeName(i);return i+=a.readBytes,{data:new o(t,a.data),readBytes:i-n}}clone(){return new o(this.getRecordRepresentation(),this.ptrName)}dataAsString(){return this.ptrName}dataEquals(e){return this.getLowerCasedPTRName()===e.getLowerCasedPTRName()}}t.PTRRecord=o,o.DEFAULT_TTL=a.ResourceRecord.RR_DEFAULT_TTL},8225:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SRVRecord=void 0;const i=r(1635).__importDefault(r(2613)),n=r(7585),a=r(5231);class o extends a.ResourceRecord{constructor(e,t,r,n,a){"string"==typeof e?super(e,33,a||o.RR_DEFAULT_TTL_SHORT,n):((0,i.default)(33===e.type),super(e)),t.endsWith(".")?this.hostname=t:this.hostname=t+".",this.port=r,this.priority=0,this.weight=0}getLowerCasedHostname(){return this.lowerCasedHostname||(this.lowerCasedHostname=(0,n.dnsLowerCase)(this.hostname))}getRDataEncodingLength(e){return 6+(e.legacyUnicastEncoding?e.getUncompressedNameLength(this.hostname):e.getNameLength(this.hostname))}encodeRData(e,t,r){const i=r;t.writeUInt16BE(this.priority,r),r+=2,t.writeUInt16BE(this.weight,r),r+=2,t.writeUInt16BE(this.port,r),r+=2;return(r+=e.legacyUnicastEncoding?e.encodeUncompressedName(this.hostname,r):e.encodeName(this.hostname,r))-i}static decodeData(e,t,r,i){const n=i;i+=2,i+=2;const a=r.readUInt16BE(i);i+=2;const s=e.decodeName(i);return i+=s.readBytes,{data:new o(t,s.data,a),readBytes:i-n}}clone(){return new o(this.getRecordRepresentation(),this.hostname,this.port)}dataAsString(){return`${this.hostname} ${this.port} ${this.priority} ${this.weight}`}dataEquals(e){return this.getLowerCasedHostname()===e.getLowerCasedHostname()&&this.port===e.port&&this.weight===e.weight&&this.priority===e.priority}}t.SRVRecord=o,o.DEFAULT_TTL=120},1576:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TXTRecord=void 0;const i=r(1635).__importDefault(r(2613)),n=r(5231);class a extends n.ResourceRecord{constructor(e,t,r,n){"string"==typeof e?super(e,16,n,r):((0,i.default)(16===e.type),super(e)),this.txt=0===t.length?[Buffer.from([])]:t}getRDataEncodingLength(){let e=0;for(const t of this.txt)e+=1+t.length,(0,i.default)(t.length<=255,"One txt character-string can only have a length of 255 chars");return e}encodeRData(e,t,r){const i=r;for(const e of this.txt)t.writeUInt8(e.length,r++),e.copy(t,r),r+=e.length;return r-i}clone(){return new a(this.getRecordRepresentation(),this.txt)}dataAsString(){return`[${this.txt.map((e=>`${e.toString("base64")}`)).join(",")}]`}dataEquals(e){if(this.txt.length!==e.txt.length)return!1;for(let t=0;t<this.txt.length;t++)if(this.txt[t].toString("hex")!==e.txt[t].toString("hex"))return!1;return!0}static decodeData(e,t,r,i){const n=i,o=[];for(;i<r.length;){const e=r.readUInt8(i++);o.push(r.subarray(i,i+e)),i+=e}return{data:new a(t,o),readBytes:i-n}}}t.TXTRecord=a,a.DEFAULT_TTL=n.ResourceRecord.RR_DEFAULT_TTL},9577:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(5231),n=r(1360),a=r(4495),o=r(5102),s=r(6343),c=r(6141),u=r(482),l=r(8225),h=r(1576);i.ResourceRecord.typeToRecordDecoder.set(28,n.AAAARecord.decodeData),i.ResourceRecord.typeToRecordDecoder.set(1,a.ARecord.decodeData),i.ResourceRecord.typeToRecordDecoder.set(5,o.CNAMERecord.decodeData),i.ResourceRecord.typeToRecordDecoder.set(47,s.NSECRecord.decodeData),i.ResourceRecord.typeToRecordDecoder.set(12,u.PTRRecord.decodeData),i.ResourceRecord.typeToRecordDecoder.set(33,l.SRVRecord.decodeData),i.ResourceRecord.typeToRecordDecoder.set(41,c.OPTRecord.decodeData),i.ResourceRecord.typeToRecordDecoder.set(16,h.TXTRecord.decodeData)},8318:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getResponder=t.Protocol=void 0;const i=r(1635);r(3476);const n=i.__importDefault(r(5753)),a=r(3325).rE;if(a.includes("beta")||process.env.BCT){const e=process.env.DEBUG;e&&e.includes("ciao")||(e?n.default.enable(e+",ciao:*"):n.default.enable("ciao:*"))}r(9577);const o=r(4288);var s;function c(e){return o.Responder.getResponder(e)}i.__exportStar(r(141),t),i.__exportStar(r(4288),t),(0,n.default)("ciao:init")("Loading ciao v"+a+"..."),function(e){e.TCP="tcp",e.UDP="udp"}(s||(t.Protocol=s={})),t.getResponder=c,t.default={getResponder:c}},9983:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Announcer=void 0;const i=r(1635),n=i.__importDefault(r(2613)),a=i.__importDefault(r(5753)),o=r(4119),s=r(2361),c=r(8390),u=(0,a.default)("ciao:Announcer");class l{constructor(e,t,r){this.repetitions=1,this.announceIntervalIncreaseFactor=2,this.goodbye=!1,this.sentAnnouncements=0,this.sentLastAnnouncement=!1,this.nextInterval=1e3,this.nextAnnouncementTime=0,(0,n.default)(e,"server must be defined"),(0,n.default)(t,"service must be defined"),this.server=e,this.service=t,r&&(void 0!==r.repetitions&&(this.repetitions=r.repetitions),r.goodbye&&(this.goodbye=!0)),(0,n.default)(this.repetitions>0&&this.repetitions<=8,"repetitions must in [1;8]")}announce(){return u("[%s] Sending %s for service",this.service.getFQDN(),this.goodbye?"goodbye":"announcement"),this.goodbye||this.service.rebuildServiceRecords(),this.promise=new Promise(((e,t)=>{this.promiseResolve=e,this.promiseReject=t,this.timer=setTimeout(this.sendAnnouncement.bind(this),0),this.timer.unref(),this.nextAnnouncementTime=(new Date).getTime()}))}async cancel(){return u("[%s] Canceling %s",this.service.getFQDN(),this.goodbye?"goodbye":"announcement"),this.timer&&(clearTimeout(this.timer),this.timer=void 0),this.promiseReject(l.CANCEL_REASON),this.awaitAnnouncement().catch((e=>{if(e!==l.CANCEL_REASON)return Promise.reject(e)}))}hasSentLastAnnouncement(){return this.sentLastAnnouncement}async awaitAnnouncement(){await this.promise}isSendingGoodbye(){return this.goodbye}sendAnnouncement(){u("[%s] Sending %s number %d",this.service.getFQDN(),this.goodbye?"goodbye":"announcement",this.sentAnnouncements+1);const e=[this.service.ptrRecord(),...this.service.subtypePtrRecords(),this.service.srvRecord(),this.service.txtRecord()];if(this.goodbye)for(const t of e)t.ttl=0;else e.push(this.service.metaQueryPtrRecord());this.sentAnnouncements+1>=this.repetitions&&(this.sentLastAnnouncement=!0),l.sendResponseAddingAddressRecords(this.server,this.service,e,this.goodbye).then((e=>{const t=(0,s.SendResultFailedRatio)(e);if(1===t)return console.error((0,s.SendResultFormatError)(e,`[${this.service.getFQDN()}] Failed to send ${this.goodbye?"goodbye":"announcement"} requests`),!0),void this.promiseReject(new Error((this.goodbye?"Goodbye":"Announcement")+" failed as of socket errors!"));t>0&&u((0,s.SendResultFormatError)(e,`Some of the ${this.goodbye?"goodbye":"announcement"} requests for '${this.service.getFQDN()}' encountered an error`)),"announcing"===this.service.serviceState?(this.sentAnnouncements++,this.sentAnnouncements>=this.repetitions?this.promiseResolve():(this.timer=setTimeout(this.sendAnnouncement.bind(this),this.nextInterval),this.timer.unref(),this.nextAnnouncementTime=(new Date).getTime()+this.nextInterval,this.nextInterval*=this.announceIntervalIncreaseFactor)):u("[%s] Service is no longer in announcing state. Stopping. (Received %s)",this.service.getFQDN(),this.service.serviceState)}))}static sendResponseAddingAddressRecords(e,t,r,i){const n=[];for(const a of e.getBoundInterfaceNames()){if(!t.advertisesOnInterface(a))continue;const u=r.concat([]),l=t.aRecord(a),h=t.aaaaRecord(a),d=t.aaaaRoutableRecord(a),p=t.aaaaUniqueLocalRecord(a),f=t.addressNSECRecord(),v=t.serviceNSECRecord();l&&(i&&(l.ttl=0),u.push(l)),h&&(i&&(h.ttl=0),u.push(h)),d&&(i&&(d.ttl=0),u.push(d)),p&&(i&&(p.ttl=0),u.push(p)),i&&(f.ttl=0,v.ttl=0);const g=[];g.push(f,v);const m=o.DNSPacket.createDNSResponsePacketsFromRRSet({answers:u,additionals:g});n.push(Promise.race([e.send(m,a),(0,c.PromiseTimeout)(s.MDNSServer.SEND_TIMEOUT).then((()=>({status:"timeout",interface:a})))]))}return Promise.all(n)}}t.Announcer=l,l.CANCEL_REASON="CIAO ANNOUNCEMENT CANCELLED"},2475:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Prober=void 0;const i=r(1635),n=i.__importDefault(r(2613)),a=i.__importDefault(r(5753)),o=r(5682),s=r(2361),c=i.__importStar(r(6948)),u=r(6948),l=(0,a.default)("ciao:Prober");class h{constructor(e,t,r){this.records=[],this.currentInterval=250,this.serviceEncounteredNameChange=!1,this.sentFirstProbeQuery=!1,this.sentQueriesForCurrentTry=0,this.sentQueries=0,(0,n.default)(e,"responder must be defined"),(0,n.default)(t,"server must be defined"),(0,n.default)(r,"service must be defined"),this.responder=e,this.server=t,this.service=r}getService(){return this.service}probe(){return l("Starting to probe for '%s'...",this.service.getFQDN()),new Promise(((e,t)=>{this.promiseResolve=e,this.promiseReject=t,this.timer=setTimeout(this.sendProbeRequest.bind(this),250*Math.random()),this.timer.unref()}))}cancel(){this.clear(),this.promiseReject(h.CANCEL_REASON)}clear(){this.timer&&(clearTimeout(this.timer),this.timer=void 0),this.sentFirstProbeQuery=!1,this.sentQueriesForCurrentTry=0}endProbing(e){this.clear(),e&&(l("Probing for '%s' finished successfully",this.service.getFQDN()),this.promiseResolve(),this.serviceEncounteredNameChange&&this.service.informAboutNameUpdates())}sendProbeRequest(){if(0===this.sentQueriesForCurrentTry&&(this.records=[this.service.srvRecord(),this.service.txtRecord(),this.service.ptrRecord(),...this.service.subtypePtrRecords(),...this.service.allAddressRecords()].sort(u.rrComparator),this.records.forEach((e=>e.flushFlag=!1))),this.sentQueriesForCurrentTry>=3)return void this.endProbing(!0);this.sentQueries>=15&&(this.currentInterval=1e3),l("Sending prober query number %d for '%s'...",this.sentQueriesForCurrentTry+1,this.service.getFQDN()),(0,n.default)(this.records.length>0,"Tried sending probing request for zero record length!");const e=[new o.Question(this.service.getFQDN(),255,!0),new o.Question(this.service.getHostname(),255,!0)];this.server.sendQueryBroadcast({questions:e,authorities:this.records},this.service).then((e=>{const t=(0,s.SendResultFailedRatio)(e);if(1===t)return console.error((0,s.SendResultFormatError)(e,`Failed to send probe queries for '${this.service.getFQDN()}'`),!0),this.endProbing(!1),void this.promiseReject(new Error("Probing failed as of socket errors!"));t>0&&l((0,s.SendResultFormatError)(e,`Some of the probe queries for '${this.service.getFQDN()}' encountered an error`)),"probing"===this.service.serviceState?(this.sentFirstProbeQuery=!0,this.sentQueriesForCurrentTry++,this.sentQueries++,this.timer=setTimeout(this.sendProbeRequest.bind(this),this.currentInterval),this.timer.unref(),this.checkLocalConflicts()):l("Service '%s' is no longer in probing state. Stopping.",this.service.getFQDN())}))}checkLocalConflicts(){let e=!1;for(const t of this.responder.getAnnouncedServices())if(t.getLowerCasedFQDN()===this.service.getLowerCasedFQDN()||t.getLowerCasedHostname()===this.service.getLowerCasedHostname()){e=!0;break}e&&(l("Probing for '%s' failed as of local service. Doing a name change",this.service.getFQDN()),this.handleNameChange())}handleResponse(e,t){if(!this.sentFirstProbeQuery||!this.service.advertisesOnInterface(t.interface))return;let r=!1;for(const t of e.answers.values())if(t.getLowerCasedName()===this.service.getLowerCasedFQDN()||t.getLowerCasedName()===this.service.getLowerCasedHostname()){r=!0;break}for(const t of e.additionals.values())if(t.getLowerCasedName()===this.service.getLowerCasedFQDN()||t.getLowerCasedName()===this.service.getLowerCasedHostname()){r=!0;break}r&&(l("Probing for '%s' failed. Doing a name change",this.service.getFQDN()),this.handleNameChange())}handleNameChange(){this.endProbing(!1),this.service.serviceState="unannounced",this.service.incrementName(),this.service.serviceState="probing",this.serviceEncounteredNameChange=!0,this.timer=setTimeout(this.sendProbeRequest.bind(this),1e3),this.timer.unref()}handleQuery(e,t){if(!this.sentFirstProbeQuery||!this.service.advertisesOnInterface(t.interface))return;let r=!1;for(const t of e.questions.values())if(t.getLowerCasedName()===this.service.getLowerCasedFQDN()||t.getLowerCasedName()===this.service.getLowerCasedHostname()){r=!0;break}r&&this.doTiebreaking(e)}doTiebreaking(e){if(!this.sentFirstProbeQuery)return;let t=0===e.authorities.size;for(const r of e.authorities.values())if(r.getLowerCasedName()===this.service.getLowerCasedFQDN()||r.getLowerCasedName()===this.service.getLowerCasedHostname()){t=!0;break}if(!t)return;const r=this.records,i=Array.from(e.authorities.values()).sort(c.rrComparator),n=c.runTiebreaking(r,i);1===n?l("'%s' won the tiebreak. We gonna ignore the other probing request!",this.service.getFQDN()):-1===n&&(l("'%s' lost the tiebreak. We are waiting a second and try to probe again...",this.service.getFQDN()),this.endProbing(!1),this.timer=setTimeout(this.sendProbeRequest.bind(this),1e3),this.timer.unref())}}t.Prober=h,h.CANCEL_REASON="CIAO PROBING CANCELLED"},572:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueryResponse=void 0;const i=r(4119);t.QueryResponse=class{constructor(e){this.sharedAnswer=!1,this.dnsPacket=new i.DNSPacket({type:1}),this.knownAnswers=e}asPacket(){return this.dnsPacket}asString(e){return this.dnsPacket.asLoggingString(e)}containsSharedAnswer(){return this.sharedAnswer}addAnswer(...e){let t=!1;for(const r of e){if(this.isKnownAnswer(r))continue;this.dnsPacket.addAnswers(r)&&(t=!0,r.flushFlag||(this.sharedAnswer=!0))}return t}addAdditional(...e){let t=!1;for(const r of e){if(this.isKnownAnswer(r))continue;if(this.dnsPacket.answers.has(r.asString()))continue;this.dnsPacket.addAdditionals(r)&&(t=!0)}return t}markLegacyUnicastResponse(e,t){this.dnsPacket.id=e,t&&this.dnsPacket.addQuestions(...t),this.dnsPacket.answers.forEach((e=>{e.flushFlag=!1,e.ttl=10})),this.dnsPacket.additionals.forEach((e=>{e.flushFlag=!1,e.ttl=10})),this.dnsPacket.setLegacyUnicastEncoding(!0)}markTruncated(){this.dnsPacket.flags.truncation=!0}hasAnswers(){return this.dnsPacket.answers.size>0}isKnownAnswer(e){if(!this.knownAnswers)return!1;const t=this.knownAnswers.get(e.asString());return void 0!==t&&t.ttl>e.ttl/2}static combineResponses(e,t){for(let r=0;r<e.length-1;r++){const i=e[r],n=i.dnsPacket,a=e[r+1],o=a.dnsPacket;n.canBeCombinedWith(o,t)&&(n.combineWith(o),e.splice(r+1,1),i.sharedAnswer=i.sharedAnswer||a.sharedAnswer,r--)}}}},8126:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueuedResponse=void 0;class r{constructor(e,t){this.timeOfCreation=(new Date).getTime(),this.estimatedTimeToBeSent=0,this.delay=-1,this.packet=e,this.interfaceName=t}getPacket(){return this.packet}getTimeSinceCreation(){return(new Date).getTime()-this.timeOfCreation}getTimeTillSent(){return Math.max(0,this.estimatedTimeToBeSent-(new Date).getTime())}calculateRandomDelay(){this.delay=100*Math.random()+20,this.estimatedTimeToBeSent=(new Date).getTime()+this.delay}scheduleResponse(e){this.timer=setTimeout(e,this.delay),this.timer.unref()}delayWouldBeInTimelyManner(e){return e.estimatedTimeToBeSent-this.timeOfCreation<=r.MAX_DELAY}combineWithNextPacketIfPossible(e){return this.interfaceName===e.interfaceName&&(!!e.packet.canBeCombinedWith(this.packet)&&(e.packet.combineWith(this.packet),e.timeOfCreation=Math.min(this.timeOfCreation,e.timeOfCreation),this.timer&&(clearTimeout(this.timer),this.timer=void 0),this.delayed=!0,!0))}combineWithUniqueResponseIfPossible(e,t){return this.interfaceName===t&&(!!this.packet.canBeCombinedWith(e.asPacket())&&(this.packet.combineWith(e.asPacket()),!0))}}t.QueuedResponse=r,r.MAX_DELAY=500},341:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TruncatedQuery=t.TruncatedQueryEvent=t.TruncatedQueryResult=void 0;const i=r(4434);var n,a;!function(e){e[e.ABORT=1]="ABORT",e[e.AGAIN_TRUNCATED=2]="AGAIN_TRUNCATED",e[e.FINISHED=3]="FINISHED"}(n||(t.TruncatedQueryResult=n={})),function(e){e.TIMEOUT="timeout"}(a||(t.TruncatedQueryEvent=a={}));class o extends i.EventEmitter{constructor(e){super(),this.arrivedPackets=1,this.timeOfArrival=(new Date).getTime(),this.packet=e,this.timer=this.resetTimer()}getPacket(){return this.packet}getArrivedPacketCount(){return this.arrivedPackets}getTotalWaitTime(){return(new Date).getTime()-this.timeOfArrival}appendDNSPacket(e){if(this.packet.combineWith(e),this.arrivedPackets++,e.flags.truncation){return(new Date).getTime()-this.timeOfArrival>5e3?1:(this.resetTimer(),2)}return clearTimeout(this.timer),this.removeAllListeners(),3}resetTimer(){return this.timer&&clearTimeout(this.timer),this.timer=setTimeout(this.timeout.bind(this),400+100*Math.random())}timeout(){this.emit("timeout"),this.removeAllListeners()}}t.TruncatedQuery=o},7585:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dnsLowerCase=void 0;const r=/[A-Z]/g;t.dnsLowerCase=function(e){return e.replace(r,(e=>e.toLowerCase()))}},9152:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNetAddress=t.ipAddressFromReversAddressName=t.formatReverseAddressPTRName=t.shortenIPv6=t.enlargeIPv6=t.removeTLD=t.formatHostname=t.stringify=t.parseFQDN=void 0;const i=r(1635),n=i.__importDefault(r(2613)),a=i.__importDefault(r(9278));function o(e){return e.startsWith("_")?e.slice(1):e}function s(e){(0,n.default)(a.default.isIPv6(e),"Illegal argument. Must be ipv6 address!"),(0,n.default)(!e.includes("."),"ipv4-mapped ipv6 addresses are currently unsupported!");const t=e.split(":");if(""===t[0])for(t.splice(0,1);t.length<8;)t.unshift("0000");else if(""===t[t.length-1])for(t.splice(t.length-1,1);t.length<8;)t.push("0000");else if(t.length<8){let e;for(e=0;e<t.length&&""!==t[e];e++);const r=new Array(9-t.length).fill("0000");t.splice(e,1,...r)}for(let e=0;e<t.length;e++){const r=t[e];if(r.length<4){const i=new Array(4-r.length).fill("0").join("");t.splice(e,1,i+r)}}const r=t.join(":");return(0,n.default)(t.length<=8,`Resulting ipv6 address has more than 8 sections (${r})!`),r}function c(e){"string"==typeof e&&(e=e.split(":"));for(let t=0;t<e.length;t++){const r=e[t];let i=0;for(;i<Math.min(3,r.length-1)&&"0"===r.charAt(i);i++);e[t]=r.substr(i)}let t=-1,r=0;for(let i=0;i<e.length;i++){if("0"!==e[i])continue;let n=1,a=i+1;for(;a<e.length&&"0"===e[a];a++)n++;n>r&&(t=i,r=n),i=a}if(-1!==t){const i=0===t||t+r===8;e[t]=i?":":"",r>1&&e.splice(t+1,r-1)}const i=e.join(":");return":"===i?"::":i}t.parseFQDN=function(e){const t=e.split(".");(0,n.default)(t.length>=3,"Received illegal fqdn: "+e);let r=t.length-1,i="";for(;"_tcp"!==(a=t[r])&&"_udp"!==a;)i=o(t[r])+(i?"."+i:""),r--;var a;(0,n.default)(r>=1,"Failed to parse illegal fqdn: "+e);const s=o(t[r--]),c=o(t[r--]);if(r<0)return{domain:i,protocol:s,type:c};if(function(e){return"_sub"===e}(t[r])){r--,(0,n.default)(0===r,"Received illegal formatted sub type fqdn: "+e);return{domain:i,protocol:s,type:c,subtype:o(t[r])}}return{domain:i,protocol:s,type:c,name:o(t.slice(0,r+1).join("."))}},t.stringify=function(e){let t;return(0,n.default)(e.type,"type cannot be undefined"),(0,n.default)(e.type.length<=15,"type must not be longer than 15 characters"),t=function(e){return"subtype"in e}(e)?`_${e.subtype}._sub.`:e.name?`${e.name}.`:"",`${t}_${e.type}._${e.protocol||"tcp"}.${e.domain||"local"}.`},t.formatHostname=function(e,t="local"){(0,n.default)(!e.endsWith("."),"hostname must not end with the root label!");const r="."+t;return(e.endsWith(r)?e:e+r)+"."},t.removeTLD=function(e){e.endsWith(".")&&(e=e.substring(0,e.length-1));const t=e.lastIndexOf(".");return e.slice(0,t)},t.enlargeIPv6=s,t.shortenIPv6=c,t.formatReverseAddressPTRName=function(e){if(a.default.isIPv4(e)){return e.split(".").reverse().join(".")+".in-addr.arpa"}if(a.default.isIPv6(e)){const t=(e=s(e).toUpperCase()).replace(/:/g,"").split("").reverse();return(0,n.default)(32===t.length,"Encountered invalid ipv6 address length! "+t.length),t.join(".")+".ip6.arpa"}throw new Error("Supplied illegal ip address format: "+e)},t.ipAddressFromReversAddressName=function(e){if((e=e.toLowerCase()).endsWith(".in-addr.arpa")){return e.replace(".in-addr.arpa","").split(".").reverse().join(".")}if(e.endsWith(".ip6.arpa")){const t=e.replace(".ip6.arpa","").split(".").reverse();(0,n.default)(32===t.length,"Encountered illegal length for .ip6.arpa split!");const r=[];for(let e=0;e<t.length;e+=4)r.push(t.slice(e,e+4).join(""));return c(r.join(":"))}throw new Error("Supplied unknown reverse address name format: "+e)},t.getNetAddress=function(e,t){if((0,n.default)(a.default.isIP(e)===a.default.isIP(t),"IP address version must match. Netmask cannot have a version different from the address!"),a.default.isIPv4(e)){const r=e.split("."),i=t.split("."),n=new Array(4);for(let e=0;e<r.length;e++){const t=parseInt(r[e]),a=parseInt(i[e]);n[e]=(t&a).toString()}return n.join(".")}if(a.default.isIPv6(e)){const r=s(e).split(":"),i=s(t).split(":"),n=new Array(8);for(let e=0;e<r.length;e++){const t=parseInt(r[e],16),a=parseInt(i[e],16);n[e]=(t&a).toString(16)}return c(s(n.join(":")))}throw new Error("Illegal argument. Address is not an ip address!")}},16:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServerClosedError=t.InterfaceNotFoundError=t.ERR_SERVER_CLOSED=t.ERR_INTERFACE_NOT_FOUND=void 0,t.ERR_INTERFACE_NOT_FOUND="ERR_INTERFACE_NOT_FOUND",t.ERR_SERVER_CLOSED="ERR_SERVER_CLOSED";class r extends Error{constructor(e){super(e),this.name="ERR_INTERFACE_NOT_FOUND"}}t.InterfaceNotFoundError=r;class i extends Error{constructor(e){super(e),this.name=t.ERR_SERVER_CLOSED}}t.ServerClosedError=i},8390:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseTimeout=void 0,t.PromiseTimeout=function(e){return new Promise((t=>{setTimeout((()=>t()),e)}))}},5762:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sortedInsert=void 0,t.sortedInsert=function(e,t,r){let i=0,n=e.length-1,a=-1;for(;i<n;){const o=Math.floor((i+n)/2),s=r(t,e[o]);if(0===s){a=o+1;break}s<0?n=o-1:i=o+1}0===e.length?a=0:a<0&&(a=r(t,e[i])>0?i+1:i),e.splice(a,0,t)}},6948:(e,t)=>{"use strict";function r(e,t){if(e.class!==t.class)return e.class-t.class;if(e.type!==t.type)return e.type-t.type;const r=e.getRawData(),i=t.getRawData(),n=Math.max(r.length,i.length);for(let e=0;e<n;e++){if(e>=r.length&&e<i.length)return-1;if(e>=i.length&&e<r.length)return 1;const t=r.readUInt8(e),n=i.readUInt8(e);if(t!==n)return t<n?-1:1}return 0}var i;Object.defineProperty(t,"__esModule",{value:!0}),t.runTiebreaking=t.TiebreakingResult=t.rrComparator=void 0,t.rrComparator=r,function(e){e[e.OPPONENT=-1]="OPPONENT",e[e.TIE=0]="TIE",e[e.HOST=1]="HOST"}(i||(t.TiebreakingResult=i={})),t.runTiebreaking=function(e,t){const i=Math.max(e.length,t.length);for(let n=0;n<i;n++){if(n>=e.length&&n<t.length)return-1;if(n>=t.length&&n<e.length)return 1;const i=r(e[n],t[n]);if(0!==i)return i}return 0}},7019:(e,t,r)=>{const i=r(2613);e.exports=function e(){if(!(this instanceof e))return new e;var t=[],r=0;this.put=function(e){return t.push({buffer:e}),r+=e.length,this},this.word8=function(e){return t.push({bytes:1,value:e}),r+=1,this},this.floatle=function(e){return t.push({bytes:"float",endian:"little",value:e}),r+=4,this},[8,16,24,32,64].forEach(function(e){this["word"+e+"be"]=function(i){return t.push({endian:"big",bytes:e/8,value:i}),r+=e/8,this},this["word"+e+"le"]=function(i){return t.push({endian:"little",bytes:e/8,value:i}),r+=e/8,this}}.bind(this)),this.pad=function(e){return i(Number.isInteger(e),"pad(bytes) must be supplied with an integer!"),t.push({endian:"big",bytes:e,value:0}),r+=e,this},this.length=function(){return r},this.buffer=function(){var e=Buffer.alloc(r),i=0;return t.forEach((function(t){if(t.buffer)t.buffer.copy(e,i,0),i+=t.buffer.length;else if("float"===t.bytes){var r=Math.abs(t.value),n=1*(t.value>=0),a=Math.ceil(Math.log(r)/Math.LN2),o=r/(1<<a);console.dir([n,a,o]),console.log(t.value),e[i++]=n<<7&a/2,e[i++]=(1&a)<<7&o/65536,e[i++]=0,e[i++]=0,i+=4}else for(var s="big"===t.endian,c=s?[8*(t.bytes-1),-8]:[0,8],u=c[0];s?u>=0:u<8*t.bytes;u+=c[1])e[i++]=u>=32?255&Math.floor(t.value/Math.pow(2,u)):t.value>>u&255})),e},this.write=function(e){e.write(this.buffer())}}},9511:(e,t,r)=>{"use strict";var i=r(8075)("ArrayBuffer.prototype.byteLength",!0),n=r(4670);e.exports=function(e){return n(e)?i?i(e):e.byteLength:NaN}},3031:e=>{"use strict";function t(e){return i(e,[])}function r(e,t){if("number"!=typeof t)throw new TypeError("Expected the depth to be a number");return n(e,[],t)}function i(e,t){for(var r=0;r<e.length;r++){var n=e[r];Array.isArray(n)?i(n,t):t.push(n)}return t}function n(e,t,r){r--;for(var i=0;i<e.length;i++){var a=e[i];r>-1&&Array.isArray(a)?n(a,t,r):t.push(a)}return t}e.exports=function(e){if(!Array.isArray(e))throw new TypeError("Expected value to be an array");return t(e)},e.exports.from=t,e.exports.depth=function(e,t){if(!Array.isArray(e))throw new TypeError("Expected value to be an array");return r(e,t)},e.exports.fromDepth=r},8404:(e,t,r)=>{"use strict";const i=r(4033),n=r(8525),a=r(4060);function o(e){if(!(this instanceof o))return new o(e);this._server=new n(e),this._registry=new i(this._server)}o.prototype={publish:function(e){return this._registry.publish(e)},unpublishAll:function(e){this._registry.unpublishAll(e)},find:function(e,t){return new a(this._server.mdns,e,t)},findOne:function(e,t){const r=new a(this._server.mdns,e);return r.once("up",(function(e){r.stop(),t&&t(e)})),r},destroy:function(){this._registry.destroy(),this._server.mdns.destroy()}},e.exports=o},4060:(e,t,r)=>{"use strict";const i=r(9023),n=r(4434).EventEmitter,a=r(2781),o=r(6917),s=r(3272),c=".local",u="_services._dns-sd._udp"+c;function l(e,t,r){if("function"==typeof t)return new l(e,null,t);n.call(this),this._mdns=e,this._onresponse=null,this._serviceMap={},this._txt=s(t.txt),t&&t.type?(this._name=a.stringify(t.type,t.protocol||"tcp")+c,t.name&&(this._name=t.name+"."+this._name),this._wildcard=!1):(this._name=u,this._wildcard=!0),this.services=[],r&&this.on("up",r),this.start()}e.exports=l,i.inherits(l,n),l.prototype.start=function(){if(this._onresponse)return;const e=this,t={};this._wildcard||(t[this._name]=!0),this._onresponse=function(r,i){e._wildcard&&r.answers.forEach((function(r){"PTR"!==r.type||r.name!==e._name||r.name in t||(t[r.data]=!0,e._mdns.query(r.data,"PTR"))})),Object.keys(t).forEach((function(t){(function(e,t){return t.answers.concat(t.additionals).filter((function(t){return"PTR"===t.type&&0===t.ttl&&o(t.name,e)})).map((function(e){return e.data}))})(t,r).forEach(e._removeService.bind(e));const n=function(e,t,r,i){const n=t.answers.concat(t.additionals).filter((function(e){return e.ttl>0}));return n.filter((function(t){return"PTR"===t.type&&o(t.name,e)})).map((function(e){const t={addresses:[]};if(n.filter((function(t){return("SRV"===t.type||"TXT"===t.type)&&o(t.name,e.data)})).forEach((function(e){if("SRV"===e.type){const r=e.name.split("."),n=r[0],o=a.parse(r.slice(1,-1).join("."));t.name=n,t.fqdn=e.name,t.host=e.data.target,t.referer=i,t.port=e.data.port,t.type=o.name,t.protocol=o.protocol,t.subtypes=o.subtypes}else"TXT"===e.type&&(t.rawTxt=e.data,t.txt=r.decodeBlocks(t.rawTxt))})),t.name)return n.filter((function(e){return("A"===e.type||"AAAA"===e.type)&&o(e.name,t.host)})).forEach((function(e){t.addresses.push(e.data)})),t})).filter((function(e){return!!e}))}(t,r,e._txt,i);0!==n.length&&n.forEach((function(t){e._serviceMap[t.fqdn]?e._updateService(t):e._addService(t)}))}))},this._mdns.on("response",this._onresponse),this.update()},l.prototype.stop=function(){this._onresponse&&(this._mdns.removeListener("response",this._onresponse),this._onresponse=null)},l.prototype.update=function(){this._mdns.query(this._name,"PTR")},l.prototype._addService=function(e){this.services.push(e),this._serviceMap[e.fqdn]=!0,this.emit("up",e)},l.prototype._updateService=function(e){let t,r;this.services.some((function(i,n){return!!o(i.fqdn,e.fqdn)&&(t=i,r=n,!0)})),t&&(this.services[r]=e,this.emit("update",e))},l.prototype._removeService=function(e){let t,r;this.services.some((function(i,n){return!!o(i.fqdn,e)&&(t=i,r=n,!0)})),t&&(this.services.splice(r,1),delete this._serviceMap[e],this.emit("down",t))}},2754:(e,t,r)=>{"use strict";const i=r(6917),n=function(e,t,r){this.sent=!1,this.retries=0,this.timer=null,this.cb=r,this.mdns=e,this.service=t,this.bound=this.onMDNSresponse.bind(this),this.matchRRBound=this.matchRR.bind(this)};n.prototype={start:function(){this.mdns.on("response",this.bound),setTimeout(this.try.bind(this),250*Math.random())},try:function(){this.service._activated&&!this.service._destroyed&&this.mdns.query(this.service.fqdn,"ANY",function(){this.sent=!0,this.timer=setTimeout(++this.retries<3?this.try.bind(this):this.done.bind(this,!1),250),this.timer.unref()}.bind(this))},matchRR:function(e){return i(e.name,this.service.fqdn)},onMDNSresponse:function(e){this.sent&&(e.answers.some(this.matchRRBound)||e.additionals.some(this.matchRRBound))&&this.done(!0)},done:function(e){this.mdns.removeListener("response",this.bound),clearTimeout(this.timer),this.cb(e)}},e.exports=n},4033:(e,t,r)=>{"use strict";const i=r(3031),n=r(5259),a=r(2754),o=function(e){this._server=e,this._services=[]};o.prototype={publish:function(e){const t=new n(e=e||{});return t.on("service-publish",this._onServicePublish.bind(this)),t.on("service-unpublish",this._onServiceUnpublish.bind(this)),t.on("service-announce-request",this._onAnnounceRequest.bind(this)),t.on("service-packet-change",this._onServiceChange.bind(this)),t.start(),t},unpublishAll:function(e){this._tearDown(this._services,e),this._services=[]},destroy:function(){for(let e=0;e<this._services.length;e++)this._services[e].destroy()},_tearDown:function(e,t){Array.isArray(e)||(e=[e]),e=e.filter((function(e){return e._activated}));const r=i.depth(e.map((function(e){e.deactivate();const t=e._records(!0);return t.forEach((function(e){e.ttl=0})),t})),1);if(0===r.length)return t&&t();this._server.unregister(r),this._server.mdns.respond(r,this._onTearDownComplete.bind(this,e,t))},_onTearDownComplete:function(e,t){for(let t=0;t<e.length;t++)e[t].published=!1;t&&t.apply(null,Array.prototype.slice.call(arguments,2))},_onServiceChange:function(e){this._server.unregister(e)},_onAnnounceRequest:function(e,t,r){this._server.register(e),t||this._server.mdns.respond(e,r)},_onServiceUnpublish:function(e,t){const r=this._services.indexOf(e);this._tearDown(e,t),-1!==r&&this._services.splice(r,1)},_onServicePublish:function(e){this._services.push(e),e.probe?new a(this._server.mdns,e,this._onProbeComplete.bind(this,e)).start():e.announce()},_onProbeComplete:function(e,t){if(!t)return e.announce();e.stop(),e.emit("error",new Error("Service name is already in use on the network"))}},e.exports=o},8525:(e,t,r)=>{"use strict";const i=r(2567),n=r(6917),a=r(3031),o=r(3805),s=function(e){this.mdns=i(e),this.mdns.setMaxListeners(0),this.registry={},this.mdns.on("query",this._respondToQuery.bind(this))};s.prototype={_respondToQuery:function(e){for(let t=0;t<e.questions.length;t++){const r=e.questions[t],i=r.type,n=r.name,s="ANY"===i?a.depth(Object.keys(this.registry).map(this._recordsFor.bind(this,n)),1):this._recordsFor(n,i);if(0===s.length)return;let c=[];"ANY"!==i&&(s.forEach((e=>{"PTR"===e.type&&(c=c.concat(this._recordsFor(e.data,"SRV")).concat(this._recordsFor(e.data,"TXT")))})),c.filter((e=>"SRV"===e.type)).map((e=>e.data.target)).filter(o.unique()).forEach((e=>{c=c.concat(this._recordsFor(e,"A")).concat(this._recordsFor(e,"AAAA"))}))),this.mdns.respond({answers:s,additionals:c},(e=>{if(e)throw e}))}},register:function(e){Array.isArray(e)||(e=[e]);for(let t=0;t<e.length;t++){const r=e[t];let i=this.registry[r.type];if(i){if(i.some(o.isDuplicateRecord(r)))continue}else i=this.registry[r.type]=[];i.push(r)}},unregister:function(e){Array.isArray(e)||(e=[e]);for(let t=0;t<e.length;t++){const r=e[t],i=r.type;i in this.registry&&(this.registry[i]=this.registry[i].filter((e=>e.name!==r.name)))}},_recordsFor:function(e,t){return t in this.registry?this.registry[t].filter((t=>{const r=~e.indexOf(".")?t.name:t.name.split(".")[0];return n(r,e)})):[]}},e.exports=s},5259:(e,t,r)=>{"use strict";const i=r(857),n=r(9023),a=r(9278),o=r(2613),s=r(4434).EventEmitter,c=r(2781),u=r(6480),l=".local",h=function(e){if(!e.name)throw new Error("Required name not given");if(!e.type)throw new Error("Required type not given");if(!e.port)throw new Error("Required port not given");if(this.name=e.name,this.protocol=e.protocol||"tcp",this.probe=!1!==e.probe,this.type=c.stringify(e.type,this.protocol),this.host=e.host||i.hostname(),this.port=e.port,this.fqdn=this.name+"."+this.type+l,this.subtypes=e.subtypes||null,this.txt=e.txt||null,this.published=!1,this.addUnsafeServiceEnumerationRecord=e.addUnsafeServiceEnumerationRecord||!1,this.restrictedAddresses=void 0,e.restrictedAddresses){o(e.restrictedAddresses.length,"The service property 'restrictedAddresses' cannot be an empty array!"),this.restrictedAddresses=new Map;for(const t of e.restrictedAddresses)if(a.isIP(t)){if("0.0.0.0"===t||"::"===t)throw new Error(`[${this.fqdn}] Unspecified ip address (${t}) cannot be used to restrict on to!`);const e=u.resolveInterface(t);if(!e)throw new Error(`[${this.fqdn}] Could not restrict service to address ${t} as we could not resolve it to an interface name!`);const r=this.restrictedAddresses.get(e);r?r.length&&!r.includes(t)&&r.push(t):this.restrictedAddresses.set(e,[t])}else this.restrictedAddresses.set(t,[])}this.disabledIpv6=e.disabledIpv6||!1,this._activated=!1};n.inherits(h,s);const d={start:function(){this._activated||(this._activated=!0,this.emit("service-publish",this))},stop:function(e){this._activated?this.emit("service-unpublish",this,e):e()},updateTxt:function(e,t){this.packet&&this.emit("service-packet-change",this.packet,this.onAnnounceComplete.bind(this)),this.packet=null,this.txt=e,this.published&&(this._unpublish(),this.announce(t))},announce:function(e){this._destroyed||(this.packet||(this.packet=this._records()),this.timer&&clearTimeout(this.timer),this.delay=1e3,this.emit("service-announce-request",this.packet,e||!1,this.onAnnounceComplete.bind(this)))},onAnnounceComplete:function(){this.published||(this._activated=!0,this.published=!0,this.emit("up")),this.delay=3*this.delay,this.delay<36e5&&!this._destroyed&&this._activated?this.timer=setTimeout(this.announce.bind(this),this.delay).unref():(this.timer=void 0,this.delay=void 0)},deactivate:function(){this._unpublish(),this._activated=!1},destroy:function(){this._unpublish(),this.removeAllListeners(),this._destroyed=!0},_unpublish:function(){this.timer&&clearTimeout(this.timer),this.published=!1},_records:function(e){const t=[this._rrPtr(),this._rrSrv(),this._rrTxt()];return t.push(...this._addressRecords()),!e&&this.addUnsafeServiceEnumerationRecord&&t.push(this._rrMetaPtr()),t},_addressRecords:function(){const e=[],t=[];return Object.entries(i.networkInterfaces()).forEach((([r,i])=>{let n=this.restrictedAddresses?this.restrictedAddresses.get(r):void 0;this.restrictedAddresses&&!n||(n&&0===n.length&&(n=void 0),i.forEach((r=>{r.internal||t.includes(r.address)||n&&n.includes(r.address)||("IPv4"===r.family?(e.push(this._rrA(r.address)),t.push(r.address)):this.disabledIpv6||(e.push(this._rrAaaa(r.address)),t.push(r.address)))})))})),e},_rrMetaPtr:function(){return{name:"_services._dns-sd._udp.local",type:"PTR",ttl:4500,data:this.type+l}},_rrPtr:function(){return{name:this.type+l,type:"PTR",ttl:4500,data:this.fqdn}},_rrSrv:function(){return{name:this.fqdn,type:"SRV",ttl:120,flush:!0,data:{port:this.port,target:this.host}}},_rrTxt:function(){const e=[];if(this.txt){const t=this.txt;Object.keys(t).forEach((r=>{const i=t[r];e.push(r+"="+i)}))}return{name:this.fqdn,type:"TXT",ttl:4500,flush:!0,data:e}},_rrA:function(e){return{name:this.host,type:"A",ttl:120,flush:!0,data:e}},_rrAaaa:function(e){return{name:this.host,type:"AAAA",ttl:120,flush:!0,data:e}}};for(const e in d)h.prototype[e]=d[e];e.exports=h},3805:(e,t,r)=>{const i=r(4982);e.exports={isDuplicateRecord:function(e){return function(t){return e.type===t.type&&e.name===t.name&&i(e.data,t.data)}},unique:function(){const e=[];return function(t){return!~e.indexOf(t)&&(e.push(t),!0)}}}},6917:e=>{"use strict";const t=/[A-Z]/g;function r(e){return e.toLowerCase()}e.exports=function(e,i){return(e=e.replace(t,r))===(i=i.replace(t,r))}},6480:(e,t,r)=>{const i=r(857);e.exports={resolveInterface:function(e){for(const[t,r]of Object.entries(i.networkInterfaces()))for(const i of r)if(i.address===e)return t}}},3272:e=>{"use strict";const t=Buffer.from("=");e.exports=function(e){const r=!!e&&e.binary,i={decodeBlocks:function(e){const i={};return e.forEach((e=>{if(0===e.length)return;const n=e.indexOf(t);if(-1===n)i[e.toString().toLowerCase()]=!0;else if(n>0){const t=e.slice(0,n).toString().toLowerCase();if(t in i)return;const a=e.slice(n+1);i[t]=r?a:a.toString()}})),i}};return i}},2746:e=>{var t=Object.prototype.toString,r="undefined"!=typeof Buffer&&"function"==typeof Buffer.alloc&&"function"==typeof Buffer.allocUnsafe&&"function"==typeof Buffer.from;e.exports=function(e,i,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return a=e,"ArrayBuffer"===t.call(a).slice(8,-1)?function(e,t,i){t>>>=0;var n=e.byteLength-t;if(n<0)throw new RangeError("'offset' is out of bounds");if(void 0===i)i=n;else if((i>>>=0)>n)throw new RangeError("'length' is out of bounds");return r?Buffer.from(e.slice(t,t+i)):new Buffer(new Uint8Array(e.slice(t,t+i)))}(e,i,n):"string"==typeof e?function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!Buffer.isEncoding(t))throw new TypeError('"encoding" must be a valid string encoding');return r?Buffer.from(e,t):new Buffer(e,t)}(e,i):r?Buffer.from(e):new Buffer(e);var a}},8075:(e,t,r)=>{"use strict";var i=r(453),n=r(487),a=n(i("String.prototype.indexOf"));e.exports=function(e,t){var r=i(e,!!t);return"function"==typeof r&&a(e,".prototype.")>-1?n(r):r}},487:(e,t,r)=>{"use strict";var i=r(6743),n=r(453),a=r(6897),o=r(9675),s=n("%Function.prototype.apply%"),c=n("%Function.prototype.call%"),u=n("%Reflect.apply%",!0)||i.call(c,s),l=r(655),h=n("%Math.max%");e.exports=function(e){if("function"!=typeof e)throw new o("a function is required");var t=u(i,c,arguments);return a(t,1+h(0,e.length-(arguments.length-1)),!0)};var d=function(){return u(i,s,arguments)};l?l(e.exports,"apply",{value:d}):e.exports.apply=d},7833:(e,t,r)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let i=0,n=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(i++,"%c"===e&&(n=i))})),t.splice(n,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(736)(t);const{formatters:i}=e.exports;i.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},736:(e,t,r)=>{e.exports=function(e){function t(e){let r,n,a,o=null;function s(...e){if(!s.enabled)return;const i=s,n=Number(new Date),a=n-(r||n);i.diff=a,i.prev=r,i.curr=n,r=n,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,n)=>{if("%%"===r)return"%";o++;const a=t.formatters[n];if("function"==typeof a){const t=e[o];r=a.call(i,t),e.splice(o,1),o--}return r})),t.formatArgs.call(i,e);(i.log||t.log).apply(i,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=i,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(n!==t.namespaces&&(n=t.namespaces,a=t.enabled(e)),a),set:e=>{o=e}}),"function"==typeof t.init&&t.init(s),s}function i(e,r){const i=t(this.namespace+(void 0===r?":":r)+e);return i.log=this.log,i}function n(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(n),...t.skips.map(n).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const i=("string"==typeof e?e:"").split(/[\s,]+/),n=i.length;for(r=0;r<n;r++)i[r]&&("-"===(e=i[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,i;for(r=0,i=t.skips.length;r<i;r++)if(t.skips[r].test(e))return!1;for(r=0,i=t.names.length;r<i;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(6585),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},5753:(e,t,r)=>{"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=r(7833):e.exports=r(6033)},6033:(e,t,r)=>{const i=r(2018),n=r(9023);t.init=function(e){e.inspectOpts={};const r=Object.keys(t.inspectOpts);for(let i=0;i<r.length;i++)e.inspectOpts[r[i]]=t.inspectOpts[r[i]]},t.log=function(...e){return process.stderr.write(n.format(...e)+"\n")},t.formatArgs=function(r){const{namespace:i,useColors:n}=this;if(n){const t=this.color,n="[3"+(t<8?t:"8;5;"+t),a=`  ${n};1m${i} [0m`;r[0]=a+r[0].split("\n").join("\n"+a),r.push(n+"m+"+e.exports.humanize(this.diff)+"[0m")}else r[0]=function(){if(t.inspectOpts.hideDate)return"";return(new Date).toISOString()+" "}()+i+" "+r[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):i.isatty(process.stderr.fd)},t.destroy=n.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{const e=r(7687);e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter((e=>/^debug_/i.test(e))).reduce(((e,t)=>{const r=t.substring(6).toLowerCase().replace(/_([a-z])/g,((e,t)=>t.toUpperCase()));let i=process.env[t];return i=!!/^(yes|on|true|enabled)$/i.test(i)||!/^(no|off|false|disabled)$/i.test(i)&&("null"===i?null:Number(i)),e[r]=i,e}),{}),e.exports=r(736)(t);const{formatters:a}=e.exports;a.o=function(e){return this.inspectOpts.colors=this.useColors,n.inspect(e,this.inspectOpts).split("\n").map((e=>e.trim())).join(" ")},a.O=function(e){return this.inspectOpts.colors=this.useColors,n.inspect(e,this.inspectOpts)}},4982:(e,t,r)=>{"use strict";var i=r(6525),n=r(8075),a=r(1589),o=r(453),s=r(1158),c=r(920),u=r(7653),l=r(7244),h=r(4634),d=r(4670),p=r(2120),f=r(4035),v=r(7070),g=r(1189),m=r(1539),y=r(593),C=r(5767),S=r(9511),E=n("SharedArrayBuffer.prototype.byteLength",!0),_=n("Date.prototype.getTime"),T=Object.getPrototypeOf,A=n("Object.prototype.toString"),I=o("%Set%",!0),D=n("Map.prototype.has",!0),w=n("Map.prototype.get",!0),b=n("Map.prototype.size",!0),U=n("Set.prototype.add",!0),R=n("Set.prototype.delete",!0),O=n("Set.prototype.has",!0),N=n("Set.prototype.size",!0);function P(e,t,r,i){for(var n,a=s(e);(n=a.next())&&!n.done;)if(F(t,n.value,r,i))return R(e,n.value),!0;return!1}function B(e){return void 0===e?null:"object"!=typeof e?"symbol"!=typeof e&&("string"!=typeof e&&"number"!=typeof e||+e==+e):void 0}function L(e,t,r,n,a,o){var s=B(r);if(null!=s)return s;var c=w(t,s),u=i({},a,{strict:!1});return!(void 0===c&&!D(t,s)||!F(n,c,u,o))&&(!D(e,s)&&F(n,c,u,o))}function x(e,t,r){var i=B(r);return null!=i?i:O(t,i)&&!O(e,i)}function M(e,t,r,i,n,a){for(var o,c,u=s(e);(o=u.next())&&!o.done;)if(F(r,c=o.value,n,a)&&F(i,w(t,c),n,a))return R(e,c),!0;return!1}function F(e,t,r,n){var o=r||{};if(o.strict?u(e,t):e===t)return!0;if(m(e)!==m(t))return!1;if(!e||!t||"object"!=typeof e&&"object"!=typeof t)return o.strict?u(e,t):e==t;var c,R=n.has(e),B=n.has(t);if(R&&B){if(n.get(e)===n.get(t))return!0}else c={};return R||n.set(e,c),B||n.set(t,c),function(e,t,r,n){var o,c;if(typeof e!=typeof t)return!1;if(null==e||null==t)return!1;if(A(e)!==A(t))return!1;if(l(e)!==l(t))return!1;var u=h(e),m=h(t);if(u!==m)return!1;var R=e instanceof Error,B=t instanceof Error;if(R!==B)return!1;if((R||B)&&(e.name!==t.name||e.message!==t.message))return!1;var V=f(e),H=f(t);if(V!==H)return!1;if((V||H)&&(e.source!==t.source||a(e)!==a(t)))return!1;var j=p(e),G=p(t);if(j!==G)return!1;if((j||G)&&_(e)!==_(t))return!1;if(r.strict&&T&&T(e)!==T(t))return!1;var W=C(e),Y=C(t);if(W!==Y)return!1;if(W||Y){if(e.length!==t.length)return!1;for(o=0;o<e.length;o++)if(e[o]!==t[o])return!1;return!0}var q=k(e),K=k(t);if(q!==K)return!1;if(q||K){if(e.length!==t.length)return!1;for(o=0;o<e.length;o++)if(e[o]!==t[o])return!1;return!0}var $=d(e),z=d(t);if($!==z)return!1;if($||z)return S(e)===S(t)&&("function"==typeof Uint8Array&&F(new Uint8Array(e),new Uint8Array(t),r,n));var Q=v(e),X=v(t);if(Q!==X)return!1;if(Q||X)return E(e)===E(t)&&("function"==typeof Uint8Array&&F(new Uint8Array(e),new Uint8Array(t),r,n));if(typeof e!=typeof t)return!1;var J=g(e),Z=g(t);if(J.length!==Z.length)return!1;for(J.sort(),Z.sort(),o=J.length-1;o>=0;o--)if(J[o]!=Z[o])return!1;for(o=J.length-1;o>=0;o--)if(!F(e[c=J[o]],t[c],r,n))return!1;var ee=y(e),te=y(t);if(ee!==te)return!1;if("Set"===ee||"Set"===te)return function(e,t,r,i){if(N(e)!==N(t))return!1;var n,a,o,c=s(e),u=s(t);for(;(n=c.next())&&!n.done;)if(n.value&&"object"==typeof n.value)o||(o=new I),U(o,n.value);else if(!O(t,n.value)){if(r.strict)return!1;if(!x(e,t,n.value))return!1;o||(o=new I),U(o,n.value)}if(o){for(;(a=u.next())&&!a.done;)if(a.value&&"object"==typeof a.value){if(!P(o,a.value,r.strict,i))return!1}else if(!r.strict&&!O(e,a.value)&&!P(o,a.value,r.strict,i))return!1;return 0===N(o)}return!0}(e,t,r,n);if("Map"===ee)return function(e,t,r,n){if(b(e)!==b(t))return!1;var a,o,c,u,l,h,d=s(e),p=s(t);for(;(a=d.next())&&!a.done;)if(u=a.value[0],l=a.value[1],u&&"object"==typeof u)c||(c=new I),U(c,u);else if(void 0===(h=w(t,u))&&!D(t,u)||!F(l,h,r,n)){if(r.strict)return!1;if(!L(e,t,u,l,r,n))return!1;c||(c=new I),U(c,u)}if(c){for(;(o=p.next())&&!o.done;)if(u=o.value[0],h=o.value[1],u&&"object"==typeof u){if(!M(c,e,u,h,r,n))return!1}else if(!(r.strict||e.has(u)&&F(w(e,u),h,r,n)||M(c,e,u,h,i({},r,{strict:!1}),n)))return!1;return 0===N(c)}return!0}(e,t,r,n);return!0}(e,t,o,n)}function k(e){return!(!e||"object"!=typeof e||"number"!=typeof e.length)&&("function"==typeof e.copy&&"function"==typeof e.slice&&(!(e.length>0&&"number"!=typeof e[0])&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))))}e.exports=function(e,t,r){return F(e,t,r,c())}},41:(e,t,r)=>{"use strict";var i=r(655),n=r(8068),a=r(9675),o=r(5795);e.exports=function(e,t,r){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new a("`obj` must be an object or a function`");if("string"!=typeof t&&"symbol"!=typeof t)throw new a("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new a("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new a("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new a("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!=typeof arguments[6])throw new a("`loose`, if provided, must be a boolean");var s=arguments.length>3?arguments[3]:null,c=arguments.length>4?arguments[4]:null,u=arguments.length>5?arguments[5]:null,l=arguments.length>6&&arguments[6],h=!!o&&o(e,t);if(i)i(e,t,{configurable:null===u&&h?h.configurable:!u,enumerable:null===s&&h?h.enumerable:!s,value:r,writable:null===c&&h?h.writable:!c});else{if(!l&&(s||c||u))throw new n("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");e[t]=r}}},8452:(e,t,r)=>{"use strict";var i=r(1189),n="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),a=Object.prototype.toString,o=Array.prototype.concat,s=r(41),c=r(592)(),u=function(e,t,r,i){if(t in e)if(!0===i){if(e[t]===r)return}else if("function"!=typeof(n=i)||"[object Function]"!==a.call(n)||!i())return;var n;c?s(e,t,r,!0):s(e,t,r)},l=function(e,t){var r=arguments.length>2?arguments[2]:{},a=i(t);n&&(a=o.call(a,Object.getOwnPropertySymbols(t)));for(var s=0;s<a.length;s+=1)u(e,a[s],t[a[s]],r[a[s]])};l.supportsDescriptors=!!c,e.exports=l},4731:(e,t)=>{"use strict";t.toString=function(e){switch(e){case 1:return"IN";case 2:return"CS";case 3:return"CH";case 4:return"HS";case 255:return"ANY"}return"UNKNOWN_"+e},t.toClass=function(e){switch(e.toUpperCase()){case"IN":return 1;case"CS":return 2;case"CH":return 3;case"HS":return 4;case"ANY":return 255}return 0}},3843:(e,t,r)=>{"use strict";const i=r(181).Buffer,n=r(834),a=r(2111),o=r(628),s=r(4731),c=r(5874),u=r(26),l=32768,h=t.name={};h.encode=function(e,t,r,{mail:n=!1}={}){t||(t=i.alloc(h.encodingLength(e))),r||(r=0);const a=r,o=e.replace(/^\.|\.$/gm,"");if(o.length){let e=[];if(n){let t="";o.split(".").forEach((r=>{r.endsWith("\\")?t+=(t.length?".":"")+r.slice(0,-1):0===e.length&&t.length?e.push(t+"."+r):e.push(r)}))}else e=o.split(".");for(let i=0;i<e.length;i++){const n=t.write(e[i],r+1);t[r]=n,r+=n+1}}return t[r++]=0,h.encode.bytes=r-a,t},h.encode.bytes=0,h.decode=function(e,t,{mail:r=!1}={}){t||(t=0);const i=[];let n=t,a=0,o=0,s=!1;for(;;){if(t>=e.length)throw new Error("Cannot decode name (buffer overflow)");const c=e[t++];if(o+=s?0:1,0===c)break;if(192&c){if(192&~c)throw new Error("Cannot decode name (bad label)");{if(t+1>e.length)throw new Error("Cannot decode name (buffer overflow)");const r=e.readUInt16BE(t-1)-49152;if(r>=n)throw new Error("Cannot decode name (bad pointer)");t=r,n=r,o+=s?0:1,s=!0}}else{if(t+c>e.length)throw new Error("Cannot decode name (buffer overflow)");if(a+=c+1,a>254)throw new Error("Cannot decode name (name too long)");let n=e.toString("utf-8",t,t+c);r&&(n=n.replace(/\./g,"\\.")),i.push(n),t+=c,o+=s?0:c}}return h.decode.bytes=o,0===i.length?".":i.join(".")},h.decode.bytes=0,h.encodingLength=function(e){return"."===e||".."===e?1:i.byteLength(e.replace(/^\.|\.$/gm,""))+2};const d={encode:function(e,t,r){t||(t=i.alloc(d.encodingLength(e))),r||(r=0);const n=t.write(e,r+1);return t[r]=n,d.encode.bytes=n+1,t}};d.encode.bytes=0,d.decode=function(e,t){t||(t=0);const r=e[t],i=e.toString("utf-8",t+1,t+1+r);return d.decode.bytes=r+1,i},d.decode.bytes=0,d.encodingLength=function(e){return i.byteLength(e)+1};const p={encode:function(e,t,r){t||(t=p.encodingLength(e)),r||(r=0);const i=32767&(e.flags||0),n="response"===e.type?32768:0;return t.writeUInt16BE(e.id||0,r),t.writeUInt16BE(i|n,r+2),t.writeUInt16BE(e.questions.length,r+4),t.writeUInt16BE(e.answers.length,r+6),t.writeUInt16BE(e.authorities.length,r+8),t.writeUInt16BE(e.additionals.length,r+10),t}};p.encode.bytes=12,p.decode=function(e,t){if(t||(t=0),e.length<12)throw new Error("Header must be 12 bytes");const r=e.readUInt16BE(t+2);return{id:e.readUInt16BE(t),type:32768&r?"response":"query",flags:32767&r,flag_qr:1==(r>>15&1),opcode:o.toString(r>>11&15),flag_aa:1==(r>>10&1),flag_tc:1==(r>>9&1),flag_rd:1==(r>>8&1),flag_ra:1==(r>>7&1),flag_z:1==(r>>6&1),flag_ad:1==(r>>5&1),flag_cd:1==(r>>4&1),rcode:a.toString(15&r),questions:new Array(e.readUInt16BE(t+4)),answers:new Array(e.readUInt16BE(t+6)),authorities:new Array(e.readUInt16BE(t+8)),additionals:new Array(e.readUInt16BE(t+10))}},p.decode.bytes=12,p.encodingLength=function(){return 12};const f=t.unknown={};f.encode=function(e,t,r){return t||(t=i.alloc(f.encodingLength(e))),r||(r=0),t.writeUInt16BE(e.length,r),e.copy(t,r+2),f.encode.bytes=e.length+2,t},f.encode.bytes=0,f.decode=function(e,t){t||(t=0);const r=e.readUInt16BE(t),i=e.slice(t+2,t+2+r);return f.decode.bytes=r+2,i},f.decode.bytes=0,f.encodingLength=function(e){return e.length+2};const v=t.ns={};v.encode=function(e,t,r){return t||(t=i.alloc(v.encodingLength(e))),r||(r=0),h.encode(e,t,r+2),t.writeUInt16BE(h.encode.bytes,r),v.encode.bytes=h.encode.bytes+2,t},v.encode.bytes=0,v.decode=function(e,t){t||(t=0);const r=e.readUInt16BE(t),i=h.decode(e,t+2);return v.decode.bytes=r+2,i},v.decode.bytes=0,v.encodingLength=function(e){return h.encodingLength(e)+2};const g=t.soa={};g.encode=function(e,t,r){t||(t=i.alloc(g.encodingLength(e))),r||(r=0);const n=r;return r+=2,h.encode(e.mname,t,r),r+=h.encode.bytes,h.encode(e.rname,t,r,{mail:!0}),r+=h.encode.bytes,t.writeUInt32BE(e.serial||0,r),r+=4,t.writeUInt32BE(e.refresh||0,r),r+=4,t.writeUInt32BE(e.retry||0,r),r+=4,t.writeUInt32BE(e.expire||0,r),r+=4,t.writeUInt32BE(e.minimum||0,r),r+=4,t.writeUInt16BE(r-n-2,n),g.encode.bytes=r-n,t},g.encode.bytes=0,g.decode=function(e,t){t||(t=0);const r=t,i={};return t+=2,i.mname=h.decode(e,t),t+=h.decode.bytes,i.rname=h.decode(e,t,{mail:!0}),t+=h.decode.bytes,i.serial=e.readUInt32BE(t),t+=4,i.refresh=e.readUInt32BE(t),t+=4,i.retry=e.readUInt32BE(t),t+=4,i.expire=e.readUInt32BE(t),t+=4,i.minimum=e.readUInt32BE(t),t+=4,g.decode.bytes=t-r,i},g.decode.bytes=0,g.encodingLength=function(e){return 22+h.encodingLength(e.mname)+h.encodingLength(e.rname)};const m=t.txt={};m.encode=function(e,t,r){Array.isArray(e)||(e=[e]);for(let t=0;t<e.length;t++)if("string"==typeof e[t]&&(e[t]=i.from(e[t])),!i.isBuffer(e[t]))throw new Error("Must be a Buffer");t||(t=i.alloc(m.encodingLength(e))),r||(r=0);const n=r;return r+=2,e.forEach((function(e){t[r++]=e.length,e.copy(t,r,0,e.length),r+=e.length})),t.writeUInt16BE(r-n-2,n),m.encode.bytes=r-n,t},m.encode.bytes=0,m.decode=function(e,t){t||(t=0);const r=t;let i=e.readUInt16BE(t);t+=2;let n=[];for(;i>0;){const r=e[t++];if(--i,i<r)throw new Error("Buffer overflow");n.push(e.slice(t,t+r)),t+=r,i-=r}return m.decode.bytes=t-r,n},m.decode.bytes=0,m.encodingLength=function(e){Array.isArray(e)||(e=[e]);let t=2;return e.forEach((function(e){t+="string"==typeof e?i.byteLength(e)+1:e.length+1})),t};const y=t.null={};y.encode=function(e,t,r){t||(t=i.alloc(y.encodingLength(e))),r||(r=0),"string"==typeof e&&(e=i.from(e)),e||(e=i.alloc(0));const n=r;r+=2;const a=e.length;return e.copy(t,r,0,a),r+=a,t.writeUInt16BE(r-n-2,n),y.encode.bytes=r-n,t},y.encode.bytes=0,y.decode=function(e,t){t||(t=0);const r=t,i=e.readUInt16BE(t);t+=2;const n=e.slice(t,t+i);return t+=i,y.decode.bytes=t-r,n},y.decode.bytes=0,y.encodingLength=function(e){return e?(i.isBuffer(e)?e.length:i.byteLength(e))+2:2};const C=t.hinfo={};C.encode=function(e,t,r){t||(t=i.alloc(C.encodingLength(e))),r||(r=0);const n=r;return r+=2,d.encode(e.cpu,t,r),r+=d.encode.bytes,d.encode(e.os,t,r),r+=d.encode.bytes,t.writeUInt16BE(r-n-2,n),C.encode.bytes=r-n,t},C.encode.bytes=0,C.decode=function(e,t){t||(t=0);const r=t,i={};return t+=2,i.cpu=d.decode(e,t),t+=d.decode.bytes,i.os=d.decode(e,t),t+=d.decode.bytes,C.decode.bytes=t-r,i},C.decode.bytes=0,C.encodingLength=function(e){return d.encodingLength(e.cpu)+d.encodingLength(e.os)+2};const S=t.ptr={},E=t.cname=S,_=t.dname=S;S.encode=function(e,t,r){return t||(t=i.alloc(S.encodingLength(e))),r||(r=0),h.encode(e,t,r+2),t.writeUInt16BE(h.encode.bytes,r),S.encode.bytes=h.encode.bytes+2,t},S.encode.bytes=0,S.decode=function(e,t){t||(t=0);const r=h.decode(e,t+2);return S.decode.bytes=h.decode.bytes+2,r},S.decode.bytes=0,S.encodingLength=function(e){return h.encodingLength(e)+2};const T=t.srv={};T.encode=function(e,t,r){t||(t=i.alloc(T.encodingLength(e))),r||(r=0),t.writeUInt16BE(e.priority||0,r+2),t.writeUInt16BE(e.weight||0,r+4),t.writeUInt16BE(e.port||0,r+6),h.encode(e.target,t,r+8);const n=h.encode.bytes+6;return t.writeUInt16BE(n,r),T.encode.bytes=n+2,t},T.encode.bytes=0,T.decode=function(e,t){t||(t=0);const r=e.readUInt16BE(t),i={};return i.priority=e.readUInt16BE(t+2),i.weight=e.readUInt16BE(t+4),i.port=e.readUInt16BE(t+6),i.target=h.decode(e,t+8),T.decode.bytes=r+2,i},T.decode.bytes=0,T.encodingLength=function(e){return 8+h.encodingLength(e.target)};const A=t.caa={};A.ISSUER_CRITICAL=128,A.encode=function(e,t,r){const n=A.encodingLength(e);return t||(t=i.alloc(A.encodingLength(e))),r||(r=0),e.issuerCritical&&(e.flags=A.ISSUER_CRITICAL),t.writeUInt16BE(n-2,r),r+=2,t.writeUInt8(e.flags||0,r),r+=1,d.encode(e.tag,t,r),r+=d.encode.bytes,t.write(e.value,r),r+=i.byteLength(e.value),A.encode.bytes=n,t},A.encode.bytes=0,A.decode=function(e,t){t||(t=0);const r=e.readUInt16BE(t),i=t+=2,n={};return n.flags=e.readUInt8(t),t+=1,n.tag=d.decode(e,t),t+=d.decode.bytes,n.value=e.toString("utf-8",t,i+r),n.issuerCritical=!!(n.flags&A.ISSUER_CRITICAL),A.decode.bytes=r+2,n},A.decode.bytes=0,A.encodingLength=function(e){return d.encodingLength(e.tag)+d.encodingLength(e.value)+2};const I=t.mx={};I.encode=function(e,t,r){t||(t=i.alloc(I.encodingLength(e))),r||(r=0);const n=r;return r+=2,t.writeUInt16BE(e.preference||0,r),r+=2,h.encode(e.exchange,t,r),r+=h.encode.bytes,t.writeUInt16BE(r-n-2,n),I.encode.bytes=r-n,t},I.encode.bytes=0,I.decode=function(e,t){t||(t=0);const r=t,i={};return t+=2,i.preference=e.readUInt16BE(t),t+=2,i.exchange=h.decode(e,t),t+=h.decode.bytes,I.decode.bytes=t-r,i},I.encodingLength=function(e){return 4+h.encodingLength(e.exchange)};const D=t.a={};D.encode=function(e,t,r){return t||(t=i.alloc(D.encodingLength(e))),r||(r=0),t.writeUInt16BE(4,r),r+=2,u.v4.encode(e,t,r),D.encode.bytes=6,t},D.encode.bytes=0,D.decode=function(e,t){t||(t=0),t+=2;const r=u.v4.decode(e,t);return D.decode.bytes=6,r},D.decode.bytes=0,D.encodingLength=function(){return 6};const w=t.aaaa={};w.encode=function(e,t,r){return t||(t=i.alloc(w.encodingLength(e))),r||(r=0),t.writeUInt16BE(16,r),r+=2,u.v6.encode(e,t,r),w.encode.bytes=18,t},w.encode.bytes=0,w.decode=function(e,t){t||(t=0),t+=2;const r=u.v6.decode(e,t);return w.decode.bytes=18,r},w.decode.bytes=0,w.encodingLength=function(){return 18};const b=t.option={};b.encode=function(e,t,r){t||(t=i.alloc(b.encodingLength(e))),r||(r=0);const n=r,a=c.toCode(e.code);if(t.writeUInt16BE(a,r),r+=2,e.data)t.writeUInt16BE(e.data.length,r),r+=2,e.data.copy(t,r),r+=e.data.length;else switch(a){case 8:const n=e.sourcePrefixLength||0,a=e.family||u.familyOf(e.ip),o=u.encode(e.ip,i.alloc),s=Math.ceil(n/8);t.writeUInt16BE(s+4,r),r+=2,t.writeUInt16BE(a,r),r+=2,t.writeUInt8(n,r++),t.writeUInt8(e.scopePrefixLength||0,r++),o.copy(t,r,0,s),r+=s;break;case 11:e.timeout?(t.writeUInt16BE(2,r),r+=2,t.writeUInt16BE(e.timeout,r),r+=2):(t.writeUInt16BE(0,r),r+=2);break;case 12:const c=e.length||0;t.writeUInt16BE(c,r),r+=2,t.fill(0,r,r+c),r+=c;break;case 14:const l=2*e.tags.length;t.writeUInt16BE(l,r),r+=2;for(const i of e.tags)t.writeUInt16BE(i,r),r+=2;break;default:throw new Error(`Unknown roption code: ${e.code}`)}return b.encode.bytes=r-n,t},b.encode.bytes=0,b.decode=function(e,t){t||(t=0);const r={};r.code=e.readUInt16BE(t),r.type=c.toString(r.code),t+=2;const n=e.readUInt16BE(t);switch(t+=2,r.data=e.slice(t,t+n),r.code){case 8:r.family=e.readUInt16BE(t),t+=2,r.sourcePrefixLength=e.readUInt8(t++),r.scopePrefixLength=e.readUInt8(t++);const a=i.alloc(1===r.family?4:16);e.copy(a,0,t,t+n-4),r.ip=u.decode(a);break;case 11:n>0&&(r.timeout=e.readUInt16BE(t),t+=2);break;case 14:r.tags=[];for(let i=0;i<n;i+=2)r.tags.push(e.readUInt16BE(t)),t+=2}return b.decode.bytes=n+4,r},b.decode.bytes=0,b.encodingLength=function(e){if(e.data)return e.data.length+4;switch(c.toCode(e.code)){case 8:const t=e.sourcePrefixLength||0;return Math.ceil(t/8)+8;case 11:return"number"==typeof e.timeout?6:4;case 12:return e.length+4;case 14:return 4+2*e.tags.length}throw new Error(`Unknown roption code: ${e.code}`)};const U=t.opt={};U.encode=function(e,t,r){t||(t=i.alloc(U.encodingLength(e))),r||(r=0);const n=r,a=G(e,b);return t.writeUInt16BE(a,r),r=W(e,b,t,r+2),U.encode.bytes=r-n,t},U.encode.bytes=0,U.decode=function(e,t){t||(t=0);const r=t,i=[];let n=e.readUInt16BE(t);t+=2;let a=0;for(;n>0;)i[a++]=b.decode(e,t),t+=b.decode.bytes,n-=b.decode.bytes;return U.decode.bytes=t-r,i},U.decode.bytes=0,U.encodingLength=function(e){return 2+G(e||[],b)};const R=t.dnskey={};R.PROTOCOL_DNSSEC=3,R.ZONE_KEY=128,R.SECURE_ENTRYPOINT=32768,R.encode=function(e,t,r){t||(t=i.alloc(R.encodingLength(e))),r||(r=0);const n=r,a=e.key;if(!i.isBuffer(a))throw new Error("Key must be a Buffer");return r+=2,t.writeUInt16BE(e.flags,r),r+=2,t.writeUInt8(R.PROTOCOL_DNSSEC,r),r+=1,t.writeUInt8(e.algorithm,r),r+=1,a.copy(t,r,0,a.length),r+=a.length,R.encode.bytes=r-n,t.writeUInt16BE(R.encode.bytes-2,n),t},R.encode.bytes=0,R.decode=function(e,t){t||(t=0);const r=t;var i={},n=e.readUInt16BE(t);if(t+=2,i.flags=e.readUInt16BE(t),t+=2,e.readUInt8(t)!==R.PROTOCOL_DNSSEC)throw new Error("Protocol must be 3");return t+=1,i.algorithm=e.readUInt8(t),t+=1,i.key=e.slice(t,r+n+2),t+=i.key.length,R.decode.bytes=t-r,i},R.decode.bytes=0,R.encodingLength=function(e){return 6+i.byteLength(e.key)};const O=t.rrsig={};O.encode=function(e,t,r){t||(t=i.alloc(O.encodingLength(e))),r||(r=0);const a=r,o=e.signature;if(!i.isBuffer(o))throw new Error("Signature must be a Buffer");return r+=2,t.writeUInt16BE(n.toType(e.typeCovered),r),r+=2,t.writeUInt8(e.algorithm,r),r+=1,t.writeUInt8(e.labels,r),r+=1,t.writeUInt32BE(e.originalTTL,r),r+=4,t.writeUInt32BE(e.expiration,r),r+=4,t.writeUInt32BE(e.inception,r),r+=4,t.writeUInt16BE(e.keyTag,r),r+=2,h.encode(e.signersName,t,r),r+=h.encode.bytes,o.copy(t,r,0,o.length),r+=o.length,O.encode.bytes=r-a,t.writeUInt16BE(O.encode.bytes-2,a),t},O.encode.bytes=0,O.decode=function(e,t){t||(t=0);const r=t;var i={},a=e.readUInt16BE(t);return t+=2,i.typeCovered=n.toString(e.readUInt16BE(t)),t+=2,i.algorithm=e.readUInt8(t),t+=1,i.labels=e.readUInt8(t),t+=1,i.originalTTL=e.readUInt32BE(t),t+=4,i.expiration=e.readUInt32BE(t),t+=4,i.inception=e.readUInt32BE(t),t+=4,i.keyTag=e.readUInt16BE(t),t+=2,i.signersName=h.decode(e,t),t+=h.decode.bytes,i.signature=e.slice(t,r+a+2),t+=i.signature.length,O.decode.bytes=t-r,i},O.decode.bytes=0,O.encodingLength=function(e){return 20+h.encodingLength(e.signersName)+i.byteLength(e.signature)};const N=t.rp={};N.encode=function(e,t,r){t||(t=i.alloc(N.encodingLength(e))),r||(r=0);const n=r;return r+=2,h.encode(e.mbox||".",t,r,{mail:!0}),r+=h.encode.bytes,h.encode(e.txt||".",t,r),r+=h.encode.bytes,N.encode.bytes=r-n,t.writeUInt16BE(N.encode.bytes-2,n),t},N.encode.bytes=0,N.decode=function(e,t){t||(t=0);const r=t,i={};return t+=2,i.mbox=h.decode(e,t,{mail:!0})||".",t+=h.decode.bytes,i.txt=h.decode(e,t)||".",t+=h.decode.bytes,N.decode.bytes=t-r,i},N.decode.bytes=0,N.encodingLength=function(e){return 2+h.encodingLength(e.mbox||".")+h.encodingLength(e.txt||".")};const P={encode:function(e,t,r){t||(t=i.alloc(P.encodingLength(e))),r||(r=0);const a=r;for(var o=[],s=0;s<e.length;s++){var c=n.toType(e[s]);void 0===o[c>>8]&&(o[c>>8]=[]),o[c>>8][c>>3&31]|=1<<7-(7&c)}for(s=0;s<o.length;s++)if(void 0!==o[s]){var u=i.from(o[s]);t.writeUInt8(s,r),r+=1,t.writeUInt8(u.length,r),r+=1,u.copy(t,r),r+=u.length}return P.encode.bytes=r-a,t}};P.encode.bytes=0,P.decode=function(e,t,r){t||(t=0);const i=t;for(var a=[];t-i<r;){var o=e.readUInt8(t);t+=1;var s=e.readUInt8(t);t+=1;for(var c=0;c<s;c++)for(var u=e.readUInt8(t+c),l=0;l<8;l++)if(u&1<<7-l){var h=n.toString(o<<8|c<<3|l);a.push(h)}t+=s}return P.decode.bytes=t-i,a},P.decode.bytes=0,P.encodingLength=function(e){for(var t=[],r=0;r<e.length;r++){var i=n.toType(e[r]);t[i>>8]=Math.max(t[i>>8]||0,255&i)}var a=0;for(r=0;r<t.length;r++)void 0!==t[r]&&(a+=2+Math.ceil((t[r]+1)/8));return a};const B=t.nsec={};B.encode=function(e,t,r){t||(t=i.alloc(B.encodingLength(e))),r||(r=0);const n=r;return r+=2,h.encode(e.nextDomain,t,r),r+=h.encode.bytes,P.encode(e.rrtypes,t,r),r+=P.encode.bytes,B.encode.bytes=r-n,t.writeUInt16BE(B.encode.bytes-2,n),t},B.encode.bytes=0,B.decode=function(e,t){t||(t=0);const r=t;var i={},n=e.readUInt16BE(t);return t+=2,i.nextDomain=h.decode(e,t),t+=h.decode.bytes,i.rrtypes=P.decode(e,t,n-(t-r)),t+=P.decode.bytes,B.decode.bytes=t-r,i},B.decode.bytes=0,B.encodingLength=function(e){return 2+h.encodingLength(e.nextDomain)+P.encodingLength(e.rrtypes)};const L=t.nsec3={};L.encode=function(e,t,r){t||(t=i.alloc(L.encodingLength(e))),r||(r=0);const n=r,a=e.salt;if(!i.isBuffer(a))throw new Error("salt must be a Buffer");const o=e.nextDomain;if(!i.isBuffer(o))throw new Error("nextDomain must be a Buffer");return r+=2,t.writeUInt8(e.algorithm,r),r+=1,t.writeUInt8(e.flags,r),r+=1,t.writeUInt16BE(e.iterations,r),r+=2,t.writeUInt8(a.length,r),r+=1,a.copy(t,r,0,a.length),r+=a.length,t.writeUInt8(o.length,r),r+=1,o.copy(t,r,0,o.length),r+=o.length,P.encode(e.rrtypes,t,r),r+=P.encode.bytes,L.encode.bytes=r-n,t.writeUInt16BE(L.encode.bytes-2,n),t},L.encode.bytes=0,L.decode=function(e,t){t||(t=0);const r=t;var i={},n=e.readUInt16BE(t);t+=2,i.algorithm=e.readUInt8(t),t+=1,i.flags=e.readUInt8(t),t+=1,i.iterations=e.readUInt16BE(t),t+=2;const a=e.readUInt8(t);t+=1,i.salt=e.slice(t,t+a),t+=a;const o=e.readUInt8(t);return t+=1,i.nextDomain=e.slice(t,t+o),t+=o,i.rrtypes=P.decode(e,t,n-(t-r)),t+=P.decode.bytes,L.decode.bytes=t-r,i},L.decode.bytes=0,L.encodingLength=function(e){return 8+e.salt.length+e.nextDomain.length+P.encodingLength(e.rrtypes)};const x=t.ds={};x.encode=function(e,t,r){t||(t=i.alloc(x.encodingLength(e))),r||(r=0);const n=r,a=e.digest;if(!i.isBuffer(a))throw new Error("Digest must be a Buffer");return r+=2,t.writeUInt16BE(e.keyTag,r),r+=2,t.writeUInt8(e.algorithm,r),r+=1,t.writeUInt8(e.digestType,r),r+=1,a.copy(t,r,0,a.length),r+=a.length,x.encode.bytes=r-n,t.writeUInt16BE(x.encode.bytes-2,n),t},x.encode.bytes=0,x.decode=function(e,t){t||(t=0);const r=t;var i={},n=e.readUInt16BE(t);return t+=2,i.keyTag=e.readUInt16BE(t),t+=2,i.algorithm=e.readUInt8(t),t+=1,i.digestType=e.readUInt8(t),t+=1,i.digest=e.slice(t,r+n+2),t+=i.digest.length,x.decode.bytes=t-r,i},x.decode.bytes=0,x.encodingLength=function(e){return 6+i.byteLength(e.digest)};const M=t.sshfp={};M.getFingerprintLengthForHashType=function(e){switch(e){case 1:return 20;case 2:return 32}},M.encode=function(e,t,r){t||(t=i.alloc(M.encodingLength(e))),r||(r=0);const n=r;t[r+=2]=e.algorithm,t[r+=1]=e.hash,r+=1;const a=i.from(e.fingerprint.toUpperCase(),"hex");if(a.length!==M.getFingerprintLengthForHashType(e.hash))throw new Error("Invalid fingerprint length");return a.copy(t,r),r+=a.byteLength,M.encode.bytes=r-n,t.writeUInt16BE(M.encode.bytes-2,n),t},M.encode.bytes=0,M.decode=function(e,t){t||(t=0);const r=t,i={};t+=2,i.algorithm=e[t],t+=1,i.hash=e[t],t+=1;const n=M.getFingerprintLengthForHashType(i.hash);return i.fingerprint=e.slice(t,t+n).toString("hex").toUpperCase(),t+=n,M.decode.bytes=t-r,i},M.decode.bytes=0,M.encodingLength=function(e){return 4+i.from(e.fingerprint,"hex").byteLength};const F=t.naptr={};F.encode=function(e,t,r){t||(t=i.alloc(F.encodingLength(e))),r||(r=0);const n=r;return r+=2,t.writeUInt16BE(e.order||0,r),r+=2,t.writeUInt16BE(e.preference||0,r),r+=2,d.encode(e.flags,t,r),r+=d.encode.bytes,d.encode(e.services,t,r),r+=d.encode.bytes,d.encode(e.regexp,t,r),r+=d.encode.bytes,h.encode(e.replacement,t,r),r+=h.encode.bytes,F.encode.bytes=r-n,t.writeUInt16BE(F.encode.bytes-2,n),t},F.encode.bytes=0,F.decode=function(e,t){t||(t=0);const r=t,i={};return t+=2,i.order=e.readUInt16BE(t),t+=2,i.preference=e.readUInt16BE(t),t+=2,i.flags=d.decode(e,t),t+=d.decode.bytes,i.services=d.decode(e,t),t+=d.decode.bytes,i.regexp=d.decode(e,t),t+=d.decode.bytes,i.replacement=h.decode(e,t),t+=h.decode.bytes,F.decode.bytes=t-r,i},F.decode.bytes=0,F.encodingLength=function(e){return d.encodingLength(e.flags)+d.encodingLength(e.services)+d.encodingLength(e.regexp)+h.encodingLength(e.replacement)+6};const k=t.tlsa={};k.encode=function(e,t,r){t||(t=i.alloc(k.encodingLength(e))),r||(r=0);const n=r,a=e.certificate;if(!i.isBuffer(a))throw new Error("Certificate must be a Buffer");return r+=2,t.writeUInt8(e.usage,r),r+=1,t.writeUInt8(e.selector,r),r+=1,t.writeUInt8(e.matchingType,r),r+=1,a.copy(t,r,0,a.length),r+=a.length,k.encode.bytes=r-n,t.writeUInt16BE(k.encode.bytes-2,n),t},k.encode.bytes=0,k.decode=function(e,t){t||(t=0);const r=t,i={},n=e.readUInt16BE(t);return t+=2,i.usage=e.readUInt8(t),t+=1,i.selector=e.readUInt8(t),t+=1,i.matchingType=e.readUInt8(t),t+=1,i.certificate=e.slice(t,r+n+2),t+=i.certificate.length,k.decode.bytes=t-r,i},k.decode.bytes=0,k.encodingLength=function(e){return 5+i.byteLength(e.certificate)};const V=t.record=function(e){switch(e.toUpperCase()){case"A":return D;case"PTR":return S;case"CNAME":return E;case"DNAME":return _;case"TXT":return m;case"NULL":return y;case"AAAA":return w;case"SRV":return T;case"HINFO":return C;case"CAA":return A;case"NS":return v;case"SOA":return g;case"MX":return I;case"OPT":return U;case"DNSKEY":return R;case"RRSIG":return O;case"RP":return N;case"NSEC":return B;case"NSEC3":return L;case"SSHFP":return M;case"DS":return x;case"NAPTR":return F;case"TLSA":return k}return f},H=t.answer={};H.encode=function(e,t,r){t||(t=i.alloc(H.encodingLength(e))),r||(r=0);const a=r;if(h.encode(e.name,t,r),r+=h.encode.bytes,t.writeUInt16BE(n.toType(e.type),r),"OPT"===e.type.toUpperCase()){if("."!==e.name)throw new Error("OPT name must be root.");t.writeUInt16BE(e.udpPayloadSize||4096,r+2),t.writeUInt8(e.extendedRcode||0,r+4),t.writeUInt8(e.ednsVersion||0,r+5),t.writeUInt16BE(e.flags||0,r+6),r+=8,U.encode(e.options||[],t,r),r+=U.encode.bytes}else{let i=s.toClass(void 0===e.class?"IN":e.class);e.flush&&(i|=l),t.writeUInt16BE(i,r+2),t.writeUInt32BE(e.ttl||0,r+4),r+=8;const n=V(e.type);n.encode(e.data,t,r),r+=n.encode.bytes}return H.encode.bytes=r-a,t},H.encode.bytes=0,H.decode=function(e,t){t||(t=0);const r={},i=t;if(r.name=h.decode(e,t),t+=h.decode.bytes,r.type=n.toString(e.readUInt16BE(t)),"OPT"===r.type)r.udpPayloadSize=e.readUInt16BE(t+2),r.extendedRcode=e.readUInt8(t+4),r.ednsVersion=e.readUInt8(t+5),r.flags=e.readUInt16BE(t+6),r.flag_do=1==(r.flags>>15&1),r.options=U.decode(e,t+8),t+=8+U.decode.bytes;else{const i=e.readUInt16BE(t+2);r.ttl=e.readUInt32BE(t+4),r.class=s.toString(-32769&i),r.flush=!!(i&l);const n=V(r.type);r.data=n.decode(e,t+8),t+=8+n.decode.bytes}return H.decode.bytes=t-i,r},H.decode.bytes=0,H.encodingLength=function(e){const t=null!==e.data&&void 0!==e.data?e.data:e.options;return h.encodingLength(e.name)+8+V(e.type).encodingLength(t)};const j=t.question={};function G(e,t){let r=0;for(let i=0;i<e.length;i++)r+=t.encodingLength(e[i]);return r}function W(e,t,r,i){for(let n=0;n<e.length;n++)t.encode(e[n],r,i),i+=t.encode.bytes;return i}function Y(e,t,r,i){for(let n=0;n<e.length;n++)e[n]=t.decode(r,i),i+=t.decode.bytes;return i}j.encode=function(e,t,r){t||(t=i.alloc(j.encodingLength(e))),r||(r=0);const a=r;return h.encode(e.name,t,r),r+=h.encode.bytes,t.writeUInt16BE(n.toType(e.type),r),r+=2,t.writeUInt16BE(s.toClass(void 0===e.class?"IN":e.class),r),r+=2,j.encode.bytes=r-a,e},j.encode.bytes=0,j.decode=function(e,t){t||(t=0);const r=t,i={};i.name=h.decode(e,t),t+=h.decode.bytes,i.type=n.toString(e.readUInt16BE(t)),t+=2,i.class=s.toString(e.readUInt16BE(t)),t+=2;return!!(32768&i.class)&&(i.class&=-32769),j.decode.bytes=t-r,i},j.decode.bytes=0,j.encodingLength=function(e){return h.encodingLength(e.name)+4},t.AUTHORITATIVE_ANSWER=1024,t.TRUNCATED_RESPONSE=512,t.RECURSION_DESIRED=256,t.RECURSION_AVAILABLE=128,t.AUTHENTIC_DATA=32,t.CHECKING_DISABLED=16,t.DNSSEC_OK=32768,t.encode=function(e,r,n){const a=!r;a&&(r=i.alloc(t.encodingLength(e))),n||(n=0);const o=n;return e.questions||(e.questions=[]),e.answers||(e.answers=[]),e.authorities||(e.authorities=[]),e.additionals||(e.additionals=[]),p.encode(e,r,n),n+=p.encode.bytes,n=W(e.questions,j,r,n),n=W(e.answers,H,r,n),n=W(e.authorities,H,r,n),n=W(e.additionals,H,r,n),t.encode.bytes=n-o,a&&t.encode.bytes!==r.length?r.slice(0,t.encode.bytes):r},t.encode.bytes=0,t.decode=function(e,r){r||(r=0);const i=r,n=p.decode(e,r);return r+=p.decode.bytes,r=Y(n.questions,j,e,r),r=Y(n.answers,H,e,r),r=Y(n.authorities,H,e,r),r=Y(n.additionals,H,e,r),t.decode.bytes=r-i,n},t.decode.bytes=0,t.encodingLength=function(e){return p.encodingLength(e)+G(e.questions||[],j)+G(e.answers||[],H)+G(e.authorities||[],H)+G(e.additionals||[],H)},t.streamEncode=function(e){const r=t.encode(e),n=i.alloc(2);n.writeUInt16BE(r.byteLength);const a=i.concat([n,r]);return t.streamEncode.bytes=a.byteLength,a},t.streamEncode.bytes=0,t.streamDecode=function(e){const r=e.readUInt16BE(0);if(e.byteLength<r+2)return null;const i=t.decode(e.slice(2));return t.streamDecode.bytes=t.decode.bytes,i},t.streamDecode.bytes=0},628:(e,t)=>{"use strict";t.toString=function(e){switch(e){case 0:return"QUERY";case 1:return"IQUERY";case 2:return"STATUS";case 3:return"OPCODE_3";case 4:return"NOTIFY";case 5:return"UPDATE";case 6:return"OPCODE_6";case 7:return"OPCODE_7";case 8:return"OPCODE_8";case 9:return"OPCODE_9";case 10:return"OPCODE_10";case 11:return"OPCODE_11";case 12:return"OPCODE_12";case 13:return"OPCODE_13";case 14:return"OPCODE_14";case 15:return"OPCODE_15"}return"OPCODE_"+e},t.toOpcode=function(e){switch(e.toUpperCase()){case"QUERY":return 0;case"IQUERY":return 1;case"STATUS":return 2;case"OPCODE_3":return 3;case"NOTIFY":return 4;case"UPDATE":return 5;case"OPCODE_6":return 6;case"OPCODE_7":return 7;case"OPCODE_8":return 8;case"OPCODE_9":return 9;case"OPCODE_10":return 10;case"OPCODE_11":return 11;case"OPCODE_12":return 12;case"OPCODE_13":return 13;case"OPCODE_14":return 14;case"OPCODE_15":return 15}return 0}},5874:(e,t)=>{"use strict";t.toString=function(e){switch(e){case 1:return"LLQ";case 2:return"UL";case 3:return"NSID";case 5:return"DAU";case 6:return"DHU";case 7:return"N3U";case 8:return"CLIENT_SUBNET";case 9:return"EXPIRE";case 10:return"COOKIE";case 11:return"TCP_KEEPALIVE";case 12:return"PADDING";case 13:return"CHAIN";case 14:return"KEY_TAG";case 26946:return"DEVICEID"}return e<0?null:`OPTION_${e}`},t.toCode=function(e){if("number"==typeof e)return e;if(!e)return-1;switch(e.toUpperCase()){case"OPTION_0":return 0;case"LLQ":return 1;case"UL":return 2;case"NSID":return 3;case"OPTION_4":return 4;case"DAU":return 5;case"DHU":return 6;case"N3U":return 7;case"CLIENT_SUBNET":return 8;case"EXPIRE":return 9;case"COOKIE":return 10;case"TCP_KEEPALIVE":return 11;case"PADDING":return 12;case"CHAIN":return 13;case"KEY_TAG":return 14;case"DEVICEID":return 26946;case"OPTION_65535":return 65535}const t=e.match(/_(\d+)$/);return t?parseInt(t[1],10):-1}},2111:(e,t)=>{"use strict";t.toString=function(e){switch(e){case 0:return"NOERROR";case 1:return"FORMERR";case 2:return"SERVFAIL";case 3:return"NXDOMAIN";case 4:return"NOTIMP";case 5:return"REFUSED";case 6:return"YXDOMAIN";case 7:return"YXRRSET";case 8:return"NXRRSET";case 9:return"NOTAUTH";case 10:return"NOTZONE";case 11:return"RCODE_11";case 12:return"RCODE_12";case 13:return"RCODE_13";case 14:return"RCODE_14";case 15:return"RCODE_15"}return"RCODE_"+e},t.toRcode=function(e){switch(e.toUpperCase()){case"NOERROR":return 0;case"FORMERR":return 1;case"SERVFAIL":return 2;case"NXDOMAIN":return 3;case"NOTIMP":return 4;case"REFUSED":return 5;case"YXDOMAIN":return 6;case"YXRRSET":return 7;case"NXRRSET":return 8;case"NOTAUTH":return 9;case"NOTZONE":return 10;case"RCODE_11":return 11;case"RCODE_12":return 12;case"RCODE_13":return 13;case"RCODE_14":return 14;case"RCODE_15":return 15}return 0}},834:(e,t)=>{"use strict";t.toString=function(e){switch(e){case 1:return"A";case 10:return"NULL";case 28:return"AAAA";case 18:return"AFSDB";case 42:return"APL";case 257:return"CAA";case 60:return"CDNSKEY";case 59:return"CDS";case 37:return"CERT";case 5:return"CNAME";case 49:return"DHCID";case 32769:return"DLV";case 39:return"DNAME";case 48:return"DNSKEY";case 43:return"DS";case 55:return"HIP";case 13:return"HINFO";case 45:return"IPSECKEY";case 25:return"KEY";case 36:return"KX";case 29:return"LOC";case 15:return"MX";case 35:return"NAPTR";case 2:return"NS";case 47:return"NSEC";case 50:return"NSEC3";case 51:return"NSEC3PARAM";case 12:return"PTR";case 46:return"RRSIG";case 17:return"RP";case 24:return"SIG";case 6:return"SOA";case 99:return"SPF";case 33:return"SRV";case 44:return"SSHFP";case 32768:return"TA";case 249:return"TKEY";case 52:return"TLSA";case 250:return"TSIG";case 16:return"TXT";case 252:return"AXFR";case 251:return"IXFR";case 41:return"OPT";case 255:return"ANY"}return"UNKNOWN_"+e},t.toType=function(e){switch(e.toUpperCase()){case"A":return 1;case"NULL":return 10;case"AAAA":return 28;case"AFSDB":return 18;case"APL":return 42;case"CAA":return 257;case"CDNSKEY":return 60;case"CDS":return 59;case"CERT":return 37;case"CNAME":return 5;case"DHCID":return 49;case"DLV":return 32769;case"DNAME":return 39;case"DNSKEY":return 48;case"DS":return 43;case"HIP":return 55;case"HINFO":return 13;case"IPSECKEY":return 45;case"KEY":return 25;case"KX":return 36;case"LOC":return 29;case"MX":return 15;case"NAPTR":return 35;case"NS":return 2;case"NSEC":return 47;case"NSEC3":return 50;case"NSEC3PARAM":return 51;case"PTR":return 12;case"RRSIG":return 46;case"RP":return 17;case"SIG":return 24;case"SOA":return 6;case"SPF":return 99;case"SRV":return 33;case"SSHFP":return 44;case"TA":return 32768;case"TKEY":return 249;case"TLSA":return 52;case"TSIG":return 250;case"TXT":return 16;case"AXFR":return 252;case"IXFR":return 251;case"OPT":return 41;case"ANY":case"*":return 255}return e.toUpperCase().startsWith("UNKNOWN_")?parseInt(e.slice(8)):0}},4928:(e,t,r)=>{var i=r(2203),n=["write","end","destroy"],a=["resume","pause"],o=["data","close"],s=Array.prototype.slice;function c(e,t){if(e.forEach)return e.forEach(t);for(var r=0;r<e.length;r++)t(e[r],r)}e.exports=function(e,t){var r=new i,u=!1;return c(n,(function(t){function i(){return e[t].apply(e,arguments)}r[t]=i})),c(a,(function(e){function i(){r.emit(e);var i=t[e];if(i)return i.apply(t,arguments);t.emit(e)}r[e]=i})),c(o,(function(e){function i(){var t=s.call(arguments);t.unshift(e),r.emit.apply(r,t)}t.on(e,i)})),t.on("end",(function(){if(u)return;u=!0;var e=s.call(arguments);e.unshift("end"),r.emit.apply(r,e)})),e.on("drain",(function(){r.emit("drain")})),e.on("error",l),t.on("error",l),r.writable=e.writable,r.readable=t.readable,r;function l(e){r.emit("error",e)}}},655:(e,t,r)=>{"use strict";var i=r(453)("%Object.defineProperty%",!0)||!1;if(i)try{i({},"a",{value:1})}catch(e){i=!1}e.exports=i},1237:e=>{"use strict";e.exports=EvalError},9383:e=>{"use strict";e.exports=Error},9290:e=>{"use strict";e.exports=RangeError},9538:e=>{"use strict";e.exports=ReferenceError},8068:e=>{"use strict";e.exports=SyntaxError},9675:e=>{"use strict";e.exports=TypeError},5345:e=>{"use strict";e.exports=URIError},8954:(e,t,r)=>{var i=r(2203).Stream,n=t,a=r(1094),o=r(1813),s=r(4928),c=r(9292),u=r(6736),l=r(175),h=r(8497),d=global.setImmediate||process.nextTick;n.Stream=i,n.through=a,n.from=o,n.duplex=s,n.map=c,n.pause=u,n.split=l,n.pipeline=n.connect=n.pipe=h,n.concat=n.merge=function(){var e=[].slice.call(arguments);1===e.length&&e[0]instanceof Array&&(e=e[0]);var t=new i;t.setMaxListeners(0);var r=0;return t.writable=t.readable=!0,e.length?e.forEach((function(i){i.pipe(t,{end:!1});var n=!1;i.on("end",(function(){n||(n=!0,++r==e.length&&t.emit("end"))}))})):process.nextTick((function(){t.emit("end")})),t.write=function(e){this.emit("data",e)},t.destroy=function(){e.forEach((function(e){e.destroy&&e.destroy()}))},t},n.collect=n.writeArray=function(e){if("function"!=typeof e)throw new Error("function writeArray (done): done must be function");var t=new i,r=[],n=!1;return t.write=function(e){r.push(e)},t.end=function(){n=!0,e(null,r)},t.writable=!0,t.readable=!1,t.destroy=function(){t.writable=t.readable=!1,n||e(new Error("destroyed before end"),r)},t},n.readArray=function(e){var t=new i,r=0,n=!1,a=!1;if(t.readable=!0,t.writable=!1,!Array.isArray(e))throw new Error("event-stream.read expects an array");return t.resume=function(){if(!a){n=!1;for(var i=e.length;r<i&&!n&&!a;)t.emit("data",e[r++]);r!=i||a||(a=!0,t.readable=!1,t.emit("end"))}},process.nextTick(t.resume),t.pause=function(){n=!0},t.destroy=function(){a=!0,t.emit("close")},t},n.readable=function(e,t){var r=new i,n=0,a=!1,o=!1,s=!1;if(r.readable=!0,r.writable=!1,"function"!=typeof e)throw new Error("event-stream.readable expects async function");function c(i,u){i?(r.emit("error",i),t||r.emit("end")):arguments.length>1&&r.emit("data",u),d((function(){if(!(o||a||s))try{s=!0,e.call(r,n++,(function(){s=!1,c.apply(null,arguments)}))}catch(e){r.emit("error",e)}}))}return r.on("end",(function(){o=!0})),r.resume=function(){a=!1,c()},process.nextTick(c),r.pause=function(){a=!0},r.destroy=function(){r.emit("end"),r.emit("close"),o=!0},r},n.mapSync=function(e){return n.through((function(t){var r;try{r=e(t)}catch(e){return this.emit("error",e)}void 0!==r&&this.emit("data",r)}))},n.filterSync=function(e){return n.through((function(t){e(t)&&this.queue(t)}))},n.flatmapSync=function(e){return n.through((function(t){var r=this;t.forEach((function(t){r.queue(e(t))}))}))},n.log=function(e){return n.through((function(t){[].slice.call(arguments);e?console.error(e,t):console.error(t),this.emit("data",t)}))},n.child=function(e){return n.duplex(e.stdin,e.stdout)},n.parse=function(e){var t=!(!e||!e.error);return n.through((function(e){var r;try{e&&(r=JSON.parse(e.toString()))}catch(r){return t?this.emit("error",r):console.error(r,"attempting to parse:",e)}void 0!==r&&this.emit("data",r)}))},n.stringify=function(){var e=r(181).Buffer;return n.mapSync((function(t){return JSON.stringify(e.isBuffer(t)?t.toString():t)+"\n"}))},n.replace=function(e,t){return n.pipeline(n.split(e),n.join(t))},n.join=function(e){if("function"==typeof e)return n.wait(e);var t=!0;return n.through((function(r){return t||this.emit("data",e),t=!1,this.emit("data",r),!0}))},n.wait=function(e){var t=[];return n.through((function(e){t.push(e)}),(function(){var r=Buffer.isBuffer(t[0])?Buffer.concat(t):t.join("");this.emit("data",r),this.emit("end"),e&&e(null,r)}))},n.pipeable=function(){throw new Error("[EVENT-STREAM] es.pipeable is deprecated")}},2017:e=>{"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var i,n,a;if(Array.isArray(t)){if((i=t.length)!=r.length)return!1;for(n=i;0!=n--;)if(!e(t[n],r[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((i=(a=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(n=i;0!=n--;)if(!Object.prototype.hasOwnProperty.call(r,a[n]))return!1;for(n=i;0!=n--;){var o=a[n];if(!e(t[o],r[o]))return!1}return!0}return t!=t&&r!=r}},2986:(e,t,r)=>{var i=r(6982);function n(e,t){null!=e&&("number"==typeof e?this.fromNumber(e,t):Buffer.isBuffer(e)?this.fromBuffer(e):null==t&&"string"!=typeof e?this.fromByteArray(e):this.fromString(e,t))}function a(){return new n(null)}n.prototype.am=function(e,t,r,i,n,a){for(var o=16383&t,s=t>>14;--a>=0;){var c=16383&this[e],u=this[e++]>>14,l=s*c+u*o;n=((c=o*c+((16383&l)<<14)+r[i]+n)>>28)+(l>>14)+s*u,r[i++]=268435455&c}return n},n.prototype.DB=28,n.prototype.DM=268435455,n.prototype.DV=1<<28;n.prototype.FV=Math.pow(2,52),n.prototype.F1=24,n.prototype.F2=4;var o,s,c="0123456789abcdefghijklmnopqrstuvwxyz",u=new Array;for(o="0".charCodeAt(0),s=0;s<=9;++s)u[o++]=s;for(o="a".charCodeAt(0),s=10;s<36;++s)u[o++]=s;for(o="A".charCodeAt(0),s=10;s<36;++s)u[o++]=s;function l(e){return c.charAt(e)}function h(e,t){var r=u[e.charCodeAt(t)];return null==r?-1:r}function d(e){var t=a();return t.fromInt(e),t}function p(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function f(e){this.m=e}function v(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function g(e,t){return e&t}function m(e,t){return e|t}function y(e,t){return e^t}function C(e,t){return e&~t}function S(e){if(0===e)return-1;var t=0;return 65535&e||(e>>=16,t+=16),255&e||(e>>=8,t+=8),15&e||(e>>=4,t+=4),3&e||(e>>=2,t+=2),1&e||++t,t}function E(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function _(){}function T(e){return e}function A(e){this.r2=a(),this.q3=a(),n.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}f.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},f.prototype.revert=function(e){return e},f.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},f.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},f.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},v.prototype.convert=function(e){var t=a();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(n.ZERO)>0&&this.m.subTo(t,t),t},v.prototype.revert=function(e){var t=a();return e.copyTo(t),this.reduce(t),t},v.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e[t],i=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[r=t+this.m.t]+=this.m.am(0,i,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},v.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},v.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},_.prototype.convert=T,_.prototype.revert=T,_.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},_.prototype.sqrTo=function(e,t){e.squareTo(t)},A.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=a();return e.copyTo(t),this.reduce(t),t},A.prototype.revert=function(e){return e},A.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},A.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},A.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var I=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],D=(1<<26)/I[I.length-1];n.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s},n.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+DV:this.t=0},n.prototype.fromString=function(e,t,r){var i;switch(t){case 2:i=1;break;case 4:i=2;break;case 8:i=3;break;case 16:i=4;break;case 32:i=5;break;case 256:i=8;break;default:return void this.fromRadix(e,t)}this.t=0,this.s=0;for(var a=e.length,o=!1,s=0;--a>=0;){var c=8==i?255&e[a]:h(e,a);c<0?"-"==e.charAt(a)&&(o=!0):(o=!1,0===s?this[this.t++]=c:s+i>this.DB?(this[this.t-1]|=(c&(1<<this.DB-s)-1)<<s,this[this.t++]=c>>this.DB-s):this[this.t-1]|=c<<s,(s+=i)>=this.DB&&(s-=this.DB))}!r&&8==i&&128&e[0]&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),o&&n.ZERO.subTo(this,this)},n.prototype.fromByteArray=function(e,t){this.fromString(e,256,t)},n.prototype.fromBuffer=function(e){this.fromString(e,256,!0)},n.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t},n.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e,t.s=this.s},n.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s},n.prototype.lShiftTo=function(e,t){var r,i=e%this.DB,n=this.DB-i,a=(1<<n)-1,o=Math.floor(e/this.DB),s=this.s<<i&this.DM;for(r=this.t-1;r>=0;--r)t[r+o+1]=this[r]>>n|s,s=(this[r]&a)<<i;for(r=o-1;r>=0;--r)t[r]=0;t[o]=s,t.t=this.t+o+1,t.s=this.s,t.clamp()},n.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var i=e%this.DB,n=this.DB-i,a=(1<<i)-1;t[0]=this[r]>>i;for(var o=r+1;o<this.t;++o)t[o-r-1]|=(this[o]&a)<<n,t[o-r]=this[o]>>i;i>0&&(t[this.t-r-1]|=(this.s&a)<<n),t.t=this.t-r,t.clamp()}},n.prototype.subTo=function(e,t){for(var r=0,i=0,n=Math.min(e.t,this.t);r<n;)i+=this[r]-e[r],t[r++]=i&this.DM,i>>=this.DB;if(e.t<this.t){for(i-=e.s;r<this.t;)i+=this[r],t[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<e.t;)i-=e[r],t[r++]=i&this.DM,i>>=this.DB;i-=e.s}t.s=i<0?-1:0,i<-1?t[r++]=this.DV+i:i>0&&(t[r++]=i),t.t=r,t.clamp()},n.prototype.multiplyTo=function(e,t){var r=this.abs(),i=e.abs(),a=r.t;for(t.t=a+i.t;--a>=0;)t[a]=0;for(a=0;a<i.t;++a)t[a+r.t]=r.am(0,i[a],t,a,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&n.ZERO.subTo(t,t)},n.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e[r]=0;for(r=0;r<t.t-1;++r){var i=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,i,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()},n.prototype.divRemTo=function(e,t,r){var i=e.abs();if(!(i.t<=0)){var o=this.abs();if(o.t<i.t)return null!=t&&t.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=a());var s=a(),c=this.s,u=e.s,l=this.DB-p(i[i.t-1]);l>0?(i.lShiftTo(l,s),o.lShiftTo(l,r)):(i.copyTo(s),o.copyTo(r));var h=s.t,d=s[h-1];if(0!==d){var f=d*(1<<this.F1)+(h>1?s[h-2]>>this.F2:0),v=this.FV/f,g=(1<<this.F1)/f,m=1<<this.F2,y=r.t,C=y-h,S=null==t?a():t;for(s.dlShiftTo(C,S),r.compareTo(S)>=0&&(r[r.t++]=1,r.subTo(S,r)),n.ONE.dlShiftTo(h,S),S.subTo(s,s);s.t<h;)s[s.t++]=0;for(;--C>=0;){var E=r[--y]==d?this.DM:Math.floor(r[y]*v+(r[y-1]+m)*g);if((r[y]+=s.am(0,E,r,C,0,h))<E)for(s.dlShiftTo(C,S),r.subTo(S,r);r[y]<--E;)r.subTo(S,r)}null!=t&&(r.drShiftTo(h,t),c!=u&&n.ZERO.subTo(t,t)),r.t=h,r.clamp(),l>0&&r.rShiftTo(l,r),c<0&&n.ZERO.subTo(r,r)}}},n.prototype.invDigit=function(){if(this.t<1)return 0;var e=this[0];if(!(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},n.prototype.isEven=function(){return 0===(this.t>0?1&this[0]:this.s)},n.prototype.exp=function(e,t){if(e>4294967295||e<1)return n.ONE;var r=a(),i=a(),o=t.convert(this),s=p(e)-1;for(o.copyTo(r);--s>=0;)if(t.sqrTo(r,i),(e&1<<s)>0)t.mulTo(i,o,r);else{var c=r;r=i,i=c}return t.revert(r)},n.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},n.prototype.toRadix=function(e){if(null==e&&(e=10),0===this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),i=d(r),n=a(),o=a(),s="";for(this.divRemTo(i,n,o);n.signum()>0;)s=(r+o.intValue()).toString(e).substr(1)+s,n.divRemTo(i,n,o);return o.intValue().toString(e)+s},n.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var r=this.chunkSize(t),i=Math.pow(t,r),a=!1,o=0,s=0,c=0;c<e.length;++c){var u=h(e,c);u<0?"-"==e.charAt(c)&&0===this.signum()&&(a=!0):(s=t*s+u,++o>=r&&(this.dMultiply(i),this.dAddOffset(s,0),o=0,s=0))}o>0&&(this.dMultiply(Math.pow(t,o)),this.dAddOffset(s,0)),a&&n.ZERO.subTo(this,this)},n.prototype.fromNumber=function(e,t){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e),this.testBit(e-1)||this.bitwiseTo(n.ONE.shiftLeft(e-1),m,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(n.ONE.shiftLeft(e-1),this);else{var r=i.randomBytes(1+(e>>3)),a=7&e;a>0?r[0]&=(1<<a)-1:r[0]=0,this.fromByteArray(r)}},n.prototype.bitwiseTo=function(e,t,r){var i,n,a=Math.min(e.t,this.t);for(i=0;i<a;++i)r[i]=t(this[i],e[i]);if(e.t<this.t){for(n=e.s&this.DM,i=a;i<this.t;++i)r[i]=t(this[i],n);r.t=this.t}else{for(n=this.s&this.DM,i=a;i<e.t;++i)r[i]=t(n,e[i]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},n.prototype.changeBit=function(e,t){var r=n.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r},n.prototype.addTo=function(e,t){for(var r=0,i=0,n=Math.min(e.t,this.t);r<n;)i+=this[r]+e[r],t[r++]=i&this.DM,i>>=this.DB;if(e.t<this.t){for(i+=e.s;r<this.t;)i+=this[r],t[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<e.t;)i+=e[r],t[r++]=i&this.DM,i>>=this.DB;i+=e.s}t.s=i<0?-1:0,i>0?t[r++]=i:i<-1&&(t[r++]=this.DV+i),t.t=r,t.clamp()},n.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},n.prototype.dAddOffset=function(e,t){if(0!==e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}},n.prototype.multiplyLowerTo=function(e,t,r){var i,n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r[--n]=0;for(i=r.t-this.t;n<i;++n)r[n+this.t]=this.am(0,e[n],r,n,0,this.t);for(i=Math.min(e.t,t);n<i;++n)this.am(0,e[n],r,n,0,t-n);r.clamp()},n.prototype.multiplyUpperTo=function(e,t,r){--t;var i=r.t=this.t+e.t-t;for(r.s=0;--i>=0;)r[i]=0;for(i=Math.max(t-this.t,0);i<e.t;++i)r[this.t+i-t]=this.am(t-i,e[i],r,0,0,this.t+i-t);r.clamp(),r.drShiftTo(1,r)},n.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0===t)r=this[0]%e;else for(var i=this.t-1;i>=0;--i)r=(t*r+this[i])%e;return r},n.prototype.millerRabin=function(e){var t=this.subtract(n.ONE),r=t.getLowestSetBit();if(r<=0)return!1;var i=t.shiftRight(r);(e=e+1>>1)>I.length&&(e=I.length);for(var o=a(),s=0;s<e;++s){o.fromInt(I[Math.floor(Math.random()*I.length)]);var c=o.modPow(i,this);if(0!=c.compareTo(n.ONE)&&0!=c.compareTo(t)){for(var u=1;u++<r&&0!=c.compareTo(t);)if(0===(c=c.modPowInt(2,this)).compareTo(n.ONE))return!1;if(0!=c.compareTo(t))return!1}}return!0},n.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,i=(1<<t)-1,n=!1,a="",o=this.t,s=this.DB-o*this.DB%t;if(o-- >0)for(s<this.DB&&(r=this[o]>>s)>0&&(n=!0,a=l(r));o>=0;)s<t?(r=(this[o]&(1<<s)-1)<<t-s,r|=this[--o]>>(s+=this.DB-t)):(r=this[o]>>(s-=t)&i,s<=0&&(s+=this.DB,--o)),r>0&&(n=!0),n&&(a+=l(r));
//! Fix to be compatible with node >0.12.7 Buffer.js
return 16==e&&a.length%2!=0&&(a="0"+a),n?a:"0"},n.prototype.negate=function(){var e=a();return n.ZERO.subTo(this,e),e},n.prototype.abs=function(){return this.s<0?this.negate():this},n.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this[r]-e[r]))return t;return 0},n.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+p(this[this.t-1]^this.s&this.DM)},n.prototype.mod=function(e){var t=a();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(n.ZERO)>0&&e.subTo(t,t),t},n.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new f(t):new v(t),this.exp(e,r)},n.prototype.clone=function(){var e=a();return this.copyTo(e),e},n.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0===this.t)return-1}else{if(1==this.t)return this[0];if(0===this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},n.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},n.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},n.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},n.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var r,i=this.DB-e*this.DB%8,n=0;if(e-- >0)for(i<this.DB&&(r=this[e]>>i)!=(this.s&this.DM)>>i&&(t[n++]=r|this.s<<this.DB-i);e>=0;)i<8?(r=(this[e]&(1<<i)-1)<<8-i,r|=this[--e]>>(i+=this.DB-8)):(r=this[e]>>(i-=8)&255,i<=0&&(i+=this.DB,--e)),128&r&&(r|=-256),0===n&&(128&this.s)!=(128&r)&&++n,(n>0||r!=this.s)&&(t[n++]=r);return t},n.prototype.toBuffer=function(e){var t=Buffer.from(this.toByteArray());if(!0===e&&0===t[0])t=t.slice(1);else if("number"==typeof e){if(t.length>e){for(var r=0;r<t.length-e;r++)if(0!==t[r])return null;return t.slice(t.length-e)}if(t.length<e){var i=Buffer.alloc(e);return i.fill(0,0,e-t.length),t.copy(i,e-t.length),i}}return t},n.prototype.equals=function(e){return 0==this.compareTo(e)},n.prototype.eq=function(e){return console.log(this.compareTo(e)),0==this.compareTo(e)},n.prototype.gt=function(e){return this.compareTo(e)>0},n.prototype.gte=function(e){return this.compareTo(e)>=0},n.prototype.lt=function(e){return this.compareTo(e)<0},n.prototype.lte=function(e){return this.compareTo(e)<=0},n.prototype.min=function(e){return this.compareTo(e)<0?this:e},n.prototype.max=function(e){return this.compareTo(e)>0?this:e},n.prototype.and=function(e){var t=a();return this.bitwiseTo(e,g,t),t},n.prototype.or=function(e){var t=a();return this.bitwiseTo(e,m,t),t},n.prototype.xor=function(e){var t=a();return this.bitwiseTo(e,y,t),t},n.prototype.andNot=function(e){var t=a();return this.bitwiseTo(e,C,t),t},n.prototype.not=function(){for(var e=a(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e},n.prototype.shiftLeft=function(e){var t=a();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},n.prototype.shiftRight=function(e){var t=a();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},n.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+S(this[e]);return this.s<0?this.t*this.DB:-1},n.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=E(this[r]^t);return e},n.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:!!(this[t]&1<<e%this.DB)},n.prototype.setBit=function(e){return this.changeBit(e,m)},n.prototype.clearBit=function(e){return this.changeBit(e,C)},n.prototype.flipBit=function(e){return this.changeBit(e,y)},n.prototype.add=function(e){var t=a();return this.addTo(e,t),t},n.prototype.subtract=function(e){var t=a();return this.subTo(e,t),t},n.prototype.multiply=function(e){var t=a();return this.multiplyTo(e,t),t},n.prototype.divide=function(e){var t=a();return this.divRemTo(e,t,null),t},n.prototype.remainder=function(e){var t=a();return this.divRemTo(e,null,t),t},n.prototype.divideAndRemainder=function(e){var t=a(),r=a();return this.divRemTo(e,t,r),new Array(t,r)},n.prototype.modPow=function(e,t){var r,i,n=e.bitLength(),o=d(1);if(n<=0)return o;r=n<18?1:n<48?3:n<144?4:n<768?5:6,i=n<8?new f(t):t.isEven()?new A(t):new v(t);var s=new Array,c=3,u=r-1,l=(1<<r)-1;if(s[1]=i.convert(this),r>1){var h=a();for(i.sqrTo(s[1],h);c<=l;)s[c]=a(),i.mulTo(h,s[c-2],s[c]),c+=2}var g,m,y=e.t-1,C=!0,S=a();for(n=p(e[y])-1;y>=0;){for(n>=u?g=e[y]>>n-u&l:(g=(e[y]&(1<<n+1)-1)<<u-n,y>0&&(g|=e[y-1]>>this.DB+n-u)),c=r;!(1&g);)g>>=1,--c;if((n-=c)<0&&(n+=this.DB,--y),C)s[g].copyTo(o),C=!1;else{for(;c>1;)i.sqrTo(o,S),i.sqrTo(S,o),c-=2;c>0?i.sqrTo(o,S):(m=o,o=S,S=m),i.mulTo(S,s[g],o)}for(;y>=0&&!(e[y]&1<<n);)i.sqrTo(o,S),m=o,o=S,S=m,--n<0&&(n=this.DB-1,--y)}return i.revert(o)},n.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0===e.signum())return n.ZERO;for(var r=e.clone(),i=this.clone(),a=d(1),o=d(0),s=d(0),c=d(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(a.isEven()&&o.isEven()||(a.addTo(this,a),o.subTo(e,o)),a.rShiftTo(1,a)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);for(;i.isEven();)i.rShiftTo(1,i),t?(s.isEven()&&c.isEven()||(s.addTo(this,s),c.subTo(e,c)),s.rShiftTo(1,s)):c.isEven()||c.subTo(e,c),c.rShiftTo(1,c);r.compareTo(i)>=0?(r.subTo(i,r),t&&a.subTo(s,a),o.subTo(c,o)):(i.subTo(r,i),t&&s.subTo(a,s),c.subTo(o,c))}return 0!=i.compareTo(n.ONE)?n.ZERO:c.compareTo(e)>=0?c.subtract(e):c.signum()<0?(c.addTo(e,c),c.signum()<0?c.add(e):c):c},n.prototype.pow=function(e){return this.exp(e,new _)},n.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var i=t;t=r,r=i}var n=t.getLowestSetBit(),a=r.getLowestSetBit();if(a<0)return t;for(n<a&&(a=n),a>0&&(t.rShiftTo(a,t),r.rShiftTo(a,r));t.signum()>0;)(n=t.getLowestSetBit())>0&&t.rShiftTo(n,t),(n=r.getLowestSetBit())>0&&r.rShiftTo(n,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return a>0&&r.lShiftTo(a,r),r},n.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r[0]<=I[I.length-1]){for(t=0;t<I.length;++t)if(r[0]==I[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<I.length;){for(var i=I[t],n=t+1;n<I.length&&i<D;)i*=I[n++];for(i=r.modInt(i);t<n;)if(i%I[t++]==0)return!1}return r.millerRabin(e)},n.int2char=l,n.ZERO=d(0),n.ONE=d(1),n.prototype.square=function(){var e=a();return this.squareTo(e),e},e.exports=n},1799:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.params=t.hex=void 0;const i=r(2986);function n(e){return new i(e.split(/\s|\n/).join(""),16)}t.hex=n,t.params={1024:{N_length_bits:1024,N:n("\n      EEAF0AB9 ADB38DD6 9C33F80A FA8FC5E8 60726187 75FF3C0B 9EA2314C\n      9C256576 D674DF74 96EA81D3 383B4813 D692C6E0 E0D5D8E2 50B98BE4\n      8E495C1D 6089DAD1 5DC7D7B4 6154D6B6 CE8EF4AD 69B15D49 82559B29\n      7BCF1885 C529F566 660E57EC 68EDBC3C 05726CC0 2FD4CBF4 976EAA9A\n      FD5138FE 8376435B 9FC61D2F C0EB06E3\n    "),g:n("02"),hash:"sha1"},1536:{N_length_bits:1536,N:n("\n      9DEF3CAF B939277A B1F12A86 17A47BBB DBA51DF4 99AC4C80 BEEEA961\n      4B19CC4D 5F4F5F55 6E27CBDE 51C6A94B E4607A29 1558903B A0D0F843\n      80B655BB 9A22E8DC DF028A7C EC67F0D0 8134B1C8 B9798914 9B609E0B\n      E3BAB63D 47548381 DBC5B1FC 764E3F4B 53DD9DA1 158BFD3E 2B9C8CF5\n      6EDF0195 39349627 DB2FD53D 24B7C486 65772E43 7D6C7F8C E442734A\n      F7CCB7AE 837C264A E3A9BEB8 7F8A2FE9 B8B5292E 5A021FFF 5E91479E\n      8CE7A28C 2442C6F3 15180F93 499A234D CF76E3FE D135F9BB\n    "),g:n("02"),hash:"sha1"},2048:{N_length_bits:2048,N:n("\n      AC6BDB41 324A9A9B F166DE5E 1389582F AF72B665 1987EE07 FC319294\n      3DB56050 A37329CB B4A099ED 8193E075 7767A13D D52312AB 4B03310D\n      CD7F48A9 DA04FD50 E8083969 EDB767B0 CF609517 9A163AB3 661A05FB\n      D5FAAAE8 2918A996 2F0B93B8 55F97993 EC975EEA A80D740A DBF4FF74\n      7359D041 D5C33EA7 1D281E44 6B14773B CA97B43A 23FB8016 76BD207A\n      436C6481 F1D2B907 8717461A 5B9D32E6 88F87748 544523B5 24B0D57D\n      5EA77A27 75D2ECFA 032CFBDB F52FB378 61602790 04E57AE6 AF874E73\n      03CE5329 9CCC041C 7BC308D8 2A5698F3 A8D0C382 71AE35F8 E9DBFBB6\n      94B5C803 D89F7AE4 35DE236D 525F5475 9B65E372 FCD68EF2 0FA7111F\n      9E4AFF73\n    "),g:n("02"),hash:"sha256"},3072:{N_length_bits:3072,N:n("\n      FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 29024E08\n      8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD EF9519B3 CD3A431B\n      302B0A6D F25F1437 4FE1356D 6D51C245 E485B576 625E7EC6 F44C42E9\n      A637ED6B 0BFF5CB6 F406B7ED EE386BFB 5A899FA5 AE9F2411 7C4B1FE6\n      49286651 ECE45B3D C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8\n      FD24CF5F 83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D\n      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B E39E772C\n      180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9 DE2BCBF6 95581718\n      3995497C EA956AE5 15D22618 98FA0510 15728E5A 8AAAC42D AD33170D\n      04507A33 A85521AB DF1CBA64 ECFB8504 58DBEF0A 8AEA7157 5D060C7D\n      B3970F85 A6E1E4C7 ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226\n      1AD2EE6B F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C\n      BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31 43DB5BFC\n      E0FD108E 4B82D120 A93AD2CA FFFFFFFF FFFFFFFF\n    "),g:n("05"),hash:"sha256"},hap:{N_length_bits:3072,N:n("\n      FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 29024E08\n      8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD EF9519B3 CD3A431B\n      302B0A6D F25F1437 4FE1356D 6D51C245 E485B576 625E7EC6 F44C42E9\n      A637ED6B 0BFF5CB6 F406B7ED EE386BFB 5A899FA5 AE9F2411 7C4B1FE6\n      49286651 ECE45B3D C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8\n      FD24CF5F 83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D\n      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B E39E772C\n      180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9 DE2BCBF6 95581718\n      3995497C EA956AE5 15D22618 98FA0510 15728E5A 8AAAC42D AD33170D\n      04507A33 A85521AB DF1CBA64 ECFB8504 58DBEF0A 8AEA7157 5D060C7D\n      B3970F85 A6E1E4C7 ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226\n      1AD2EE6B F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C\n      BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31 43DB5BFC\n      E0FD108E 4B82D120 A93AD2CA FFFFFFFF FFFFFFFF\n    "),g:n("05"),hash:"sha512"},4096:{N_length_bits:4096,N:n("\n      FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 29024E08\n      8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD EF9519B3 CD3A431B\n      302B0A6D F25F1437 4FE1356D 6D51C245 E485B576 625E7EC6 F44C42E9\n      A637ED6B 0BFF5CB6 F406B7ED EE386BFB 5A899FA5 AE9F2411 7C4B1FE6\n      49286651 ECE45B3D C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8\n      FD24CF5F 83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D\n      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B E39E772C\n      180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9 DE2BCBF6 95581718\n      3995497C EA956AE5 15D22618 98FA0510 15728E5A 8AAAC42D AD33170D\n      04507A33 A85521AB DF1CBA64 ECFB8504 58DBEF0A 8AEA7157 5D060C7D\n      B3970F85 A6E1E4C7 ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226\n      1AD2EE6B F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C\n      BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31 43DB5BFC\n      E0FD108E 4B82D120 A9210801 1A723C12 A787E6D7 88719A10 BDBA5B26\n      99C32718 6AF4E23C 1A946834 B6150BDA 2583E9CA 2AD44CE8 DBBBC2DB\n      04DE8EF9 2E8EFC14 1FBECAA6 287C5947 4E6BC05D 99B2964F A090C3A2\n      233BA186 515BE7ED 1F612970 CEE2D7AF B81BDD76 2170481C D0069127\n      D5B05AA9 93B4EA98 8D8FDDC1 86FFB7DC 90A6C08F 4DF435C9 34063199\n      FFFFFFFF FFFFFFFF\n    "),g:n("05"),hash:"sha256"},6244:{N_length_bits:6244,N:n("\n      FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 29024E08\n      8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD EF9519B3 CD3A431B\n      302B0A6D F25F1437 4FE1356D 6D51C245 E485B576 625E7EC6 F44C42E9\n      A637ED6B 0BFF5CB6 F406B7ED EE386BFB 5A899FA5 AE9F2411 7C4B1FE6\n      49286651 ECE45B3D C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8\n      FD24CF5F 83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D\n      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B E39E772C\n      180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9 DE2BCBF6 95581718\n      3995497C EA956AE5 15D22618 98FA0510 15728E5A 8AAAC42D AD33170D\n      04507A33 A85521AB DF1CBA64 ECFB8504 58DBEF0A 8AEA7157 5D060C7D\n      B3970F85 A6E1E4C7 ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226\n      1AD2EE6B F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C\n      BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31 43DB5BFC\n      E0FD108E 4B82D120 A9210801 1A723C12 A787E6D7 88719A10 BDBA5B26\n      99C32718 6AF4E23C 1A946834 B6150BDA 2583E9CA 2AD44CE8 DBBBC2DB\n      04DE8EF9 2E8EFC14 1FBECAA6 287C5947 4E6BC05D 99B2964F A090C3A2\n      233BA186 515BE7ED 1F612970 CEE2D7AF B81BDD76 2170481C D0069127\n      D5B05AA9 93B4EA98 8D8FDDC1 86FFB7DC 90A6C08F 4DF435C9 34028492\n      36C3FAB4 D27C7026 C1D4DCB2 602646DE C9751E76 3DBA37BD F8FF9406\n      AD9E530E E5DB382F 413001AE B06A53ED 9027D831 179727B0 865A8918\n      DA3EDBEB CF9B14ED 44CE6CBA CED4BB1B DB7F1447 E6CC254B 33205151\n      2BD7AF42 6FB8F401 378CD2BF 5983CA01 C64B92EC F032EA15 D1721D03\n      F482D7CE 6E74FEF6 D55E702F 46980C82 B5A84031 900B1C9E 59E7C97F\n      BEC7E8F3 23A97A7E 36CC88BE 0F1D45B7 FF585AC5 4BD407B2 2B4154AA\n      CC8F6D7E BF48E1D8 14CC5ED2 0F8037E0 A79715EE F29BE328 06A1D58B\n      B7C5DA76 F550AA3D 8A1FBFF0 EB19CCB1 A313D55C DA56C9EC 2EF29632\n      387FE8D7 6E3C0468 043E8F66 3F4860EE 12BF2D5B 0B7474D6 E694F91E\n      6DCC4024 FFFFFFFF FFFFFFFF\n    "),g:n("05"),hash:"sha256"},8192:{N_length_bits:8192,N:n("\n      FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 29024E08\n      8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD EF9519B3 CD3A431B\n      302B0A6D F25F1437 4FE1356D 6D51C245 E485B576 625E7EC6 F44C42E9\n      A637ED6B 0BFF5CB6 F406B7ED EE386BFB 5A899FA5 AE9F2411 7C4B1FE6\n      49286651 ECE45B3D C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8\n      FD24CF5F 83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D\n      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B E39E772C\n      180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9 DE2BCBF6 95581718\n      3995497C EA956AE5 15D22618 98FA0510 15728E5A 8AAAC42D AD33170D\n      04507A33 A85521AB DF1CBA64 ECFB8504 58DBEF0A 8AEA7157 5D060C7D\n      B3970F85 A6E1E4C7 ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226\n      1AD2EE6B F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C\n      BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31 43DB5BFC\n      E0FD108E 4B82D120 A9210801 1A723C12 A787E6D7 88719A10 BDBA5B26\n      99C32718 6AF4E23C 1A946834 B6150BDA 2583E9CA 2AD44CE8 DBBBC2DB\n      04DE8EF9 2E8EFC14 1FBECAA6 287C5947 4E6BC05D 99B2964F A090C3A2\n      233BA186 515BE7ED 1F612970 CEE2D7AF B81BDD76 2170481C D0069127\n      D5B05AA9 93B4EA98 8D8FDDC1 86FFB7DC 90A6C08F 4DF435C9 34028492\n      36C3FAB4 D27C7026 C1D4DCB2 602646DE C9751E76 3DBA37BD F8FF9406\n      AD9E530E E5DB382F 413001AE B06A53ED 9027D831 179727B0 865A8918\n      DA3EDBEB CF9B14ED 44CE6CBA CED4BB1B DB7F1447 E6CC254B 33205151\n      2BD7AF42 6FB8F401 378CD2BF 5983CA01 C64B92EC F032EA15 D1721D03\n      F482D7CE 6E74FEF6 D55E702F 46980C82 B5A84031 900B1C9E 59E7C97F\n      BEC7E8F3 23A97A7E 36CC88BE 0F1D45B7 FF585AC5 4BD407B2 2B4154AA\n      CC8F6D7E BF48E1D8 14CC5ED2 0F8037E0 A79715EE F29BE328 06A1D58B\n      B7C5DA76 F550AA3D 8A1FBFF0 EB19CCB1 A313D55C DA56C9EC 2EF29632\n      387FE8D7 6E3C0468 043E8F66 3F4860EE 12BF2D5B 0B7474D6 E694F91E\n      6DBE1159 74A3926F 12FEE5E4 38777CB6 A932DF8C D8BEC4D0 73B931BA\n      3BC832B6 8D9DD300 741FA7BF 8AFC47ED 2576F693 6BA42466 3AAB639C\n      5AE4F568 3423B474 2BF1C978 238F16CB E39D652D E3FDB8BE FC848AD9\n      22222E04 A4037C07 13EB57A8 1A23F0C7 3473FC64 6CEA306B 4BCBC886\n      2F8385DD FA9D4B7F A2C087E8 79683303 ED5BDD3A 062B3CF5 B3A278A6\n      6D2A13F8 3F44F82D DF310EE0 74AB6A36 4597E899 A0255DC1 64F31CC5\n      0846851D F9AB4819 5DED7EA1 B1D510BD 7EE74D73 FAF36BC3 1ECFA268\n      359046F4 EB879F92 4009438B 481C6CD7 889A002E D5EE382B C9190DA6\n      FC026E47 9558E447 5677E9AA 9E3050E2 765694DF C81F56E8 80B96E71\n      60C980DD 98EDD3DF FFFFFFFF FFFFFFFF\n    "),g:n("13"),hash:"sha256"}},t.default=t.params},4618:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SrpServer=t.SrpClient=t.SRP=void 0;const n=i(r(6982)),a=i(r(2613)),o=r(2986),s=r(1799),c=new o(0,10);function u(e,t){if(!e)throw new Error(t||"assertion")}function l(e,t="arg"){u(Buffer.isBuffer(e),`Type error: ${t} must be a buffer`)}function h(e,t="arg"){u(e instanceof o,`Type error: ${t} must be a BigInteger`)}function d(e,t){l(e,"n");const r=t-e.length;u(r>-1,"Negative padding.  Very uncomfortable.");const i=Buffer.alloc(t);return i.fill(0,0,r),e.copy(i,r),a.default.strictEqual(i.length,t),i}function p(e,t){h(e);const r=e.toString(16).length%2!=0?"0"+e.toString(16):e.toString(16);return d(Buffer.from(r,"hex"),t.N_length_bits/8)}function f(e,t,r,i){l(t,"salt (salt)"),l(r,"identity (I)"),l(i,"password (P)");const a=n.default.createHash(e.hash).update(Buffer.concat([r,Buffer.from(":"),i])).digest(),s=n.default.createHash(e.hash).update(t).update(a).digest();return new o(s)}class v{static computeVerifier(e,t,r,i){l(t,"salt (salt)"),l(r,"identity (I)"),l(i,"password (P)");return e.g.modPow(f(e,t,r,i),e.N).toBuffer(e.N_length_bits/8)}static genKey(e=32,t){if("number"!=typeof e&&(t=e,e=32),!t)return new Promise(((t,r)=>v.genKey(e,((e,i)=>e?r(e):t(i)))));n.default.randomBytes(e,((e,r)=>e?t(e,null):t(null,r)))}}function g(e){const t=n.default.createHash(e.hash).update(p(e.N,e)).update(p(e.g,e)).digest();return new o(t)}function m(e,t,r){l(t,"A"),l(r,"B");const i=n.default.createHash(e.hash).update(d(t,e.N_length_bits/8)).update(d(r,e.N_length_bits/8)).digest();return new o(i)}function y(e,t){return l(t,"S"),"sha1"===e.hash?Buffer.concat([n.default.createHash(e.hash).update(t).update(Buffer.from([0,0,0,0])).digest(),n.default.createHash(e.hash).update(t).update(Buffer.from([0,0,0,1])).digest()]):n.default.createHash(e.hash).update(t).digest()}function C(e,t,r,i,a,o){if(arguments.length>4){l(t,"identity (I)"),l(r,"salt (s)"),l(i,"client public key (A)"),l(a,"server public key (B)"),l(o,"session key (K)");const s=n.default.createHash(e.hash).update(e.N.toBuffer(!0)).digest(),c=n.default.createHash(e.hash).update(e.g.toBuffer(!0)).digest();for(let e=0;e<s.length;e++)s[e]^=c[e];const u=n.default.createHash(e.hash).update(t).digest();return n.default.createHash(e.hash).update(s).update(u).update(r).update(i).update(a).update(o).digest()}return[i,a,r]=[t,r,i],l(i,"A"),l(a,"B"),l(r,"S"),n.default.createHash(e.hash).update(i).update(a).update(r).digest()}function S(e,t,r,i){return l(t,"A"),l(r,"M1"),l(i,"K"),n.default.createHash(e.hash).update(t).update(r).update(i).digest()}function E(e,t){return e.toString("hex")===t.toString("hex")}t.SRP=v,v.params=s.params;t.SrpClient=class{constructor(e,t,r,i,n,a=!0){l(t,"salt (s)"),l(r,"identity (I)"),l(i,"password (P)"),l(n,"secret1"),this._params=e,this._k=g(e),this._x=f(e,t,r,i),this._a=new o(n),a&&(this._I=r,this._s=t),this._A=function(e,t){return h(t),Math.ceil(t.toString(16).length/2)<32&&console.warn("getA: client key length %d is less than the recommended 256 bits",t.bitLength()),e.g.modPow(t,e.N).toBuffer(e.N_length_bits/8)}(e,this._a)}computeA(){return this._A}setB(e){const t=m(this._params,this._A,e),r=function(e,t,r,i,n,a){if(h(t),h(r),h(i),h(n),h(a),c.compareTo(n)>=0||e.N.compareTo(n)<=0)throw new Error('invalid server-supplied "B", must be 1..N-1');return n.subtract(t.multiply(e.g.modPow(r,e.N))).modPow(i.add(a.multiply(r)),e.N).mod(e.N).toBuffer(e.N_length_bits/8)}(this._params,this._k,this._x,this._a,new o(e),t);this._K=y(this._params,r),this._u=t,this._S=r,this._B=e,this._I&&this._s?this._M1=C(this._params,this._I,this._s,this._A,this._B,this._K):this._M1=C(this._params,this._A,this._B,this._S),this._M2=S(this._params,this._A,this._M1,this._K)}computeM1(){if(void 0===this._M1)throw new Error("incomplete protocol");return this._M1}checkM2(e){if(!E(this._M2,e))throw new Error("server is not authentic")}computeK(){if(void 0===this._K)throw new Error("incomplete protocol");return this._K}};t.SrpServer=class{constructor(e,t,r,i,n){if(this._params=e,this._k=g(e),arguments.length>3)l(t,"salt (salt)"),l(r,"identity (I)"),l(i,"password (P)"),l(n,"secret2"),this._b=new o(n),this._v=new o(v.computeVerifier(e,t,r,i)),this._I=r,this._s=t;else if(t instanceof Buffer){const e=t;[n,t,r,i]=[r,void 0,void 0,void 0],l(e,"verifier (v)"),l(n,"secret2"),this._b=new o(n),this._v=new o(e)}else{const s=t;[n,t,r,i]=[r,void 0,void 0,void 0],(0,a.default)(s.username instanceof Buffer||"string"==typeof s.username,"identity.username (I) must be a string or Buffer"),l(s.salt,"identity.salt (s)"),(0,a.default)("password"in s||"verifier"in s,"identity requires a password or verifier"),"verifier"in s?l(s.verifier,"identity.verifier (v)"):(0,a.default)(s.password instanceof Buffer||"string"==typeof s.password,"identity.password (p) must be a string or Buffer"),l(n,"secret2");const c="string"==typeof s.username?Buffer.from(s.username):s.username;this._b=new o(n),this._v=new o("verifier"in s?s.verifier:v.computeVerifier(e,s.salt,c,"string"==typeof s.password?Buffer.from(s.password):s.password)),this._I=c,this._s=s.salt}this._B=function(e,t,r,i){return h(r),h(t),h(i),t.multiply(r).add(e.g.modPow(i,e.N)).mod(e.N).toBuffer(e.N_length_bits/8)}(e,this._k,this._v,this._b)}computeB(){return this._B}setA(e){const t=m(this._params,e,this._B),r=function(e,t,r,i,n){if(h(t),h(r),h(i),h(n),c.compareTo(r)>=0||e.N.compareTo(r)<=0)throw new Error('invalid client-supplied "A", must be 1..N-1');return r.multiply(t.modPow(n,e.N)).modPow(i,e.N).mod(e.N).toBuffer(e.N_length_bits/8)}(this._params,this._v,new o(e),this._b,t);this._K=y(this._params,r),this._u=t,this._S=r,this._I&&this._s?this._M1=C(this._params,this._I,this._s,e,this._B,this._K):this._M1=C(this._params,e,this._B,this._S),this._M2=S(this._params,e,this._M1,this._K)}checkM1(e){if(void 0===this._M1)throw new Error("incomplete protocol");if(!E(this._M1,e))throw new Error("client did not use the same password")}computeK(){if(void 0===this._K)throw new Error("incomplete protocol");return this._K}computeM2(){if(void 0===this._M2)throw new Error("incomplete protocol");return this._M2}}},2682:(e,t,r)=>{"use strict";var i=r(9600),n=Object.prototype.toString,a=Object.prototype.hasOwnProperty;e.exports=function(e,t,r){if(!i(t))throw new TypeError("iterator must be a function");var o;arguments.length>=3&&(o=r),"[object Array]"===n.call(e)?function(e,t,r){for(var i=0,n=e.length;i<n;i++)a.call(e,i)&&(null==r?t(e[i],i,e):t.call(r,e[i],i,e))}(e,t,o):"string"==typeof e?function(e,t,r){for(var i=0,n=e.length;i<n;i++)null==r?t(e.charAt(i),i,e):t.call(r,e.charAt(i),i,e)}(e,t,o):function(e,t,r){for(var i in e)a.call(e,i)&&(null==r?t(e[i],i,e):t.call(r,e[i],i,e))}(e,t,o)}},1813:(e,t,r)=>{"use strict";var i=r(2203);e.exports=function e(t){if(Array.isArray(t)){var r=0,n=t.length;return e((function(e){return r<n?this.emit("data",t[r++]):this.emit("end"),!0}))}var a=new i,o=0;function s(){if(a.started=!0,!a.ended)for(;!a.ended&&!a.paused&&t.call(a,o++,(function(){a.ended||a.paused||process.nextTick(s)})););}return a.ended=!1,a.started=!1,a.readable=!0,a.writable=!1,a.paused=!1,a.ended=!1,a.pause=function(){a.started=!0,a.paused=!0},a.resume=function(){a.started=!0,a.paused=!1,s()},a.on("end",(function(){a.ended=!0,a.readable=!1,process.nextTick(a.destroy)})),a.destroy=function(){a.ended=!0,a.emit("close")},process.nextTick((function(){a.started||a.resume()})),a}},9353:e=>{"use strict";var t=Object.prototype.toString,r=Math.max,i=function(e,t){for(var r=[],i=0;i<e.length;i+=1)r[i]=e[i];for(var n=0;n<t.length;n+=1)r[n+e.length]=t[n];return r};e.exports=function(e){var n=this;if("function"!=typeof n||"[object Function]"!==t.apply(n))throw new TypeError("Function.prototype.bind called on incompatible "+n);for(var a,o=function(e,t){for(var r=[],i=t||0,n=0;i<e.length;i+=1,n+=1)r[n]=e[i];return r}(arguments,1),s=r(0,n.length-o.length),c=[],u=0;u<s;u++)c[u]="$"+u;if(a=Function("binder","return function ("+function(e,t){for(var r="",i=0;i<e.length;i+=1)r+=e[i],i+1<e.length&&(r+=t);return r}(c,",")+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof a){var t=n.apply(this,i(o,arguments));return Object(t)===t?t:this}return n.apply(e,i(o,arguments))})),n.prototype){var l=function(){};l.prototype=n.prototype,a.prototype=new l,l.prototype=null}return a}},6743:(e,t,r)=>{"use strict";var i=r(9353);e.exports=Function.prototype.bind||i},4462:e=>{"use strict";var t=function(){return"string"==typeof function(){}.name},r=Object.getOwnPropertyDescriptor;if(r)try{r([],"length")}catch(e){r=null}t.functionsHaveConfigurableNames=function(){if(!t()||!r)return!1;var e=r((function(){}),"name");return!!e&&!!e.configurable};var i=Function.prototype.bind;t.boundFunctionsHaveNames=function(){return t()&&"function"==typeof i&&""!==function(){}.bind().name},e.exports=t},6871:(e,t,r)=>{"use strict";const{Buffer:i}=r(181),{createHash:n,createHmac:a}=r(6982),o={},s=e=>{switch(e){case"sha256":case"sha3-256":case"blake2s256":return 32;case"sha512":case"sha3-512":case"blake2b512":return 64;case"sha224":case"sha3-224":return 28;case"sha384":case"sha3-384":return 48;case"sha1":return 20;case"md5":return 16;default:{let t=o[e];return void 0===t&&(t=n(e).digest().length,o[e]=t),t}}},c=(e,t,r,n)=>{const o=i.isBuffer(r)?r:i.from(r),s=n&&n.length?i.from(n):i.alloc(t,0);return a(e,s).update(o).digest()},u=(e,t,r,n,o)=>{const s=i.isBuffer(o)?o:i.from(o||""),c=s.length,u=Math.ceil(n/t);if(u>255)throw new Error(`OKM length ${n} is too long for ${e} hash`);const l=i.alloc(t*u+c+1);for(let i=1,n=0,o=0;i<=u;++i)s.copy(l,o),l[o+c]=i,a(e,r).update(l.slice(n,o+c+1)).digest().copy(l,o),n=o,o+=t;return l.slice(0,n)};function l(e,t,{salt:r="",info:i="",hash:n="SHA-256"}={}){n=n.toLowerCase().replace("-","");const a=s(n),o=c(n,a,e,r);return u(n,a,o,t,i)}Object.defineProperties(l,{hash_length:{configurable:!1,enumerable:!1,writable:!1,value:s},extract:{configurable:!1,enumerable:!1,writable:!1,value:c},expand:{configurable:!1,enumerable:!1,writable:!1,value:u}}),e.exports=l},453:(e,t,r)=>{"use strict";var i,n=r(9383),a=r(1237),o=r(9290),s=r(9538),c=r(8068),u=r(9675),l=r(5345),h=Function,d=function(e){try{return h('"use strict"; return ('+e+").constructor;")()}catch(e){}},p=Object.getOwnPropertyDescriptor;if(p)try{p({},"")}catch(e){p=null}var f=function(){throw new u},v=p?function(){try{return f}catch(e){try{return p(arguments,"callee").get}catch(e){return f}}}():f,g=r(4039)(),m=r(24)(),y=Object.getPrototypeOf||(m?function(e){return e.__proto__}:null),C={},S="undefined"!=typeof Uint8Array&&y?y(Uint8Array):i,E={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?i:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?i:ArrayBuffer,"%ArrayIteratorPrototype%":g&&y?y([][Symbol.iterator]()):i,"%AsyncFromSyncIteratorPrototype%":i,"%AsyncFunction%":C,"%AsyncGenerator%":C,"%AsyncGeneratorFunction%":C,"%AsyncIteratorPrototype%":C,"%Atomics%":"undefined"==typeof Atomics?i:Atomics,"%BigInt%":"undefined"==typeof BigInt?i:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?i:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?i:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?i:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":n,"%eval%":eval,"%EvalError%":a,"%Float32Array%":"undefined"==typeof Float32Array?i:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?i:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?i:FinalizationRegistry,"%Function%":h,"%GeneratorFunction%":C,"%Int8Array%":"undefined"==typeof Int8Array?i:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?i:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?i:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":g&&y?y(y([][Symbol.iterator]())):i,"%JSON%":"object"==typeof JSON?JSON:i,"%Map%":"undefined"==typeof Map?i:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&g&&y?y((new Map)[Symbol.iterator]()):i,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?i:Promise,"%Proxy%":"undefined"==typeof Proxy?i:Proxy,"%RangeError%":o,"%ReferenceError%":s,"%Reflect%":"undefined"==typeof Reflect?i:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?i:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&g&&y?y((new Set)[Symbol.iterator]()):i,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?i:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":g&&y?y(""[Symbol.iterator]()):i,"%Symbol%":g?Symbol:i,"%SyntaxError%":c,"%ThrowTypeError%":v,"%TypedArray%":S,"%TypeError%":u,"%Uint8Array%":"undefined"==typeof Uint8Array?i:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?i:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?i:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?i:Uint32Array,"%URIError%":l,"%WeakMap%":"undefined"==typeof WeakMap?i:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?i:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?i:WeakSet};if(y)try{null.error}catch(e){var _=y(y(e));E["%Error.prototype%"]=_}var T=function e(t){var r;if("%AsyncFunction%"===t)r=d("async function () {}");else if("%GeneratorFunction%"===t)r=d("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=d("async function* () {}");else if("%AsyncGenerator%"===t){var i=e("%AsyncGeneratorFunction%");i&&(r=i.prototype)}else if("%AsyncIteratorPrototype%"===t){var n=e("%AsyncGenerator%");n&&y&&(r=y(n.prototype))}return E[t]=r,r},A={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},I=r(6743),D=r(9957),w=I.call(Function.call,Array.prototype.concat),b=I.call(Function.apply,Array.prototype.splice),U=I.call(Function.call,String.prototype.replace),R=I.call(Function.call,String.prototype.slice),O=I.call(Function.call,RegExp.prototype.exec),N=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,P=/\\(\\)?/g,B=function(e,t){var r,i=e;if(D(A,i)&&(i="%"+(r=A[i])[0]+"%"),D(E,i)){var n=E[i];if(n===C&&(n=T(i)),void 0===n&&!t)throw new u("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:i,value:n}}throw new c("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new u("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new u('"allowMissing" argument must be a boolean');if(null===O(/^%?[^%]*%?$/,e))throw new c("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=function(e){var t=R(e,0,1),r=R(e,-1);if("%"===t&&"%"!==r)throw new c("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new c("invalid intrinsic syntax, expected opening `%`");var i=[];return U(e,N,(function(e,t,r,n){i[i.length]=r?U(n,P,"$1"):t||e})),i}(e),i=r.length>0?r[0]:"",n=B("%"+i+"%",t),a=n.name,o=n.value,s=!1,l=n.alias;l&&(i=l[0],b(r,w([0,1],l)));for(var h=1,d=!0;h<r.length;h+=1){var f=r[h],v=R(f,0,1),g=R(f,-1);if(('"'===v||"'"===v||"`"===v||'"'===g||"'"===g||"`"===g)&&v!==g)throw new c("property names with quotes must have matching quotes");if("constructor"!==f&&d||(s=!0),D(E,a="%"+(i+="."+f)+"%"))o=E[a];else if(null!=o){if(!(f in o)){if(!t)throw new u("base intrinsic for "+e+" exists, but the property is not available.");return}if(p&&h+1>=r.length){var m=p(o,f);o=(d=!!m)&&"get"in m&&!("originalValue"in m.get)?m.get:o[f]}else d=D(o,f),o=o[f];d&&!s&&(E[a]=o)}}return o}},5795:(e,t,r)=>{"use strict";var i=r(453)("%Object.getOwnPropertyDescriptor%",!0);if(i)try{i([],"length")}catch(e){i=null}e.exports=i},135:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MANUFACTURER_CTYPE=t.LOGS_CTYPE=t.LOCK_MECHANISM_LAST_KNOWN_ACTION_CTYPE=t.LOCK_MANAGEMENT_CONTROL_POINT_CTYPE=t.LOCK_MANAGEMENT_AUTO_SECURE_TIMEOUT_CTYPE=t.IDENTIFY_CTYPE=t.HUE_CTYPE=t.HEATING_THRESHOLD_CTYPE=t.CURRENT_TEMPERATURE_CTYPE=t.CURRENT_RELATIVE_HUMIDITY_CTYPE=t.CURRENT_LOCK_MECHANISM_STATE_CTYPE=t.CURRENT_DOOR_STATE_CTYPE=t.CONTACT_SENSOR_STATE_CTYPE=t.COOLING_THRESHOLD_CTYPE=t.BATTERY_LEVEL_CTYPE=t.BRIGHTNESS_CTYPE=t.AUDIO_FEEDBACK_CTYPE=t.ADMIN_ONLY_ACCESS_CTYPE=t.ALARM_TARGET_STATE_CTYPE=t.ALARM_CURRENT_STATE_CTYPE=t.TEMPERATURE_SENSOR_STYPE=t.HUMIDITY_SENSOR_STYPE=t.MOTION_SENSOR_STYPE=t.CONTACT_SENSOR_STYPE=t.OCCUPANCY_SENSOR_STYPE=t.WINDOW_COVERING_STYPE=t.ALARM_STYPE=t.LOCK_MANAGEMENT_STYPE=t.LOCK_MECHANISM_STYPE=t.OUTLET_STYPE=t.FAN_STYPE=t.ACCESSORY_INFORMATION_STYPE=t.GARAGE_DOOR_OPENER_STYPE=t.THERMOSTAT_STYPE=t.SWITCH_STYPE=t.LIGHTBULB_STYPE=t.PROGRAMMABLE_SWITCH_TCTYPE=t.WINDOW_COVERING_TCTYPE=t.WINDOW_TCTYPE=t.DOOR_TCTYPE=t.ALARM_SYSTEM_TCTYPE=t.SENSOR_TCTYPE=t.THERMOSTAT_TCTYPE=t.SWITCH_TCTYPE=t.OUTLET_TCTYPE=t.DOOR_LOCK_TCTYPE=t.LIGHTBULB_TCTYPE=t.GARAGE_DOOR_OPENER_TCTYPE=t.FAN_TCTYPE=t.OTHER_TCTYPE=void 0,t.TARGETHEATINGCOOLING_CTYPE=t.CURRENTHEATINGCOOLING_CTYPE=t.WINDOW_COVERING_OPERATION_STATE_CTYPE=t.WINDOW_COVERING_CURRENT_POSITION_CTYPE=t.WINDOW_COVERING_TARGET_POSITION_CTYPE=t.VERSION_CTYPE=t.TEMPERATURE_UNITS_CTYPE=t.TARGET_TEMPERATURE_CTYPE=t.TARGET_RELATIVE_HUMIDITY_CTYPE=t.TARGET_LOCK_MECHANISM_STATE_CTYPE=t.TARGET_DOORSTATE_CTYPE=t.STATUS_FAULT_CTYPE=t.STATUS_LOW_BATTERY_CTYPE=t.FIRMWARE_REVISION_CTYPE=t.SERIAL_NUMBER_CTYPE=t.SATURATION_CTYPE=t.ROTATION_SPEED_CTYPE=t.ROTATION_DIRECTION_CTYPE=t.PROGRAMMABLE_SWITCH_OUTPUT_STATE_CTYPE=t.PROGRAMMABLE_SWITCH_SWITCH_EVENT_CTYPE=t.POWER_STATE_CTYPE=t.OCCUPANCY_DETECTED_CTYPE=t.OUTLET_IN_USE_CTYPE=t.OBSTRUCTION_DETECTED_CTYPE=t.NAME_CTYPE=t.MOTION_DETECTED_CTYPE=t.MODEL_CTYPE=void 0;var r="000000",i="-0000-1000-8000-0026BB765291";t.OTHER_TCTYPE=1,t.FAN_TCTYPE=3,t.GARAGE_DOOR_OPENER_TCTYPE=4,t.LIGHTBULB_TCTYPE=5,t.DOOR_LOCK_TCTYPE=6,t.OUTLET_TCTYPE=7,t.SWITCH_TCTYPE=8,t.THERMOSTAT_TCTYPE=9,t.SENSOR_TCTYPE=10,t.ALARM_SYSTEM_TCTYPE=11,t.DOOR_TCTYPE=12,t.WINDOW_TCTYPE=13,t.WINDOW_COVERING_TCTYPE=14,t.PROGRAMMABLE_SWITCH_TCTYPE=15,t.LIGHTBULB_STYPE=r+"43"+i,t.SWITCH_STYPE=r+"49"+i,t.THERMOSTAT_STYPE=r+"4A"+i,t.GARAGE_DOOR_OPENER_STYPE=r+"41"+i,t.ACCESSORY_INFORMATION_STYPE=r+"3E"+i,t.FAN_STYPE=r+"40"+i,t.OUTLET_STYPE=r+"47"+i,t.LOCK_MECHANISM_STYPE=r+"45"+i,t.LOCK_MANAGEMENT_STYPE=r+"44"+i,t.ALARM_STYPE=r+"7E"+i,t.WINDOW_COVERING_STYPE=r+"8C"+i,t.OCCUPANCY_SENSOR_STYPE=r+"86"+i,t.CONTACT_SENSOR_STYPE=r+"80"+i,t.MOTION_SENSOR_STYPE=r+"85"+i,t.HUMIDITY_SENSOR_STYPE=r+"82"+i,t.TEMPERATURE_SENSOR_STYPE=r+"8A"+i,t.ALARM_CURRENT_STATE_CTYPE=r+"66"+i,t.ALARM_TARGET_STATE_CTYPE=r+"67"+i,t.ADMIN_ONLY_ACCESS_CTYPE=r+"01"+i,t.AUDIO_FEEDBACK_CTYPE=r+"05"+i,t.BRIGHTNESS_CTYPE=r+"08"+i,t.BATTERY_LEVEL_CTYPE=r+"68"+i,t.COOLING_THRESHOLD_CTYPE=r+"0D"+i,t.CONTACT_SENSOR_STATE_CTYPE=r+"6A"+i,t.CURRENT_DOOR_STATE_CTYPE=r+"0E"+i,t.CURRENT_LOCK_MECHANISM_STATE_CTYPE=r+"1D"+i,t.CURRENT_RELATIVE_HUMIDITY_CTYPE=r+"10"+i,t.CURRENT_TEMPERATURE_CTYPE=r+"11"+i,t.HEATING_THRESHOLD_CTYPE=r+"12"+i,t.HUE_CTYPE=r+"13"+i,t.IDENTIFY_CTYPE=r+"14"+i,t.LOCK_MANAGEMENT_AUTO_SECURE_TIMEOUT_CTYPE=r+"1A"+i,t.LOCK_MANAGEMENT_CONTROL_POINT_CTYPE=r+"19"+i,t.LOCK_MECHANISM_LAST_KNOWN_ACTION_CTYPE=r+"1C"+i,t.LOGS_CTYPE=r+"1F"+i,t.MANUFACTURER_CTYPE=r+"20"+i,t.MODEL_CTYPE=r+"21"+i,t.MOTION_DETECTED_CTYPE=r+"22"+i,t.NAME_CTYPE=r+"23"+i,t.OBSTRUCTION_DETECTED_CTYPE=r+"24"+i,t.OUTLET_IN_USE_CTYPE=r+"26"+i,t.OCCUPANCY_DETECTED_CTYPE=r+"71"+i,t.POWER_STATE_CTYPE=r+"25"+i,t.PROGRAMMABLE_SWITCH_SWITCH_EVENT_CTYPE=r+"73"+i,t.PROGRAMMABLE_SWITCH_OUTPUT_STATE_CTYPE=r+"74"+i,t.ROTATION_DIRECTION_CTYPE=r+"28"+i,t.ROTATION_SPEED_CTYPE=r+"29"+i,t.SATURATION_CTYPE=r+"2F"+i,t.SERIAL_NUMBER_CTYPE=r+"30"+i,t.FIRMWARE_REVISION_CTYPE=r+"52"+i,t.STATUS_LOW_BATTERY_CTYPE=r+"79"+i,t.STATUS_FAULT_CTYPE=r+"77"+i,t.TARGET_DOORSTATE_CTYPE=r+"32"+i,t.TARGET_LOCK_MECHANISM_STATE_CTYPE=r+"1E"+i,t.TARGET_RELATIVE_HUMIDITY_CTYPE=r+"34"+i,t.TARGET_TEMPERATURE_CTYPE=r+"35"+i,t.TEMPERATURE_UNITS_CTYPE=r+"36"+i,t.VERSION_CTYPE=r+"37"+i,t.WINDOW_COVERING_TARGET_POSITION_CTYPE=r+"7C"+i,t.WINDOW_COVERING_CURRENT_POSITION_CTYPE=r+"6D"+i,t.WINDOW_COVERING_OPERATION_STATE_CTYPE=r+"72"+i,t.CURRENTHEATINGCOOLING_CTYPE=r+"0F"+i,t.TARGETHEATINGCOOLING_CTYPE=r+"33"+i},3103:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=t.HAPLibraryVersion=t.LegacyTypes=t.uuid=t.AccessoryLoader=void 0;var i=r(1635);r(3476),r(8086);var n=i.__importDefault(r(5753)),a=r(4299);t.AccessoryLoader=i.__importStar(r(1370)),t.uuid=i.__importStar(r(2997)),i.__exportStar(r(4299),t),i.__exportStar(r(5745),t),i.__exportStar(r(3186),t),i.__exportStar(r(5876),t),i.__exportStar(r(9826),t),i.__exportStar(r(1370),t),i.__exportStar(r(8591),t),i.__exportStar(r(4910),t),i.__exportStar(r(589),t),i.__exportStar(r(9948),t),i.__exportStar(r(1068),t),i.__exportStar(r(5579),t),i.__exportStar(r(9621),t),i.__exportStar(r(7739),t),i.__exportStar(r(3314),t),i.__exportStar(r(8073),t),i.__exportStar(r(2175),t),i.__exportStar(r(1579),t),i.__exportStar(r(9593),t),i.__exportStar(r(4310),t),t.LegacyTypes=i.__importStar(r(135));var o=(0,n.default)("HAP-NodeJS:Advertiser");function s(){return r(8389).version}t.HAPLibraryVersion=s,o("Initializing HAP-NodeJS v%s ...",s()),t.init=function(e){console.log("DEPRECATED: The need to manually initialize HAP (by calling the init method) was removed. If you want to set a custom storage path location, please ust HAPStorage.setCustomStoragePath directly. This method will be removed in the next major update!"),e&&a.HAPStorage.setCustomStoragePath(e)};i.__importStar(r(1647)),i.__importStar(r(651))},8602:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HAPMimeTypes=t.PairingStates=t.PairMethods=t.TLVValues=t.consideredTrue=void 0,t.consideredTrue=function(e){return!!e&&("true"===e||"1"===e)},function(e){e[e.REQUEST_TYPE=0]="REQUEST_TYPE",e[e.METHOD=0]="METHOD",e[e.USERNAME=1]="USERNAME",e[e.IDENTIFIER=1]="IDENTIFIER",e[e.SALT=2]="SALT",e[e.PUBLIC_KEY=3]="PUBLIC_KEY",e[e.PASSWORD_PROOF=4]="PASSWORD_PROOF",e[e.ENCRYPTED_DATA=5]="ENCRYPTED_DATA",e[e.SEQUENCE_NUM=6]="SEQUENCE_NUM",e[e.STATE=6]="STATE",e[e.ERROR_CODE=7]="ERROR_CODE",e[e.RETRY_DELAY=8]="RETRY_DELAY",e[e.CERTIFICATE=9]="CERTIFICATE",e[e.PROOF=10]="PROOF",e[e.SIGNATURE=10]="SIGNATURE",e[e.PERMISSIONS=11]="PERMISSIONS",e[e.FRAGMENT_DATA=12]="FRAGMENT_DATA",e[e.FRAGMENT_LAST=13]="FRAGMENT_LAST",e[e.SEPARATOR=255]="SEPARATOR"}(t.TLVValues||(t.TLVValues={})),function(e){e[e.PAIR_SETUP=0]="PAIR_SETUP",e[e.PAIR_SETUP_WITH_AUTH=1]="PAIR_SETUP_WITH_AUTH",e[e.PAIR_VERIFY=2]="PAIR_VERIFY",e[e.ADD_PAIRING=3]="ADD_PAIRING",e[e.REMOVE_PAIRING=4]="REMOVE_PAIRING",e[e.LIST_PAIRINGS=5]="LIST_PAIRINGS"}(t.PairMethods||(t.PairMethods={})),function(e){e[e.M1=1]="M1",e[e.M2=2]="M2",e[e.M3=3]="M3",e[e.M4=4]="M4",e[e.M5=5]="M5",e[e.M6=6]="M6"}(t.PairingStates||(t.PairingStates={})),function(e){e.PAIRING_TLV8="application/pairing+tlv8",e.HAP_JSON="application/hap+json",e.IMAGE_JPEG="image/jpeg"}(t.HAPMimeTypes||(t.HAPMimeTypes={}))},5745:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Accessory=t.AccessoryEventTypes=t.MDNSAdvertiser=t.CharacteristicWarningType=t.Categories=void 0;var i,n,a=r(1635),o=a.__importDefault(r(2613)),s=a.__importDefault(r(6982)),c=a.__importDefault(r(5753)),u=r(4434),l=a.__importDefault(r(9278)),h=r(310),d=r(8591),p=r(9826),f=r(1068),v=r(589),g=r(5579),m=r(292),y=r(2738),C=r(5876),S=r(9621),E=r(8066),_=a.__importStar(r(2997)),T=r(2997),A=(0,c.default)("HAP-NodeJS:Accessory");!function(e){e[e.OTHER=1]="OTHER",e[e.BRIDGE=2]="BRIDGE",e[e.FAN=3]="FAN",e[e.GARAGE_DOOR_OPENER=4]="GARAGE_DOOR_OPENER",e[e.LIGHTBULB=5]="LIGHTBULB",e[e.DOOR_LOCK=6]="DOOR_LOCK",e[e.OUTLET=7]="OUTLET",e[e.SWITCH=8]="SWITCH",e[e.THERMOSTAT=9]="THERMOSTAT",e[e.SENSOR=10]="SENSOR",e[e.ALARM_SYSTEM=11]="ALARM_SYSTEM",e[e.SECURITY_SYSTEM=11]="SECURITY_SYSTEM",e[e.DOOR=12]="DOOR",e[e.WINDOW=13]="WINDOW",e[e.WINDOW_COVERING=14]="WINDOW_COVERING",e[e.PROGRAMMABLE_SWITCH=15]="PROGRAMMABLE_SWITCH",e[e.RANGE_EXTENDER=16]="RANGE_EXTENDER",e[e.CAMERA=17]="CAMERA",e[e.IP_CAMERA=17]="IP_CAMERA",e[e.VIDEO_DOORBELL=18]="VIDEO_DOORBELL",e[e.AIR_PURIFIER=19]="AIR_PURIFIER",e[e.AIR_HEATER=20]="AIR_HEATER",e[e.AIR_CONDITIONER=21]="AIR_CONDITIONER",e[e.AIR_HUMIDIFIER=22]="AIR_HUMIDIFIER",e[e.AIR_DEHUMIDIFIER=23]="AIR_DEHUMIDIFIER",e[e.APPLE_TV=24]="APPLE_TV",e[e.HOMEPOD=25]="HOMEPOD",e[e.SPEAKER=26]="SPEAKER",e[e.AIRPORT=27]="AIRPORT",e[e.SPRINKLER=28]="SPRINKLER",e[e.FAUCET=29]="FAUCET",e[e.SHOWER_HEAD=30]="SHOWER_HEAD",e[e.TELEVISION=31]="TELEVISION",e[e.TARGET_CONTROLLER=32]="TARGET_CONTROLLER",e[e.ROUTER=33]="ROUTER",e[e.AUDIO_RECEIVER=34]="AUDIO_RECEIVER",e[e.TV_SET_TOP_BOX=35]="TV_SET_TOP_BOX",e[e.TV_STREAMING_STICK=36]="TV_STREAMING_STICK"}(i=t.Categories||(t.Categories={})),function(e){e.SLOW_WRITE="slow-write",e.TIMEOUT_WRITE="timeout-write",e.SLOW_READ="slow-read",e.TIMEOUT_READ="timeout-read",e.WARN_MESSAGE="warn-message",e.ERROR_MESSAGE="error-message",e.DEBUG_MESSAGE="debug-message"}(t.CharacteristicWarningType||(t.CharacteristicWarningType={})),function(e){e.CIAO="ciao",e.BONJOUR="bonjour-hap",e.AVAHI="avahi",e.RESOLVED="resolved"}(t.MDNSAdvertiser||(t.MDNSAdvertiser={})),function(e){e[e.REGULAR_REQUEST=0]="REGULAR_REQUEST",e[e.TIMED_WRITE_AUTHENTICATED=1]="TIMED_WRITE_AUTHENTICATED",e[e.TIMED_WRITE_REJECTED=2]="TIMED_WRITE_REJECTED"}(n||(n={})),function(e){e.IDENTIFY="identify",e.LISTENING="listening",e.ADVERTISED="advertised",e.SERVICE_CONFIGURATION_CHANGE="service-configurationChange",e.SERVICE_CHARACTERISTIC_CHANGE="service-characteristic-change",e.PAIRED="paired",e.UNPAIRED="unpaired",e.CHARACTERISTIC_WARNING="characteristic-warning"}(t.AccessoryEventTypes||(t.AccessoryEventTypes={}));var I=function(e){function t(t,r){var i=e.call(this)||this;return i.displayName=t,i.UUID=r,i.aid=null,i._isBridge=!1,i.bridged=!1,i.bridgedAccessories=[],i.reachable=!0,i.category=1,i.services=[],i.shouldPurgeUnusedIDs=!0,i.initialized=!1,i.controllers={},i._setupID=null,i.controllerStorage=new m.ControllerStorage(i),i.lastAccessoriesRequest=0,i.getPrimaryAccessory=function(){return i.bridged?i.bridge:i},(0,o.default)(t,"Accessories must be created with a non-empty displayName."),(0,o.default)(r,"Accessories must be created with a valid UUID."),(0,o.default)(_.isValid(r),"UUID '"+r+"' is not a valid UUID. Try using the provided 'generateUUID' function to create a valid UUID from any arbitrary string, like a serial number."),i.addService(C.Service.AccessoryInformation).setCharacteristic(p.Characteristic.Name,t),i.getService(C.Service.AccessoryInformation).getCharacteristic(p.Characteristic.Identify).on("set",(function(e,t){if(e){i.identificationRequest(!0,t)}})),i}return a.__extends(t,e),t.prototype.identificationRequest=function(e,t){A("[%s] Identification request",this.displayName),this.listeners("identify").length>0?this.emit("identify",e,t):(A("[%s] Identification request ignored; no listeners to 'identify' event",this.displayName),t())},t.prototype.addService=function(e){for(var t,r,i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var o="function"==typeof e?new e(i[0],i[1],i[2]):e;try{for(var s=a.__values(this.services),c=s.next();!c.done;c=s.next()){var u=c.value;if(u.UUID===o.UUID){if(!o.subtype)throw new Error("Cannot add a Service with the same UUID '"+u.UUID+"' as another Service in this Accessory without also defining a unique 'subtype' property.");if(o.subtype===u.subtype)throw new Error("Cannot add a Service with the same UUID '"+u.UUID+"' and subtype '"+u.subtype+"' as another Service in this Accessory.")}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}if(this.services.length>=100)throw new Error("Cannot add more than 100 services to a single accessory!");return this.services.push(o),o.isPrimaryService&&(void 0!==this.primaryService&&(this.primaryService.isPrimaryService=!1),this.primaryService=o),this.bridged?this.emit("service-configurationChange",{service:o}):this.enqueueConfigurationUpdate(),this.setupServiceEventHandlers(o),o},t.prototype.setPrimaryService=function(e){e.setPrimaryService()},t.prototype.removeService=function(e){var t=this.services.indexOf(e);t>=0&&(this.services.splice(t,1),this.primaryService===e&&(this.primaryService=void 0),this.removeLinkedService(e),this.bridged?this.emit("service-configurationChange",{service:e}):this.enqueueConfigurationUpdate(),e.removeAllListeners())},t.prototype.removeLinkedService=function(e){var t,r;try{for(var i=a.__values(this.services),n=i.next();!n.done;n=i.next()){n.value.removeLinkedService(e)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}},t.prototype.getService=function(e){var t,r;try{for(var i=a.__values(this.services),n=i.next();!n.done;n=i.next()){var o=n.value;if("string"==typeof e&&(o.displayName===e||o.name===e||o.subtype===e))return o;if("function"==typeof e&&(o instanceof e||e.UUID===o.UUID))return o}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}},t.prototype.getServiceById=function(e,t){var r,i;try{for(var n=a.__values(this.services),o=n.next();!o.done;o=n.next()){var s=o.value;if("string"==typeof e&&(s.displayName===e||s.name===e)&&s.subtype===t)return s;if("function"==typeof e&&(s instanceof e||e.UUID===s.UUID)&&s.subtype===t)return s}}catch(e){r={error:e}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(r)throw r.error}}},t.prototype.updateReachability=function(e){if(!this.bridged)throw new Error("Cannot update reachability on non-bridged accessory!");this.reachable=e,A("Reachability update is no longer being supported.")},t.prototype.addBridgedAccessory=function(e,t){var r=this;if(void 0===t&&(t=!1),e._isBridge||e===this)throw new Error("Illegal state: either trying to bridge a bridge or trying to bridge itself!");if(e.initialized)throw new Error("Tried to bridge an accessory which was already published once!");if(null!=e.bridge)throw new Error("Tried to bridge "+e.displayName+" while it was already bridged by "+e.bridge.displayName);if(this.bridgedAccessories.length>=149)throw new Error("Cannot Bridge more than 149 Accessories");return e.on("service-characteristic-change",(function(t){return r.handleCharacteristicChangeEvent(e,t.service,t)})),e.on("service-configurationChange",this.enqueueConfigurationUpdate.bind(this)),e.on("characteristic-warning",this.handleCharacteristicWarning.bind(this)),e.bridged=!0,e.bridge=this,this.bridgedAccessories.push(e),this.controllerStorage.linkAccessory(e),t||this.enqueueConfigurationUpdate(),e},t.prototype.addBridgedAccessories=function(e){var t,r;try{for(var i=a.__values(e),n=i.next();!n.done;n=i.next()){var o=n.value;this.addBridgedAccessory(o,!0)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}this.enqueueConfigurationUpdate()},t.prototype.removeBridgedAccessory=function(e,t){void 0===t&&(t=!1);var r=this.bridgedAccessories.indexOf(e);if(-1===r)throw new Error("Cannot find the bridged Accessory to remove.");this.bridgedAccessories.splice(r,1),e.bridged=!1,e.bridge=void 0,e.removeAllListeners(),t||this.enqueueConfigurationUpdate()},t.prototype.removeBridgedAccessories=function(e){var t,r;try{for(var i=a.__values(e),n=i.next();!n.done;n=i.next()){var o=n.value;this.removeBridgedAccessory(o,!0)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}this.enqueueConfigurationUpdate()},t.prototype.removeAllBridgedAccessories=function(){for(var e=this.bridgedAccessories.length-1;e>=0;e--)this.removeBridgedAccessory(this.bridgedAccessories[e],!0);this.enqueueConfigurationUpdate()},t.prototype.getCharacteristicByIID=function(e){var t,r;try{for(var i=a.__values(this.services),n=i.next();!n.done;n=i.next()){var o=n.value.getCharacteristicByIID(e);if(o)return o}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}},t.prototype.getAccessoryByAID=function(e){return this.aid===e?this:this.bridgedAccessories.find((function(t){return t.aid===e}))},t.prototype.findCharacteristic=function(e,t){var r=this.getAccessoryByAID(e);return r&&r.getCharacteristicByIID(t)},t.prototype.configureCameraSource=function(e){var t=this;if(0===e.streamControllers.length)throw new Error("Malformed legacy CameraSource. Did not expose any StreamControllers!");var r=e.streamControllers[0].options,i={cameraStreamCount:e.streamControllers.length,streamingOptions:r,delegate:new d.LegacyCameraSourceAdapter(e)},n=new f.CameraController(i,!0);return this.configureController(n),e.services.forEach((function(e){e.UUID!==C.Service.CameraRTPStreamManagement.UUID&&e.UUID!==C.Service.CameraOperatingMode.UUID&&e.UUID!==C.Service.CameraRecordingManagement.UUID&&t.addService(e)})),e.streamControllers=n.streamManagements,n},t.prototype.configureController=function(e){var t=this,r="function"==typeof e?new e:e,i=r.controllerId();if(this.controllers[i])throw new Error("A Controller with the type/id '".concat(i,"' was already added to the accessory ").concat(this.displayName));var n,a=this.serializedControllers&&this.serializedControllers[i];if(a){var o=(0,S.clone)(a),s=r.initWithServices(a);n=s||a,s&&this.handleUpdatedControllerServiceMap(o,s),r.configureServices(),delete this.serializedControllers[i],0===Object.entries(this.serializedControllers).length&&(this.serializedControllers=void 0)}else n=r.constructServices(),r.configureServices(),Object.values(n).forEach((function(e){e&&!t.services.includes(e)&&t.addService(e)}));var c={controller:r,serviceMap:n};(0,f.isSerializableController)(r)&&this.controllerStorage.trackController(r),this.controllers[i]=c,r instanceof f.CameraController&&(this.activeCameraController=r)},t.prototype.removeController=function(e){var t=this,r=e.controllerId(),i=this.controllers[r];if(i){if(i.controller!==e)throw new Error("["+this.displayName+"] tried removing a controller with the id/type '"+r+"' though provided controller isn't the same instance that is registered!");(0,f.isSerializableController)(e)&&this.controllerStorage.untrackController(e),e.handleFactoryReset&&e.handleFactoryReset(),e.handleControllerRemoved(),delete this.controllers[r],this.activeCameraController===e&&(this.activeCameraController=void 0),Object.values(i.serviceMap).forEach((function(e){e&&t.removeService(e)}))}this.serializedControllers&&delete this.serializedControllers[r]},t.prototype.handleAccessoryUnpairedForControllers=function(){var e,t;try{for(var r=a.__values(Object.values(this.controllers)),i=r.next();!i.done;i=r.next()){var n=i.value.controller;n.handleFactoryReset&&n.handleFactoryReset(),(0,f.isSerializableController)(n)&&this.controllerStorage.purgeControllerData(n)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},t.prototype.handleUpdatedControllerServiceMap=function(e,t){var r=this;t=(0,S.clone)(t),Object.keys(e).forEach((function(i){var n=e[i],a=t[i];n&&a&&(delete e[i],delete t[i],n!==a&&(r.removeService(n),r.addService(a)))})),Object.values(e).forEach((function(e){e&&r.removeService(e)})),Object.values(t).forEach((function(e){e&&r.addService(e)}))},t.prototype.setupURI=function(){if(this._setupURI)return this._setupURI;(0,o.default)(!!this._accessoryInfo,"Cannot generate setupURI on an accessory that isn't published yet!");var e=Buffer.alloc(8),t=parseInt(this._accessoryInfo.pincode.replace(/-/g,""),10),r=this._accessoryInfo.category>>1;t|=1<<28,e.writeUInt32BE(t,4),1&this._accessoryInfo.category&&(e[4]=128|e[4]),e.writeUInt32BE(r,0);var i=(e.readUInt32BE(4)+4294967296*e.readUInt32BE(0)).toString(36).toUpperCase();if(9!==i.length)for(var n=0;n<=9-i.length;n++)i="0"+i;return this._setupURI="X-HM://"+i+this._setupID,this._setupURI},t.prototype.validateAccessory=function(e){var t=this,r=this.getService(C.Service.AccessoryInformation);if(r){var i=function(e,r){r||console.log("HAP-NodeJS WARNING: The accessory '"+t.displayName+"' is getting published with the characteristic '"+e+"' (of the AccessoryInformation service) not having a value set. This might prevent the accessory from being added to the Home App or leading to the accessory being unresponsive!")},n=r.getCharacteristic(p.Characteristic.Model).value,a=r.getCharacteristic(p.Characteristic.SerialNumber).value,s=r.getCharacteristic(p.Characteristic.FirmwareRevision).value,c=r.getCharacteristic(p.Characteristic.Name).value;i("Model",n),i("SerialNumber",a),i("FirmwareRevision",s),i("Name",c)}else console.log("HAP-NodeJS WARNING: The accessory '"+this.displayName+"' is getting published without a AccessoryInformation service. This might prevent the accessory from being added to the Home app or leading to the accessory being unresponsive!");e&&(0,o.default)(Buffer.from(this.displayName,"utf8").length<=63,"Accessory displayName cannot be longer than 63 bytes!"),this.bridged&&this.bridgedAccessories.forEach((function(e){return e.validateAccessory()}))},t.prototype._assignIDs=function(e){var t,r,i,n;this._identifierCache&&this.shouldPurgeUnusedIDs&&this._identifierCache.startTrackingUsage(),this.bridged?this.aid=e.getAID(this.UUID):this.aid=1;try{for(var o=a.__values(this.services),s=o.next();!s.done;s=o.next()){var c=s.value;this._isBridge?c._assignIDs(e,this.UUID,2e9):c._assignIDs(e,this.UUID)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}try{for(var u=a.__values(this.bridgedAccessories),l=u.next();!l.done;l=u.next()){l.value._assignIDs(e)}}catch(e){i={error:e}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(i)throw i.error}}this._identifierCache&&(this.shouldPurgeUnusedIDs&&this._identifierCache.stopTrackingUsageAndExpireUnused(),this._identifierCache.save())},t.prototype.disableUnusedIDPurge=function(){this.shouldPurgeUnusedIDs=!1},t.prototype.enableUnusedIDPurge=function(){this.shouldPurgeUnusedIDs=!0},t.prototype.purgeUnusedIDs=function(){var e=this.shouldPurgeUnusedIDs;this.shouldPurgeUnusedIDs=!0,this._assignIDs(this._identifierCache),this.shouldPurgeUnusedIDs=e},t.prototype.toHAP=function(e,t){return void 0===t&&(t=!0),a.__awaiter(this,void 0,void 0,(function(){var r,i,n,s,c,u;return a.__generator(this,(function(l){switch(l.label){case 0:return(0,o.default)(this.aid,"aid cannot be undefined for accessory '"+this.displayName+"'"),(0,o.default)(this.services.length,"accessory '"+this.displayName+"' does not have any services!"),u={aid:this.aid},[4,Promise.all(this.services.map((function(r){return r.toHAP(e,t)})))];case 1:return u.services=l.sent(),r=[u],this.bridged?[3,3]:(n=(i=r.push).apply,s=[r],c=[[]],[4,Promise.all(this.bridgedAccessories.map((function(r){return r.toHAP(e,t).then((function(e){return e[0]}))})))]);case 2:n.apply(i,s.concat([a.__spreadArray.apply(void 0,c.concat([a.__read.apply(void 0,[l.sent()]),!1]))])),l.label=3;case 3:return[2,r]}}))}))},t.prototype.internalHAPRepresentation=function(e){var t,r;void 0===e&&(e=!0),e&&this._assignIDs(this._identifierCache),(0,o.default)(this.aid,"aid cannot be undefined for accessory '"+this.displayName+"'"),(0,o.default)(this.services.length,"accessory '"+this.displayName+"' does not have any services!");var i=[{aid:this.aid,services:this.services.map((function(e){return e.internalHAPRepresentation()}))}];if(!this.bridged)try{for(var n=a.__values(this.bridgedAccessories),s=n.next();!s.done;s=n.next()){var c=s.value;i.push(c.internalHAPRepresentation(!1)[0])}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return i},t.prototype.publish=function(e,r){var i,n,o;return a.__awaiter(this,void 0,void 0,(function(){var c,u,l,d,f,m,S,E=this;return a.__generator(this,(function(a){switch(a.label){case 0:if(this.bridged)throw new Error("Can't publish in accessory which is bridged by another accessory. Bridged by "+(null===(i=this.bridge)||void 0===i?void 0:i.displayName));return e.advertiser||null==e.useLegacyAdvertiser||(e.advertiser=e.useLegacyAdvertiser?"bonjour-hap":"ciao",console.warn('DEPRECATED The PublishInfo.useLegacyAdvertiser option has been removed. Please use the PublishInfo.advertiser property to enable "ciao" (useLegacyAdvertiser=false) or "bonjour-hap" (useLegacyAdvertiser=true) mdns advertiser libraries!')),e.mdns&&"bonjour-hap"!==e.advertiser&&console.log("DEPRECATED user supplied a custom 'mdns' option. This option is deprecated and ignored. Please move to the new 'bind' option."),(c=this.getService(C.Service.ProtocolInformation))||(c=this.addService(C.Service.ProtocolInformation)),c.setCharacteristic(p.Characteristic.Version,h.CiaoAdvertiser.protocolVersionService),this.lastKnownUsername&&this.lastKnownUsername!==e.username&&t.cleanupAccessoryData(this.lastKnownUsername),this.initialized||null!==(n=e.addIdentifyingMaterial)&&void 0!==n&&!n||(this.displayName=this.displayName+" "+s.default.createHash("sha512").update(e.username,"utf8").digest("hex").slice(0,4).toUpperCase(),this.getService(C.Service.AccessoryInformation).updateCharacteristic(p.Characteristic.Name,this.displayName)),this._accessoryInfo=g.AccessoryInfo.load(e.username),this._accessoryInfo||(A("[%s] Creating new AccessoryInfo for our HAP server",this.displayName),this._accessoryInfo=g.AccessoryInfo.create(e.username)),e.setupID?this._setupID=e.setupID:void 0===this._accessoryInfo.setupID||""===this._accessoryInfo.setupID?this._setupID=t._generateSetupID():this._setupID=this._accessoryInfo.setupID,this._accessoryInfo.setupID=this._setupID,this._accessoryInfo.displayName=this.displayName,this._accessoryInfo.model=this.getService(C.Service.AccessoryInformation).getCharacteristic(p.Characteristic.Model).value,this._accessoryInfo.category=e.category||1,this._accessoryInfo.pincode=e.pincode,this._accessoryInfo.save(),this._identifierCache=y.IdentifierCache.load(e.username),this._identifierCache||(A("[%s] Creating new IdentifierCache",this.displayName),this._identifierCache=new y.IdentifierCache(e.username)),this._isBridge&&0===this.bridgedAccessories.length&&(this.disableUnusedIDPurge(),this.controllerStorage.purgeUnidentifiedAccessoryData=!1),this.initialized||this.controllerStorage.load(e.username),this._assignIDs(this._identifierCache),u=this.internalHAPRepresentation(!1),this._accessoryInfo.checkForCurrentConfigurationNumberIncrement(u,!0),this.validateAccessory(!0),l=t.parseBindOption(e),d=null!==(o=e.advertiser)&&void 0!==o?o:"bonjour-hap",(m="avahi"===e.advertiser)?[4,h.AvahiAdvertiser.isAvailable()]:[3,2];case 1:m=!a.sent(),a.label=2;case 2:return(f=m)?[3,5]:(S="resolved"===e.advertiser)?[4,h.ResolvedAdvertiser.isAvailable()]:[3,4];case 3:S=!a.sent(),a.label=4;case 4:f=S,a.label=5;case 5:switch(f&&(console.error("[".concat(this.displayName,'] The selected advertiser, "').concat(e.advertiser,"\", isn't available on this platform. ")+'Reverting to "'.concat("bonjour-hap",'"')),d="bonjour-hap"),d){case"ciao":this._advertiser=new h.CiaoAdvertiser(this._accessoryInfo,{interface:l.advertiserAddress},{restrictedAddresses:l.serviceRestrictedAddress,disabledIpv6:l.serviceDisableIpv6});break;case"bonjour-hap":this._advertiser=new h.BonjourHAPAdvertiser(this._accessoryInfo,e.mdns,{restrictedAddresses:l.serviceRestrictedAddress,disabledIpv6:l.serviceDisableIpv6});break;case"avahi":this._advertiser=new h.AvahiAdvertiser(this._accessoryInfo);break;case"resolved":this._advertiser=new h.ResolvedAdvertiser(this._accessoryInfo);break;default:throw new Error("Unsupported advertiser setting: '"+e.advertiser+"'")}return this._advertiser.on("updated-name",(function(e){E.displayName=e,E._accessoryInfo&&(E._accessoryInfo.displayName=e,E._accessoryInfo.save()),E.getService(C.Service.AccessoryInformation).updateCharacteristic(p.Characteristic.Name,e)})),this._server=new v.HAPServer(this._accessoryInfo),this._server.allowInsecureRequest=!!r,this._server.on("listening",this.onListening.bind(this)),this._server.on("identify",this.identificationRequest.bind(this,!1)),this._server.on("pair",this.handleInitialPairSetupFinished.bind(this)),this._server.on("add-pairing",this.handleAddPairing.bind(this)),this._server.on("remove-pairing",this.handleRemovePairing.bind(this)),this._server.on("list-pairings",this.handleListPairings.bind(this)),this._server.on("accessories",this.handleAccessories.bind(this)),this._server.on("get-characteristics",this.handleGetCharacteristics.bind(this)),this._server.on("set-characteristics",this.handleSetCharacteristics.bind(this)),this._server.on("connection-closed",this.handleHAPConnectionClosed.bind(this)),this._server.on("request-resource",this.handleResource.bind(this)),this._server.listen(e.port,l.serverAddress),this.initialized=!0,[2]}}))}))},t.prototype.destroy=function(){var e=this.unpublish();return this._accessoryInfo&&(t.cleanupAccessoryData(this._accessoryInfo.username),this._accessoryInfo=void 0,this._identifierCache=void 0,this.controllerStorage=new m.ControllerStorage(this)),this.removeAllListeners(),e},t.prototype.unpublish=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return this._server&&(this._server.destroy(),this._server=void 0),this._advertiser?[4,this._advertiser.destroy()]:[3,2];case 1:e.sent(),this._advertiser=void 0,e.label=2;case 2:return[2]}}))}))},t.prototype.enqueueConfigurationUpdate=function(){var e=this;this.configurationChangeDebounceTimeout||(this.configurationChangeDebounceTimeout=setTimeout((function(){var t;if(e.configurationChangeDebounceTimeout=void 0,e._advertiser&&e._advertiser){var r=e.internalHAPRepresentation();(null===(t=e._accessoryInfo)||void 0===t?void 0:t.checkForCurrentConfigurationNumberIncrement(r))&&e._advertiser.updateAdvertisement()}}),1e3),this.configurationChangeDebounceTimeout.unref())},t.prototype.onListening=function(e,t){var r=this;(0,o.default)(this._advertiser,"Advertiser wasn't created at onListening!"),this._advertiser.initPort(e),this._advertiser.startAdvertising().then((function(){return r.emit("advertised")})).catch((function(e){console.error("Could not create mDNS advertisement. The HAP-Server won't be discoverable: "+e),e.stack&&A("Detailed error: "+e.stack)})),this.emit("listening",e,t)},t.prototype.handleInitialPairSetupFinished=function(e,t,r){A("[%s] Paired with client %s",this.displayName,e),this._accessoryInfo&&this._accessoryInfo.addPairedClient(e,t,1),this._accessoryInfo&&this._accessoryInfo.save(),this._advertiser&&this._advertiser.updateAdvertisement(),r(),this.emit("paired")},t.prototype.handleAddPairing=function(e,t,r,i,n){if(this._accessoryInfo)if(this._accessoryInfo.hasAdminPermissions(e.username)){var a=this._accessoryInfo.getClientPublicKey(t);if(a){if(a.toString()!==r.toString())return void n(1);this._accessoryInfo.updatePermission(t,i)}else this._accessoryInfo.addPairedClient(t,r,i);this._accessoryInfo.save(),n(0)}else n(2);else n(6)},t.prototype.handleRemovePairing=function(e,t,r){var i,n;if(this._accessoryInfo)if(this._accessoryInfo.hasAdminPermissions(e.username)){if(this._accessoryInfo.removePairedClient(e,t),this._accessoryInfo.save(),r(0),!this._accessoryInfo.paired()){this._advertiser&&this._advertiser.updateAdvertisement(),this.emit("unpaired"),this.handleAccessoryUnpairedForControllers();try{for(var o=a.__values(this.bridgedAccessories),s=o.next();!s.done;s=o.next()){s.value.handleAccessoryUnpairedForControllers()}}catch(e){i={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}}}else r(2);else r(6)},t.prototype.handleListPairings=function(e,t){this._accessoryInfo?this._accessoryInfo.hasAdminPermissions(e.username)?t(0,this._accessoryInfo.listPairings()):t(2):t(6)},t.prototype.handleAccessories=function(e,t){var r=this;this._assignIDs(this._identifierCache);var i=Date.now(),n=i-this.lastAccessoriesRequest>5e3;this.lastAccessoriesRequest=i,this.toHAP(e,n).then((function(e){t(void 0,{accessories:e})}),(function(e){console.error("["+r.displayName+"] /accessories request error with: "+e.stack),t({httpCode:500,status:-70402})}))},t.prototype.handleGetCharacteristics=function(e,r,i){var n,o,s=this,c=[],u={characteristics:c},l=new Set(r.ids.map((function(e){return e.aid+"."+e.iid})));if(l.size===r.ids.length){var h=setTimeout((function(){var e,r;try{for(var n=a.__values(l),o=n.next();!o.done;o=n.next()){var d=o.value.split("."),p=parseInt(d[0],10),f=parseInt(d[1],10),v=s.getAccessoryByAID(p),g=v.getCharacteristicByIID(f);s.sendCharacteristicWarning(g,"slow-read","The read handler for the characteristic '"+g.displayName+"' on the accessory '"+v.displayName+"' was slow to respond!")}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}h=setTimeout((function(){var e,t;h=void 0;try{for(var r=a.__values(l),n=r.next();!n.done;n=r.next()){var o=n.value.split("."),d=parseInt(o[0],10),p=parseInt(o[1],10),f=s.getAccessoryByAID(d),v=f.getCharacteristicByIID(p);s.sendCharacteristicWarning(v,"timeout-read","The read handler for the characteristic '"+v.displayName+"' on the accessory '"+f.displayName+"' didn't respond at all!. Please check that you properly call the callback!"),c.push({aid:d,iid:p,status:-70408})}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}l.clear(),i(void 0,u)}),t.TIMEOUT_AFTER_WARNING),h.unref()}),t.TIMEOUT_WARNING);h.unref();var d=function(t){var n=t.aid+"."+t.iid;p.handleCharacteristicRead(e,t,r).then((function(e){return a.__assign({aid:t.aid,iid:t.iid},e)}),(function(e){return console.error("[".concat(s.displayName,"] Read request for characteristic ").concat(n," encountered an error: ").concat(e.stack)),{aid:t.aid,iid:t.iid,status:-70402}})).then((function(e){h&&(l.delete(n),c.push(e),0===l.size&&(h&&(clearTimeout(h),h=void 0),i(void 0,u)))}))},p=this;try{for(var f=a.__values(r.ids),v=f.next();!v.done;v=f.next()){d(v.value)}}catch(e){n={error:e}}finally{try{v&&!v.done&&(o=f.return)&&o.call(f)}finally{if(n)throw n.error}}}else i({httpCode:422,status:-70410})},t.prototype.handleCharacteristicRead=function(e,t,r){return a.__awaiter(this,void 0,void 0,(function(){var i,n,o=this;return a.__generator(this,(function(a){return(i=this.findCharacteristic(t.aid,t.iid))?i.props.perms.includes("pr")?i.props.adminOnlyAccess&&i.props.adminOnlyAccess.includes(0)&&((n=this._accessoryInfo&&e.username)||A("[%s] Could not verify admin permissions for Characteristic which requires admin permissions for reading (aid of %s and iid of %s)",this.displayName,t.aid,t.iid),!n||!this._accessoryInfo.hasAdminPermissions(e.username))?[2,{status:-70401}]:[2,i.handleGetRequest(e).then((function(n){n=(0,E.formatOutgoingCharacteristicValue)(n,i.props),A('[%s] Got Characteristic "%s" value: "%s"',o.displayName,i.displayName,n);var a={value:null==n?null:n};return r.includeMeta&&(a.format=i.props.format,a.unit=i.props.unit,a.minValue=i.props.minValue,a.maxValue=i.props.maxValue,a.minStep=i.props.minStep,a.maxLen=i.props.maxLen||i.props.maxDataLen),r.includePerms&&(a.perms=i.props.perms),r.includeType&&(a.type=(0,T.toShortForm)(i.UUID)),r.includeEvent&&(a.ev=e.hasEventNotifications(t.aid,t.iid)),a}),(function(e){return A('[%s] Error getting value for characteristic "%s": %s',o.displayName,i.displayName,v.HAPStatus[e]),{status:e}}))]:(A("[%s] Tried reading from characteristic which does not allow reading (aid of %s and iid of %s)",this.displayName,t.aid,t.iid),[2,{status:-70405}]):(A("[%s] Could not find a Characteristic with aid of %s and iid of %s",this.displayName,t.aid,t.iid),[2,{status:-70410}])}))}))},t.prototype.handleSetCharacteristics=function(e,r,i){var n,o,s=this;A("[%s] Processing characteristic set: %s",this.displayName,JSON.stringify(r));var c=0;void 0!==r.pid&&(e.timedWritePid===r.pid?(c=1,clearTimeout(e.timedWriteTimeout),e.timedWritePid=void 0,e.timedWriteTimeout=void 0,A("[%s] Timed write request got acknowledged for pid %d",this.displayName,r.pid)):(c=2,A("[%s] TTL for timed write request has probably expired for pid %d",this.displayName,r.pid)));var u=[],l={characteristics:u},h=new Set(r.characteristics.map((function(e){return e.aid+"."+e.iid})));if(h.size===r.characteristics.length){var d=setTimeout((function(){var e,r;try{for(var n=a.__values(h),o=n.next();!o.done;o=n.next()){var c=o.value.split("."),p=parseInt(c[0],10),f=parseInt(c[1],10),v=s.getAccessoryByAID(p),g=v.getCharacteristicByIID(f);s.sendCharacteristicWarning(g,"slow-write","The write handler for the characteristic '"+g.displayName+"' on the accessory '"+v.displayName+"' was slow to respond!")}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}d=setTimeout((function(){var e,t;d=void 0;try{for(var r=a.__values(h),n=r.next();!n.done;n=r.next()){var o=n.value.split("."),c=parseInt(o[0],10),p=parseInt(o[1],10),f=s.getAccessoryByAID(c),v=f.getCharacteristicByIID(p);s.sendCharacteristicWarning(v,"timeout-write","The write handler for the characteristic '"+v.displayName+"' on the accessory '"+f.displayName+"' didn't respond at all!. Please check that you properly call the callback!"),u.push({aid:c,iid:p,status:-70408})}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}h.clear(),i(void 0,l)}),t.TIMEOUT_AFTER_WARNING),d.unref()}),t.TIMEOUT_WARNING);d.unref();var p=function(t){var r=t.aid+"."+t.iid;f.handleCharacteristicWrite(e,t,c).then((function(e){return a.__assign({aid:t.aid,iid:t.iid},e)}),(function(e){return console.error("[".concat(s.displayName,"] Write request for characteristic ").concat(r," encountered an error: ").concat(e.stack)),{aid:t.aid,iid:t.iid,status:-70402}})).then((function(e){d&&(h.delete(r),u.push(e),0===h.size&&(d&&(clearTimeout(d),d=void 0),i(void 0,l)))}))},f=this;try{for(var v=a.__values(r.characteristics),g=v.next();!g.done;g=v.next()){p(g.value)}}catch(e){n={error:e}}finally{try{g&&!g.done&&(o=v.return)&&o.call(v)}finally{if(n)throw n.error}}}else i({httpCode:422,status:-70410})},t.prototype.handleCharacteristicWrite=function(e,t,r){return a.__awaiter(this,void 0,void 0,(function(){var i,n,o,s,c=this;return a.__generator(this,(function(a){if(!(i=this.findCharacteristic(t.aid,t.iid)))return A("[%s] Could not find a Characteristic with aid of %s and iid of %s",this.displayName,t.aid,t.iid),[2,{status:-70410}];if(2===r)return[2,{status:-70410}];if(null==t.ev&&null==t.value)return[2,{status:-70410}];if(null!=t.ev){if(!i.props.perms.includes("ev"))return A("[%s] Tried %s notifications for Characteristic which does not allow notify (aid of %s and iid of %s)",this.displayName,t.ev?"enabling":"disabling",t.aid,t.iid),[2,{status:-70406}];if(i.props.adminOnlyAccess&&i.props.adminOnlyAccess.includes(2)&&((o=e.username&&this._accessoryInfo)||A("[%s] Could not verify admin permissions for Characteristic which requires admin permissions for notify (aid of %s and iid of %s)",this.displayName,t.aid,t.iid),!o||!this._accessoryInfo.hasAdminPermissions(e.username)))return[2,{status:-70401}];n=e.hasEventNotifications(t.aid,t.iid),t.ev&&!n?(e.enableEventNotifications(t.aid,t.iid),i.subscribe(),A('[%s] Registered Characteristic "%s" on "%s" for events',e.remoteAddress,i.displayName,this.displayName)):!t.ev&&n&&(i.unsubscribe(),e.disableEventNotifications(t.aid,t.iid),A('[%s] Unregistered Characteristic "%s" on "%s" for events',e.remoteAddress,i.displayName,this.displayName))}if(null!=t.value){if(!i.props.perms.includes("pw"))return A("[%s] Tried writing to Characteristic which does not allow writing (aid of %s and iid of %s)",this.displayName,t.aid,t.iid),[2,{status:-70404}];if(i.props.adminOnlyAccess&&i.props.adminOnlyAccess.includes(1)&&((o=e.username&&this._accessoryInfo)||A("[%s] Could not verify admin permissions for Characteristic which requires admin permissions for write (aid of %s and iid of %s)",this.displayName,t.aid,t.iid),!o||!this._accessoryInfo.hasAdminPermissions(e.username)))return[2,{status:-70401}];if(i.props.perms.includes("aa")&&i.additionalAuthorizationHandler){s=void 0;try{s=i.additionalAuthorizationHandler(t.authData)}catch(e){console.warn("["+this.displayName+"] Additional authorization handler has thrown an error when checking authData: "+e.stack),s=!1}if(!s)return[2,{status:-70411}]}return i.props.perms.includes("tw")&&1!==r?(A("[%s] Tried writing to a timed write only Characteristic without properly preparing (iid of %s and aid of %s)",this.displayName,t.aid,t.iid),[2,{status:-70410}]):[2,i.handleSetRequest(t.value,e).then((function(e){return A('[%s] Setting Characteristic "%s" to value %s',c.displayName,i.displayName,t.value),{value:t.r&&e?(0,E.formatOutgoingCharacteristicValue)(e,i.props):void 0,status:0}}),(function(e){return A('[%s] Error setting Characteristic "%s" to value %s: ',c.displayName,i.displayName,t.value,v.HAPStatus[e]),{status:e}}))]}return[2,{status:0}]}))}))},t.prototype.handleResource=function(e,t){var r;if("image"===e["resource-type"]){var i=e.aid,n=void 0,a=void 0;return i?(n=this.getAccessoryByAID(i))&&n.activeCameraController&&(a=n.activeCameraController):this.activeCameraController&&(n=this,a=this.activeCameraController),a?void a.handleSnapshotRequest(e["image-height"],e["image-width"],null==n?void 0:n.displayName,e.reason).then((function(e){t(void 0,e)}),(function(e){t({httpCode:207,status:e})})):(A("[%s] received snapshot request though no camera controller was associated!"),void t({httpCode:404,status:-70409}))}A("[%s] received request for unsupported image type: "+e["resource-type"],null===(r=this._accessoryInfo)||void 0===r?void 0:r.username),t({httpCode:404,status:-70409})},t.prototype.handleHAPConnectionClosed=function(e){var t,r;this.activeCameraController&&this.activeCameraController.handleCloseConnection(e.sessionID);try{for(var i=a.__values(e.getRegisteredEvents()),n=i.next();!n.done;n=i.next()){var o=n.value.split("."),s=parseInt(o[0],10),c=parseInt(o[1],10),u=this.findCharacteristic(s,c);u&&u.unsubscribe()}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}e.clearRegisteredEvents()},t.prototype.handleServiceConfigurationChangeEvent=function(e){e.isPrimaryService||e!==this.primaryService?e.isPrimaryService&&e!==this.primaryService&&(void 0!==this.primaryService&&(this.primaryService.isPrimaryService=!1),this.primaryService=e):this.primaryService=void 0,this.bridged?this.emit("service-configurationChange",{service:e}):this.enqueueConfigurationUpdate()},t.prototype.handleCharacteristicChangeEvent=function(e,t,r){if(this.bridged)this.emit("service-characteristic-change",a.__assign(a.__assign({},r),{service:t}));else{if(!this._server)return;if(null==e.aid||null==r.characteristic.iid)return void A("[%s] Muting event notification for %s as ids aren't yet assigned!",e.displayName,r.characteristic.displayName);if(null!=r.context&&"object"==typeof r.context&&r.context.omitEventUpdate)return void A("[%s] Omitting event updates for %s as specified in the context object!",e.displayName,r.characteristic.displayName);if("event"!==r.reason&&r.oldValue===r.newValue&&r.characteristic.UUID!==p.Characteristic.ProgrammableSwitchEvent.UUID&&r.characteristic.UUID!==p.Characteristic.ButtonEvent.UUID)return;var i=r.characteristic.UUID,n=i===p.Characteristic.ButtonEvent.UUID||i===p.Characteristic.ProgrammableSwitchEvent.UUID||i===p.Characteristic.MotionDetected.UUID||i===p.Characteristic.ContactSensorState.UUID,o=(0,E.formatOutgoingCharacteristicValue)(r.newValue,r.characteristic.props);this._server.sendEventNotifications(e.aid,r.characteristic.iid,o,r.originator,n)}},t.prototype.sendCharacteristicWarning=function(e,t,r){this.handleCharacteristicWarning({characteristic:e,type:t,message:r,originatorChain:[e.displayName],stack:(new Error).stack})},t.prototype.handleCharacteristicWarning=function(e){var t;if(e.originatorChain=a.__spreadArray([this.displayName],a.__read(e.originatorChain),!1),!this.emit("characteristic-warning",e)){var r="[".concat(e.originatorChain.join("@"),"] ").concat(e.message);"error-message"===e.type||"timeout-read"===e.type||"timeout-write"===e.type?console.error(r):console.warn(r),A("[%s] Above characteristic warning was thrown at: %s",this.displayName,null!==(t=e.stack)&&void 0!==t?t:"unknown")}},t.prototype.setupServiceEventHandlers=function(e){e.on("service-configurationChange",this.handleServiceConfigurationChangeEvent.bind(this,e)),e.on("characteristic-change",this.handleCharacteristicChangeEvent.bind(this,this,e)),e.on("characteristic-warning",this.handleCharacteristicWarning.bind(this))},t.prototype._sideloadServices=function(e){var t,r,i=this;try{for(var n=a.__values(e),o=n.next();!o.done;o=n.next()){var s=o.value;this.setupServiceEventHandlers(s)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}this.services=e.slice(),this.getService(C.Service.AccessoryInformation).getCharacteristic(p.Characteristic.Identify).on("set",(function(e,t){if(e){i.identificationRequest(!0,t)}}))},t._generateSetupID=function(){for(var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",t="",r=0;r<4;r++){var i=Math.floor(36*Math.random());t+=e.charAt(i)}return t},t.serialize=function(e){var r={displayName:e.displayName,UUID:e.UUID,lastKnownUsername:e._accessoryInfo?e._accessoryInfo.username:void 0,category:e.category,services:[]},i={},n=!1;e.services.forEach((function(e){r.services.push(C.Service.serialize(e));var t=[];e.linkedServices.forEach((function(e){t.push(e.getServiceId())})),t.length>0&&(i[e.getServiceId()]=t,n=!0)})),n&&(r.linkedServices=i);var o=[];return Object.values(e.controllers).forEach((function(e){o.push({type:e.controller.controllerId(),services:t.serializeServiceMap(e.serviceMap)})})),e.serializedControllers&&Object.entries(e.serializedControllers).forEach((function(e){var r=a.__read(e,2),i=r[0],n=r[1];o.push({type:i,services:t.serializeServiceMap(n)})})),o.length>0&&(r.controllers=o),r},t.deserialize=function(e){var r,i,n=new t(e.displayName,e.UUID);n.lastKnownUsername=e.lastKnownUsername,n.category=e.category;var o=[],s={};if(e.services.forEach((function(e){var t=C.Service.deserialize(e);o.push(t),s[t.getServiceId()]=t})),e.linkedServices){var c=function(e,t){var r=s[e];if(!r)return"continue";t.forEach((function(e){var t=s[e];t&&r.addLinkedService(t)}))};try{for(var u=a.__values(Object.entries(e.linkedServices)),l=u.next();!l.done;l=u.next()){var h=a.__read(l.value,2);c(h[0],h[1])}}catch(e){r={error:e}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}}return e.controllers&&(n.serializedControllers={},e.controllers.forEach((function(e){n.serializedControllers[e.type]=t.deserializeServiceMap(e.services,s)}))),n._sideloadServices(o),n},t.cleanupAccessoryData=function(e){y.IdentifierCache.remove(e),g.AccessoryInfo.remove(e),m.ControllerStorage.remove(e)},t.serializeServiceMap=function(e){var t={};return Object.entries(e).forEach((function(e){var r=a.__read(e,2),i=r[0],n=r[1];n&&(t[i]=n.getServiceId())})),t},t.deserializeServiceMap=function(e,t){var r={};return Object.entries(e).forEach((function(e){var i=a.__read(e,2),n=i[0],o=i[1],s=t[o];s&&(r[n]=s)})),r},t.parseBindOption=function(e){var t,r,i=void 0,n=void 0,o=void 0;if(e.bind){var s=new Set(Array.isArray(e.bind)?e.bind:[e.bind]);if(s.has("::"))o="::",s.delete("::"),s.size&&(i=Array.from(s));else if(s.has("0.0.0.0"))n=!0,o="0.0.0.0",s.delete("0.0.0.0"),s.size&&(i=Array.from(s));else if(1===s.size){i=Array.from(s);var c=s.values().next().value;o=(p=l.default.isIP(c))&&4===p?"0.0.0.0":"::"}else if(s.size>1){i=Array.from(s);var u=!1;try{for(var h=a.__values(s),d=h.next();!d.done;d=h.next()){var p;c=d.value;if(0===(p=l.default.isIP(c))||6===p){u=!0;break}}}catch(e){t={error:e}}finally{try{d&&!d.done&&(r=h.return)&&r.call(h)}finally{if(t)throw t.error}}o=u?"::":"0.0.0.0"}}return{advertiserAddress:i,serviceRestrictedAddress:i,serviceDisableIpv6:n,serverAddress:o}},t.Categories=i,t.TIMEOUT_WARNING=3e3,t.TIMEOUT_AFTER_WARNING=6e3,t}(u.EventEmitter);t.Accessory=I},1370:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadDirectory=t.parseAccessoryJSON=t.parseServiceJSON=t.parseCharacteristicJSON=void 0;var i=r(1635),n=i.__importDefault(r(5753)),a=i.__importDefault(r(9896)),o=i.__importDefault(r(6928)),s=r(5745),c=r(9826),u=r(5876),l=i.__importStar(r(2997)),h=(0,n.default)("HAP-NodeJS:AccessoryLoader");function d(e){var t=e.cType,r=new c.Characteristic(e.manfDescription||t,t,{format:e.format,minValue:e.designedMinValue,maxValue:e.designedMaxValue,minStep:e.designedMinStep,unit:e.unit,perms:e.perms});r.value=e.initialValue,r.locals=e.locals;var i=e.onUpdate,n=e.onRead,a=e.onRegister;return i&&r.on("set",(function(e,t){i(e),t&&t()})),n&&r.on("get",(function(e){n((function(t){e(null,t)}))})),a&&a(r),r}function p(e){var t=e.sType,r=[];e.characteristics.forEach((function(e){var t=d(e);r.push(t)}));var i=null;r.forEach((function(e){"00000023-0000-1000-8000-0026BB765291"===e.UUID&&(i=e.value)}));var n=new u.Service(i||t,t,"".concat(i));return r.forEach((function(e){"00000023-0000-1000-8000-0026BB765291"!==e.UUID&&n.addCharacteristic(e)})),n}function f(e){var t=[];e.services.forEach((function(e){var r=p(e);t.push(r)}));var r=e.displayName;t.forEach((function(e){"0000003E-0000-1000-8000-0026BB765291"===e.UUID&&e.characteristics.forEach((function(e){"00000023-0000-1000-8000-0026BB765291"===e.UUID&&(r=e.value)}))}));var i=new s.Accessory(r,l.generate(r));return i.username=e.username,i.pincode=e.pincode,i.services.length=0,t.forEach((function(e){i.addService(e)})),i}t.parseCharacteristicJSON=d,t.parseServiceJSON=p,t.parseAccessoryJSON=f,t.loadDirectory=function(e){var t=[];return a.default.readdirSync(e).forEach((function(i){var n=i.split("_").pop();if("accessory.js"===n||"accessory.ts"===n){h("Parsing accessory: %s",i);var a=r(7506)(o.default.join(e,i)).accessory;t.push(a)}else if("accfactory.js"===n||"accfactory.ts"===n){h("Parsing accessory factory: %s",i);var s=r(7506)(o.default.join(e,i));t=t.concat(s)}})),t.map((function(e){return null==e?(console.log("Invalid accessory!"),!1):e instanceof s.Accessory?e:f(e)})).filter((function(e){return!!e}))}},310:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResolvedAdvertiser=t.AvahiAdvertiser=t.DBusInvokeError=t.BonjourHAPAdvertiser=t.CiaoAdvertiser=t.AdvertiserEvent=t.PairingFeatureFlag=t.StatusFlag=void 0;var i=r(1635),n=i.__importDefault(r(8318)),a=i.__importDefault(r(7845)),o=i.__importDefault(r(2613)),s=i.__importDefault(r(8404)),c=i.__importDefault(r(6982)),u=i.__importDefault(r(5753)),l=r(4434),h=r(4009),d=(0,u.default)("HAP-NodeJS:Advertiser");!function(e){e[e.NOT_PAIRED=1]="NOT_PAIRED",e[e.NOT_JOINED_WIFI=2]="NOT_JOINED_WIFI",e[e.PROBLEM_DETECTED=4]="PROBLEM_DETECTED"}(t.StatusFlag||(t.StatusFlag={})),function(e){e[e.SUPPORTS_HARDWARE_AUTHENTICATION=1]="SUPPORTS_HARDWARE_AUTHENTICATION",e[e.SUPPORTS_SOFTWARE_AUTHENTICATION=2]="SUPPORTS_SOFTWARE_AUTHENTICATION"}(t.PairingFeatureFlag||(t.PairingFeatureFlag={})),function(e){e.UPDATED_NAME="updated-name"}(t.AdvertiserEvent||(t.AdvertiserEvent={}));var p=function(e){function t(r,a,o){var s=e.call(this)||this;return s.accessoryInfo=r,s.setupHash=t.computeSetupHash(r),s.responder=n.default.getResponder(i.__assign({},a)),s.advertisedService=s.responder.createService(i.__assign({name:s.accessoryInfo.displayName,type:"hap",txt:t.createTxt(r,s.setupHash)},o)),s.advertisedService.on("name-change",s.emit.bind(s,"updated-name")),d("Preparing Advertiser for '".concat(s.accessoryInfo.displayName,"' using ciao backend!")),s}return i.__extends(t,e),t.prototype.initPort=function(e){this.advertisedService.updatePort(e)},t.prototype.startAdvertising=function(){return d("Starting to advertise '".concat(this.accessoryInfo.displayName,"' using ciao backend!")),this.advertisedService.advertise()},t.prototype.updateAdvertisement=function(e){var r=t.createTxt(this.accessoryInfo,this.setupHash);d("Updating txt record (txt: %o, silent: %d)",r,e),this.advertisedService.updateTxt(r,e)},t.prototype.destroy=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){switch(e.label){case 0:return[4,this.responder.shutdown()];case 1:return e.sent(),this.removeAllListeners(),[2]}}))}))},t.createTxt=function(e,r){var n=[];return e.paired()||n.push(1),{"c#":e.getConfigVersion(),ff:t.ff(),id:e.username,md:e.model,pv:t.protocolVersion,"s#":1,sf:t.sf.apply(t,i.__spreadArray([],i.__read(n),!1)),ci:e.category,sh:r}},t.computeSetupHash=function(e){var t=c.default.createHash("sha512");return t.update(e.setupID+e.username.toUpperCase()),t.digest().slice(0,4).toString("base64")},t.ff=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=0;return e.forEach((function(e){return r|=e})),r},t.sf=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=0;return e.forEach((function(e){return r|=e})),r},t.protocolVersion="1.1",t.protocolVersionService="1.1.0",t}(l.EventEmitter);t.CiaoAdvertiser=p;var f=function(e){function t(t,r,i){var n=e.call(this)||this;return n.destroyed=!1,n.accessoryInfo=t,n.setupHash=p.computeSetupHash(t),n.serviceOptions=i,n.bonjour=(0,s.default)(r),d("Preparing Advertiser for '".concat(n.accessoryInfo.displayName,"' using bonjour-hap backend!")),n}return i.__extends(t,e),t.prototype.initPort=function(e){this.port=e},t.prototype.startAdvertising=function(){if((0,o.default)(!this.destroyed,"Can't advertise on a destroyed bonjour instance!"),null==this.port)throw new Error("Tried starting bonjour-hap advertisement without initializing port!");d("Starting to advertise '".concat(this.accessoryInfo.displayName,"' using bonjour-hap backend!")),this.advertisement&&this.destroy();var e=this.accessoryInfo.username.replace(/:/gi,"_")+".local";return this.advertisement=this.bonjour.publish(i.__assign({name:this.accessoryInfo.displayName,type:"hap",port:this.port,txt:p.createTxt(this.accessoryInfo,this.setupHash),host:e,addUnsafeServiceEnumerationRecord:!0},this.serviceOptions)),(0,h.PromiseTimeout)(1)},t.prototype.updateAdvertisement=function(e){var t=p.createTxt(this.accessoryInfo,this.setupHash);d("Updating txt record (txt: %o, silent: %d)",t,e),this.advertisement&&this.advertisement.updateTxt(t,e)},t.prototype.destroy=function(){var e=this;this.advertisement?this.advertisement.stop((function(){e.advertisement.destroy(),e.advertisement=void 0,e.bonjour.destroy()})):this.bonjour.destroy()},t}(l.EventEmitter);function v(e){return new Promise((function(t,r){var i=function(t){e.connection.removeListener("connect",n),r(t)},n=function(){e.connection.removeListener("error",i),t()};e.connection.once("connect",n),e.connection.once("error",i)}))}t.BonjourHAPAdvertiser=f;var g,m=function(e){function t(r){var i=e.call(this)||this;return Object.setPrototypeOf(i,t.prototype),i.name="DBusInvokeError",i.errorName=r.name,Array.isArray(r.message)&&1===r.message.length?i.message=r.message[0]:i.message=r.message.toString(),i}return i.__extends(t,e),t}(Error);function y(e,t,r,n,a,o){return new Promise((function(s,c){var u=i.__assign({destination:t,path:r,interface:n,member:a},o||{});e.invoke(u,(function(e,t){e?c(new m(e)):s(t)}))}))}t.DBusInvokeError=m,function(e){e[e.INVALID=0]="INVALID",e[e.REGISTERING=1]="REGISTERING",e[e.RUNNING=2]="RUNNING",e[e.COLLISION=3]="COLLISION",e[e.FAILURE=4]="FAILURE"}(g||(g={}));var C=function(e){function t(t){var r=e.call(this)||this;return r.accessoryInfo=t,r.setupHash=p.computeSetupHash(t),d("Preparing Advertiser for '".concat(r.accessoryInfo.displayName,"' using Avahi backend!")),r.bus=a.default.systemBus(),r.stateChangeHandler=r.handleStateChangedEvent.bind(r),r}return i.__extends(t,e),t.prototype.createTxt=function(){return Object.entries(p.createTxt(this.accessoryInfo,this.setupHash)).map((function(e){return Buffer.from(e[0]+"="+e[1])}))},t.prototype.initPort=function(e){this.port=e},t.prototype.startAdvertising=function(){return i.__awaiter(this,void 0,void 0,(function(){var e,r,n;return i.__generator(this,(function(i){switch(i.label){case 0:if(null==this.port)throw new Error("Tried starting Avahi advertisement without initializing port!");if(!this.bus)throw new Error("Tried to start Avahi advertisement on a destroyed advertiser!");return d("Starting to advertise '".concat(this.accessoryInfo.displayName,"' using Avahi backend!")),e=this,[4,t.avahiInvoke(this.bus,"/","Server","EntryGroupNew")];case 1:return e.path=i.sent(),[4,t.avahiInvoke(this.bus,this.path,"EntryGroup","AddService",{body:[-1,-1,0,this.accessoryInfo.displayName,"_hap._tcp","","",this.port,this.createTxt()],signature:"iiussssqaay"})];case 2:return i.sent(),[4,t.avahiInvoke(this.bus,this.path,"EntryGroup","Commit")];case 3:i.sent(),i.label=4;case 4:return i.trys.push([4,7,,8]),this.avahiServerInterface?[3,6]:(r=this,[4,t.avahiInterface(this.bus,"Server")]);case 5:r.avahiServerInterface=i.sent(),this.avahiServerInterface.on("StateChanged",this.stateChangeHandler),i.label=6;case 6:return[3,8];case 7:return n=i.sent(),console.warn("Failed to create listener for avahi-daemon server state. The system will not be notified about restarts of avahi-daemon and will therefore stay undiscoverable in those instances. Error message: "+n),n.stack&&d("Detailed error: "+n.stack),[3,8];case 8:return[2]}}))}))},t.prototype.handleStateChangedEvent=function(e){2===e&&this.path&&(d("Found Avahi daemon to have restarted!"),this.startAdvertising().catch((function(e){return console.error("Could not (re-)create mDNS advertisement. The HAP-Server won't be discoverable: "+e)})))},t.prototype.updateAdvertisement=function(e){return i.__awaiter(this,void 0,void 0,(function(){var r;return i.__generator(this,(function(i){switch(i.label){case 0:if(!this.bus)throw new Error("Tried to update Avahi advertisement on a destroyed advertiser!");if(!this.path)return d("Tried to update advertisement without a valid `path`!"),[2];d("Updating txt record (txt: %o, silent: %d)",p.createTxt(this.accessoryInfo,this.setupHash),e),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,t.avahiInvoke(this.bus,this.path,"EntryGroup","UpdateServiceTxt",{body:[-1,-1,0,this.accessoryInfo.displayName,"_hap._tcp","",this.createTxt()],signature:"iiusssaay"})];case 2:return i.sent(),[3,4];case 3:return r=i.sent(),console.error("Failed to update avahi advertisement: "+r),[3,4];case 4:return[2]}}))}))},t.prototype.destroy=function(){return i.__awaiter(this,void 0,void 0,(function(){var e;return i.__generator(this,(function(r){switch(r.label){case 0:if(!this.bus)throw new Error("Tried to destroy Avahi advertisement on a destroyed advertiser!");if(!this.path)return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t.avahiInvoke(this.bus,this.path,"EntryGroup","Free")];case 2:return r.sent(),[3,4];case 3:return e=r.sent(),d("Destroying Avahi advertisement failed: "+e),[3,4];case 4:this.path=void 0,r.label=5;case 5:return this.avahiServerInterface&&(this.avahiServerInterface.removeListener("StateChanged",this.stateChangeHandler),this.avahiServerInterface=void 0),this.bus.connection.stream.destroy(),this.bus=void 0,[2]}}))}))},t.isAvailable=function(){return i.__awaiter(this,void 0,void 0,(function(){var e,t;return i.__generator(this,(function(r){switch(r.label){case 0:e=a.default.systemBus(),r.label=1;case 1:r.trys.push([1,,9,10]),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,v(e)];case 3:return r.sent(),[3,5];case 4:return r.sent(),d("Avahi/DBus classified unavailable due to missing dbus interface!"),[2,!1];case 5:return r.trys.push([5,7,,8]),[4,this.avahiInvoke(e,"/","Server","GetVersionString")];case 6:return t=r.sent(),d("Detected Avahi over DBus interface running version '%s'.",t),[3,8];case 7:return r.sent(),d("Avahi/DBus classified unavailable due to missing avahi interface!"),[2,!1];case 8:return[2,!0];case 9:return e.connection.stream.destroy(),[7];case 10:return[2]}}))}))},t.avahiInvoke=function(e,t,r,i,n){return y(e,"org.freedesktop.Avahi",t,"org.freedesktop.Avahi.".concat(r),i,n)},t.avahiInterface=function(e,t){return new Promise((function(r,i){e.getService("org.freedesktop.Avahi").getInterface("/","org.freedesktop.Avahi."+t,(function(e,t){e||!t?i(null!=e?e:new Error("Interface not present!")):r(t)}))}))},t}(l.EventEmitter);t.AvahiAdvertiser=C;var S=["org.freedesktop.DBus.Error.AccessDenied","org.freedesktop.DBus.Error.AuthFailed","org.freedesktop.DBus.Error.InteractiveAuthorizationRequired"],E=function(e){function t(t){var r=e.call(this)||this;return r.accessoryInfo=t,r.setupHash=p.computeSetupHash(t),r.bus=a.default.systemBus(),d("Preparing Advertiser for '".concat(r.accessoryInfo.displayName,"' using systemd-resolved backend!")),r}return i.__extends(t,e),t.prototype.createTxt=function(){return Object.entries(p.createTxt(this.accessoryInfo,this.setupHash)).map((function(e){return[e[0].toString(),Buffer.from(e[1].toString())]}))},t.prototype.initPort=function(e){this.port=e},t.prototype.startAdvertising=function(){return i.__awaiter(this,void 0,void 0,(function(){var e,r;return i.__generator(this,(function(i){switch(i.label){case 0:if(null==this.port)throw new Error("Tried starting systemd-resolved advertisement without initializing port!");if(!this.bus)throw new Error("Tried to start systemd-resolved advertisement on a destroyed advertiser!");d("Starting to advertise '".concat(this.accessoryInfo.displayName,"' using systemd-resolved backend!")),i.label=1;case 1:return i.trys.push([1,3,,4]),e=this,[4,t.managerInvoke(this.bus,"RegisterService",{body:[this.accessoryInfo.displayName,this.accessoryInfo.displayName,"_hap._tcp",this.port,0,0,[this.createTxt()]],signature:"sssqqqaa{say}"})];case 2:return e.path=i.sent(),[3,4];case 3:throw(r=i.sent())instanceof m&&S.includes(r.errorName)&&(r.message="Permissions issue. See https://homebridge.io/w/mDNS-Options for more info. ".concat(r.message)),r;case 4:return[2]}}))}))},t.prototype.updateAdvertisement=function(e){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:if(!this.bus)throw new Error("Tried to update systemd-resolved advertisement on a destroyed advertiser!");return d("Updating txt record (txt: %o, silent: %d)",p.createTxt(this.accessoryInfo,this.setupHash),e),[4,this.stopAdvertising()];case 1:return t.sent(),[4,this.startAdvertising()];case 2:return t.sent(),[2]}}))}))},t.prototype.stopAdvertising=function(){return i.__awaiter(this,void 0,void 0,(function(){var e;return i.__generator(this,(function(r){switch(r.label){case 0:if(!this.bus)throw new Error("Tried to destroy systemd-resolved advertisement on a destroyed advertiser!");if(!this.path)return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t.managerInvoke(this.bus,"UnregisterService",{body:[this.path],signature:"o"})];case 2:return r.sent(),[3,4];case 3:return e=r.sent(),d("Destroying systemd-resolved advertisement failed: "+e),[3,4];case 4:this.path=void 0,r.label=5;case 5:return[2]}}))}))},t.prototype.destroy=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){switch(e.label){case 0:if(!this.bus)throw new Error("Tried to destroy systemd-resolved advertisement on a destroyed advertiser!");return[4,this.stopAdvertising()];case 1:return e.sent(),this.bus.connection.stream.destroy(),this.bus=void 0,[2]}}))}))},t.isAvailable=function(){return i.__awaiter(this,void 0,void 0,(function(){var e,t,r;return i.__generator(this,(function(i){switch(i.label){case 0:e=a.default.systemBus(),i.label=1;case 1:i.trys.push([1,,12,13]),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,v(e)];case 3:return i.sent(),[3,5];case 4:return i.sent(),d("systemd-resolved/DBus classified unavailable due to missing dbus interface!"),[2,!1];case 5:return i.trys.push([5,7,,8]),[4,this.managerInvoke(e,"ResolveHostname",{body:[0,"127.0.0.1",0,0],signature:"isit"})];case 6:return i.sent(),d("Detected systemd-resolved over DBus interface running version."),[3,8];case 7:return i.sent(),d("systemd-resolved/DBus classified unavailable due to missing systemd-resolved interface!"),[2,!1];case 8:return i.trys.push([8,10,,11]),[4,this.resolvedInvoke(e,"org.freedesktop.DBus.Properties","Get",{body:["org.freedesktop.resolve1.Manager","MulticastDNS"],signature:"ss"})];case 9:if("s"!==(t=i.sent())[0][0].type)throw new Error("Invalid type for MulticastDNS");return"yes"!==t[1][0]?(d("systemd-resolved/DBus classified unavailable because MulticastDNS is not enabled!"),[2,!1]):[3,11];case 10:return r=i.sent(),d("systemd-resolved/DBus classified unavailable due to failure checking system status: "+r),[2,!1];case 11:return[2,!0];case 12:return e.connection.stream.destroy(),[7];case 13:return[2]}}))}))},t.resolvedInvoke=function(e,t,r,i){return y(e,"org.freedesktop.resolve1","/org/freedesktop/resolve1",t,r,i)},t.managerInvoke=function(e,t,r){return this.resolvedInvoke(e,"org.freedesktop.resolve1.Manager",t,r)},t}(l.EventEmitter);t.ResolvedAdvertiser=E},3186:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Bridge=void 0;var i=r(1635),n=function(e){function t(t,r){var i=e.call(this,t,r)||this;return i._isBridge=!0,i}return i.__extends(t,e),t}(r(5745).Accessory);t.Bridge=n},9826:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Characteristic=t.CharacteristicEventTypes=t.ChangeReason=t.Access=t.Perms=t.Units=t.Formats=void 0;var i,n,a,o=r(1635),s=o.__importDefault(r(2613)),c=o.__importDefault(r(5753)),u=r(4434),l=r(589),h=r(9621),d=r(8073),p=r(7739),f=r(8066),v=r(2997),g=(0,c.default)("HAP-NodeJS:Characteristic");!function(e){e.BOOL="bool",e.INT="int",e.FLOAT="float",e.STRING="string",e.UINT8="uint8",e.UINT16="uint16",e.UINT32="uint32",e.UINT64="uint64",e.DATA="data",e.TLV8="tlv8",e.ARRAY="array",e.DICTIONARY="dict"}(i=t.Formats||(t.Formats={})),function(e){e.CELSIUS="celsius",e.PERCENTAGE="percentage",e.ARC_DEGREE="arcdegrees",e.LUX="lux",e.SECONDS="seconds"}(n=t.Units||(t.Units={})),function(e){e.READ="pr",e.WRITE="pw",e.PAIRED_READ="pr",e.PAIRED_WRITE="pw",e.NOTIFY="ev",e.EVENTS="ev",e.ADDITIONAL_AUTHORIZATION="aa",e.TIMED_WRITE="tw",e.HIDDEN="hd",e.WRITE_RESPONSE="wr"}(a=t.Perms||(t.Perms={})),function(e){e[e.READ=0]="READ",e[e.WRITE=1]="WRITE",e[e.NOTIFY=2]="NOTIFY"}(t.Access||(t.Access={})),function(e){e.WRITE="write",e.UPDATE="update",e.READ="read",e.EVENT="event"}(t.ChangeReason||(t.ChangeReason={})),function(e){e.GET="get",e.SET="set",e.CHANGE="change",e.SUBSCRIBE="subscribe",e.UNSUBSCRIBE="unsubscribe",e.CHARACTERISTIC_WARNING="characteristic-warning"}(t.CharacteristicEventTypes||(t.CharacteristicEventTypes={}));var m=function(){function e(e){(0,s.default)((0,f.isNumericFormat)(e.format),"Cannot instantiate valid values iterable when format is not numeric. Found "+e.format),this.props=e}return e.prototype[Symbol.iterator]=function(){var e,t,r,i,n,a,s,c,u;return o.__generator(this,(function(l){switch(l.label){case 0:if(!this.props.validValues)return[3,9];l.label=1;case 1:l.trys.push([1,6,7,8]),e=o.__values(this.props.validValues),t=e.next(),l.label=2;case 2:return t.done?[3,5]:[4,t.value];case 3:l.sent(),l.label=4;case 4:return t=e.next(),[3,2];case 5:return[3,8];case 6:return r=l.sent(),c={error:r},[3,8];case 7:try{t&&!t.done&&(u=e.return)&&u.call(e)}finally{if(c)throw c.error}return[7];case 8:return[3,13];case 9:if(i=0,n=void 0,a=1,this.props.validValueRanges)i=this.props.validValueRanges[0],n=this.props.validValueRanges[1];else if(null!=this.props.minValue&&null!=this.props.maxValue)i=this.props.minValue,n=this.props.maxValue,null!=this.props.minStep&&(a=this.props.minStep);else{if(!(0,f.isUnsignedNumericFormat)(this.props.format))throw new Error("Could not find valid iterator strategy for props: "+JSON.stringify(this.props));n=(0,f.numericUpperBound)(this.props.format)}s=i,l.label=10;case 10:return s<=n?[4,s]:[3,13];case 11:l.sent(),l.label=12;case 12:return s+=a,[3,10];case 13:return[2]}}))},e}(),y=/^-?\d+$/;function C(e){var t=-70402;if(y.test(e.message)){var r=parseInt(e.message,10);(0,l.IsKnownHAPStatusError)(r)&&(t=r)}return t}function S(e,t){return null==e?t:null==t?e:Math.max(e,t)}function E(e,t){return null==e?t:null==t?e:Math.min(e,t)}var _=function(e){function t(t,r,i){var n=e.call(this)||this;return n.iid=null,n.value=null,n.status=null,n.statusCode=0,n.subscriptions=0,n.displayName=t,n.UUID=r,n.props={format:"int",perms:["ev"]},n.setProps(i||{}),n}return o.__extends(t,e),t.prototype.onGet=function(e){return"function"!=typeof e?(this.characteristicWarning(".onGet handler must be a function"),this):(this.getHandler=e,this)},t.prototype.removeOnGet=function(){return this.getHandler=void 0,this},t.prototype.onSet=function(e){return"function"!=typeof e?(this.characteristicWarning(".onSet handler must be a function"),this):(this.setHandler=e,this)},t.prototype.removeOnSet=function(){return this.setHandler=void 0,this},t.prototype.setProps=function(e){(0,s.default)(e,"props cannot be undefined when setting props");var r=!1;if(e.format&&(r=this.props.format!==e.format,this.props.format=e.format),e.perms&&((0,s.default)(e.perms.length>0,"characteristic prop perms cannot be empty array"),this.props.perms=e.perms),void 0!==e.unit&&(this.props.unit=null!=e.unit?e.unit:void 0),void 0!==e.description&&(this.props.description=null!=e.description?e.description:void 0),void 0!==e.minValue&&(null===e.minValue?e.minValue=void 0:(0,f.isNumericFormat)(this.props.format)?"number"==typeof e.minValue&&Number.isFinite(e.minValue)?e.minValue<(0,f.numericLowerBound)(this.props.format)?(this.characteristicWarning("Characteristic Property 'minValue' was set to "+e.minValue+", but for numeric format "+this.props.format+" minimum possible is "+(0,f.numericLowerBound)(this.props.format),"error-message"),e.minValue=(0,f.numericLowerBound)(this.props.format)):e.minValue>(0,f.numericUpperBound)(this.props.format)&&(this.characteristicWarning("Characteristic Property 'minValue' was set to "+e.minValue+", but for numeric format "+this.props.format+" maximum possible is "+(0,f.numericUpperBound)(this.props.format),"error-message"),e.minValue=(0,f.numericLowerBound)(this.props.format)):(this.characteristicWarning("Characteristic Property 'minValue' must be a finite number, received \"".concat(e.minValue,'" (').concat(typeof e.minValue,")"),"error-message"),e.minValue=void 0):(this.characteristicWarning("Characteristic Property 'minValue' can only be set for characteristics with numeric format, but not for "+this.props.format,"error-message"),e.minValue=void 0),this.props.minValue=e.minValue),void 0!==e.maxValue&&(null===e.maxValue?e.maxValue=void 0:(0,f.isNumericFormat)(this.props.format)?"number"==typeof e.maxValue&&Number.isFinite(e.maxValue)?e.maxValue>(0,f.numericUpperBound)(this.props.format)?(this.characteristicWarning("Characteristic Property 'maxValue' was set to "+e.maxValue+", but for numeric format "+this.props.format+" maximum possible is "+(0,f.numericUpperBound)(this.props.format),"error-message"),e.maxValue=(0,f.numericUpperBound)(this.props.format)):e.maxValue<(0,f.numericLowerBound)(this.props.format)&&(this.characteristicWarning("Characteristic Property 'maxValue' was set to "+e.maxValue+", but for numeric format "+this.props.format+" minimum possible is "+(0,f.numericLowerBound)(this.props.format),"error-message"),e.maxValue=(0,f.numericUpperBound)(this.props.format)):(this.characteristicWarning("Characteristic Property 'maxValue' must be a finite number, received \"".concat(e.maxValue,'" (').concat(typeof e.maxValue,")"),"error-message"),e.maxValue=void 0):(this.characteristicWarning("Characteristic Property 'maxValue' can only be set for characteristics with numeric format, but not for "+this.props.format,"error-message"),e.maxValue=void 0),this.props.maxValue=e.maxValue),void 0!==e.minStep&&(null===e.minStep?this.props.minStep=void 0:(0,f.isNumericFormat)(this.props.format)?(e.minStep<1&&(0,f.isIntegerNumericFormat)(this.props.format)&&this.characteristicWarning("Characteristic Property `minStep` was set to a value lower than 1, this will have no effect on format `"+this.props.format),this.props.minStep=e.minStep):this.characteristicWarning("Characteristic Property `minStep` can only be set for characteristics with numeric format, but not for "+this.props.format,"error-message")),void 0!==e.maxLen&&(null===e.maxLen?this.props.maxLen=void 0:"string"!==this.props.format?this.characteristicWarning("Characteristic Property `maxLen` can only be set for characteristics with format `STRING`, but not for "+this.props.format,"error-message"):(e.maxLen>256&&(this.characteristicWarning("Characteristic Property string `maxLen` cannot be bigger than 256"),e.maxLen=256),this.props.maxLen=e.maxLen)),void 0!==e.maxDataLen&&(null===e.maxDataLen?this.props.maxDataLen=void 0:"data"!==this.props.format?this.characteristicWarning("Characteristic Property `maxDataLen` can only be set for characteristics with format `DATA`, but not for "+this.props.format,"error-message"):this.props.maxDataLen=e.maxDataLen),void 0!==e.validValues&&(null===e.validValues?this.props.validValues=void 0:(0,f.isNumericFormat)(this.props.format)?((0,s.default)(e.validValues.length,"characteristic prop validValues cannot be empty array"),this.props.validValues=e.validValues):this.characteristicWarning("Characteristic Property `validValues` was supplied for non numeric format "+this.props.format)),void 0!==e.validValueRanges&&(null===e.validValueRanges?this.props.validValueRanges=void 0:(0,f.isNumericFormat)(this.props.format)?((0,s.default)(2===e.validValueRanges.length,"characteristic prop validValueRanges must have a length of 2"),this.props.validValueRanges=e.validValueRanges):this.characteristicWarning("Characteristic Property `validValueRanges` was supplied for non numeric format "+this.props.format)),void 0!==e.adminOnlyAccess&&(this.props.adminOnlyAccess=null!=e.adminOnlyAccess?e.adminOnlyAccess:void 0),null!=this.props.minValue&&null!=this.props.maxValue&&this.props.minValue>this.props.maxValue)throw this.props.minValue=void 0,this.props.maxValue=void 0,new Error("Error setting CharacteristicsProps for '"+this.displayName+"': 'minValue' cannot be greater or equal the 'maxValue'!");if(((0,f.isNumericFormat)(this.props.format)||"string"===this.props.format)&&null!=this.value&&!r&&0===this.statusCode&&this.UUID!==t.ProgrammableSwitchEvent.UUID){var i=this.validateUserInput(this.value,"debug-message");i!==this.value&&this.updateValue(i)}return this},t.prototype.validValuesIterator=function(){return new m(this.props)},t.prototype.setupAdditionalAuthorization=function(e){this.props.perms.includes("aa")||this.props.perms.push("aa"),this.additionalAuthorizationHandler=e},t.prototype.getValue=function(e,t){this.handleGetRequest(void 0,t).then((function(t){e&&e(null,t)}),(function(t){e&&e(t)}))},t.prototype.setValue=function(e,t,r){if(e instanceof Error)return this.statusCode=e instanceof d.HapStatusError?e.hapStatus:C(e),this.status=e,t&&t(),this;t&&!r&&"function"!=typeof t&&(r=t,t=void 0);try{e=this.validateUserInput(e)}catch(e){return this.characteristicWarning((null==e?void 0:e.message)+"","error-message",null==e?void 0:e.stack),t&&t(e),this}return this.handleSetRequest(e,void 0,r).then((function(e){t&&(e?t(null,e):t(null))}),(function(e){t&&t(e)})),this},t.prototype.updateValue=function(e,t,r){if(e instanceof Error)return this.statusCode=e instanceof d.HapStatusError?e.hapStatus:C(e),this.status=e,t&&t(),this;t&&!r&&"function"!=typeof t&&(r=t,t=void 0);try{e=this.validateUserInput(e)}catch(e){return this.characteristicWarning((null==e?void 0:e.message)+"","error-message",null==e?void 0:e.stack),t&&t(),this}this.statusCode=0,this.status=null;var i=this.value;return this.value=e,t&&t(),this.emit("change",{originator:void 0,oldValue:i,newValue:e,reason:"update",context:r}),this},t.prototype.sendEventNotification=function(e,t){this.statusCode=0,this.status=null,e=this.validateUserInput(e);var r=this.value;return this.value=e,this.emit("change",{originator:void 0,oldValue:r,newValue:e,reason:"event",context:t}),this},t.prototype.handleGetRequest=function(e,r){return o.__awaiter(this,void 0,void 0,(function(){var i,n,a,s,c=this;return o.__generator(this,(function(o){switch(o.label){case 0:if(!this.props.perms.includes("pr"))throw-70405;if(this.UUID===t.ProgrammableSwitchEvent.UUID)return[2,null];if(!this.getHandler)return[3,4];this.listeners("get").length>0&&this.characteristicWarning("Ignoring on('get') handler as onGet handler was defined instead"),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.getHandler(r,e)];case 2:i=o.sent(),this.statusCode=0,this.status=null;try{i=this.validateUserInput(i)}catch(e){return this.characteristicWarning("An illegal value was supplied by the read handler for characteristic: ".concat(null==e?void 0:e.message),"warn-message",null==e?void 0:e.stack),this.statusCode=-70402,this.status=e,[2,Promise.reject(-70402)]}return n=this.value,this.value=i,n!==i&&this.emit("change",{originator:e,oldValue:n,newValue:i,reason:"read",context:r}),[2,i];case 3:throw"number"==typeof(a=o.sent())?(s=new d.HapStatusError(a),this.statusCode=s.hapStatus,this.status=s):a instanceof d.HapStatusError?(this.statusCode=a.hapStatus,this.status=a):(this.characteristicWarning("Unhandled error thrown inside read handler for characteristic: ".concat(null==a?void 0:a.message),"error-message",null==a?void 0:a.stack),this.statusCode=-70402,this.status=a),this.statusCode;case 4:if(0===this.listeners("get").length){if(this.statusCode)throw this.statusCode;try{return[2,this.validateUserInput(this.value)]}catch(e){return this.characteristicWarning("An illegal value was supplied by setting `value` for characteristic: ".concat(null==e?void 0:e.message),"warn-message",null==e?void 0:e.stack),[2,Promise.reject(-70402)]}}return[2,new Promise((function(t,i){try{c.emit("get",(0,p.once)((function(n,a){if(n){if("number"==typeof n){var o=new d.HapStatusError(n);c.statusCode=o.hapStatus,c.status=o}else n instanceof d.HapStatusError?(c.statusCode=n.hapStatus,c.status=n):(g("[%s] Received error from get handler %s",c.displayName,n.stack),c.statusCode=C(n),c.status=n);i(c.statusCode)}else{c.statusCode=0,c.status=null,a=c.validateUserInput(a);var s=c.value;c.value=a,t(a),s!==a&&c.emit("change",{originator:e,oldValue:s,newValue:a,reason:"read",context:r})}})),r,e)}catch(e){c.characteristicWarning("Unhandled error thrown inside read handler for characteristic: ".concat(null==e?void 0:e.message),"error-message",null==e?void 0:e.stack),c.statusCode=-70402,c.status=e,i(-70402)}}))]}}))}))},t.prototype.handleSetRequest=function(e,t,r){return o.__awaiter(this,void 0,void 0,(function(){var i,n,a,s,c=this;return o.__generator(this,(function(o){switch(o.label){case 0:if(this.statusCode=0,this.status=null,void 0!==t)try{e=this.validateClientSuppliedValue(e)}catch(e){return g("[".concat(this.displayName,"]"),e.message),[2,Promise.reject(-70410)]}if(i=this.value,!this.setHandler)return[3,4];this.listeners("set").length>0&&this.characteristicWarning("Ignoring on('set') handler as onSet handler was defined instead"),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.setHandler(e,r,t)];case 2:return n=o.sent(),this.statusCode=0,this.status=null,null!=n&&this.props.perms.includes("wr")?(this.value=this.validateUserInput(n),[2,this.value]):(null!=n&&this.characteristicWarning("SET handler returned write response value, though the characteristic doesn't support write response","debug-message"),this.value=e,this.emit("change",{originator:t,oldValue:i,newValue:e,reason:"write",context:r}),[2]);case 3:throw"number"==typeof(a=o.sent())?(s=new d.HapStatusError(a),this.statusCode=s.hapStatus,this.status=s):a instanceof d.HapStatusError?(this.statusCode=a.hapStatus,this.status=a):(this.characteristicWarning("Unhandled error thrown inside write handler for characteristic: ".concat(null==a?void 0:a.message),"error-message",null==a?void 0:a.stack),this.statusCode=-70402,this.status=a),this.statusCode;case 4:return 0===this.listeners("set").length?(this.value=e,this.emit("change",{originator:t,oldValue:i,newValue:e,reason:"write",context:r}),[2,Promise.resolve()]):[2,new Promise((function(n,a){try{c.emit("set",e,(0,p.once)((function(o,s){if(o){if("number"==typeof o){var u=new d.HapStatusError(o);c.statusCode=u.hapStatus,c.status=u}else o instanceof d.HapStatusError?(c.statusCode=o.hapStatus,c.status=o):(g("[%s] Received error from set handler %s",c.displayName,o.stack),c.statusCode=C(o),c.status=o);a(c.statusCode)}else c.statusCode=0,c.status=null,null!=s&&c.props.perms.includes("wr")?(c.value=c.validateUserInput(s),n(c.value)):(null!=s&&c.characteristicWarning("SET handler returned write response value, though the characteristic doesn't support write response","debug-message"),c.value=e,n(),c.emit("change",{originator:t,oldValue:i,newValue:e,reason:"write",context:r}))})),r,t)}catch(e){c.characteristicWarning("Unhandled error thrown inside write handler for characteristic: ".concat(null==e?void 0:e.message),"error-message",null==e?void 0:e.stack),c.statusCode=-70402,c.status=e,a(-70402)}}))]}}))}))},t.prototype.subscribe=function(){0===this.subscriptions&&this.emit("subscribe"),this.subscriptions++},t.prototype.unsubscribe=function(){var e=1===this.subscriptions;this.subscriptions--,this.subscriptions=Math.max(this.subscriptions,0),e&&this.emit("unsubscribe")},t.prototype.getDefaultValue=function(){var e;switch(this.props.format){case"bool":return!1;case"string":switch(this.UUID){case t.Manufacturer.UUID:return"Default-Manufacturer";case t.Model.UUID:return"Default-Model";case t.SerialNumber.UUID:return"Default-SerialNumber";case t.FirmwareRevision.UUID:return"0.0.0";default:return""}case"data":case"tlv8":return"";case"dict":return{};case"array":return[];case"int":case"float":case"uint8":case"uint16":case"uint32":case"uint64":return this.UUID===t.CurrentTemperature.UUID?0:(null===(e=this.props.validValues)||void 0===e?void 0:e.length)&&"number"==typeof this.props.validValues[0]?this.props.validValues[0]:"number"==typeof this.props.minValue&&Number.isFinite(this.props.minValue)?this.props.minValue:0;default:return 0}},t.prototype.validateClientSuppliedValue=function(e){if(null==e)throw new Error("Client supplied invalid value for ".concat(this.props.format,": ").concat(e));switch(this.props.format){case"bool":if("boolean"==typeof e)return e;if("number"==typeof e&&(1===e||0===e))return Boolean(e);throw new Error("Client supplied invalid type for ".concat(this.props.format,': "').concat(e,'" (').concat(typeof e,")"));case"int":case"float":case"uint8":case"uint16":case"uint32":case"uint64":if("boolean"==typeof e&&(e=e?1:0),"number"!=typeof e||!Number.isFinite(e))throw new Error("Client supplied invalid type for ".concat(this.props.format,': "').concat(e,'" (').concat(typeof e,")"));var t=S(this.props.minValue,(0,f.numericLowerBound)(this.props.format)),r=E(this.props.maxValue,(0,f.numericUpperBound)(this.props.format));if("number"==typeof t&&e<t)throw new Error("Client supplied value of ".concat(e," is less than the minimum allowed value of ").concat(t));if("number"==typeof r&&e>r)throw new Error("Client supplied value of ".concat(e," is greater than the maximum allowed value of ").concat(r));if(this.props.validValues&&!this.props.validValues.includes(e))throw new Error("Client supplied value of ".concat(e," is not in ").concat(this.props.validValues.toString()));if(this.props.validValueRanges&&2===this.props.validValueRanges.length){if(e<this.props.validValueRanges[0])throw new Error("Client supplied value of ".concat(e," is less than the minimum allowed value of ").concat(this.props.validValueRanges[0]));if(e>this.props.validValueRanges[1])throw new Error("Client supplied value of ".concat(e," is greater than the maximum allowed value of ").concat(this.props.validValueRanges[1]))}return e;case"string":if("string"!=typeof e)throw new Error("Client supplied invalid type for ".concat(this.props.format,': "').concat(e,'" (').concat(typeof e,")"));var i=null!=this.props.maxLen?this.props.maxLen:64;if(e.length>i)throw new Error("Client supplied value length of ".concat(e.length," exceeds maximum length allowed of ").concat(i));return e;case"data":if("string"!=typeof e)throw new Error("Client supplied invalid type for ".concat(this.props.format,': "').concat(e,'" (').concat(typeof e,")"));i=null!=this.props.maxDataLen?this.props.maxDataLen:2097152;if(e.length>i)throw new Error("Client supplied value length of ".concat(e.length," exceeds maximum length allowed of ").concat(i));return e;case"tlv8":if("string"!=typeof e)throw new Error("Client supplied invalid type for ".concat(this.props.format,': "').concat(e,'" (').concat(typeof e,")"));return e}return e},t.prototype.validateUserInput=function(e,r){var i;if(void 0===r&&(r="warn-message"),null===e){if(this.UUID===t.Model.UUID||this.UUID===t.SerialNumber.UUID)return this.characteristicWarning("characteristic must have a non null value otherwise HomeKit will reject this accessory, ignoring new value","error-message"),this.value;if("data"===this.props.format||"tlv8"===this.props.format)return e;if(!this.UUID.endsWith(v.BASE_UUID))return e;if(this.UUID===t.ProgrammableSwitchEvent.UUID)return e;if(this.characteristicWarning("characteristic was supplied illegal value: null! Home App will reject null for Apple defined characteristics",r),null!==this.value)return this.value}switch(this.props.format){case"bool":return"boolean"==typeof e?e:"number"==typeof e?1===e:"string"==typeof e?"1"===e||"true"===e:(this.characteristicWarning("characteristic value expected boolean and received "+typeof e,r),!1);case"int":case"float":case"uint8":case"uint16":case"uint32":case"uint64":"boolean"==typeof e&&(e=e?1:0),"string"==typeof e&&(e="float"===this.props.format?parseFloat(e):parseInt(e,10)),"number"==typeof e&&Number.isFinite(e)||(this.characteristicWarning('characteristic value expected valid finite number and received "'.concat(e,'" (').concat(typeof e,")"),r),e="number"==typeof this.value?this.value:this.props.minValue||0);var n=S(this.props.minValue,(0,f.numericLowerBound)(this.props.format)),a=E(this.props.maxValue,(0,f.numericUpperBound)(this.props.format)),o=void 0;if(null!=(o="float"===this.props.format?this.props.minStep:S(this.props.minStep,1))&&o>0){var s=null!=this.props.minValue?this.props.minValue:0;e=o*Math.round((e-s)/o)+s}return null!=n&&e<n&&(this.characteristicWarning("characteristic was supplied illegal value: number ".concat(e," exceeded minimum of ").concat(n),r),e=n),null!=a&&e>a&&(this.characteristicWarning("characteristic was supplied illegal value: number ".concat(e," exceeded maximum of ").concat(a),r),e=a),this.props.validValues&&!this.props.validValues.includes(e)?(this.characteristicWarning("characteristic value ".concat(e," is not contained in valid values array"),r),this.props.validValues.includes(this.value)?this.value:this.props.validValues[0]||0):(this.props.validValueRanges&&2===this.props.validValueRanges.length&&(e<this.props.validValueRanges[0]?(this.characteristicWarning("characteristic was supplied illegal value: number ".concat(e," not contained in valid value range of           ").concat(this.props.validValueRanges,", supplying illegal values will throw errors in the future"),r),e=this.props.validValueRanges[0]):e>this.props.validValueRanges[1]&&(this.characteristicWarning("characteristic was supplied illegal value: number ".concat(e," not contained in valid value range of           ").concat(this.props.validValueRanges,", supplying illegal values will throw errors in the future"),r),e=this.props.validValueRanges[1])),e);case"string":if("number"==typeof e&&(this.characteristicWarning("characteristic was supplied illegal value: number instead of string, supplying illegal values will throw errors in the future",r),e=String(e)),"string"!=typeof e&&(this.characteristicWarning("characteristic value expected string and received "+typeof e,r),e="string"==typeof this.value?this.value:e+""),e.length<=1&&(this.UUID===t.Model.UUID||this.UUID===t.SerialNumber.UUID))return this.characteristicWarning("[".concat(this.displayName,"] characteristic must have a length of more than 1 character otherwise         HomeKit will reject this accessory, ignoring new value"),r),this.value;var c=null!==(i=this.props.maxLen)&&void 0!==i?i:64;return e.length>c&&(this.characteristicWarning("characteristic was supplied illegal value: string '".concat(e,"' exceeded max length of ").concat(c),r),e=e.substring(0,c)),e;case"data":if("string"!=typeof e)throw new Error("characteristic with DATA format must have string value");if(null!=this.props.maxDataLen&&e.length>this.props.maxDataLen)throw new Error("characteristic with DATA format exceeds specified maxDataLen");return e;case"tlv8":return void 0===e?(this.characteristicWarning("characteristic was supplied illegal value: undefined",r),this.value):e}return void 0===e?(this.characteristicWarning("characteristic was supplied illegal value: undefined","error-message"),this.value):e},t.prototype._assignID=function(e,t,r,i){this.iid=e.getIID(t,r,i,this.UUID)},t.prototype.characteristicWarning=function(e,t,r){void 0===t&&(t="warn-message"),void 0===r&&(r=(new Error).stack),this.emit("characteristic-warning",t,e,r)},t.prototype.removeAllListeners=function(t){return t||(this.removeOnGet(),this.removeOnSet()),e.prototype.removeAllListeners.call(this,t)},t.prototype.replaceBy=function(e){var t=this;this.props=e.props,this.updateValue(e.value);var r=e.listeners("get");r.length&&(this.removeAllListeners("get"),r.forEach((function(e){return t.addListener("get",e)}))),this.removeOnGet(),e.getHandler&&this.onGet(e.getHandler);var i=e.listeners("set");i.length&&(this.removeAllListeners("set"),i.forEach((function(e){return t.addListener("set",e)}))),this.removeOnSet(),e.setHandler&&this.onSet(e.setHandler)},t.prototype.toHAP=function(e,r){return void 0===r&&(r=!0),o.__awaiter(this,void 0,void 0,(function(){var i,n,a,s=this;return o.__generator(this,(function(o){switch(o.label){case 0:return i=this.internalHAPRepresentation(),this.props.perms.includes("pr")?[3,1]:(i.value=void 0,[3,6]);case 1:return this.UUID!==t.ProgrammableSwitchEvent.UUID?[3,2]:(i.value=null,[3,6]);case 2:return r?[4,this.handleGetRequest(e).catch((function(){var e=s.getDefaultValue();return g("[%s] Error getting value for characteristic on /accessories request. Returning default value instead: %s",s.displayName,"".concat(e)),e}))]:[3,4];case 3:return a=o.sent(),[3,5];case 4:a=this.value,o.label=5;case 5:n=a,i.value=(0,f.formatOutgoingCharacteristicValue)(n,this.props),o.label=6;case 6:return[2,i]}}))}))},t.prototype.internalHAPRepresentation=function(){return(0,s.default)(this.iid,"iid cannot be undefined for characteristic '"+this.displayName+"'"),{type:(0,v.toShortForm)(this.UUID),iid:this.iid,value:null,perms:this.props.perms,description:this.props.description||this.displayName,format:this.props.format,unit:this.props.unit,minValue:this.props.minValue,maxValue:this.props.maxValue,minStep:this.props.minStep,maxLen:this.props.maxLen,maxDataLen:this.props.maxDataLen,"valid-values":this.props.validValues,"valid-values-range":this.props.validValueRanges}},t.serialize=function(e){var r;return"Characteristic"!==e.constructor.name&&(r=e.constructor.name),{displayName:e.displayName,UUID:e.UUID,eventOnlyCharacteristic:e.UUID===t.ProgrammableSwitchEvent.UUID,constructorName:r,value:e.value,props:(0,h.clone)({},e.props)}},t.deserialize=function(e){var r;e.constructorName&&e.constructorName.charAt(0).toUpperCase()===e.constructorName.charAt(0)&&t[e.constructorName]?((r=new(0,t[e.constructorName])).displayName=e.displayName,r.setProps(e.props)):r=new t(e.displayName,e.UUID,e.props);return r.value=e.value,r},t.Formats=i,t.Units=n,t.Perms=a,t}(u.EventEmitter);t.Characteristic=_,r(651)},589:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HAPServer=t.HAPServerEventTypes=t.HAPPairingHTTPCode=t.HAPHTTPCode=t.Status=t.Codes=t.IsKnownHAPStatusError=t.HAPStatus=t.TLVErrorCode=void 0;var i,n,a=r(1635),o=a.__importDefault(r(6982)),s=a.__importDefault(r(5753)),c=r(4434),u=r(4618),l=a.__importDefault(r(8947)),h=r(7016),d=r(8602),p=r(9593),f=a.__importStar(r(8)),v=r(7739),g=a.__importStar(r(3314)),m=(0,s.default)("HAP-NodeJS:HAPServer");!function(e){e[e.UNKNOWN=1]="UNKNOWN",e[e.INVALID_REQUEST=2]="INVALID_REQUEST",e[e.AUTHENTICATION=2]="AUTHENTICATION",e[e.BACKOFF=3]="BACKOFF",e[e.MAX_PEERS=4]="MAX_PEERS",e[e.MAX_TRIES=5]="MAX_TRIES",e[e.UNAVAILABLE=6]="UNAVAILABLE",e[e.BUSY=7]="BUSY"}(i=t.TLVErrorCode||(t.TLVErrorCode={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.INSUFFICIENT_PRIVILEGES=-70401]="INSUFFICIENT_PRIVILEGES",e[e.SERVICE_COMMUNICATION_FAILURE=-70402]="SERVICE_COMMUNICATION_FAILURE",e[e.RESOURCE_BUSY=-70403]="RESOURCE_BUSY",e[e.READ_ONLY_CHARACTERISTIC=-70404]="READ_ONLY_CHARACTERISTIC",e[e.WRITE_ONLY_CHARACTERISTIC=-70405]="WRITE_ONLY_CHARACTERISTIC",e[e.NOTIFICATION_NOT_SUPPORTED=-70406]="NOTIFICATION_NOT_SUPPORTED",e[e.OUT_OF_RESOURCE=-70407]="OUT_OF_RESOURCE",e[e.OPERATION_TIMED_OUT=-70408]="OPERATION_TIMED_OUT",e[e.RESOURCE_DOES_NOT_EXIST=-70409]="RESOURCE_DOES_NOT_EXIST",e[e.INVALID_VALUE_IN_REQUEST=-70410]="INVALID_VALUE_IN_REQUEST",e[e.INSUFFICIENT_AUTHORIZATION=-70411]="INSUFFICIENT_AUTHORIZATION",e[e.NOT_ALLOWED_IN_CURRENT_STATE=-70412]="NOT_ALLOWED_IN_CURRENT_STATE"}(n=t.HAPStatus||(t.HAPStatus={})),t.IsKnownHAPStatusError=function(e){return e>=-70412&&e<=-70401},t.Codes=i,t.Status=n,function(e){e[e.OK=200]="OK",e[e.NO_CONTENT=204]="NO_CONTENT",e[e.MULTI_STATUS=207]="MULTI_STATUS",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",e[e.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",e[e.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE"}(t.HAPHTTPCode||(t.HAPHTTPCode={})),function(e){e[e.OK=200]="OK",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.METHOD_NOT_ALLOWED=405]="METHOD_NOT_ALLOWED",e[e.TOO_MANY_REQUESTS=429]="TOO_MANY_REQUESTS",e[e.CONNECTION_AUTHORIZATION_REQUIRED=470]="CONNECTION_AUTHORIZATION_REQUIRED",e[e.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR"}(t.HAPPairingHTTPCode||(t.HAPPairingHTTPCode={})),function(e){e.LISTENING="listening",e.IDENTIFY="identify",e.ADD_PAIRING="add-pairing",e.REMOVE_PAIRING="remove-pairing",e.LIST_PAIRINGS="list-pairings",e.PAIR="pair",e.ACCESSORIES="accessories",e.GET_CHARACTERISTICS="get-characteristics",e.SET_CHARACTERISTICS="set-characteristics",e.REQUEST_RESOURCE="request-resource",e.CONNECTION_CLOSED="connection-closed"}(t.HAPServerEventTypes||(t.HAPServerEventTypes={}));var y=function(e){function t(t){var r=e.call(this)||this;return r.unsuccessfulPairAttempts=0,r.accessoryInfo=t,r.allowInsecureRequest=!1,r.httpServer=new p.EventedHTTPServer,r.httpServer.on("listening",r.onListening.bind(r)),r.httpServer.on("request",r.handleRequestOnHAPConnection.bind(r)),r.httpServer.on("connection-closed",r.handleConnectionClosed.bind(r)),r}return a.__extends(t,e),t.prototype.listen=function(e,t){void 0===e&&(e=0),"::"===t&&(t=void 0),this.httpServer.listen(e,t)},t.prototype.stop=function(){this.httpServer.stop()},t.prototype.destroy=function(){this.stop(),this.removeAllListeners()},t.prototype.sendEventNotifications=function(e,t,r,i,n){try{this.httpServer.broadcastEvent(e,t,r,i,n)}catch(e){console.warn("["+this.accessoryInfo.username+"] Error when sending event notifications: "+e.message)}},t.prototype.onListening=function(e,t){this.emit("listening",e,t)},t.prototype.handleRequestOnHAPConnection=function(e,t,r){var i=this;m("[%s] HAP Request: %s %s",this.accessoryInfo.username,t.method,t.url);var n=[];t.on("data",(function(e){return n.push(e)})),t.on("end",(function(){var a=new h.URL(t.url,"http://hap-nodejs.local"),o=i.getHandler(a);if(o){var s=Buffer.concat(n);try{o(e,a,t,s,r)}catch(e){m("[%s] Error executing route handler: %s",i.accessoryInfo.username,e.stack),r.writeHead(500,{"Content-Type":"application/hap+json"}),r.end(JSON.stringify({status:-70403}))}}else m("[%s] WARNING: Handler for %s not implemented",i.accessoryInfo.username,t.url),r.writeHead(404,{"Content-Type":"application/hap+json"}),r.end(JSON.stringify({status:-70409}))}))},t.prototype.handleConnectionClosed=function(e){this.emit("connection-closed",e)},t.prototype.getHandler=function(e){switch(e.pathname.toLowerCase()){case"/identify":return this.handleIdentifyRequest.bind(this);case"/pair-setup":return this.handlePairSetup.bind(this);case"/pair-verify":return this.handlePairVerify.bind(this);case"/pairings":return this.handlePairings.bind(this);case"/accessories":return this.handleAccessories.bind(this);case"/characteristics":return this.handleCharacteristics.bind(this);case"/prepare":return this.handlePrepareWrite.bind(this);case"/resource":return this.handleResource.bind(this);default:return}},t.prototype.handleIdentifyRequest=function(e,t,r,i,n){var a=this;if(this.accessoryInfo.paired()&&!this.allowInsecureRequest)return n.writeHead(400,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:-70401}));this.emit("identify",(0,v.once)((function(e){e?(m("[%s] Identification error: %s",a.accessoryInfo.username,e.message),n.writeHead(500,{"Content-Type":"application/hap+json"}),n.end(JSON.stringify({status:-70403}))):(m("[%s] Identification success",a.accessoryInfo.username),n.writeHead(204),n.end())})))},t.prototype.handlePairSetup=function(e,t,r,i,n){if(!this.allowInsecureRequest&&this.accessoryInfo.paired())return n.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),void n.end(g.encode(6,2,7,6));if(this.unsuccessfulPairAttempts>100)return m("[%s] Reached maximum amount of unsuccessful pair attempts!",this.accessoryInfo.username),n.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),void n.end(g.encode(6,2,7,5));var a=g.decode(i),o=a[6][0];if(1===o)this.handlePairSetupM1(e,r,n);else if(3===o&&2===e._pairSetupState)this.handlePairSetupM3(e,r,n,a);else{if(5!==o||4!==e._pairSetupState)return n.writeHead(400,{"Content-Type":"application/pairing+tlv8"}),void n.end(g.encode(6,o+1,7,1));this.handlePairSetupM5(e,r,n,a)}},t.prototype.handlePairSetupM1=function(e,t,r){var i=this;m("[%s] Pair step 1/5",this.accessoryInfo.username);var n=o.default.randomBytes(16),a=u.SRP.params.hap;u.SRP.genKey(32).then((function(t){var o=new u.SrpServer(a,n,Buffer.from("Pair-Setup"),Buffer.from(i.accessoryInfo.pincode),t),s=o.computeB();e.srpServer=o,r.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),r.end(g.encode(6,2,2,n,3,s)),e._pairSetupState=2})).catch((function(e){m("[%s] Error occurred when generating srp key: %s",i.accessoryInfo.username,e.message),r.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),r.end(g.encode(6,2,7,1))}))},t.prototype.handlePairSetupM3=function(e,t,r,i){m("[%s] Pair step 2/5",this.accessoryInfo.username);var n=i[3],a=i[4],o=e.srpServer;o.setA(n);try{o.checkM1(a)}catch(t){return this.unsuccessfulPairAttempts++,m("[%s] Error while checking pincode: %s",this.accessoryInfo.username,t.message),r.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),r.end(g.encode(6,4,7,2)),void(e._pairSetupState=void 0)}var s=o.computeM2();r.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),r.end(g.encode(6,4,4,s)),e._pairSetupState=4},t.prototype.handlePairSetupM5=function(e,t,r,i){m("[%s] Pair step 3/5",this.accessoryInfo.username);var n=e.srpServer,a=i[5],o=Buffer.alloc(a.length-16),s=Buffer.alloc(16);a.copy(o,0,0,a.length-16),a.copy(s,0,a.length-16,a.length);var c,u=n.computeK(),l=Buffer.from("Pair-Setup-Encrypt-Salt"),h=Buffer.from("Pair-Setup-Encrypt-Info"),d=f.HKDF("sha512",l,u,h,32);try{c=f.chacha20_poly1305_decryptAndVerify(d,Buffer.from("PS-Msg05"),null,o,s)}catch(t){return m("[%s] Error while decrypting and verifying M5 subTlv: %s",this.accessoryInfo.username),r.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),r.end(g.encode(6,4,7,2)),void(e._pairSetupState=void 0)}var p=g.decode(c),v=p[1],y=p[3],C=p[10];this.handlePairSetupM5_2(e,t,r,v,y,C,d)},t.prototype.handlePairSetupM5_2=function(e,t,r,i,n,a,o){m("[%s] Pair step 4/5",this.accessoryInfo.username);var s=e.srpServer.computeK(),c=Buffer.from("Pair-Setup-Controller-Sign-Salt"),u=Buffer.from("Pair-Setup-Controller-Sign-Info"),h=f.HKDF("sha512",c,s,u,32),d=Buffer.concat([h,i,n]);if(!l.default.sign.detached.verify(d,a,n))return m("[%s] Invalid signature",this.accessoryInfo.username),r.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),r.end(g.encode(6,6,7,2)),void(e._pairSetupState=void 0);this.handlePairSetupM5_3(e,t,r,i,n,o)},t.prototype.handlePairSetupM5_3=function(e,t,r,i,n,a){var o=this;m("[%s] Pair step 5/5",this.accessoryInfo.username);var s=e.srpServer.computeK(),c=Buffer.from("Pair-Setup-Accessory-Sign-Salt"),u=Buffer.from("Pair-Setup-Accessory-Sign-Info"),h=f.HKDF("sha512",c,s,u,32),d=this.accessoryInfo.signPk,p=Buffer.from(this.accessoryInfo.username),y=Buffer.concat([h,p,d]),C=Buffer.from(this.accessoryInfo.signSk),S=l.default.sign.detached(y,C),E=g.encode(1,p,3,d,10,S),_=f.chacha20_poly1305_encryptAndSeal(a,Buffer.from("PS-Msg06"),null,E);this.emit("pair",i.toString(),n,(0,v.once)((function(t){if(t)return m("[%s] Error adding pairing info: %s",o.accessoryInfo.username,t.message),r.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),r.end(g.encode(6,6,7,1)),void(e._pairSetupState=void 0);r.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),r.end(g.encode(6,6,5,Buffer.concat([_.ciphertext,_.authTag]))),e._pairSetupState=void 0})))},t.prototype.handlePairVerify=function(e,t,r,i,n){var a=g.decode(i),o=a[6][0];if(1===o)this.handlePairVerifyM1(e,r,n,a);else{if(3!==o||2!==e._pairVerifyState)return n.writeHead(400,{"Content-Type":"application/pairing+tlv8"}),void n.end(g.encode(6,o+1,7,1));this.handlePairVerifyM3(e,r,n,a)}},t.prototype.handlePairVerifyM1=function(e,t,r,i){m("[%s] Pair verify step 1/2",this.accessoryInfo.username);var n=i[3],a=f.generateCurve25519KeyPair(),o=Buffer.from(a.secretKey),s=Buffer.from(a.publicKey),c=Buffer.from(f.generateCurve25519SharedSecKey(o,n)),u=Buffer.from(this.accessoryInfo.username),h=Buffer.concat([s,u,n]),d=Buffer.from(this.accessoryInfo.signSk),v=l.default.sign.detached(h,d),y=Buffer.from("Pair-Verify-Encrypt-Salt"),C=Buffer.from("Pair-Verify-Encrypt-Info"),S=f.HKDF("sha512",y,c,C,32).slice(0,32);e.encryption=new p.HAPEncryption(n,o,s,c,S);var E=g.encode(1,u,10,v),_=f.chacha20_poly1305_encryptAndSeal(S,Buffer.from("PV-Msg02"),null,E);r.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),r.end(g.encode(6,2,5,Buffer.concat([_.ciphertext,_.authTag]),3,s)),e._pairVerifyState=2},t.prototype.handlePairVerifyM3=function(e,t,r,i){m("[%s] Pair verify step 2/2",this.accessoryInfo.username);var n=i[5],a=Buffer.alloc(n.length-16),o=Buffer.alloc(16);n.copy(a,0,0,n.length-16),n.copy(o,0,n.length-16,n.length);var s,c=e.encryption;try{s=f.chacha20_poly1305_decryptAndVerify(c.hkdfPairEncryptionKey,Buffer.from("PV-Msg03"),null,a,o)}catch(t){return m("[%s] M3: Failed to decrypt and/or verify",this.accessoryInfo.username),r.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),r.end(g.encode(6,4,7,2)),void(e._pairVerifyState=void 0)}var u=g.decode(s),h=u[1],d=u[10],p=Buffer.concat([c.clientPublicKey,h,c.publicKey]),v=this.accessoryInfo.getClientPublicKey(h.toString());if(!v)return m("[%s] Client %s attempting to verify, but we are not paired; rejecting client",this.accessoryInfo.username,h),r.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),r.end(g.encode(6,4,7,2)),void(e._pairVerifyState=void 0);if(!l.default.sign.detached.verify(p,d,v))return m("[%s] Client %s provided an invalid signature",this.accessoryInfo.username,h),r.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),r.end(g.encode(6,4,7,2)),void(e._pairVerifyState=void 0);m("[%s] Client %s verification complete",this.accessoryInfo.username,h),r.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),r.end(g.encode(6,4));var y=Buffer.from("Control-Salt"),C=Buffer.from("Control-Read-Encryption-Key"),S=Buffer.from("Control-Write-Encryption-Key");c.accessoryToControllerKey=f.HKDF("sha512",y,c.sharedSecret,C,32),c.controllerToAccessoryKey=f.HKDF("sha512",y,c.sharedSecret,S,32),e.connectionAuthenticated(h.toString()),e._pairVerifyState=void 0},t.prototype.handlePairings=function(e,t,r,i,n){var o=this;if(!this.allowInsecureRequest&&!e.isAuthenticated())return n.writeHead(470,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:-70401}));var s=g.decode(i),c=s[0][0];if(1===s[6][0])if(3===c){var u=s[1].toString(),l=s[3],h=s[11][0];this.emit("add-pairing",e,u,l,h,(0,v.once)((function(e){if(e>0)return m("[%s] Pairings: failed ADD_PAIRING with code %d",o.accessoryInfo.username,e),n.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),void n.end(g.encode(6,2,7,e));n.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),n.end(g.encode(6,2)),m("[%s] Pairings: successfully executed ADD_PAIRING",o.accessoryInfo.username)})))}else if(4===c){u=s[1].toString();this.emit("remove-pairing",e,u,(0,v.once)((function(e){if(e>0)return m("[%s] Pairings: failed REMOVE_PAIRING with code %d",o.accessoryInfo.username,e),n.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),void n.end(g.encode(6,2,7,e));n.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),n.end(g.encode(6,2)),m("[%s] Pairings: successfully executed REMOVE_PAIRING",o.accessoryInfo.username)})))}else 5===c&&this.emit("list-pairings",e,(0,v.once)((function(e,t){if(e>0)return m("[%s] Pairings: failed LIST_PAIRINGS with code %d",o.accessoryInfo.username,e),n.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),void n.end(g.encode(6,2,7,e));var r=[];t.forEach((function(e,t){t>0&&r.push(255,Buffer.alloc(0)),r.push(1,e.username,3,e.publicKey,11,e.permission)}));var i=g.encode.apply(g,a.__spreadArray([6,2],a.__read(r),!1));n.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),n.end(i),m("[%s] Pairings: successfully executed LIST_PAIRINGS",o.accessoryInfo.username)})))},t.prototype.handleAccessories=function(e,t,r,i,n){if(!this.allowInsecureRequest&&!e.isAuthenticated())return n.writeHead(470,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:-70401}));this.emit("accessories",e,(0,v.once)((function(e,t){e?(n.writeHead(e.httpCode,{"Content-Type":"application/hap+json"}),n.end(JSON.stringify({status:e.status}))):(n.writeHead(200,{"Content-Type":"application/hap+json"}),n.end(JSON.stringify(t)))})))},t.prototype.handleCharacteristics=function(e,t,r,i,n){var o,s;if(!this.allowInsecureRequest&&!e.isAuthenticated())return n.writeHead(470,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:-70401}));if("GET"===r.method){var c=t.searchParams,u=c.get("id");if(!u)return n.writeHead(400,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:-70410}));var l=[];try{for(var h=a.__values(u.split(",")),p=h.next();!p.done;p=h.next()){var f=p.value.split(".");l.push({aid:parseInt(f[0],10),iid:parseInt(f[1],10)})}}catch(e){o={error:e}}finally{try{p&&!p.done&&(s=h.return)&&s.call(h)}finally{if(o)throw o.error}}var g={ids:l,includeMeta:(0,d.consideredTrue)(c.get("meta")),includePerms:(0,d.consideredTrue)(c.get("perms")),includeType:(0,d.consideredTrue)(c.get("type")),includeEvent:(0,d.consideredTrue)(c.get("ev"))};this.emit("get-characteristics",e,g,(0,v.once)((function(e,t){var r,i,o,s;if(e)return n.writeHead(e.httpCode,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:e.status}));var c=t.characteristics,u=!1;try{for(var l=a.__values(c),h=l.next();!h.done;h=l.next()){if(h.value.status){u=!0;break}}}catch(e){r={error:e}}finally{try{h&&!h.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}if(u)try{for(var d=a.__values(c),p=d.next();!p.done;p=d.next()){var f=p.value;f.status||(f.status=0)}}catch(e){o={error:e}}finally{try{p&&!p.done&&(s=d.return)&&s.call(d)}finally{if(o)throw o.error}}n.writeHead(u?207:200,{"Content-Type":"application/hap+json"}),n.end(JSON.stringify({characteristics:c}))})))}else if("PUT"===r.method){if(!e.isAuthenticated()&&(!r.headers||r.headers&&r.headers.authorization!==this.accessoryInfo.pincode))return n.writeHead(470,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:-70401}));if(0===i.length)return n.writeHead(400,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:-70410}));var m=JSON.parse(i.toString("utf8"));this.emit("set-characteristics",e,m,(0,v.once)((function(e,t){var r,i;if(e)return n.writeHead(e.httpCode,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:e.status}));var o=t.characteristics,s=!1;try{for(var c=a.__values(o),u=c.next();!u.done;u=c.next()){var l=u.value;if(l.status||void 0!==l.value){s=!0;break}}}catch(e){r={error:e}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}s?(n.writeHead(207,{"Content-Type":"application/hap+json"}),n.end(JSON.stringify({characteristics:o}))):(n.writeHead(204),n.end())})))}else n.writeHead(400,{"Content-Type":"application/hap+json"}),n.end(JSON.stringify({status:-70410}))},t.prototype.handlePrepareWrite=function(e,t,r,i,n){var a=this;if(!this.allowInsecureRequest&&!e.isAuthenticated())return n.writeHead(470,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:-70401}));if("PUT"===r.method){if(0===i.length)return n.writeHead(400,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:-70410}));var o=JSON.parse(i.toString());if(o.pid&&o.ttl)return m("[%s] Received prepare write request with pid %d and ttl %d",this.accessoryInfo.username,o.pid,o.ttl),e.timedWriteTimeout&&clearTimeout(e.timedWriteTimeout),e.timedWritePid=o.pid,e.timedWriteTimeout=setTimeout((function(){m("[%s] Timed write request timed out for pid %d",a.accessoryInfo.username,o.pid),e.timedWritePid=void 0,e.timedWriteTimeout=void 0}),o.ttl),n.writeHead(200,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:0}));n.writeHead(400,{"Content-Type":"application/hap+json"}),n.end(JSON.stringify({status:-70410}))}else n.writeHead(400,{"Content-Type":"application/hap+json"}),n.end(JSON.stringify({status:-70410}))},t.prototype.handleResource=function(e,t,r,i,n){if(!(e.isAuthenticated()||this.allowInsecureRequest&&r.headers&&r.headers.authorization===this.accessoryInfo.pincode))return n.writeHead(470,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:-70401}));if("POST"===r.method){if(0===i.length)return n.writeHead(400,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:-70410}));var a=JSON.parse(i.toString());this.emit("request-resource",a,(0,v.once)((function(e,t){e?(n.writeHead(e.httpCode,{"Content-Type":"application/hap+json"}),n.end(JSON.stringify({status:e.status}))):(n.writeHead(200,{"Content-Type":"image/jpeg"}),n.end(t))})))}else n.writeHead(400,{"Content-Type":"application/hap+json"}),n.end(JSON.stringify({status:-70410}))},t}(c.EventEmitter);t.HAPServer=y},5876:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Service=t.ServiceEventTypes=void 0;var i=r(1635),n=i.__importDefault(r(2613)),a=i.__importDefault(r(5753)),o=r(4434),s=r(9826),c=r(2997),u=(0,a.default)("HAP-NodeJS:Service");!function(e){e.CHARACTERISTIC_CHANGE="characteristic-change",e.SERVICE_CONFIGURATION_CHANGE="service-configurationChange",e.CHARACTERISTIC_WARNING="characteristic-warning"}(t.ServiceEventTypes||(t.ServiceEventTypes={}));var l=function(e){function t(t,r,i){void 0===t&&(t="");var a=e.call(this)||this;(a.iid=null,a.name=null,a.characteristics=[],a.optionalCharacteristics=[],a.isHiddenService=!1,a.isPrimaryService=!1,a.linkedServices=[],(0,n.default)(r,"Services must be created with a valid UUID."),a.displayName=t,a.UUID=r,a.subtype=i,t)&&(a.getCharacteristic(s.Characteristic.Name)||a.addCharacteristic(s.Characteristic.Name)).updateValue(t);return a}return i.__extends(t,e),t.prototype.getServiceId=function(){return this.UUID+(this.subtype||"")},t.prototype.addCharacteristic=function(e){for(var t,r,n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var o="function"==typeof e?new(e.bind.apply(e,i.__spreadArray([void 0],i.__read(n),!1))):e;try{for(var s=i.__values(this.characteristics),c=s.next();!c.done;c=s.next()){var u=c.value;if(u.UUID===o.UUID){if("00000052-0000-1000-8000-0026BB765291"===o.UUID)return u;throw new Error("Cannot add a Characteristic with the same UUID as another Characteristic in this Service: "+u.UUID)}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}if(this.characteristics.length>=100)throw new Error("Cannot add more than 100 characteristics to a single service!");return this.setupCharacteristicEventHandlers(o),this.characteristics.push(o),this.emit("service-configurationChange"),o},t.prototype.setPrimaryService=function(e){void 0===e&&(e=!0),this.isPrimaryService=e,this.emit("service-configurationChange")},t.prototype.setHiddenService=function(e){void 0===e&&(e=!0),this.isHiddenService=e,this.emit("service-configurationChange")},t.prototype.addLinkedService=function(e){this.linkedServices.includes(e)||this.linkedServices.push(e),this.emit("service-configurationChange")},t.prototype.removeLinkedService=function(e){var t=this.linkedServices.indexOf(e);-1!==t&&this.linkedServices.splice(t,1),this.emit("service-configurationChange")},t.prototype.removeCharacteristic=function(e){var t=this.characteristics.indexOf(e);-1!==t&&(this.characteristics.splice(t,1),e.removeAllListeners(),this.emit("service-configurationChange"))},t.prototype.getCharacteristic=function(e){var t,r,n,a;try{for(var o=i.__values(this.characteristics),c=o.next();!c.done;c=o.next()){var u=c.value;if("string"==typeof e&&u.displayName===e)return u;if("function"==typeof e&&(u instanceof e||e.UUID===u.UUID))return u}}catch(e){t={error:e}}finally{try{c&&!c.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}if("function"==typeof e){try{for(var l=i.__values(this.optionalCharacteristics),h=l.next();!h.done;h=l.next()){if((u=h.value)instanceof e||e.UUID===u.UUID)return this.addCharacteristic(e)}}catch(e){n={error:e}}finally{try{h&&!h.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}var d=this.addCharacteristic(e);return e.UUID!==s.Characteristic.Name.UUID&&this.emitCharacteristicWarningEvent(d,"warn-message","Characteristic not in required or optional characteristic section for service "+this.constructor.name+". Adding anyway."),d}},t.prototype.testCharacteristic=function(e){var t,r;try{for(var n=i.__values(this.characteristics),a=n.next();!a.done;a=n.next()){var o=a.value;if("string"==typeof e&&o.displayName===e)return!0;if("function"==typeof e&&(o instanceof e||e.UUID===o.UUID))return!0}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return!1},t.prototype.setCharacteristic=function(e,t){return this.getCharacteristic(e).setValue(t),this},t.prototype.updateCharacteristic=function(e,t){return this.getCharacteristic(e).updateValue(t),this},t.prototype.addOptionalCharacteristic=function(e){"function"==typeof e&&(e=new e),this.optionalCharacteristics.push(e)},t.prototype.replaceCharacteristicsFromService=function(e){var t=this;if(this.UUID!==e.UUID)throw new Error("Incompatible services. Tried replacing characteristics of ".concat(this.UUID," with characteristics from ").concat(e.UUID));var r={};e.characteristics.forEach((function(e){return r[e.UUID]=e})),this.characteristics.forEach((function(e){var t=r[e.UUID];if(t){if(delete r[e.UUID],!t.value&&0!==t.value&&!1!==t.value)return;e.replaceBy(t)}})),Object.values(r).forEach((function(e){return t.addCharacteristic(e)}))},t.prototype.getCharacteristicByIID=function(e){var t,r;try{for(var n=i.__values(this.characteristics),a=n.next();!a.done;a=n.next()){var o=a.value;if(o.iid===e)return o}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},t.prototype._assignIDs=function(e,t,r){var n,a;void 0===r&&(r=0),"0000003E-0000-1000-8000-0026BB765291"===this.UUID?this.iid=1:this.iid=r+e.getIID(t,this.UUID,this.subtype);try{for(var o=i.__values(this.characteristics),s=o.next();!s.done;s=o.next()){s.value._assignID(e,t,this.UUID,this.subtype)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}},t.prototype.toHAP=function(e,t){var r=this;return void 0===t&&(t=!0),new Promise((function(a){var o,s,l,h;(0,n.default)(r.iid,"iid cannot be undefined for service '"+r.displayName+"'"),(0,n.default)(r.characteristics.length,"service '"+r.displayName+"' does not have any characteristics!");var d={type:(0,c.toShortForm)(r.UUID),iid:r.iid,characteristics:[],hidden:!!r.isHiddenService||void 0,primary:!!r.isPrimaryService||void 0};if(r.linkedServices.length){d.linked=[];try{for(var p=i.__values(r.linkedServices),f=p.next();!f.done;f=p.next()){var v=f.value;v.iid?d.linked.push(v.iid):u("iid of linked service '".concat(v.displayName,"' ").concat(v.UUID," is undefined on service '").concat(r.displayName,"'"))}}catch(e){o={error:e}}finally{try{f&&!f.done&&(s=p.return)&&s.call(p)}finally{if(o)throw o.error}}}var g=new Set,m=setTimeout((function(){var e,t;try{for(var n=i.__values(g),o=n.next();!o.done;o=n.next()){var s=o.value;r.emitCharacteristicWarningEvent(s,"slow-read","The read handler for the characteristic '".concat(s.displayName,"' was slow to respond!"))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}m=setTimeout((function(){var e,t;m=void 0;try{for(var n=i.__values(g),o=n.next();!o.done;o=n.next()){var s=o.value;r.emitCharacteristicWarningEvent(s,"timeout-read","The read handler for the characteristic '"+(null==s?void 0:s.displayName)+"' didn't respond at all!. Please check that you properly call the callback!"),d.characteristics.push(s.internalHAPRepresentation())}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}g.clear(),a(d)}),6e3)}),3e3),y=function(r){g.add(r),r.toHAP(e,t).then((function(e){m&&(g.delete(r),d.characteristics.push(e),0===g.size&&(m&&(clearTimeout(m),m=void 0),a(d)))}))};try{for(var C=i.__values(r.characteristics),S=C.next();!S.done;S=C.next()){y(S.value)}}catch(e){l={error:e}}finally{try{S&&!S.done&&(h=C.return)&&h.call(C)}finally{if(l)throw l.error}}}))},t.prototype.internalHAPRepresentation=function(){var e,t;(0,n.default)(this.iid,"iid cannot be undefined for service '"+this.displayName+"'"),(0,n.default)(this.characteristics.length,"service '"+this.displayName+"' does not have any characteristics!");var r={type:(0,c.toShortForm)(this.UUID),iid:this.iid,characteristics:this.characteristics.map((function(e){return e.internalHAPRepresentation()})),hidden:!!this.isHiddenService||void 0,primary:!!this.isPrimaryService||void 0};if(this.linkedServices.length){r.linked=[];try{for(var a=i.__values(this.linkedServices),o=a.next();!o.done;o=a.next()){var s=o.value;s.iid?r.linked.push(s.iid):u("iid of linked service '".concat(s.displayName,"' ").concat(s.UUID," is undefined on service '").concat(this.displayName,"'"))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}}return r},t.prototype.setupCharacteristicEventHandlers=function(e){var t=this;e.on("change",(function(r){t.emit("characteristic-change",i.__assign(i.__assign({},r),{characteristic:e}))})),e.on("characteristic-warning",this.emitCharacteristicWarningEvent.bind(this,e))},t.prototype.emitCharacteristicWarningEvent=function(e,t,r,i){this.emit("characteristic-warning",{characteristic:e,type:t,message:r,originatorChain:[this.displayName,e.displayName],stack:i})},t.prototype._sideloadCharacteristics=function(e){var t,r;try{for(var n=i.__values(e),a=n.next();!a.done;a=n.next()){var o=a.value;this.setupCharacteristicEventHandlers(o)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}this.characteristics=e.slice()},t.serialize=function(e){var t;return"Service"!==e.constructor.name&&(t=e.constructor.name),{displayName:e.displayName,UUID:e.UUID,subtype:e.subtype,constructorName:t,hiddenService:e.isHiddenService,primaryService:e.isPrimaryService,characteristics:e.characteristics.map((function(e){return s.Characteristic.serialize(e)})),optionalCharacteristics:e.optionalCharacteristics.map((function(e){return s.Characteristic.serialize(e)}))}},t.deserialize=function(e){var r;e.constructorName&&e.constructorName.charAt(0).toUpperCase()===e.constructorName.charAt(0)&&t[e.constructorName]?r=new(0,t[e.constructorName])(e.displayName,e.subtype):r=new t(e.displayName,e.UUID,e.subtype);r.isHiddenService=!!e.hiddenService,r.isPrimaryService=!!e.primaryService;var i=e.characteristics.map((function(e){return s.Characteristic.deserialize(e)}));return r._sideloadCharacteristics(i),e.optionalCharacteristics&&(r.optionalCharacteristics=e.optionalCharacteristics.map((function(e){return s.Characteristic.deserialize(e)}))),r},t}(o.EventEmitter);t.Service=l,r(1647)},9672:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyCameraSourceAdapter=void 0;var r=function(){function e(e){this.cameraSource=e}return e.prototype.handleSnapshotRequest=function(e,t){this.cameraSource.handleSnapshotRequest(e,(function(e,r){t(e||void 0,r)}))},e.prototype.prepareStream=function(e,t){this.cameraSource.prepareStream(e,(function(e){t(void 0,e)}))},e.prototype.handleStreamRequest=function(e,t){this.cameraSource.handleStreamRequest(e),t()},e.prototype.forwardCloseConnection=function(e){this.cameraSource.handleCloseConnection(e)},e}();t.LegacyCameraSourceAdapter=r},5989:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(1635).__importDefault(r(7194)),n=function(){function e(e){this.options=e,this.startingPort=1e4,this.type=e.isIPV6?"udp6":"udp4",this.startingPort=1e4,this.outgoingAddress=e.outgoingAddress,this.outgoingPort=e.outgoingPort,this.incomingPayloadType=0,this.outgoingSSRC=e.outgoingSSRC,this.disabled=e.disabled,this.incomingSSRC=null,this.outgoingPayloadType=null}return e.prototype.setup=function(){var e=this;return this.createSocketPair(this.type).then((function(t){return e.incomingRTPSocket=t[0],e.incomingRTCPSocket=t[1],e.createSocket(e.type)})).then((function(t){e.outgoingSocket=t,e.onBound()}))},e.prototype.destroy=function(){this.incomingRTPSocket&&this.incomingRTPSocket.close(),this.incomingRTCPSocket&&this.incomingRTCPSocket.close(),this.outgoingSocket&&this.outgoingSocket.close()},e.prototype.incomingRTPPort=function(){var e=this.incomingRTPSocket.address();if("string"!=typeof e)return e.port;throw new Error("Unsupported socket!")},e.prototype.incomingRTCPPort=function(){var e=this.incomingRTCPSocket.address();if("string"!=typeof e)return e.port;throw new Error("Unsupported socket!")},e.prototype.outgoingLocalPort=function(){var e=this.outgoingSocket.address();if("string"!=typeof e)return e.port;throw new Error("Unsupported socket!")},e.prototype.setServerAddress=function(e){this.serverAddress=e},e.prototype.setServerRTPPort=function(e){this.serverRTPPort=e},e.prototype.setServerRTCPPort=function(e){this.serverRTCPPort=e},e.prototype.setIncomingPayloadType=function(e){this.incomingPayloadType=e},e.prototype.setOutgoingPayloadType=function(e){this.outgoingPayloadType=e},e.prototype.sendOut=function(e){this.outgoingAddress&&this.outgoingPort&&this.outgoingSocket.send(e,this.outgoingPort,this.outgoingAddress)},e.prototype.sendBack=function(e){this.serverAddress&&this.serverRTCPPort&&this.outgoingSocket.send(e,this.serverRTCPPort,this.serverAddress)},e.prototype.onBound=function(){var e=this;this.disabled||(this.incomingRTPSocket.on("message",(function(t){e.rtpMessage(t)})),this.incomingRTCPSocket.on("message",(function(t){e.rtcpMessage(t)})),this.outgoingSocket.on("message",(function(t){e.rtcpReply(t)})))},e.prototype.rtpMessage=function(e){if(e.length<12)this.sendOut(e);else{var t=e.readUInt8(1);(127&t)===this.incomingPayloadType&&(t=128&t|this.outgoingPayloadType,e.writeUInt8(t,1)),null===this.incomingSSRC&&(this.incomingSSRC=e.readUInt32BE(4)),e.writeUInt32BE(this.outgoingSSRC,8),this.sendOut(e)}},e.prototype.processRTCPMessage=function(e,t){for(var r=[],i=0;i+4<=e.length;){var n=e.readUInt8(i+1),a=4*e.readUInt16BE(i+2);if(i+4+a>e.length)break;var o=e.slice(i,i+4+a);(o=t(n,o))&&r.push(o),i+=4+a}return r.length>0?Buffer.concat(r):null},e.prototype.rtcpMessage=function(e){var t=this,r=this.processRTCPMessage(e,(function(e,r){return 200!==e||r.length<8||(null===t.incomingSSRC&&(t.incomingSSRC=r.readUInt32BE(4)),r.writeUInt32BE(t.outgoingSSRC,4)),r}));r&&this.sendOut(r)},e.prototype.rtcpReply=function(e){var t=this,r=this.processRTCPMessage(e,(function(e,r){return 201!==e||r.length<12||r.writeUInt32BE(t.incomingSSRC,8),r}));r&&this.sendOut(r)},e.prototype.createSocket=function(e){var t=this;return new Promise((function(r){var n=function(){var a=i.default.createSocket(e);a.once("error",(function(){65535===t.startingPort?t.startingPort=1e4:++t.startingPort,a.close(),n()})),a.on("listening",(function(){r(a)})),a.bind(t.startingPort)};n()}))},e.prototype.createSocketPair=function(e){var t=this;return new Promise((function(r){var n=function(){var a=i.default.createSocket(e),o=i.default.createSocket(e),s={socket1:0,socket2:0},c=function(){0!==s.socket1&&0!==s.socket2&&(2!==s.socket1||2!==s.socket2?(65534===t.startingPort?t.startingPort=1e4:++t.startingPort,a.close(),o.close(),n()):r([a,o]))};a.once("error",(function(){s.socket1=1,c()})),o.once("error",(function(){s.socket2=1,c()})),a.once("listening",(function(){s.socket1=2,c()})),o.once("listening",(function(){s.socket2=2,c()})),a.bind(t.startingPort),o.bind(t.startingPort+1)};n()}))},e}();t.default=n},8598:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamController=t.RTPStreamManagement=t.StreamRequestTypes=t.AudioStreamingSamplerate=t.AudioStreamingCodecType=t.SRTPCryptoSuites=t.AudioSamplerate=t.AudioBitrate=t.VideoCodecPacketizationMode=t.H264Level=t.H264Profile=t.VideoCodecType=void 0;var i,n,a,o,s,c,u,l,h,d,p,f,v,g,m,y,C,S,E,_,T,A,I,D,w,b,U,R=r(1635),O=R.__importDefault(r(2613)),N=R.__importDefault(r(6982)),P=R.__importDefault(r(5753)),B=R.__importDefault(r(9278)),L=r(9826),x=r(1068),M=r(5876),F=r(8073),k=r(7739),V=R.__importStar(r(3314)),H=R.__importStar(r(2997)),j=r(9672),G=R.__importDefault(r(5989)),W=(0,P.default)("HAP-NodeJS:Camera:RTPStreamManagement");!function(e){e[e.STATUS=1]="STATUS"}(i||(i={})),function(e){e[e.AVAILABLE=0]="AVAILABLE",e[e.IN_USE=1]="IN_USE",e[e.UNAVAILABLE=2]="UNAVAILABLE"}(n||(n={})),function(e){e[e.VIDEO_CODEC_CONFIGURATION=1]="VIDEO_CODEC_CONFIGURATION"}(a||(a={})),function(e){e[e.CODEC_TYPE=1]="CODEC_TYPE",e[e.CODEC_PARAMETERS=2]="CODEC_PARAMETERS",e[e.ATTRIBUTES=3]="ATTRIBUTES"}(o||(o={})),function(e){e[e.PROFILE_ID=1]="PROFILE_ID",e[e.LEVEL=2]="LEVEL",e[e.PACKETIZATION_MODE=3]="PACKETIZATION_MODE",e[e.CVO_ENABLED=4]="CVO_ENABLED",e[e.CVO_ID=5]="CVO_ID"}(s||(s={})),function(e){e[e.IMAGE_WIDTH=1]="IMAGE_WIDTH",e[e.IMAGE_HEIGHT=2]="IMAGE_HEIGHT",e[e.FRAME_RATE=3]="FRAME_RATE"}(c||(c={})),function(e){e[e.H264=0]="H264"}(t.VideoCodecType||(t.VideoCodecType={})),function(e){e[e.BASELINE=0]="BASELINE",e[e.MAIN=1]="MAIN",e[e.HIGH=2]="HIGH"}(u=t.H264Profile||(t.H264Profile={})),function(e){e[e.LEVEL3_1=0]="LEVEL3_1",e[e.LEVEL3_2=1]="LEVEL3_2",e[e.LEVEL4_0=2]="LEVEL4_0"}(t.H264Level||(t.H264Level={})),function(e){e[e.NON_INTERLEAVED=0]="NON_INTERLEAVED"}(t.VideoCodecPacketizationMode||(t.VideoCodecPacketizationMode={})),function(e){e[e.UNSUPPORTED=0]="UNSUPPORTED",e[e.SUPPORTED=1]="SUPPORTED"}(l||(l={})),function(e){e[e.AUDIO_CODEC_CONFIGURATION=1]="AUDIO_CODEC_CONFIGURATION",e[e.COMFORT_NOISE_SUPPORT=2]="COMFORT_NOISE_SUPPORT"}(h||(h={})),function(e){e[e.CODEC_TYPE=1]="CODEC_TYPE",e[e.CODEC_PARAMETERS=2]="CODEC_PARAMETERS"}(d||(d={})),function(e){e[e.PCMU=0]="PCMU",e[e.PCMA=1]="PCMA",e[e.AAC_ELD=2]="AAC_ELD",e[e.OPUS=3]="OPUS",e[e.MSBC=4]="MSBC",e[e.AMR=5]="AMR",e[e.AMR_WB=6]="AMR_WB"}(p||(p={})),function(e){e[e.CHANNEL=1]="CHANNEL",e[e.BIT_RATE=2]="BIT_RATE",e[e.SAMPLE_RATE=3]="SAMPLE_RATE",e[e.PACKET_TIME=4]="PACKET_TIME"}(f||(f={})),function(e){e[e.VARIABLE=0]="VARIABLE",e[e.CONSTANT=1]="CONSTANT"}(t.AudioBitrate||(t.AudioBitrate={})),function(e){e[e.KHZ_8=0]="KHZ_8",e[e.KHZ_16=1]="KHZ_16",e[e.KHZ_24=2]="KHZ_24"}(t.AudioSamplerate||(t.AudioSamplerate={})),function(e){e[e.SRTP_CRYPTO_SUITE=2]="SRTP_CRYPTO_SUITE"}(v||(v={})),function(e){e[e.AES_CM_128_HMAC_SHA1_80=0]="AES_CM_128_HMAC_SHA1_80",e[e.AES_CM_256_HMAC_SHA1_80=1]="AES_CM_256_HMAC_SHA1_80",e[e.NONE=2]="NONE"}(g=t.SRTPCryptoSuites||(t.SRTPCryptoSuites={})),function(e){e[e.SESSION_ID=1]="SESSION_ID",e[e.CONTROLLER_ADDRESS=3]="CONTROLLER_ADDRESS",e[e.VIDEO_SRTP_PARAMETERS=4]="VIDEO_SRTP_PARAMETERS",e[e.AUDIO_SRTP_PARAMETERS=5]="AUDIO_SRTP_PARAMETERS"}(m||(m={})),function(e){e[e.ADDRESS_VERSION=1]="ADDRESS_VERSION",e[e.ADDRESS=2]="ADDRESS",e[e.VIDEO_RTP_PORT=3]="VIDEO_RTP_PORT",e[e.AUDIO_RTP_PORT=4]="AUDIO_RTP_PORT"}(y||(y={})),function(e){e[e.IPV4=0]="IPV4",e[e.IPV6=1]="IPV6"}(C||(C={})),function(e){e[e.SRTP_CRYPTO_SUITE=1]="SRTP_CRYPTO_SUITE",e[e.MASTER_KEY=2]="MASTER_KEY",e[e.MASTER_SALT=3]="MASTER_SALT"}(S||(S={})),function(e){e[e.SESSION_ID=1]="SESSION_ID",e[e.STATUS=2]="STATUS",e[e.ACCESSORY_ADDRESS=3]="ACCESSORY_ADDRESS",e[e.VIDEO_SRTP_PARAMETERS=4]="VIDEO_SRTP_PARAMETERS",e[e.AUDIO_SRTP_PARAMETERS=5]="AUDIO_SRTP_PARAMETERS",e[e.VIDEO_SSRC=6]="VIDEO_SSRC",e[e.AUDIO_SSRC=7]="AUDIO_SSRC"}(E||(E={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.BUSY=1]="BUSY",e[e.ERROR=2]="ERROR"}(_||(_={})),function(e){e[e.SESSION_CONTROL=1]="SESSION_CONTROL",e[e.SELECTED_VIDEO_PARAMETERS=2]="SELECTED_VIDEO_PARAMETERS",e[e.SELECTED_AUDIO_PARAMETERS=3]="SELECTED_AUDIO_PARAMETERS"}(T||(T={})),function(e){e[e.SESSION_IDENTIFIER=1]="SESSION_IDENTIFIER",e[e.COMMAND=2]="COMMAND"}(A||(A={})),function(e){e[e.END_SESSION=0]="END_SESSION",e[e.START_SESSION=1]="START_SESSION",e[e.SUSPEND_SESSION=2]="SUSPEND_SESSION",e[e.RESUME_SESSION=3]="RESUME_SESSION",e[e.RECONFIGURE_SESSION=4]="RECONFIGURE_SESSION"}(I||(I={})),function(e){e[e.CODEC_TYPE=1]="CODEC_TYPE",e[e.CODEC_PARAMETERS=2]="CODEC_PARAMETERS",e[e.ATTRIBUTES=3]="ATTRIBUTES",e[e.RTP_PARAMETERS=4]="RTP_PARAMETERS"}(D||(D={})),function(e){e[e.PAYLOAD_TYPE=1]="PAYLOAD_TYPE",e[e.SYNCHRONIZATION_SOURCE=2]="SYNCHRONIZATION_SOURCE",e[e.MAX_BIT_RATE=3]="MAX_BIT_RATE",e[e.MIN_RTCP_INTERVAL=4]="MIN_RTCP_INTERVAL",e[e.MAX_MTU=5]="MAX_MTU"}(w||(w={})),function(e){e[e.CODEC_TYPE=1]="CODEC_TYPE",e[e.CODEC_PARAMETERS=2]="CODEC_PARAMETERS",e[e.RTP_PARAMETERS=3]="RTP_PARAMETERS",e[e.COMFORT_NOISE=4]="COMFORT_NOISE"}(b||(b={})),function(e){e[e.PAYLOAD_TYPE=1]="PAYLOAD_TYPE",e[e.SYNCHRONIZATION_SOURCE=2]="SYNCHRONIZATION_SOURCE",e[e.MAX_BIT_RATE=3]="MAX_BIT_RATE",e[e.MIN_RTCP_INTERVAL=4]="MIN_RTCP_INTERVAL",e[e.COMFORT_NOISE_PAYLOAD_TYPE=6]="COMFORT_NOISE_PAYLOAD_TYPE"}(U||(U={})),function(e){e.PCMU="PCMU",e.PCMA="PCMA",e.AAC_ELD="AAC-eld",e.OPUS="OPUS",e.MSBC="mSBC",e.AMR="AMR",e.AMR_WB="AMR-WB"}(t.AudioStreamingCodecType||(t.AudioStreamingCodecType={})),function(e){e[e.KHZ_8=8]="KHZ_8",e[e.KHZ_16=16]="KHZ_16",e[e.KHZ_24=24]="KHZ_24"}(t.AudioStreamingSamplerate||(t.AudioStreamingSamplerate={})),function(e){e.RECONFIGURE="reconfigure",e.START="start",e.STOP="stop"}(t.StreamRequestTypes||(t.StreamRequestTypes={}));var Y=function(){function e(t,r,i,n,a){if(this.videoOnly=!1,this.sessionIdentifier=void 0,this.streamStatus=0,this.selectedConfiguration="",this.setupEndpointsResponse="",this.id=t,this.delegate=i,this.requireProxy=r.proxy||!1,this.disableAudioProxy=r.disable_audio_proxy||!1,!function(e){return"srtp"in e}(r)?this.supportedCryptoSuites=r.supportedCryptoSuites:this.supportedCryptoSuites=[r.srtp?0:2],0===this.supportedCryptoSuites.length&&this.supportedCryptoSuites.push(2),!r.video)throw new Error("Video parameters cannot be undefined in options");this.supportedRTPConfiguration=e._supportedRTPConfiguration(this.supportedCryptoSuites),this.supportedVideoStreamConfiguration=e._supportedVideoStreamConfiguration(r.video),this.supportedAudioStreamConfiguration=this._supportedAudioStreamConfiguration(r.audio),this.activeConnectionClosedListener=this._handleStopStream.bind(this),this.service=n||this.constructService(t),this.setupServiceHandlers(),this.resetSetupEndpointsResponse(),this.resetSelectedStreamConfiguration(),this.disabledThroughOperatingMode=a}return e.prototype.forceStop=function(){this.handleSessionClosed()},e.prototype.getService=function(){return this.service},e.prototype.handleCloseConnection=function(e){},e.prototype.handleFactoryReset=function(){this.resetSelectedStreamConfiguration(),this.resetSetupEndpointsResponse(),this.service.updateCharacteristic(L.Characteristic.Active,!0)},e.prototype.destroy=function(){this.activeConnection&&this._handleStopStream()},e.prototype.constructService=function(e){var t=new M.Service.CameraRTPStreamManagement("",e.toString());return t.setCharacteristic(L.Characteristic.Active,!0),t},e.prototype.setupServiceHandlers=function(){var e=this;this.service.testCharacteristic(L.Characteristic.Active)||this.service.setCharacteristic(L.Characteristic.Active,!0),this.service.getCharacteristic(L.Characteristic.Active).on("change",(function(){var t;return null===(t=e.stateChangeDelegate)||void 0===t?void 0:t.call(e)})).setProps({adminOnlyAccess:[1]}),this.service.setCharacteristic(L.Characteristic.SupportedRTPConfiguration,this.supportedRTPConfiguration),this.service.setCharacteristic(L.Characteristic.SupportedVideoStreamConfiguration,this.supportedVideoStreamConfiguration),this.service.setCharacteristic(L.Characteristic.SupportedAudioStreamConfiguration,this.supportedAudioStreamConfiguration),this._updateStreamStatus(0),this.service.setCharacteristic(L.Characteristic.SetupEndpoints,this.setupEndpointsResponse),this.service.getCharacteristic(L.Characteristic.SelectedRTPStreamConfiguration).on("get",(function(t){e.streamingIsDisabled()?t(null,V.encode(1,V.encode(2,I.SUSPEND_SESSION)).toString("base64")):t(null,e.selectedConfiguration)})).on("set",this._handleSelectedStreamConfigurationWrite.bind(this)),this.service.getCharacteristic(L.Characteristic.SetupEndpoints).on("get",(function(t){e.streamingIsDisabled()?t(null,V.encode(2,2).toString("base64")):t(null,e.setupEndpointsResponse)})).on("set",(function(t,r,i,n){if(!n)return W("Set event handler for SetupEndpoints cannot be called from plugin. Connection undefined!"),void r(-70410);e.handleSetupEndpoints(t,r,n)}))},e.prototype.handleSessionClosed=function(){this.resetSelectedStreamConfiguration(),this.resetSetupEndpointsResponse(),this.activeConnection&&(this.activeConnection.removeListener("closed",this.activeConnectionClosedListener),this.activeConnection=void 0),this._updateStreamStatus(0),this.sessionIdentifier=void 0,this.connectionID=void 0,this.ipVersion=void 0,this.videoProxy&&(this.videoProxy.destroy(),this.videoProxy=void 0),this.audioProxy&&(this.audioProxy.destroy(),this.audioProxy=void 0)},e.prototype.streamingIsDisabled=function(e){var t;return this.service.getCharacteristic(L.Characteristic.Active).value?!!(null===(t=this.disabledThroughOperatingMode)||void 0===t?void 0:t.call(this))&&(e&&e(new F.HapStatusError(-70412)),!0):(e&&e(new F.HapStatusError(-70412)),!0)},e.prototype._handleSelectedStreamConfigurationWrite=function(e,t){var r=this;if(!this.streamingIsDisabled(t)){var i=Buffer.from(e,"base64"),n=V.decode(i),a=V.decode(n[1]),o=H.unparse(a[1]),s=a[2][0];if(o!==this.sessionIdentifier)return W("Received unknown session Identifier with request to ".concat(I[s])),void t(-70410);this.selectedConfiguration=e;var c=function(e,i){t(e,i),e&&r.handleSessionClosed()};switch(s){case I.START_SESSION:var u=V.decode(n[2]),l=V.decode(n[3]);this._handleStartStream(u,l,c);break;case I.RECONFIGURE_SESSION:var h=V.decode(n[2]);this.handleReconfigureStream(h,c);break;case I.END_SESSION:this._handleStopStream(c);break;case I.RESUME_SESSION:case I.SUSPEND_SESSION:default:return W("Unhandled request type ".concat(I[s])),void t(-70410)}}},e.prototype._handleStartStream=function(e,t,r){var i=e[1],n=e[2],a=e[3],o=e[4],s=V.decode(n),c=s[1][0],u=s[2][0],l=s[3][0],h=s[4],d=void 0;h&&1===h[0]&&(d=s[5].readUInt8(0));var p=V.decode(a),f=p[1].readUInt16LE(0),v=p[2].readUInt16LE(0),g=p[3].readUInt8(0),m=V.decode(o),y=m[1].readUInt8(0),C=m[2].readUInt32LE(0),S=m[3].readUInt16LE(0),E=m[4].readFloatLE(0),_="ipv6"===this.ipVersion?1228:1378;m[5]&&(_=m[5].readUInt16LE(0));var T=t[1][0],A=t[2],I=t[3],D=!!t[4].readUInt8(0),w=V.decode(A),b=w[1][0],U=w[2][0],R=w[3][0],O=w[4].readUInt8(0),N=V.decode(I),P=N[1].readUInt8(0),B=N[2].readUInt32LE(0),L=N[3].readUInt16LE(0),x=N[4].readFloatLE(0),M=N[6].readUInt8(0);this.requireProxy&&(this.videoProxy.setOutgoingPayloadType(y),this.disableAudioProxy||this.audioProxy.setOutgoingPayloadType(P));var F,k,H={codec:i.readUInt8(0),profile:c,level:u,packetizationMode:l,cvoId:d,width:f,height:v,fps:g,pt:y,ssrc:C,max_bit_rate:S,rtcp_interval:E,mtu:_};switch(T){case 0:F="PCMU";break;case 1:F="PCMA";break;case 2:F="AAC-eld";break;case 3:F="OPUS";break;case 4:F="mSBC";break;case 5:F="AMR";break;case 6:F="AMR-WB";break;default:throw new Error("Encountered unknown selected audio codec ".concat(T))}switch(R){case 0:k=8;break;case 1:k=16;break;case 2:k=24;break;default:throw new Error("Encountered unknown selected audio samplerate ".concat(R))}var j={codec:F,channel:b,bit_rate:U,sample_rate:k,packet_time:O,pt:P,ssrc:B,max_bit_rate:L,rtcp_interval:x,comfort_pt:M,comfortNoiseEnabled:D},G={sessionID:this.sessionIdentifier,type:"start",video:H,audio:j};this.delegate.handleStreamRequest(G,(function(e){return r(e)}))},e.prototype.handleReconfigureStream=function(e,t){var r=e[3],i=e[4],n=V.decode(r),a=n[1].readUInt16LE(0),o=n[2].readUInt16LE(0),s=n[3].readUInt8(0),c=V.decode(i),u={width:a,height:o,fps:s,max_bit_rate:c[3].readUInt16LE(0),rtcp_interval:c[4].readFloatLE(0)||.5},l={sessionID:this.sessionIdentifier,type:"reconfigure",video:u};this.delegate.handleStreamRequest(l,(function(e){return t(e)}))},e.prototype._handleStopStream=function(e){var t={sessionID:this.sessionIdentifier,type:"stop"};this.handleSessionClosed(),this.delegate.handleStreamRequest(t,(function(t){return e?e(t):void 0}))},e.prototype.handleSetupEndpoints=function(e,t,r){var i=this;if(!this.streamingIsDisabled(t)){var n=Buffer.from(e,"base64"),a=V.decode(n),o=H.unparse(a[1]);if(0!==this.streamStatus)return this.setupEndpointsResponse=V.encode(1,H.write(o),2,1).toString("base64"),void t();(0,O.default)(null==this.activeConnection,"Found non-nil `activeConnection` when trying to setup streaming endpoints, even though streamStatus is reported to be AVAILABLE!"),this.activeConnection=r,this.activeConnection.on("closed",this.activeConnectionClosedListener),this.connectionID=r.sessionID,this.sessionIdentifier=o,this._updateStreamStatus(1);var s=a[3],c=V.decode(s),u=c[1][0],l=c[2].toString("utf8"),h=c[3].readUInt16LE(0),d=c[4].readUInt16LE(0),p=a[4],f=V.decode(p),v=f[1][0],g=f[2],m=f[3],y=a[5],C=V.decode(y),S=C[1][0],E=C[2],_=C[3];W("Session: ",o,"\nControllerAddress: ",l,"\nVideoPort: ",h,"\nAudioPort: ",d,"\nVideo Crypto: ",v,"\nVideo Master Key: ",g,"\nVideo Master Salt: ",m,"\nAudio Crypto: ",S,"\nAudio Master Key: ",E,"\nAudio Master Salt: ",_);var T={sessionID:o,sourceAddress:r.localAddress,targetAddress:l,addressVersion:1===u?"ipv6":"ipv4",video:{port:h,srtpCryptoSuite:v,srtp_key:g,srtp_salt:m},audio:{port:d,srtpCryptoSuite:S,srtp_key:E,srtp_salt:_}},A=[];this.requireProxy&&(T.targetAddress=r.getLocalAddress(1===u?"ipv6":"ipv4"),this.videoProxy=new G.default({outgoingAddress:l,outgoingPort:h,outgoingSSRC:N.default.randomBytes(4).readUInt32LE(0),disabled:!1}),A.push(this.videoProxy.setup().then((function(){T.video.proxy_rtp=i.videoProxy.incomingRTPPort(),T.video.proxy_rtcp=i.videoProxy.incomingRTCPPort()}))),this.disableAudioProxy||(this.audioProxy=new G.default({outgoingAddress:l,outgoingPort:d,outgoingSSRC:N.default.randomBytes(4).readUInt32LE(0),disabled:this.videoOnly}),A.push(this.audioProxy.setup().then((function(){T.audio.proxy_rtp=i.audioProxy.incomingRTPPort(),T.audio.proxy_rtcp=i.audioProxy.incomingRTCPPort()}))))),Promise.all(A).then((function(){i.delegate.prepareStream(T,(0,k.once)((function(e,n){e||!n?(W("PrepareStream request encountered an error: ".concat(e?e.message:void 0)),i.setupEndpointsResponse=V.encode(1,H.write(o),2,2).toString("base64"),i.handleSessionClosed(),t(e)):i.generateSetupEndpointResponse(r,o,T,n,t)})))}))}},e.prototype.generateSetupEndpointResponse=function(e,t,r,i,n){var a,o,s,c,u,l,h,d,p,f,v,g=r.addressVersion;if(!this.videoOnly&&!i.audio)throw new Error("Audio was enabled but not supplied in PrepareStreamResponse!");var m=i.audio||{port:r.audio.port,ssrc:x.CameraController.generateSynchronisationSource(),srtp_key:r.audio.srtp_key,srtp_salt:r.audio.srtp_salt};if(this.requireProxy){C=i.video;if(a=e.getLocalAddress(r.addressVersion),c=2,u=Buffer.alloc(0),l=Buffer.alloc(0),h=2,d=Buffer.alloc(0),p=Buffer.alloc(0),this.videoProxy.setIncomingPayloadType(C.proxy_pt),this.videoProxy.setServerAddress(C.proxy_server_address),this.videoProxy.setServerRTPPort(C.proxy_server_rtp),this.videoProxy.setServerRTCPPort(C.proxy_server_rtcp),o=this.videoProxy.outgoingLocalPort(),f=this.videoProxy.outgoingSSRC,this.disableAudioProxy){s=(y=i.audio).port,v=y.ssrc}else{var y=i.audio;this.audioProxy.setIncomingPayloadType(y.proxy_pt),this.audioProxy.setServerAddress(y.proxy_server_address),this.audioProxy.setServerRTPPort(y.proxy_server_rtp),this.audioProxy.setServerRTCPPort(y.proxy_server_rtcp),s=this.audioProxy.outgoingLocalPort(),v=this.audioProxy.outgoingSSRC}}else{var C=i.video,y=m;if(i.addressOverride?(g=B.default.isIPv4(i.addressOverride)?"ipv4":"ipv6",a=i.addressOverride):a=e.getLocalAddress(g),r.addressVersion!==g)throw new Error("Incoming and outgoing ip address versions must match! Expected ".concat(r.addressVersion," but got ").concat(g));if(o=C.port,s=y.port,2!==r.video.srtpCryptoSuite&&(void 0===C.srtp_key||void 0===C.srtp_salt))throw new Error("SRTP was selected for the prepared video stream, but no 'srtp_key' or 'srtp_salt' was specified!");if(2!==r.audio.srtpCryptoSuite&&(void 0===y.srtp_key||void 0===y.srtp_salt))throw new Error("SRTP was selected for the prepared audio stream, but no 'srtp_key' or 'srtp_salt' was specified!");c=r.video.srtpCryptoSuite,u=C.srtp_key||Buffer.alloc(0),l=C.srtp_salt||Buffer.alloc(0),h=r.audio.srtpCryptoSuite,d=y.srtp_key||Buffer.alloc(0),p=y.srtp_salt||Buffer.alloc(0),f=C.ssrc,v=y.ssrc}this.ipVersion=g;var S=V.encode(1,"ipv4"===g?0:1,2,a,3,V.writeUInt16(o),4,V.writeUInt16(s)),E=V.encode(1,c,2,u,3,l),_=V.encode(1,h,2,d,3,p);this.setupEndpointsResponse=V.encode(1,H.write(t),2,0,3,S,4,E,5,_,6,V.writeUInt32(f),7,V.writeUInt32(v)).toString("base64"),n()},e.prototype._updateStreamStatus=function(e){this.streamStatus=e,this.service.updateCharacteristic(L.Characteristic.StreamingStatus,V.encode(1,this.streamStatus).toString("base64"))},e._supportedRTPConfiguration=function(e){return 1===e.length&&2===e[0]&&W("Client claims it doesn't support SRTP. The stream may stops working with future iOS releases."),V.encode(2,e).toString("base64")},e._supportedVideoStreamConfiguration=function(e){if(!e.codec)throw new Error("Video codec cannot be undefined");if(!e.resolutions)throw new Error("Video resolutions cannot be undefined");var t=V.encode(1,e.codec.profiles,2,e.codec.levels,3,0);null!=e.cvoId&&(t=Buffer.concat([t,V.encode(4,1,5,e.cvoId)]));var r=V.encode(1,0,2,t,3,e.resolutions.map((function(e){if(3!==e.length)throw new Error("Unexpected video resolution");var t=Buffer.alloc(2),r=Buffer.alloc(2),i=Buffer.alloc(1);return t.writeUInt16LE(e[0],0),r.writeUInt16LE(e[1],0),i.writeUInt8(e[2],0),V.encode(1,t,2,r,3,i)})));return V.encode(1,r).toString("base64")},e.prototype.checkForLegacyAudioCodecRepresentation=function(e){var t={};e.slice().forEach((function(r){var i=t[r.type];if(i){"number"==typeof i.samplerate&&(i.samplerate=[i.samplerate]),i.samplerate=i.samplerate.concat(r.samplerate);var n=e.indexOf(r);n>=0&&e.splice(n,1)}else t[r.type]=r}))},e.prototype._supportedAudioStreamConfiguration=function(e){var t=e&&!!e.comfort_noise,r=e&&e.codecs||[];this.checkForLegacyAudioCodecRepresentation(r),0===r.length&&(W("Client doesn't support any audio codec that HomeKit supports."),this.videoOnly=!0,r.push({type:"OPUS",samplerate:[16,24]}));var i=r.map((function(e){var t;switch(e.type){case"OPUS":t=3;break;case"AAC-eld":t=2;break;case"PCMA":t=1;break;case"PCMU":t=0;break;case"mSBC":t=4;break;case"AMR":t=5;break;case"AMR-WB":t=6;break;default:throw new Error("Unsupported codec: "+e.type)}var r=("number"==typeof e.samplerate?[e.samplerate]:e.samplerate).map((function(t){var r;switch(t){case 8:r=0;break;case 16:r=1;break;case 24:r=2;break;default:console.log("Unsupported sample rate: ",e.samplerate),r=-1}return r})).filter((function(e){return-1!==e}));if(0===r.length)throw new Error("Audio samplerate cannot be empty!");var i=V.encode(1,Math.max(1,e.audioChannels||1),2,e.bitrate||0,3,r);return V.encode(1,t,2,i)}));return V.encode(1,i,2,t?1:0).toString("base64")},e.prototype.resetSetupEndpointsResponse=function(){this.setupEndpointsResponse=V.encode(2,2).toString("base64"),this.service.updateCharacteristic(L.Characteristic.SetupEndpoints,this.setupEndpointsResponse)},e.prototype.resetSelectedStreamConfiguration=function(){this.selectedConfiguration=V.encode(1,V.encode(2,I.SUSPEND_SESSION)).toString("base64"),this.service.updateCharacteristic(L.Characteristic.SelectedRTPStreamConfiguration,this.selectedConfiguration)},e.prototype.serialize=function(){var e=this.service.getCharacteristic(L.Characteristic.Active).value;if(!0!==e)return{id:this.id,active:!!e}},e.prototype.deserialize=function(e){(0,O.default)(e.id===this.id,"Tried to initialize RTPStreamManagement ".concat(this.id," with data from management with id ").concat(e.id,"!")),this.service.updateCharacteristic(L.Characteristic.Active,e.active)},e.prototype.setupStateChangeDelegate=function(e){this.stateChangeDelegate=e},e.SRTPCryptoSuites=g,e.VideoCodecParamProfileIDTypes=u,e.VideoCodecParamLevelTypes=Object.freeze({TYPE3_1:0,TYPE3_2:1,TYPE4_0:2}),e}();t.RTPStreamManagement=Y;var q=function(e){function t(t,r,i,n){var a=e.call(this,t,r,new j.LegacyCameraSourceAdapter(i),n)||this;return a.options=r,a}return R.__extends(t,e),t}(Y);t.StreamController=q},6859:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecordingManagement=t.PacketDataType=t.AudioRecordingSamplerate=t.AudioRecordingCodecType=t.MediaContainerType=t.EventTriggerOption=void 0;var i,n,a,o,s,c,u,l,h,d,p,f=r(1635),v=f.__importDefault(r(6982)),g=f.__importDefault(r(5753)),m=r(4434),y=r(9826),C=r(9948),S=r(5876),E=r(8073),_=f.__importStar(r(3314)),T=(0,g.default)("HAP-NodeJS:Camera:RecordingManagement");!function(e){e[e.MOTION=1]="MOTION",e[e.DOORBELL=2]="DOORBELL"}(t.EventTriggerOption||(t.EventTriggerOption={})),function(e){e[e.FRAGMENTED_MP4=0]="FRAGMENTED_MP4"}(t.MediaContainerType||(t.MediaContainerType={})),function(e){e[e.CODEC_TYPE=1]="CODEC_TYPE",e[e.CODEC_PARAMETERS=2]="CODEC_PARAMETERS",e[e.ATTRIBUTES=3]="ATTRIBUTES"}(i||(i={})),function(e){e[e.PROFILE_ID=1]="PROFILE_ID",e[e.LEVEL=2]="LEVEL",e[e.BITRATE=3]="BITRATE",e[e.IFRAME_INTERVAL=4]="IFRAME_INTERVAL"}(n||(n={})),function(e){e[e.IMAGE_WIDTH=1]="IMAGE_WIDTH",e[e.IMAGE_HEIGHT=2]="IMAGE_HEIGHT",e[e.FRAME_RATE=3]="FRAME_RATE"}(a||(a={})),function(e){e[e.SELECTED_RECORDING_CONFIGURATION=1]="SELECTED_RECORDING_CONFIGURATION",e[e.SELECTED_VIDEO_CONFIGURATION=2]="SELECTED_VIDEO_CONFIGURATION",e[e.SELECTED_AUDIO_CONFIGURATION=3]="SELECTED_AUDIO_CONFIGURATION"}(o||(o={})),function(e){e[e.AAC_LC=0]="AAC_LC",e[e.AAC_ELD=1]="AAC_ELD"}(t.AudioRecordingCodecType||(t.AudioRecordingCodecType={})),function(e){e[e.KHZ_8=0]="KHZ_8",e[e.KHZ_16=1]="KHZ_16",e[e.KHZ_24=2]="KHZ_24",e[e.KHZ_32=3]="KHZ_32",e[e.KHZ_44_1=4]="KHZ_44_1",e[e.KHZ_48=5]="KHZ_48"}(t.AudioRecordingSamplerate||(t.AudioRecordingSamplerate={})),function(e){e[e.VIDEO_CODEC_CONFIGURATION=1]="VIDEO_CODEC_CONFIGURATION"}(s||(s={})),function(e){e[e.PREBUFFER_LENGTH=1]="PREBUFFER_LENGTH",e[e.EVENT_TRIGGER_OPTIONS=2]="EVENT_TRIGGER_OPTIONS",e[e.MEDIA_CONTAINER_CONFIGURATIONS=3]="MEDIA_CONTAINER_CONFIGURATIONS"}(c||(c={})),function(e){e[e.MEDIA_CONTAINER_TYPE=1]="MEDIA_CONTAINER_TYPE",e[e.MEDIA_CONTAINER_PARAMETERS=2]="MEDIA_CONTAINER_PARAMETERS"}(u||(u={})),function(e){e[e.FRAGMENT_LENGTH=1]="FRAGMENT_LENGTH"}(l||(l={})),function(e){e[e.CHANNEL=1]="CHANNEL",e[e.BIT_RATE=2]="BIT_RATE",e[e.SAMPLE_RATE=3]="SAMPLE_RATE",e[e.MAX_AUDIO_BITRATE=4]="MAX_AUDIO_BITRATE"}(h||(h={})),function(e){e[e.CODEC_TYPE=1]="CODEC_TYPE",e[e.CODEC_PARAMETERS=2]="CODEC_PARAMETERS"}(d||(d={})),function(e){e[e.AUDIO_CODEC_CONFIGURATION=1]="AUDIO_CODEC_CONFIGURATION"}(p||(p={})),function(e){e.MEDIA_INITIALIZATION="mediaInitialization",e.MEDIA_FRAGMENT="mediaFragment"}(t.PacketDataType||(t.PacketDataType={}));var A,I=function(){function e(e,t,r,i){var n,a;this.sensorServices=[],this.recordingActive=!1,this.options=e,this.delegate=t;var o=i||this.constructService();this.recordingManagementService=o.recordingManagement,this.operatingModeService=o.operatingMode,this.dataStreamManagement=o.dataStreamManagement,this.eventTriggerOptions=0;try{for(var s=f.__values(r),c=s.next();!c.done;c=s.next()){var u=c.value;this.eventTriggerOptions|=u}}catch(e){n={error:e}}finally{try{c&&!c.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}this.supportedCameraRecordingConfiguration=this._supportedCameraRecordingConfiguration(e),this.supportedVideoRecordingConfiguration=this._supportedVideoRecordingConfiguration(e.video),this.supportedAudioRecordingConfiguration=this._supportedAudioStreamConfiguration(e.audio),this.setupServiceHandlers()}return e.prototype.constructService=function(){var e=new S.Service.CameraRecordingManagement("","");e.setCharacteristic(y.Characteristic.Active,!1),e.setCharacteristic(y.Characteristic.RecordingAudioActive,!1);var t=new S.Service.CameraOperatingMode("","");t.setCharacteristic(y.Characteristic.EventSnapshotsActive,!0),t.setCharacteristic(y.Characteristic.HomeKitCameraActive,!0),t.setCharacteristic(y.Characteristic.PeriodicSnapshotsActive,!0);var r=new C.DataStreamManagement;return e.addLinkedService(r.getService()),{recordingManagement:e,operatingMode:t,dataStreamManagement:r}},e.prototype.setupServiceHandlers=function(){var e=this;this.recordingManagementService.setCharacteristic(y.Characteristic.SupportedCameraRecordingConfiguration,this.supportedCameraRecordingConfiguration),this.recordingManagementService.setCharacteristic(y.Characteristic.SupportedVideoRecordingConfiguration,this.supportedVideoRecordingConfiguration),this.recordingManagementService.setCharacteristic(y.Characteristic.SupportedAudioRecordingConfiguration,this.supportedAudioRecordingConfiguration),this.recordingManagementService.getCharacteristic(y.Characteristic.SelectedCameraRecordingConfiguration).onGet(this.handleSelectedCameraRecordingConfigurationRead.bind(this)).onSet(this.handleSelectedCameraRecordingConfigurationWrite.bind(this)).setProps({adminOnlyAccess:[1]}),this.recordingManagementService.getCharacteristic(y.Characteristic.Active).onSet((function(t){!!t!==e.recordingActive&&(e.recordingActive=!!t,e.delegate.updateRecordingActive(e.recordingActive))})).on("change",(function(){var t;return null===(t=e.stateChangeDelegate)||void 0===t?void 0:t.call(e)})).setProps({adminOnlyAccess:[1]}),this.recordingManagementService.getCharacteristic(y.Characteristic.RecordingAudioActive).on("change",(function(){var t;return null===(t=e.stateChangeDelegate)||void 0===t?void 0:t.call(e)})),this.operatingModeService.getCharacteristic(y.Characteristic.HomeKitCameraActive).on("change",(function(t){var r,i,n;try{for(var a=f.__values(e.sensorServices),o=a.next();!o.done;o=a.next()){o.value.setCharacteristic(y.Characteristic.StatusActive,!!t.newValue)}}catch(e){r={error:e}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}!t.newValue&&e.recordingStream&&e.recordingStream.close(1),null===(n=e.stateChangeDelegate)||void 0===n||n.call(e)})).setProps({adminOnlyAccess:[1]}),this.operatingModeService.getCharacteristic(y.Characteristic.EventSnapshotsActive).on("change",(function(){var t;return null===(t=e.stateChangeDelegate)||void 0===t?void 0:t.call(e)})).setProps({adminOnlyAccess:[1]}),this.operatingModeService.getCharacteristic(y.Characteristic.PeriodicSnapshotsActive).on("change",(function(){var t;return null===(t=e.stateChangeDelegate)||void 0===t?void 0:t.call(e)})).setProps({adminOnlyAccess:[1]}),this.dataStreamManagement.onRequestMessage("dataSend","open",this.handleDataSendOpen.bind(this))},e.prototype.handleDataSendOpen=function(e,t,r){var i=this,n=r.streamId,a=r.type,o=r.target,s=r.reason;if("controller"!==o||"ipcamera.recording"!==a)return T("[HDS %s] Received data send with unexpected target: %s or type: %d. Rejecting...",e.remoteAddress,o,a),void e.sendResponse("dataSend","open",t,C.HDSStatus.PROTOCOL_SPECIFIC_ERROR,{status:5});if(this.recordingActive){if(this.operatingModeService.getCharacteristic(y.Characteristic.HomeKitCameraActive).value)return this.recordingStream?(T("[HDS %s] Rejecting DATA_SEND OPEN as another stream (%s) is already recording with streamId %d!",e.remoteAddress,this.recordingStream.connection.remoteAddress,this.recordingStream.streamId),void e.sendResponse("dataSend","open",t,C.HDSStatus.PROTOCOL_SPECIFIC_ERROR,{status:2})):void(this.selectedConfiguration?(T("[HDS %s] HDS DATA_SEND Open with reason '%s'.",e.remoteAddress,s),this.recordingStream=new D(e,this.delegate,t,n),this.recordingStream.on("closed",(function(){T("[HDS %s] Removing active recoding session from recording management!"),i.recordingStream=void 0})),this.recordingStream.startStreaming()):e.sendResponse("dataSend","open",t,C.HDSStatus.PROTOCOL_SPECIFIC_ERROR,{status:9}));e.sendResponse("dataSend","open",t,C.HDSStatus.PROTOCOL_SPECIFIC_ERROR,{status:1})}else e.sendResponse("dataSend","open",t,C.HDSStatus.PROTOCOL_SPECIFIC_ERROR,{status:1})},e.prototype.handleSelectedCameraRecordingConfigurationRead=function(){if(!this.selectedConfiguration)throw new E.HapStatusError(-70402);return this.selectedConfiguration.base64},e.prototype.handleSelectedCameraRecordingConfigurationWrite=function(e){var t,r,i=this.parseSelectedConfiguration(e),n=(null===(t=this.selectedConfiguration)||void 0===t?void 0:t.base64)!==e;this.selectedConfiguration={parsed:i,base64:e},n&&(this.delegate.updateRecordingConfiguration(this.selectedConfiguration.parsed),null===(r=this.stateChangeDelegate)||void 0===r||r.call(this))},e.prototype.parseSelectedConfiguration=function(e){for(var t=_.decode(Buffer.from(e,"base64")),r=_.decode(t[1]),i=_.decode(t[2]),n=_.decode(t[3]),a=r[1].readInt32LE(0),o=r[2].readInt32LE(0),s=_.decode(r[3]),c=s[1][0],u=_.decode(s[2])[1].readInt32LE(0),l=i[1][0],h=_.decode(i[2]),d=_.decode(i[3]),p=h[1][0],f=h[2][0],v=h[3].readInt32LE(0),g=h[4].readInt32LE(0),m=d[1].readInt16LE(0),y=d[2].readInt16LE(0),C=d[3][0],S=n[1][0],E=_.decode(n[2]),T=E[1][0],A=E[3][0],I=E[2][0],D=E[4].readUInt32LE(0),w=[],b=0;o>0;)1&o&&w.push(1<<b),o>>=1,b+=1;return{prebufferLength:a,eventTriggerTypes:w,mediaContainerConfiguration:{type:c,fragmentLength:u},videoCodec:{type:l,parameters:{profile:p,level:f,bitRate:v,iFrameInterval:g},resolution:[m,y,C]},audioCodec:{audioChannels:T,type:S,samplerate:A,bitrateMode:I,bitrate:D}}},e.prototype._supportedCameraRecordingConfiguration=function(e){var t=Array.isArray(e.mediaContainerConfiguration)?e.mediaContainerConfiguration:[e.mediaContainerConfiguration],r=Buffer.alloc(4),i=Buffer.alloc(8);return r.writeInt32LE(e.prebufferLength,0),i.writeInt32LE(this.eventTriggerOptions,0),_.encode(1,r,2,i,3,t.map((function(e){var t=Buffer.alloc(4);return t.writeInt32LE(e.fragmentLength,0),_.encode(1,e.type,2,_.encode(1,t))}))).toString("base64")},e.prototype._supportedVideoRecordingConfiguration=function(e){if(!e.parameters)throw new Error("Video parameters cannot be undefined");if(!e.resolutions)throw new Error("Video resolutions cannot be undefined");var t=_.encode(1,e.parameters.profiles,2,e.parameters.levels),r=_.encode(1,e.type,2,t,3,e.resolutions.map((function(e){if(3!==e.length)throw new Error("Unexpected video resolution");var t=Buffer.alloc(2),r=Buffer.alloc(2),i=Buffer.alloc(1);return t.writeUInt16LE(e[0],0),r.writeUInt16LE(e[1],0),i.writeUInt8(e[2],0),_.encode(1,t,2,r,3,i)})));return _.encode(1,r).toString("base64")},e.prototype._supportedAudioStreamConfiguration=function(e){var t=Array.isArray(e.codecs)?e.codecs:[e.codecs];if(0===t.length)throw Error("CameraRecordingOptions.audio: At least one audio codec configuration must be specified!");var r=t.map((function(e){var t=Array.isArray(e.samplerate)?e.samplerate:[e.samplerate];if(0===t.length)throw new Error("CameraRecordingOptions.audio.codecs: Audio samplerate cannot be empty!");var r=_.encode(1,Math.max(1,e.audioChannels||1),2,e.bitrateMode||0,3,t);return _.encode(1,e.type,2,r)}));return _.encode(1,r).toString("base64")},e.prototype.computeConfigurationHash=function(e){void 0===e&&(e="sha256");var t=v.default.createHash(e);return t.update(this.supportedCameraRecordingConfiguration),t.update(this.supportedVideoRecordingConfiguration),t.update(this.supportedAudioRecordingConfiguration),t.digest().toString("hex")},e.prototype.serialize=function(){var e;return{configurationHash:{algorithm:"sha256",hash:this.computeConfigurationHash("sha256")},selectedConfiguration:null===(e=this.selectedConfiguration)||void 0===e?void 0:e.base64,recordingActive:this.recordingActive,recordingAudioActive:!!this.recordingManagementService.getCharacteristic(y.Characteristic.RecordingAudioActive).value,eventSnapshotsActive:!!this.operatingModeService.getCharacteristic(y.Characteristic.EventSnapshotsActive).value,homeKitCameraActive:!!this.operatingModeService.getCharacteristic(y.Characteristic.HomeKitCameraActive).value,periodicSnapshotsActive:!!this.operatingModeService.getCharacteristic(y.Characteristic.PeriodicSnapshotsActive).value}},e.prototype.deserialize=function(e){var t,r,i,n=!1,a=this.computeConfigurationHash(e.configurationHash.algorithm);e.selectedConfiguration&&(a===e.configurationHash.hash?this.selectedConfiguration={base64:e.selectedConfiguration,parsed:this.parseSelectedConfiguration(e.selectedConfiguration)}:n=!0),this.recordingActive=e.recordingActive,this.recordingManagementService.updateCharacteristic(y.Characteristic.Active,e.recordingActive),this.recordingManagementService.updateCharacteristic(y.Characteristic.RecordingAudioActive,e.recordingAudioActive),this.operatingModeService.updateCharacteristic(y.Characteristic.EventSnapshotsActive,e.eventSnapshotsActive),this.operatingModeService.updateCharacteristic(y.Characteristic.PeriodicSnapshotsActive,e.periodicSnapshotsActive),this.operatingModeService.updateCharacteristic(y.Characteristic.HomeKitCameraActive,e.homeKitCameraActive);try{for(var o=f.__values(this.sensorServices),s=o.next();!s.done;s=o.next()){s.value.setCharacteristic(y.Characteristic.StatusActive,e.homeKitCameraActive)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}try{this.selectedConfiguration&&this.delegate.updateRecordingConfiguration(this.selectedConfiguration.parsed),e.recordingActive&&this.delegate.updateRecordingActive(e.recordingActive)}catch(e){console.error("Failed to properly initialize CameraRecordingDelegate from persistent storage: "+e.stack)}n&&(null===(i=this.stateChangeDelegate)||void 0===i||i.call(this))},e.prototype.setupStateChangeDelegate=function(e){this.stateChangeDelegate=e},e.prototype.destroy=function(){this.dataStreamManagement.destroy()},e.prototype.handleFactoryReset=function(){var e,t;this.selectedConfiguration=void 0,this.recordingManagementService.updateCharacteristic(y.Characteristic.Active,!1),this.recordingManagementService.updateCharacteristic(y.Characteristic.RecordingAudioActive,!1),this.operatingModeService.updateCharacteristic(y.Characteristic.EventSnapshotsActive,!0),this.operatingModeService.updateCharacteristic(y.Characteristic.PeriodicSnapshotsActive,!0),this.operatingModeService.updateCharacteristic(y.Characteristic.HomeKitCameraActive,!0);try{for(var r=f.__values(this.sensorServices),i=r.next();!i.done;i=r.next()){i.value.setCharacteristic(y.Characteristic.StatusActive,!0)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}try{this.delegate.updateRecordingActive(!1),this.delegate.updateRecordingConfiguration(void 0)}catch(e){console.error("CameraRecordingDelegate failed to update state after handleFactoryReset: "+e.stack)}},e}();t.RecordingManagement=I,function(e){e.CLOSED="closed"}(A||(A={}));var D=function(e){function t(t,r,i,n){var a,o=e.call(this)||this;return o.closed=!1,o.eventHandler=((a={}).close=o.handleDataSendClose.bind(o),a.ack=o.handleDataSendAck.bind(o),a),o.requestHandler=void 0,o.connection=t,o.delegate=r,o.hdsRequestId=i,o.streamId=n,o.connection.on("closed",o.closeListener=o.handleDataStreamConnectionClosed.bind(o)),o.connection.addProtocolHandler("dataSend",o),o}return f.__extends(t,e),t.prototype.startStreaming=function(){this._startStreaming()},t.prototype._startStreaming=function(){var e,t,r,i;return f.__awaiter(this,void 0,void 0,(function(){var n,a,o,s,c,u,l,h,d,p,v,g,m,y,S,E;return f.__generator(this,(function(_){switch(_.label){case 0:T("[HDS %s] Sending DATA_SEND OPEN response for streamId %d",this.connection.remoteAddress,this.streamId),this.connection.sendResponse("dataSend","open",this.hdsRequestId,C.HDSStatus.SUCCESS,{status:C.HDSStatus.SUCCESS}),n=262144,a=!0,o=1,s=!1,_.label=1;case 1:_.trys.push([1,14,15,16]),this.generator=this.delegate.handleRecordingStreamRequest(this.streamId),_.label=2;case 2:_.trys.push([2,7,8,13]),c=!0,u=f.__asyncValues(this.generator),_.label=3;case 3:return[4,u.next()];case 4:if(l=_.sent(),e=l.done)return[3,6];i=l.value,c=!1;try{if(h=i,this.closed)return console.error("[HDS ".concat(this.connection.remoteAddress,"] Delegate yielded fragment after stream ").concat(this.streamId," was already closed!")),[3,6];if(s)return console.error("[HDS ".concat(this.connection.remoteAddress,"] Delegate yielded fragment for stream ").concat(this.streamId," after already signaling end of stream!")),[3,6];for(d=h.data,p=0,v=1;p<d.length;)g=d.slice(p,p+n),p+=g.length,m={streamId:this.streamId,packets:[{data:g,metadata:{dataType:a?"mediaInitialization":"mediaFragment",dataSequenceNumber:o,dataChunkSequenceNumber:v,isLastDataChunk:p>=d.length,dataTotalSize:1===v?d.length:void 0}}],endOfStream:p>=d.length?Boolean(h.isLast).valueOf():void 0},T("[HDS %s] Sending DATA_SEND DATA for stream %d with metadata: %o and length %d; EoS: %s",this.connection.remoteAddress,this.streamId,m.packets[0].metadata,g.length,m.endOfStream),this.connection.sendEvent("dataSend","data",m),v++,a=!1;if(s=h.isLast,h.isLast)return[3,6];o++}finally{c=!0}_.label=5;case 5:return[3,3];case 6:return[3,13];case 7:return y=_.sent(),t={error:y},[3,13];case 8:return _.trys.push([8,,11,12]),c||e||!(r=u.return)?[3,10]:[4,r.call(u)];case 9:_.sent(),_.label=10;case 10:return[3,12];case 11:if(t)throw t.error;return[7];case 12:return[7];case 13:return s||this.closed||console.warn("[HDS ".concat(this.connection.remoteAddress,"] Delegate finished streaming for ").concat(this.streamId," without setting RecordingPacket.isLast.         Can't notify Controller about endOfStream!")),[3,16];case 14:if(S=_.sent(),this.closed)console.warn("[HDS ".concat(this.connection.remoteAddress,"] Encountered unexpected error on already closed recording stream ").concat(this.streamId,": ").concat(S.stack));else{if(E=5,S instanceof C.HDSProtocolError)E=S.reason,T("[HDS %s] Delegate signaled to close the recording stream %d.",this.connection.remoteAddress,this.streamId);else{if(S instanceof C.HDSConnectionError&&2===S.type)return T("[HDS %s] Exited recording stream due to closed HDS socket: stream id %d.",this.connection.remoteAddress,this.streamId),[2];console.error("[HDS ".concat(this.connection.remoteAddress,"] Encountered unexpected error for recording stream ").concat(this.streamId,": ").concat(S.stack))}this.close(E)}return[2];case 15:return this.generator=void 0,this.generatorTimeout&&clearTimeout(this.generatorTimeout),this.closed||this.kickOffCloseTimeout(),[7];case 16:return a&&console.warn("[HDS ".concat(this.connection.remoteAddress,"] Delegate finished recording stream ").concat(this.streamId," without sending anything out.       Controller will CANCEL.")),T("[HDS %s] Finished DATA_SEND transmission for stream %d!",this.connection.remoteAddress,this.streamId),[2]}}))}))},t.prototype.handleDataSendAck=function(e){var t=this,r=e.streamId,i=e.endOfStream;T("[HDS %s] Received DATA_SEND ACK packet for streamId %s. Acknowledged %s.",this.connection.remoteAddress,r,i),this.handleClosed((function(){var e,r;return null===(r=(e=t.delegate).acknowledgeStream)||void 0===r?void 0:r.call(e,t.streamId)}))},t.prototype.handleDataSendClose=function(e){var t=this,r=e.streamId,i=e.reason;r===this.streamId&&(T("[HDS %s] Received DATA_SEND CLOSE for streamId %d with reason %s",this.connection.remoteAddress,r,C.HDSProtocolSpecificErrorReason[i]),this.handleClosed((function(){return t.delegate.closeRecordingStream(r,i)})))},t.prototype.handleDataStreamConnectionClosed=function(){var e=this;T("[HDS %s] The HDS connection of the stream %d closed.",this.connection.remoteAddress,this.streamId),this.handleClosed((function(){return e.delegate.closeRecordingStream(e.streamId,void 0)}))},t.prototype.handleClosed=function(e){var t=this;this.closed=!0,this.closingTimeout&&(clearTimeout(this.closingTimeout),this.closingTimeout=void 0),this.connection.removeProtocolHandler("dataSend",this),this.connection.removeListener("closed",this.closeListener),this.generator&&(this.generatorTimeout=setTimeout((function(){console.error("[HDS %s] Recording download stream %d is still awaiting generator although stream was closed 10s ago! This is a programming mistake by the camera implementation which prevents freeing up resources.",t.connection.remoteAddress,t.streamId)}),1e4));try{e()}catch(e){console.error("[HDS ".concat(this.connection.remoteAddress,"] CameraRecordingDelegated failed to handle closing the stream ").concat(this.streamId,": ").concat(e.stack))}this.emit("closed")},t.prototype.close=function(e){var t=this;this.closed||(T("[HDS %s] Recording stream %d was closed manually with reason %s.",this.connection.remoteAddress,this.streamId,e?C.HDSProtocolSpecificErrorReason[e]:"CLOSED"),this.connection.isConsideredClosed()||this.connection.sendEvent("dataSend","close",{streamId:this.streamId,reason:e}),this.handleClosed((function(){return t.delegate.closeRecordingStream(t.streamId,e)})))},t.prototype.kickOffCloseTimeout=function(){var e=this;this.closingTimeout&&clearTimeout(this.closingTimeout),this.closingTimeout=setTimeout((function(){e.closed||(T("[HDS %s] Recording stream %d took longer than expected to fully close. Force closing now!",e.connection.remoteAddress,e.streamId),e.close(3))}),12e3)},t}(m.EventEmitter)},8591:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(1635);i.__exportStar(r(9672),t),i.__exportStar(r(5989),t),i.__exportStar(r(8598),t),i.__exportStar(r(6859),t)},6864:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdaptiveLightingController=t.AdaptiveLightingControllerEvents=t.AdaptiveLightingControllerMode=void 0;var i,n,a,o,s,c,u,l,h,d,p,f,v,g=r(1635),m=g.__importDefault(r(2613)),y=r(2175),C=r(8073),S=r(1579),E=g.__importStar(r(2997)),_=g.__importDefault(r(5753)),T=r(4434),A=r(9826),I=g.__importStar(r(3314)),D=(0,_.default)("HAP-NodeJS:Controller:TransitionControl");!function(e){e[e.SUPPORTED_TRANSITION_CONFIGURATION=1]="SUPPORTED_TRANSITION_CONFIGURATION"}(i||(i={})),function(e){e[e.CHARACTERISTIC_IID=1]="CHARACTERISTIC_IID",e[e.TRANSITION_TYPE=2]="TRANSITION_TYPE"}(n||(n={})),function(e){e[e.BRIGHTNESS=1]="BRIGHTNESS",e[e.COLOR_TEMPERATURE=2]="COLOR_TEMPERATURE"}(a||(a={})),function(e){e[e.READ_CURRENT_VALUE_TRANSITION_CONFIGURATION=1]="READ_CURRENT_VALUE_TRANSITION_CONFIGURATION",e[e.UPDATE_VALUE_TRANSITION_CONFIGURATION=2]="UPDATE_VALUE_TRANSITION_CONFIGURATION"}(o||(o={})),function(e){e[e.CHARACTERISTIC_IID=1]="CHARACTERISTIC_IID"}(s||(s={})),function(e){e[e.VALUE_TRANSITION_CONFIGURATION=1]="VALUE_TRANSITION_CONFIGURATION"}(c||(c={})),function(e){e[e.CHARACTERISTIC_IID=1]="CHARACTERISTIC_IID",e[e.TRANSITION_PARAMETERS=2]="TRANSITION_PARAMETERS",e[e.UNKNOWN_3=3]="UNKNOWN_3",e[e.UNKNOWN_4=4]="UNKNOWN_4",e[e.TRANSITION_CURVE_CONFIGURATION=5]="TRANSITION_CURVE_CONFIGURATION",e[e.UPDATE_INTERVAL=6]="UPDATE_INTERVAL",e[e.UNKNOWN_7=7]="UNKNOWN_7",e[e.NOTIFY_INTERVAL_THRESHOLD=8]="NOTIFY_INTERVAL_THRESHOLD"}(u||(u={})),function(e){e[e.TRANSITION_ID=1]="TRANSITION_ID",e[e.START_TIME=2]="START_TIME",e[e.UNKNOWN_3=3]="UNKNOWN_3"}(l||(l={})),function(e){e[e.TRANSITION_ENTRY=1]="TRANSITION_ENTRY",e[e.ADJUSTMENT_CHARACTERISTIC_IID=2]="ADJUSTMENT_CHARACTERISTIC_IID",e[e.ADJUSTMENT_MULTIPLIER_RANGE=3]="ADJUSTMENT_MULTIPLIER_RANGE"}(h||(h={})),function(e){e[e.ADJUSTMENT_FACTOR=1]="ADJUSTMENT_FACTOR",e[e.VALUE=2]="VALUE",e[e.TRANSITION_OFFSET=3]="TRANSITION_OFFSET",e[e.DURATION=4]="DURATION"}(d||(d={})),function(e){e[e.MINIMUM_ADJUSTMENT_MULTIPLIER=1]="MINIMUM_ADJUSTMENT_MULTIPLIER",e[e.MAXIMUM_ADJUSTMENT_MULTIPLIER=2]="MAXIMUM_ADJUSTMENT_MULTIPLIER"}(p||(p={})),function(e){e[e.VALUE_CONFIGURATION_STATUS=1]="VALUE_CONFIGURATION_STATUS"}(f||(f={})),function(e){e[e.CHARACTERISTIC_IID=1]="CHARACTERISTIC_IID",e[e.TRANSITION_PARAMETERS=2]="TRANSITION_PARAMETERS",e[e.TIME_SINCE_START=3]="TIME_SINCE_START"}(v||(v={})),function(e){e[e.AUTOMATIC=1]="AUTOMATIC",e[e.MANUAL=2]="MANUAL"}(t.AdaptiveLightingControllerMode||(t.AdaptiveLightingControllerMode={})),function(e){e.UPDATE="update",e.DISABLED="disable"}(t.AdaptiveLightingControllerEvents||(t.AdaptiveLightingControllerEvents={}));var w=function(e){function t(t,r){var i,n,a=this;return(a=e.call(this)||this).didRunFirstInitializationStep=!1,a.lastEventNotificationSent=0,a.lastNotifiedTemperatureValue=0,a.lastNotifiedSaturationValue=0,a.lastNotifiedHueValue=0,a.lightbulb=t,a.mode=null!==(i=null==r?void 0:r.controllerMode)&&void 0!==i?i:1,a.customTemperatureAdjustment=null!==(n=null==r?void 0:r.customTemperatureAdjustment)&&void 0!==n?n:0,(0,m.default)(a.lightbulb.testCharacteristic(A.Characteristic.ColorTemperature),"Lightbulb must have the ColorTemperature characteristic added!"),(0,m.default)(a.lightbulb.testCharacteristic(A.Characteristic.Brightness),"Lightbulb must have the Brightness characteristic added!"),a.adjustmentFactorChangedListener=a.handleAdjustmentFactorChanged.bind(a),a.characteristicManualWrittenChangeListener=a.handleCharacteristicManualWritten.bind(a),a}return g.__extends(t,e),t.prototype.controllerId=function(){return"characteristic-transition-"+this.lightbulb.getServiceId()},t.prototype.isAdaptiveLightingActive=function(){return!!this.activeTransition},t.prototype.disableAdaptiveLighting=function(){var e;this.updateTimeout&&(clearTimeout(this.updateTimeout),this.updateTimeout=void 0),this.activeTransition&&(this.colorTemperatureCharacteristic.removeListener("change",this.characteristicManualWrittenChangeListener),this.brightnessCharacteristic.removeListener("change",this.adjustmentFactorChangedListener),this.hueCharacteristic&&this.hueCharacteristic.removeListener("change",this.characteristicManualWrittenChangeListener),this.saturationCharacteristic&&this.saturationCharacteristic.removeListener("change",this.characteristicManualWrittenChangeListener),this.activeTransition=void 0,null===(e=this.stateChangeDelegate)||void 0===e||e.call(this)),this.colorTemperatureCharacteristic=void 0,this.brightnessCharacteristic=void 0,this.hueCharacteristic=void 0,this.saturationCharacteristic=void 0,this.lastTransitionPointInfo=void 0,this.lastEventNotificationSent=0,this.lastNotifiedTemperatureValue=0,this.lastNotifiedSaturationValue=0,this.lastNotifiedHueValue=0,this.didRunFirstInitializationStep=!1,this.activeTransitionCount.sendEventNotification(0),D("[%s] Disabling adaptive lighting",this.lightbulb.displayName)},t.prototype.getAdaptiveLightingStartTimeOfTransition=function(){if(!this.activeTransition)throw new Error("There is no active transition!");return this.activeTransition.transitionStartMillis},t.prototype.getAdaptiveLightingTimeOffset=function(){if(!this.activeTransition)throw new Error("There is no active transition!");return this.activeTransition.timeMillisOffset},t.prototype.getAdaptiveLightingTransitionCurve=function(){if(!this.activeTransition)throw new Error("There is no active transition!");return this.activeTransition.transitionCurve},t.prototype.getAdaptiveLightingBrightnessMultiplierRange=function(){if(!this.activeTransition)throw new Error("There is no active transition!");return this.activeTransition.brightnessAdjustmentRange},t.prototype.getAdaptiveLightingUpdateInterval=function(){if(!this.activeTransition)throw new Error("There is no active transition!");return this.activeTransition.updateInterval},t.prototype.getAdaptiveLightingNotifyIntervalThreshold=function(){if(!this.activeTransition)throw new Error("There is no active transition!");return this.activeTransition.notifyIntervalThreshold},t.prototype.handleActiveTransitionUpdated=function(e){var t;if(void 0===e&&(e=!1),e?this.activeTransitionCount.value=1:this.activeTransitionCount.sendEventNotification(1),1===this.mode)this.scheduleNextUpdate();else{if(2!==this.mode)throw new Error("Unsupported adaptive lighting controller mode: "+this.mode);this.emit("update")}e||null===(t=this.stateChangeDelegate)||void 0===t||t.call(this)},t.prototype.handleAdaptiveLightingEnabled=function(){if(!this.activeTransition)throw new Error("There is no active transition!");this.colorTemperatureCharacteristic=this.lightbulb.getCharacteristic(A.Characteristic.ColorTemperature),this.brightnessCharacteristic=this.lightbulb.getCharacteristic(A.Characteristic.Brightness),this.colorTemperatureCharacteristic.on("change",this.characteristicManualWrittenChangeListener),this.brightnessCharacteristic.on("change",this.adjustmentFactorChangedListener),this.lightbulb.testCharacteristic(A.Characteristic.Hue)&&(this.hueCharacteristic=this.lightbulb.getCharacteristic(A.Characteristic.Hue).on("change",this.characteristicManualWrittenChangeListener)),this.lightbulb.testCharacteristic(A.Characteristic.Saturation)&&(this.saturationCharacteristic=this.lightbulb.getCharacteristic(A.Characteristic.Saturation).on("change",this.characteristicManualWrittenChangeListener))},t.prototype.handleAdaptiveLightingDisabled=function(){2===this.mode&&this.activeTransition&&this.emit("disable"),this.disableAdaptiveLighting()},t.prototype.handleAdjustmentFactorChanged=function(e){var t=this;e.newValue!==e.oldValue&&("read"===e.reason?setTimeout((function(){t.activeTransition&&t.scheduleNextUpdate(!0)}),1e3).unref():this.scheduleNextUpdate(!0))},t.prototype.handleCharacteristicManualWritten=function(e){var t;"write"!==e.reason||(t=e.context)&&"controller"in t&&e.context.controller===this||(D("[%s] Received a manual write to an characteristic (newValue: %d, oldValue: %d, reason: %s). Thus disabling adaptive lighting!",this.lightbulb.displayName,e.newValue,e.oldValue,e.reason),this.disableAdaptiveLighting())},t.prototype.getCurrentAdaptiveLightingTransitionPoint=function(){var e,t,r,i,n;if(!this.activeTransition)throw new Error("Cannot calculate current transition point if no transition is active!");for(var a=Date.now()-this.activeTransition.timeMillisOffset-this.activeTransition.transitionStartMillis,o=null!==(t=null===(e=this.lastTransitionPointInfo)||void 0===e?void 0:e.curveIndex)&&void 0!==t?t:0,s=null!==(i=null===(r=this.lastTransitionPointInfo)||void 0===r?void 0:r.lowerBoundTimeOffset)&&void 0!==i?i:0,c=void 0,u=void 0;o+1<this.activeTransition.transitionCurve.length;o++){var l=this.activeTransition.transitionCurve[o],h=this.activeTransition.transitionCurve[o+1],d=null!==(n=l.duration)&&void 0!==n?n:0;if(a>=(s+=l.transitionTime)){if(a<=s+d+h.transitionTime){c=l,u=h;break}}else if(this.lastTransitionPointInfo)return this.lastTransitionPointInfo=void 0,this.getCurrentAdaptiveLightingTransitionPoint();s+=d}if(c&&u)return this.lastTransitionPointInfo={curveIndex:o,lowerBoundTimeOffset:s-c.transitionTime},{lowerBoundTimeOffset:s,transitionOffset:a-s,lowerBound:c,upperBound:u};this.lastTransitionPointInfo=void 0},t.prototype.scheduleNextUpdate=function(e){var t,r,i,n,a,o=this;if(void 0===e&&(e=!1),!this.activeTransition)throw new Error("tried scheduling transition when no transition was active!");e||(this.updateTimeout=void 0),this.didRunFirstInitializationStep||(this.didRunFirstInitializationStep=!0,this.handleAdaptiveLightingEnabled());var s=this.getCurrentAdaptiveLightingTransitionPoint();if(!s)return D("[%s] Reached end of transition curve!",this.lightbulb.displayName),void(e||this.disableAdaptiveLighting());var c,u,l=s.lowerBound,h=s.upperBound;if(l.duration&&s.transitionOffset<=l.duration)c=l.temperature,u=l.brightnessAdjustmentFactor;else{var d=(s.transitionOffset-(null!==(t=l.duration)&&void 0!==t?t:0))/h.transitionTime;c=l.temperature+(h.temperature-l.temperature)*d,u=l.brightnessAdjustmentFactor+(h.brightnessAdjustmentFactor-l.brightnessAdjustmentFactor)*d}var p=Math.max(this.activeTransition.brightnessAdjustmentRange.minBrightnessValue,Math.min(this.activeTransition.brightnessAdjustmentRange.maxBrightnessValue,this.brightnessCharacteristic.value)),f=Math.round(c+u*p);f+=this.customTemperatureAdjustment;var v=null!==(i=null===(r=this.colorTemperatureCharacteristic)||void 0===r?void 0:r.props.minValue)&&void 0!==i?i:140,g=null!==(a=null===(n=this.colorTemperatureCharacteristic)||void 0===n?void 0:n.props.maxValue)&&void 0!==a?a:500;f=Math.max(v,Math.min(g,f));var m=y.ColorUtils.colorTemperatureToHueAndSaturation(f);D("[%s] Next temperature value is %d (for brightness %d adj: %s)",this.lightbulb.displayName,f,p,this.customTemperatureAdjustment);var C={controller:this,omitEventUpdate:!0};if(this.saturationCharacteristic&&(this.saturationCharacteristic.value=m.saturation),this.hueCharacteristic&&(this.hueCharacteristic.value=m.hue),this.colorTemperatureCharacteristic.handleSetRequest(f,void 0,C).catch((function(e){D("[%s] Failed to next adaptive lighting transition point: %d",o.lightbulb.displayName,e)})),this.activeTransition){var S=Date.now();if(!e&&S-this.lastEventNotificationSent>=this.activeTransition.notifyIntervalThreshold){D("[%s] Sending event notifications for current transition!",this.lightbulb.displayName),this.lastEventNotificationSent=S;var E={controller:this};this.lastNotifiedTemperatureValue!==f&&(this.colorTemperatureCharacteristic.sendEventNotification(f,E),this.lastNotifiedTemperatureValue=f),this.saturationCharacteristic&&this.lastNotifiedSaturationValue!==m.saturation&&(this.saturationCharacteristic.sendEventNotification(m.saturation,E),this.lastNotifiedSaturationValue=m.saturation),this.hueCharacteristic&&this.lastNotifiedHueValue!==m.hue&&(this.hueCharacteristic.sendEventNotification(m.hue,E),this.lastNotifiedHueValue=m.hue)}e||(this.updateTimeout=setTimeout(this.scheduleNextUpdate.bind(this),this.activeTransition.updateInterval))}else console.warn("["+this.lightbulb.displayName+"] Adaptive Lighting was probably disable my mistake by some call in the SET handler of the ColorTemperature characteristic! Please check that you don't call setValue/setCharacteristic on the Hue, Saturation or ColorTemperature characteristic!")},t.prototype.constructServices=function(){return{}},t.prototype.initWithServices=function(e){},t.prototype.configureServices=function(){var e=this;this.supportedTransitionConfiguration=this.lightbulb.getCharacteristic(A.Characteristic.SupportedCharacteristicValueTransitionConfiguration),this.transitionControl=this.lightbulb.getCharacteristic(A.Characteristic.CharacteristicValueTransitionControl).updateValue(""),this.activeTransitionCount=this.lightbulb.getCharacteristic(A.Characteristic.CharacteristicValueActiveTransitionCount).updateValue(0),this.supportedTransitionConfiguration.onGet(this.handleSupportedTransitionConfigurationRead.bind(this)),this.transitionControl.onGet((function(){return e.buildTransitionControlResponseBuffer().toString("base64")})).onSet((function(t){try{return e.handleTransitionControlWrite(t)}catch(r){throw console.warn("[%s] DEBUG: '".concat(t,"'")),console.warn("[%s] Encountered error on CharacteristicValueTransitionControl characteristic: "+r.stack),e.disableAdaptiveLighting(),new C.HapStatusError(-70402)}}))},t.prototype.handleControllerRemoved=function(){this.lightbulb.removeCharacteristic(this.supportedTransitionConfiguration),this.lightbulb.removeCharacteristic(this.transitionControl),this.lightbulb.removeCharacteristic(this.activeTransitionCount),this.supportedTransitionConfiguration=void 0,this.transitionControl=void 0,this.activeTransitionCount=void 0,this.removeAllListeners()},t.prototype.handleFactoryReset=function(){this.handleAdaptiveLightingDisabled()},t.prototype.serialize=function(){if(this.activeTransition)return{activeTransition:this.activeTransition}},t.prototype.deserialize=function(e){this.activeTransition=e.activeTransition,this.activeTransition.transitionId||(this.activeTransition.transitionId=this.activeTransition.id1,delete this.activeTransition.id1),this.activeTransition.timeMillisOffset||(this.activeTransition.timeMillisOffset=0),this.handleActiveTransitionUpdated(!0)},t.prototype.setupStateChangeDelegate=function(e){this.stateChangeDelegate=e},t.prototype.handleSupportedTransitionConfigurationRead=function(){var e=this.lightbulb.getCharacteristic(A.Characteristic.Brightness).iid,t=this.lightbulb.getCharacteristic(A.Characteristic.ColorTemperature).iid;return(0,m.default)(e,"iid for brightness characteristic is undefined"),(0,m.default)(t,"iid for temperature characteristic is undefined"),I.encode(1,[I.encode(1,I.writeVariableUIntLE(e),2,1),I.encode(1,I.writeVariableUIntLE(t),2,2)]).toString("base64")},t.prototype.buildTransitionControlResponseBuffer=function(e){if(!this.activeTransition)return Buffer.alloc(0);var t=this.activeTransition,r=null!=e?e:Date.now()-t.timeMillisOffset-t.transitionStartMillis,i=I.writeVariableUIntLE(r),n=I.encode(1,E.write(t.transitionId),2,Buffer.from(t.transitionStartBuffer,"hex"));t.id3&&(n=Buffer.concat([n,I.encode(3,Buffer.from(t.id3,"hex"))]));var a=I.encode(1,I.writeVariableUIntLE(t.iid),2,n,3,i);return I.encode(1,a)},t.prototype.handleTransitionControlWrite=function(e){if("string"!=typeof e)throw new C.HapStatusError(-70410);var t=I.decode(Buffer.from(e,"base64")),r=[],i=t[1];if(i){var n=this.handleTransitionControlReadTransition(i);n&&r.push(n)}var a=t[2];if(a){var o=this.handleTransitionControlUpdateTransition(a);o&&r.push(o)}return Buffer.concat(r).toString("base64")},t.prototype.handleTransitionControlReadTransition=function(e){var t=I.decode(e),r=I.readVariableUIntLE(t[1]);if(this.activeTransition){if(this.activeTransition.iid!==r)throw console.warn("["+this.lightbulb.displayName+"] iid of current adaptive lighting transition ("+this.activeTransition.iid+") doesn't match the requested one "+r),new C.HapStatusError(-70410);var i=I.encode(1,E.write(this.activeTransition.transitionId),2,Buffer.from(this.activeTransition.transitionStartBuffer,"hex"));return this.activeTransition.id3&&(i=Buffer.concat([i,I.encode(3,Buffer.from(this.activeTransition.id3,"hex"))])),I.encode(1,I.encode(1,I.writeVariableUIntLE(this.activeTransition.iid),2,i,3,1,5,I.encode(1,this.activeTransition.transitionCurve.map((function(e,t,r){var i,n,a=null!==(n=null===(i=r[t-1])||void 0===i?void 0:i.duration)&&void 0!==n?n:0;return I.encode(1,I.writeFloat32LE(e.brightnessAdjustmentFactor),2,I.writeFloat32LE(e.temperature),3,I.writeVariableUIntLE(e.transitionTime),4,I.writeVariableUIntLE(a))})),2,I.writeVariableUIntLE(this.activeTransition.brightnessCharacteristicIID),3,I.encode(1,I.writeUInt32(this.activeTransition.brightnessAdjustmentRange.minBrightnessValue),2,I.writeUInt32(this.activeTransition.brightnessAdjustmentRange.maxBrightnessValue))),6,I.writeVariableUIntLE(this.activeTransition.updateInterval),8,I.writeVariableUIntLE(this.activeTransition.notifyIntervalThreshold)))}},t.prototype.handleTransitionControlUpdateTransition=function(e){var t,r,i,n,a=I.decode(e),o=I.decode(a[1]),s=I.readVariableUIntLE(o[1]);if(!this.lightbulb.getCharacteristicByIID(s))throw new C.HapStatusError(-70410);if(!(null===(i=o[3])||void 0===i?void 0:i.readUInt8(0)))return this.handleAdaptiveLightingDisabled(),I.encode(2,Buffer.alloc(0));var c=I.decode(o[2]),u=I.decodeWithLists(o[5]),l=null===(n=o[6])||void 0===n?void 0:n.readUInt16LE(0),h=o[8].readUInt32LE(0),d=c[1],p=c[2],f=c[3],v=(0,S.epochMillisFromMillisSince2001_01_01Buffer)(p),m=Date.now()-v,y=[],_=void 0,T=u[1];try{for(var A=g.__values(T),w=A.next();!w.done;w=A.next()){var b=w.value,U=I.decode(b),R=U[1].readFloatLE(0),O=U[2].readFloatLE(0),N=I.readVariableUIntLE(U[3]),P=U[4]?I.readVariableUIntLE(U[4]):void 0;_&&(_.duration=P),_={temperature:O,brightnessAdjustmentFactor:R,transitionTime:N},y.push(_)}}catch(e){t={error:e}}finally{try{w&&!w.done&&(r=A.return)&&r.call(A)}finally{if(t)throw t.error}}var B=I.readVariableUIntLE(u[2]),L=I.decode(u[3]),x=L[1].readUInt32LE(0),M=L[2].readUInt32LE(0);return this.activeTransition={iid:s,transitionStartMillis:v,timeMillisOffset:m,transitionId:E.unparse(d),transitionStartBuffer:p.toString("hex"),id3:null==f?void 0:f.toString("hex"),brightnessCharacteristicIID:B,brightnessAdjustmentRange:{minBrightnessValue:x,maxBrightnessValue:M},transitionCurve:y,updateInterval:null!=l?l:6e4,notifyIntervalThreshold:h},this.updateTimeout?(clearTimeout(this.updateTimeout),this.updateTimeout=void 0,D("[%s] Adaptive lighting was renewed.",this.lightbulb.displayName)):D("[%s] Adaptive lighting was enabled.",this.lightbulb.displayName),this.handleActiveTransitionUpdated(),I.encode(2,this.buildTransitionControlResponseBuffer(0))},t}(T.EventEmitter);t.AdaptiveLightingController=w},2405:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CameraController=t.CameraControllerEvents=t.ResourceRequestReason=void 0;var i=r(1635),n=i.__importDefault(r(6982)),a=i.__importDefault(r(5753)),o=r(4434),s=r(8591),c=r(9826),u=r(9948),l=r(5876),h=r(8073),d=(0,a.default)("HAP-NodeJS:Camera:Controller");!function(e){e[e.PERIODIC=0]="PERIODIC",e[e.EVENT=1]="EVENT"}(t.ResourceRequestReason||(t.ResourceRequestReason={})),function(e){e.MICROPHONE_PROPERTIES_CHANGED="microphone-change",e.SPEAKER_PROPERTIES_CHANGED="speaker-change"}(t.CameraControllerEvents||(t.CameraControllerEvents={}));var p=function(e){function t(t,r){void 0===r&&(r=!1);var i=e.call(this)||this;return i.legacyMode=!1,i.streamManagements=[],i.microphoneMuted=!1,i.microphoneVolume=100,i.speakerMuted=!1,i.speakerVolume=100,i.motionServiceExternallySupplied=!1,i.occupancyServiceExternallySupplied=!1,i.streamCount=Math.max(1,t.cameraStreamCount||1),i.delegate=t.delegate,i.streamingOptions=t.streamingOptions,i.recording=t.recording,i.sensorOptions=t.sensors,i.legacyMode=r,i}return i.__extends(t,e),t.prototype.controllerId=function(){return"camera"},t.prototype.forceStopStreamingSession=function(e){this.streamManagements.forEach((function(t){t.sessionIdentifier===e&&t.forceStop()}))},t.generateSynchronisationSource=function(){var e=n.default.randomBytes(4);return e[0]=0,e.readInt32BE(0)},t.prototype.setMicrophoneMuted=function(e){void 0===e&&(e=!0),this.microphoneService&&(this.microphoneMuted=e,this.microphoneService.updateCharacteristic(c.Characteristic.Mute,e))},t.prototype.setMicrophoneVolume=function(e){this.microphoneService&&(this.microphoneVolume=e,this.microphoneService.updateCharacteristic(c.Characteristic.Volume,e))},t.prototype.setSpeakerMuted=function(e){void 0===e&&(e=!0),this.speakerService&&(this.speakerMuted=e,this.speakerService.updateCharacteristic(c.Characteristic.Mute,e))},t.prototype.setSpeakerVolume=function(e){this.speakerService&&(this.speakerVolume=e,this.speakerService.updateCharacteristic(c.Characteristic.Volume,e))},t.prototype.emitMicrophoneChange=function(){this.emit("microphone-change",this.microphoneMuted,this.microphoneVolume)},t.prototype.emitSpeakerChange=function(){this.emit("speaker-change",this.speakerMuted,this.speakerVolume)},t.prototype.constructServices=function(){for(var e,r,i,n,a=0;a<this.streamCount;a++){var o=new s.RTPStreamManagement(a,this.streamingOptions,this.delegate,void 0,this.rtpStreamManagementDisabledThroughOperatingMode.bind(this));this.streamManagements.push(o)}!this.legacyMode&&this.streamingOptions.audio&&(this.microphoneService=new l.Service.Microphone("",""),this.microphoneService.setCharacteristic(c.Characteristic.Volume,this.microphoneVolume),this.streamingOptions.audio.twoWayAudio&&(this.speakerService=new l.Service.Speaker("",""),this.speakerService.setCharacteristic(c.Characteristic.Volume,this.speakerVolume))),this.recording&&(this.recordingManagement=new s.RecordingManagement(this.recording.options,this.recording.delegate,this.retrieveEventTriggerOptions())),(null===(e=this.sensorOptions)||void 0===e?void 0:e.motion)&&("boolean"==typeof this.sensorOptions.motion?this.motionService=new l.Service.MotionSensor("",""):(this.motionService=this.sensorOptions.motion,this.motionServiceExternallySupplied=!0),this.motionService.setCharacteristic(c.Characteristic.StatusActive,!0),null===(r=this.recordingManagement)||void 0===r||r.recordingManagementService.addLinkedService(this.motionService)),(null===(i=this.sensorOptions)||void 0===i?void 0:i.occupancy)&&("boolean"==typeof this.sensorOptions.occupancy?this.occupancyService=new l.Service.OccupancySensor("",""):(this.occupancyService=this.sensorOptions.occupancy,this.occupancyServiceExternallySupplied=!0),this.occupancyService.setCharacteristic(c.Characteristic.StatusActive,!0),null===(n=this.recordingManagement)||void 0===n||n.recordingManagementService.addLinkedService(this.occupancyService));var u={microphone:this.microphoneService,speaker:this.speakerService,motionService:this.motionServiceExternallySupplied?void 0:this.motionService,occupancyService:this.occupancyServiceExternallySupplied?void 0:this.occupancyService};return this.recordingManagement&&(u.cameraEventRecordingManagement=this.recordingManagement.recordingManagementService,u.cameraOperatingMode=this.recordingManagement.operatingModeService,u.dataStreamTransportManagement=this.recordingManagement.dataStreamManagement.getService()),this.streamManagements.forEach((function(e,r){u[t.STREAM_MANAGEMENT+r]=e.getService()})),this.recording=void 0,this.sensorOptions=void 0,u},t.prototype.initWithServices=function(e){var t=this._initWithServices(e);if(t.updated)return t.serviceMap},t.prototype._initWithServices=function(e){for(var r,i,n,a,o,h,d,p,f,v=!1,g=0;;g++){var m=e[t.STREAM_MANAGEMENT+g];if(g<this.streamCount){var y=this.rtpStreamManagementDisabledThroughOperatingMode.bind(this);if(m)this.streamManagements.push(new s.RTPStreamManagement(g,this.streamingOptions,this.delegate,m,y));else{var C=new s.RTPStreamManagement(g,this.streamingOptions,this.delegate,void 0,y);this.streamManagements.push(C),e[t.STREAM_MANAGEMENT+g]=C.getService(),v=!0}}else{if(!m)break;delete e[t.STREAM_MANAGEMENT+g],v=!0}}if(!this.legacyMode&&this.streamingOptions.audio?e.microphone?this.microphoneService=e.microphone:(this.microphoneService=new l.Service.Microphone("",""),this.microphoneService.setCharacteristic(c.Characteristic.Volume,this.microphoneVolume),e.microphone=this.microphoneService,v=!0):e.microphone&&(delete e.microphone,v=!0),!this.legacyMode&&(null===(r=this.streamingOptions.audio)||void 0===r?void 0:r.twoWayAudio)?e.speaker?this.speakerService=e.speaker:(this.speakerService=new l.Service.Speaker("",""),this.speakerService.setCharacteristic(c.Characteristic.Volume,this.speakerVolume),e.speaker=this.speakerService,v=!0):e.speaker&&(delete e.speaker,v=!0),this.recording){var S=this.retrieveEventTriggerOptions();e.cameraEventRecordingManagement&&e.cameraOperatingMode&&e.dataStreamTransportManagement?this.recordingManagement=new s.RecordingManagement(this.recording.options,this.recording.delegate,S,{recordingManagement:e.cameraEventRecordingManagement,operatingMode:e.cameraOperatingMode,dataStreamManagement:new u.DataStreamManagement(e.dataStreamTransportManagement)}):(this.recordingManagement=new s.RecordingManagement(this.recording.options,this.recording.delegate,S),e.cameraEventRecordingManagement=this.recordingManagement.recordingManagementService,e.cameraOperatingMode=this.recordingManagement.operatingModeService,e.dataStreamTransportManagement=this.recordingManagement.dataStreamManagement.getService(),v=!0)}else e.cameraEventRecordingManagement&&(delete e.cameraEventRecordingManagement,v=!0),e.cameraOperatingMode&&(delete e.cameraOperatingMode,v=!0),e.dataStreamTransportManagement&&(delete e.dataStreamTransportManagement,v=!0);return(null===(i=this.sensorOptions)||void 0===i?void 0:i.motion)?("boolean"==typeof this.sensorOptions.motion?e.motionService?this.motionService=e.motionService:this.motionService=new l.Service.MotionSensor("",""):(this.motionService=this.sensorOptions.motion,this.motionServiceExternallySupplied=!0,e.motionService&&(null===(n=this.recordingManagement)||void 0===n||n.recordingManagementService.removeLinkedService(e.motionService),delete e.motionService,v=!0)),this.motionService.setCharacteristic(c.Characteristic.StatusActive,!0),null===(a=this.recordingManagement)||void 0===a||a.recordingManagementService.addLinkedService(this.motionService)):e.motionService&&(null===(o=this.recordingManagement)||void 0===o||o.recordingManagementService.removeLinkedService(e.motionService),delete e.motionService,v=!0),(null===(h=this.sensorOptions)||void 0===h?void 0:h.occupancy)?("boolean"==typeof this.sensorOptions.occupancy?e.occupancyService?this.occupancyService=e.occupancyService:this.occupancyService=new l.Service.OccupancySensor("",""):(this.occupancyService=this.sensorOptions.occupancy,this.occupancyServiceExternallySupplied=!0,e.occupancyService&&(null===(d=this.recordingManagement)||void 0===d||d.recordingManagementService.removeLinkedService(e.occupancyService),delete e.occupancyService,v=!0)),this.occupancyService.setCharacteristic(c.Characteristic.StatusActive,!0),null===(p=this.recordingManagement)||void 0===p||p.recordingManagementService.addLinkedService(this.occupancyService)):e.occupancyService&&(null===(f=this.recordingManagement)||void 0===f||f.recordingManagementService.removeLinkedService(e.occupancyService),delete e.occupancyService,v=!0),this.migrateFromDoorbell(e)&&(v=!0),this.recording=void 0,this.sensorOptions=void 0,{serviceMap:e,updated:v}},t.prototype.migrateFromDoorbell=function(e){return!!e.doorbell&&(delete e.doorbell,!0)},t.prototype.retrieveEventTriggerOptions=function(){var e,t,r;if(!this.recording)return new Set;var n=new Set;if(this.recording.options.overrideEventTriggerOptions)try{for(var a=i.__values(this.recording.options.overrideEventTriggerOptions),o=a.next();!o.done;o=a.next()){var s=o.value;n.add(s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return(null===(r=this.sensorOptions)||void 0===r?void 0:r.motion)&&n.add(1),n},t.prototype.configureServices=function(){var e,t,r=this;this.microphoneService&&(this.microphoneService.getCharacteristic(c.Characteristic.Mute).on("get",(function(e){e(void 0,r.microphoneMuted)})).on("set",(function(e,t){r.microphoneMuted=e,t(),r.emitMicrophoneChange()})),this.microphoneService.getCharacteristic(c.Characteristic.Volume).on("get",(function(e){e(void 0,r.microphoneVolume)})).on("set",(function(e,t){r.microphoneVolume=e,t(),r.emitMicrophoneChange()}))),this.speakerService&&(this.speakerService.getCharacteristic(c.Characteristic.Mute).on("get",(function(e){e(void 0,r.speakerMuted)})).on("set",(function(e,t){r.speakerMuted=e,t(),r.emitSpeakerChange()})),this.speakerService.getCharacteristic(c.Characteristic.Volume).on("get",(function(e){e(void 0,r.speakerVolume)})).on("set",(function(e,t){r.speakerVolume=e,t(),r.emitSpeakerChange()}))),this.motionService&&(null===(e=this.recordingManagement)||void 0===e||e.sensorServices.push(this.motionService)),this.occupancyService&&(null===(t=this.recordingManagement)||void 0===t||t.sensorServices.push(this.occupancyService))},t.prototype.rtpStreamManagementDisabledThroughOperatingMode=function(){return!!this.recordingManagement&&!this.recordingManagement.operatingModeService.getCharacteristic(c.Characteristic.HomeKitCameraActive).value},t.prototype.handleControllerRemoved=function(){var e,t,r;this.handleFactoryReset();try{for(var n=i.__values(this.streamManagements),a=n.next();!a.done;a=n.next()){a.value.destroy()}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.streamManagements.splice(0,this.streamManagements.length),this.microphoneService=void 0,this.speakerService=void 0,null===(r=this.recordingManagement)||void 0===r||r.destroy(),this.recordingManagement=void 0,this.removeAllListeners()},t.prototype.handleFactoryReset=function(){var e;this.streamManagements.forEach((function(e){return e.handleFactoryReset()})),null===(e=this.recordingManagement)||void 0===e||e.handleFactoryReset(),this.microphoneMuted=!1,this.microphoneVolume=100,this.speakerMuted=!1,this.speakerVolume=100},t.prototype.serialize=function(){var e,t,r,n=[];try{for(var a=i.__values(this.streamManagements),o=a.next();!o.done;o=a.next()){var s=o.value.serialize();s&&n.push(s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return{streamManagements:n,recordingManagement:null===(r=this.recordingManagement)||void 0===r?void 0:r.serialize()}},t.prototype.deserialize=function(e){var t,r,n,a,o;try{for(var s=i.__values(e.streamManagements),u=s.next();!u.done;u=s.next()){var l=u.value;(p=this.streamManagements[l.id])&&p.deserialize(l)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}if(e.recordingManagement)if(this.recordingManagement)this.recordingManagement.deserialize(e.recordingManagement);else{try{for(var h=i.__values(this.streamManagements),d=h.next();!d.done;d=h.next()){var p;(p=d.value).service.updateCharacteristic(c.Characteristic.Active,!0)}}catch(e){n={error:e}}finally{try{d&&!d.done&&(a=h.return)&&a.call(h)}finally{if(n)throw n.error}}null===(o=this.stateChangeDelegate)||void 0===o||o.call(this)}},t.prototype.setupStateChangeDelegate=function(e){var t,r,n;this.stateChangeDelegate=e;try{for(var a=i.__values(this.streamManagements),o=a.next();!o.done;o=a.next()){o.value.setupStateChangeDelegate(e)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}null===(n=this.recordingManagement)||void 0===n||n.setupStateChangeDelegate(e)},t.prototype.handleSnapshotRequest=function(e,t,r,i){var n=this;if(this.streamManagements.map((function(e){return!e.getService().getCharacteristic(c.Characteristic.Active).value})).reduce((function(e,t){return e&&t})))return d("[%s] Rejecting snapshot as streaming is disabled.",r),Promise.reject(-70412);if(this.recordingManagement){var a=this.recordingManagement.operatingModeService;if(!a.getCharacteristic(c.Characteristic.HomeKitCameraActive).value)return d("[%s] Rejecting snapshot as HomeKit camera is disabled.",r),Promise.reject(-70412);if(!a.getCharacteristic(c.Characteristic.EventSnapshotsActive).value){if(null==i)return d("[%s] Rejecting snapshot as reason is required due to disabled event snapshots.",r),Promise.reject(-70401);if(1===i)return d("[%s] Rejecting snapshot as even snapshots are disabled.",r),Promise.reject(-70412)}if(!a.getCharacteristic(c.Characteristic.PeriodicSnapshotsActive).value){if(null==i)return d("[%s] Rejecting snapshot as reason is required due to disabled periodic snapshots.",r),Promise.reject(-70401);if(0===i)return d("[%s] Rejecting snapshot as periodic snapshots are disabled.",r),Promise.reject(-70412)}}return new Promise((function(a,o){var s=setTimeout((function(){console.warn("[".concat(r,"] The image snapshot handler for the given accessory is slow to respond! See https://homebridge.io/w/JtMGR for more info.")),(s=setTimeout((function(){s=void 0,console.warn("[".concat(r,"] The image snapshot handler for the given accessory didn't respond at all! See https://homebridge.io/w/JtMGR for more info.")),o(-70408)}),17e3)).unref()}),5e3);s.unref();try{n.delegate.handleSnapshotRequest({height:e,width:t,reason:i},(function(e,t){s&&(clearTimeout(s),s=void 0,e?"number"==typeof e?o(e):(d("[%s] Error getting snapshot: %s",r,e.stack),o(-70402)):t&&0!==t.length?a(t):(console.warn("[".concat(r,"] Snapshot request handler provided empty image buffer!")),o(-70402)))}))}catch(e){if(!s)return;clearTimeout(s),s=void 0,console.warn("[".concat(r,"] Unhandled error thrown inside snapshot request handler: ").concat(e.stack)),o(e instanceof h.HapStatusError?e.hapStatus:-70402)}}))},t.prototype.handleCloseConnection=function(e){this.delegate instanceof s.LegacyCameraSourceAdapter&&this.delegate.forwardCloseConnection(e)},t.STREAM_MANAGEMENT="streamManagement",t}(o.EventEmitter);t.CameraController=p},9414:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSerializableController=t.DefaultControllerType=void 0,function(e){e.CAMERA="camera",e.REMOTE="remote",e.TV="tv",e.ROUTER="router",e.LOCK="lock",e.CHARACTERISTIC_TRANSITION="characteristic-transition"}(t.DefaultControllerType||(t.DefaultControllerType={})),t.isSerializableController=function(e){return"serialize"in e&&"deserialize"in e&&"setupStateChangeDelegate"in e}},7959:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DoorbellController=void 0;var i=r(1635),n=r(9826),a=r(5876),o=function(e){function t(t){var r=e.call(this,t)||this;return r.doorbellServiceExternallySupplied=!1,r.doorbellOptions={name:t.name,externalDoorbellService:t.externalDoorbellService},r}return i.__extends(t,e),t.prototype.ringDoorbell=function(){this.doorbellService.updateCharacteristic(n.Characteristic.ProgrammableSwitchEvent,n.Characteristic.ProgrammableSwitchEvent.SINGLE_PRESS)},t.prototype.constructServices=function(){var t,r,i;(null===(t=this.doorbellOptions)||void 0===t?void 0:t.externalDoorbellService)?(this.doorbellService=this.doorbellOptions.externalDoorbellService,this.doorbellServiceExternallySupplied=!0):this.doorbellService=new a.Service.Doorbell(null!==(i=null===(r=this.doorbellOptions)||void 0===r?void 0:r.name)&&void 0!==i?i:"",""),this.doorbellService.setPrimaryService();var n=e.prototype.constructServices.call(this);return this.doorbellServiceExternallySupplied||(n.doorbell=this.doorbellService),n},t.prototype.initWithServices=function(t){var r,i,n,o=e.prototype._initWithServices.call(this,t);if((null===(r=this.doorbellOptions)||void 0===r?void 0:r.externalDoorbellService)?(this.doorbellService=this.doorbellOptions.externalDoorbellService,this.doorbellServiceExternallySupplied=!0,o.serviceMap.doorbell&&(delete o.serviceMap.doorbell,o.updated=!0)):(this.doorbellService=o.serviceMap.doorbell,this.doorbellService||(this.doorbellService=new a.Service.Doorbell(null!==(n=null===(i=this.doorbellOptions)||void 0===i?void 0:i.name)&&void 0!==n?n:"",""),o.serviceMap.doorbell=this.doorbellService,o.updated=!0)),this.doorbellService.setPrimaryService(),o.updated)return o.serviceMap},t.prototype.migrateFromDoorbell=function(e){return!1},t.prototype.retrieveEventTriggerOptions=function(){var t=e.prototype.retrieveEventTriggerOptions.call(this);return t.add(2),t},t.prototype.handleControllerRemoved=function(){e.prototype.handleControllerRemoved.call(this),this.doorbellService=void 0},t.prototype.configureServices=function(){e.prototype.configureServices.call(this),this.doorbellService.getCharacteristic(n.Characteristic.ProgrammableSwitchEvent).onGet((function(){return null})),this.doorbellOptions=void 0},t}(r(2405).CameraController);t.DoorbellController=o},9352:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SiriAudioSession=t.SiriAudioSessionEvents=t.HomeKitRemoteController=t.RemoteController=t.RemoteControllerEvents=t.TargetUpdates=t.AudioCodecTypes=t.ButtonState=t.TargetCategory=t.ButtonType=void 0;var i,n,a,o,s,c,u,l,h,d,p,f,v,g=r(1635),m=g.__importDefault(r(2613)),y=g.__importDefault(r(5753)),C=r(4434),S=r(9826),E=r(9948),_=r(5876),T=g.__importStar(r(3314)),A=(0,y.default)("HAP-NodeJS:Remote:Controller");!function(e){e[e.MAXIMUM_TARGETS=1]="MAXIMUM_TARGETS",e[e.TICKS_PER_SECOND=2]="TICKS_PER_SECOND",e[e.SUPPORTED_BUTTON_CONFIGURATION=3]="SUPPORTED_BUTTON_CONFIGURATION",e[e.TYPE=4]="TYPE"}(i||(i={})),function(e){e[e.BUTTON_ID=1]="BUTTON_ID",e[e.BUTTON_TYPE=2]="BUTTON_TYPE"}(n||(n={})),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.MENU=1]="MENU",e[e.PLAY_PAUSE=2]="PLAY_PAUSE",e[e.TV_HOME=3]="TV_HOME",e[e.SELECT=4]="SELECT",e[e.ARROW_UP=5]="ARROW_UP",e[e.ARROW_RIGHT=6]="ARROW_RIGHT",e[e.ARROW_DOWN=7]="ARROW_DOWN",e[e.ARROW_LEFT=8]="ARROW_LEFT",e[e.VOLUME_UP=9]="VOLUME_UP",e[e.VOLUME_DOWN=10]="VOLUME_DOWN",e[e.SIRI=11]="SIRI",e[e.POWER=12]="POWER",e[e.GENERIC=13]="GENERIC"}(a=t.ButtonType||(t.ButtonType={})),function(e){e[e.OPERATION=1]="OPERATION",e[e.TARGET_CONFIGURATION=2]="TARGET_CONFIGURATION"}(o||(o={})),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.LIST=1]="LIST",e[e.ADD=2]="ADD",e[e.REMOVE=3]="REMOVE",e[e.RESET=4]="RESET",e[e.UPDATE=5]="UPDATE"}(s||(s={})),function(e){e[e.TARGET_IDENTIFIER=1]="TARGET_IDENTIFIER",e[e.TARGET_NAME=2]="TARGET_NAME",e[e.TARGET_CATEGORY=3]="TARGET_CATEGORY",e[e.BUTTON_CONFIGURATION=4]="BUTTON_CONFIGURATION"}(c||(c={})),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.APPLE_TV=24]="APPLE_TV"}(t.TargetCategory||(t.TargetCategory={})),function(e){e[e.BUTTON_ID=1]="BUTTON_ID",e[e.BUTTON_TYPE=2]="BUTTON_TYPE",e[e.BUTTON_NAME=3]="BUTTON_NAME"}(u||(u={})),function(e){e[e.BUTTON_ID=1]="BUTTON_ID",e[e.BUTTON_STATE=2]="BUTTON_STATE",e[e.TIMESTAMP=3]="TIMESTAMP",e[e.ACTIVE_IDENTIFIER=4]="ACTIVE_IDENTIFIER"}(l||(l={})),function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN"}(t.ButtonState||(t.ButtonState={})),function(e){e[e.SELECTED_AUDIO_INPUT_STREAM_CONFIGURATION=1]="SELECTED_AUDIO_INPUT_STREAM_CONFIGURATION"}(h||(h={})),function(e){e[e.AUDIO_CODEC_CONFIGURATION=1]="AUDIO_CODEC_CONFIGURATION",e[e.COMFORT_NOISE_SUPPORT=2]="COMFORT_NOISE_SUPPORT"}(d||(d={})),function(e){e[e.CODEC_TYPE=1]="CODEC_TYPE",e[e.CODEC_PARAMETERS=2]="CODEC_PARAMETERS"}(p||(p={})),function(e){e[e.PCMU=0]="PCMU",e[e.PCMA=1]="PCMA",e[e.AAC_ELD=2]="AAC_ELD",e[e.OPUS=3]="OPUS",e[e.MSBC=4]="MSBC",e[e.AMR=5]="AMR",e[e.AMR_WB=6]="AMR_WB"}(t.AudioCodecTypes||(t.AudioCodecTypes={})),function(e){e[e.CHANNEL=1]="CHANNEL",e[e.BIT_RATE=2]="BIT_RATE",e[e.SAMPLE_RATE=3]="SAMPLE_RATE",e[e.PACKET_TIME=4]="PACKET_TIME"}(f||(f={})),function(e){e[e.STARTING=0]="STARTING",e[e.SENDING=1]="SENDING",e[e.CLOSING=2]="CLOSING",e[e.CLOSED=3]="CLOSED"}(v||(v={})),function(e){e[e.NAME=0]="NAME",e[e.CATEGORY=1]="CATEGORY",e[e.UPDATED_BUTTONS=2]="UPDATED_BUTTONS",e[e.REMOVED_BUTTONS=3]="REMOVED_BUTTONS"}(t.TargetUpdates||(t.TargetUpdates={})),function(e){e.ACTIVE_CHANGE="active-change",e.ACTIVE_IDENTIFIER_CHANGE="active-identifier-change",e.TARGET_ADDED="target-add",e.TARGET_UPDATED="target-update",e.TARGET_REMOVED="target-remove",e.TARGETS_RESET="targets-reset"}(t.RemoteControllerEvents||(t.RemoteControllerEvents={}));var I=function(e){function t(r,i){var n=e.call(this)||this;n.buttons={},n.targetConfigurations=new Map,n.targetConfigurationsString="",n.lastButtonEvent="",n.activeIdentifier=0,n.dataStreamConnections=new Map,n.audioSupported=void 0!==r,n.audioProducerConstructor=r,n.audioProducerOptions=i;var a=n.constructSupportedConfiguration();n.supportedConfiguration=n.buildTargetControlSupportedConfigurationTLV(a);var o=n.constructSupportedAudioConfiguration();return n.supportedAudioConfiguration=t.buildSupportedAudioConfigurationTLV(o),n.selectedAudioConfiguration={codecType:3,parameters:{channels:1,bitrate:0,samplerate:1,rtpTime:20}},n.selectedAudioConfigurationString=t.buildSelectedAudioConfigurationTLV({audioCodecConfiguration:n.selectedAudioConfiguration}),n}return g.__extends(t,e),t.prototype.controllerId=function(){return"remote"},t.prototype.setActiveIdentifier=function(e){var t=this;if(e!==this.activeIdentifier){if(0!==e&&!this.targetConfigurations.has(e))throw Error("Tried setting unconfigured targetIdentifier to active");A("%d is now the active target",e),this.activeIdentifier=e,this.targetControlService.getCharacteristic(S.Characteristic.ActiveIdentifier).updateValue(e),this.activeAudioSession&&this.handleSiriAudioStop(),setTimeout((function(){return t.emit("active-identifier-change",e)}),0),this.setInactive()}},t.prototype.isActive=function(){return!!this.activeConnection},t.prototype.isConfigured=function(e){return this.targetConfigurations.has(e)},t.prototype.getTargetIdentifierByName=function(e){var t,r;try{for(var i=g.__values(Object.entries(this.targetConfigurations)),n=i.next();!n.done;n=i.next()){var a=g.__read(n.value,2),o=a[0];if(a[1].targetName===e)return parseInt(o,10)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}},t.prototype.pushButton=function(e){this.sendButtonEvent(e,1)},t.prototype.releaseButton=function(e){this.sendButtonEvent(e,0)},t.prototype.pushAndReleaseButton=function(e,t){var r=this;void 0===t&&(t=200),this.pushButton(e),setTimeout((function(){return r.releaseButton(e)}),t)},t.prototype.addServicesToAccessory=function(e){e.configureController(this)},t.prototype.constructSupportedConfiguration=function(){var e=this,t={maximumTargets:10,ticksPerSecond:1e3,supportedButtonConfiguration:[],hardwareImplemented:this.audioSupported},r=[1,2,3,4,5,6,7,8,9,10,12,13];return this.audioSupported&&r.push(11),r.forEach((function(r){var i={buttonID:100+r,buttonType:r};t.supportedButtonConfiguration.push(i),e.buttons[r]=i.buttonID})),t},t.prototype.constructSupportedAudioConfiguration=function(){return{audioCodecConfiguration:{codecType:3,parameters:{channels:1,bitrate:0,samplerate:1}}}},t.prototype.handleTargetControlWrite=function(e,t){var r,i=Buffer.from(e,"base64"),n=T.decode(i),a=n[1][0],o=void 0;switch(n[2]&&(o=this.parseTargetConfigurationTLV(n[2])),A("Received TargetControl write operation %s",s[a]),a){case s.ADD:r=this.handleAddTarget.bind(this);break;case s.UPDATE:r=this.handleUpdateTarget.bind(this);break;case s.REMOVE:r=this.handleRemoveTarget.bind(this);break;case s.RESET:r=this.handleResetTargets.bind(this);break;case s.LIST:r=this.handleListTargets.bind(this);break;default:return void t(-70410,void 0)}var c=r(o);0===c?(t(void 0,this.targetConfigurationsString),a===s.ADD&&0===this.activeIdentifier&&this.setActiveIdentifier(o.targetIdentifier)):t(new Error(c+""))},t.prototype.handleAddTarget=function(e){var t=this;return e?(this.targetConfigurations.set(e.targetIdentifier,e),A("Configured new target '"+e.targetName+"' with targetIdentifier '"+e.targetIdentifier+"'"),setTimeout((function(){return t.emit("target-add",e)}),0),this.updatedTargetConfiguration(),0):-70410},t.prototype.handleUpdateTarget=function(e){var t,r,i=this;if(!e)return-70410;var n=[],a=this.targetConfigurations.get(e.targetIdentifier);if(!a)return-70410;if(e.targetName&&(A("Target name was updated '%s' => '%s' (%d)",a.targetName,e.targetName,a.targetIdentifier),a.targetName=e.targetName,n.push(0)),e.targetCategory&&(A("Target category was updated '%d' => '%d' for target '%s' (%d)",a.targetCategory,e.targetCategory,a.targetName,a.targetIdentifier),a.targetCategory=e.targetCategory,n.push(1)),e.buttonConfiguration){A("%d button configurations were updated for target '%s' (%d)",Object.keys(e.buttonConfiguration).length,a.targetName,a.targetIdentifier);try{for(var o=g.__values(Object.values(e.buttonConfiguration)),s=o.next();!s.done;s=o.next()){var c=s.value,u=a.buttonConfiguration[c.buttonID];u.buttonType=c.buttonType,u.buttonName=c.buttonName}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}n.push(2)}return setTimeout((function(){return i.emit("target-update",e,n)}),0),this.updatedTargetConfiguration(),0},t.prototype.handleRemoveTarget=function(e){var t=this;if(!e)return-70410;var r=this.targetConfigurations.get(e.targetIdentifier);if(!r)return-70410;if(e.buttonConfiguration){for(var i in e.buttonConfiguration)Object.prototype.hasOwnProperty.call(e.buttonConfiguration,i)&&delete r.buttonConfiguration[i];A("Removed %d button configurations of target '%s' (%d)",Object.keys(e.buttonConfiguration).length,r.targetName,r.targetIdentifier),setTimeout((function(){return t.emit("target-update",r,[3])}),0)}else{this.targetConfigurations.delete(e.targetIdentifier),A("Target '%s' (%d) was removed",r.targetName,r.targetIdentifier),setTimeout((function(){return t.emit("target-remove",e.targetIdentifier)}),0);var n=Object.keys(this.targetConfigurations);this.setActiveIdentifier(0===n.length?0:parseInt(n[0],10))}return this.updatedTargetConfiguration(),0},t.prototype.handleResetTargets=function(e){var t=this;return e?-70410:(A("Resetting all target configurations"),this.targetConfigurations=new Map,this.updatedTargetConfiguration(),setTimeout((function(){return t.emit("targets-reset")}),0),this.setActiveIdentifier(0),0)},t.prototype.handleListTargets=function(e){return e?-70410:(A("Returning "+Object.keys(this.targetConfigurations).length+" target configurations"),0)},t.prototype.handleActiveWrite=function(e,t,r){if(0===this.activeIdentifier)return A("Tried to change active state. There is no active target set though"),void t(-70410);this.activeConnection&&(this.activeConnection.removeListener("closed",this.activeConnectionDisconnectListener),this.activeConnection=void 0,this.activeConnectionDisconnectListener=void 0),this.activeConnection=e?r:void 0,this.activeConnection&&(this.activeConnectionDisconnectListener=this.handleActiveSessionDisconnected.bind(this,this.activeConnection),this.activeConnection.on("closed",this.activeConnectionDisconnectListener));var i=this.targetConfigurations.get(this.activeIdentifier);i?(A("Remote with activeTarget '%s' (%d) was set to %s",i.targetName,this.activeIdentifier,e?"ACTIVE":"INACTIVE"),t(),this.emit("active-change",e)):t(-70410)},t.prototype.setInactive=function(){var e=this;void 0!==this.activeConnection&&(this.activeConnection.removeListener("closed",this.activeConnectionDisconnectListener),this.activeConnection=void 0,this.activeConnectionDisconnectListener=void 0,this.targetControlService.getCharacteristic(S.Characteristic.Active).updateValue(!1),A("Remote was set to INACTIVE"),setTimeout((function(){return e.emit("active-change",!1)}),0))},t.prototype.handleActiveSessionDisconnected=function(e){e===this.activeConnection&&(A("Active hap session disconnected!"),this.setInactive())},t.prototype.sendButtonEvent=function(e,t){var r=this.buttons[e];if(void 0===r||0===r)throw new Error("Tried sending button event for unsupported button ("+e+")");if(0===this.activeIdentifier)throw new Error("Tried sending button event although no target was selected");if(!this.isActive())throw new Error("Tried sending button event although target was not marked as active");if(11===e&&this.audioSupported)1===t?this.handleSiriAudioStart():0===t&&this.handleSiriAudioStop();else{var i=T.encode(1,r),n=T.encode(2,t),a=T.encode(3,T.writeVariableUIntLE((new Date).getTime())),o=T.encode(4,T.writeUInt32(this.activeIdentifier));this.lastButtonEvent=Buffer.concat([i,n,a,o]).toString("base64"),this.targetControlService.getCharacteristic(S.Characteristic.ButtonEvent).sendEventNotification(this.lastButtonEvent)}},t.prototype.parseTargetConfigurationTLV=function(e){var t=T.decode(e),r=T.readUInt32(t[1]),i=void 0;t[2]&&(i=t[2].toString());var n=void 0;t[3]&&(n=T.readUInt16(t[3]));var o={};t[4]&&T.decodeList(t[4],1).forEach((function(e){var t,r=e[1][0],i=T.readUInt16(e[2]);t=e[3]?e[3].toString():a[i],o[r]={buttonID:r,buttonType:i,buttonName:t}}));return{targetIdentifier:r,targetName:i,targetCategory:n,buttonConfiguration:o}},t.prototype.updatedTargetConfiguration=function(){var e,t,r,i,n,a=[];try{for(var o=g.__values(Object.values(this.targetConfigurations)),s=o.next();!s.done;s=o.next()){var c=s.value,u=T.encode(1,T.writeUInt32(c.targetIdentifier)),l=T.encode(2,c.targetName),h=T.encode(3,T.writeUInt16(c.targetCategory)),d=[];try{for(var p=(r=void 0,g.__values(c.buttonConfiguration.values())),f=p.next();!f.done;f=p.next()){var v=f.value,m=T.encode(1,v.buttonID,2,T.writeUInt16(v.buttonType));v.buttonName&&(m=Buffer.concat([m,T.encode(3,v.buttonName)])),d.push(m)}}catch(e){r={error:e}}finally{try{f&&!f.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}var y=T.encode(4,Buffer.concat(d)),C=Buffer.concat([u,l,h,y]);a.push(T.encode(2,C))}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}this.targetConfigurationsString=Buffer.concat(a).toString("base64"),null===(n=this.stateChangeDelegate)||void 0===n||n.call(this)},t.prototype.buildTargetControlSupportedConfigurationTLV=function(e){var t=T.encode(1,e.maximumTargets),r=T.encode(2,T.writeVariableUIntLE(e.ticksPerSecond)),i=[];e.supportedButtonConfiguration.forEach((function(e){var t=T.encode(1,e.buttonID,2,T.writeUInt16(e.buttonType));i.push(t)}));var n=T.encode(3,Buffer.concat(i)),a=T.encode(4,e.hardwareImplemented?1:0);return Buffer.concat([t,r,n,a]).toString("base64")},t.prototype.handleTargetControlWhoAmI=function(e,t){var r=t.identifier;this.dataStreamConnections.set(r,e),A("Discovered HDS connection for targetIdentifier %s",r),e.addProtocolHandler("dataSend",this)},t.prototype.handleSiriAudioStart=function(){if(!this.audioSupported)throw new Error("Cannot start siri stream on remote where siri is not supported");if(this.isActive())if(!this.activeAudioSession||this.activeAudioSession.isClosing()&&!this.nextAudioSession){var e=this.dataStreamConnections.get(this.activeIdentifier);if(void 0!==e){var t=new w(e,this.selectedAudioConfiguration,this.audioProducerConstructor,this.audioProducerOptions);this.activeAudioSession?this.nextAudioSession=t:this.activeAudioSession=t,t.on("close",this.handleSiriAudioSessionClosed.bind(this,t)),t.start()}else A("Tried opening Siri audio stream however target is not connected via HDS")}else A("Tried opening Siri audio stream, however there is already one in progress");else A("Tried opening Siri audio stream, however no controller is connected!")},t.prototype.handleSiriAudioStop=function(){if(this.activeAudioSession){if(!this.activeAudioSession.isClosing())return void this.activeAudioSession.stop();if(this.nextAudioSession&&!this.nextAudioSession.isClosing())return void this.nextAudioSession.stop()}A("handleSiriAudioStop called although no audio session was started")},t.prototype.handleDataSendAckEvent=function(e){var t=e.streamId,r=e.endOfStream;this.activeAudioSession&&this.activeAudioSession.streamId===t?this.activeAudioSession.handleDataSendAckEvent(r):this.nextAudioSession&&this.nextAudioSession.streamId===t?this.nextAudioSession.handleDataSendAckEvent(r):A("Received dataSend acknowledgment event for unknown streamId '%s'",t)},t.prototype.handleDataSendCloseEvent=function(e){var t=e.streamId,r=e.reason;this.activeAudioSession&&this.activeAudioSession.streamId===t?this.activeAudioSession.handleDataSendCloseEvent(r):this.nextAudioSession&&this.nextAudioSession.streamId===t?this.nextAudioSession.handleDataSendCloseEvent(r):A("Received dataSend close event for unknown streamId '%s'",t)},t.prototype.handleSiriAudioSessionClosed=function(e){e===this.activeAudioSession?(this.activeAudioSession=this.nextAudioSession,this.nextAudioSession=void 0):e===this.nextAudioSession&&(this.nextAudioSession=void 0)},t.prototype.handleDataStreamConnectionClosed=function(e){var t,r;try{for(var i=g.__values(this.dataStreamConnections),n=i.next();!n.done;n=i.next()){var a=g.__read(n.value,2),o=a[0];if(e===a[1]){A("HDS connection disconnected for targetIdentifier %s",o),this.dataStreamConnections.delete(o);break}}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}},t.prototype.handleSelectedAudioConfigurationWrite=function(e,r){var i=Buffer.from(e,"base64"),n=T.decode(i),a=T.decode(n[1]),o=a[1][0],s=T.decode(a[2]),c=s[1][0],u=s[2][0],l=s[3][0];this.selectedAudioConfiguration={codecType:o,parameters:{channels:c,bitrate:u,samplerate:l,rtpTime:20}},this.selectedAudioConfigurationString=t.buildSelectedAudioConfigurationTLV({audioCodecConfiguration:this.selectedAudioConfiguration}),r()},t.buildSupportedAudioConfigurationTLV=function(e){var r=t.buildCodecConfigurationTLV(e.audioCodecConfiguration);return T.encode(1,r).toString("base64")},t.buildSelectedAudioConfigurationTLV=function(e){var r=t.buildCodecConfigurationTLV(e.audioCodecConfiguration);return T.encode(1,r).toString("base64")},t.buildCodecConfigurationTLV=function(e){var t=e.parameters,r=T.encode(1,t.channels,2,t.bitrate,3,t.samplerate);return t.rtpTime&&(r=Buffer.concat([r,T.encode(4,t.rtpTime)])),T.encode(1,e.codecType,2,r)},t.prototype.constructServices=function(){var e;return this.targetControlManagementService=new _.Service.TargetControlManagement("",""),this.targetControlManagementService.setCharacteristic(S.Characteristic.TargetControlSupportedConfiguration,this.supportedConfiguration),this.targetControlManagementService.setCharacteristic(S.Characteristic.TargetControlList,this.targetConfigurationsString),this.targetControlManagementService.setPrimaryService(),this.targetControlService=new _.Service.TargetControl("",""),this.targetControlService.setCharacteristic(S.Characteristic.ActiveIdentifier,0),this.targetControlService.setCharacteristic(S.Characteristic.Active,!1),this.targetControlService.setCharacteristic(S.Characteristic.ButtonEvent,this.lastButtonEvent),this.audioSupported&&(this.siriService=new _.Service.Siri("",""),this.siriService.setCharacteristic(S.Characteristic.SiriInputType,S.Characteristic.SiriInputType.PUSH_BUTTON_TRIGGERED_APPLE_TV),this.audioStreamManagementService=new _.Service.AudioStreamManagement("",""),this.audioStreamManagementService.setCharacteristic(S.Characteristic.SupportedAudioStreamConfiguration,this.supportedAudioConfiguration),this.audioStreamManagementService.setCharacteristic(S.Characteristic.SelectedAudioStreamConfiguration,this.selectedAudioConfigurationString),this.dataStreamManagement=new E.DataStreamManagement,this.siriService.addLinkedService(this.dataStreamManagement.getService()),this.siriService.addLinkedService(this.audioStreamManagementService)),{targetControlManagement:this.targetControlManagementService,targetControl:this.targetControlService,siri:this.siriService,audioStreamManagement:this.audioStreamManagementService,dataStreamTransportManagement:null===(e=this.dataStreamManagement)||void 0===e?void 0:e.getService()}},t.prototype.initWithServices=function(e){this.targetControlManagementService=e.targetControlManagement,this.targetControlService=e.targetControl,this.siriService=e.siri,this.audioStreamManagementService=e.audioStreamManagement,this.dataStreamManagement=new E.DataStreamManagement(e.dataStreamTransportManagement)},t.prototype.configureServices=function(){var e,t=this;if(!this.targetControlManagementService||!this.targetControlService)throw new Error("Unexpected state: Services not configured!");this.targetControlManagementService.getCharacteristic(S.Characteristic.TargetControlList).on("get",(function(e){e(null,t.targetConfigurationsString)})).on("set",this.handleTargetControlWrite.bind(this)),this.targetControlService.getCharacteristic(S.Characteristic.ActiveIdentifier).on("get",(function(e){e(void 0,t.activeIdentifier)})),this.targetControlService.getCharacteristic(S.Characteristic.Active).on("get",(function(e){e(void 0,t.isActive())})).on("set",(function(e,r,i,n){if(!n)return A("Set event handler for Remote.Active cannot be called from plugin. Connection undefined!"),void r(-70410);t.handleActiveWrite(e,r,n)})),this.targetControlService.getCharacteristic(S.Characteristic.ButtonEvent).on("get",(function(e){e(void 0,t.lastButtonEvent)})),this.audioSupported&&(this.audioStreamManagementService.getCharacteristic(S.Characteristic.SelectedAudioStreamConfiguration).on("get",(function(e){e(null,t.selectedAudioConfigurationString)})).on("set",this.handleSelectedAudioConfigurationWrite.bind(this)).updateValue(this.selectedAudioConfigurationString),this.dataStreamManagement.onEventMessage("targetControl","whoami",this.handleTargetControlWhoAmI.bind(this)).onServerEvent("connection-closed",this.handleDataStreamConnectionClosed.bind(this)),this.eventHandler=((e={}).ack=this.handleDataSendAckEvent.bind(this),e.close=this.handleDataSendCloseEvent.bind(this),e))},t.prototype.handleControllerRemoved=function(){var e;this.targetControlManagementService=void 0,this.targetControlService=void 0,this.siriService=void 0,this.audioStreamManagementService=void 0,this.eventHandler=void 0,this.requestHandler=void 0,null===(e=this.dataStreamManagement)||void 0===e||e.destroy(),this.dataStreamManagement=void 0},t.prototype.handleFactoryReset=function(){A("Running factory reset. Resetting targets..."),this.handleResetTargets(void 0),this.lastButtonEvent=""},t.prototype.serialize=function(){if(this.activeIdentifier||0!==Object.keys(this.targetConfigurations).length)return{activeIdentifier:this.activeIdentifier,targetConfigurations:g.__spreadArray([],g.__read(this.targetConfigurations),!1).reduce((function(e,t){var r=g.__read(t,2),i=r[0],n=r[1];return e[i]=n,e}),{})}},t.prototype.deserialize=function(e){this.activeIdentifier=e.activeIdentifier,this.targetConfigurations=Object.entries(e.targetConfigurations).reduce((function(e,t){var r=g.__read(t,2),i=r[0],n=r[1],a=parseInt(i,10);return e.set(a,n),e}),new Map),this.updatedTargetConfiguration()},t.prototype.setupStateChangeDelegate=function(e){this.stateChangeDelegate=e},t}(C.EventEmitter);t.RemoteController=I;var D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return g.__extends(t,e),t}(I);t.HomeKitRemoteController=D,function(e){e.CLOSE="close"}(t.SiriAudioSessionEvents||(t.SiriAudioSessionEvents={}));var w=function(e){function t(t,r,i,n){var a=e.call(this)||this;return a.producerRunning=!1,a.state=0,a.endOfStream=!1,a.audioFrameQueue=[],a.maxQueueSize=1024,a.sequenceNumber=0,a.connection=t,a.selectedAudioConfiguration=r,a.producer=new i(a.handleSiriAudioFrame.bind(a),a.handleProducerError.bind(a),n),a.connection.on("closed",a.closeListener=a.handleDataStreamConnectionClosed.bind(a)),a}return g.__extends(t,e),t.prototype.start=function(){var e=this;A("Sending request to start siri audio stream"),this.connection.sendRequest("dataSend","open",{target:"controller",type:"audio.siri"},(function(t,r,i){3!==e.state?(m.default.strictEqual(e.state,0),e.state=1,t||r?(t?A("Error occurred trying to start siri audio stream: %s",t.message):r&&A("Controller responded with non-zero status code: %s",E.HDSStatus[r]),e.closed()):(e.streamId=i.streamId,e.producerRunning?A("Successfully setup siri audio stream with streamId %d",e.streamId):e.sendDataSendCloseEvent(3))):A("Ignoring dataSend open response as the session is already closed")})),this.startAudioProducer()},t.prototype.isClosing=function(){return this.state>=2},t.prototype.stop=function(){(0,m.default)(this.state<=1,"state was higher than SENDING"),A("Stopping siri audio stream with streamId %d",this.streamId),this.endOfStream=!0,this.stopAudioProducer(),1===this.state?(this.handleSiriAudioFrame(void 0),this.state=2):this.closed()},t.prototype.startAudioProducer=function(){var e=this;this.producer.startAudioProduction(this.selectedAudioConfiguration),this.producerRunning=!0,this.producerTimer=setTimeout((function(){A("Didn't receive any frames from audio producer for stream with streamId %s. Canceling the stream now.",e.streamId),e.producerTimer=void 0,e.handleProducerError(3)}),3e3),this.producerTimer.unref()},t.prototype.stopAudioProducer=function(){this.producer.stopAudioProduction(),this.producerRunning=!1,this.producerTimer&&(clearTimeout(this.producerTimer),this.producerTimer=void 0)},t.prototype.handleSiriAudioFrame=function(e){var t=this;if(!(this.state>=2)&&(this.producerTimer&&(clearTimeout(this.producerTimer),this.producerTimer=void 0),e&&this.audioFrameQueue.length<this.maxQueueSize&&this.audioFrameQueue.push(e),1===this.state))for(var r,i=function(){var e=[];r.forEach((function(r){var i={data:r.data,metadata:{rms:new E.Float32(r.rms),sequenceNumber:new E.Int64(t.sequenceNumber++)}};e.push(i)}));var i={packets:e,streamId:new E.Int64(n.streamId),endOfStream:n.endOfStream};try{n.connection.sendEvent("dataSend","data",i)}catch(e){A("Error occurred when trying to send audio frame of hds connection: %s",e.message),n.stopAudioProducer(),n.closed()}if(n.endOfStream)return"break"},n=this;null!==(r=this.popSome());){if("break"===i())break}},t.prototype.handleProducerError=function(e){this.state>=2||(this.stopAudioProducer(),1===this.state&&this.sendDataSendCloseEvent(e))},t.prototype.handleDataSendAckEvent=function(e){m.default.strictEqual(e,!0),A("Received acknowledgment for siri audio stream with streamId %s, closing it now",this.streamId),this.sendDataSendCloseEvent(0)},t.prototype.handleDataSendCloseEvent=function(e){A("Received close event from controller with reason %s for stream with streamId %s",E.HDSProtocolSpecificErrorReason[e],this.streamId),this.state<=1&&this.stopAudioProducer(),this.closed()},t.prototype.sendDataSendCloseEvent=function(e){(0,m.default)(this.state>=1,"state was less than SENDING"),(0,m.default)(this.state<=2,"state was higher than CLOSING"),this.connection.sendEvent("dataSend","close",{streamId:new E.Int64(this.streamId),reason:new E.Int64(e)}),this.closed()},t.prototype.handleDataStreamConnectionClosed=function(){A("Closing audio session with streamId %d",this.streamId),this.state<=1&&this.stopAudioProducer(),this.closed()},t.prototype.closed=function(){var e=this.state;this.state=3,3!==e&&(this.emit("close"),this.connection.removeListener("closed",this.closeListener)),this.removeAllListeners()},t.prototype.popSome=function(){if(this.audioFrameQueue.length<5&&!this.endOfStream)return null;for(var e=Math.min(this.audioFrameQueue.length,5),t=[],r=0;r<e;r++){var i=this.audioFrameQueue.shift();t.push(i)}return t},t}(C.EventEmitter);t.SiriAudioSession=w},1068:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(1635);i.__exportStar(r(9414),t),i.__exportStar(r(6864),t),i.__exportStar(r(9352),t),i.__exportStar(r(2405),t),i.__exportStar(r(7959),t)},733:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataStreamManagement=t.DataStreamStatus=void 0;var i,n,a,o,s,c,u,l=r(1635),h=l.__importDefault(r(5753)),d=r(9826),p=r(5876),f=l.__importStar(r(3314)),v=r(4097),g=(0,h.default)("HAP-NodeJS:DataStream:Management");!function(e){e[e.TRANSFER_TRANSPORT_CONFIGURATION=1]="TRANSFER_TRANSPORT_CONFIGURATION"}(i||(i={})),function(e){e[e.TRANSPORT_TYPE=1]="TRANSPORT_TYPE"}(n||(n={})),function(e){e[e.SESSION_COMMAND_TYPE=1]="SESSION_COMMAND_TYPE",e[e.TRANSPORT_TYPE=2]="TRANSPORT_TYPE",e[e.CONTROLLER_KEY_SALT=3]="CONTROLLER_KEY_SALT"}(a||(a={})),function(e){e[e.STATUS=1]="STATUS",e[e.TRANSPORT_TYPE_SESSION_PARAMETERS=2]="TRANSPORT_TYPE_SESSION_PARAMETERS",e[e.ACCESSORY_KEY_SALT=3]="ACCESSORY_KEY_SALT"}(o||(o={})),function(e){e[e.TCP_LISTENING_PORT=1]="TCP_LISTENING_PORT"}(s||(s={})),function(e){e[e.HOMEKIT_DATA_STREAM=0]="HOMEKIT_DATA_STREAM"}(c||(c={})),function(e){e[e.START_SESSION=0]="START_SESSION"}(u||(u={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.GENERIC_ERROR=1]="GENERIC_ERROR",e[e.BUSY=2]="BUSY"}(t.DataStreamStatus||(t.DataStreamStatus={}));var m=function(){function e(e){this.dataStreamServer=new v.DataStreamServer,this.lastSetupDataStreamTransportResponse="";var t=[c.HOMEKIT_DATA_STREAM];this.supportedDataStreamTransportConfiguration=this.buildSupportedDataStreamTransportConfigurationTLV(t),this.dataStreamTransportManagementService=e||this.constructService(),this.setupServiceHandlers()}return e.prototype.destroy=function(){this.dataStreamServer.destroy(),this.dataStreamTransportManagementService.getCharacteristic(d.Characteristic.SetupDataStreamTransport).removeOnGet().removeAllListeners("set"),this.lastSetupDataStreamTransportResponse=""},e.prototype.getService=function(){return this.dataStreamTransportManagementService},e.prototype.onEventMessage=function(e,t,r){return this.dataStreamServer.onEventMessage(e,t,r),this},e.prototype.removeEventHandler=function(e,t,r){return this.dataStreamServer.removeEventHandler(e,t,r),this},e.prototype.onRequestMessage=function(e,t,r){return this.dataStreamServer.onRequestMessage(e,t,r),this},e.prototype.removeRequestHandler=function(e,t,r){return this.dataStreamServer.removeRequestHandler(e,t,r),this},e.prototype.onServerEvent=function(e,t){return this.dataStreamServer.on(e,t),this},e.prototype.handleSetupDataStreamTransportWrite=function(e,t,r){var i=this,n=Buffer.from(e,"base64"),a=f.decode(n),o=a[1][0],s=a[2][0],l=a[3];g("Received setup write with command %s and transport type %s",u[o],c[s]),o===u.START_SESSION&&s===c.HOMEKIT_DATA_STREAM&&32===l.length?this.dataStreamServer.prepareSession(r,l,(function(e,r){if(!e&&r){var n=f.encode(1,f.writeUInt16(r.port)),a=Buffer.concat([f.encode(1,0),f.encode(2,n)]);i.lastSetupDataStreamTransportResponse=a.toString("base64"),a=Buffer.concat([a,f.encode(3,r.accessoryKeySalt)]),t(null,a.toString("base64"))}else t(null!=e?e:new Error("PreparedSession was undefined!"))})):t(-70410)},e.prototype.buildSupportedDataStreamTransportConfigurationTLV=function(e){var t=[];return e.forEach((function(e){var r=f.encode(1,e),i=f.encode(1,r);t.push(i)})),Buffer.concat(t).toString("base64")},e.prototype.constructService=function(){var e=new p.Service.DataStreamTransportManagement("","");return e.setCharacteristic(d.Characteristic.SupportedDataStreamTransportConfiguration,this.supportedDataStreamTransportConfiguration),e.setCharacteristic(d.Characteristic.Version,v.DataStreamServer.version),e},e.prototype.setupServiceHandlers=function(){var e=this;this.dataStreamTransportManagementService.getCharacteristic(d.Characteristic.SetupDataStreamTransport).onGet((function(){return e.lastSetupDataStreamTransportResponse})).on("set",(function(t,r,i,n){if(!n)return g("Set event handler for SetupDataStreamTransport cannot be called from plugin! Connection undefined!"),void r(-70410);e.handleSetupDataStreamTransportWrite(t,r,n)})).updateValue(this.lastSetupDataStreamTransportResponse)},e}();t.DataStreamManagement=m},7881:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataStreamWriter=t.DataStreamReader=t.DataStreamParser=t.DataFormatTags=t.UUID=t.SecondsSince2001=t.Float64=t.Float32=t.Int64=t.Int32=t.Int16=t.Int8=t.ValueWrapper=void 0;var i=r(1635),n=i.__importStar(r(2997)),a=i.__importStar(r(8)),o=i.__importDefault(r(2613)),s=(0,i.__importDefault(r(5753)).default)("HAP-NodeJS:DataStream:Parser"),c=function(){function e(){}return e.TERMINATOR={type:"terminator"},e}(),u=function(){function e(e){this.value=e}return e.prototype.equals=function(e){return this.constructor.name===e.constructor.name&&e.value===this.value},e}();t.ValueWrapper=u;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t}(u);t.Int8=l;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t}(u);t.Int16=h;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t}(u);t.Int32=d;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t}(u);t.Int64=p;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t}(u);t.Float32=f;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t}(u);t.Float64=v;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t}(u);t.SecondsSince2001=g;var m=function(e){function t(t){return(0,o.default)(n.isValid(t),"invalid uuid format"),e.call(this,t)||this}return i.__extends(t,e),t}(u);t.UUID=m,function(e){e[e.INVALID=0]="INVALID",e[e.TRUE=1]="TRUE",e[e.FALSE=2]="FALSE",e[e.TERMINATOR=3]="TERMINATOR",e[e.NULL=4]="NULL",e[e.UUID=5]="UUID",e[e.DATE=6]="DATE",e[e.INTEGER_MINUS_ONE=7]="INTEGER_MINUS_ONE",e[e.INTEGER_RANGE_START_0=8]="INTEGER_RANGE_START_0",e[e.INTEGER_RANGE_STOP_39=46]="INTEGER_RANGE_STOP_39",e[e.INT8=48]="INT8",e[e.INT16LE=49]="INT16LE",e[e.INT32LE=50]="INT32LE",e[e.INT64LE=51]="INT64LE",e[e.FLOAT32LE=53]="FLOAT32LE",e[e.FLOAT64LE=54]="FLOAT64LE",e[e.UTF8_LENGTH_START=64]="UTF8_LENGTH_START",e[e.UTF8_LENGTH_STOP=96]="UTF8_LENGTH_STOP",e[e.UTF8_LENGTH8=97]="UTF8_LENGTH8",e[e.UTF8_LENGTH16LE=98]="UTF8_LENGTH16LE",e[e.UTF8_LENGTH32LE=99]="UTF8_LENGTH32LE",e[e.UTF8_LENGTH64LE=100]="UTF8_LENGTH64LE",e[e.UTF8_NULL_TERMINATED=111]="UTF8_NULL_TERMINATED",e[e.DATA_LENGTH_START=112]="DATA_LENGTH_START",e[e.DATA_LENGTH_STOP=144]="DATA_LENGTH_STOP",e[e.DATA_LENGTH8=145]="DATA_LENGTH8",e[e.DATA_LENGTH16LE=146]="DATA_LENGTH16LE",e[e.DATA_LENGTH32LE=147]="DATA_LENGTH32LE",e[e.DATA_LENGTH64LE=148]="DATA_LENGTH64LE",e[e.DATA_TERMINATED=159]="DATA_TERMINATED",e[e.COMPRESSION_START=160]="COMPRESSION_START",e[e.COMPRESSION_STOP=207]="COMPRESSION_STOP",e[e.ARRAY_LENGTH_START=208]="ARRAY_LENGTH_START",e[e.ARRAY_LENGTH_STOP=222]="ARRAY_LENGTH_STOP",e[e.ARRAY_TERMINATED=223]="ARRAY_TERMINATED",e[e.DICTIONARY_LENGTH_START=224]="DICTIONARY_LENGTH_START",e[e.DICTIONARY_LENGTH_STOP=238]="DICTIONARY_LENGTH_STOP",e[e.DICTIONARY_TERMINATED=239]="DICTIONARY_TERMINATED"}(t.DataFormatTags||(t.DataFormatTags={}));var y=function(){function e(){}return e.decode=function(e){var t=e.readTag();if(0===t)throw new Error("HDSDecoder: zero tag detected on index "+e.readerIndex);if(1===t)return e.readTrue();if(2===t)return e.readFalse();if(3===t)return c.TERMINATOR;if(4===t)return null;if(5===t)return e.readUUID();if(6===t)return e.readSecondsSince2001_01_01();if(7===t)return e.readNegOne();if(t>=8&&t<=46)return e.readIntRange(t);if(48===t)return e.readInt8();if(49===t)return e.readInt16LE();if(50===t)return e.readInt32LE();if(51===t)return e.readInt64LE();if(53===t)return e.readFloat32LE();if(54===t)return e.readFloat64LE();if(t>=64&&t<=96){var r=t-64;return e.readUTF8(r)}if(97===t)return e.readUTF8_Length8();if(98===t)return e.readUTF8_Length16LE();if(99===t)return e.readUTF8_Length32LE();if(100===t)return e.readUTF8_Length64LE();if(111===t)return e.readUTF8_NULL_terminated();if(!(t>=112&&t<=144)){if(145===t)return e.readData_Length8();if(146===t)return e.readData_Length16LE();if(147===t)return e.readData_Length32LE();if(148===t)return e.readData_Length64LE();if(159===t)return e.readData_terminated();if(t>=160&&t<=207){var i=t-160;return e.decompressData(i)}if(t>=208&&t<=222){r=t-208;for(var n=[],a=0;a<r;a++)n.push(this.decode(e));return n}if(223===t){n=[];for(var o=void 0;(o=this.decode(e))!==c.TERMINATOR;)n.push(o);return n}if(t>=224&&t<=238){r=t-224;var s={};for(a=0;a<r;a++){s[u=this.decode(e)]=this.decode(e)}return s}if(239===t){s={};for(var u=void 0;(u=this.decode(e))!==c.TERMINATOR;)s[u]=this.decode(e);return s}throw new Error("HDSDecoder: encountered unknown tag on index "+e.readerIndex+": "+t.toString(16))}var r=t-112;e.readData(r)},e.encode=function(e,t){var r=this;if(void 0===e)throw new Error("HDSEncoder: cannot encode undefined");if(null!==e)switch(typeof e){case"boolean":e?t.writeTrue():t.writeFalse();break;case"number":Number.isInteger(e)?t.writeNumber(e):t.writeFloat64LE(new v(e));break;case"string":t.writeUTF8(e);break;case"object":if(Array.isArray(e)){var i=e.length;i<=12?t.writeTag(208+i):t.writeTag(223),e.forEach((function(e){r.encode(e,t)})),i>12&&t.writeTag(3)}else if(e instanceof u)if(e instanceof l)t.writeInt8(e);else if(e instanceof h)t.writeInt16LE(e);else if(e instanceof d)t.writeInt32LE(e);else if(e instanceof p)t.writeInt64LE(e);else if(e instanceof f)t.writeFloat32LE(e);else if(e instanceof v)t.writeFloat64LE(e);else if(e instanceof g)t.writeSecondsSince2001_01_01(e);else{if(!(e instanceof m))throw new Error("Unknown wrapped object 'ValueWrapper' of class "+e.constructor.name);t.writeUUID(e.value)}else if(e instanceof Buffer)t.writeData(e);else{var n=Object.entries(e).filter((function(e){return void 0!==e[1]}));n.length<=14?t.writeTag(224+n.length):t.writeTag(239),n.forEach((function(e){r.encode(e[0],t),r.encode(e[1],t)})),n.length>14&&t.writeTag(3)}break;default:throw new Error("HDSEncoder: no idea how to encode value of type '"+typeof e+"': "+e)}else t.writeTag(4)},e}();t.DataStreamParser=y;var C=function(){function e(e){this.trackedCompressedData=[],this.data=e,this.readerIndex=0}return e.prototype.finished=function(){if(this.readerIndex<this.data.length){var e=this.data.slice(this.readerIndex,this.data.length).toString("hex");s("WARNING Finished reading HDS stream, but there are still %d bytes remaining () %s",this.data.length-this.readerIndex,e)}},e.prototype.decompressData=function(e){if(e>=this.trackedCompressedData.length)throw new Error("HDSDecoder: Tried decompression of data for an index out of range (index "+e+" and got "+this.trackedCompressedData.length+" elements)");return this.trackedCompressedData[e]},e.prototype.trackData=function(e){return this.trackedCompressedData.push(e),e},e.prototype.ensureLength=function(e){if(this.readerIndex+e>this.data.length){var t=this.data.length-this.readerIndex;throw new Error("HDSDecoder: End of data stream. Tried reading "+e+" bytes however got only "+t+" remaining!")}},e.prototype.readTag=function(){return this.ensureLength(1),this.data.readUInt8(this.readerIndex++)},e.prototype.readTrue=function(){return this.trackData(!0)},e.prototype.readFalse=function(){return this.trackData(!1)},e.prototype.readNegOne=function(){return this.trackData(-1)},e.prototype.readIntRange=function(e){return this.trackData(e-8)},e.prototype.readInt8=function(){return this.ensureLength(1),this.trackData(this.data.readInt8(this.readerIndex++))},e.prototype.readInt16LE=function(){this.ensureLength(2);var e=this.data.readInt16LE(this.readerIndex);return this.readerIndex+=2,this.trackData(e)},e.prototype.readInt32LE=function(){this.ensureLength(4);var e=this.data.readInt32LE(this.readerIndex);return this.readerIndex+=4,this.trackData(e)},e.prototype.readInt64LE=function(){this.ensureLength(8);var e=this.data.readInt32LE(this.readerIndex),t=4294967296*this.data.readInt32LE(this.readerIndex+4)+e;return e<0&&(t+=4294967296),this.readerIndex+=8,this.trackData(t)},e.prototype.readFloat32LE=function(){this.ensureLength(4);var e=this.data.readFloatLE(this.readerIndex);return this.readerIndex+=4,this.trackData(e)},e.prototype.readFloat64LE=function(){this.ensureLength(8);var e=this.data.readDoubleLE(this.readerIndex);return this.trackData(e)},e.prototype.readLength8=function(){return this.ensureLength(1),this.data.readUInt8(this.readerIndex++)},e.prototype.readLength16LE=function(){this.ensureLength(2);var e=this.data.readUInt16LE(this.readerIndex);return this.readerIndex+=2,e},e.prototype.readLength32LE=function(){this.ensureLength(4);var e=this.data.readUInt32LE(this.readerIndex);return this.readerIndex+=4,e},e.prototype.readLength64LE=function(){this.ensureLength(8);var e=this.data.readUInt32LE(this.readerIndex),t=4294967296*this.data.readUInt32LE(this.readerIndex+4)+e;return this.readerIndex+=8,t},e.prototype.readUTF8=function(e){this.ensureLength(e);var t=this.data.toString("utf8",this.readerIndex,this.readerIndex+e);return this.readerIndex+=e,this.trackData(t)},e.prototype.readUTF8_Length8=function(){var e=this.readLength8();return this.readUTF8(e)},e.prototype.readUTF8_Length16LE=function(){var e=this.readLength16LE();return this.readUTF8(e)},e.prototype.readUTF8_Length32LE=function(){var e=this.readLength32LE();return this.readUTF8(e)},e.prototype.readUTF8_Length64LE=function(){var e=this.readLength64LE();return this.readUTF8(e)},e.prototype.readUTF8_NULL_terminated=function(){for(var e,t=this.readerIndex;;){if(void 0===(e=this.data[t]))throw new Error("HDSDecoder: Reached end of data stream while reading NUL terminated string!");if(0===e)break;t++}var r=this.data.toString("utf8",this.readerIndex,t);return this.readerIndex=t+1,this.trackData(r)},e.prototype.readData=function(e){this.ensureLength(e);var t=this.data.slice(this.readerIndex,this.readerIndex+e);return this.readerIndex+=e,this.trackData(t)},e.prototype.readData_Length8=function(){var e=this.readLength8();return this.readData(e)},e.prototype.readData_Length16LE=function(){var e=this.readLength16LE();return this.readData(e)},e.prototype.readData_Length32LE=function(){var e=this.readLength32LE();return this.readData(e)},e.prototype.readData_Length64LE=function(){var e=this.readLength64LE();return this.readData(e)},e.prototype.readData_terminated=function(){for(var e,t=this.readerIndex;;){if(void 0===(e=this.data[t]))throw new Error("HDSDecoder: Reached end of data stream while reading terminated data!");if(3===e)break;t++}var r=this.data.slice(this.readerIndex,t);return this.readerIndex=t+1,this.trackData(r)},e.prototype.readSecondsSince2001_01_01=function(){return this.readFloat64LE()},e.prototype.readUUID=function(){this.ensureLength(16);var e=n.unparse(this.data,this.readerIndex);return this.readerIndex+=16,this.trackData(e)},e}();t.DataStreamReader=C;var S=function(){function e(){this.writtenData=[]}return e.prototype.push=function(e){this.writtenData.push(e)},e.prototype.indexOf=function(e){for(var t=0;t<this.writtenData.length;t++){var r=this.writtenData[t];if(e===r)return t;if(e instanceof u&&r instanceof u&&e.equals(r))return t}return-1},e}(),E=function(){function e(){this.writtenData=new S,this.data=Buffer.alloc(e.chunkSize),this.writerIndex=0}return e.prototype.length=function(){return this.writerIndex},e.prototype.getData=function(){return this.data.slice(0,this.writerIndex)},e.prototype.ensureLength=function(t){var r=this.writerIndex+t-this.data.length;if(r>0){var i=Math.ceil(r/e.chunkSize);this.data=Buffer.concat([this.data,Buffer.alloc(i*e.chunkSize)])}},e.prototype.compressDataIfPossible=function(e){var t=this.writtenData.indexOf(e);return t<0?(this.writtenData.push(e),!1):t<=47&&(this.writeTag(160+t),!0)},e.prototype.writeTag=function(e){this.ensureLength(1),this.data.writeUInt8(e,this.writerIndex++)},e.prototype.writeTrue=function(){this.writeTag(1)},e.prototype.writeFalse=function(){this.writeTag(2)},e.prototype.writeNumber=function(e){if(-1===e)this.writeTag(7);else if(e>=0&&e<=39)this.writeTag(8+e);else if(e>=-128&&e<=127)this.writeInt8(new l(e));else if(e>=-32768&&e<=32767)this.writeInt16LE(new h(e));else if(e>=-2147483648&&e<=-2147483648)this.writeInt32LE(new d(e));else{if(!(e>=Number.MIN_SAFE_INTEGER&&e<=Number.MAX_SAFE_INTEGER))throw new Error("Tried writing unrepresentable number ("+e+")");this.writeInt64LE(new p(e))}},e.prototype.writeInt8=function(e){this.compressDataIfPossible(e)||(this.ensureLength(2),this.writeTag(48),this.data.writeInt8(e.value,this.writerIndex++))},e.prototype.writeInt16LE=function(e){this.compressDataIfPossible(e)||(this.ensureLength(3),this.writeTag(49),this.data.writeInt16LE(e.value,this.writerIndex),this.writerIndex+=2)},e.prototype.writeInt32LE=function(e){this.compressDataIfPossible(e)||(this.ensureLength(5),this.writeTag(50),this.data.writeInt32LE(e.value,this.writerIndex),this.writerIndex+=4)},e.prototype.writeInt64LE=function(e){this.compressDataIfPossible(e)||(this.ensureLength(9),this.writeTag(51),this.data.writeUInt32LE(e.value,this.writerIndex),this.data.writeUInt32LE(0,this.writerIndex+4),this.writerIndex+=8)},e.prototype.writeFloat32LE=function(e){this.compressDataIfPossible(e)||(this.ensureLength(5),this.writeTag(53),this.data.writeFloatLE(e.value,this.writerIndex),this.writerIndex+=4)},e.prototype.writeFloat64LE=function(e){this.compressDataIfPossible(e)||(this.ensureLength(9),this.writeTag(54),this.data.writeDoubleLE(e.value,this.writerIndex),this.writerIndex+=8)},e.prototype.writeLength8=function(e){this.ensureLength(1),this.data.writeUInt8(e,this.writerIndex++)},e.prototype.writeLength16LE=function(e){this.ensureLength(2),this.data.writeUInt16LE(e,this.writerIndex),this.writerIndex+=2},e.prototype.writeLength32LE=function(e){this.ensureLength(4),this.data.writeUInt32LE(e,this.writerIndex),this.writerIndex+=4},e.prototype.writeLength64LE=function(e){this.ensureLength(8),a.writeUInt64LE(e,this.data,this.writerIndex),this.writerIndex+=8},e.prototype.writeUTF8=function(e){if(!this.compressDataIfPossible(e)){var t=Buffer.byteLength(e);t<=32?(this.ensureLength(1+t),this.writeTag(64+e.length),this._writeUTF8(e)):t<=255?this.writeUTF8_Length8(e):t<=65535?this.writeUTF8_Length16LE(e):t<=4294967295?this.writeUTF8_Length32LE(e):t<=Number.MAX_SAFE_INTEGER?this.writeUTF8_Length64LE(e):this.writeUTF8_NULL_terminated(e)}},e.prototype._writeUTF8=function(e){var t=Buffer.byteLength(e);this.ensureLength(t),this.data.write(e,this.writerIndex,void 0,"utf8"),this.writerIndex+=t},e.prototype.writeUTF8_Length8=function(e){var t=Buffer.byteLength(e);this.ensureLength(2+t),this.writeTag(97),this.writeLength8(t),this._writeUTF8(e)},e.prototype.writeUTF8_Length16LE=function(e){var t=Buffer.byteLength(e);this.ensureLength(3+t),this.writeTag(98),this.writeLength16LE(t),this._writeUTF8(e)},e.prototype.writeUTF8_Length32LE=function(e){var t=Buffer.byteLength(e);this.ensureLength(5+t),this.writeTag(99),this.writeLength32LE(t),this._writeUTF8(e)},e.prototype.writeUTF8_Length64LE=function(e){var t=Buffer.byteLength(e);this.ensureLength(9+t),this.writeTag(100),this.writeLength64LE(t),this._writeUTF8(e)},e.prototype.writeUTF8_NULL_terminated=function(e){this.ensureLength(1+Buffer.byteLength(e)+1),this.writeTag(111),this._writeUTF8(e),this.data.writeUInt8(0,this.writerIndex++)},e.prototype.writeData=function(e){this.compressDataIfPossible(e)||(e.length<=32?(this.writeTag(112+e.length),this._writeData(e)):e.length<=255?this.writeData_Length8(e):e.length<=65535?this.writeData_Length16LE(e):e.length<=4294967295?this.writeData_Length32LE(e):e.length<=Number.MAX_SAFE_INTEGER?this.writeData_Length64LE(e):this.writeData_terminated(e))},e.prototype._writeData=function(e){this.ensureLength(e.length);for(var t=0;t<e.length;t++)this.data[this.writerIndex++]=e[t]},e.prototype.writeData_Length8=function(e){this.ensureLength(2+e.length),this.writeTag(145),this.writeLength8(e.length),this._writeData(e)},e.prototype.writeData_Length16LE=function(e){this.ensureLength(3+e.length),this.writeTag(146),this.writeLength16LE(e.length),this._writeData(e)},e.prototype.writeData_Length32LE=function(e){this.ensureLength(5+e.length),this.writeTag(147),this.writeLength32LE(e.length),this._writeData(e)},e.prototype.writeData_Length64LE=function(e){this.ensureLength(9+e.length),this.writeTag(148),this.writeLength64LE(e.length),this._writeData(e)},e.prototype.writeData_terminated=function(e){this.ensureLength(1+e.length+1),this.writeTag(159),this._writeData(e),this.writeTag(3)},e.prototype.writeSecondsSince2001_01_01=function(e){this.compressDataIfPossible(e)||(this.ensureLength(9),this.writeTag(6),this.data.writeDoubleLE(e.value,this.writerIndex),this.writerIndex+=8)},e.prototype.writeUUID=function(e){(0,o.default)(n.isValid(e),"supplied uuid is invalid"),this.compressDataIfPossible(new m(e))||(this.ensureLength(17),this.writeTag(5),n.write(e,this.data,this.writerIndex),this.writerIndex+=16)},e.chunkSize=128,e}();t.DataStreamWriter=E},4097:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataStreamConnection=t.HDSConnectionError=t.HDSConnectionErrorType=t.DataStreamConnectionEvent=t.DataStreamServer=t.DataStreamServerEvent=t.MessageType=t.HDSProtocolError=t.HDSProtocolSpecificErrorReason=t.HDSStatus=t.Topics=t.Protocols=void 0;var i,n=r(1635),a=n.__importDefault(r(2613)),o=n.__importDefault(r(6982)),s=n.__importDefault(r(5753)),c=r(4434),u=n.__importDefault(r(9278)),l=n.__importStar(r(8)),h=r(7881),d=(0,s.default)("HAP-NodeJS:DataStream:Server");!function(e){e.CONTROL="control",e.TARGET_CONTROL="targetControl",e.DATA_SEND="dataSend"}(t.Protocols||(t.Protocols={})),function(e){e.HELLO="hello",e.WHOAMI="whoami",e.OPEN="open",e.DATA="data",e.ACK="ack",e.CLOSE="close"}(t.Topics||(t.Topics={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.OUT_OF_MEMORY=1]="OUT_OF_MEMORY",e[e.TIMEOUT=2]="TIMEOUT",e[e.HEADER_ERROR=3]="HEADER_ERROR",e[e.PAYLOAD_ERROR=4]="PAYLOAD_ERROR",e[e.MISSING_PROTOCOL=5]="MISSING_PROTOCOL",e[e.PROTOCOL_SPECIFIC_ERROR=6]="PROTOCOL_SPECIFIC_ERROR"}(i=t.HDSStatus||(t.HDSStatus={})),function(e){e[e.NORMAL=0]="NORMAL",e[e.NOT_ALLOWED=1]="NOT_ALLOWED",e[e.BUSY=2]="BUSY",e[e.CANCELLED=3]="CANCELLED",e[e.UNSUPPORTED=4]="UNSUPPORTED",e[e.UNEXPECTED_FAILURE=5]="UNEXPECTED_FAILURE",e[e.TIMEOUT=6]="TIMEOUT",e[e.BAD_DATA=7]="BAD_DATA",e[e.PROTOCOL_ERROR=8]="PROTOCOL_ERROR",e[e.INVALID_CONFIGURATION=9]="INVALID_CONFIGURATION"}(t.HDSProtocolSpecificErrorReason||(t.HDSProtocolSpecificErrorReason={}));var p,f,v=function(e){function t(t){var r=e.call(this,"HDSProtocolError: "+t)||this;return(0,a.default)(0!==t,"Cannot initialize a HDSProtocolError with NORMAL!"),r.reason=t,r}return n.__extends(t,e),t}(Error);t.HDSProtocolError=v,function(e){e[e.UNINITIALIZED=0]="UNINITIALIZED",e[e.BINDING=1]="BINDING",e[e.LISTENING=2]="LISTENING",e[e.CLOSING=3]="CLOSING"}(p||(p={})),function(e){e[e.UNIDENTIFIED=0]="UNIDENTIFIED",e[e.EXPECTING_HELLO=1]="EXPECTING_HELLO",e[e.READY=2]="READY",e[e.CLOSING=3]="CLOSING",e[e.CLOSED=4]="CLOSED"}(f||(f={})),function(e){e[e.EVENT=1]="EVENT",e[e.REQUEST=2]="REQUEST",e[e.RESPONSE=3]="RESPONSE"}(t.MessageType||(t.MessageType={})),function(e){e.CONNECTION_OPENED="connection-opened",e.CONNECTION_CLOSED="connection-closed"}(t.DataStreamServerEvent||(t.DataStreamServerEvent={}));var g=function(e){function t(){var t=e.call(this)||this;return t.state=0,t.preparedSessions=[],t.connections=[],t.removeListenersOnceClosed=!1,t.internalEventEmitter=new c.EventEmitter,t}return n.__extends(t,e),t.prototype.onEventMessage=function(e,t,r){return this.internalEventEmitter.on(e+"-e-"+t,r),this},t.prototype.removeEventHandler=function(e,t,r){return this.internalEventEmitter.removeListener(e+"-e-"+t,r),this},t.prototype.onRequestMessage=function(e,t,r){return this.internalEventEmitter.on(e+"-r-"+t,r),this},t.prototype.removeRequestHandler=function(e,t,r){return this.internalEventEmitter.removeListener(e+"-r-"+t,r),this},t.prototype.prepareSession=function(e,r,i){var n=this;d("Preparing for incoming HDS connection from %s",e.sessionID);var a=o.default.randomBytes(32),s=Buffer.concat([r,a]),c={connection:e,accessoryToControllerEncryptionKey:l.HKDF("sha512",s,e.encryption.sharedSecret,t.accessoryToControllerInfo,32),controllerToAccessoryEncryptionKey:l.HKDF("sha512",s,e.encryption.sharedSecret,t.controllerToAccessoryInfo,32),accessoryKeySalt:a,connectTimeout:setTimeout((function(){return n.timeoutPreparedSession(c)}),1e4)};c.connectTimeout.unref(),this.preparedSessions.push(c),this.checkTCPServerEstablished(c,(function(e){e?i(e):i(void 0,c)}))},t.prototype.timeoutPreparedSession=function(e){d("Prepared HDS session timed out out since no connection was opened for 10 seconds (%s)",e.connection.sessionID);var t=this.preparedSessions.indexOf(e);t>=0&&this.preparedSessions.splice(t,1),this.checkCloseable()},t.prototype.checkTCPServerEstablished=function(e,t){var r=this;switch(this.state){case 0:d("Starting up TCP server."),this.tcpServer=u.default.createServer(),this.tcpServer.once("listening",this.listening.bind(this,e,t)),this.tcpServer.on("connection",this.onConnection.bind(this)),this.tcpServer.on("close",this.closed.bind(this)),this.tcpServer.listen(),this.state=1;break;case 1:d("TCP server already running. Waiting for it to bind."),this.tcpServer.once("listening",this.listening.bind(this,e,t));break;case 2:d("Instructing client to connect to already running TCP server"),e.port=this.tcpPort,t();break;case 3:d("TCP socket is currently closing. Trying again when server is fully closed and opening a new one then."),this.tcpServer.once("close",(function(){return setTimeout((function(){return r.checkTCPServerEstablished(e,t)}),10)}))}},t.prototype.listening=function(e,t){this.state=2;var r=this.tcpServer.address();r&&"string"!=typeof r&&(this.tcpPort=r.port,e.port=r.port,d("TCP server is now listening for new data stream connections on port %s",r.port),t())},t.prototype.onConnection=function(e){d("[%s] New DataStream connection was established",e.remoteAddress);var t=new y(e);t.on("identification",this.handleSessionIdentification.bind(this,t)),t.on("handle-message-globally",this.handleMessageGlobally.bind(this,t)),t.on("closed",this.connectionClosed.bind(this,t)),this.connections.push(t),this.emit("connection-opened",t)},t.prototype.handleSessionIdentification=function(e,t,r){for(var i=void 0,n=0;n<this.preparedSessions.length;n++){var a=this.preparedSessions[n];if(e.decryptHDSFrame(t,a.controllerToAccessoryEncryptionKey)){i=a;break}}if(r(i),i){d("[%s] Connection was successfully identified (linked with sessionId: %s)",e.remoteAddress,i.connection.sessionID);var o=this.preparedSessions.indexOf(i);o>=0&&this.preparedSessions.splice(o,1),clearTimeout(i.connectTimeout),i.connectTimeout=void 0}else d("[%s] Could not identify connection. Terminating.",e.remoteAddress),e.close()},t.prototype.handleMessageGlobally=function(e,t){var r;a.default.notStrictEqual(t.type,3);var i,o="",s=[];1===t.type?o="-e-":2===t.type&&(o="-r-",s.push(t.id)),s.push(t.message);try{i=(r=this.internalEventEmitter).emit.apply(r,n.__spreadArray([t.protocol+o+t.topic,e],n.__read(s),!1))}catch(r){i=!0,d("[%s] Error occurred while dispatching handler for HDS message: %o",e.remoteAddress,t),d(r.stack)}i||d("[%s] WARNING no handler was found for message: %o",e.remoteAddress,t)},t.prototype.connectionClosed=function(e){d("[%s] DataStream connection closed",e.remoteAddress),this.connections.splice(this.connections.indexOf(e),1),this.emit("connection-closed",e),this.checkCloseable(),3===this.state&&this.removeListenersOnceClosed&&0===this.connections.length&&this.removeAllListeners()},t.prototype.checkCloseable=function(){0===this.connections.length&&0===this.preparedSessions.length&&this.state<3&&(d("Last connection disconnected. Closing the server now."),this.state=3,this.tcpServer.close())},t.prototype.destroy=function(){var e,t;if(this.state>0&&this.state<3){this.tcpServer.close();try{for(var r=n.__values(this.connections),i=r.next();!i.done;i=r.next()){i.value.close()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}}this.state=3,this.removeListenersOnceClosed=!0,this.internalEventEmitter.removeAllListeners()},t.prototype.closed=function(){this.tcpServer=void 0,this.tcpPort=void 0,this.state=0},t.version="1.0",t.accessoryToControllerInfo=Buffer.from("HDS-Read-Encryption-Key"),t.controllerToAccessoryInfo=Buffer.from("HDS-Write-Encryption-Key"),t}(c.EventEmitter);t.DataStreamServer=g,function(e){e.IDENTIFICATION="identification",e.HANDLE_MESSAGE_GLOBALLY="handle-message-globally",e.CLOSED="closed"}(t.DataStreamConnectionEvent||(t.DataStreamConnectionEvent={})),function(e){e[e.ILLEGAL_STATE=1]="ILLEGAL_STATE",e[e.CLOSED_SOCKET=2]="CLOSED_SOCKET",e[e.MAX_PAYLOAD_LENGTH=3]="MAX_PAYLOAD_LENGTH"}(t.HDSConnectionErrorType||(t.HDSConnectionErrorType={}));var m=function(e){function t(t,r){var i=e.call(this,t)||this;return i.type=r,i}return n.__extends(t,e),t}(Error);t.HDSConnectionError=m;var y=function(e){function t(t){var r,i=e.call(this)||this;return i.state=0,i.protocolHandlers={},i.responseHandlers={},i.responseTimers={},i.socket=t,i.remoteAddress=t.remoteAddress,i.socket.setNoDelay(!0),i.socket.setKeepAlive(!0),i.accessoryToControllerNonce=0,i.accessoryToControllerNonceBuffer=Buffer.alloc(8),i.controllerToAccessoryNonce=0,i.controllerToAccessoryNonceBuffer=Buffer.alloc(8),i.hapConnectionClosedListener=i.onHAPSessionClosed.bind(i),i.addProtocolHandler("control",{requestHandler:(r={},r.hello=i.handleHello.bind(i),r)}),i.helloTimer=setTimeout((function(){d("[%s] Hello message did not arrive in time. Killing the connection",i.remoteAddress),i.close()}),1e4),i.socket.on("data",i.onSocketData.bind(i)),i.socket.on("error",i.onSocketError.bind(i)),i.socket.on("close",i.onSocketClose.bind(i)),i.setMaxListeners(100),i}return n.__extends(t,e),t.prototype.handleHello=function(e,t){d("[%s] Received hello message from client: %o",this.remoteAddress,t),clearTimeout(this.helloTimer),this.helloTimer=void 0,this.state=2,this.sendResponse("control","hello",e)},t.prototype.addProtocolHandler=function(e,t){return void 0===this.protocolHandlers[e]&&(this.protocolHandlers[e]=t,!0)},t.prototype.removeProtocolHandler=function(e,t){this.protocolHandlers[e]===t&&delete this.protocolHandlers[e]},t.prototype.sendEvent=function(e,t,r){void 0===r&&(r={});var i={};i.protocol=e,i.event=t,this.sendHDSFrame(i,r)},t.prototype.sendRequest=function(e,t,r,i){var n,a=this;void 0===r&&(r={});do{n=Math.floor(4294967295*Math.random())}while(void 0!==this.responseHandlers[n]);this.responseHandlers[n]=i,this.responseTimers[n]=setTimeout((function(){a.close();var e=a.responseHandlers[n];delete a.responseHandlers[n],delete a.responseTimers[n],e(new Error("timeout"),void 0,{})}),1e4);var o={};o.protocol=e,o.request=t,o.id=new h.Int64(n),this.sendHDSFrame(o,r)},t.prototype.sendResponse=function(e,t,r,n,a){void 0===n&&(n=i.SUCCESS),void 0===a&&(a={});var o={};o.protocol=e,o.response=t,o.id=new h.Int64(r),o.status=new h.Int64(n),this.sendHDSFrame(o,a)},t.prototype.onSocketData=function(e){var t=this;if(!(this.state>=3)){var r=0,i=this.decodeHDSFrames(e);if(0!==i.length){if(0===this.state){var n=i[r++];if(this.emit("identification",n,(function(e){e&&(t.connection=e.connection,t.accessoryToControllerEncryptionKey=e.accessoryToControllerEncryptionKey,t.controllerToAccessoryEncryptionKey=e.controllerToAccessoryEncryptionKey,t.state=1,t.connection.setMaxListeners(t.connection.getMaxListeners()+1),t.connection.on("closed",t.hapConnectionClosedListener),d("[%s] Registering CLOSED handler to HAP connection. Connection currently has %d close handlers!",t.remoteAddress,t.connection.listeners("closed").length))})),0===this.state)return}for(;r<i.length;r++)if(!this.decryptHDSFrame(i[r]))return d("[%s] HDS frame decryption or authentication failed. Connection will be terminated!",this.remoteAddress),void this.close();var a=this.decodePayloads(i);if(1===this.state){var o=a[0];if("control"!==o.protocol||2!==o.type||"hello"!==o.topic)return d("[%s] First message received was not the expected hello message. Instead got: %o",this.remoteAddress,o),void this.close()}a.forEach((function(e){if(3===e.type){var r=t.responseHandlers[e.id],i=t.responseTimers[e.id];if(i&&(clearTimeout(i),delete t.responseTimers[e.id]),!r)return void d("WARNING we received a response to a request we have not sent: %o",e);try{r(void 0,e.status,e.message)}catch(r){d("[%s] Error occurred while dispatching response handler for HDS message: %o",t.remoteAddress,e),d(r.stack)}delete t.responseHandlers[e.id]}else{var n=t.protocolHandlers[e.protocol];if(void 0===n)return void t.emit("handle-message-globally",e);if(1===e.type){var a=void 0;if(!n.eventHandler||!(a=n.eventHandler[e.topic]))return void d("[%s] WARNING no event handler was found for message: %o",t.remoteAddress,e);try{a(e.message)}catch(r){d("[%s] Error occurred while dispatching event handler for HDS message: %o",t.remoteAddress,e),d(r.stack)}}else if(2===e.type){var o=void 0;if(!n.requestHandler||!(o=n.requestHandler[e.topic]))return void d("[%s] WARNING no request handler was found for message: %o",t.remoteAddress,e);try{o(e.id,e.message)}catch(r){d("[%s] Error occurred while dispatching request handler for HDS message: %o",t.remoteAddress,e),d(r.stack)}}else d("[%s] Encountered unknown message type with id %d",t.remoteAddress,e.type)}}))}}},t.prototype.decodeHDSFrames=function(e){void 0!==this.frameBuffer&&(e=Buffer.concat([this.frameBuffer,e]),this.frameBuffer=void 0);for(var r=e.length,i=[],n=0;n<r;){if(n+4>r){this.frameBuffer=e.slice(n);break}var a=e.readUInt8(n),o=e.readUIntBE(n+1,3);if(o>t.MAX_PAYLOAD_LENGTH)return d("[%s] Connection send payload with size bigger than the maximum allow for data stream",this.remoteAddress),this.close(),[];if(o+16>r-n-4){this.frameBuffer=e.slice(n);break}var s=n+4,c=s+o,u=e.slice(n,s),l=e.slice(s,c),h=Buffer.alloc(o),p=e.slice(c,c+16);if(n=c+16,1===a){var f={header:u,cipheredPayload:l,authTag:p};i.push(f)}else d("[%s] Encountered unknown payload type %d for payload: %s",this.remoteAddress,h.toString("hex"))}return i},t.prototype.decryptHDSFrame=function(e,t){l.writeUInt64LE(this.controllerToAccessoryNonce,this.controllerToAccessoryNonceBuffer,0);var r=t||this.controllerToAccessoryEncryptionKey;try{return e.plaintextPayload=l.chacha20_poly1305_decryptAndVerify(r,this.controllerToAccessoryNonceBuffer,e.header,e.cipheredPayload,e.authTag),this.controllerToAccessoryNonce++,!0}catch(e){return!1}},t.prototype.decodePayloads=function(e){var t=this,r=[];return e.forEach((function(e){var i=e.plaintextPayload;if(!i)throw new m("Reached illegal state. Encountered HDSFrame with wasn't decrypted yet!",1);var n,a,o,s=i.readUInt8(0),c=i.length-s-1,u=1+s,l=new h.DataStreamReader(i.slice(1,1+s)),p=new h.DataStreamReader(i.slice(u,u+c));try{n=h.DataStreamParser.decode(l),l.finished()}catch(e){return void d("[%s] Failed to decode header payload: %s",t.remoteAddress,e.message)}try{a=h.DataStreamParser.decode(p),p.finished()}catch(e){return void d("[%s] Failed to decode message payload: %s (header: %o)",t.remoteAddress,e.message,n)}var f,v=n.protocol,g=void 0,y=void 0;if(void 0!==n.event)o=1,f=n.event;else if(void 0!==n.request)o=2,f=n.request,g=n.id;else{if(void 0===n.response)return void d("[%s] Encountered unknown payload header format: %o (message: %o)",t.remoteAddress,n,a);o=3,f=n.response,g=n.id,y=n.status}var C={type:o,protocol:v,topic:f,id:g,status:y,message:a};r.push(C)})),r},t.prototype.sendHDSFrame=function(e,r){if(this.state>=3)throw new m("Cannot send message on closing/closed socket!",2);var i=new h.DataStreamWriter,n=new h.DataStreamWriter;h.DataStreamParser.encode(e,i),h.DataStreamParser.encode(r,n);var a=Buffer.alloc(1);a.writeUInt8(i.length(),0);var o=Buffer.concat([a,i.getData(),n.getData()]);if(o.length>t.MAX_PAYLOAD_LENGTH)throw new m("Tried sending payload with length larger than the maximum allowed for data stream",3);var s=Buffer.alloc(1);s.writeUInt8(1,0);var c=Buffer.alloc(4);c.writeUInt32BE(o.length,0),c=c.slice(1,4);var u=Buffer.concat([s,c]);l.writeUInt64LE(this.accessoryToControllerNonce++,this.accessoryToControllerNonceBuffer);var d=l.chacha20_poly1305_encryptAndSeal(this.accessoryToControllerEncryptionKey,this.accessoryToControllerNonceBuffer,u,o);this.socket.write(Buffer.concat([u,d.ciphertext,d.authTag]))},t.prototype.close=function(){this.state>=3||(this.state=3,this.socket.end())},t.prototype.isConsideredClosed=function(){return this.state>=3},t.prototype.onHAPSessionClosed=function(){d("[%s] HAP connection disconnected. Also closing DataStream connection now.",this.remoteAddress),this.close()},t.prototype.onSocketError=function(e){d("[%s] Encountered socket error: %s",this.remoteAddress,e.message)},t.prototype.onSocketClose=function(){var e,t;this.state=4,this.emit("closed"),null===(e=this.connection)||void 0===e||e.removeListener("closed",this.hapConnectionClosedListener),null===(t=this.connection)||void 0===t||t.setMaxListeners(this.connection.getMaxListeners()-1),this.removeAllListeners()},t.MAX_PAYLOAD_LENGTH=1048575,t}(c.EventEmitter);t.DataStreamConnection=y},9948:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(1635);i.__exportStar(r(733),t),i.__exportStar(r(4097),t),i.__exportStar(r(7881),t)},651:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CurrentMediaState=t.CurrentHumidifierDehumidifierState=t.CurrentHorizontalTiltAngle=t.CurrentHeatingCoolingState=t.CurrentHeaterCoolerState=t.CurrentFanState=t.CurrentDoorState=t.CurrentAmbientLightLevel=t.CurrentAirPurifierState=t.CryptoHash=t.CoolingThresholdTemperature=t.ContactSensorState=t.ConfiguredName=t.ConfigureBridgedAccessoryStatus=t.ConfigureBridgedAccessory=t.ConfigurationState=t.ColorTemperature=t.ClosedCaptions=t.ChargingState=t.CharacteristicValueTransitionControl=t.CharacteristicValueActiveTransitionCount=t.CCASignalDetectThreshold=t.CCAEnergyDetectThreshold=t.Category=t.CarbonMonoxidePeakLevel=t.CarbonMonoxideLevel=t.CarbonMonoxideDetected=t.CarbonDioxidePeakLevel=t.CarbonDioxideLevel=t.CarbonDioxideDetected=t.CameraOperatingModeIndicator=t.ButtonEvent=t.Brightness=t.BatteryLevel=t.AudioFeedback=t.AssetUpdateReadiness=t.AppMatchingIdentifier=t.AirQuality=t.AirPlayEnable=t.AirParticulateSize=t.AirParticulateDensity=t.AdministratorOnlyAccess=t.ActivityInterval=t.ActiveIdentifier=t.Active=t.AccessoryIdentifier=t.AccessoryFlags=t.AccessControlLevel=t.AccessCodeSupportedConfiguration=t.AccessCodeControlPoint=void 0,t.Logs=t.LockTargetState=t.LockPhysicalControls=t.LockManagementAutoSecurityTimeout=t.LockLastKnownAction=t.LockCurrentState=t.LockControlPoint=t.ListPairings=t.LinkQuality=t.LeakDetected=t.IsConfigured=t.InUse=t.InputSourceType=t.InputDeviceType=t.ImageRotation=t.ImageMirroring=t.Identify=t.Identifier=t.Hue=t.HomeKitCameraActive=t.HoldPosition=t.HeatingThresholdTemperature=t.HeartBeat=t.HardwareRevision=t.HardwareFinish=t.FirmwareUpdateStatus=t.FirmwareUpdateReadiness=t.FirmwareRevision=t.FilterLifeLevel=t.FilterChangeIndication=t.EventTransmissionCounters=t.EventSnapshotsActive=t.EventRetransmissionMaximum=t.DisplayOrder=t.DiscoveredBridgedAccessories=t.DiscoverBridgedAccessories=t.DigitalZoom=t.DiagonalFieldOfView=t.DayoftheWeek=t.DataStreamHAPTransportInterrupt=t.DataStreamHAPTransport=t.CurrentVisibilityState=t.CurrentVerticalTiltAngle=t.CurrentTransport=t.CurrentTime=t.CurrentTiltAngle=t.CurrentTemperature=t.CurrentSlatState=t.CurrentRelativeHumidity=t.CurrentPosition=void 0,t.RelayState=t.RelayEnabled=t.RelayControlPoint=t.RelativeHumidityHumidifierThreshold=t.RelativeHumidityDehumidifierThreshold=t.RecordingAudioActive=t.ReceiverSensitivity=t.ReceivedSignalStrengthIndication=t.Reachable=t.ProgramMode=t.ProgrammableSwitchOutputState=t.ProgrammableSwitchEvent=t.ProductData=t.PowerModeSelection=t.PositionState=t.PM2_5Density=t.PM10Density=t.Ping=t.PictureMode=t.PeriodicSnapshotsActive=t.PasswordSetting=t.PairVerify=t.PairSetup=t.PairingFeatures=t.OzoneDensity=t.OutletInUse=t.OpticalZoom=t.OperatingStateResponse=t.On=t.OccupancyDetected=t.ObstructionDetected=t.NitrogenDioxideDensity=t.NightVision=t.NFCAccessSupportedConfiguration=t.NFCAccessControlPoint=t.NetworkClientStatusControl=t.NetworkClientProfileControl=t.NetworkAccessViolationControl=t.Name=t.Mute=t.MultifunctionButton=t.MotionDetected=t.Model=t.MetricsBufferFullState=t.MaximumTransmitPower=t.Manufacturer=t.ManuallyDisabled=t.ManagedNetworkEnable=t.MACTransmissionCounters=t.MACRetransmissionMaximum=void 0,t.SupportedDiagnosticsModes=t.SupportedDataStreamTransportConfiguration=t.SupportedCharacteristicValueTransitionConfiguration=t.SupportedCameraRecordingConfiguration=t.SupportedAudioStreamConfiguration=t.SupportedAudioRecordingConfiguration=t.SupportedAssetTypes=t.SulphurDioxideDensity=t.StreamingStatus=t.StatusTampered=t.StatusLowBattery=t.StatusJammed=t.StatusFault=t.StatusActive=t.StagedFirmwareVersion=t.SoftwareRevision=t.SmokeDetected=t.SleepInterval=t.SleepDiscoveryMode=t.SlatType=t.SiriTouchToUse=t.SiriListening=t.SiriLightOnUse=t.SiriInputType=t.SiriEngineVersion=t.SiriEndpointSessionStatus=t.SiriEnable=t.SignalToNoiseRatio=t.SetupTransferTransport=t.SetupEndpoints=t.SetupDataStreamTransport=t.SetDuration=t.ServiceLabelNamespace=t.ServiceLabelIndex=t.SerialNumber=t.SelectedSleepConfiguration=t.SelectedRTPStreamConfiguration=t.SelectedDiagnosticsModes=t.SelectedCameraRecordingConfiguration=t.SelectedAudioStreamConfiguration=t.SecuritySystemTargetState=t.SecuritySystemCurrentState=t.SecuritySystemAlarmType=t.Saturation=t.RouterStatus=t.RotationSpeed=t.RotationDirection=t.ResetFilterIndication=t.RemoteKey=t.RemainingDuration=void 0,t.WakeConfiguration=t.VolumeSelector=t.VolumeControlType=t.Volume=t.VOCDensity=t.VideoAnalysisActive=t.Version=t.ValveType=t.TunneledAccessoryStateNumber=t.TunneledAccessoryConnected=t.TunneledAccessoryAdvertising=t.TunnelConnectionTimeout=t.TransmitPower=t.Token=t.TimeUpdate=t.ThreadStatus=t.ThreadOpenThreadVersion=t.ThreadNodeCapabilities=t.ThreadControlPoint=t.ThirdPartyCameraActive=t.TemperatureDisplayUnits=t.TargetVisibilityState=t.TargetVerticalTiltAngle=t.TargetTiltAngle=t.TargetTemperature=t.TargetSlatState=t.TargetRelativeHumidity=t.TargetPosition=t.TargetMediaState=t.TargetHumidifierDehumidifierState=t.TargetHorizontalTiltAngle=t.TargetHeatingCoolingState=t.TargetHeaterCoolerState=t.TargetFanState=t.TargetDoorState=t.TargetControlSupportedConfiguration=t.TargetControlList=t.TargetAirQuality=t.TargetAirPurifierState=t.TapType=t.SwingMode=t.SupportedVideoStreamConfiguration=t.SupportedVideoRecordingConfiguration=t.SupportedTransferTransportConfiguration=t.SupportedSleepConfiguration=t.SupportedRTPConfiguration=t.SupportedRouterConfiguration=t.SupportedMetrics=t.SupportedFirmwareUpdateConfiguration=t.SupportedDiagnosticsSnapshot=void 0,t.WiFiSatelliteStatus=t.WiFiConfigurationControl=t.WiFiCapabilities=t.WaterLevel=t.WANStatusList=t.WANConfigurationList=void 0;var i=r(1635),n=r(9826),a=function(e){function t(){var r=e.call(this,"Access Code Control Point",t.UUID,{format:"tlv8",perms:["pr","pw","wr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000262-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.AccessCodeControlPoint=a,n.Characteristic.AccessCodeControlPoint=a;var o=function(e){function t(){var r=e.call(this,"Access Code Supported Configuration",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000261-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.AccessCodeSupportedConfiguration=o,n.Characteristic.AccessCodeSupportedConfiguration=o;var s=function(e){function t(){var r=e.call(this,"Access Control Level",t.UUID,{format:"uint16",perms:["ev","pr","pw"],minValue:0,maxValue:2,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000E5-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.AccessControlLevel=s,n.Characteristic.AccessControlLevel=s;var c=function(e){function t(){var r=e.call(this,"Accessory Flags",t.UUID,{format:"uint32",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000A6-0000-1000-8000-0026BB765291",t.REQUIRES_ADDITIONAL_SETUP_BIT_MASK=1,t}(n.Characteristic);t.AccessoryFlags=c,n.Characteristic.AccessoryFlags=c;var u=function(e){function t(){var r=e.call(this,"Accessory Identifier",t.UUID,{format:"string",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000057-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.AccessoryIdentifier=u,n.Characteristic.AccessoryIdentifier=u;var l=function(e){function t(){var r=e.call(this,"Active",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000B0-0000-1000-8000-0026BB765291",t.INACTIVE=0,t.ACTIVE=1,t}(n.Characteristic);t.Active=l,n.Characteristic.Active=l;var h=function(e){function t(){var r=e.call(this,"Active Identifier",t.UUID,{format:"uint32",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000E7-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ActiveIdentifier=h,n.Characteristic.ActiveIdentifier=h;var d=function(e){function t(){var r=e.call(this,"Activity Interval",t.UUID,{format:"uint32",perms:["ev","pr"],minValue:0,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000023B-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ActivityInterval=d,n.Characteristic.ActivityInterval=d;var p=function(e){function t(){var r=e.call(this,"Administrator Only Access",t.UUID,{format:"bool",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000001-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.AdministratorOnlyAccess=p,n.Characteristic.AdministratorOnlyAccess=p;var f=function(e){function t(){var r=e.call(this,"Air Particulate Density",t.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e3})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000064-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.AirParticulateDensity=f,n.Characteristic.AirParticulateDensity=f;var v=function(e){function t(){var r=e.call(this,"Air Particulate Size",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000065-0000-1000-8000-0026BB765291",t._2_5_M=0,t._10_M=1,t}(n.Characteristic);t.AirParticulateSize=v,n.Characteristic.AirParticulateSize=v;var g=function(e){function t(){var r=e.call(this,"AirPlay Enable",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000025B-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.AirPlayEnable=g,n.Characteristic.AirPlayEnable=g;var m=function(e){function t(){var r=e.call(this,"Air Quality",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:5,minStep:1,validValues:[0,1,2,3,4,5]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000095-0000-1000-8000-0026BB765291",t.UNKNOWN=0,t.EXCELLENT=1,t.GOOD=2,t.FAIR=3,t.INFERIOR=4,t.POOR=5,t}(n.Characteristic);t.AirQuality=m,n.Characteristic.AirQuality=m;var y=function(e){function t(){var r=e.call(this,"App Matching Identifier",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000A4-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.AppMatchingIdentifier=y,n.Characteristic.AppMatchingIdentifier=y;var C=function(e){function t(){var r=e.call(this,"Asset Update Readiness",t.UUID,{format:"uint32",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000269-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.AssetUpdateReadiness=C,n.Characteristic.AssetUpdateReadiness=C;var S=function(e){function t(){var r=e.call(this,"Audio Feedback",t.UUID,{format:"bool",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000005-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.AudioFeedback=S,n.Characteristic.AudioFeedback=S;var E=function(e){function t(){var r=e.call(this,"Battery Level",t.UUID,{format:"uint8",perms:["ev","pr"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000068-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.BatteryLevel=E,n.Characteristic.BatteryLevel=E;var _=function(e){function t(){var r=e.call(this,"Brightness",t.UUID,{format:"int",perms:["ev","pr","pw"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000008-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Brightness=_,n.Characteristic.Brightness=_;var T=function(e){function t(){var r=e.call(this,"Button Event",t.UUID,{format:"tlv8",perms:["ev","pr"],adminOnlyAccess:[2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000126-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ButtonEvent=T,n.Characteristic.ButtonEvent=T;var A=function(e){function t(){var r=e.call(this,"Camera Operating Mode Indicator",t.UUID,{format:"bool",perms:["ev","pr","pw","tw"],validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000021D-0000-1000-8000-0026BB765291",t.DISABLE=0,t.ENABLE=1,t}(n.Characteristic);t.CameraOperatingModeIndicator=A,n.Characteristic.CameraOperatingModeIndicator=A;var I=function(e){function t(){var r=e.call(this,"Carbon Dioxide Detected",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000092-0000-1000-8000-0026BB765291",t.CO2_LEVELS_NORMAL=0,t.CO2_LEVELS_ABNORMAL=1,t}(n.Characteristic);t.CarbonDioxideDetected=I,n.Characteristic.CarbonDioxideDetected=I;var D=function(e){function t(){var r=e.call(this,"Carbon Dioxide Level",t.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e5,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000093-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CarbonDioxideLevel=D,n.Characteristic.CarbonDioxideLevel=D;var w=function(e){function t(){var r=e.call(this,"Carbon Dioxide Peak Level",t.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e5,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000094-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CarbonDioxidePeakLevel=w,n.Characteristic.CarbonDioxidePeakLevel=w;var b=function(e){function t(){var r=e.call(this,"Carbon Monoxide Detected",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000069-0000-1000-8000-0026BB765291",t.CO_LEVELS_NORMAL=0,t.CO_LEVELS_ABNORMAL=1,t}(n.Characteristic);t.CarbonMonoxideDetected=b,n.Characteristic.CarbonMonoxideDetected=b;var U=function(e){function t(){var r=e.call(this,"Carbon Monoxide Level",t.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000090-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CarbonMonoxideLevel=U,n.Characteristic.CarbonMonoxideLevel=U;var R=function(e){function t(){var r=e.call(this,"Carbon Monoxide Peak Level",t.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000091-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CarbonMonoxidePeakLevel=R,n.Characteristic.CarbonMonoxidePeakLevel=R;var O=function(e){function t(){var r=e.call(this,"Category",t.UUID,{format:"uint16",perms:["ev","pr"],minValue:1,maxValue:16})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000A3-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Category=O,n.Characteristic.Category=O;var N=function(e){function t(){var r=e.call(this,"CCA Energy Detect Threshold",t.UUID,{format:"int",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000246-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CCAEnergyDetectThreshold=N,n.Characteristic.CCAEnergyDetectThreshold=N;var P=function(e){function t(){var r=e.call(this,"CCA Signal Detect Threshold",t.UUID,{format:"int",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000245-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CCASignalDetectThreshold=P,n.Characteristic.CCASignalDetectThreshold=P;var B=function(e){function t(){var r=e.call(this,"Characteristic Value Active Transition Count",t.UUID,{format:"uint8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000024B-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CharacteristicValueActiveTransitionCount=B,n.Characteristic.CharacteristicValueActiveTransitionCount=B;var L=function(e){function t(){var r=e.call(this,"Characteristic Value Transition Control",t.UUID,{format:"tlv8",perms:["pr","pw","wr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000143-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CharacteristicValueTransitionControl=L,n.Characteristic.CharacteristicValueTransitionControl=L;var x=function(e){function t(){var r=e.call(this,"Charging State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000008F-0000-1000-8000-0026BB765291",t.NOT_CHARGING=0,t.CHARGING=1,t.NOT_CHARGEABLE=2,t}(n.Characteristic);t.ChargingState=x,n.Characteristic.ChargingState=x;var M=function(e){function t(){var r=e.call(this,"Closed Captions",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000DD-0000-1000-8000-0026BB765291",t.DISABLED=0,t.ENABLED=1,t}(n.Characteristic);t.ClosedCaptions=M,n.Characteristic.ClosedCaptions=M;var F=function(e){function t(){var r=e.call(this,"Color Temperature",t.UUID,{format:"int",perms:["ev","pr","pw"],minValue:140,maxValue:500,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000CE-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ColorTemperature=F,n.Characteristic.ColorTemperature=F;var k=function(e){function t(){var r=e.call(this,"Configuration State",t.UUID,{format:"uint16",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000263-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ConfigurationState=k,n.Characteristic.ConfigurationState=k;var V=function(e){function t(){var r=e.call(this,"Configure Bridged Accessory",t.UUID,{format:"tlv8",perms:["pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000A0-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ConfigureBridgedAccessory=V,n.Characteristic.ConfigureBridgedAccessory=V;var H=function(e){function t(){var r=e.call(this,"Configure Bridged Accessory Status",t.UUID,{format:"tlv8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000009D-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ConfigureBridgedAccessoryStatus=H,n.Characteristic.ConfigureBridgedAccessoryStatus=H;var j=function(e){function t(){var r=e.call(this,"Configured Name",t.UUID,{format:"string",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000E3-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ConfiguredName=j,n.Characteristic.ConfiguredName=j;var G=function(e){function t(){var r=e.call(this,"Contact Sensor State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000006A-0000-1000-8000-0026BB765291",t.CONTACT_DETECTED=0,t.CONTACT_NOT_DETECTED=1,t}(n.Characteristic);t.ContactSensorState=G,n.Characteristic.ContactSensorState=G;var W=function(e){function t(){var r=e.call(this,"Cooling Threshold Temperature",t.UUID,{format:"float",perms:["ev","pr","pw"],unit:"celsius",minValue:10,maxValue:35,minStep:.1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000000D-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CoolingThresholdTemperature=W,n.Characteristic.CoolingThresholdTemperature=W;var Y=function(e){function t(){var r=e.call(this,"Crypto Hash",t.UUID,{format:"tlv8",perms:["pw","wr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000250-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CryptoHash=Y,n.Characteristic.CryptoHash=Y;var q=function(e){function t(){var r=e.call(this,"Current Air Purifier State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000A9-0000-1000-8000-0026BB765291",t.INACTIVE=0,t.IDLE=1,t.PURIFYING_AIR=2,t}(n.Characteristic);t.CurrentAirPurifierState=q,n.Characteristic.CurrentAirPurifierState=q;var K=function(e){function t(){var r=e.call(this,"Current Ambient Light Level",t.UUID,{format:"float",perms:["ev","pr"],unit:"lux",minValue:1e-4,maxValue:1e5})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000006B-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CurrentAmbientLightLevel=K,n.Characteristic.CurrentAmbientLightLevel=K;var $=function(e){function t(){var r=e.call(this,"Current Door State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:4,minStep:1,validValues:[0,1,2,3,4]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000000E-0000-1000-8000-0026BB765291",t.OPEN=0,t.CLOSED=1,t.OPENING=2,t.CLOSING=3,t.STOPPED=4,t}(n.Characteristic);t.CurrentDoorState=$,n.Characteristic.CurrentDoorState=$;var z=function(e){function t(){var r=e.call(this,"Current Fan State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000AF-0000-1000-8000-0026BB765291",t.INACTIVE=0,t.IDLE=1,t.BLOWING_AIR=2,t}(n.Characteristic);t.CurrentFanState=z,n.Characteristic.CurrentFanState=z;var Q=function(e){function t(){var r=e.call(this,"Current Heater-Cooler State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000B1-0000-1000-8000-0026BB765291",t.INACTIVE=0,t.IDLE=1,t.HEATING=2,t.COOLING=3,t}(n.Characteristic);t.CurrentHeaterCoolerState=Q,n.Characteristic.CurrentHeaterCoolerState=Q;var X=function(e){function t(){var r=e.call(this,"Current Heating Cooling State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000000F-0000-1000-8000-0026BB765291",t.OFF=0,t.HEAT=1,t.COOL=2,t}(n.Characteristic);t.CurrentHeatingCoolingState=X,n.Characteristic.CurrentHeatingCoolingState=X;var J=function(e){function t(){var r=e.call(this,"Current Horizontal Tilt Angle",t.UUID,{format:"int",perms:["ev","pr"],unit:"arcdegrees",minValue:-90,maxValue:90,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000006C-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CurrentHorizontalTiltAngle=J,n.Characteristic.CurrentHorizontalTiltAngle=J;var Z=function(e){function t(){var r=e.call(this,"Current Humidifier-Dehumidifier State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000B3-0000-1000-8000-0026BB765291",t.INACTIVE=0,t.IDLE=1,t.HUMIDIFYING=2,t.DEHUMIDIFYING=3,t}(n.Characteristic);t.CurrentHumidifierDehumidifierState=Z,n.Characteristic.CurrentHumidifierDehumidifierState=Z;var ee=function(e){function t(){var r=e.call(this,"Current Media State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:5,minStep:1,validValues:[0,1,2,4,5]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000E0-0000-1000-8000-0026BB765291",t.PLAY=0,t.PAUSE=1,t.STOP=2,t.LOADING=4,t.INTERRUPTED=5,t}(n.Characteristic);t.CurrentMediaState=ee,n.Characteristic.CurrentMediaState=ee;var te=function(e){function t(){var r=e.call(this,"Current Position",t.UUID,{format:"uint8",perms:["ev","pr"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000006D-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CurrentPosition=te,n.Characteristic.CurrentPosition=te;var re=function(e){function t(){var r=e.call(this,"Current Relative Humidity",t.UUID,{format:"float",perms:["ev","pr"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000010-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CurrentRelativeHumidity=re,n.Characteristic.CurrentRelativeHumidity=re;var ie=function(e){function t(){var r=e.call(this,"Current Slat State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000AA-0000-1000-8000-0026BB765291",t.FIXED=0,t.JAMMED=1,t.SWINGING=2,t}(n.Characteristic);t.CurrentSlatState=ie,n.Characteristic.CurrentSlatState=ie;var ne=function(e){function t(){var r=e.call(this,"Current Temperature",t.UUID,{format:"float",perms:["ev","pr"],unit:"celsius",minValue:-270,maxValue:100,minStep:.1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000011-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CurrentTemperature=ne,n.Characteristic.CurrentTemperature=ne;var ae=function(e){function t(){var r=e.call(this,"Current Tilt Angle",t.UUID,{format:"int",perms:["ev","pr"],unit:"arcdegrees",minValue:-90,maxValue:90,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000C1-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CurrentTiltAngle=ae,n.Characteristic.CurrentTiltAngle=ae;var oe=function(e){function t(){var r=e.call(this,"Current Time",t.UUID,{format:"string",perms:["pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000009B-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CurrentTime=oe,n.Characteristic.CurrentTime=oe;var se=function(e){function t(){var r=e.call(this,"Current Transport",t.UUID,{format:"bool",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000022B-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CurrentTransport=se,n.Characteristic.CurrentTransport=se;var ce=function(e){function t(){var r=e.call(this,"Current Vertical Tilt Angle",t.UUID,{format:"int",perms:["ev","pr"],unit:"arcdegrees",minValue:-90,maxValue:90,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000006E-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CurrentVerticalTiltAngle=ce,n.Characteristic.CurrentVerticalTiltAngle=ce;var ue=function(e){function t(){var r=e.call(this,"Current Visibility State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000135-0000-1000-8000-0026BB765291",t.SHOWN=0,t.HIDDEN=1,t}(n.Characteristic);t.CurrentVisibilityState=ue,n.Characteristic.CurrentVisibilityState=ue;var le=function(e){function t(){var r=e.call(this,"Data Stream HAP Transport",t.UUID,{format:"tlv8",perms:["pr","pw","wr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000138-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.DataStreamHAPTransport=le,n.Characteristic.DataStreamHAPTransport=le;var he=function(e){function t(){var r=e.call(this,"Data Stream HAP Transport Interrupt",t.UUID,{format:"tlv8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000139-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.DataStreamHAPTransportInterrupt=he,n.Characteristic.DataStreamHAPTransportInterrupt=he;var de=function(e){function t(){var r=e.call(this,"Day of the Week",t.UUID,{format:"uint8",perms:["pr","pw"],minValue:1,maxValue:7})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000098-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.DayoftheWeek=de,n.Characteristic.DayoftheWeek=de;var pe=function(e){function t(){var r=e.call(this,"Diagonal Field Of View",t.UUID,{format:"float",perms:["ev","pr"],unit:"arcdegrees",minValue:0,maxValue:360})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000224-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.DiagonalFieldOfView=pe,n.Characteristic.DiagonalFieldOfView=pe;var fe=function(e){function t(){var r=e.call(this,"Digital Zoom",t.UUID,{format:"float",perms:["ev","pr","pw"],minStep:.1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000011D-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.DigitalZoom=fe,n.Characteristic.DigitalZoom=fe;var ve=function(e){function t(){var r=e.call(this,"Discover Bridged Accessories",t.UUID,{format:"uint8",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000009E-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.DiscoverBridgedAccessories=ve,n.Characteristic.DiscoverBridgedAccessories=ve;var ge=function(e){function t(){var r=e.call(this,"Discovered Bridged Accessories",t.UUID,{format:"uint16",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000009F-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.DiscoveredBridgedAccessories=ge,n.Characteristic.DiscoveredBridgedAccessories=ge;var me=function(e){function t(){var r=e.call(this,"Display Order",t.UUID,{format:"tlv8",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000136-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.DisplayOrder=me,n.Characteristic.DisplayOrder=me;var ye=function(e){function t(){var r=e.call(this,"Event Retransmission Maximum",t.UUID,{format:"uint8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000023D-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.EventRetransmissionMaximum=ye,n.Characteristic.EventRetransmissionMaximum=ye;var Ce=function(e){function t(){var r=e.call(this,"Event Snapshots Active",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000223-0000-1000-8000-0026BB765291",t.DISABLE=0,t.ENABLE=1,t}(n.Characteristic);t.EventSnapshotsActive=Ce,n.Characteristic.EventSnapshotsActive=Ce;var Se=function(e){function t(){var r=e.call(this,"Event Transmission Counters",t.UUID,{format:"uint32",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000023E-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.EventTransmissionCounters=Se,n.Characteristic.EventTransmissionCounters=Se;var Ee=function(e){function t(){var r=e.call(this,"Filter Change Indication",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000AC-0000-1000-8000-0026BB765291",t.FILTER_OK=0,t.CHANGE_FILTER=1,t}(n.Characteristic);t.FilterChangeIndication=Ee,n.Characteristic.FilterChangeIndication=Ee;var _e=function(e){function t(){var r=e.call(this,"Filter Life Level",t.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000AB-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.FilterLifeLevel=_e,n.Characteristic.FilterLifeLevel=_e;var Te=function(e){function t(){var r=e.call(this,"Firmware Revision",t.UUID,{format:"string",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000052-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.FirmwareRevision=Te,n.Characteristic.FirmwareRevision=Te;var Ae=function(e){function t(){var r=e.call(this,"Firmware Update Readiness",t.UUID,{format:"tlv8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000234-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.FirmwareUpdateReadiness=Ae,n.Characteristic.FirmwareUpdateReadiness=Ae;var Ie=function(e){function t(){var r=e.call(this,"Firmware Update Status",t.UUID,{format:"tlv8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000235-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.FirmwareUpdateStatus=Ie,n.Characteristic.FirmwareUpdateStatus=Ie;var De=function(e){function t(){var r=e.call(this,"Hardware Finish",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000026C-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.HardwareFinish=De,n.Characteristic.HardwareFinish=De;var we=function(e){function t(){var r=e.call(this,"Hardware Revision",t.UUID,{format:"string",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000053-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.HardwareRevision=we,n.Characteristic.HardwareRevision=we;var be=function(e){function t(){var r=e.call(this,"Heart Beat",t.UUID,{format:"uint32",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000024A-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.HeartBeat=be,n.Characteristic.HeartBeat=be;var Ue=function(e){function t(){var r=e.call(this,"Heating Threshold Temperature",t.UUID,{format:"float",perms:["ev","pr","pw"],unit:"celsius",minValue:0,maxValue:25,minStep:.1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000012-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.HeatingThresholdTemperature=Ue,n.Characteristic.HeatingThresholdTemperature=Ue;var Re=function(e){function t(){var r=e.call(this,"Hold Position",t.UUID,{format:"bool",perms:["pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000006F-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.HoldPosition=Re,n.Characteristic.HoldPosition=Re;var Oe=function(e){function t(){var r=e.call(this,"HomeKit Camera Active",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000021B-0000-1000-8000-0026BB765291",t.OFF=0,t.ON=1,t}(n.Characteristic);t.HomeKitCameraActive=Oe,n.Characteristic.HomeKitCameraActive=Oe;var Ne=function(e){function t(){var r=e.call(this,"Hue",t.UUID,{format:"float",perms:["ev","pr","pw"],unit:"arcdegrees",minValue:0,maxValue:360,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000013-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Hue=Ne,n.Characteristic.Hue=Ne;var Pe=function(e){function t(){var r=e.call(this,"Identifier",t.UUID,{format:"uint32",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000E6-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Identifier=Pe,n.Characteristic.Identifier=Pe;var Be=function(e){function t(){var r=e.call(this,"Identify",t.UUID,{format:"bool",perms:["pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000014-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Identify=Be,n.Characteristic.Identify=Be;var Le=function(e){function t(){var r=e.call(this,"Image Mirroring",t.UUID,{format:"bool",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000011F-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ImageMirroring=Le,n.Characteristic.ImageMirroring=Le;var xe=function(e){function t(){var r=e.call(this,"Image Rotation",t.UUID,{format:"int",perms:["ev","pr","pw"],unit:"arcdegrees",minValue:0,maxValue:360,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000011E-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ImageRotation=xe,n.Characteristic.ImageRotation=xe;var Me=function(e){function t(){var r=e.call(this,"Input Device Type",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:6,minStep:1,validValues:[0,1,2,3,4,5,6]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000DC-0000-1000-8000-0026BB765291",t.OTHER=0,t.TV=1,t.RECORDING=2,t.TUNER=3,t.PLAYBACK=4,t.AUDIO_SYSTEM=5,t}(n.Characteristic);t.InputDeviceType=Me,n.Characteristic.InputDeviceType=Me;var Fe=function(e){function t(){var r=e.call(this,"Input Source Type",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:10,minStep:1,validValues:[0,1,2,3,4,5,6,7,8,9,10]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000DB-0000-1000-8000-0026BB765291",t.OTHER=0,t.HOME_SCREEN=1,t.TUNER=2,t.HDMI=3,t.COMPOSITE_VIDEO=4,t.S_VIDEO=5,t.COMPONENT_VIDEO=6,t.DVI=7,t.AIRPLAY=8,t.USB=9,t.APPLICATION=10,t}(n.Characteristic);t.InputSourceType=Fe,n.Characteristic.InputSourceType=Fe;var ke=function(e){function t(){var r=e.call(this,"In Use",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000D2-0000-1000-8000-0026BB765291",t.NOT_IN_USE=0,t.IN_USE=1,t}(n.Characteristic);t.InUse=ke,n.Characteristic.InUse=ke;var Ve=function(e){function t(){var r=e.call(this,"Is Configured",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000D6-0000-1000-8000-0026BB765291",t.NOT_CONFIGURED=0,t.CONFIGURED=1,t}(n.Characteristic);t.IsConfigured=Ve,n.Characteristic.IsConfigured=Ve;var He=function(e){function t(){var r=e.call(this,"Leak Detected",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000070-0000-1000-8000-0026BB765291",t.LEAK_NOT_DETECTED=0,t.LEAK_DETECTED=1,t}(n.Characteristic);t.LeakDetected=He,n.Characteristic.LeakDetected=He;var je=function(e){function t(){var r=e.call(this,"Link Quality",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:1,maxValue:4})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000009C-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.LinkQuality=je,n.Characteristic.LinkQuality=je;var Ge=function(e){function t(){var r=e.call(this,"List Pairings",t.UUID,{format:"tlv8",perms:["pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000050-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ListPairings=Ge,n.Characteristic.ListPairings=Ge;var We=function(e){function t(){var r=e.call(this,"Lock Control Point",t.UUID,{format:"tlv8",perms:["pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000019-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.LockControlPoint=We,n.Characteristic.LockControlPoint=We;var Ye=function(e){function t(){var r=e.call(this,"Lock Current State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000001D-0000-1000-8000-0026BB765291",t.UNSECURED=0,t.SECURED=1,t.JAMMED=2,t.UNKNOWN=3,t}(n.Characteristic);t.LockCurrentState=Ye,n.Characteristic.LockCurrentState=Ye;var qe=function(e){function t(){var r=e.call(this,"Lock Last Known Action",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:10,minStep:1,validValues:[0,1,2,3,4,5,6,7,8,9,10]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000001C-0000-1000-8000-0026BB765291",t.SECURED_PHYSICALLY_INTERIOR=0,t.UNSECURED_PHYSICALLY_INTERIOR=1,t.SECURED_PHYSICALLY_EXTERIOR=2,t.UNSECURED_PHYSICALLY_EXTERIOR=3,t.SECURED_BY_KEYPAD=4,t.UNSECURED_BY_KEYPAD=5,t.SECURED_REMOTELY=6,t.UNSECURED_REMOTELY=7,t.SECURED_BY_AUTO_SECURE_TIMEOUT=8,t.SECURED_PHYSICALLY=9,t.UNSECURED_PHYSICALLY=10,t}(n.Characteristic);t.LockLastKnownAction=qe,n.Characteristic.LockLastKnownAction=qe;var Ke=function(e){function t(){var r=e.call(this,"Lock Management Auto Security Timeout",t.UUID,{format:"uint32",perms:["ev","pr","pw"],unit:"seconds"})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000001A-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.LockManagementAutoSecurityTimeout=Ke,n.Characteristic.LockManagementAutoSecurityTimeout=Ke;var $e=function(e){function t(){var r=e.call(this,"Lock Physical Controls",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000A7-0000-1000-8000-0026BB765291",t.CONTROL_LOCK_DISABLED=0,t.CONTROL_LOCK_ENABLED=1,t}(n.Characteristic);t.LockPhysicalControls=$e,n.Characteristic.LockPhysicalControls=$e;var ze=function(e){function t(){var r=e.call(this,"Lock Target State",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000001E-0000-1000-8000-0026BB765291",t.UNSECURED=0,t.SECURED=1,t}(n.Characteristic);t.LockTargetState=ze,n.Characteristic.LockTargetState=ze;var Qe=function(e){function t(){var r=e.call(this,"Logs",t.UUID,{format:"tlv8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000001F-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Logs=Qe,n.Characteristic.Logs=Qe;var Xe=function(e){function t(){var r=e.call(this,"MAC Retransmission Maximum",t.UUID,{format:"uint8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000247-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.MACRetransmissionMaximum=Xe,n.Characteristic.MACRetransmissionMaximum=Xe;var Je=function(e){function t(){var r=e.call(this,"MAC Transmission Counters",t.UUID,{format:"data",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000248-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.MACTransmissionCounters=Je,n.Characteristic.MACTransmissionCounters=Je;var Ze=function(e){function t(){var r=e.call(this,"Managed Network Enable",t.UUID,{format:"uint8",perms:["ev","pr","pw","tw"],minValue:0,maxValue:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000215-0000-1000-8000-0026BB765291",t.DISABLED=0,t.ENABLED=1,t}(n.Characteristic);t.ManagedNetworkEnable=Ze,n.Characteristic.ManagedNetworkEnable=Ze;var et=function(e){function t(){var r=e.call(this,"Manually Disabled",t.UUID,{format:"bool",perms:["ev","pr"],validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000227-0000-1000-8000-0026BB765291",t.ENABLED=0,t.DISABLED=1,t}(n.Characteristic);t.ManuallyDisabled=et,n.Characteristic.ManuallyDisabled=et;var tt=function(e){function t(){var r=e.call(this,"Manufacturer",t.UUID,{format:"string",perms:["pr"],maxLen:64})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000020-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Manufacturer=tt,n.Characteristic.Manufacturer=tt;var rt=function(e){function t(){var r=e.call(this,"Maximum Transmit Power",t.UUID,{format:"int",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000243-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.MaximumTransmitPower=rt,n.Characteristic.MaximumTransmitPower=rt;var it=function(e){function t(){var r=e.call(this,"Metrics Buffer Full State",t.UUID,{format:"bool",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000272-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.MetricsBufferFullState=it,n.Characteristic.MetricsBufferFullState=it;var nt=function(e){function t(){var r=e.call(this,"Model",t.UUID,{format:"string",perms:["pr"],maxLen:64})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000021-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Model=nt,n.Characteristic.Model=nt;var at=function(e){function t(){var r=e.call(this,"Motion Detected",t.UUID,{format:"bool",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000022-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.MotionDetected=at,n.Characteristic.MotionDetected=at;var ot=function(e){function t(){var r=e.call(this,"Multifunction Button",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000026B-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.MultifunctionButton=ot,n.Characteristic.MultifunctionButton=ot;var st=function(e){function t(){var r=e.call(this,"Mute",t.UUID,{format:"bool",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000011A-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Mute=st,n.Characteristic.Mute=st;var ct=function(e){function t(){var r=e.call(this,"Name",t.UUID,{format:"string",perms:["pr"],maxLen:64})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000023-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Name=ct,n.Characteristic.Name=ct;var ut=function(e){function t(){var r=e.call(this,"Network Access Violation Control",t.UUID,{format:"tlv8",perms:["ev","pr","pw","tw","wr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000021F-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.NetworkAccessViolationControl=ut,n.Characteristic.NetworkAccessViolationControl=ut;var lt=function(e){function t(){var r=e.call(this,"Network Client Profile Control",t.UUID,{format:"tlv8",perms:["ev","pr","pw","tw","wr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000020C-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.NetworkClientProfileControl=lt,n.Characteristic.NetworkClientProfileControl=lt;var ht=function(e){function t(){var r=e.call(this,"Network Client Status Control",t.UUID,{format:"tlv8",perms:["pr","pw","wr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000020D-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.NetworkClientStatusControl=ht,n.Characteristic.NetworkClientStatusControl=ht;var dt=function(e){function t(){var r=e.call(this,"NFC Access Control Point",t.UUID,{format:"tlv8",perms:["pr","pw","wr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000264-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.NFCAccessControlPoint=dt,n.Characteristic.NFCAccessControlPoint=dt;var pt=function(e){function t(){var r=e.call(this,"NFC Access Supported Configuration",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000265-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.NFCAccessSupportedConfiguration=pt,n.Characteristic.NFCAccessSupportedConfiguration=pt;var ft=function(e){function t(){var r=e.call(this,"Night Vision",t.UUID,{format:"bool",perms:["ev","pr","pw","tw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000011B-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.NightVision=ft,n.Characteristic.NightVision=ft;var vt=function(e){function t(){var r=e.call(this,"Nitrogen Dioxide Density",t.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e3,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000C4-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.NitrogenDioxideDensity=vt,n.Characteristic.NitrogenDioxideDensity=vt;var gt=function(e){function t(){var r=e.call(this,"Obstruction Detected",t.UUID,{format:"bool",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000024-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ObstructionDetected=gt,n.Characteristic.ObstructionDetected=gt;var mt=function(e){function t(){var r=e.call(this,"Occupancy Detected",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000071-0000-1000-8000-0026BB765291",t.OCCUPANCY_NOT_DETECTED=0,t.OCCUPANCY_DETECTED=1,t}(n.Characteristic);t.OccupancyDetected=mt,n.Characteristic.OccupancyDetected=mt;var yt=function(e){function t(){var r=e.call(this,"On",t.UUID,{format:"bool",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000025-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.On=yt,n.Characteristic.On=yt;var Ct=function(e){function t(){var r=e.call(this,"Operating State Response",t.UUID,{format:"tlv8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000232-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.OperatingStateResponse=Ct,n.Characteristic.OperatingStateResponse=Ct;var St=function(e){function t(){var r=e.call(this,"Optical Zoom",t.UUID,{format:"float",perms:["ev","pr","pw"],minStep:.1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000011C-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.OpticalZoom=St,n.Characteristic.OpticalZoom=St;var Et=function(e){function t(){var r=e.call(this,"Outlet In Use",t.UUID,{format:"bool",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000026-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.OutletInUse=Et,n.Characteristic.OutletInUse=Et;var _t=function(e){function t(){var r=e.call(this,"Ozone Density",t.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e3,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000C3-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.OzoneDensity=_t,n.Characteristic.OzoneDensity=_t;var Tt=function(e){function t(){var r=e.call(this,"Pairing Features",t.UUID,{format:"uint8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000004F-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.PairingFeatures=Tt,n.Characteristic.PairingFeatures=Tt;var At=function(e){function t(){var r=e.call(this,"Pair Setup",t.UUID,{format:"tlv8",perms:["pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000004C-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.PairSetup=At,n.Characteristic.PairSetup=At;var It=function(e){function t(){var r=e.call(this,"Pair Verify",t.UUID,{format:"tlv8",perms:["pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000004E-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.PairVerify=It,n.Characteristic.PairVerify=It;var Dt=function(e){function t(){var r=e.call(this,"Password Setting",t.UUID,{format:"tlv8",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000E4-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.PasswordSetting=Dt,n.Characteristic.PasswordSetting=Dt;var wt=function(e){function t(){var r=e.call(this,"Periodic Snapshots Active",t.UUID,{format:"uint8",perms:["ev","pr","pw"],validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000225-0000-1000-8000-0026BB765291",t.DISABLE=0,t.ENABLE=1,t}(n.Characteristic);t.PeriodicSnapshotsActive=wt,n.Characteristic.PeriodicSnapshotsActive=wt;var bt=function(e){function t(){var r=e.call(this,"Picture Mode",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:13,minStep:1,validValues:[0,1,2,3,4,5,6,7,8,9,10,11,12,13]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000E2-0000-1000-8000-0026BB765291",t.OTHER=0,t.STANDARD=1,t.CALIBRATED=2,t.CALIBRATED_DARK=3,t.VIVID=4,t.GAME=5,t.COMPUTER=6,t.CUSTOM=7,t}(n.Characteristic);t.PictureMode=bt,n.Characteristic.PictureMode=bt;var Ut=function(e){function t(){var r=e.call(this,"Ping",t.UUID,{format:"data",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000023C-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Ping=Ut,n.Characteristic.Ping=Ut;var Rt=function(e){function t(){var r=e.call(this,"PM10 Density",t.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e3,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000C7-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.PM10Density=Rt,n.Characteristic.PM10Density=Rt;var Ot=function(e){function t(){var r=e.call(this,"PM2.5 Density",t.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e3,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000C6-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.PM2_5Density=Ot,n.Characteristic.PM2_5Density=Ot;var Nt=function(e){function t(){var r=e.call(this,"Position State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000072-0000-1000-8000-0026BB765291",t.DECREASING=0,t.INCREASING=1,t.STOPPED=2,t}(n.Characteristic);t.PositionState=Nt,n.Characteristic.PositionState=Nt;var Pt=function(e){function t(){var r=e.call(this,"Power Mode Selection",t.UUID,{format:"uint8",perms:["pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000DF-0000-1000-8000-0026BB765291",t.SHOW=0,t.HIDE=1,t}(n.Characteristic);t.PowerModeSelection=Pt,n.Characteristic.PowerModeSelection=Pt;var Bt=function(e){function t(){var r=e.call(this,"Product Data",t.UUID,{format:"data",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000220-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ProductData=Bt,n.Characteristic.ProductData=Bt;var Lt=function(e){function t(){var r=e.call(this,"Programmable Switch Event",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000073-0000-1000-8000-0026BB765291",t.SINGLE_PRESS=0,t.DOUBLE_PRESS=1,t.LONG_PRESS=2,t}(n.Characteristic);t.ProgrammableSwitchEvent=Lt,n.Characteristic.ProgrammableSwitchEvent=Lt;var xt=function(e){function t(){var r=e.call(this,"Programmable Switch Output State",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000074-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ProgrammableSwitchOutputState=xt,n.Characteristic.ProgrammableSwitchOutputState=xt;var Mt=function(e){function t(){var r=e.call(this,"Program Mode",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000D1-0000-1000-8000-0026BB765291",t.NO_PROGRAM_SCHEDULED=0,t.PROGRAM_SCHEDULED=1,t.PROGRAM_SCHEDULED_MANUAL_MODE_=2,t}(n.Characteristic);t.ProgramMode=Mt,n.Characteristic.ProgramMode=Mt;var Ft=function(e){function t(){var r=e.call(this,"Reachable",t.UUID,{format:"bool",perms:["pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000063-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Reachable=Ft,n.Characteristic.Reachable=Ft;var kt=function(e){function t(){var r=e.call(this,"Received Signal Strength Indication",t.UUID,{format:"int",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000023F-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ReceivedSignalStrengthIndication=kt,n.Characteristic.ReceivedSignalStrengthIndication=kt;var Vt=function(e){function t(){var r=e.call(this,"Receiver Sensitivity",t.UUID,{format:"int",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000244-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ReceiverSensitivity=Vt,n.Characteristic.ReceiverSensitivity=Vt;var Ht=function(e){function t(){var r=e.call(this,"Recording Audio Active",t.UUID,{format:"uint8",perms:["ev","pr","pw","tw"],validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000226-0000-1000-8000-0026BB765291",t.DISABLE=0,t.ENABLE=1,t}(n.Characteristic);t.RecordingAudioActive=Ht,n.Characteristic.RecordingAudioActive=Ht;var jt=function(e){function t(){var r=e.call(this,"Relative Humidity Dehumidifier Threshold",t.UUID,{format:"float",perms:["ev","pr","pw"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000C9-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.RelativeHumidityDehumidifierThreshold=jt,n.Characteristic.RelativeHumidityDehumidifierThreshold=jt;var Gt=function(e){function t(){var r=e.call(this,"Relative Humidity Humidifier Threshold",t.UUID,{format:"float",perms:["ev","pr","pw"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000CA-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.RelativeHumidityHumidifierThreshold=Gt,n.Characteristic.RelativeHumidityHumidifierThreshold=Gt;var Wt=function(e){function t(){var r=e.call(this,"Relay Control Point",t.UUID,{format:"tlv8",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000005E-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.RelayControlPoint=Wt,n.Characteristic.RelayControlPoint=Wt;var Yt=function(e){function t(){var r=e.call(this,"Relay Enabled",t.UUID,{format:"bool",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000005B-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.RelayEnabled=Yt,n.Characteristic.RelayEnabled=Yt;var qt=function(e){function t(){var r=e.call(this,"Relay State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:5,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000005C-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.RelayState=qt,n.Characteristic.RelayState=qt;var Kt=function(e){function t(){var r=e.call(this,"Remaining Duration",t.UUID,{format:"uint32",perms:["ev","pr"],unit:"seconds",minValue:0,maxValue:3600,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000D4-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.RemainingDuration=Kt,n.Characteristic.RemainingDuration=Kt;var $t=function(e){function t(){var r=e.call(this,"Remote Key",t.UUID,{format:"uint8",perms:["pw"],minValue:0,maxValue:16,minStep:1,validValues:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000E1-0000-1000-8000-0026BB765291",t.REWIND=0,t.FAST_FORWARD=1,t.NEXT_TRACK=2,t.PREVIOUS_TRACK=3,t.ARROW_UP=4,t.ARROW_DOWN=5,t.ARROW_LEFT=6,t.ARROW_RIGHT=7,t.SELECT=8,t.BACK=9,t.EXIT=10,t.PLAY_PAUSE=11,t.INFORMATION=15,t}(n.Characteristic);t.RemoteKey=$t,n.Characteristic.RemoteKey=$t;var zt=function(e){function t(){var r=e.call(this,"Reset Filter Indication",t.UUID,{format:"uint8",perms:["pw"],minValue:1,maxValue:1,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000AD-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ResetFilterIndication=zt,n.Characteristic.ResetFilterIndication=zt;var Qt=function(e){function t(){var r=e.call(this,"Rotation Direction",t.UUID,{format:"int",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000028-0000-1000-8000-0026BB765291",t.CLOCKWISE=0,t.COUNTER_CLOCKWISE=1,t}(n.Characteristic);t.RotationDirection=Qt,n.Characteristic.RotationDirection=Qt;var Xt=function(e){function t(){var r=e.call(this,"Rotation Speed",t.UUID,{format:"float",perms:["ev","pr","pw"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000029-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.RotationSpeed=Xt,n.Characteristic.RotationSpeed=Xt;var Jt=function(e){function t(){var r=e.call(this,"Router Status",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000020E-0000-1000-8000-0026BB765291",t.READY=0,t.NOT_READY=1,t}(n.Characteristic);t.RouterStatus=Jt,n.Characteristic.RouterStatus=Jt;var Zt=function(e){function t(){var r=e.call(this,"Saturation",t.UUID,{format:"float",perms:["ev","pr","pw"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000002F-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Saturation=Zt,n.Characteristic.Saturation=Zt;var er=function(e){function t(){var r=e.call(this,"Security System Alarm Type",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000008E-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SecuritySystemAlarmType=er,n.Characteristic.SecuritySystemAlarmType=er;var tr=function(e){function t(){var r=e.call(this,"Security System Current State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:4,minStep:1,validValues:[0,1,2,3,4]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000066-0000-1000-8000-0026BB765291",t.STAY_ARM=0,t.AWAY_ARM=1,t.NIGHT_ARM=2,t.DISARMED=3,t.ALARM_TRIGGERED=4,t}(n.Characteristic);t.SecuritySystemCurrentState=tr,n.Characteristic.SecuritySystemCurrentState=tr;var rr=function(e){function t(){var r=e.call(this,"Security System Target State",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000067-0000-1000-8000-0026BB765291",t.STAY_ARM=0,t.AWAY_ARM=1,t.NIGHT_ARM=2,t.DISARM=3,t}(n.Characteristic);t.SecuritySystemTargetState=rr,n.Characteristic.SecuritySystemTargetState=rr;var ir=function(e){function t(){var r=e.call(this,"Selected Audio Stream Configuration",t.UUID,{format:"tlv8",perms:["pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000128-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SelectedAudioStreamConfiguration=ir,n.Characteristic.SelectedAudioStreamConfiguration=ir;var nr=function(e){function t(){var r=e.call(this,"Selected Camera Recording Configuration",t.UUID,{format:"tlv8",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000209-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SelectedCameraRecordingConfiguration=nr,n.Characteristic.SelectedCameraRecordingConfiguration=nr;var ar=function(e){function t(){var r=e.call(this,"Selected Diagnostics Modes",t.UUID,{format:"uint32",perms:["pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000024D-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SelectedDiagnosticsModes=ar,n.Characteristic.SelectedDiagnosticsModes=ar;var or=function(e){function t(){var r=e.call(this,"Selected RTP Stream Configuration",t.UUID,{format:"tlv8",perms:["pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000117-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SelectedRTPStreamConfiguration=or,n.Characteristic.SelectedRTPStreamConfiguration=or;var sr=function(e){function t(){var r=e.call(this,"Selected Sleep Configuration",t.UUID,{format:"tlv8",perms:["ev","pr","pw","wr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000252-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SelectedSleepConfiguration=sr,n.Characteristic.SelectedSleepConfiguration=sr;var cr=function(e){function t(){var r=e.call(this,"Serial Number",t.UUID,{format:"string",perms:["pr"],maxLen:64})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000030-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SerialNumber=cr,n.Characteristic.SerialNumber=cr;var ur=function(e){function t(){var r=e.call(this,"Service Label Index",t.UUID,{format:"uint8",perms:["pr"],minValue:1,maxValue:255,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000CB-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ServiceLabelIndex=ur,n.Characteristic.ServiceLabelIndex=ur;var lr=function(e){function t(){var r=e.call(this,"Service Label Namespace",t.UUID,{format:"uint8",perms:["pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000CD-0000-1000-8000-0026BB765291",t.DOTS=0,t.ARABIC_NUMERALS=1,t}(n.Characteristic);t.ServiceLabelNamespace=lr,n.Characteristic.ServiceLabelNamespace=lr;var hr=function(e){function t(){var r=e.call(this,"Set Duration",t.UUID,{format:"uint32",perms:["ev","pr","pw"],unit:"seconds",minValue:0,maxValue:3600,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000D3-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SetDuration=hr,n.Characteristic.SetDuration=hr;var dr=function(e){function t(){var r=e.call(this,"Setup Data Stream Transport",t.UUID,{format:"tlv8",perms:["pr","pw","wr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000131-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SetupDataStreamTransport=dr,n.Characteristic.SetupDataStreamTransport=dr;var pr=function(e){function t(){var r=e.call(this,"Setup Endpoints",t.UUID,{format:"tlv8",perms:["pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000118-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SetupEndpoints=pr,n.Characteristic.SetupEndpoints=pr;var fr=function(e){function t(){var r=e.call(this,"Setup Transfer Transport",t.UUID,{format:"tlv8",perms:["pw","wr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000201-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SetupTransferTransport=fr,n.Characteristic.SetupTransferTransport=fr;var vr=function(e){function t(){var r=e.call(this,"Signal To Noise Ratio",t.UUID,{format:"int",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000241-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SignalToNoiseRatio=vr,n.Characteristic.SignalToNoiseRatio=vr;var gr=function(e){function t(){var r=e.call(this,"Siri Enable",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000255-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SiriEnable=gr,n.Characteristic.SiriEnable=gr;var mr=function(e){function t(){var r=e.call(this,"Siri Endpoint Session Status",t.UUID,{format:"tlv8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000254-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SiriEndpointSessionStatus=mr,n.Characteristic.SiriEndpointSessionStatus=mr;var yr=function(e){function t(){var r=e.call(this,"Siri Engine Version",t.UUID,{format:"string",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000025A-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SiriEngineVersion=yr,n.Characteristic.SiriEngineVersion=yr;var Cr=function(e){function t(){var r=e.call(this,"Siri Input Type",t.UUID,{format:"uint8",perms:["pr"],minValue:0,maxValue:0,validValues:[0]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000132-0000-1000-8000-0026BB765291",t.PUSH_BUTTON_TRIGGERED_APPLE_TV=0,t}(n.Characteristic);t.SiriInputType=Cr,n.Characteristic.SiriInputType=Cr;var Sr=function(e){function t(){var r=e.call(this,"Siri Light On Use",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000258-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SiriLightOnUse=Sr,n.Characteristic.SiriLightOnUse=Sr;var Er=function(e){function t(){var r=e.call(this,"Siri Listening",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000256-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SiriListening=Er,n.Characteristic.SiriListening=Er;var _r=function(e){function t(){var r=e.call(this,"Siri Touch To Use",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000257-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SiriTouchToUse=_r,n.Characteristic.SiriTouchToUse=_r;var Tr=function(e){function t(){var r=e.call(this,"Slat Type",t.UUID,{format:"uint8",perms:["pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000C0-0000-1000-8000-0026BB765291",t.HORIZONTAL=0,t.VERTICAL=1,t}(n.Characteristic);t.SlatType=Tr,n.Characteristic.SlatType=Tr;var Ar=function(e){function t(){var r=e.call(this,"Sleep Discovery Mode",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000E8-0000-1000-8000-0026BB765291",t.NOT_DISCOVERABLE=0,t.ALWAYS_DISCOVERABLE=1,t}(n.Characteristic);t.SleepDiscoveryMode=Ar,n.Characteristic.SleepDiscoveryMode=Ar;var Ir=function(e){function t(){var r=e.call(this,"Sleep Interval",t.UUID,{format:"uint32",perms:["ev","pr"],minValue:0,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000023A-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SleepInterval=Ir,n.Characteristic.SleepInterval=Ir;var Dr=function(e){function t(){var r=e.call(this,"Smoke Detected",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000076-0000-1000-8000-0026BB765291",t.SMOKE_NOT_DETECTED=0,t.SMOKE_DETECTED=1,t}(n.Characteristic);t.SmokeDetected=Dr,n.Characteristic.SmokeDetected=Dr;var wr=function(e){function t(){var r=e.call(this,"Software Revision",t.UUID,{format:"string",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000054-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SoftwareRevision=wr,n.Characteristic.SoftwareRevision=wr;var br=function(e){function t(){var r=e.call(this,"Staged Firmware Version",t.UUID,{format:"string",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000249-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.StagedFirmwareVersion=br,n.Characteristic.StagedFirmwareVersion=br;var Ur=function(e){function t(){var r=e.call(this,"Status Active",t.UUID,{format:"bool",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000075-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.StatusActive=Ur,n.Characteristic.StatusActive=Ur;var Rr=function(e){function t(){var r=e.call(this,"Status Fault",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000077-0000-1000-8000-0026BB765291",t.NO_FAULT=0,t.GENERAL_FAULT=1,t}(n.Characteristic);t.StatusFault=Rr,n.Characteristic.StatusFault=Rr;var Or=function(e){function t(){var r=e.call(this,"Status Jammed",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000078-0000-1000-8000-0026BB765291",t.NOT_JAMMED=0,t.JAMMED=1,t}(n.Characteristic);t.StatusJammed=Or,n.Characteristic.StatusJammed=Or;var Nr=function(e){function t(){var r=e.call(this,"Status Low Battery",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000079-0000-1000-8000-0026BB765291",t.BATTERY_LEVEL_NORMAL=0,t.BATTERY_LEVEL_LOW=1,t}(n.Characteristic);t.StatusLowBattery=Nr,n.Characteristic.StatusLowBattery=Nr;var Pr=function(e){function t(){var r=e.call(this,"Status Tampered",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000007A-0000-1000-8000-0026BB765291",t.NOT_TAMPERED=0,t.TAMPERED=1,t}(n.Characteristic);t.StatusTampered=Pr,n.Characteristic.StatusTampered=Pr;var Br=function(e){function t(){var r=e.call(this,"Streaming Status",t.UUID,{format:"tlv8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000120-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.StreamingStatus=Br,n.Characteristic.StreamingStatus=Br;var Lr=function(e){function t(){var r=e.call(this,"Sulphur Dioxide Density",t.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e3,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000C5-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SulphurDioxideDensity=Lr,n.Characteristic.SulphurDioxideDensity=Lr;var xr=function(e){function t(){var r=e.call(this,"Supported Asset Types",t.UUID,{format:"uint32",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000268-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedAssetTypes=xr,n.Characteristic.SupportedAssetTypes=xr;var Mr=function(e){function t(){var r=e.call(this,"Supported Audio Recording Configuration",t.UUID,{format:"tlv8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000207-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedAudioRecordingConfiguration=Mr,n.Characteristic.SupportedAudioRecordingConfiguration=Mr;var Fr=function(e){function t(){var r=e.call(this,"Supported Audio Stream Configuration",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000115-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedAudioStreamConfiguration=Fr,n.Characteristic.SupportedAudioStreamConfiguration=Fr;var kr=function(e){function t(){var r=e.call(this,"Supported Camera Recording Configuration",t.UUID,{format:"tlv8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000205-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedCameraRecordingConfiguration=kr,n.Characteristic.SupportedCameraRecordingConfiguration=kr;var Vr=function(e){function t(){var r=e.call(this,"Supported Characteristic Value Transition Configuration",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000144-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedCharacteristicValueTransitionConfiguration=Vr,n.Characteristic.SupportedCharacteristicValueTransitionConfiguration=Vr;var Hr=function(e){function t(){var r=e.call(this,"Supported Data Stream Transport Configuration",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000130-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedDataStreamTransportConfiguration=Hr,n.Characteristic.SupportedDataStreamTransportConfiguration=Hr;var jr=function(e){function t(){var r=e.call(this,"Supported Diagnostics Modes",t.UUID,{format:"uint32",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000024C-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedDiagnosticsModes=jr,n.Characteristic.SupportedDiagnosticsModes=jr;var Gr=function(e){function t(){var r=e.call(this,"Supported Diagnostics Snapshot",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000238-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedDiagnosticsSnapshot=Gr,n.Characteristic.SupportedDiagnosticsSnapshot=Gr;var Wr=function(e){function t(){var r=e.call(this,"Supported Firmware Update Configuration",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000233-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedFirmwareUpdateConfiguration=Wr,n.Characteristic.SupportedFirmwareUpdateConfiguration=Wr;var Yr=function(e){function t(){var r=e.call(this,"Supported Metrics",t.UUID,{format:"tlv8",perms:["pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000271-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedMetrics=Yr,n.Characteristic.SupportedMetrics=Yr;var qr=function(e){function t(){var r=e.call(this,"Supported Router Configuration",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000210-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedRouterConfiguration=qr,n.Characteristic.SupportedRouterConfiguration=qr;var Kr=function(e){function t(){var r=e.call(this,"Supported RTP Configuration",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000116-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedRTPConfiguration=Kr,n.Characteristic.SupportedRTPConfiguration=Kr;var $r=function(e){function t(){var r=e.call(this,"Supported Sleep Configuration",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000251-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedSleepConfiguration=$r,n.Characteristic.SupportedSleepConfiguration=$r;var zr=function(e){function t(){var r=e.call(this,"Supported Transfer Transport Configuration",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000202-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedTransferTransportConfiguration=zr,n.Characteristic.SupportedTransferTransportConfiguration=zr;var Qr=function(e){function t(){var r=e.call(this,"Supported Video Recording Configuration",t.UUID,{format:"tlv8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000206-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedVideoRecordingConfiguration=Qr,n.Characteristic.SupportedVideoRecordingConfiguration=Qr;var Xr=function(e){function t(){var r=e.call(this,"Supported Video Stream Configuration",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000114-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedVideoStreamConfiguration=Xr,n.Characteristic.SupportedVideoStreamConfiguration=Xr;var Jr=function(e){function t(){var r=e.call(this,"Swing Mode",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000B6-0000-1000-8000-0026BB765291",t.SWING_DISABLED=0,t.SWING_ENABLED=1,t}(n.Characteristic);t.SwingMode=Jr,n.Characteristic.SwingMode=Jr;var Zr=function(e){function t(){var r=e.call(this,"Tap Type",t.UUID,{format:"uint16",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000022F-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TapType=Zr,n.Characteristic.TapType=Zr;var ei=function(e){function t(){var r=e.call(this,"Target Air Purifier State",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000A8-0000-1000-8000-0026BB765291",t.MANUAL=0,t.AUTO=1,t}(n.Characteristic);t.TargetAirPurifierState=ei,n.Characteristic.TargetAirPurifierState=ei;var ti=function(e){function t(){var r=e.call(this,"Target Air Quality",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:2,validValues:[0,1,2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000AE-0000-1000-8000-0026BB765291",t.EXCELLENT=0,t.GOOD=1,t.FAIR=2,t}(n.Characteristic);t.TargetAirQuality=ti,n.Characteristic.TargetAirQuality=ti;var ri=function(e){function t(){var r=e.call(this,"Target Control List",t.UUID,{format:"tlv8",perms:["pr","pw","wr"],adminOnlyAccess:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000124-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TargetControlList=ri,n.Characteristic.TargetControlList=ri;var ii=function(e){function t(){var r=e.call(this,"Target Control Supported Configuration",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000123-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TargetControlSupportedConfiguration=ii,n.Characteristic.TargetControlSupportedConfiguration=ii;var ni=function(e){function t(){var r=e.call(this,"Target Door State",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000032-0000-1000-8000-0026BB765291",t.OPEN=0,t.CLOSED=1,t}(n.Characteristic);t.TargetDoorState=ni,n.Characteristic.TargetDoorState=ni;var ai=function(e){function t(){var r=e.call(this,"Target Fan State",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000BF-0000-1000-8000-0026BB765291",t.MANUAL=0,t.AUTO=1,t}(n.Characteristic);t.TargetFanState=ai,n.Characteristic.TargetFanState=ai;var oi=function(e){function t(){var r=e.call(this,"Target Heater-Cooler State",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000B2-0000-1000-8000-0026BB765291",t.AUTO=0,t.HEAT=1,t.COOL=2,t}(n.Characteristic);t.TargetHeaterCoolerState=oi,n.Characteristic.TargetHeaterCoolerState=oi;var si=function(e){function t(){var r=e.call(this,"Target Heating Cooling State",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000033-0000-1000-8000-0026BB765291",t.OFF=0,t.HEAT=1,t.COOL=2,t.AUTO=3,t}(n.Characteristic);t.TargetHeatingCoolingState=si,n.Characteristic.TargetHeatingCoolingState=si;var ci=function(e){function t(){var r=e.call(this,"Target Horizontal Tilt Angle",t.UUID,{format:"int",perms:["ev","pr","pw"],unit:"arcdegrees",minValue:-90,maxValue:90,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000007B-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TargetHorizontalTiltAngle=ci,n.Characteristic.TargetHorizontalTiltAngle=ci;var ui=function(e){function t(){var r=e.call(this,"Target Humidifier-Dehumidifier State",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000B4-0000-1000-8000-0026BB765291",t.AUTO=0,t.HUMIDIFIER_OR_DEHUMIDIFIER=0,t.HUMIDIFIER=1,t.DEHUMIDIFIER=2,t}(n.Characteristic);t.TargetHumidifierDehumidifierState=ui,n.Characteristic.TargetHumidifierDehumidifierState=ui;var li=function(e){function t(){var r=e.call(this,"Target Media State",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000137-0000-1000-8000-0026BB765291",t.PLAY=0,t.PAUSE=1,t.STOP=2,t}(n.Characteristic);t.TargetMediaState=li,n.Characteristic.TargetMediaState=li;var hi=function(e){function t(){var r=e.call(this,"Target Position",t.UUID,{format:"uint8",perms:["ev","pr","pw"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000007C-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TargetPosition=hi,n.Characteristic.TargetPosition=hi;var di=function(e){function t(){var r=e.call(this,"Target Relative Humidity",t.UUID,{format:"float",perms:["ev","pr","pw"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000034-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TargetRelativeHumidity=di,n.Characteristic.TargetRelativeHumidity=di;var pi=function(e){function t(){var r=e.call(this,"Target Slat State",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000BE-0000-1000-8000-0026BB765291",t.MANUAL=0,t.AUTO=1,t}(n.Characteristic);t.TargetSlatState=pi,n.Characteristic.TargetSlatState=pi;var fi=function(e){function t(){var r=e.call(this,"Target Temperature",t.UUID,{format:"float",perms:["ev","pr","pw"],unit:"celsius",minValue:10,maxValue:38,minStep:.1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000035-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TargetTemperature=fi,n.Characteristic.TargetTemperature=fi;var vi=function(e){function t(){var r=e.call(this,"Target Tilt Angle",t.UUID,{format:"int",perms:["ev","pr","pw"],unit:"arcdegrees",minValue:-90,maxValue:90,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000C2-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TargetTiltAngle=vi,n.Characteristic.TargetTiltAngle=vi;var gi=function(e){function t(){var r=e.call(this,"Target Vertical Tilt Angle",t.UUID,{format:"int",perms:["ev","pr","pw"],unit:"arcdegrees",minValue:-90,maxValue:90,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000007D-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TargetVerticalTiltAngle=gi,n.Characteristic.TargetVerticalTiltAngle=gi;var mi=function(e){function t(){var r=e.call(this,"Target Visibility State",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000134-0000-1000-8000-0026BB765291",t.SHOWN=0,t.HIDDEN=1,t}(n.Characteristic);t.TargetVisibilityState=mi,n.Characteristic.TargetVisibilityState=mi;var yi=function(e){function t(){var r=e.call(this,"Temperature Display Units",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000036-0000-1000-8000-0026BB765291",t.CELSIUS=0,t.FAHRENHEIT=1,t}(n.Characteristic);t.TemperatureDisplayUnits=yi,n.Characteristic.TemperatureDisplayUnits=yi;var Ci=function(e){function t(){var r=e.call(this,"Third Party Camera Active",t.UUID,{format:"uint8",perms:["ev","pr"],validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000021C-0000-1000-8000-0026BB765291",t.OFF=0,t.ON=1,t}(n.Characteristic);t.ThirdPartyCameraActive=Ci,n.Characteristic.ThirdPartyCameraActive=Ci;var Si=function(e){function t(){var r=e.call(this,"Thread Control Point",t.UUID,{format:"tlv8",perms:["pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000704-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ThreadControlPoint=Si,n.Characteristic.ThreadControlPoint=Si;var Ei=function(e){function t(){var r=e.call(this,"Thread Node Capabilities",t.UUID,{format:"uint16",perms:["pr"],minValue:0,maxValue:31,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000702-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ThreadNodeCapabilities=Ei,n.Characteristic.ThreadNodeCapabilities=Ei;var _i=function(e){function t(){var r=e.call(this,"Thread OpenThread Version",t.UUID,{format:"string",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000706-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ThreadOpenThreadVersion=_i,n.Characteristic.ThreadOpenThreadVersion=_i;var Ti=function(e){function t(){var r=e.call(this,"Thread Status",t.UUID,{format:"uint16",perms:["ev","pr"],minValue:0,maxValue:6,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000703-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ThreadStatus=Ti,n.Characteristic.ThreadStatus=Ti;var Ai=function(e){function t(){var r=e.call(this,"Time Update",t.UUID,{format:"bool",perms:["pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000009A-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TimeUpdate=Ai,n.Characteristic.TimeUpdate=Ai;var Ii=function(e){function t(){var r=e.call(this,"Token",t.UUID,{format:"data",perms:["pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000231-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Token=Ii,n.Characteristic.Token=Ii;var Di=function(e){function t(){var r=e.call(this,"Transmit Power",t.UUID,{format:"int",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000242-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TransmitPower=Di,n.Characteristic.TransmitPower=Di;var wi=function(e){function t(){var r=e.call(this,"Tunnel Connection Timeout",t.UUID,{format:"int",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000061-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TunnelConnectionTimeout=wi,n.Characteristic.TunnelConnectionTimeout=wi;var bi=function(e){function t(){var r=e.call(this,"Tunneled Accessory Advertising",t.UUID,{format:"bool",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000060-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TunneledAccessoryAdvertising=bi,n.Characteristic.TunneledAccessoryAdvertising=bi;var Ui=function(e){function t(){var r=e.call(this,"Tunneled Accessory Connected",t.UUID,{format:"bool",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000059-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TunneledAccessoryConnected=Ui,n.Characteristic.TunneledAccessoryConnected=Ui;var Ri=function(e){function t(){var r=e.call(this,"Tunneled Accessory State Number",t.UUID,{format:"int",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000058-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TunneledAccessoryStateNumber=Ri,n.Characteristic.TunneledAccessoryStateNumber=Ri;var Oi=function(e){function t(){var r=e.call(this,"Valve Type",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000D5-0000-1000-8000-0026BB765291",t.GENERIC_VALVE=0,t.IRRIGATION=1,t.SHOWER_HEAD=2,t.WATER_FAUCET=3,t}(n.Characteristic);t.ValveType=Oi,n.Characteristic.ValveType=Oi;var Ni=function(e){function t(){var r=e.call(this,"Version",t.UUID,{format:"string",perms:["pr"],maxLen:64})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000037-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Version=Ni,n.Characteristic.Version=Ni;var Pi=function(e){function t(){var r=e.call(this,"Video Analysis Active",t.UUID,{format:"uint8",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000229-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.VideoAnalysisActive=Pi,n.Characteristic.VideoAnalysisActive=Pi;var Bi=function(e){function t(){var r=e.call(this,"VOC Density",t.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e3,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000C8-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.VOCDensity=Bi,n.Characteristic.VOCDensity=Bi;var Li=function(e){function t(){var r=e.call(this,"Volume",t.UUID,{format:"uint8",perms:["ev","pr","pw"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000119-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Volume=Li,n.Characteristic.Volume=Li;var xi=function(e){function t(){var r=e.call(this,"Volume Control Type",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000E9-0000-1000-8000-0026BB765291",t.NONE=0,t.RELATIVE=1,t.RELATIVE_WITH_CURRENT=2,t.ABSOLUTE=3,t}(n.Characteristic);t.VolumeControlType=xi,n.Characteristic.VolumeControlType=xi;var Mi=function(e){function t(){var r=e.call(this,"Volume Selector",t.UUID,{format:"uint8",perms:["pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000EA-0000-1000-8000-0026BB765291",t.INCREMENT=0,t.DECREMENT=1,t}(n.Characteristic);t.VolumeSelector=Mi,n.Characteristic.VolumeSelector=Mi;var Fi=function(e){function t(){var r=e.call(this,"Wake Configuration",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000222-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.WakeConfiguration=Fi,n.Characteristic.WakeConfiguration=Fi;var ki=function(e){function t(){var r=e.call(this,"WAN Configuration List",t.UUID,{format:"tlv8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000211-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.WANConfigurationList=ki,n.Characteristic.WANConfigurationList=ki;var Vi=function(e){function t(){var r=e.call(this,"WAN Status List",t.UUID,{format:"tlv8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000212-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.WANStatusList=Vi,n.Characteristic.WANStatusList=Vi;var Hi=function(e){function t(){var r=e.call(this,"Water Level",t.UUID,{format:"float",perms:["ev","pr"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000B5-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.WaterLevel=Hi,n.Characteristic.WaterLevel=Hi;var ji=function(e){function t(){var r=e.call(this,"Wi-Fi Capabilities",t.UUID,{format:"uint32",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000022C-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.WiFiCapabilities=ji,n.Characteristic.WiFiCapabilities=ji;var Gi=function(e){function t(){var r=e.call(this,"Wi-Fi Configuration Control",t.UUID,{format:"tlv8",perms:["ev","pr","pw","tw","wr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000022D-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.WiFiConfigurationControl=Gi,n.Characteristic.WiFiConfigurationControl=Gi;var Wi=function(e){function t(){var r=e.call(this,"Wi-Fi Satellite Status",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,validValues:[0,1,2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000021E-0000-1000-8000-0026BB765291",t.UNKNOWN=0,t.CONNECTED=1,t.NOT_CONNECTED=2,t}(n.Characteristic);t.WiFiSatelliteStatus=Wi,n.Characteristic.WiFiSatelliteStatus=Wi},1647:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SecuritySystem=t.ProtocolInformation=t.PowerManagement=t.Pairing=t.Outlet=t.OccupancySensor=t.NFCAccess=t.MotionSensor=t.Microphone=t.LockMechanism=t.LockManagement=t.LightSensor=t.Lightbulb=t.LeakSensor=t.IrrigationSystem=t.InputSource=t.HumiditySensor=t.HumidifierDehumidifier=t.HeaterCooler=t.GarageDoorOpener=t.FirmwareUpdate=t.FilterMaintenance=t.Faucet=t.Fanv2=t.Fan=t.Doorbell=t.Door=t.Diagnostics=t.DataStreamTransportManagement=t.ContactSensor=t.CloudRelay=t.CarbonMonoxideSensor=t.CarbonDioxideSensor=t.CameraRTPStreamManagement=t.CameraRecordingManagement=t.CameraOperatingMode=t.CameraControl=t.BridgingState=t.BridgeConfiguration=t.Battery=t.AudioStreamManagement=t.Assistant=t.AssetUpdate=t.AirQualitySensor=t.AirPurifier=t.AccessoryRuntimeInformation=t.AccessoryMetrics=t.AccessoryInformation=t.AccessControl=t.AccessCode=void 0,t.WindowCovering=t.Window=t.WiFiTransport=t.WiFiSatellite=t.WiFiRouter=t.Valve=t.Tunnel=t.TransferTransportManagement=t.TimeInformation=t.ThreadTransport=t.Thermostat=t.TemperatureSensor=t.TelevisionSpeaker=t.Television=t.TargetControlManagement=t.TargetControl=t.TapManagement=t.Switch=t.StatelessProgrammableSwitch=t.StatefulProgrammableSwitch=t.Speaker=t.SmokeSensor=t.SmartSpeaker=t.Slats=t.SiriEndpoint=t.Siri=t.ServiceLabel=void 0;var i=r(1635),n=r(9826),a=r(5876),o=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.AccessCodeControlPoint),a.addCharacteristic(n.Characteristic.AccessCodeSupportedConfiguration),a.addCharacteristic(n.Characteristic.ConfigurationState),a}return i.__extends(t,e),t.UUID="00000260-0000-1000-8000-0026BB765291",t}(a.Service);t.AccessCode=o,a.Service.AccessCode=o;var s=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.AccessControlLevel),a.addOptionalCharacteristic(n.Characteristic.PasswordSetting),a}return i.__extends(t,e),t.UUID="000000DA-0000-1000-8000-0026BB765291",t}(a.Service);t.AccessControl=s,a.Service.AccessControl=s;var c=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.Identify),a.addCharacteristic(n.Characteristic.Manufacturer),a.addCharacteristic(n.Characteristic.Model),a.testCharacteristic(n.Characteristic.Name)||a.addCharacteristic(n.Characteristic.Name).updateValue("Unnamed Service"),a.addCharacteristic(n.Characteristic.SerialNumber),a.addCharacteristic(n.Characteristic.FirmwareRevision),a.addOptionalCharacteristic(n.Characteristic.AccessoryFlags),a.addOptionalCharacteristic(n.Characteristic.AppMatchingIdentifier),a.addOptionalCharacteristic(n.Characteristic.ConfiguredName),a.addOptionalCharacteristic(n.Characteristic.HardwareFinish),a.addOptionalCharacteristic(n.Characteristic.HardwareRevision),a.addOptionalCharacteristic(n.Characteristic.ProductData),a.addOptionalCharacteristic(n.Characteristic.SoftwareRevision),a}return i.__extends(t,e),t.UUID="0000003E-0000-1000-8000-0026BB765291",t}(a.Service);t.AccessoryInformation=c,a.Service.AccessoryInformation=c;var u=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.Active),a.addCharacteristic(n.Characteristic.MetricsBufferFullState),a.addCharacteristic(n.Characteristic.SupportedMetrics),a}return i.__extends(t,e),t.UUID="00000270-0000-1000-8000-0026BB765291",t}(a.Service);t.AccessoryMetrics=u,a.Service.AccessoryMetrics=u;var l=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.Ping),a.addOptionalCharacteristic(n.Characteristic.ActivityInterval),a.addOptionalCharacteristic(n.Characteristic.HeartBeat),a.addOptionalCharacteristic(n.Characteristic.SleepInterval),a}return i.__extends(t,e),t.UUID="00000239-0000-1000-8000-0026BB765291",t}(a.Service);t.AccessoryRuntimeInformation=l,a.Service.AccessoryRuntimeInformation=l;var h=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.Active),a.addCharacteristic(n.Characteristic.CurrentAirPurifierState),a.addCharacteristic(n.Characteristic.TargetAirPurifierState),a.addOptionalCharacteristic(n.Characteristic.LockPhysicalControls),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.RotationSpeed),a.addOptionalCharacteristic(n.Characteristic.SwingMode),a}return i.__extends(t,e),t.UUID="000000BB-0000-1000-8000-0026BB765291",t}(a.Service);t.AirPurifier=h,a.Service.AirPurifier=h;var d=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.AirQuality),a.addOptionalCharacteristic(n.Characteristic.NitrogenDioxideDensity),a.addOptionalCharacteristic(n.Characteristic.OzoneDensity),a.addOptionalCharacteristic(n.Characteristic.PM10Density),a.addOptionalCharacteristic(n.Characteristic.PM2_5Density),a.addOptionalCharacteristic(n.Characteristic.SulphurDioxideDensity),a.addOptionalCharacteristic(n.Characteristic.VOCDensity),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.StatusActive),a.addOptionalCharacteristic(n.Characteristic.StatusFault),a.addOptionalCharacteristic(n.Characteristic.StatusLowBattery),a.addOptionalCharacteristic(n.Characteristic.StatusTampered),a}return i.__extends(t,e),t.UUID="0000008D-0000-1000-8000-0026BB765291",t}(a.Service);t.AirQualitySensor=d,a.Service.AirQualitySensor=d;var p=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.AssetUpdateReadiness),a.addCharacteristic(n.Characteristic.SupportedAssetTypes),a}return i.__extends(t,e),t.UUID="00000267-0000-1000-8000-0026BB765291",t}(a.Service);t.AssetUpdate=p,a.Service.AssetUpdate=p;var f=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.Active),a.addCharacteristic(n.Characteristic.Identifier),a.testCharacteristic(n.Characteristic.Name)||a.addCharacteristic(n.Characteristic.Name).updateValue("Unnamed Service"),a}return i.__extends(t,e),t.UUID="0000026A-0000-1000-8000-0026BB765291",t}(a.Service);t.Assistant=f,a.Service.Assistant=f;var v=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.SupportedAudioStreamConfiguration),a.addCharacteristic(n.Characteristic.SelectedAudioStreamConfiguration),a}return i.__extends(t,e),t.UUID="00000127-0000-1000-8000-0026BB765291",t}(a.Service);t.AudioStreamManagement=v,a.Service.AudioStreamManagement=v;var g=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.StatusLowBattery),a.addOptionalCharacteristic(n.Characteristic.BatteryLevel),a.addOptionalCharacteristic(n.Characteristic.ChargingState),a.addOptionalCharacteristic(n.Characteristic.Name),a}return i.__extends(t,e),t.UUID="00000096-0000-1000-8000-0026BB765291",t}(a.Service);t.Battery=g,a.Service.BatteryService=g,a.Service.Battery=g;var m=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.ConfigureBridgedAccessoryStatus),a.addCharacteristic(n.Characteristic.DiscoverBridgedAccessories),a.addCharacteristic(n.Characteristic.DiscoveredBridgedAccessories),a.addCharacteristic(n.Characteristic.ConfigureBridgedAccessory),a.addOptionalCharacteristic(n.Characteristic.Name),a}return i.__extends(t,e),t.UUID="000000A1-0000-1000-8000-0026BB765291",t}(a.Service);t.BridgeConfiguration=m,a.Service.BridgeConfiguration=m;var y=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.Reachable),a.addCharacteristic(n.Characteristic.LinkQuality),a.addCharacteristic(n.Characteristic.AccessoryIdentifier),a.addCharacteristic(n.Characteristic.Category),a.addOptionalCharacteristic(n.Characteristic.Name),a}return i.__extends(t,e),t.UUID="00000062-0000-1000-8000-0026BB765291",t}(a.Service);t.BridgingState=y,a.Service.BridgingState=y;var C=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.On),a.addOptionalCharacteristic(n.Characteristic.CurrentHorizontalTiltAngle),a.addOptionalCharacteristic(n.Characteristic.CurrentVerticalTiltAngle),a.addOptionalCharacteristic(n.Characteristic.TargetHorizontalTiltAngle),a.addOptionalCharacteristic(n.Characteristic.TargetVerticalTiltAngle),a.addOptionalCharacteristic(n.Characteristic.NightVision),a.addOptionalCharacteristic(n.Characteristic.OpticalZoom),a.addOptionalCharacteristic(n.Characteristic.DigitalZoom),a.addOptionalCharacteristic(n.Characteristic.ImageRotation),a.addOptionalCharacteristic(n.Characteristic.ImageMirroring),a.addOptionalCharacteristic(n.Characteristic.Name),a}return i.__extends(t,e),t.UUID="00000111-0000-1000-8000-0026BB765291",t}(a.Service);t.CameraControl=C,a.Service.CameraControl=C;var S=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.EventSnapshotsActive),a.addCharacteristic(n.Characteristic.HomeKitCameraActive),a.addOptionalCharacteristic(n.Characteristic.CameraOperatingModeIndicator),a.addOptionalCharacteristic(n.Characteristic.ManuallyDisabled),a.addOptionalCharacteristic(n.Characteristic.NightVision),a.addOptionalCharacteristic(n.Characteristic.PeriodicSnapshotsActive),a.addOptionalCharacteristic(n.Characteristic.ThirdPartyCameraActive),a.addOptionalCharacteristic(n.Characteristic.DiagonalFieldOfView),a}return i.__extends(t,e),t.UUID="0000021A-0000-1000-8000-0026BB765291",t}(a.Service);t.CameraOperatingMode=S,a.Service.CameraOperatingMode=S;var E=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.Active),a.addCharacteristic(n.Characteristic.SelectedCameraRecordingConfiguration),a.addCharacteristic(n.Characteristic.SupportedAudioRecordingConfiguration),a.addCharacteristic(n.Characteristic.SupportedCameraRecordingConfiguration),a.addCharacteristic(n.Characteristic.SupportedVideoRecordingConfiguration),a.addOptionalCharacteristic(n.Characteristic.RecordingAudioActive),a}return i.__extends(t,e),t.UUID="00000204-0000-1000-8000-0026BB765291",t}(a.Service);t.CameraRecordingManagement=E,a.Service.CameraEventRecordingManagement=E,a.Service.CameraRecordingManagement=E;var _=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.SelectedRTPStreamConfiguration),a.addCharacteristic(n.Characteristic.SetupEndpoints),a.addCharacteristic(n.Characteristic.StreamingStatus),a.addCharacteristic(n.Characteristic.SupportedAudioStreamConfiguration),a.addCharacteristic(n.Characteristic.SupportedRTPConfiguration),a.addCharacteristic(n.Characteristic.SupportedVideoStreamConfiguration),a.addOptionalCharacteristic(n.Characteristic.Active),a}return i.__extends(t,e),t.UUID="00000110-0000-1000-8000-0026BB765291",t}(a.Service);t.CameraRTPStreamManagement=_,a.Service.CameraRTPStreamManagement=_;var T=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.CarbonDioxideDetected),a.addOptionalCharacteristic(n.Characteristic.CarbonDioxideLevel),a.addOptionalCharacteristic(n.Characteristic.CarbonDioxidePeakLevel),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.StatusActive),a.addOptionalCharacteristic(n.Characteristic.StatusFault),a.addOptionalCharacteristic(n.Characteristic.StatusLowBattery),a.addOptionalCharacteristic(n.Characteristic.StatusTampered),a}return i.__extends(t,e),t.UUID="00000097-0000-1000-8000-0026BB765291",t}(a.Service);t.CarbonDioxideSensor=T,a.Service.CarbonDioxideSensor=T;var A=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.CarbonMonoxideDetected),a.addOptionalCharacteristic(n.Characteristic.CarbonMonoxideLevel),a.addOptionalCharacteristic(n.Characteristic.CarbonMonoxidePeakLevel),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.StatusActive),a.addOptionalCharacteristic(n.Characteristic.StatusFault),a.addOptionalCharacteristic(n.Characteristic.StatusLowBattery),a.addOptionalCharacteristic(n.Characteristic.StatusTampered),a}return i.__extends(t,e),t.UUID="0000007F-0000-1000-8000-0026BB765291",t}(a.Service);t.CarbonMonoxideSensor=A,a.Service.CarbonMonoxideSensor=A;var I=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.RelayControlPoint),a.addCharacteristic(n.Characteristic.RelayState),a.addCharacteristic(n.Characteristic.RelayEnabled),a}return i.__extends(t,e),t.UUID="0000005A-0000-1000-8000-0026BB765291",t}(a.Service);t.CloudRelay=I,a.Service.Relay=I,a.Service.CloudRelay=I;var D=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.ContactSensorState),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.StatusActive),a.addOptionalCharacteristic(n.Characteristic.StatusFault),a.addOptionalCharacteristic(n.Characteristic.StatusLowBattery),a.addOptionalCharacteristic(n.Characteristic.StatusTampered),a}return i.__extends(t,e),t.UUID="00000080-0000-1000-8000-0026BB765291",t}(a.Service);t.ContactSensor=D,a.Service.ContactSensor=D;var w=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.SetupDataStreamTransport),a.addCharacteristic(n.Characteristic.SupportedDataStreamTransportConfiguration),a.addCharacteristic(n.Characteristic.Version),a}return i.__extends(t,e),t.UUID="00000129-0000-1000-8000-0026BB765291",t}(a.Service);t.DataStreamTransportManagement=w,a.Service.DataStreamTransportManagement=w;var b=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.SupportedDiagnosticsSnapshot),a.addOptionalCharacteristic(n.Characteristic.SelectedDiagnosticsModes),a.addOptionalCharacteristic(n.Characteristic.SupportedDiagnosticsModes),a}return i.__extends(t,e),t.UUID="00000237-0000-1000-8000-0026BB765291",t}(a.Service);t.Diagnostics=b,a.Service.Diagnostics=b;var U=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.CurrentPosition),a.addCharacteristic(n.Characteristic.PositionState),a.addCharacteristic(n.Characteristic.TargetPosition),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.ObstructionDetected),a.addOptionalCharacteristic(n.Characteristic.HoldPosition),a}return i.__extends(t,e),t.UUID="00000081-0000-1000-8000-0026BB765291",t}(a.Service);t.Door=U,a.Service.Door=U;var R=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.ProgrammableSwitchEvent),a.addOptionalCharacteristic(n.Characteristic.Brightness),a.addOptionalCharacteristic(n.Characteristic.Mute),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.OperatingStateResponse),a.addOptionalCharacteristic(n.Characteristic.Volume),a}return i.__extends(t,e),t.UUID="00000121-0000-1000-8000-0026BB765291",t}(a.Service);t.Doorbell=R,a.Service.Doorbell=R;var O=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.On),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.RotationDirection),a.addOptionalCharacteristic(n.Characteristic.RotationSpeed),a}return i.__extends(t,e),t.UUID="00000040-0000-1000-8000-0026BB765291",t}(a.Service);t.Fan=O,a.Service.Fan=O;var N=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.Active),a.addOptionalCharacteristic(n.Characteristic.CurrentFanState),a.addOptionalCharacteristic(n.Characteristic.TargetFanState),a.addOptionalCharacteristic(n.Characteristic.LockPhysicalControls),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.RotationDirection),a.addOptionalCharacteristic(n.Characteristic.RotationSpeed),a.addOptionalCharacteristic(n.Characteristic.SwingMode),a}return i.__extends(t,e),t.UUID="000000B7-0000-1000-8000-0026BB765291",t}(a.Service);t.Fanv2=N,a.Service.Fanv2=N;var P=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.Active),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.StatusFault),a}return i.__extends(t,e),t.UUID="000000D7-0000-1000-8000-0026BB765291",t}(a.Service);t.Faucet=P,a.Service.Faucet=P;var B=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.FilterChangeIndication),a.addOptionalCharacteristic(n.Characteristic.FilterLifeLevel),a.addOptionalCharacteristic(n.Characteristic.ResetFilterIndication),a.addOptionalCharacteristic(n.Characteristic.Name),a}return i.__extends(t,e),t.UUID="000000BA-0000-1000-8000-0026BB765291",t}(a.Service);t.FilterMaintenance=B,a.Service.FilterMaintenance=B;var L=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.FirmwareUpdateReadiness),a.addCharacteristic(n.Characteristic.FirmwareUpdateStatus),a.addOptionalCharacteristic(n.Characteristic.StagedFirmwareVersion),a.addOptionalCharacteristic(n.Characteristic.SupportedFirmwareUpdateConfiguration),a}return i.__extends(t,e),t.UUID="00000236-0000-1000-8000-0026BB765291",t}(a.Service);t.FirmwareUpdate=L,a.Service.FirmwareUpdate=L;var x=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.CurrentDoorState),a.addCharacteristic(n.Characteristic.TargetDoorState),a.addCharacteristic(n.Characteristic.ObstructionDetected),a.addOptionalCharacteristic(n.Characteristic.LockCurrentState),a.addOptionalCharacteristic(n.Characteristic.LockTargetState),a.addOptionalCharacteristic(n.Characteristic.Name),a}return i.__extends(t,e),t.UUID="00000041-0000-1000-8000-0026BB765291",t}(a.Service);t.GarageDoorOpener=x,a.Service.GarageDoorOpener=x;var M=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.Active),a.addCharacteristic(n.Characteristic.CurrentHeaterCoolerState),a.addCharacteristic(n.Characteristic.TargetHeaterCoolerState),a.addCharacteristic(n.Characteristic.CurrentTemperature),a.addOptionalCharacteristic(n.Characteristic.LockPhysicalControls),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.RotationSpeed),a.addOptionalCharacteristic(n.Characteristic.SwingMode),a.addOptionalCharacteristic(n.Characteristic.CoolingThresholdTemperature),a.addOptionalCharacteristic(n.Characteristic.HeatingThresholdTemperature),a.addOptionalCharacteristic(n.Characteristic.TemperatureDisplayUnits),a}return i.__extends(t,e),t.UUID="000000BC-0000-1000-8000-0026BB765291",t}(a.Service);t.HeaterCooler=M,a.Service.HeaterCooler=M;var F=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.Active),a.addCharacteristic(n.Characteristic.CurrentHumidifierDehumidifierState),a.addCharacteristic(n.Characteristic.TargetHumidifierDehumidifierState),a.addCharacteristic(n.Characteristic.CurrentRelativeHumidity),a.addOptionalCharacteristic(n.Characteristic.LockPhysicalControls),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.RelativeHumidityDehumidifierThreshold),a.addOptionalCharacteristic(n.Characteristic.RelativeHumidityHumidifierThreshold),a.addOptionalCharacteristic(n.Characteristic.RotationSpeed),a.addOptionalCharacteristic(n.Characteristic.SwingMode),a.addOptionalCharacteristic(n.Characteristic.WaterLevel),a}return i.__extends(t,e),t.UUID="000000BD-0000-1000-8000-0026BB765291",t}(a.Service);t.HumidifierDehumidifier=F,a.Service.HumidifierDehumidifier=F;var k=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.CurrentRelativeHumidity),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.StatusActive),a.addOptionalCharacteristic(n.Characteristic.StatusFault),a.addOptionalCharacteristic(n.Characteristic.StatusLowBattery),a.addOptionalCharacteristic(n.Characteristic.StatusTampered),a}return i.__extends(t,e),t.UUID="00000082-0000-1000-8000-0026BB765291",t}(a.Service);t.HumiditySensor=k,a.Service.HumiditySensor=k;var V=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.ConfiguredName),a.addCharacteristic(n.Characteristic.InputSourceType),a.addCharacteristic(n.Characteristic.IsConfigured),a.testCharacteristic(n.Characteristic.Name)||a.addCharacteristic(n.Characteristic.Name).updateValue("Unnamed Service"),a.addCharacteristic(n.Characteristic.CurrentVisibilityState),a.addOptionalCharacteristic(n.Characteristic.Identifier),a.addOptionalCharacteristic(n.Characteristic.InputDeviceType),a.addOptionalCharacteristic(n.Characteristic.TargetVisibilityState),a}return i.__extends(t,e),t.UUID="000000D9-0000-1000-8000-0026BB765291",t}(a.Service);t.InputSource=V,a.Service.InputSource=V;var H=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.Active),a.addCharacteristic(n.Characteristic.ProgramMode),a.addCharacteristic(n.Characteristic.InUse),a.addOptionalCharacteristic(n.Characteristic.RemainingDuration),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.StatusFault),a}return i.__extends(t,e),t.UUID="000000CF-0000-1000-8000-0026BB765291",t}(a.Service);t.IrrigationSystem=H,a.Service.IrrigationSystem=H;var j=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.LeakDetected),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.StatusActive),a.addOptionalCharacteristic(n.Characteristic.StatusFault),a.addOptionalCharacteristic(n.Characteristic.StatusLowBattery),a.addOptionalCharacteristic(n.Characteristic.StatusTampered),a}return i.__extends(t,e),t.UUID="00000083-0000-1000-8000-0026BB765291",t}(a.Service);t.LeakSensor=j,a.Service.LeakSensor=j;var G=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.On),a.addOptionalCharacteristic(n.Characteristic.Brightness),a.addOptionalCharacteristic(n.Characteristic.CharacteristicValueActiveTransitionCount),a.addOptionalCharacteristic(n.Characteristic.CharacteristicValueTransitionControl),a.addOptionalCharacteristic(n.Characteristic.ColorTemperature),a.addOptionalCharacteristic(n.Characteristic.Hue),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.Saturation),a.addOptionalCharacteristic(n.Characteristic.SupportedCharacteristicValueTransitionConfiguration),a}return i.__extends(t,e),t.UUID="00000043-0000-1000-8000-0026BB765291",t}(a.Service);t.Lightbulb=G,a.Service.Lightbulb=G;var W=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.CurrentAmbientLightLevel),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.StatusActive),a.addOptionalCharacteristic(n.Characteristic.StatusFault),a.addOptionalCharacteristic(n.Characteristic.StatusLowBattery),a.addOptionalCharacteristic(n.Characteristic.StatusTampered),a}return i.__extends(t,e),t.UUID="00000084-0000-1000-8000-0026BB765291",t}(a.Service);t.LightSensor=W,a.Service.LightSensor=W;var Y=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.LockControlPoint),a.addCharacteristic(n.Characteristic.Version),a.addOptionalCharacteristic(n.Characteristic.AdministratorOnlyAccess),a.addOptionalCharacteristic(n.Characteristic.AudioFeedback),a.addOptionalCharacteristic(n.Characteristic.CurrentDoorState),a.addOptionalCharacteristic(n.Characteristic.LockManagementAutoSecurityTimeout),a.addOptionalCharacteristic(n.Characteristic.LockLastKnownAction),a.addOptionalCharacteristic(n.Characteristic.Logs),a.addOptionalCharacteristic(n.Characteristic.MotionDetected),a}return i.__extends(t,e),t.UUID="00000044-0000-1000-8000-0026BB765291",t}(a.Service);t.LockManagement=Y,a.Service.LockManagement=Y;var q=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.LockCurrentState),a.addCharacteristic(n.Characteristic.LockTargetState),a.addOptionalCharacteristic(n.Characteristic.Name),a}return i.__extends(t,e),t.UUID="00000045-0000-1000-8000-0026BB765291",t}(a.Service);t.LockMechanism=q,a.Service.LockMechanism=q;var K=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.Mute),a.addOptionalCharacteristic(n.Characteristic.Volume),a}return i.__extends(t,e),t.UUID="00000112-0000-1000-8000-0026BB765291",t}(a.Service);t.Microphone=K,a.Service.Microphone=K;var $=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.MotionDetected),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.StatusActive),a.addOptionalCharacteristic(n.Characteristic.StatusFault),a.addOptionalCharacteristic(n.Characteristic.StatusLowBattery),a.addOptionalCharacteristic(n.Characteristic.StatusTampered),a}return i.__extends(t,e),t.UUID="00000085-0000-1000-8000-0026BB765291",t}(a.Service);t.MotionSensor=$,a.Service.MotionSensor=$;var z=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.ConfigurationState),a.addCharacteristic(n.Characteristic.NFCAccessControlPoint),a.addCharacteristic(n.Characteristic.NFCAccessSupportedConfiguration),a}return i.__extends(t,e),t.UUID="00000266-0000-1000-8000-0026BB765291",t}(a.Service);t.NFCAccess=z,a.Service.NFCAccess=z;var Q=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.OccupancyDetected),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.StatusActive),a.addOptionalCharacteristic(n.Characteristic.StatusFault),a.addOptionalCharacteristic(n.Characteristic.StatusLowBattery),a.addOptionalCharacteristic(n.Characteristic.StatusTampered),a}return i.__extends(t,e),t.UUID="00000086-0000-1000-8000-0026BB765291",t}(a.Service);t.OccupancySensor=Q,a.Service.OccupancySensor=Q;var X=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.On),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.OutletInUse),a}return i.__extends(t,e),t.UUID="00000047-0000-1000-8000-0026BB765291",t}(a.Service);t.Outlet=X,a.Service.Outlet=X;var J=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.ListPairings),a.addCharacteristic(n.Characteristic.PairSetup),a.addCharacteristic(n.Characteristic.PairVerify),a.addCharacteristic(n.Characteristic.PairingFeatures),a}return i.__extends(t,e),t.UUID="00000055-0000-1000-8000-0026BB765291",t}(a.Service);t.Pairing=J,a.Service.Pairing=J;var Z=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.WakeConfiguration),a.addOptionalCharacteristic(n.Characteristic.SelectedSleepConfiguration),a.addOptionalCharacteristic(n.Characteristic.SupportedSleepConfiguration),a}return i.__extends(t,e),t.UUID="00000221-0000-1000-8000-0026BB765291",t}(a.Service);t.PowerManagement=Z,a.Service.PowerManagement=Z;var ee=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.Version),a}return i.__extends(t,e),t.UUID="000000A2-0000-1000-8000-0026BB765291",t}(a.Service);t.ProtocolInformation=ee,a.Service.ProtocolInformation=ee;var te=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.SecuritySystemCurrentState),a.addCharacteristic(n.Characteristic.SecuritySystemTargetState),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.SecuritySystemAlarmType),a.addOptionalCharacteristic(n.Characteristic.StatusFault),a.addOptionalCharacteristic(n.Characteristic.StatusTampered),a}return i.__extends(t,e),t.UUID="0000007E-0000-1000-8000-0026BB765291",t}(a.Service);t.SecuritySystem=te,a.Service.SecuritySystem=te;var re=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.ServiceLabelNamespace),a}return i.__extends(t,e),t.UUID="000000CC-0000-1000-8000-0026BB765291",t}(a.Service);t.ServiceLabel=re,a.Service.ServiceLabel=re;var ie=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.SiriInputType),a.addOptionalCharacteristic(n.Characteristic.MultifunctionButton),a.addOptionalCharacteristic(n.Characteristic.SiriEnable),a.addOptionalCharacteristic(n.Characteristic.SiriEngineVersion),a.addOptionalCharacteristic(n.Characteristic.SiriLightOnUse),a.addOptionalCharacteristic(n.Characteristic.SiriListening),a.addOptionalCharacteristic(n.Characteristic.SiriTouchToUse),a}return i.__extends(t,e),t.UUID="00000133-0000-1000-8000-0026BB765291",t}(a.Service);t.Siri=ie,a.Service.Siri=ie;var ne=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.SiriEndpointSessionStatus),a.addCharacteristic(n.Characteristic.Version),a.addOptionalCharacteristic(n.Characteristic.ActiveIdentifier),a.addOptionalCharacteristic(n.Characteristic.ManuallyDisabled),a}return i.__extends(t,e),t.UUID="00000253-0000-1000-8000-0026BB765291",t}(a.Service);t.SiriEndpoint=ne,a.Service.SiriEndpoint=ne;var ae=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.CurrentSlatState),a.addCharacteristic(n.Characteristic.SlatType),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.SwingMode),a.addOptionalCharacteristic(n.Characteristic.CurrentTiltAngle),a.addOptionalCharacteristic(n.Characteristic.TargetTiltAngle),a}return i.__extends(t,e),t.UUID="000000B9-0000-1000-8000-0026BB765291",t}(a.Service);t.Slats=ae,a.Service.Slat=ae,a.Service.Slats=ae;var oe=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.CurrentMediaState),a.addCharacteristic(n.Characteristic.TargetMediaState),a.addOptionalCharacteristic(n.Characteristic.AirPlayEnable),a.addOptionalCharacteristic(n.Characteristic.ConfiguredName),a.addOptionalCharacteristic(n.Characteristic.Mute),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.Volume),a}return i.__extends(t,e),t.UUID="00000228-0000-1000-8000-0026BB765291",t}(a.Service);t.SmartSpeaker=oe,a.Service.SmartSpeaker=oe;var se=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.SmokeDetected),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.StatusActive),a.addOptionalCharacteristic(n.Characteristic.StatusFault),a.addOptionalCharacteristic(n.Characteristic.StatusLowBattery),a.addOptionalCharacteristic(n.Characteristic.StatusTampered),a}return i.__extends(t,e),t.UUID="00000087-0000-1000-8000-0026BB765291",t}(a.Service);t.SmokeSensor=se,a.Service.SmokeSensor=se;var ce=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.Mute),a.addOptionalCharacteristic(n.Characteristic.Active),a.addOptionalCharacteristic(n.Characteristic.Volume),a}return i.__extends(t,e),t.UUID="00000113-0000-1000-8000-0026BB765291",t}(a.Service);t.Speaker=ce,a.Service.Speaker=ce;var ue=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.ProgrammableSwitchEvent),a.addCharacteristic(n.Characteristic.ProgrammableSwitchOutputState),a.addOptionalCharacteristic(n.Characteristic.Name),a}return i.__extends(t,e),t.UUID="00000088-0000-1000-8000-0026BB765291",t}(a.Service);t.StatefulProgrammableSwitch=ue,a.Service.StatefulProgrammableSwitch=ue;var le=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.ProgrammableSwitchEvent),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.ServiceLabelIndex),a}return i.__extends(t,e),t.UUID="00000089-0000-1000-8000-0026BB765291",t}(a.Service);t.StatelessProgrammableSwitch=le,a.Service.StatelessProgrammableSwitch=le;var he=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.On),a.addOptionalCharacteristic(n.Characteristic.Name),a}return i.__extends(t,e),t.UUID="00000049-0000-1000-8000-0026BB765291",t}(a.Service);t.Switch=he,a.Service.Switch=he;var de=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.Active),a.addCharacteristic(n.Characteristic.CryptoHash),a.addCharacteristic(n.Characteristic.TapType),a.addCharacteristic(n.Characteristic.Token),a}return i.__extends(t,e),t.UUID="0000022E-0000-1000-8000-0026BB765291",t}(a.Service);t.TapManagement=de,a.Service.TapManagement=de;var pe=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.Active),a.addCharacteristic(n.Characteristic.ActiveIdentifier),a.addCharacteristic(n.Characteristic.ButtonEvent),a.addOptionalCharacteristic(n.Characteristic.Name),a}return i.__extends(t,e),t.UUID="00000125-0000-1000-8000-0026BB765291",t}(a.Service);t.TargetControl=pe,a.Service.TargetControl=pe;var fe=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.TargetControlSupportedConfiguration),a.addCharacteristic(n.Characteristic.TargetControlList),a}return i.__extends(t,e),t.UUID="00000122-0000-1000-8000-0026BB765291",t}(a.Service);t.TargetControlManagement=fe,a.Service.TargetControlManagement=fe;var ve=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.Active),a.addCharacteristic(n.Characteristic.ActiveIdentifier),a.addCharacteristic(n.Characteristic.ConfiguredName),a.addCharacteristic(n.Characteristic.RemoteKey),a.addCharacteristic(n.Characteristic.SleepDiscoveryMode),a.addOptionalCharacteristic(n.Characteristic.Brightness),a.addOptionalCharacteristic(n.Characteristic.ClosedCaptions),a.addOptionalCharacteristic(n.Characteristic.DisplayOrder),a.addOptionalCharacteristic(n.Characteristic.CurrentMediaState),a.addOptionalCharacteristic(n.Characteristic.TargetMediaState),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.PictureMode),a.addOptionalCharacteristic(n.Characteristic.PowerModeSelection),a}return i.__extends(t,e),t.UUID="000000D8-0000-1000-8000-0026BB765291",t}(a.Service);t.Television=ve,a.Service.Television=ve;var ge=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.Mute),a.addOptionalCharacteristic(n.Characteristic.Active),a.addOptionalCharacteristic(n.Characteristic.Volume),a.addOptionalCharacteristic(n.Characteristic.VolumeControlType),a.addOptionalCharacteristic(n.Characteristic.VolumeSelector),a}return i.__extends(t,e),t.UUID="00000113-0000-1000-8000-0026BB765291",t}(a.Service);t.TelevisionSpeaker=ge,a.Service.TelevisionSpeaker=ge;var me=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.CurrentTemperature),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.StatusActive),a.addOptionalCharacteristic(n.Characteristic.StatusFault),a.addOptionalCharacteristic(n.Characteristic.StatusLowBattery),a.addOptionalCharacteristic(n.Characteristic.StatusTampered),a}return i.__extends(t,e),t.UUID="0000008A-0000-1000-8000-0026BB765291",t}(a.Service);t.TemperatureSensor=me,a.Service.TemperatureSensor=me;var ye=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.CurrentHeatingCoolingState),a.addCharacteristic(n.Characteristic.TargetHeatingCoolingState),a.addCharacteristic(n.Characteristic.CurrentTemperature),a.addCharacteristic(n.Characteristic.TargetTemperature),a.addCharacteristic(n.Characteristic.TemperatureDisplayUnits),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.CurrentRelativeHumidity),a.addOptionalCharacteristic(n.Characteristic.TargetRelativeHumidity),a.addOptionalCharacteristic(n.Characteristic.CoolingThresholdTemperature),a.addOptionalCharacteristic(n.Characteristic.HeatingThresholdTemperature),a}return i.__extends(t,e),t.UUID="0000004A-0000-1000-8000-0026BB765291",t}(a.Service);t.Thermostat=ye,a.Service.Thermostat=ye;var Ce=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.CurrentTransport),a.addCharacteristic(n.Characteristic.ThreadControlPoint),a.addCharacteristic(n.Characteristic.ThreadNodeCapabilities),a.addCharacteristic(n.Characteristic.ThreadStatus),a.addOptionalCharacteristic(n.Characteristic.CCAEnergyDetectThreshold),a.addOptionalCharacteristic(n.Characteristic.CCASignalDetectThreshold),a.addOptionalCharacteristic(n.Characteristic.EventRetransmissionMaximum),a.addOptionalCharacteristic(n.Characteristic.EventTransmissionCounters),a.addOptionalCharacteristic(n.Characteristic.MACRetransmissionMaximum),a.addOptionalCharacteristic(n.Characteristic.MACTransmissionCounters),a.addOptionalCharacteristic(n.Characteristic.ReceiverSensitivity),a.addOptionalCharacteristic(n.Characteristic.ReceivedSignalStrengthIndication),a.addOptionalCharacteristic(n.Characteristic.SignalToNoiseRatio),a.addOptionalCharacteristic(n.Characteristic.ThreadOpenThreadVersion),a.addOptionalCharacteristic(n.Characteristic.TransmitPower),a.addOptionalCharacteristic(n.Characteristic.MaximumTransmitPower),a}return i.__extends(t,e),t.UUID="00000701-0000-1000-8000-0026BB765291",t}(a.Service);t.ThreadTransport=Ce,a.Service.ThreadTransport=Ce;var Se=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.CurrentTime),a.addCharacteristic(n.Characteristic.DayoftheWeek),a.addCharacteristic(n.Characteristic.TimeUpdate),a.addOptionalCharacteristic(n.Characteristic.Name),a}return i.__extends(t,e),t.UUID="00000099-0000-1000-8000-0026BB765291",t}(a.Service);t.TimeInformation=Se,a.Service.TimeInformation=Se;var Ee=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.SupportedTransferTransportConfiguration),a.addCharacteristic(n.Characteristic.SetupTransferTransport),a}return i.__extends(t,e),t.UUID="00000203-0000-1000-8000-0026BB765291",t}(a.Service);t.TransferTransportManagement=Ee,a.Service.TransferTransportManagement=Ee;var _e=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.AccessoryIdentifier),a.addCharacteristic(n.Characteristic.TunnelConnectionTimeout),a.addCharacteristic(n.Characteristic.TunneledAccessoryAdvertising),a.addCharacteristic(n.Characteristic.TunneledAccessoryConnected),a.addCharacteristic(n.Characteristic.TunneledAccessoryStateNumber),a}return i.__extends(t,e),t.UUID="00000056-0000-1000-8000-0026BB765291",t}(a.Service);t.Tunnel=_e,a.Service.TunneledBTLEAccessoryService=_e,a.Service.Tunnel=_e;var Te=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.Active),a.addCharacteristic(n.Characteristic.InUse),a.addCharacteristic(n.Characteristic.ValveType),a.addOptionalCharacteristic(n.Characteristic.IsConfigured),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.RemainingDuration),a.addOptionalCharacteristic(n.Characteristic.ServiceLabelIndex),a.addOptionalCharacteristic(n.Characteristic.SetDuration),a.addOptionalCharacteristic(n.Characteristic.StatusFault),a}return i.__extends(t,e),t.UUID="000000D0-0000-1000-8000-0026BB765291",t}(a.Service);t.Valve=Te,a.Service.Valve=Te;var Ae=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.ConfiguredName),a.addCharacteristic(n.Characteristic.ManagedNetworkEnable),a.addCharacteristic(n.Characteristic.NetworkAccessViolationControl),a.addCharacteristic(n.Characteristic.NetworkClientProfileControl),a.addCharacteristic(n.Characteristic.NetworkClientStatusControl),a.addCharacteristic(n.Characteristic.RouterStatus),a.addCharacteristic(n.Characteristic.SupportedRouterConfiguration),a.addCharacteristic(n.Characteristic.WANConfigurationList),a.addCharacteristic(n.Characteristic.WANStatusList),a}return i.__extends(t,e),t.UUID="0000020A-0000-1000-8000-0026BB765291",t}(a.Service);t.WiFiRouter=Ae,a.Service.WiFiRouter=Ae;var Ie=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.WiFiSatelliteStatus),a}return i.__extends(t,e),t.UUID="0000020F-0000-1000-8000-0026BB765291",t}(a.Service);t.WiFiSatellite=Ie,a.Service.WiFiSatellite=Ie;var De=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.CurrentTransport),a.addCharacteristic(n.Characteristic.WiFiCapabilities),a.addOptionalCharacteristic(n.Characteristic.WiFiConfigurationControl),a}return i.__extends(t,e),t.UUID="0000022A-0000-1000-8000-0026BB765291",t}(a.Service);t.WiFiTransport=De,a.Service.WiFiTransport=De;var we=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.CurrentPosition),a.addCharacteristic(n.Characteristic.PositionState),a.addCharacteristic(n.Characteristic.TargetPosition),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.ObstructionDetected),a.addOptionalCharacteristic(n.Characteristic.HoldPosition),a}return i.__extends(t,e),t.UUID="0000008B-0000-1000-8000-0026BB765291",t}(a.Service);t.Window=we,a.Service.Window=we;var be=function(e){function t(r,i){var a=e.call(this,r,t.UUID,i)||this;return a.addCharacteristic(n.Characteristic.CurrentPosition),a.addCharacteristic(n.Characteristic.PositionState),a.addCharacteristic(n.Characteristic.TargetPosition),a.addOptionalCharacteristic(n.Characteristic.CurrentHorizontalTiltAngle),a.addOptionalCharacteristic(n.Characteristic.TargetHorizontalTiltAngle),a.addOptionalCharacteristic(n.Characteristic.Name),a.addOptionalCharacteristic(n.Characteristic.ObstructionDetected),a.addOptionalCharacteristic(n.Characteristic.HoldPosition),a.addOptionalCharacteristic(n.Characteristic.CurrentVerticalTiltAngle),a.addOptionalCharacteristic(n.Characteristic.TargetVerticalTiltAngle),a}return i.__extends(t,e),t.UUID="0000008C-0000-1000-8000-0026BB765291",t}(a.Service);t.WindowCovering=be,a.Service.WindowCovering=be},8086:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(1635);i.__exportStar(r(651),t),i.__exportStar(r(1647),t)},5579:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AccessoryInfo=t.PermissionTypes=void 0;var i=r(1635),n=i.__importDefault(r(2613)),a=i.__importDefault(r(6982)),o=i.__importDefault(r(8947)),s=i.__importDefault(r(9023)),c=r(9593),u=r(4299);function l(){return r(8389).version}!function(e){e[e.USER=0]="USER",e[e.ADMIN=1]="ADMIN"}(t.PermissionTypes||(t.PermissionTypes={}));var h=function(){function e(e){var t=this;this.configVersion=1,this.lastFirmwareVersion="",this.paired=function(){return Object.keys(t.pairedClients).length>0},this.username=e,this.displayName="",this.model="",this.category=1,this.pincode="",this.signSk=Buffer.alloc(0),this.signPk=Buffer.alloc(0),this.pairedClients={},this.pairedAdminClients=0,this.configHash="",this.setupID=""}return e.prototype.addPairedClient=function(e,t,r){this.pairedClients[e]={username:e,publicKey:t,permission:r},1===r&&this.pairedAdminClients++},e.prototype.updatePermission=function(e,t){var r=this.pairedClients[e];if(r){var i=r.permission;r.permission=t,1===i&&1!==t?this.pairedAdminClients--:1!==i&&1===t&&this.pairedAdminClients++}},e.prototype.listPairings=function(){var e,t,r=[];try{for(var n=i.__values(Object.values(this.pairedClients)),a=n.next();!a.done;a=n.next()){var o=a.value;r.push(o)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return r},e.prototype.removePairedClient=function(e,t){var r,n;if(this._removePairedClient0(e,t),0===this.pairedAdminClients)try{for(var a=i.__values(Object.keys(this.pairedClients)),o=a.next();!o.done;o=a.next()){var s=o.value;this._removePairedClient0(e,s)}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},e.prototype._removePairedClient0=function(e,t){this.pairedClients[t]&&1===this.pairedClients[t].permission&&this.pairedAdminClients--,delete this.pairedClients[t],c.EventedHTTPServer.destroyExistingConnectionsAfterUnpair(e,t)},e.prototype.isPaired=function(e){return!!this.pairedClients[e]},e.prototype.hasAdminPermissions=function(e){if(!e)return!1;var t=this.pairedClients[e];return!!t&&1===t.permission},e.prototype.getClientPublicKey=function(e){var t=this.pairedClients[e];return t?t.publicKey:void 0},e.prototype.checkForCurrentConfigurationNumberIncrement=function(e,t){var r=a.default.createHash("sha1");r.update(JSON.stringify(e));var i=r.digest("hex"),n=!1;if(i!==this.configHash&&(this.configVersion++,this.configHash=i,this.ensureConfigVersionBounds(),n=!0),t){var o=l();this.lastFirmwareVersion!==o&&(this.lastFirmwareVersion=o,n=!0)}return n&&this.save(),n},e.prototype.getConfigVersion=function(){return this.configVersion},e.prototype.ensureConfigVersionBounds=function(){this.configVersion=this.configVersion%65536,0===this.configVersion&&(this.configVersion=1)},e.prototype.save=function(){var t,r,n={displayName:this.displayName,category:this.category,pincode:this.pincode,signSk:this.signSk.toString("hex"),signPk:this.signPk.toString("hex"),pairedClients:{},pairedClientsPermission:{},configVersion:this.configVersion,configHash:this.configHash,setupID:this.setupID,lastFirmwareVersion:this.lastFirmwareVersion};try{for(var a=i.__values(Object.entries(this.pairedClients)),o=a.next();!o.done;o=a.next()){var s=i.__read(o.value,2),c=s[0],l=s[1];n.pairedClients[c]=l.publicKey.toString("hex"),n.pairedClientsPermission[c]=l.permission}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}var h=e.persistKey(this.username);u.HAPStorage.storage().setItemSync(h,n)},e.persistKey=function(e){return s.default.format("AccessoryInfo.%s.json",e.replace(/:/g,"").toUpperCase())},e.create=function(t){e.assertValidUsername(t);var r=new e(t);r.lastFirmwareVersion=l();var i=o.default.sign.keyPair();return r.signSk=Buffer.from(i.secretKey),r.signPk=Buffer.from(i.publicKey),r},e.load=function(t){var r,n;e.assertValidUsername(t);var a=e.persistKey(t),o=u.HAPStorage.storage().getItem(a);if(o){var s=new e(t);s.displayName=o.displayName||"",s.category=o.category||"",s.pincode=o.pincode||"",s.signSk=Buffer.from(o.signSk||"","hex"),s.signPk=Buffer.from(o.signPk||"","hex"),s.pairedClients={};try{for(var c=i.__values(Object.keys(o.pairedClients||{})),h=c.next();!h.done;h=c.next()){var d=h.value,p=o.pairedClients[d],f=o.pairedClientsPermission?o.pairedClientsPermission[d]:void 0;void 0===f&&(f=1),s.pairedClients[d]={username:d,publicKey:Buffer.from(p,"hex"),permission:f},1===f&&s.pairedAdminClients++}}catch(e){r={error:e}}finally{try{h&&!h.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}return s.configVersion=o.configVersion||1,s.configHash=o.configHash||"",s.setupID=o.setupID||"",s.lastFirmwareVersion=o.lastFirmwareVersion||l(),s.ensureConfigVersionBounds(),s}return null},e.remove=function(t){var r=e.persistKey(t);u.HAPStorage.storage().removeItemSync(r)},e.assertValidUsername=function(t){n.default.ok(e.deviceIdPattern.test(t),"The supplied username ("+t+") is not valid (expected a format like 'XX:XX:XX:XX:XX:XX' with XX being a valid hexadecimal string). Note that, if you had this accessory already paired with the invalid username, you will need to repair the accessory and reconfigure your services in the Home app. Using an invalid username will lead to unexpected behaviour.")},e.deviceIdPattern=/^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$/,e}();t.AccessoryInfo=h},292:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ControllerStorage=void 0;var i=r(1635),n=i.__importDefault(r(9023)),a=i.__importDefault(r(5753)),o=r(4299),s=(0,a.default)("HAP-NodeJS:ControllerStorage"),c=function(){function e(e){this.initialized=!1,this.fileCreated=!1,this.purgeUnidentifiedAccessoryData=!0,this.trackedControllers=[],this.controllerData={},this.accessoryUUID=e.UUID}return e.prototype.enqueueSaveRequest=function(e){var t,r=this;if(void 0===e&&(e=0),this.parent)this.parent.enqueueSaveRequest(e);else{var i=Date.now()+e;if(this.queuedSaveTimeout){if(i<=(null!==(t=this.queuedSaveTime)&&void 0!==t?t:0))return;clearTimeout(this.queuedSaveTimeout)}this.queuedSaveTimeout=setTimeout((function(){r.queuedSaveTimeout=r.queuedSaveTime=void 0,r.save()}),e).unref(),this.queuedSaveTime=Date.now()+e}},e.prototype.linkAccessory=function(e){this.linkedAccessories||(this.linkedAccessories=[]);var t=e.controllerStorage;this.linkedAccessories.push(t),t.parent=this;var r=this.restoredAccessories&&this.restoredAccessories[e.UUID];this.initialized&&t.init(r)},e.prototype.trackController=function(e){e.setupStateChangeDelegate(this.handleStateChange.bind(this,e)),this.initialized?this.restoreController(e):this.trackedControllers.push(e)},e.prototype.untrackController=function(e){var t=this.trackedControllers.indexOf(e);-1!==t&&this.trackedControllers.splice(t,1),e.setupStateChangeDelegate(void 0),this.purgeControllerData(e)},e.prototype.purgeControllerData=function(e){delete this.controllerData[e.controllerId()],this.initialized&&this.enqueueSaveRequest(100)},e.prototype.handleStateChange=function(e){var t=e.controllerId(),r=e.serialize();if(r){var i=this.controllerData[t];i?i.data=r:this.controllerData[t]={data:r}}else delete this.controllerData[t];this.initialized&&this.enqueueSaveRequest(100)},e.prototype.restoreController=function(e){if(!this.initialized)throw new Error("Illegal state. Controller data wasn't loaded yet!");var t=this.controllerData[e.controllerId()];if(t){try{e.deserialize(t.data)}catch(t){console.warn("Could not initialize controller of type '".concat(e.controllerId(),"' from data stored on disk. Resetting to default: ").concat(t.stack)),e.handleFactoryReset()}t.purgeOnNextLoad=void 0}},e.prototype.init=function(e){var t=this;if(this.initialized)throw new Error("ControllerStorage for accessory ".concat(this.accessoryUUID," was already initialized!"));this.initialized=!0,e&&e.forEach((function(e){return t.controllerData[e.type]=e.controllerData}));var r=[];this.trackedControllers.forEach((function(e){t.restoreController(e),r.push(e.controllerId())})),this.trackedControllers.splice(0,this.trackedControllers.length);var n=!1;Object.entries(this.controllerData).forEach((function(e){var a=i.__read(e,2),o=a[0],s=a[1];if(s.purgeOnNextLoad)return delete t.controllerData[o],void(n=!0);r.includes(o)||(s.purgeOnNextLoad=!0)})),n&&this.enqueueSaveRequest(500)},e.prototype.load=function(t){if(this.username)throw new Error("ControllerStorage was already loaded!");this.username=t;var r,i=e.persistKey(t),n=o.HAPStorage.storage().getItem(i);n&&(this.fileCreated=!0,r=n.accessories[this.accessoryUUID],delete n.accessories[this.accessoryUUID]),this.init(r),this.linkedAccessories&&this.linkedAccessories.forEach((function(e){var t=n&&n.accessories[e.accessoryUUID];e.init(t),n&&delete n.accessories[e.accessoryUUID]})),n&&Object.keys(n.accessories).length>0&&(this.purgeUnidentifiedAccessoryData?s("Purging unidentified controller data for bridge %s",t):this.restoredAccessories=n.accessories)},e.prototype.save=function(){var t;if(this.parent)this.parent.save();else{if(!this.initialized)throw new Error("ControllerStorage has not yet been loaded!");if(!this.username)throw new Error("Cannot save controllerData for a storage without a username!");var r=((t={})[this.accessoryUUID]=this.controllerData,t);this.linkedAccessories&&this.linkedAccessories.forEach((function(e){return r[e.accessoryUUID]=e.controllerData}));var n=this.restoredAccessories||{};Object.entries(r).forEach((function(e){var t=i.__read(e,2),r=t[0],a=t[1],o=Object.entries(a);o.length>0&&(n[r]=o.map((function(e){var t=i.__read(e,2);return{type:t[0],controllerData:t[1]}})))}));var a=e.persistKey(this.username);if(Object.keys(n).length>0){var s={accessories:n};this.fileCreated=!0,o.HAPStorage.storage().setItemSync(a,s)}else this.fileCreated&&(this.fileCreated=!1,o.HAPStorage.storage().removeItemSync(a))}},e.persistKey=function(e){return n.default.format("ControllerStorage.%s.json",e.replace(/:/g,"").toUpperCase())},e.remove=function(t){var r=e.persistKey(t);o.HAPStorage.storage().removeItemSync(r)},e}();t.ControllerStorage=c},4299:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HAPStorage=void 0;var i=r(1635).__importDefault(r(3396)),n=function(){function e(){}return e.storage=function(){return this.INSTANCE.storage()},e.setCustomStoragePath=function(e){this.INSTANCE.setCustomStoragePath(e)},e.prototype.storage=function(){return this.localStore||(this.localStore=i.default.create(),this.customStoragePath?this.localStore.initSync({dir:this.customStoragePath}):this.localStore.initSync()),this.localStore},e.prototype.setCustomStoragePath=function(e){if(this.localStore)throw new Error("Cannot change storage path after it has already been initialized!");this.customStoragePath=e},e.INSTANCE=new e,e}();t.HAPStorage=n},2738:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdentifierCache=void 0;var i=r(1635),n=i.__importDefault(r(6982)),a=i.__importDefault(r(9023)),o=r(4299),s=function(){function e(e){this.username=e,this._cache={},this._usedCache=null,this._savedCacheHash=""}return e.prototype.startTrackingUsage=function(){this._usedCache={}},e.prototype.stopTrackingUsageAndExpireUnused=function(){this._cache=this._usedCache||this._cache,this._usedCache=null},e.prototype.getCache=function(e){var t=this._cache[e];return this._usedCache&&void 0!==t&&(this._usedCache[e]=t),t},e.prototype.setCache=function(e,t){return this._cache[e]=t,this._usedCache&&(this._usedCache[e]=t),t},e.prototype.getAID=function(e){var t=e;return this.getCache("|nextAID"),this.getCache(t)||this.setCache(t,this.getNextAID())},e.prototype.getIID=function(e,t,r,i){var n=e+"|"+t+(r?"|"+r:"")+(i?"|"+i:"");return this.getCache(e+"|nextIID"),this.getCache(n)||this.setCache(n,this.getNextIID(e))},e.prototype.getNextAID=function(){var e="|nextAID",t=this.getCache(e)||2;return this.setCache(e,t+1),t},e.prototype.getNextIID=function(e){var t=e+"|nextIID",r=this.getCache(t)||2;return this.setCache(t,r+1),r},e.prototype.save=function(){var t=n.default.createHash("sha1").update(JSON.stringify(this._cache)).digest("hex");if(t!==this._savedCacheHash){var r={cache:this._cache},i=e.persistKey(this.username);o.HAPStorage.storage().setItemSync(i,r),this._savedCacheHash=t}},e.persistKey=function(e){return a.default.format("IdentifierCache.%s.json",e.replace(/:/g,"").toUpperCase())},e.load=function(t){var r=e.persistKey(t),i=o.HAPStorage.storage().getItem(r);if(i){var a=new e(t);return a._cache=i.cache,a._savedCacheHash=n.default.createHash("sha1").update(JSON.stringify(a._cache)).digest("hex"),a}return null},e.remove=function(e){var t=this.persistKey(e);o.HAPStorage.storage().removeItemSync(t)},e}();t.IdentifierCache=s},4910:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AccessControlManagement=t.AccessControlEvent=t.AccessLevel=void 0;var i,n=r(1635),a=r(4434),o=r(9826),s=r(5876),c=n.__importStar(r(3314));!function(e){e[e.PASSWORD=1]="PASSWORD",e[e.PASSWORD_REQUIRED=2]="PASSWORD_REQUIRED"}(i||(i={})),function(e){e[e.ANYONE=0]="ANYONE",e[e.HOME_MEMBERS_ONLY=1]="HOME_MEMBERS_ONLY"}(t.AccessLevel||(t.AccessLevel={})),function(e){e.ACCESS_LEVEL_UPDATED="update-control-level",e.PASSWORD_SETTING_UPDATED="update-password"}(t.AccessControlEvent||(t.AccessControlEvent={}));var u=function(e){function t(t,r){var i=e.call(this)||this;return i.accessLevel=0,i.passwordRequired=!1,i.accessControlService=r||new s.Service.AccessControl,i.setupServiceHandlers(t),i}return n.__extends(t,e),t.prototype.getService=function(){return this.accessControlService},t.prototype.getAccessLevel=function(){return this.accessLevel},t.prototype.getPassword=function(){return this.passwordRequired?this.password:void 0},t.prototype.destroy=function(){this.removeAllListeners(),this.accessControlService.getCharacteristic(o.Characteristic.AccessControlLevel).removeOnSet(),this.accessControlService.testCharacteristic(o.Characteristic.PasswordSetting)&&this.accessControlService.getCharacteristic(o.Characteristic.PasswordSetting).removeOnSet()},t.prototype.handleAccessLevelChange=function(e){var t=this;this.accessLevel=e,setTimeout((function(){t.emit("update-control-level",t.accessLevel)}),0).unref()},t.prototype.handlePasswordChange=function(e){var t=this,r=Buffer.from(e,"base64"),i=c.decode(r);i[1]?this.password=i[1].toString("utf8"):this.password=void 0,this.passwordRequired=!!i[2][0],setTimeout((function(){t.emit("update-password",t.password,t.passwordRequired)}),0).unref()},t.prototype.setupServiceHandlers=function(e){var t=this;this.accessControlService.getCharacteristic(o.Characteristic.AccessControlLevel).onSet((function(e){return t.handleAccessLevelChange(e)})).updateValue(0),e&&this.accessControlService.getCharacteristic(o.Characteristic.PasswordSetting).onSet((function(e){return t.handlePasswordChange(e)})).updateValue("")},t}(a.EventEmitter);t.AccessControlManagement=u},9621:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clone=void 0;var i=r(1635);t.clone=function(e,t){var r,n,a,o,s={};try{for(var c=i.__values(Object.entries(e)),u=c.next();!u.done;u=c.next()){var l=i.__read(u.value,2),h=l[0],d=l[1];s[h]=d}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}if(t)try{for(var p=i.__values(Object.entries(t)),f=p.next();!f.done;f=p.next()){var v=i.__read(f.value,2);h=v[0],d=v[1];s[h]=d}}catch(e){a={error:e}}finally{try{f&&!f.done&&(o=p.return)&&o.call(p)}finally{if(a)throw a.error}}return s}},2175:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorUtils=void 0;var i=r(1635).__importDefault(r(2613)),n=new Map([[100,[19,222.1]],[101,[18.7,222.2]],[102,[18.4,222.3]],[103,[18.2,222.3]],[104,[17.9,222.4]],[105,[17.6,222.5]],[106,[17.3,222.7]],[107,[17,222.8]],[108,[16.7,222.9]],[109,[16.4,223]],[110,[16.1,223.2]],[111,[15.8,223.3]],[112,[15.4,223.4]],[113,[15.2,223.6]],[114,[14.9,223.8]],[115,[14.7,223.9]],[116,[14.3,224.1]],[117,[14.1,224.2]],[118,[13.8,224.4]],[119,[13.5,224.6]],[120,[13.2,224.8]],[121,[12.9,225]],[122,[12.5,225.3]],[123,[12.2,225.6]],[124,[11.8,225.9]],[125,[11.4,226.3]],[126,[11.1,226.7]],[127,[10.7,227.1]],[128,[10.3,227.6]],[129,[9.9,228]],[130,[9.6,228.5]],[131,[9.3,229.1]],[132,[8.9,229.6]],[133,[8.5,230.2]],[134,[8.2,230.9]],[135,[7.8,231.6]],[136,[7.5,232.5]],[137,[7.1,233.5]],[138,[6.7,234.6]],[139,[6.3,235.8]],[140,[6,237.1]],[141,[5.6,238.9]],[142,[5.2,240.9]],[143,[5,242.9]],[144,[4.8,244.9]],[145,[4.6,246.9]],[146,[4.4,249.3]],[147,[4.3,251.9]],[148,[4.1,254.9]],[149,[3.9,258]],[150,[3.7,261.8]],[151,[3.4,265.9]],[152,[3.2,271]],[153,[3,276.4]],[154,[2.8,283.6]],[155,[2.6,290.4]],[156,[2.3,295.3]],[157,[2.1,300]],[158,[1.9,300]],[159,[1.6,300]],[160,[1.4,195.8]],[161,[1.2,84.3]],[162,[1.3,58.2]],[163,[1.5,55.9]],[164,[1.7,53.2]],[165,[1.9,50.2]],[166,[2.1,47.1]],[167,[2.4,44.5]],[168,[2.6,42.6]],[169,[2.9,40.9]],[170,[3.1,39.5]],[171,[3.4,38.3]],[172,[3.7,37.3]],[173,[3.9,36.5]],[174,[4.2,35.7]],[175,[4.4,35.1]],[176,[4.6,34.5]],[177,[4.9,34]],[178,[5.1,33.5]],[179,[5.3,33]],[180,[5.6,32.7]],[181,[5.8,32.3]],[182,[6,32]],[183,[6.3,31.7]],[184,[6.5,31.4]],[185,[6.7,31.2]],[186,[7,30.9]],[187,[7.2,30.7]],[188,[7.4,30.5]],[189,[7.6,30.3]],[190,[7.9,30.1]],[191,[8.1,29.9]],[192,[8.4,29.7]],[193,[8.6,29.6]],[194,[8.9,29.5]],[195,[9.1,29.3]],[196,[9.4,29.2]],[197,[9.6,29.1]],[198,[9.8,29]],[199,[10,28.9]],[200,[10.2,28.7]],[201,[10.5,28.7]],[202,[10.7,28.6]],[203,[11,28.5]],[204,[11.2,28.4]],[205,[11.4,28.3]],[206,[11.6,28.3]],[207,[11.8,28.2]],[208,[12.1,28.1]],[209,[12.3,28.1]],[210,[12.5,28]],[211,[12.7,28]],[212,[12.9,27.9]],[213,[13.2,27.8]],[214,[13.4,27.8]],[215,[13.6,27.7]],[216,[13.8,27.7]],[217,[14,27.7]],[218,[14.3,27.6]],[219,[14.5,27.6]],[220,[14.7,27.5]],[221,[14.9,27.5]],[222,[15.1,27.5]],[223,[15.3,27.4]],[224,[15.5,27.4]],[225,[15.8,27.4]],[226,[16,27.3]],[227,[16.2,27.3]],[228,[16.4,27.3]],[229,[16.6,27.3]],[230,[16.8,27.2]],[231,[17,27.2]],[232,[17.2,27.2]],[233,[17.4,27.2]],[234,[17.6,27.2]],[235,[17.8,27.1]],[236,[18,27.1]],[237,[18.2,27.1]],[238,[18.4,27.1]],[239,[18.7,27.1]],[240,[18.8,27]],[241,[19,27]],[242,[19.2,27]],[243,[19.4,27]],[244,[19.6,27]],[245,[19.8,27]],[246,[20,27]],[247,[20.3,26.9]],[248,[20.5,26.9]],[249,[20.6,26.9]],[250,[20.8,26.9]],[251,[21,26.9]],[252,[21.3,26.9]],[253,[21.5,26.9]],[254,[21.6,26.9]],[255,[21.8,26.8]],[256,[22,26.8]],[257,[22.2,26.8]],[258,[22.4,26.8]],[259,[22.6,26.8]],[260,[22.8,26.8]],[261,[23,26.8]],[262,[23.2,26.8]],[263,[23.4,26.8]],[264,[23.6,26.8]],[265,[23.8,26.8]],[266,[24,26.8]],[267,[24.1,26.8]],[268,[24.3,26.8]],[269,[24.5,26.8]],[270,[24.7,26.8]],[271,[24.8,26.8]],[272,[25.1,26.7]],[273,[25.3,26.7]],[274,[25.4,26.7]],[275,[25.6,26.7]],[276,[25.8,26.7]],[277,[26,26.7]],[278,[26.1,26.7]],[279,[26.3,26.7]],[280,[26.5,26.7]],[281,[26.7,26.7]],[282,[26.9,26.7]],[283,[27.1,26.7]],[284,[27.3,26.7]],[285,[27.5,26.7]],[286,[27.7,26.7]],[287,[27.8,26.7]],[288,[28,26.7]],[289,[28.2,26.7]],[290,[28.4,26.7]],[291,[28.6,26.7]],[292,[28.8,26.7]],[293,[28.9,26.7]],[294,[29.1,26.7]],[295,[29.3,26.7]],[296,[29.5,26.7]],[297,[29.6,26.7]],[298,[29.8,26.7]],[299,[30,26.7]],[300,[30.2,26.7]],[301,[30.4,26.7]],[302,[30.5,26.7]],[303,[30.7,26.7]],[304,[30.9,26.7]],[305,[31.1,26.7]],[306,[31.2,26.7]],[307,[31.4,26.7]],[308,[31.6,26.7]],[309,[31.8,26.8]],[310,[31.9,26.8]],[311,[32.1,26.8]],[312,[32.3,26.8]],[313,[32.5,26.8]],[314,[32.6,26.8]],[315,[32.8,26.8]],[316,[33,26.8]],[317,[33.2,26.8]],[318,[33.3,26.8]],[319,[33.5,26.8]],[320,[33.7,26.8]],[321,[33.8,26.8]],[322,[34,26.8]],[323,[34.2,26.8]],[324,[34.4,26.8]],[325,[34.5,26.8]],[326,[34.7,26.8]],[327,[34.9,26.8]],[328,[35.1,26.8]],[329,[35.2,26.8]],[330,[35.4,26.8]],[331,[35.5,26.8]],[332,[35.7,26.8]],[333,[35.9,26.8]],[334,[36.1,26.8]],[335,[36.3,26.9]],[336,[36.5,26.9]],[337,[36.7,26.9]],[338,[36.9,26.9]],[339,[37.1,26.9]],[340,[37.2,26.9]],[341,[37.4,26.9]],[342,[37.5,26.9]],[343,[37.7,26.9]],[344,[37.9,26.9]],[345,[38.1,26.9]],[346,[38.3,26.9]],[347,[38.5,26.9]],[348,[38.7,26.9]],[349,[38.9,26.9]],[350,[39,26.9]],[351,[39.2,26.9]],[352,[39.3,27]],[353,[39.5,27]],[354,[39.7,27]],[355,[39.9,27]],[356,[40.1,27]],[357,[40.2,27]],[358,[40.4,27]],[359,[40.6,27]],[360,[40.8,27]],[361,[40.9,27]],[362,[41.1,27]],[363,[41.2,27]],[364,[41.4,27]],[365,[41.6,27]],[366,[41.8,27]],[367,[42,27]],[368,[42.1,27.1]],[369,[42.3,27.1]],[370,[42.4,27.1]],[371,[42.6,27.1]],[372,[42.8,27.1]],[373,[43,27.1]],[374,[43.1,27.1]],[375,[43.2,27.1]],[376,[43.4,27.1]],[377,[43.6,27.1]],[378,[43.8,27.1]],[379,[43.9,27.1]],[380,[44.1,27.1]],[381,[44.3,27.2]],[382,[44.4,27.2]],[383,[44.6,27.2]],[384,[44.7,27.2]],[385,[44.9,27.2]],[386,[45.1,27.2]],[387,[45.3,27.2]],[388,[45.5,27.2]],[389,[45.6,27.2]],[390,[45.8,27.2]],[391,[46,27.2]],[392,[46.2,27.2]],[393,[46.4,27.3]],[394,[46.5,27.3]],[395,[46.7,27.3]],[396,[46.9,27.3]],[397,[47.1,27.3]],[398,[47.2,27.3]],[399,[47.4,27.3]],[400,[47.6,27.3]],[401,[47.7,27.3]],[402,[47.9,27.3]],[403,[48.1,27.3]],[404,[48.3,27.3]],[405,[48.5,27.4]],[406,[48.7,27.4]],[407,[48.8,27.4]],[408,[49,27.4]],[409,[49.2,27.4]],[410,[49.4,27.4]],[411,[49.6,27.4]],[412,[49.7,27.4]],[413,[49.9,27.4]],[414,[50.1,27.4]],[415,[50.2,27.4]],[416,[50.4,27.4]],[417,[50.6,27.5]],[418,[50.7,27.5]],[419,[50.9,27.5]],[420,[51.1,27.5]],[421,[51.2,27.5]],[422,[51.4,27.5]],[423,[51.6,27.5]],[424,[51.7,27.5]],[425,[51.9,27.5]],[426,[52.1,27.5]],[427,[51.2,27.6]],[428,[52.4,27.6]],[429,[52.5,27.6]],[430,[52.7,27.6]],[431,[52.9,27.6]],[432,[53.1,27.6]],[433,[53.2,27.6]],[434,[53.4,27.6]],[435,[53.6,27.6]],[436,[53.7,27.6]],[437,[53.9,27.6]],[438,[54.1,27.7]],[439,[54.2,27.7]],[440,[54.3,27.7]],[441,[54.5,27.7]],[442,[54.7,27.7]],[443,[54.8,27.7]],[444,[55,27.7]],[445,[55.2,27.7]],[446,[55.3,27.7]],[447,[55.5,27.7]],[448,[55.7,27.7]],[449,[55.8,27.8]],[450,[56,27.8]],[451,[56.2,27.8]],[452,[56.3,27.8]],[453,[56.5,27.8]],[454,[56.7,27.8]],[455,[56.8,27.8]],[456,[57,27.8]],[457,[57.2,27.8]],[458,[57.3,27.9]],[459,[57.4,27.9]],[460,[57.6,27.9]],[461,[57.8,27.9]],[462,[57.9,27.9]],[463,[58.1,27.9]],[464,[58.3,27.9]],[465,[58.4,27.9]],[466,[58.6,27.9]],[467,[58.8,27.9]],[468,[59,28]],[469,[59.1,28]],[470,[59.2,28]],[471,[59.4,28]],[472,[59.6,28]],[473,[59.7,28]],[474,[60,28]],[475,[60.1,28]],[476,[60.2,28]],[477,[60.4,28]],[478,[60.6,28.1]],[479,[60.7,28.1]],[480,[60.9,28.1]],[481,[60.1,28.1]],[482,[60.3,28.1]],[483,[61.4,28.1]],[484,[61.5,28.1]],[485,[61.7,28.1]],[486,[61.9,28.1]],[487,[62,28.2]],[488,[62.2,28.2]],[489,[62.3,28.2]],[490,[62.5,28.2]],[491,[62.7,28.2]],[492,[62.8,28.2]],[493,[63,28.2]],[494,[63.2,28.2]],[495,[63.3,28.2]],[496,[63.4,28.2]],[497,[63.6,28.2]],[498,[63.8,28.3]],[499,[63.9,28.3]],[500,[64.1,28.3]]]),a=function(){function e(){}return e.colorTemperatureToHueAndSaturation=function(e,t){void 0===t&&(t=!0),e>500?e=500:e<100&&(e=100),e=Math.round(e);var r=n.get(e);return(0,i.default)(null!=e,"lookup for temperature "+e+" did not yield any results"),t&&(r[0]=Math.round(r[0]),r[1]=Math.round(r[1])),{saturation:r[0],hue:r[1]}},e}();t.ColorUtils=a},9593:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HAPConnection=t.HAPConnectionEvent=t.HAPConnectionState=t.EventedHTTPServer=t.EventedHTTPServerEvent=t.HAPEncryption=void 0;var i=r(1635),n=r(9152),a=i.__importDefault(r(2613)),o=i.__importDefault(r(5753)),s=r(4434),c=i.__importDefault(r(8611)),u=i.__importDefault(r(9278)),l=i.__importDefault(r(857)),h=i.__importStar(r(8)),d=r(47),p=i.__importStar(r(2997)),f=(0,o.default)("HAP-NodeJS:EventedHTTPServer"),v=(0,o.default)("HAP-NodeJS:EventedHTTPServer:Connection"),g=(0,o.default)("HAP-NodeJS:EventEmitter"),m=function(e,t,r,i,n){this.accessoryToControllerCount=0,this.controllerToAccessoryCount=0,this.clientPublicKey=e,this.secretKey=t,this.publicKey=r,this.sharedSecret=i,this.hkdfPairEncryptionKey=n,this.accessoryToControllerKey=Buffer.alloc(0),this.controllerToAccessoryKey=Buffer.alloc(0)};t.HAPEncryption=m,function(e){e.LISTENING="listening",e.CONNECTION_OPENED="connection-opened",e.REQUEST="request",e.CONNECTION_CLOSED="connection-closed"}(t.EventedHTTPServerEvent||(t.EventedHTTPServerEvent={}));var y=function(e){function t(){var t=e.call(this)||this;return t.connections=new Set,t.connectionsByUsername=new Map,t.tcpServer=u.default.createServer(),t}return i.__extends(t,e),t.prototype.scheduleNextConnectionIdleTimeout=function(){var e,r;if(this.connectionIdleTimeout=void 0,this.tcpServer.listening){f("Running idle timeout timer...");var n=(new Date).getTime(),a=-1;try{for(var o=i.__values(this.connections),s=o.next();!s.done;s=o.next()){var c=s.value,u=n-c.lastSocketOperation;u>=t.MAX_CONNECTION_IDLE_TIME?(f("[%s] Closing connection as it was inactive for "+u+"ms"),c.close()):a=Math.max(a,t.MAX_CONNECTION_IDLE_TIME-u)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}this.connections.size>=t.CONNECTION_TIMEOUT_LIMIT&&(this.connectionIdleTimeout=setTimeout(this.scheduleNextConnectionIdleTimeout.bind(this),a))}},t.prototype.address=function(){return this.tcpServer.address()},t.prototype.listen=function(e,t){var r=this;this.tcpServer.listen(e,t,(function(){var e=r.tcpServer.address();f("Server listening on %s:%s","IPv6"===e.family?"[".concat(e.address,"]"):e.address,e.port),r.connectionLoggingInterval=setInterval((function(){var e=i.__spreadArray([],i.__read(r.connections),!1).map((function(e){return"".concat(e.remoteAddress,":").concat(e.remotePort)})).join(", ");f("Currently %d hap connections open: %s",r.connections.size,e)}),6e4),r.connectionLoggingInterval.unref(),r.emit("listening",e.port,e.address)})),this.tcpServer.on("connection",this.onConnection.bind(this))},t.prototype.stop=function(){var e,t;null!=this.connectionLoggingInterval&&(clearInterval(this.connectionLoggingInterval),this.connectionLoggingInterval=void 0),null!=this.connectionIdleTimeout&&(clearTimeout(this.connectionIdleTimeout),this.connectionIdleTimeout=void 0),this.tcpServer.close();try{for(var r=i.__values(this.connections),n=r.next();!n.done;n=r.next()){n.value.close()}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},t.prototype.destroy=function(){this.stop(),this.removeAllListeners()},t.prototype.broadcastEvent=function(e,t,r,n,a){var o,s;try{for(var c=i.__values(this.connections),u=c.next();!u.done;u=c.next()){var l=u.value;l!==n?l.sendEvent(e,t,r,a):f("[%s] Muting event '%s' notification for this connection since it originated here.",l.remoteAddress,e+"."+t)}}catch(e){o={error:e}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(o)throw o.error}}},t.prototype.onConnection=function(e){var r=this,i=new C(this,e);i.on("request",(function(e,t){r.emit("request",i,e,t)})),i.on("authenticated",this.handleConnectionAuthenticated.bind(this,i)),i.on("closed",this.handleConnectionClose.bind(this,i)),this.connections.add(i),f("[%s] New connection from client on interface %s (%s)",i.remoteAddress,i.networkInterface,i.localAddress),this.emit("connection-opened",i),this.connections.size>=t.CONNECTION_TIMEOUT_LIMIT&&!this.connectionIdleTimeout&&this.scheduleNextConnectionIdleTimeout()},t.prototype.handleConnectionAuthenticated=function(e,t){var r=this.connectionsByUsername.get(t);r?r.includes(e)||r.push(e):this.connectionsByUsername.set(t,[e])},t.prototype.handleConnectionClose=function(e){if(this.emit("connection-closed",e),this.connections.delete(e),e.username){var t=this.connectionsByUsername.get(e.username);if(t){var r=t.indexOf(e);-1!==r&&t.splice(r,1),0===t.length&&this.connectionsByUsername.delete(e.username)}}},t.destroyExistingConnectionsAfterUnpair=function(e,t){var r,n,a=e.server.connectionsByUsername.get(t);if(a)try{for(var o=i.__values(a),s=o.next();!s.done;s=o.next()){s.value.closeConnectionAsOfUnpair(e)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}},t.CONNECTION_TIMEOUT_LIMIT=16,t.MAX_CONNECTION_IDLE_TIME=36e5,t}(s.EventEmitter);t.EventedHTTPServer=y,function(e){e[e.CONNECTING=0]="CONNECTING",e[e.FULLY_SET_UP=1]="FULLY_SET_UP",e[e.AUTHENTICATED=2]="AUTHENTICATED",e[e.TO_BE_TEARED_DOWN=3]="TO_BE_TEARED_DOWN",e[e.CLOSING=4]="CLOSING",e[e.CLOSED=5]="CLOSED"}(t.HAPConnectionState||(t.HAPConnectionState={})),function(e){e.REQUEST="request",e.AUTHENTICATED="authenticated",e.CLOSED="closed"}(t.HAPConnectionEvent||(t.HAPConnectionEvent={}));var C=function(e){function t(r,i){var n=e.call(this)||this;return n.state=0,n.lastSocketOperation=(new Date).getTime(),n.pendingClientSocketData=Buffer.alloc(0),n.handlingRequest=!1,n.registeredEvents=new Set,n.queuedEvents=[],n.eventsQueuedForImmediateDelivery=!1,n.server=r,n.sessionID=p.generate(i.remoteAddress+":"+i.remotePort),n.localAddress=i.localAddress,n.remoteAddress=i.remoteAddress,n.remotePort=i.remotePort,n.networkInterface=t.getLocalNetworkInterface(i),n.tcpSocket=i,n.tcpSocket.on("data",n.onTCPSocketData.bind(n)),n.tcpSocket.on("close",n.onTCPSocketClose.bind(n)),n.tcpSocket.on("error",n.onTCPSocketError.bind(n)),n.tcpSocket.setNoDelay(!0),n.internalHttpServer=c.default.createServer(),n.internalHttpServer.timeout=0,n.internalHttpServer.keepAliveTimeout=0,n.internalHttpServer.on("listening",n.onHttpServerListening.bind(n)),n.internalHttpServer.on("request",n.handleHttpServerRequest.bind(n)),n.internalHttpServer.on("error",n.onHttpServerError.bind(n)),n.internalHttpServer.listen(0,n.internalHttpServerAddress=(0,d.getOSLoopbackAddressIfAvailable)()),n}return i.__extends(t,e),t.prototype.debugListenerRegistration=function(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=-1);var i=(new Error).stack.split("\n")[3],n=this.listeners(e).length,a="authenticated"===e?"\t":"\t\t",o=t?"\t\t":"\t";g("[".concat(this.remoteAddress,"] ").concat(t?"Registered":"Unregistered"," event '").concat(String(e).toUpperCase(),"' ").concat(a,"(total: ").concat(n).concat(t?"":" Before: "+r,") ").concat(o).concat(i))},t.prototype.on=function(t,r){var i=e.prototype.on.call(this,t,r);return this.debugListenerRegistration(t),i},t.prototype.addListener=function(t,r){var i=e.prototype.addListener.call(this,t,r);return this.debugListenerRegistration(t),i},t.prototype.removeListener=function(t,r){var i=this.listeners(t).length,n=e.prototype.removeListener.call(this,t,r);return this.debugListenerRegistration(t,!1,i),n},t.prototype.off=function(t,r){var i=e.prototype.off.call(this,t,r),n=this.listeners(t).length;return this.debugListenerRegistration(t,!1,n),i},t.prototype.connectionAuthenticated=function(e){this.state=2,this.username=e,this.emit("authenticated",e)},t.prototype.isAuthenticated=function(){return 2===this.state},t.prototype.close=function(){this.state>=4||(this.state=4,this.tcpSocket.destroy())},t.prototype.closeConnectionAsOfUnpair=function(e){this===e?this.state=3:this.close()},t.prototype.sendEvent=function(e,t,r,i){(0,a.default)(null!=e,"HAPConnection.sendEvent: aid must be defined!"),(0,a.default)(null!=t,"HAPConnection.sendEvent: iid must be defined!");var n=e+"."+t;if(this.registeredEvents.has(n)){var o={aid:e,iid:t,value:r};if(i)return this.queuedEvents.push(o),this.eventsQueuedForImmediateDelivery=!0,this.eventsTimer&&(clearTimeout(this.eventsTimer),this.eventsTimer=void 0),void this.handleEventsTimeout();for(var s=this.queuedEvents.length-1;s>=0;s--){var c=this.queuedEvents[s];if(c.aid===e&&c.iid===t){if(c.value===r)return;break}}this.queuedEvents.push(o),this.eventsTimer||(this.eventsTimer=setTimeout(this.handleEventsTimeout.bind(this),250),this.eventsTimer.unref())}},t.prototype.handleEventsTimeout=function(){this.eventsTimer=void 0,this.state>2||this.writeQueuedEventNotifications()},t.prototype.writeQueuedEventNotifications=function(){var e,t;if(0!==this.queuedEvents.length&&!this.handlingRequest){this.eventsTimer&&(clearTimeout(this.eventsTimer),this.eventsTimer=void 0);var r={characteristics:[]};try{for(var n=i.__values(this.queuedEvents),a=n.next();!a.done;a=n.next()){var o=a.value;this.registeredEvents.has(o.aid+"."+o.iid)&&r.characteristics.push(o)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.queuedEvents.splice(0,this.queuedEvents.length),this.eventsQueuedForImmediateDelivery=!1,this.writeEventNotification(r)}},t.prototype.writeEventNotification=function(e){v("[%s] Sending HAP event notifications %o",this.remoteAddress,e.characteristics),(0,a.default)(!this.handlingRequest,"Can't write event notifications while handling a request!"),e.characteristics.reverse();var t=Buffer.from(JSON.stringify(e),"utf8"),r=Buffer.from("EVENT/1.0 200 OK\r\nContent-Type: application/hap+json\r\nContent-Length: "+t.length+"\r\n\r\n","utf8"),i=Buffer.concat([r,t]);this.tcpSocket.write(this.encrypt(i),this.handleTCPSocketWriteFulfilled.bind(this))},t.prototype.enableEventNotifications=function(e,t){this.registeredEvents.add(e+"."+t)},t.prototype.disableEventNotifications=function(e,t){this.registeredEvents.delete(e+"."+t)},t.prototype.hasEventNotifications=function(e,t){return this.registeredEvents.has(e+"."+t)},t.prototype.getRegisteredEvents=function(){return this.registeredEvents},t.prototype.clearRegisteredEvents=function(){this.registeredEvents.clear()},t.prototype.encrypt=function(e){return this.encryption&&this.encryption.accessoryToControllerKey.length>0&&this.encryption.controllerToAccessoryCount>0?h.layerEncrypt(e,this.encryption):e},t.prototype.decrypt=function(e){return this.encryption&&this.encryption.controllerToAccessoryKey.length>0?h.layerDecrypt(e,this.encryption):e},t.prototype.onHttpServerListening=function(){var e=this,t=this.internalHttpServer.address(),r="IPv6"===t.family?"[".concat(t.address,"]"):t.address;this.internalHttpServerPort=t.port,v("[%s] Internal HTTP server listening on %s:%s",this.remoteAddress,r,t.port),this.internalHttpServer.on("close",this.onHttpServerClose.bind(this)),this.httpSocket=u.default.createConnection(this.internalHttpServerPort,this.internalHttpServerAddress),this.httpSocket.setNoDelay(!0),this.httpSocket.on("data",this.handleHttpServerResponse.bind(this)),this.httpSocket.on("error",this.onHttpSocketError.bind(this)),this.httpSocket.on("close",this.onHttpSocketClose.bind(this)),this.httpSocket.on("connect",(function(){e.state=1,v("[%s] Internal HTTP socket connected. HAPConnection now fully set up!",e.remoteAddress),e.pendingClientSocketData&&e.pendingClientSocketData.length>0&&e.httpSocket.write(e.pendingClientSocketData),e.pendingClientSocketData=void 0}))},t.prototype.onTCPSocketData=function(e){if(!(this.state>2)){this.handlingRequest=!0,this.lastSocketOperation=(new Date).getTime();try{e=this.decrypt(e)}catch(e){return v("[%s] Error occurred trying to decrypt incoming packet: %s",this.remoteAddress,e.message),void this.close()}this.state<1?this.pendingClientSocketData=Buffer.concat([this.pendingClientSocketData,e]):this.httpSocket.write(e)}},t.prototype.handleHttpServerRequest=function(e,t){this.state>2||(v("[%s] HTTP request: %s",this.remoteAddress,e.url),e.socket.setNoDelay(!0),this.emit("request",e,t))},t.prototype.handleHttpServerResponse=function(e){var t=this;e=this.encrypt(e),this.tcpSocket.write(e,this.handleTCPSocketWriteFulfilled.bind(this)),v("[%s] HTTP Response is finished",this.remoteAddress),this.handlingRequest=!1,3===this.state?setTimeout((function(){return t.close()}),10):this.state<3&&(this.eventsTimer&&!this.eventsQueuedForImmediateDelivery||this.writeQueuedEventNotifications())},t.prototype.handleTCPSocketWriteFulfilled=function(){this.lastSocketOperation=(new Date).getTime()},t.prototype.onTCPSocketError=function(e){v("[%s] Client connection error: %s",this.remoteAddress,e.message)},t.prototype.onTCPSocketClose=function(){this.state=5,v("[%s] Client connection closed",this.remoteAddress),this.httpSocket&&this.httpSocket.destroy(),this.internalHttpServer.close(),this.emit("closed"),this.removeAllListeners()},t.prototype.onHttpServerError=function(e){v("[%s] HTTP server error: %s",this.remoteAddress,e.message),"EADDRINUSE"===e.code&&(this.internalHttpServerPort=void 0,this.internalHttpServer.close(),this.internalHttpServer.listen(0,this.internalHttpServerAddress=(0,d.getOSLoopbackAddressIfAvailable)()))},t.prototype.onHttpServerClose=function(){v("[%s] HTTP server was closed",this.remoteAddress),this.close()},t.prototype.onHttpSocketError=function(e){v("[%s] HTTP connection error: ",this.remoteAddress,e.message)},t.prototype.onHttpSocketClose=function(){v("[%s] HTTP connection was closed",this.remoteAddress),this.internalHttpServer.close()},t.prototype.getLocalAddress=function(e){var t,r,n,a,o=l.default.networkInterfaces()[this.networkInterface];if("ipv4"===e){try{for(var s=i.__values(o),c=s.next();!c.done;c=s.next()){if("IPv4"===(p=c.value).family||4===p.family)return p.address}}catch(e){t={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}throw new Error("Could not find "+e+" address for interface "+this.networkInterface)}var u=void 0;try{for(var h=i.__values(o),d=h.next();!d.done;d=h.next()){var p;if("IPv6"===(p=d.value).family||6===p.family){if(!p.scopeid)return p.address;u||(u=p.address)}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(a=h.return)&&a.call(h)}finally{if(n)throw n.error}}if(!u)throw new Error("Could not find "+e+" address for interface "+this.networkInterface);return u},t.getLocalNetworkInterface=function(e){var t,r,a,o,s,c,h,d,p=e.localAddress;if(p.startsWith("::ffff:"))p=p.substring(7);else{var f=p.indexOf("%");-1!==f&&(p=p.substring(0,f))}var v=l.default.networkInterfaces();try{for(var g=i.__values(Object.entries(v)),m=g.next();!m.done;m=g.next()){var y=i.__read(m.value,2),C=y[0],S=y[1];try{for(var E=(a=void 0,i.__values(S)),_=E.next();!_.done;_=E.next()){if((U=_.value).address===p)return C}}catch(e){a={error:e}}finally{try{_&&!_.done&&(o=E.return)&&o.call(E)}finally{if(a)throw a.error}}}}catch(e){t={error:e}}finally{try{m&&!m.done&&(r=g.return)&&r.call(g)}finally{if(t)throw t.error}}var T=u.default.isIPv4(p)?"IPv4":"IPv6";try{for(var A=i.__values(Object.entries(v)),I=A.next();!I.done;I=A.next()){var D=i.__read(I.value,2);C=D[0],S=D[1];try{for(var w=(h=void 0,i.__values(S)),b=w.next();!b.done;b=w.next()){var U;if((U=b.value).family===T&&(0,n.getNetAddress)(p,U.netmask)===(0,n.getNetAddress)(U.address,U.netmask))return C}}catch(e){h={error:e}}finally{try{b&&!b.done&&(d=w.return)&&d.call(w)}finally{if(h)throw h.error}}}}catch(e){s={error:e}}finally{try{I&&!I.done&&(c=A.return)&&c.call(A)}finally{if(s)throw s.error}}return console.log("WARNING couldn't map socket coming from remote address ".concat(e.remoteAddress,":").concat(e.remotePort,"     at local address ").concat(e.localAddress," to a interface!")),Object.keys(v)[1]},t}(s.EventEmitter);t.HAPConnection=C},8:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.layerDecrypt=t.layerEncrypt=t.chacha20_poly1305_encryptAndSeal=t.chacha20_poly1305_decryptAndVerify=t.writeUInt64LE=t.HKDF=t.generateCurve25519SharedSecKey=t.generateCurve25519KeyPair=void 0;var i=r(1635),n=i.__importDefault(r(2613)),a=i.__importDefault(r(6982)),o=i.__importDefault(r(6871)),s=i.__importDefault(r(8947));a.default.getCiphers().includes("chacha20-poly1305")||n.default.fail("The cipher 'chacha20-poly1305' is not supported with your current running nodejs version v"+process.version+". At least a nodejs version of v10.17.0 (excluding v11.0 and v11.1) is required!"),t.generateCurve25519KeyPair=function(){return s.default.box.keyPair()},t.generateCurve25519SharedSecKey=function(e,t){return s.default.scalarMult(e,t)},t.HKDF=function(e,t,r,i,n){return(0,o.default)(r,n,{hash:e,salt:t,info:i})};var c=4294967295,u=9007199254740991;function l(e,t,r){void 0===r&&(r=0);var i=function(e){(0,n.default)(e>-1&&e<=u,"number out of range"),(0,n.default)(Math.floor(e)===e,"number must be an integer");var t=0,r=4294967295&e,i=r<0?2147483648+(2147483647&e):r;return e>c&&(t=(e-i)/(c+1)),[t,i]}(e);t.writeUInt32LE(i[1],r),t.writeUInt32LE(i[0],r+4)}function h(e,t,r,i,n){t.length<12&&(t=Buffer.concat([Buffer.alloc(12-t.length,0),t]));var o=a.default.createDecipheriv("chacha20-poly1305",e,t,{authTagLength:16});r&&o.setAAD(r),o.setAuthTag(n);var s=o.update(i);return o.final(),s}function d(e,t,r,i){t.length<12&&(t=Buffer.concat([Buffer.alloc(12-t.length,0),t]));var n=a.default.createCipheriv("chacha20-poly1305",e,t,{authTagLength:16});r&&n.setAAD(r);var o=n.update(i);return n.final(),{ciphertext:o,authTag:n.getAuthTag()}}t.writeUInt64LE=l,t.chacha20_poly1305_decryptAndVerify=h,t.chacha20_poly1305_encryptAndSeal=d,t.layerEncrypt=function(e,t){for(var r=Buffer.alloc(0),i=e.length,n=0;n<i;){var a=Math.min(i-n,1024),o=Buffer.alloc(2);o.writeUInt16LE(a,0);var s=Buffer.alloc(8);l(t.accessoryToControllerCount++,s,0);var c=d(t.accessoryToControllerKey,s,o,e.slice(n,n+a));n+=a,r=Buffer.concat([r,o,c.ciphertext,c.authTag])}return r},t.layerDecrypt=function(e,t){t.incompleteFrame&&(e=Buffer.concat([t.incompleteFrame,e]),t.incompleteFrame=void 0);for(var r=Buffer.alloc(0),i=e.length,n=0;n<i;){var a=e.slice(n,n+2).readUInt16LE(0);if(a>i-n-2-16){t.incompleteFrame=e.slice(n);break}var o=Buffer.alloc(8);l(t.controllerToAccessoryCount++,o,0);var s=h(t.controllerToAccessoryKey,o,e.slice(n,n+2),e.slice(n+2,n+2+a),e.slice(n+2+a,n+2+a+16));r=Buffer.concat([r,s]),n+=18+a}return r}},8073:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HapStatusError=void 0;var i=r(1635),n=r(589),a=function(e){function t(r){var i=e.call(this,"HAP Status Error: "+r)||this;return Object.setPrototypeOf(i,t.prototype),(0,n.IsKnownHAPStatusError)(r)?i.hapStatus=r:i.hapStatus=-70402,i}return i.__extends(t,e),t}(Error);t.HapStatusError=a},47:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOSLoopbackAddressIfAvailable=t.getOSLoopbackAddress=t.findLoopbackAddress=void 0;var i=r(1635),n=i.__importDefault(r(857));function a(){var e,t,r,a,o=void 0,s=void 0,c=void 0;try{for(var u=i.__values(Object.entries(n.default.networkInterfaces())),l=u.next();!l.done;l=u.next()){var h=i.__read(l.value,2),d=h[0],p=h[1],f=!1;try{for(var v=(r=void 0,i.__values(p)),g=v.next();!g.done;g=v.next()){var m=g.value;m.internal&&(f=!0,"IPv4"===m.family||4===m.family?c||(c=m.address):"IPv6"!==m.family&&6!==m.family||(m.scopeid?s||(s=m.address+"%"+d):o||(o=m.address)))}}catch(e){r={error:e}}finally{try{g&&!g.done&&(a=v.return)&&a.call(v)}finally{if(r)throw r.error}}if(f)break}}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}var y=c||o||s;if(!y)throw new Error("Could not find a valid loopback address on the platform!");return y}t.findLoopbackAddress=a;var o=void 0;t.getOSLoopbackAddress=function(){return null!=o?o:o=a()},t.getOSLoopbackAddressIfAvailable=function(){try{return null!=o?o:o=a()}catch(e){return void console.log(e.stack)}}},7739:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.once=void 0;var i=r(1635);t.once=function(e){var t=!1;return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];if(t)throw new Error("This callback function has already been called by someone else; it can only be called one time.");return t=!0,e.apply(void 0,i.__spreadArray([],i.__read(r),!1))}}},4009:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.awaitEventOnce=t.PromiseTimeout=void 0,t.PromiseTimeout=function(e){return new Promise((function(t){setTimeout((function(){return t()}),e)}))},t.awaitEventOnce=function(e,t,r){return void 0===r&&(r=5e3),new Promise((function(i,n){var a,o=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];clearTimeout(a),i(e.length?1===e.length?e[0]:e:void 0)};a=setTimeout((function(){e.removeListener(t,o),n(new Error("awaitEvent for event ".concat(t," timed out!")))}),r),e.once(t,o)}))}},8066:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.numericUpperBound=t.numericLowerBound=t.isIntegerNumericFormat=t.isUnsignedNumericFormat=t.isNumericFormat=t.formatOutgoingCharacteristicValue=void 0,t.formatOutgoingCharacteristicValue=function(e,t){var r;if("boolean"==typeof e)return e?1:0;if("number"==typeof e){if(!t.minStep||t.minStep>=1)return e;var i=null!==(r=t.minValue)&&void 0!==r?r:0,n=1/t.minStep;return Math.round(1e4*(Math.round((e-i)*n)/n+i))/1e4}return e},t.isNumericFormat=function(e){switch(e){case"int":case"float":case"uint8":case"uint16":case"uint32":case"uint64":return!0;default:return!1}},t.isUnsignedNumericFormat=function(e){switch(e){case"uint8":case"uint16":case"uint32":case"uint64":return!0;default:return!1}},t.isIntegerNumericFormat=function(e){switch(e){case"int":case"uint8":case"uint16":case"uint32":case"uint64":return!0;default:return!1}},t.numericLowerBound=function(e){switch(e){case"int":return-2147483648;case"float":return-Number.MAX_VALUE;case"uint8":case"uint16":case"uint32":case"uint64":return 0;default:throw new Error("Unable to determine numeric lower bound for "+e)}},t.numericUpperBound=function(e){switch(e){case"int":return 2147483647;case"float":return Number.MAX_VALUE;case"uint8":return 255;case"uint16":return 65535;case"uint32":return 4294967295;case"uint64":return 0x10000000000000000;default:throw new Error("Unable to determine numeric lower bound for "+e)}}},1579:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.epochMillisFromMillisSince2001_01_01Buffer=t.epochMillisFromMillisSince2001_01_01=void 0;var i=r(1635).__importDefault(r(2613)),n=r(3314),a=Date.UTC(2001,0,1,0,0,0,0);function o(e){return a+e}t.epochMillisFromMillisSince2001_01_01=o,t.epochMillisFromMillisSince2001_01_01Buffer=function(e){return(0,i.default)(8===e.length,"can only parse 64 bit buffers!"),o((0,n.readUInt64LE)(e))}},3314:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.writeVariableUIntLE=t.readVariableUIntLE=t.readUInt16=t.writeUInt16=t.writeFloat32LE=t.readUInt32=t.writeUInt32=t.readUInt64BE=t.readUInt64LE=t.readUInt64=t.writeUInt64=t.decodeList=t.decodeWithLists=t.decode=t.encode=void 0;var i=r(1635),n=i.__importDefault(r(2613)),a=i.__importStar(r(8));function o(e,t){void 0===t&&(t=0);var r=e.readUInt32LE(t);return 4294967296*e.readUInt32LE(t+4)+r}function s(e){var t=Buffer.alloc(4);return t.writeUInt32LE(e,0),t}function c(e){var t=Buffer.alloc(2);return t.writeUInt16LE(e,0),t}t.encode=function e(t,r){for(var n,a,o=[],s=2;s<arguments.length;s++)o[s-2]=arguments[s];var c=[];if("number"==typeof r?r=Buffer.from([r]):"string"==typeof r&&(r=Buffer.from(r)),Array.isArray(r)){var u=!0;try{for(var l=i.__values(r),h=l.next();!h.done;h=l.next()){var d=h.value;u||c.push(Buffer.from([0,0])),u=!1,c.push(e(t,d))}}catch(e){n={error:e}}finally{try{h&&!h.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}u&&c.push(Buffer.from([t,0]))}else if(r.length<=255)c.push(Buffer.concat([Buffer.from([t,r.length]),r]));else for(var p=r.length,f=0;p>0;)p>=255?(c.push(Buffer.concat([Buffer.from([t,255]),r.slice(f,f+255)])),p-=255,f+=255):(c.push(Buffer.concat([Buffer.from([t,p]),r.slice(f)])),p-=p);if(o.length>=2){var v=i.__read(o),g=v[0],m=v[1],y=v.slice(2),C=e.apply(void 0,i.__spreadArray([g,m],i.__read(y),!1));c.push(C)}return Buffer.concat(c)},t.decode=function(e){(0,n.default)(e instanceof Buffer,"Illegal argument. tlv.decode() expects Buffer type!");for(var t={},r=e.length,i=0;r>0;){var a=e[i],o=e[i+1];i+=2,r-=2;var s=e.slice(i,i+o);t[a]?t[a]=Buffer.concat([t[a],s]):t[a]=s,i+=o,r-=o}return t},t.decodeWithLists=function(e){for(var t={},r=e.length,i=0,n=-1,a=-1,o=!1;r>0;){var s=e.readUInt8(i++),c=e.readUInt8(i++);r-=2;var u=e.slice(i,i+c);if(i+=c,r-=c,0!==s||0!==c){var l=t[s];if(l)if(o&&n===s)Array.isArray(l)?l.push(u):t[s]=[l,u];else{if(n!==s||255!==a)throw new Error("Found duplicated tlv entry with type ".concat(s," and length ").concat(c,"         (lastItemWasDelimiter: ").concat(o,", lastType: ").concat(n,", lastLength: ").concat(a,")"));if(Array.isArray(l)){var h=l[l.length-1];l[l.length-1]=Buffer.concat([h,u])}else t[s]=Buffer.concat([l,u])}else t[s]=u;n=s,a=c,o=!1}else o=!0}return t},t.decodeList=function(e,t){for(var r=[],i=e.length,n=0,a=void 0;i>0;){var o=e[n],s=e[n+1],c=e.slice(n+2,n+2+s);if(o===t&&(void 0!==a&&r.push(a),a={}),void 0===a)throw new Error("Error parsing tlv list: Encountered uninitialized storage object");a[o]?a[o]=Buffer.concat([a[o],c]):a[o]=c,n+=2+s,i-=2+s}return void 0!==a&&r.push(a),r},t.writeUInt64=function(e){var t=new Float64Array(1);t[0]=e;for(var r=Buffer.alloc(t.buffer.byteLength),i=new Uint8Array(t.buffer),n=0;n<r.length;n++)r[n]=i[n];return r},t.readUInt64=function(e){return new Float64Array(e)[0]},t.readUInt64LE=o,t.readUInt64BE=function(e,t){return void 0===t&&(t=0),o(e,t)},t.writeUInt32=s,t.readUInt32=function(e){return e.readUInt32LE(0)},t.writeFloat32LE=function(e){var t=Buffer.alloc(4);return t.writeFloatLE(e,0),t},t.writeUInt16=c,t.readUInt16=function(e){return e.readUInt16LE(0)},t.readVariableUIntLE=function(e,t){switch(void 0===t&&(t=0),(0,n.default)(0===t,"Can't define a offset different than 0!"),e.length){case 1:return e.readUInt8(t);case 2:return e.readUInt16LE(t);case 4:return e.readUInt32LE(t);case 8:return o(e,t);default:throw new Error("Can't read uint LE with length "+e.length)}},t.writeVariableUIntLE=function(e,t){if(void 0===t&&(t=0),(0,n.default)(e>=0,"Can't encode a negative integer as unsigned integer"),(0,n.default)(0===t,"Can't define a offset different than 0!"),e<=255)return(r=Buffer.alloc(1)).writeUInt8(e,t),r;if(e<=65535)return c(e);if(e<=4294967295)return s(e);var r=Buffer.alloc(8);return a.writeUInt64LE(e,r,t),r}},2997:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toLongForm=t.toShortForm=t.write=t.unparse=t.isValid=t.generate=t.BASE_UUID=void 0;var i=r(1635).__importDefault(r(6982));t.BASE_UUID="-0000-1000-8000-0026BB765291",t.generate=function(e){var t=i.default.createHash("sha1");t.update(e);var r=t.digest("hex"),n=-1;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){return n+=1,"y"===e?(3&parseInt("0x"+r[n],16)|8).toString(16):r[n]}))};var n=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function a(e){return n.test(e)}t.isValid=a,t.unparse=function(e,t){if(void 0===t&&(t=0),"string"==typeof e&&a(e))return e;var r=t;return e.toString("hex",r,r+=4)+"-"+e.toString("hex",r,r+=2)+"-"+e.toString("hex",r,r+=2)+"-"+e.toString("hex",r,r+=2)+"-"+e.toString("hex",r,r+6)},t.write=function(e,t,r){void 0===r&&(r=0);var i=Buffer.from(e.replace(/-/g,""),"hex");return t?(i.copy(t,r),t):i};var o=/^0*([0-9a-f]{1,8})-([0-9a-f]{4}-){3}[0-9a-f]{12}$/i;t.toShortForm=function(e,r){if(void 0===r&&(r=t.BASE_UUID),!a(e))throw new TypeError("uuid was not a valid UUID or short form UUID");if(r&&!a("00000000"+r))throw new TypeError("base was not a valid base UUID");return r&&!e.endsWith(r)?e.toUpperCase():e.replace(o,"$1").toUpperCase()};var s=/^[0-9a-f]{1,8}$/i;t.toLongForm=function(e,r){if(void 0===r&&(r=t.BASE_UUID),a(e))return e.toUpperCase();if(!s.test(e))throw new TypeError("uuid was not a valid UUID or short form UUID");if(!a("00000000"+r))throw new TypeError("base was not a valid base UUID");return(("00000000"+e).substr(-8)+r).toUpperCase()}},7506:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=7506,e.exports=t},4310:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResourceRequestType=void 0,function(e){e.IMAGE="image"}(t.ResourceRequestType||(t.ResourceRequestType={}))},7845:(e,t,r)=>{const i=r(4434).EventEmitter,n=r(9278),a=r(3796),o=r(3550),s=r(1300),c=r(126),u=r(6663),l=r(1138);function h(e){var t=new i;e||(e={});var a=t.stream=function(e){if(e.stream)return e.stream;var t=e.host,i=e.port,a=e.socket;if(a)return n.createConnection(a);if(i)return n.createConnection(i,t);var o=e.busAddress||process.env.DBUS_SESSION_BUS_ADDRESS;if(!o)throw new Error("unknown bus address");for(var s=o.split(";"),c=0;c<s.length;++c){var u=s[c].split(":"),l=u[0],h={};u[1].split(",").map((function(e){var t=e.split("=");h[t[0]]=t[1]}));try{switch(l.toLowerCase()){case"tcp":return t=h.host||"localhost",i=h.port,n.createConnection(i,t);case"unix":if(h.socket)return n.createConnection(h.socket);if(h.abstract)return r(Object(function(){var e=new Error("Cannot find module 'abstract-socket'");throw e.code="MODULE_NOT_FOUND",e}())).connect("\0"+h.abstract);if(h.path)return n.createConnection(h.path);throw new Error("not enough parameters for 'unix' connection - you need to specify 'socket' or 'abstract' or 'path' parameter");case"unixexec":for(var d=r(8954),p=r(5317).spawn,f=[],v=1;h["arg"+v];v++)f.push(h["arg"+v]);var g=p(h.path,f);return d.duplex(g.stdin,g.stdout);default:throw new Error("unknown address type:"+l)}}catch(e){if(c<s.length-1){console.warn(e.message);continue}throw e}}}(e);return a.setNoDelay(),a.on("error",(function(e){t.emit("error",e)})),a.on("end",(function(){t.emit("end"),t.message=function(){console.warn("Didn't write bytes to closed stream")}})),t.end=function(){return a.end(),t},(e.server?c:s)(a,e,(function(r,i){if(r)return t.emit("error",r);t.guid=i,t.emit("connect"),o.unmarshalMessages(a,(function(e){t.emit("message",e)}),e)})),t._messages=[],t.message=function(e){t._messages.push(e)},t.once("connect",(function(){t.state="connected";for(var e=0;e<t._messages.length;++e)a.write(o.marshall(t._messages[e]));t._messages.length=0,t.message=function(e){a.write(o.marshall(e))}})),t}e.exports.createClient=function(e){var t=h(e||{});return new u(t,e||{})},e.exports.systemBus=function(){return e.exports.createClient({busAddress:process.env.DBUS_SYSTEM_BUS_ADDRESS||"unix:path=/var/run/dbus/system_bus_socket"})},e.exports.sessionBus=function(t){return e.exports.createClient(t)},e.exports.messageType=a.messageType,e.exports.createConnection=h,e.exports.createServer=l.createServer},6020:(e,t,r)=>{const i=r(2861).Buffer;t.M=function(e,t){var r=t-e._offset%t;if(0!==r&&r!==t){var n=i.alloc(r);e.put(i.from(n)),e._offset+=r}}},6663:(e,t,r)=>{const i=r(4434).EventEmitter,n=r(3796),a=r(7407),o=r(5286).introspectBus;e.exports=function e(t,r){if(!(this instanceof e))return new e(t);r||(r={});var s=this;function c(e,t){this.name=e,this.service=t,this.as=function(e){return this.proxy[e]}}function u(e,t){this.name=e,this.bus=t,this.getObject=function(e,t){if(void 0===e)return t(new Error("Object name is null or undefined"));var r=new c(e,this);o(r,(function(e,i,n){if(e)return t(e);r.proxy=i,r.nodes=n,t(null,r)}))},this.getInterface=function(e,t,r){this.getObject(e,(function(e,i){if(e)return r(e);r(null,i.as(t))}))}}this.connection=t,this.serial=1,this.cookies={},this.methodCallHandlers={},this.signals=new i,this.exportedObjects={},this.invoke=function(e,t){e.type||(e.type=n.messageType.methodCall),e.serial=s.serial++,this.cookies[e.serial]=t,s.connection.message(e)},this.invokeDbus=function(e,t){e.path||(e.path="/org/freedesktop/DBus"),e.destination||(e.destination="org.freedesktop.DBus"),e.interface||(e.interface="org.freedesktop.DBus"),s.invoke(e,t)},this.mangle=function(e,t,r){var i={};return"object"==typeof e?(i.path=e.path,i.interface=e.interface,i.member=e.member):(i.path=e,i.interface=t,i.member=r),JSON.stringify(i)},this.sendSignal=function(e,t,r,i,a){var o={type:n.messageType.signal,serial:s.serial++,interface:t,path:e,member:r};i&&(o.signature=i,o.body=a),s.connection.message(o)},this.sendError=function(e,t,r){var i={type:n.messageType.error,serial:s.serial++,replySerial:e.serial,destination:e.sender,errorName:t,signature:"s",body:[r]};this.connection.message(i)},this.sendReply=function(e,t,r){var i={type:n.messageType.methodReturn,serial:s.serial++,replySerial:e.serial,destination:e.sender,signature:t,body:r};this.connection.message(i)},this.connection.on("message",(function(e){function t(t,r,i){Promise.resolve().then((function(){return r.apply(t,(e.body||[]).concat(e))})).then((function(t){var r={type:n.messageType.methodReturn,serial:s.serial++,destination:e.sender,replySerial:e.serial};null!==t&&(r.signature=i,r.body=[t]),s.connection.message(r)}),(function(t){s.sendError(e,t.dbusName||"org.freedesktop.DBus.Error.Failed",t.message||"")}))}var r;if(e.type===n.messageType.methodReturn||e.type===n.messageType.error){if(r=s.cookies[e.replySerial]){delete s.cookies[e.replySerial];var i={connection:s.connection,bus:s,message:e,signature:e.signature},o=e.body||[];e.type===n.messageType.methodReturn?(o=[null].concat(o),r.apply(i,o)):r.call(i,{name:e.errorName,message:o})}}else if(e.type===n.messageType.signal)s.signals.emit(s.mangle(e),e.body,e.signature);else{if(a(e,s))return;var c,u,l;if(c=s.exportedObjects[e.path]){if(u=c[e.interface]){var h=(l=u[1])[e.member];return h?void t(l,h,u[0].methods[e.member][1]):void s.sendError(e,"org.freedesktop.DBus.Error.UnknownMethod",`Method "${e.member}" on interface "${e.interface}" doesn't exist`)}console.error(`Interface ${e.interface} is not supported`)}(r=s.methodCallHandlers[s.mangle(e)])?t(null,r[0],r[1]):s.sendError(e,"org.freedesktop.DBus.Error.UnknownService","Uh oh oh")}})),this.setMethodCallHandler=function(e,t,r,i){var n=s.mangle(e,t,r);s.methodCallHandlers[n]=i},this.exportInterface=function(e,t,r){if((s.exportedObjects[t]?s.exportedObjects[t]:s.exportedObjects[t]={})[r.name]=[r,e],"function"==typeof e.emit){var i=e.emit;e.emit=function(){var a,o=Array.prototype.slice.apply(arguments),c=o[0];if(!c)throw new Error("Trying to emit undefined signa");if(r.signals&&r.signals[c]){a=r.signals[c];var u={type:n.messageType.signal,serial:s.serial++,interface:r.name,path:t,member:c};a[0]&&(u.signature=a[0],u.body=o.slice(1)),s.connection.message(u),s.serial++}i.apply(e,o)}}},!0!==r.direct?this.invokeDbus({member:"Hello"},(function(e,t){if(e)throw new Error(e);s.name=t})):s.name=null,this.getService=function(e){return new u(e,this)},this.getObject=function(e,t,r){return this.getService(e).getObject(t,r)},this.getInterface=function(e,t,r,i){return this.getObject(e,t,(function(e,t){if(e)return i(e);i(null,t.as(r))}))},this.addMatch=function(e,t){this.invokeDbus({member:"AddMatch",signature:"s",body:[e]},t)},this.removeMatch=function(e,t){this.invokeDbus({member:"RemoveMatch",signature:"s",body:[e]},t)},this.getId=function(e){this.invokeDbus({member:"GetId"},e)},this.requestName=function(e,t,r){this.invokeDbus({member:"RequestName",signature:"su",body:[e,t]},(function(e,t){r&&r(e,t)}))},this.releaseName=function(e,t){this.invokeDbus({member:"ReleaseName",signature:"s",body:[e]},t)},this.listNames=function(e){this.invokeDbus({member:"ListNames"},e)},this.listActivatableNames=function(e){this.invokeDbus({member:"ListActivatableNames"},e)},this.updateActivationEnvironment=function(e,t){this.invokeDbus({member:"UpdateActivationEnvironment",signature:"a{ss}",body:[e]},t)},this.startServiceByName=function(e,t,r){this.invokeDbus({member:"StartServiceByName",signature:"su",body:[e,t]},r)},this.getConnectionUnixUser=function(e,t){this.invokeDbus({member:"GetConnectionUnixUser",signature:"s",body:[e]},t)},this.getConnectionUnixProcessId=function(e,t){this.invokeDbus({member:"GetConnectionUnixProcessID",signature:"s",body:[e]},t)},this.getNameOwner=function(e,t){this.invokeDbus({member:"GetNameOwner",signature:"s",body:[e]},t)},this.nameHasOwner=function(e,t){this.invokeDbus({member:"NameHasOwner",signature:"s",body:[e]},t)}}},3796:e=>{e.exports={messageType:{invalid:0,methodCall:1,methodReturn:2,error:3,signal:4},headerTypeName:[null,"path","interface","member","errorName","replySerial","destination","sender","signature"],fieldSignature:{path:"o",interface:"s",member:"s",errorName:"s",replySerial:"u",destination:"s",sender:"s",signature:"g"},headerTypeId:{path:1,interface:2,member:3,errorName:4,replySerial:5,destination:6,sender:7,signature:8},protocolVersion:1,flags:{noReplyExpected:1,noAutoStart:2},endianness:{le:108,be:66},messageSignature:"yyyyuua(yv)",defaultAuthMethods:["EXTERNAL","DBUS_COOKIE_SHA1","ANONYMOUS"]}},2342:(e,t,r)=>{const i=r(6094),n=r(6707);function a(e,t,r){"object"!=typeof r?r={ayBuffer:!0,ReturnLongjs:!1}:void 0===r.ayBuffer&&(r.ayBuffer=!0),this.options=r,this.buffer=e,this.startPos=t||0,this.pos=0}a.prototype.align=function(e){var t=(1<<e)-1,r=this.pos+this.startPos+t>>e<<e;this.pos=r-this.startPos},a.prototype.readInt8=function(){return this.pos++,this.buffer[this.pos-1]},a.prototype.readSInt16=function(){this.align(1);var e=this.buffer.readInt16LE(this.pos);return this.pos+=2,e},a.prototype.readInt16=function(){this.align(1);var e=this.buffer.readUInt16LE(this.pos);return this.pos+=2,e},a.prototype.readSInt32=function(){this.align(2);var e=this.buffer.readInt32LE(this.pos);return this.pos+=4,e},a.prototype.readInt32=function(){this.align(2);var e=this.buffer.readUInt32LE(this.pos);return this.pos+=4,e},a.prototype.readDouble=function(){this.align(3);var e=this.buffer.readDoubleLE(this.pos);return this.pos+=8,e},a.prototype.readString=function(e){if(0===e)return this.pos++,"";var t=this.buffer.toString("utf8",this.pos,this.pos+e);return this.pos+=e+1,t},a.prototype.readTree=function(e){switch(e.type){case"(":case"{":case"r":return this.align(3),this.readStruct(e.child);case"a":if(!e.child||1!==e.child.length)throw new Error("Incorrect array element signature");var t=this.readInt32();return this.readArray(e.child[0],t);case"v":return this.readVariant();default:return this.readSimpleType(e.type)}},a.prototype.read=function(e){var t=n(e);return this.readStruct(t)},a.prototype.readVariant=function(){var e=this.readSimpleType("g"),t=n(e);return[t,this.readStruct(t)]},a.prototype.readStruct=function(e){for(var t=[],r=0;r<e.length;++r)t.push(this.readTree(e[r]));return t},a.prototype.readArray=function(e,t){var r,i=this.pos;if("y"===e.type&&this.options.ayBuffer)return this.pos+=t,this.buffer.slice(i,this.pos);-1!==["x","t","d","{","(","r"].indexOf(e.type)&&this.align(3);var n=this.pos+t;for(r=[];this.pos<n;)r.push(this.readTree(e));return r},a.prototype.readSimpleType=function(e){var t,r,n,a;switch(e){case"y":return this.readInt8();case"b":return!!this.readInt32();case"n":return this.readSInt16();case"q":return this.readInt16();case"u":return this.readInt32();case"i":return this.readSInt32();case"g":return r=this.readInt8(),this.readString(r);case"s":case"o":return r=this.readInt32(),this.readString(r);case"x":return this.align(3),n=this.readInt32(),a=this.readInt32(),t=i.fromBits(n,a,!1),this.options.ReturnLongjs?t:t.toNumber();case"t":return this.align(3),n=this.readInt32(),a=this.readInt32(),t=i.fromBits(n,a,!0),this.options.ReturnLongjs?t:t.toNumber();case"d":return this.readDouble();default:throw new Error(`Unsupported type: ${e}`)}},e.exports=a},1300:(e,t,r)=>{const i=r(2861).Buffer,n=r(6982),a=r(9896),o=r(6928),s=r(3796),c=r(3571);function u(e,t,r){var i=o.join(process.env[process.platform.match(/$win/)?"USERPROFILE":"HOME"],".dbus-keyrings");0===e.length&&(e="org_freedesktop_general");var n=o.join(i,e);a.stat(i,(function(e,i){return e?r(e):18&i.mode?r(new Error("User keyrings directory is writeable by other users. Aborting authentication")):process.hasOwnProperty("getuid")&&i.uid!==process.getuid()?r(new Error("Keyrings directory is not owned by the current user. Aborting authentication!")):void a.readFile(n,"ascii",(function(e,i){if(e)return r(e);for(var n=i.split("\n"),a=0;a<n.length;++a){var o=n[a].split(" ");if(t===o[0])return r(null,o[2])}return r(new Error("cookie not found"))}))}))}function l(e){return i.from(e.toString(),"ascii").toString("hex")}function h(e,t,r){if(0===t.length)return r(new Error("No authentication methods left to try"));var a=t.shift(),o=l(process.hasOwnProperty("getuid")?process.getuid():0);function s(){c(e,(function(i){var n=i.toString("ascii").match(/^([A-Za-z]+) (.*)/);return n&&"OK"===n[1]?(e.write("BEGIN\r\n"),r(null,n[2])):t.empty?r(i):void h(e,t,r)}))}switch(a){case"EXTERNAL":e.write(`AUTH ${a} ${o}\r\n`),s();break;case"DBUS_COOKIE_SHA1":e.write(`AUTH ${a} ${o}\r\n`),c(e,(function(t){var a=i.from(t.toString().split(" ")[1].trim(),"hex").toString().split(" "),o=a[0],c=a[1],h=a[2],d=n.randomBytes(16).toString("hex");u(o,c,(function(t,i){if(t)return r(t);var a,o,c=(a=[h,d,i].join(":"),(o=n.createHash("sha1")).update(a),o.digest("hex")),u=l(d+c);e.write(`DATA ${u}\r\n`),s()}))}));break;case"ANONYMOUS":e.write("AUTH ANONYMOUS \r\n"),s();break;default:console.error(`Unsupported auth method: ${a}`),s()}}e.exports=function(e,t,r){var i;i=t.authMethods?t.authMethods:s.defaultAuthMethods,e.write("\0"),h(e,i.slice(),r)}},5286:(e,t,r)=>{const i=r(8805);function n(e,t){this.$parent=e,this.$name=t,this.$methods={},this.$properties={},this.$callbacks=[],this.$sigHandlers=[]}function a(e,t,r){return`type='signal',path='${e}',interface='${t}',member='${r}'`}e.exports.introspectBus=function(t,r){t.service.bus.invoke({destination:t.service.name,path:t.name,interface:"org.freedesktop.DBus.Introspectable",member:"Introspect"},(function(i,n){e.exports.processXML(i,n,t,r)}))},e.exports.processXML=function(t,r,a,o){if(t)return o(t);(new i.Parser).parseString(r,(function(t,r){if(t)return o(t);if(!r.node)throw new Error("No root XML node");if(!(r=r.node).interface){if(r.node&&r.node.length>0&&r.node[0].$){var i=Object.assign(a,{});return"/"!==i.name.slice(-1)&&(i.name+="/"),i.name+=r.node[0].$.name,e.exports.introspectBus(i,o)}return o(new Error("No such interface found"))}for(var s,c,u,l,h,d,p,f={},v=[],g=r.interface,m=r.node||[],y=1;y<m.length;++y)v.push(m[y].$.name);for(var C=0;C<g.length;++C){p=f[s=(l=g[C]).$.name]=new n(a,s);for(var S=0;l.method&&S<l.method.length;++S){d="";for(var E=(c=l.method[S]).$.name,_=0;c.arg&&_<c.arg.length;++_)"in"===(h=c.arg[_].$).direction&&(d+=h.type);p.$createMethod(E,d)}for(var T=0;l.property&&T<l.property.length;++T)u=l.property[T],p.$createProp(u.$.name,u.$.type,u.$.access)}o(null,f,v)}))},n.prototype.$getSigHandler=function(e){var t;return-1===(t=this.$callbacks.indexOf(e))&&(t=this.$callbacks.push(e)-1,this.$sigHandlers[t]=function(t){e.apply(null,t)}),this.$sigHandlers[t]},n.prototype.addListener=n.prototype.on=function(e,t){var r=this.$parent.service.bus,i=r.mangle(this.$parent.name,this.$name,e);if(r.signals.listeners(i).length)r.signals.on(i,this.$getSigHandler(t));else{var n=a(this.$parent.name,this.$name,e);r.addMatch(n,function(e){if(e)throw new Error(e);r.signals.on(i,this.$getSigHandler(t))}.bind(this))}},n.prototype.removeListener=n.prototype.off=function(e,t){var r=this.$parent.service.bus,i=r.mangle(this.$parent.name,this.$name,e);if(r.signals.removeListener(i,this.$getSigHandler(t)),!r.signals.listeners(i).length){var n=a(this.$parent.name,this.$name,e);r.removeMatch(n,function(e){if(e)throw new Error(e);this.$callbacks.length=0,this.$sigHandlers.length=0}.bind(this))}},n.prototype.$createMethod=function(e,t){this.$methods[e]=t,this[e]=function(){this.$callMethod(e,arguments)}},n.prototype.$callMethod=function(e,t){var r=this.$parent.service.bus;Array.isArray(t)||(t=Array.from(t));var i="function"==typeof t[t.length-1]?t.pop():function(){},n={destination:this.$parent.service.name,path:this.$parent.name,interface:this.$name,member:e};""!==this.$methods[e]&&(n.signature=this.$methods[e],n.body=t),r.invoke(n,i)},n.prototype.$createProp=function(e,t,r){this.$properties[e]={type:t,access:r},Object.defineProperty(this,e,{enumerable:!0,get:()=>t=>this.$readProp(e,t),set:function(t){this.$writeProp(e,t)}})},n.prototype.$readProp=function(e,t){this.$parent.service.bus.invoke({destination:this.$parent.service.name,path:this.$parent.name,interface:"org.freedesktop.DBus.Properties",member:"Get",signature:"ss",body:[this.$name,e]},(function(e,r){e?t(e):1===r[0].length?t(e,r[1][0]):t(e,r[1])}))},n.prototype.$writeProp=function(e,t){this.$parent.service.bus.invoke({destination:this.$parent.service.name,path:this.$parent.name,interface:"org.freedesktop.DBus.Properties",member:"Set",signature:"ssv",body:[this.$name,e,[this.$properties[e].type,t]]})}},1795:(e,t,r)=>{const i=r(2613),n=r(6707),a=r(7019),o=r(5607),s=r(6020).M;function c(e,t,r){if(t.length!==r.length)throw new Error("Invalid struct data");for(var i=0;i<t.length;++i)u(e,t[i],r[i]);return e}function u(e,t,r){switch(t.type){case"(":case"{":s(e,8),c(e,t.child,r);break;case"a":var o=a();o._offset=e._offset;var l=o._offset;h(o,"u",0);var d=o._offset-4-l;-1!==["x","t","d","{","("].indexOf(t.child[0].type)&&s(o,8);for(var p=o._offset,f=0;f<r.length;++f)u(o,t.child[0],r[f]);var v=o.buffer(),g=o._offset-p;v.writeUInt32LE(g,d),e.put(v),e._offset+=v.length;break;case"v":i.equal(r.length,2,"variant data should be [signature, data]");u(e,{type:"g",child:[]},r[0]);var m=n(r[0]);i(1===m.length),u(e,m[0],r[1]);break;default:return h(e,t.type,r)}}e.exports=function(e,t,r){void 0===r&&(r=0);var i=n(e);if(!Array.isArray(t)||t.length!==i.length)throw new Error(`message body does not match message signature. Body:${JSON.stringify(t)}, signature:${e}`);var o=a();return o._offset=r,c(o,i,t).buffer()};var l=["g","o","s"];function h(e,t,r){if(void 0===r)throw new Error("Serialisation of JS 'undefined' type is not supported by d-bus");if(null===r)throw new Error("Serialisation of null value is not supported by d-bus");if(Buffer.isBuffer(r)&&(r=r.toString()),-1!==l.indexOf(t)&&"string"!=typeof r)throw new Error(`Expected string or buffer argument, got ${JSON.stringify(r)} of type '${t}'`);return o.MakeSimpleMarshaller(t).marshall(e,r),e}},5607:(e,t,r)=>{const i=r(2861).Buffer,n=r(6020).M,a=r(6707),o=r(6094);t.MakeSimpleMarshaller=function(e){var t={};function r(e){if("string"!=typeof e)throw new Error(`Data: ${e} was not of type string`);if(-1!==e.indexOf("\0"))throw new Error("String contains null byte")}switch(e){case"o":case"s":t.check=function(e){r(e)},t.marshall=function(e,t){this.check(t),n(e,4);const r=i.from(t,"utf8");e.word32le(r.length).put(r).word8(0),e._offset+=5+r.length};break;case"g":t.check=function(e){r(e),function(e){if(e.length>255)throw new Error(`Data: ${e} is too long for signature type (${e.length} > 255)`);for(var t=0,r=0;r<e.length;++r){if(t>32)throw new Error(`Maximum container type nesting exceeded in signature type:${e}`);switch(e[r]){case"(":++t;break;case")":--t}}a(e)}(e)},t.marshall=function(e,t){this.check(t);const r=i.from(t,"ascii");e.word8(t.length).put(r).word8(0),e._offset+=2+r.length};break;case"y":t.check=function(e){c(e),s(0,255,e)},t.marshall=function(e,t){this.check(t),e.word8(t),e._offset++};break;case"b":t.check=function(e){u(e)},t.marshall=function(e,t){this.check(t),t=t?1:0,n(e,4),e.word32le(t),e._offset+=4};break;case"n":t.check=function(e){c(e),s(-32768,32767,e)},t.marshall=function(e,t){this.check(t),n(e,2);const r=i.alloc(2);r.writeInt16LE(parseInt(t),0),e.put(r),e._offset+=2};break;case"q":t.check=function(e){c(e),s(0,65535,e)},t.marshall=function(e,t){this.check(t),n(e,2),e.word16le(t),e._offset+=2};break;case"i":t.check=function(e){c(e),s(-2147483648,2147483647,e)},t.marshall=function(e,t){this.check(t),n(e,4);const r=i.alloc(4);r.writeInt32LE(parseInt(t),0),e.put(r),e._offset+=4};break;case"u":t.check=function(e){c(e),s(0,4294967295,e)},t.marshall=function(e,t){this.check(t),n(e,4),e.word32le(t),e._offset+=4};break;case"t":t.check=function(e){return l(e,!1)},t.marshall=function(e,t){t=this.check(t),n(e,8),e.word32le(t.low),e.word32le(t.high),e._offset+=8};break;case"x":t.check=function(e){return l(e,!0)},t.marshall=function(e,t){t=this.check(t),n(e,8),e.word32le(t.low),e.word32le(t.high),e._offset+=8};break;case"d":t.check=function(e){if("number"!=typeof e)throw new Error(`Data: ${e} was not of type number`);if(Number.isNaN(e))throw new Error(`Data: ${e} was not a number`);if(!Number.isFinite(e))throw new Error("Number outside range")},t.marshall=function(e,t){this.check(t),n(e,8);const r=i.alloc(8);r.writeDoubleLE(parseFloat(t),0),e.put(r),e._offset+=8};break;default:throw new Error(`Unknown data type format: ${e}`)}return t};var s=function(e,t,r){if(r>t||r<e)throw new Error("Number outside range")},c=function(e){if("number"!=typeof e)throw new Error(`Data: ${e} was not of type number`);if(Math.floor(e)!==e)throw new Error(`Data: ${e} was not an integer`)},u=function(e){if("boolean"!=typeof e&&0!==e&&1!==e)throw new Error(`Data: ${e} was not of type boolean`)},l=function(e,t){if(o.isLong(e)||(e=function(e,t){if(e instanceof o)return e;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e){try{c(e),s(t?-9007199254740991:0,9007199254740991,e)}catch(e){throw e.message+=" (Number type can only carry 53 bit integer)",e}try{return o.fromNumber(e,!t)}catch(e){throw e.message=`Error converting number to 64bit integer "${e.message}"`,e}}if("string"==typeof e||e instanceof String){var r,i=10;"0X"===(e=e.trim().toUpperCase()).substring(0,2)?(i=16,e=e.substring(2)):"-0X"===e.substring(0,3)&&(i=16,e=`-${e.substring(3)}`),e=e.replace(/^0+(?=\d)/,"");try{r=o.fromString(e,!t,i)}catch(e){throw e.message=`Error converting string to 64bit integer '${e.message}'`,e}if(r.toString(i).toUpperCase()!==e)throw new Error(`Data: '${e}' did not convert correctly to ${t?"signed":"unsigned"} 64 bit`);return r}try{return o.fromBits(e.low,e.high,e.unsigned)}catch(e){throw e.message=`Error converting object to 64bit integer '${e.message}'`,e}}(e,t)),t){if(e.unsigned)throw new Error("Longjs object is unsigned, but marshalling into signed 64 bit field");if(e.gt(o.MAX_VALUE)||e.lt(o.MIN_VALUE))throw new Error(`Data: ${e} was out of range (64-bit signed)`)}else{if(!e.unsigned)throw new Error("Longjs object is signed, but marshalling into unsigned 64 bit field");if(e.gt(o.MAX_UNSIGNED_VALUE)||e.lt(0))throw new Error(`Data: ${e} was out of range (64-bit unsigned)`)}return e}},3550:(e,t,r)=>{const i=r(2861).Buffer,n=r(1795),a=r(3796),o=r(2342),s=r(4268);e.exports.unmarshalMessages=function(e,t,r){var i,n,c,u,l=0,h=0,d=0;e.on("readable",(function(){for(;;)if(0===l){if(!(i=e.read(16)))break;l=1,c=i.readUInt32LE(12),u=c+7>>3<<3,d=i.readUInt32LE(4),h=u+d}else{if(!(n=e.read(h)))break;l=0;var p=new o(n,void 0,r),f=p.readArray(s[0].child[0],c);p.align(3);var v={};v.serial=i.readUInt32LE(8);for(var g=0;g<f.length;++g)v[a.headerTypeName[f[g][0]]]=f[g][1][1][0];v.type=i[1],v.flags=i[2],d>0&&v.signature&&(v.body=p.read(v.signature)),t(v)}}))},e.exports.unmarshall=function(e,t){for(var r=new o(e,void 0,t),i=r.read("yyyyuua(yv)"),n={},s=0;s<i[6].length;++s){n[a.headerTypeName[i[6][s][0]]]=i[6][s][1][1][0]}return n.type=i[1],n.flags=i[2],n.serial=i[5],r.align(3),n.body=r.read(n.signature),n},e.exports.marshall=function(e){if(!e.serial)throw new Error("Missing or invalid serial");var t,r=e.flags||0,o=e.type||a.messageType.methodCall,s=0;e.signature&&e.body&&(s=(t=n(e.signature,e.body)).length);var c=[a.endianness.le,o,r,a.protocolVersion,s,e.serial],u=n("yyyyuu",c),l=[];a.headerTypeName.forEach((function(t){var r=e[t];r&&l.push([a.headerTypeId[t],[a.fieldSignature[t],r]])}));var h=n("a(yv)",[l],12),d=u.length+h.length+7>>3<<3,p=d+s,f=i.alloc(p);return u.copy(f),h.copy(f,u.length),s>0&&t.copy(f,d),f}},3571:(e,t,r)=>{const i=r(2861).Buffer;e.exports=function(e,t){var r=[];e.on("readable",(function n(){for(;;){var a=e.read(1);if(!a)return;var o=a[0];if(10===o){try{t(i.from(r))}catch(t){e.emit("error",t)}return void e.removeListener("readable",n)}r.push(o)}}))}},126:(e,t,r)=>{const i=r(2861).Buffer,n=r(3571);e.exports=function(e,t,r){e.name="SERVER SERVER",n(e,(function(t){console.log(["hello string: ",t.toString(),t]),e.write("REJECTED EXTERNAL DBUS_COOKIE_SHA1 ANONYMOUS\r\n"),n(e,(function(){e.write(`DATA ${i.from("org_freedesktop_general 642038150 b9ce247a275f427c8586e4c9de9bb951").toString("hex")}\r\n`),n(e,(function(){e.write("OK 6f72675f667265656465736b746f705f67656e6572616c20353631303331333937206239636532343761323735663432376338353836653463396465396262393531\r\n"),n(e,(function(e){console.log(["AFTER begin: ",e.toString()]),r(null)}))}))}))}))}},1138:(e,t,r)=>{const i=r(7845),n=r(9278);e.exports.createServer=function(e){return new function(){var t=123;this.server=n.createServer((function(r){r.idd=t,t++;var n=i.createConnection({stream:r,server:!0});e&&e(n)})),this.listen=this.server.listen.bind(this.server)}}},6707:e=>{var t={"{":"}","(":")"},r={};"(){}ybnqiuxtdsogarvehm*?@&^".split("").forEach((function(e){r[e]=!0})),e.exports=function(e){var i=0;function n(){if(i<e.length){var t=e[i];return++i,t}return null}function a(i){function o(e){if(!e)throw new Error("Bad signature: unexpected end");return e}if(!r[i])throw new Error(`Unknown type: "${i}" in signature "${e}"`);var s,c={type:i,child:[]};switch(i){case"a":return o(s=n()),c.child.push(a(s)),c;case"{":case"(":for(;null!==(s=n())&&s!==t[i];)c.child.push(a(s));return o(s),c}return c}for(var o,s=[];null!==(o=n());)s.push(a(o));return s}},7407:(e,t,r)=>{const i=r(3796),n=r(6707);var a;function o(e){var t=[],r=function(e,r,i){e&&n(e).forEach((function(e,n){var a=r?r[n]:i+n,o="signal"===i?"":`" direction="${i}`;t.push(`      <arg type="${s([e])}" name="${a}${o}" />`)}))};if(t.push(`  <interface name="${e.name}">`),e.methods)for(var i in e.methods){var a=e.methods[i];t.push(`    <method name="${i}">`),r(a[0],a[2],"in"),r(a[1],a[3],"out"),t.push("    </method>")}if(e.signals)for(var o in e.signals){var c=e.signals[o];t.push(`    <signal name="${o}">`),r(c[0],c.slice(1),"signal"),t.push("    </signal>")}if(e.properties)for(const r in e.properties)t.push(`    <property name="${r}" type="${e.properties[r]}" access="readwrite"/>`);return t.push("  </interface>"),t.join("\n")}function s(e){var t=[];return e.forEach((function(e){t.push(e.type+s(e.child)),"{"===e.type&&t.push("}"),"("===e.type&&t.push(")")})),t.join("")}e.exports=function(e,t){if("org.freedesktop.DBus.Introspectable"===e.interface&&"Introspect"===e.member){"/"===e.path&&(e.path="");var r=['<!DOCTYPE node PUBLIC "-//freedesktop//DTD D-BUS Object Introspection 1.0//EN"\n    "http://www.freedesktop.org/standards/dbus/1.0/introspect.dtd">'],n={};for(var s in t.exportedObjects)if(0===s.indexOf(e.path)){var c=t.exportedObjects[e.path];if(c)n[e.path]=c;else{if("/"!==s[e.path.length])continue;n[s.substr(e.path.length).split("/")[1]]=null}}var u=Object.keys(n).length;if(0===u)r.push("<node/>");else if(1===u){var l=n[Object.keys(n)[0]];if(l){for(var h in r.push("<node>"),l)r.push(o(l[h][0]));r.push(a),r.push("</node>")}else r.push(`<node>\n  <node name="${Object.keys(n)[0]}"/>\n  </node>`)}else{for(var d in r.push("<node>"),n)if(null===n[d])r.push(`  <node name="${d}" />`);else{for(var p in l=n[d],r.push(`  <node name="${d}" >`),l)r.push(o(l[p][0]));r.push(a),r.push("  </node>")}r.push("</node>")}const f={type:i.messageType.methodReturn,serial:t.serial++,replySerial:e.serial,destination:e.sender,signature:"s",body:[r.join("\n")]};return t.connection.message(f),1}if("org.freedesktop.DBus.Properties"===e.interface){var f=e.body[0],v=t.exportedObjects[e.path];if(!v||!v[f])return t.sendError(e,"org.freedesktop.DBus.Error.UnknownMethod","Uh oh oh"),1;var g=v[f][1];const r={type:i.messageType.methodReturn,serial:t.serial++,replySerial:e.serial,destination:e.sender};if("Get"===e.member||"Set"===e.member){var m=e.body[1],y=v[f][0].properties[m];if("Get"===e.member){var C=g[m];r.signature="v",r.body=[[y,C]]}else g[m]=1234}else if("GetAll"===e.member){r.signature="a{sv}";var S=[];for(var E in v[f][0].properties){var _=v[f][0].properties[E];S.push([E,[_,g[E]]])}r.body=[S]}return t.connection.message(r),1}if("org.freedesktop.DBus.Peer"===e.interface){const r={type:i.messageType.methodReturn,serial:t.serial++,replySerial:e.serial,destination:e.sender};return"Ping"===e.member||"GetMachineId"===e.member&&(r.signature="s",r.body=["This is a machine id. TODO: implement"]),t.connection.message(r),1}return 0},a='  <interface name="org.freedesktop.DBus.Properties">\n    <method name="Get">\n      <arg type="s" name="interface_name" direction="in"/>\n      <arg type="s" name="property_name" direction="in"/>\n      <arg type="v" name="value" direction="out"/>\n    </method>\n    <method name="GetAll">\n      <arg type="s" name="interface_name" direction="in"/>\n      <arg type="a{sv}" name="properties" direction="out"/>\n    </method>\n    <method name="Set">\n      <arg type="s" name="interface_name" direction="in"/>\n      <arg type="s" name="property_name" direction="in"/>\n      <arg type="v" name="value" direction="in"/>\n    </method>\n    <signal name="PropertiesChanged">\n      <arg type="s" name="interface_name"/>\n      <arg type="a{sv}" name="changed_properties"/>\n      <arg type="as" name="invalidated_properties"/>\n    </signal>\n  </interface>\n  <interface name="org.freedesktop.DBus.Introspectable">\n    <method name="Introspect">\n      <arg type="s" name="xml_data" direction="out"/>\n    </method>\n  </interface>\n  <interface name="org.freedesktop.DBus.Peer">\n    <method name="Ping"/>\n    <method name="GetMachineId">\n      <arg type="s" name="machine_uuid" direction="out"/>\n    </method>\n  </interface>'},9790:e=>{"use strict";var t="undefined"!=typeof BigInt&&BigInt;e.exports=function(){return"function"==typeof t&&"function"==typeof BigInt&&"bigint"==typeof t(42)&&"bigint"==typeof BigInt(42)}},5884:e=>{"use strict";e.exports=(e,t=process.argv)=>{const r=e.startsWith("-")?"":1===e.length?"-":"--",i=t.indexOf(r+e),n=t.indexOf("--");return-1!==i&&(-1===n||i<n)}},592:(e,t,r)=>{"use strict";var i=r(655),n=function(){return!!i};n.hasArrayLengthDefineBug=function(){if(!i)return null;try{return 1!==i([],"length",{value:1}).length}catch(e){return!0}},e.exports=n},24:e=>{"use strict";var t={__proto__:null,foo:{}},r=Object;e.exports=function(){return{__proto__:t}.foo===t.foo&&!(t instanceof r)}},4039:(e,t,r)=>{"use strict";var i="undefined"!=typeof Symbol&&Symbol,n=r(1333);e.exports=function(){return"function"==typeof i&&("function"==typeof Symbol&&("symbol"==typeof i("foo")&&("symbol"==typeof Symbol("bar")&&n())))}},1333:e=>{"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var i=Object.getOwnPropertySymbols(e);if(1!==i.length||i[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var n=Object.getOwnPropertyDescriptor(e,t);if(42!==n.value||!0!==n.enumerable)return!1}return!0}},9092:(e,t,r)=>{"use strict";var i=r(1333);e.exports=function(){return i()&&!!Symbol.toStringTag}},9957:(e,t,r)=>{"use strict";var i=Function.prototype.call,n=Object.prototype.hasOwnProperty,a=r(6743);e.exports=a.call(i,n)},7244:(e,t,r)=>{"use strict";var i=r(9092)(),n=r(8075)("Object.prototype.toString"),a=function(e){return!(i&&e&&"object"==typeof e&&Symbol.toStringTag in e)&&"[object Arguments]"===n(e)},o=function(e){return!!a(e)||null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==n(e)&&"[object Function]"===n(e.callee)},s=function(){return a(arguments)}();a.isLegacyArguments=o,e.exports=s?a:o},4670:(e,t,r)=>{"use strict";var i=r(487),n=r(8075),a=r(453)("%ArrayBuffer%",!0),o=n("ArrayBuffer.prototype.byteLength",!0),s=n("Object.prototype.toString"),c=!!a&&!o&&new a(0).slice,u=!!c&&i(c);e.exports=o||u?function(e){if(!e||"object"!=typeof e)return!1;try{return o?o(e):u(e,0),!0}catch(e){return!1}}:a?function(e){return"[object ArrayBuffer]"===s(e)}:function(e){return!1}},9803:(e,t,r)=>{"use strict";if(r(9790)()){var i=BigInt.prototype.valueOf;e.exports=function(e){return null!=e&&"boolean"!=typeof e&&"string"!=typeof e&&"number"!=typeof e&&"symbol"!=typeof e&&"function"!=typeof e&&("bigint"==typeof e||function(e){try{return i.call(e),!0}catch(e){}return!1}(e))}}else e.exports=function(e){return!1}},5128:(e,t,r)=>{"use strict";var i=r(8075),n=i("Boolean.prototype.toString"),a=i("Object.prototype.toString"),o=r(9092)();e.exports=function(e){return"boolean"==typeof e||null!==e&&"object"==typeof e&&(o&&Symbol.toStringTag in e?function(e){try{return n(e),!0}catch(e){return!1}}(e):"[object Boolean]"===a(e))}},9600:e=>{"use strict";var t,r,i=Function.prototype.toString,n="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof n&&"function"==typeof Object.defineProperty)try{t=Object.defineProperty({},"length",{get:function(){throw r}}),r={},n((function(){throw 42}),null,t)}catch(e){e!==r&&(n=null)}else n=null;var a=/^\s*class\b/,o=function(e){try{var t=i.call(e);return a.test(t)}catch(e){return!1}},s=function(e){try{return!o(e)&&(i.call(e),!0)}catch(e){return!1}},c=Object.prototype.toString,u="function"==typeof Symbol&&!!Symbol.toStringTag,l=!(0 in[,]),h=function(){return!1};if("object"==typeof document){var d=document.all;c.call(d)===c.call(document.all)&&(h=function(e){if((l||!e)&&(void 0===e||"object"==typeof e))try{var t=c.call(e);return("[object HTMLAllCollection]"===t||"[object HTML document.all class]"===t||"[object HTMLCollection]"===t||"[object Object]"===t)&&null==e("")}catch(e){}return!1})}e.exports=n?function(e){if(h(e))return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;try{n(e,null,t)}catch(e){if(e!==r)return!1}return!o(e)&&s(e)}:function(e){if(h(e))return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if(u)return s(e);if(o(e))return!1;var t=c.call(e);return!("[object Function]"!==t&&"[object GeneratorFunction]"!==t&&!/^\[object HTML/.test(t))&&s(e)}},2120:(e,t,r)=>{"use strict";var i=Date.prototype.getDay,n=Object.prototype.toString,a=r(9092)();e.exports=function(e){return"object"==typeof e&&null!==e&&(a?function(e){try{return i.call(e),!0}catch(e){return!1}}(e):"[object Date]"===n.call(e))}},3802:e=>{"use strict";var t,r="function"==typeof Map&&Map.prototype?Map:null,i="function"==typeof Set&&Set.prototype?Set:null;r||(t=function(e){return!1});var n=r?Map.prototype.has:null,a=i?Set.prototype.has:null;t||n||(t=function(e){return!1}),e.exports=t||function(e){if(!e||"object"!=typeof e)return!1;try{if(n.call(e),a)try{a.call(e)}catch(e){return!0}return e instanceof r}catch(e){}return!1}},1703:(e,t,r)=>{"use strict";var i=Number.prototype.toString,n=Object.prototype.toString,a=r(9092)();e.exports=function(e){return"number"==typeof e||"object"==typeof e&&(a?function(e){try{return i.call(e),!0}catch(e){return!1}}(e):"[object Number]"===n.call(e))}},4035:(e,t,r)=>{"use strict";var i,n,a,o,s=r(8075),c=r(9092)();if(c){i=s("Object.prototype.hasOwnProperty"),n=s("RegExp.prototype.exec"),a={};var u=function(){throw a};o={toString:u,valueOf:u},"symbol"==typeof Symbol.toPrimitive&&(o[Symbol.toPrimitive]=u)}var l=s("Object.prototype.toString"),h=Object.getOwnPropertyDescriptor;e.exports=c?function(e){if(!e||"object"!=typeof e)return!1;var t=h(e,"lastIndex");if(!(t&&i(t,"value")))return!1;try{n(e,o)}catch(e){return e===a}}:function(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&"[object RegExp]"===l(e)}},256:e=>{"use strict";var t,r="function"==typeof Map&&Map.prototype?Map:null,i="function"==typeof Set&&Set.prototype?Set:null;i||(t=function(e){return!1});var n=r?Map.prototype.has:null,a=i?Set.prototype.has:null;t||a||(t=function(e){return!1}),e.exports=t||function(e){if(!e||"object"!=typeof e)return!1;try{if(a.call(e),n)try{n.call(e)}catch(e){return!0}return e instanceof i}catch(e){}return!1}},7070:(e,t,r)=>{"use strict";var i=r(8075)("SharedArrayBuffer.prototype.byteLength",!0);e.exports=i?function(e){if(!e||"object"!=typeof e)return!1;try{return i(e),!0}catch(e){return!1}}:function(e){return!1}},4761:(e,t,r)=>{"use strict";var i=String.prototype.valueOf,n=Object.prototype.toString,a=r(9092)();e.exports=function(e){return"string"==typeof e||"object"==typeof e&&(a?function(e){try{return i.call(e),!0}catch(e){return!1}}(e):"[object String]"===n.call(e))}},3612:(e,t,r)=>{"use strict";var i=Object.prototype.toString;if(r(4039)()){var n=Symbol.prototype.toString,a=/^Symbol\(.*\)$/;e.exports=function(e){if("symbol"==typeof e)return!0;if("[object Symbol]"!==i.call(e))return!1;try{return function(e){return"symbol"==typeof e.valueOf()&&a.test(n.call(e))}(e)}catch(e){return!1}}}else e.exports=function(e){return!1}},7842:e=>{"use strict";var t,r="function"==typeof WeakMap&&WeakMap.prototype?WeakMap:null,i="function"==typeof WeakSet&&WeakSet.prototype?WeakSet:null;r||(t=function(e){return!1});var n=r?r.prototype.has:null,a=i?i.prototype.has:null;t||n||(t=function(e){return!1}),e.exports=t||function(e){if(!e||"object"!=typeof e)return!1;try{if(n.call(e,n),a)try{a.call(e,a)}catch(e){return!0}return e instanceof r}catch(e){}return!1}},2648:(e,t,r)=>{"use strict";var i=r(453),n=r(8075),a=i("%WeakSet%",!0),o=n("WeakSet.prototype.has",!0);if(o){var s=n("WeakMap.prototype.has",!0);e.exports=function(e){if(!e||"object"!=typeof e)return!1;try{if(o(e,o),s)try{s(e,s)}catch(e){return!0}return e instanceof a}catch(e){}return!1}}else e.exports=function(e){return!1}},4634:e=>{var t={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==t.call(e)}},9292:(e,t,r)=>{var i=r(2203).Stream;e.exports=function(e,t){var r=new i,n=0,a=0,o=!1,s=!1,c=!1,u=0,l=!1,h=(t=t||{}).failures?"failure":"error",d={};function p(e,t){var i=u+1;if(t===i?(void 0!==e&&r.emit.apply(r,["data",e]),u++,i++):d[t]=e,d.hasOwnProperty(i)){var c=d[i];return delete d[i],p(c,i)}a++,n===a&&(s&&(s=!1,r.emit("drain")),o&&v())}function f(e,i,n){c||(l=!0,e&&!t.failures||p(i,n),e&&r.emit.apply(r,[h,e]),l=!1)}function v(e){if(o=!0,r.writable=!1,void 0!==e)return p(e,n);n==a&&(r.readable=!1,r.emit("end"),r.destroy())}return r.writable=!0,r.readable=!0,r.write=function(t){if(o)throw new Error("map stream is not writable");l=!1,n++;try{var r=(i=t,a=n,c=f,e.call(null,i,(function(e,t){c(e,t,a)})));return!(s=!1===r)}catch(e){if(l)throw e;return f(e),!s}var i,a,c},r.end=function(e){o||v(e)},r.destroy=function(){o=c=!0,r.writable=r.readable=s=!1,process.nextTick((function(){r.emit("close")}))},r.pause=function(){s=!0},r.resume=function(){s=!1},r}},3480:(e,t,r)=>{var i=r(6928),n=r(9896),a=parseInt("0777",8);function o(e,t,r,s){"function"==typeof t?(r=t,t={}):t&&"object"==typeof t||(t={mode:t});var c=t.mode,u=t.fs||n;void 0===c&&(c=a),s||(s=null);var l=r||function(){};e=i.resolve(e),u.mkdir(e,c,(function(r){if(!r)return l(null,s=s||e);if("ENOENT"===r.code){if(i.dirname(e)===e)return l(r);o(i.dirname(e),t,(function(r,i){r?l(r,i):o(e,t,l,i)}))}else u.stat(e,(function(e,t){e||!t.isDirectory()?l(r,s):l(null,s)}))}))}e.exports=o.mkdirp=o.mkdirP=o,o.sync=function e(t,r,o){r&&"object"==typeof r||(r={mode:r});var s=r.mode,c=r.fs||n;void 0===s&&(s=a),o||(o=null),t=i.resolve(t);try{c.mkdirSync(t,s),o=o||t}catch(n){if("ENOENT"===n.code)o=e(i.dirname(t),r,o),e(t,r,o);else{var u;try{u=c.statSync(t)}catch(e){throw n}if(!u.isDirectory())throw n}}return o}},6585:e=>{var t=1e3,r=60*t,i=60*r,n=24*i,a=7*n,o=365.25*n;function s(e,t,r,i){var n=t>=1.5*r;return Math.round(e/r)+" "+i+(n?"s":"")}e.exports=function(e,c){c=c||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var s=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!s)return;var c=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*o;case"weeks":case"week":case"w":return c*a;case"days":case"day":case"d":return c*n;case"hours":case"hour":case"hrs":case"hr":case"h":return c*i;case"minutes":case"minute":case"mins":case"min":case"m":return c*r;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===u&&isFinite(e))return c.long?function(e){var a=Math.abs(e);if(a>=n)return s(e,a,n,"day");if(a>=i)return s(e,a,i,"hour");if(a>=r)return s(e,a,r,"minute");if(a>=t)return s(e,a,t,"second");return e+" ms"}(e):function(e){var a=Math.abs(e);if(a>=n)return Math.round(e/n)+"d";if(a>=i)return Math.round(e/i)+"h";if(a>=r)return Math.round(e/r)+"m";if(a>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},2781:(e,t)=>{var r=function(e){return"_"+e},i=function(e){return e};t.stringify=function(e){return"object"==typeof e&&e&&e.name?t.stringify(e.name,e.protocol,e.subtypes):Array.prototype.concat.apply([],arguments).filter(i).map(r).join(".")},t.parse=function(e){for(var t=e.split("."),r=0;r<t.length;r++)"_"===t[r][0]&&(t[r]=t[r].slice(1));return{name:t.shift(),protocol:t.shift()||null,subtypes:t}},t.tcp=function(e){return t.stringify(e,"tcp",Array.prototype.concat.apply([],Array.prototype.slice.call(arguments,1)))},t.udp=function(e){return t.stringify(e,"udp",Array.prototype.concat.apply([],Array.prototype.slice.call(arguments,1)))}},2567:(e,t,r)=>{var i=r(3843),n=r(7194),a=r(294),o=r(4434),s=r(857),c=function(){};function u(e){return 4===e||"IPv4"===e}e.exports=function(e){e||(e={});var t=new o.EventEmitter,r="number"==typeof e.port?e.port:5353,l=e.type||"udp4",h=e.ip||e.host||("udp4"===l?"224.0.0.251":null),d={address:h,port:r},p={},f=!1,v=null;if(!("udp6"!==l||h&&e.interface))throw new Error("For IPv6 multicast you must specify `ip` and `interface`");var g=e.socket||n.createSocket({type:l,reuseAddr:!1!==e.reuseAddr,toString:function(){return l}});g.on("error",(function(e){"EACCES"===e.code||"EADDRINUSE"===e.code?t.emit("error",e):t.emit("warning",e)})),g.on("message",(function(e,r){try{e=i.decode(e)}catch(e){return void t.emit("warning",e)}t.emit("packet",e,r),"query"===e.type&&t.emit("query",e,r),"response"===e.type&&t.emit("response",e,r)})),g.on("listening",(function(){r||(r=d.port=g.address().port),!1!==e.multicast&&(t.update(),v=setInterval(t.update,5e3),g.setMulticastTTL(e.ttl||255),g.setMulticastLoopback(!1!==e.loopback))}));var m=a((function(t){if(!r||!1===e.bind)return t(null);g.once("error",t),g.bind(r,e.bind||e.interface,(function(){g.removeListener("error",t),t(null)}))}));return m((function(e){if(e)return t.emit("error",e);t.emit("ready")})),t.send=function(e,r,n){if("function"==typeof r)return t.send(e,null,r);n||(n=c),r?r.host||r.address||(r.address=d.address):r=d,m((function(t){if(f)return n();if(t)return n(t);var a=i.encode(e);g.send(a,0,a.length,r.port,r.address||r.host,n)}))},t.response=t.respond=function(e,r,n){Array.isArray(e)&&(e={answers:e}),e.type="response",e.flags=(e.flags||0)|i.AUTHORITATIVE_ANSWER,t.send(e,r,n)},t.query=function(e,r,i,n){return"function"==typeof r?t.query(e,null,null,r):"object"==typeof r&&r&&r.port?t.query(e,null,r,i):"function"==typeof i?t.query(e,r,null,i):(n||(n=c),"string"==typeof e&&(e=[{name:e,type:r||"ANY"}]),Array.isArray(e)&&(e={type:"query",questions:e}),e.type="query",void t.send(e,i,n))},t.destroy=function(e){if(e||(e=c),f)return process.nextTick(e);for(var t in f=!0,clearInterval(v),p)try{g.dropMembership(h,t)}catch(e){}p={},g.close(e)},t.update=function(){for(var r=e.interface?[].concat(e.interface):function(){for(var e=s.networkInterfaces(),t=Object.keys(e),r=[],i=0;i<t.length;i++)for(var n=e[t[i]],a=0;a<n.length;a++){var o=n[a];if(u(o.family)){r.push(o.address);break}}return r}(),i=!1,n=0;n<r.length;n++){var a=r[n];if(!p[a])try{g.addMembership(h,a),p[a]=!0,i=!0}catch(e){t.emit("warning",e)}}if(i){if(g.setMulticastInterface)try{g.setMulticastInterface(e.interface||function(){for(var e=s.networkInterfaces(),t=Object.keys(e),r=0;r<t.length;r++)for(var i=e[t[r]],n=0;n<i.length;n++){var a=i[n];if(u(a.family)&&!a.internal)return"darwin"===s.platform()&&"en0"===t[r]?a.address:"0.0.0.0"}return"127.0.0.1"}())}catch(e){t.emit("warning",e)}t.emit("networkInterface")}},t}},1566:(e,t,r)=>{var i=r(9896),n=r(6928),a=r(3480),o=r(3231),s={dir:"persist",stringify:JSON.stringify,parse:JSON.parse,encoding:"utf8",logging:!1,continuous:!0,interval:!1,ttl:!1},c=function(e){return"function"==typeof e},u=function(e){if(e)throw e},l=function(){},h=function(e){if(!(this instanceof h))return new h(e);this.data={},this.ttls={},this.changes={},this.setOptions(e)};h.prototype={setOptions:function(e){var t,r={};if(e){for(var i in s)e.hasOwnProperty(i)?r[i]=e[i]:r[i]=s[i];r.dir=this.resolveDir(r.dir),r.ttlDir=r.dir+"-ttl",r.ttl=!!r.ttl&&(t=r.ttl,!isNaN(parseFloat(t))&&isFinite(t)&&r.ttl>0?r.ttl:864e5)}else r=s;c(r.logging)&&(this.log=r.logging,r.logging=!0),this.options=r},init:function(e,t){c(e)&&(t=e,e=null),e&&this.setOptions(e),t=c(t)?t:u;var r=o.defer(),i=[],n=this.options,a={dir:n.dir};return i.push(this.parseDataDir()),n.ttl&&(a.ttlDir=n.ttlDir,i.push(this.parseTTLDir())),n.interval&&n.interval>0&&(this._persistInterval=setInterval(this.persist.bind(this),n.interval)),o.all(i).then((function(){r.resolve(a),t(null,a)}),(function(e){r.reject(e),t(e)})),r.promise},initSync:function(e){e&&this.setOptions(e);var t=this.options;t.logging&&(this.log("options:"),this.log(t.stringify(t))),this.parseDataDirSync(),t.ttl&&this.parseTTLDirSync(),t.interval&&t.interval>0&&(this._persistInterval=setInterval(this.persistSync.bind(this),t.interval))},key:function(e){var t=this.keys();return t.length<=e?null:t[e]},keys:function(){return Object.keys(this.data)},length:function(){return this.keys().length},forEach:function(e){return this.keys().forEach(function(t){e(t,this.data[t])}.bind(this))},values:function(e){e=c(e)?e:l;var t=this.keys().map(function(e){return this.data[e]}.bind(this));return e(t),t},valuesWithKeyMatch:function(e,t){t=c(t)?t:l;var r=(e=e||/.*/)instanceof RegExp?function(t){return e.test(t)}:function(t){return-1!==e.indexOf(t)},i=[];return this.keys().forEach(function(e){r(e)&&i.push(this.data[e])}.bind(this)),t(i),i},setItem:function(e,t,r){r=c(r)?r:u;var i,n=this.options,a="set ("+e+": "+n.stringify(t)+")",s=o.defer(),l=[];this.data[e]=t,n.ttl&&(this.ttls[e]=(new Date).getTime()+n.ttl),i={key:e,value:t,queued:!!n.interval,manual:!n.interval&&!n.continuous};return this.log(a),n.interval||!n.continuous?this.changes[e]={onSuccess:function(){r(null,i),s.resolve(i)},onError:function(e){r(e),s.reject(e)}}:(l.push(this.persistKey(e)),o.all(l).then(function(e){s.resolve(e),r(null,e)}.bind(this),(function(e){s.reject(e),r(e)}))),s.promise},setItemSync:function(e,t){this.data[e]=t,this.options.ttl&&(this.ttls[e]=(new Date).getTime()+this.options.ttl),this.persistKeySync(e),this.log("set ("+e+": "+this.options.stringify(t)+")")},getItem:function(e,t){if(t=c(t)?t:u,!this.isExpired(e))return t(null,this.data[e]),this.data[e];this.log(e+" has expired"),!this.options.interval&&this.options.continuous?this.removeItem(e,(function(){t(null,null)})):t(null,null)},getItemSync:function(e){if(!this.isExpired(e))return this.data[e];this.removeItemSync(e)},removeItem:function(e,t){t=c(t)?t:u;var r=o.defer(),i=[];return i.push(this.removePersistedKey(e)),o.all(i).then(function(){delete this.data[e],delete this.ttls[e],this.log("removed: "+e),t(null,this.data),r.resolve(this.data)}.bind(this),(function(e){t(e),r.reject(e)})),r.promise},removeItemSync:function(e){this.removePersistedKeySync(e),delete this.data[e],delete this.ttls[e],this.log("removed: "+e)},clear:function(e){e=c(e)?e:u;for(var t=o.defer(),r=[],i=this.keys(),n=0;n<i.length;n++)r.push(this.removePersistedKey(i[n]));return o.all(r).then(function(r){this.data={},this.ttls={},this.changes={},t.resolve(r),e(null,r)}.bind(this),(function(r){t.reject(r),e(r)})),t.promise},clearSync:function(){for(var e=this.keys(!0),t=0;t<e.length;t++)this.removePersistedKeySync(e[t]);this.data={},this.ttls={},this.changes={}},persist:function(e){e=c(e)?e:u;var t=o.defer(),r=[];for(var i in this.data)this.changes[i]&&r.push(this.persistKey(i));return o.all(r).then(function(r){t.resolve(r),e(null,r),this.log("persist done")}.bind(this),(function(r){t.reject(undefined),e(r)})),t.promise},persistSync:function(){for(var e in this.data)this.changes[e]&&this.persistKeySync(e);this.log("persistSync done")},persistKey:function(e,t){t=c(t)?t:u;var r,s,l=this,h=this.options,d=h.stringify(this.data[e]),p=n.join(h.dir,e),f=o.defer(),v=function(r){return l.changes[e]&&l.changes[e].onError&&l.changes[e].onError(r),f.reject(r),t(r)},g=function(){l.changes[e]&&l.changes[e].onSuccess&&l.changes[e].onSuccess(),delete l.changes[e],l.log("wrote: "+e),s={key:e,data:d,file:p},f.resolve(s),t(null,s)};return a(n.dirname(p),(function(t){t&&v(t),i.writeFile(p,d,h.encoding,function(t){t&&v(t),h.ttl?(r=n.join(h.ttlDir,e),a(n.dirname(r),(function(t){i.writeFile(r,h.stringify(l.ttls[e]),h.encoding,(function(){t?v(t):g()}))}))):g()}.bind(this))})),f.promise},persistKeySync:function(e){var t,r=this.options,o=n.join(r.dir,e);try{a.sync(n.dirname(o)),i.writeFileSync(o,r.stringify(this.data[e])),this.changes[e]&&this.changes[e].onSuccess&&this.changes[e].onSuccess()}catch(t){throw this.changes[e]&&this.changes[e].onError&&this.changes[e].onError(t),t}r.ttl&&(t=n.join(r.ttlDir,e),a.sync(n.dirname(t)),i.writeFileSync(t,r.stringify(this.ttls[e]))),delete this.changes[e],this.log("wrote: "+e)},removePersistedKey:function(e,t){t=c(t)?t:u;var r,a=this.options,s=o.defer(),l=n.join(a.dir,e);return i.exists(l,(function(o){o?i.unlink(l,(function(o){r={key:e,removed:!o,exists:!0};var c=function(e){s.reject(e),t(e)},u=function(){s.resolve(r),t(null,r)};if(o)return c(o);if(a.ttl){var l=n.join(a.ttlDir,e);i.exists(l,(function(e){e?i.unlink(l,(function(e){e&&c(e),u()})):u()}))}else u()})):(r={key:e,removed:!1,exists:!1},s.resolve(r),t(null,r))})),s.promise},parseString:function(e){try{return this.options.parse(e)}catch(e){return void this.log("parse error: ",this.options.stringify(e))}},parseTTLDir:function(e){return this.parseDir(this.options.ttlDir,this.parseTTLFile.bind(this),e)},parseTTLDirSync:function(){return this.parseDirSync(this.options.ttlDir,this.ttls)},parseDataDir:function(e){return this.parseDir(this.options.dir,this.parseDataFile.bind(this),e)},parseDataDirSync:function(){return this.parseDirSync(this.options.dir,this.data)},parseDir:function(e,t,r){r=c(r)?r:u;var n=o.defer(),s=[],l={dir:e};return i.exists(e,function(c){c?i.readdir(e,function(e,i){for(var a in e&&(n.reject(e),r(e)),i){var c=i[a];"."!==c[0]&&s.push(t(c))}o.all(s).then((function(){n.resolve(l),r(null,l)}),(function(e){n.reject(e),r(e)}))}.bind(this)):a(e,function(t){t?(console.error(t),n.reject(t),r(t)):(this.log("created "+e),n.resolve(l),r(null,l))}.bind(this))}.bind(this)),n.promise},parseDirSync:function(e,t){if(i.existsSync(e))for(var r=i.readdirSync(e),o=0;o<r.length;o++){var s=r[o];if(r[o]&&"."!==s[0]){var c=i.readFileSync(n.join(e,s),this.options.encoding);t[s]=this.parseString(c)}}else a.sync(e)},parseDataFile:function(e,t){return this.parseFile(e,this.options.dir,this.data,t)},parseDataFileSync:function(e){return this.parseFileSync(e,this.options.dir,this.data)},parseTTLFile:function(e,t){return this.parseFile(e,this.options.ttlDir,this.ttls,t)},parseTTLFileSync:function(e){return this.parseFileSync(e,this.options.ttlDir,this.ttls)},parseFile:function(e,t,r,a){a=c(a)?a:u;var s,l=o.defer(),h=n.join(t,e),d=this.options;return i.readFile(h,d.encoding,function(i,n){if(i)return l.reject(i),a(i);var o=this.parseString(n);r[e]=o,this.log("loaded: "+t+"/"+e),s={key:e,value:o,file:h},l.resolve(s),a(null,s)}.bind(this)),l.promise},parseFileSync:function(e,t,r){var a=n.join(t,e);return r[e]=i.readFileSync(a,this.options.encoding),this.log("loaded: "+t+"/"+e),r[e]},isExpired:function(e){return!!this.options.ttl&&this.ttls[e]<(new Date).getTime()},removePersistedKeySync:function(e){var t=this.options,r=n.join(t.dir,e);if(i.existsSync(r)&&i.unlinkSync(r),t.ttl){var a=n.join(t.ttlDir,e);i.existsSync(a)&&i.unlinkSync(a)}},resolveDir:function(e){return(e=n.normalize(e))!==n.resolve(e)&&(e=n.join(__dirname,"storage",e||""),this.log("Made dir absolute: "+e)),e},stopInterval:function(){clearInterval(this._persistInterval)},log:function(){this.options&&this.options.logging&&console.log.apply(console,arguments)}},e.exports=h},3396:(e,t,r)=>{var i=r(1566);!function(e){var t;e.create=function(e){return i(e)},e.init=function(r,i){return(t=e.create(r)).init(i)},e.initSync=function(r){return(t=e.create(r)).initSync()},e.key=function(e){return t.key(e)},e.keys=function(){return t.keys()},e.length=function(){return t.length()},e.forEach=function(e){return t.forEach(e)},e.values=function(e){return t.values(e)},e.valuesWithKeyMatch=function(e,r){return t.valuesWithKeyMatch(e,r)},e.setItem=function(e,r,i){return t.setItem(e,r,i)},e.setItemSync=function(e,r){return t.setItemSync(e,r)},e.getItem=function(e,r){return t.getItem(e,r)},e.getItemSync=function(e){return t.getItemSync(e)},e.removeItem=function(e,r){return t.removeItem(e,r)},e.removeItemSync=function(e){return t.removeItemSync(e)},e.clear=function(e){return t.clear(e)},e.clearSync=function(){return t.clearSync()},e.persist=function(e){return t.persist(e)},e.persistSync=function(){return t.persistSync()},e.persistKey=function(e,r){return t.persistKey(e,r)},e.persistKeySync=function(e){return t.persistKeySync(e)}}(e.exports)},8859:(e,t,r)=>{var i="function"==typeof Map&&Map.prototype,n=Object.getOwnPropertyDescriptor&&i?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,a=i&&n&&"function"==typeof n.get?n.get:null,o=i&&Map.prototype.forEach,s="function"==typeof Set&&Set.prototype,c=Object.getOwnPropertyDescriptor&&s?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,u=s&&c&&"function"==typeof c.get?c.get:null,l=s&&Set.prototype.forEach,h="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,d="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,p="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,f=Boolean.prototype.valueOf,v=Object.prototype.toString,g=Function.prototype.toString,m=String.prototype.match,y=String.prototype.slice,C=String.prototype.replace,S=String.prototype.toUpperCase,E=String.prototype.toLowerCase,_=RegExp.prototype.test,T=Array.prototype.concat,A=Array.prototype.join,I=Array.prototype.slice,D=Math.floor,w="function"==typeof BigInt?BigInt.prototype.valueOf:null,b=Object.getOwnPropertySymbols,U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,R="function"==typeof Symbol&&"object"==typeof Symbol.iterator,O="function"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===R||"symbol")?Symbol.toStringTag:null,N=Object.prototype.propertyIsEnumerable,P=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function B(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||_.call(/e/,t))return t;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof e){var i=e<0?-D(-e):D(e);if(i!==e){var n=String(i),a=y.call(t,n.length+1);return C.call(n,r,"$&_")+"."+C.call(C.call(a,/([0-9]{3})/g,"$&_"),/_$/,"")}}return C.call(t,r,"$&_")}var L=r(8093),x=L.custom,M=j(x)?x:null;function F(e,t,r){var i="double"===(r.quoteStyle||t)?'"':"'";return i+e+i}function k(e){return C.call(String(e),/"/g,"&quot;")}function V(e){return!("[object Array]"!==Y(e)||O&&"object"==typeof e&&O in e)}function H(e){return!("[object RegExp]"!==Y(e)||O&&"object"==typeof e&&O in e)}function j(e){if(R)return e&&"object"==typeof e&&e instanceof Symbol;if("symbol"==typeof e)return!0;if(!e||"object"!=typeof e||!U)return!1;try{return U.call(e),!0}catch(e){}return!1}e.exports=function e(t,r,i,n){var s=r||{};if(W(s,"quoteStyle")&&"single"!==s.quoteStyle&&"double"!==s.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(W(s,"maxStringLength")&&("number"==typeof s.maxStringLength?s.maxStringLength<0&&s.maxStringLength!==1/0:null!==s.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var c=!W(s,"customInspect")||s.customInspect;if("boolean"!=typeof c&&"symbol"!==c)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(W(s,"indent")&&null!==s.indent&&"\t"!==s.indent&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(W(s,"numericSeparator")&&"boolean"!=typeof s.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var v=s.numericSeparator;if(void 0===t)return"undefined";if(null===t)return"null";if("boolean"==typeof t)return t?"true":"false";if("string"==typeof t)return K(t,s);if("number"==typeof t){if(0===t)return 1/0/t>0?"0":"-0";var S=String(t);return v?B(t,S):S}if("bigint"==typeof t){var _=String(t)+"n";return v?B(t,_):_}var D=void 0===s.depth?5:s.depth;if(void 0===i&&(i=0),i>=D&&D>0&&"object"==typeof t)return V(t)?"[Array]":"[Object]";var b=function(e,t){var r;if("\t"===e.indent)r="\t";else{if(!("number"==typeof e.indent&&e.indent>0))return null;r=A.call(Array(e.indent+1)," ")}return{base:r,prev:A.call(Array(t+1),r)}}(s,i);if(void 0===n)n=[];else if(q(n,t)>=0)return"[Circular]";function x(t,r,a){if(r&&(n=I.call(n)).push(r),a){var o={depth:s.depth};return W(s,"quoteStyle")&&(o.quoteStyle=s.quoteStyle),e(t,o,i+1,n)}return e(t,s,i+1,n)}if("function"==typeof t&&!H(t)){var G=function(e){if(e.name)return e.name;var t=m.call(g.call(e),/^function\s*([\w$]+)/);if(t)return t[1];return null}(t),$=Z(t,x);return"[Function"+(G?": "+G:" (anonymous)")+"]"+($.length>0?" { "+A.call($,", ")+" }":"")}if(j(t)){var ee=R?C.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):U.call(t);return"object"!=typeof t||R?ee:z(ee)}if(function(e){if(!e||"object"!=typeof e)return!1;if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return"string"==typeof e.nodeName&&"function"==typeof e.getAttribute}(t)){for(var te="<"+E.call(String(t.nodeName)),re=t.attributes||[],ie=0;ie<re.length;ie++)te+=" "+re[ie].name+"="+F(k(re[ie].value),"double",s);return te+=">",t.childNodes&&t.childNodes.length&&(te+="..."),te+="</"+E.call(String(t.nodeName))+">"}if(V(t)){if(0===t.length)return"[]";var ne=Z(t,x);return b&&!function(e){for(var t=0;t<e.length;t++)if(q(e[t],"\n")>=0)return!1;return!0}(ne)?"["+J(ne,b)+"]":"[ "+A.call(ne,", ")+" ]"}if(function(e){return!("[object Error]"!==Y(e)||O&&"object"==typeof e&&O in e)}(t)){var ae=Z(t,x);return"cause"in Error.prototype||!("cause"in t)||N.call(t,"cause")?0===ae.length?"["+String(t)+"]":"{ ["+String(t)+"] "+A.call(ae,", ")+" }":"{ ["+String(t)+"] "+A.call(T.call("[cause]: "+x(t.cause),ae),", ")+" }"}if("object"==typeof t&&c){if(M&&"function"==typeof t[M]&&L)return L(t,{depth:D-i});if("symbol"!==c&&"function"==typeof t.inspect)return t.inspect()}if(function(e){if(!a||!e||"object"!=typeof e)return!1;try{a.call(e);try{u.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var oe=[];return o&&o.call(t,(function(e,r){oe.push(x(r,t,!0)+" => "+x(e,t))})),X("Map",a.call(t),oe,b)}if(function(e){if(!u||!e||"object"!=typeof e)return!1;try{u.call(e);try{a.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var se=[];return l&&l.call(t,(function(e){se.push(x(e,t))})),X("Set",u.call(t),se,b)}if(function(e){if(!h||!e||"object"!=typeof e)return!1;try{h.call(e,h);try{d.call(e,d)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return Q("WeakMap");if(function(e){if(!d||!e||"object"!=typeof e)return!1;try{d.call(e,d);try{h.call(e,h)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return Q("WeakSet");if(function(e){if(!p||!e||"object"!=typeof e)return!1;try{return p.call(e),!0}catch(e){}return!1}(t))return Q("WeakRef");if(function(e){return!("[object Number]"!==Y(e)||O&&"object"==typeof e&&O in e)}(t))return z(x(Number(t)));if(function(e){if(!e||"object"!=typeof e||!w)return!1;try{return w.call(e),!0}catch(e){}return!1}(t))return z(x(w.call(t)));if(function(e){return!("[object Boolean]"!==Y(e)||O&&"object"==typeof e&&O in e)}(t))return z(f.call(t));if(function(e){return!("[object String]"!==Y(e)||O&&"object"==typeof e&&O in e)}(t))return z(x(String(t)));if("undefined"!=typeof window&&t===window)return"{ [object Window] }";if(t===global)return"{ [object globalThis] }";if(!function(e){return!("[object Date]"!==Y(e)||O&&"object"==typeof e&&O in e)}(t)&&!H(t)){var ce=Z(t,x),ue=P?P(t)===Object.prototype:t instanceof Object||t.constructor===Object,le=t instanceof Object?"":"null prototype",he=!ue&&O&&Object(t)===t&&O in t?y.call(Y(t),8,-1):le?"Object":"",de=(ue||"function"!=typeof t.constructor?"":t.constructor.name?t.constructor.name+" ":"")+(he||le?"["+A.call(T.call([],he||[],le||[]),": ")+"] ":"");return 0===ce.length?de+"{}":b?de+"{"+J(ce,b)+"}":de+"{ "+A.call(ce,", ")+" }"}return String(t)};var G=Object.prototype.hasOwnProperty||function(e){return e in this};function W(e,t){return G.call(e,t)}function Y(e){return v.call(e)}function q(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1}function K(e,t){if(e.length>t.maxStringLength){var r=e.length-t.maxStringLength,i="... "+r+" more character"+(r>1?"s":"");return K(y.call(e,0,t.maxStringLength),t)+i}return F(C.call(C.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,$),"single",t)}function $(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+S.call(t.toString(16))}function z(e){return"Object("+e+")"}function Q(e){return e+" { ? }"}function X(e,t,r,i){return e+" ("+t+") {"+(i?J(r,i):A.call(r,", "))+"}"}function J(e,t){if(0===e.length)return"";var r="\n"+t.prev+t.base;return r+A.call(e,","+r)+"\n"+t.prev}function Z(e,t){var r=V(e),i=[];if(r){i.length=e.length;for(var n=0;n<e.length;n++)i[n]=W(e,n)?t(e[n],e):""}var a,o="function"==typeof b?b(e):[];if(R){a={};for(var s=0;s<o.length;s++)a["$"+o[s]]=o[s]}for(var c in e)W(e,c)&&(r&&String(Number(c))===c&&c<e.length||R&&a["$"+c]instanceof Symbol||(_.call(/[^\w$]/,c)?i.push(t(c,e)+": "+t(e[c],e)):i.push(c+": "+t(e[c],e))));if("function"==typeof b)for(var u=0;u<o.length;u++)N.call(e,o[u])&&i.push("["+t(o[u])+"]: "+t(e[o[u]],e));return i}},8093:(e,t,r)=>{e.exports=r(9023).inspect},9211:e=>{"use strict";var t=function(e){return e!=e};e.exports=function(e,r){return 0===e&&0===r?1/e==1/r:e===r||!(!t(e)||!t(r))}},7653:(e,t,r)=>{"use strict";var i=r(8452),n=r(487),a=r(9211),o=r(9394),s=r(6576),c=n(o(),Object);i(c,{getPolyfill:o,implementation:a,shim:s}),e.exports=c},9394:(e,t,r)=>{"use strict";var i=r(9211);e.exports=function(){return"function"==typeof Object.is?Object.is:i}},6576:(e,t,r)=>{"use strict";var i=r(9394),n=r(8452);e.exports=function(){var e=i();return n(Object,{is:e},{is:function(){return Object.is!==e}}),e}},8875:(e,t,r)=>{"use strict";var i;if(!Object.keys){var n=Object.prototype.hasOwnProperty,a=Object.prototype.toString,o=r(1093),s=Object.prototype.propertyIsEnumerable,c=!s.call({toString:null},"toString"),u=s.call((function(){}),"prototype"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],h=function(e){var t=e.constructor;return t&&t.prototype===e},d={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},p=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!d["$"+e]&&n.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{h(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();i=function(e){var t=null!==e&&"object"==typeof e,r="[object Function]"===a.call(e),i=o(e),s=t&&"[object String]"===a.call(e),d=[];if(!t&&!r&&!i)throw new TypeError("Object.keys called on a non-object");var f=u&&r;if(s&&e.length>0&&!n.call(e,0))for(var v=0;v<e.length;++v)d.push(String(v));if(i&&e.length>0)for(var g=0;g<e.length;++g)d.push(String(g));else for(var m in e)f&&"prototype"===m||!n.call(e,m)||d.push(String(m));if(c)for(var y=function(e){if("undefined"==typeof window||!p)return h(e);try{return h(e)}catch(e){return!1}}(e),C=0;C<l.length;++C)y&&"constructor"===l[C]||!n.call(e,l[C])||d.push(l[C]);return d}}e.exports=i},1189:(e,t,r)=>{"use strict";var i=Array.prototype.slice,n=r(1093),a=Object.keys,o=a?function(e){return a(e)}:r(8875),s=Object.keys;o.shim=function(){if(Object.keys){var e=function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2);e||(Object.keys=function(e){return n(e)?s(i.call(e)):s(e)})}else Object.keys=o;return Object.keys||o},e.exports=o},1093:e=>{"use strict";var t=Object.prototype.toString;e.exports=function(e){var r=t.call(e),i="[object Arguments]"===r;return i||(i="[object Array]"!==r&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===t.call(e.callee)),i}},8403:(e,t,r)=>{"use strict";var i=r(1189),n=r(1333)(),a=r(8075),o=Object,s=a("Array.prototype.push"),c=a("Object.prototype.propertyIsEnumerable"),u=n?Object.getOwnPropertySymbols:null;e.exports=function(e,t){if(null==e)throw new TypeError("target must be an object");var r=o(e);if(1===arguments.length)return r;for(var a=1;a<arguments.length;++a){var l=o(arguments[a]),h=i(l),d=n&&(Object.getOwnPropertySymbols||u);if(d)for(var p=d(l),f=0;f<p.length;++f){var v=p[f];c(l,v)&&s(h,v)}for(var g=0;g<h.length;++g){var m=h[g];if(c(l,m)){var y=l[m];r[m]=y}}}return r}},6525:(e,t,r)=>{"use strict";var i=r(8452),n=r(487),a=r(8403),o=r(1514),s=r(984),c=n.apply(o()),u=function(e,t){return c(Object,arguments)};i(u,{getPolyfill:o,implementation:a,shim:s}),e.exports=u},1514:(e,t,r)=>{"use strict";var i=r(8403);e.exports=function(){return Object.assign?function(){if(!Object.assign)return!1;for(var e="abcdefghijklmnopqrst",t=e.split(""),r={},i=0;i<t.length;++i)r[t[i]]=t[i];var n=Object.assign({},r),a="";for(var o in n)a+=o;return e!==a}()||function(){if(!Object.assign||!Object.preventExtensions)return!1;var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(t){return"y"===e[1]}return!1}()?i:Object.assign:i}},984:(e,t,r)=>{"use strict";var i=r(8452),n=r(1514);e.exports=function(){var e=n();return i(Object,{assign:e},{assign:function(){return Object.assign!==e}}),e}},6736:(e,t,r)=>{e.exports=r(1094)},6578:e=>{"use strict";e.exports=["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]},3231:e=>{
/*!
 *
 * Copyright 2009-2012 Kris Kowal under the terms of the MIT
 * license found at http://github.com/kriskowal/q/raw/master/LICENSE
 *
 * With parts by Tyler Close
 * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found
 * at http://www.opensource.org/licenses/mit-license.html
 * Forked at ref_send.js version: 2009-05-11
 *
 * With parts by Mark Miller
 * Copyright (C) 2011 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */
!function(t){"use strict";"function"==typeof bootstrap?bootstrap("promise",t):e.exports=t()}((function(){"use strict";var e=!1;try{throw new Error}catch(t){e=!!t.stack}var t,r=E(),i=function(){},n=function(){var e={task:void 0,next:null},t=e,r=!1,i=void 0,a=!1;function o(){for(;e.next;){var t=(e=e.next).task;e.task=void 0;var i=e.domain;i&&(e.domain=void 0,i.enter());try{t()}catch(e){if(a)throw i&&i.exit(),setTimeout(o,0),i&&i.enter(),e;setTimeout((function(){throw e}),0)}i&&i.exit()}r=!1}if(n=function(e){t=t.next={task:e,domain:a&&process.domain,next:null},r||(r=!0,i())},"undefined"!=typeof process&&process.nextTick)a=!0,i=function(){process.nextTick(o)};else if("function"==typeof setImmediate)i="undefined"!=typeof window?setImmediate.bind(window,o):function(){setImmediate(o)};else if("undefined"!=typeof MessageChannel){var s=new MessageChannel;s.port1.onmessage=function(){i=c,s.port1.onmessage=o,o()};var c=function(){s.port2.postMessage(0)};i=function(){setTimeout(o,0),c()}}else i=function(){setTimeout(o,0)};return n}(),a=Function.call;function o(e){return function(){return a.apply(e,arguments)}}var s,c=o(Array.prototype.slice),u=o(Array.prototype.reduce||function(e,t){var r=0,i=this.length;if(1===arguments.length)for(;;){if(r in this){t=this[r++];break}if(++r>=i)throw new TypeError}for(;r<i;r++)r in this&&(t=e(t,this[r],r));return t}),l=o(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),h=o(Array.prototype.map||function(e,t){var r=this,i=[];return u(r,(function(n,a,o){i.push(e.call(t,a,o,r))}),void 0),i}),d=Object.create||function(e){function t(){}return t.prototype=e,new t},p=o(Object.prototype.hasOwnProperty),f=Object.keys||function(e){var t=[];for(var r in e)p(e,r)&&t.push(r);return t},v=o(Object.prototype.toString);s="undefined"!=typeof ReturnValue?ReturnValue:function(e){this.value=e};var g="From previous event:";function m(t,r){if(e&&r.stack&&"object"==typeof t&&null!==t&&t.stack&&-1===t.stack.indexOf(g)){for(var i=[],n=r;n;n=n.source)n.stack&&i.unshift(n.stack);i.unshift(t.stack);var a=i.join("\n"+g+"\n");t.stack=function(e){for(var t=e.split("\n"),r=[],i=0;i<t.length;++i){var n=t[i];S(n)||y(n)||!n||r.push(n)}return r.join("\n")}(a)}}function y(e){return-1!==e.indexOf("(module.js:")||-1!==e.indexOf("(node.js:")}function C(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t)return[t[1],Number(t[2])];var r=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(r)return[r[1],Number(r[2])];var i=/.*@(.+):(\d+)$/.exec(e);return i?[i[1],Number(i[2])]:void 0}function S(e){var i=C(e);if(!i)return!1;var n=i[0],a=i[1];return n===t&&a>=r&&a<=W}function E(){if(e)try{throw new Error}catch(e){var r=e.stack.split("\n"),i=C(r[0].indexOf("@")>0?r[1]:r[2]);if(!i)return;return t=i[0],i[1]}}function _(e){return e instanceof D?e:R(e)?function(e){var t=T();return _.nextTick((function(){try{e.then(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}})),t.promise}(e):k(e)}function T(){var t,r=[],i=[],n=d(T.prototype),a=d(D.prototype);if(a.promiseDispatch=function(e,n,a){var o=c(arguments);r?(r.push(o),"when"===n&&a[1]&&i.push(a[1])):_.nextTick((function(){t.promiseDispatch.apply(t,o)}))},a.valueOf=function(){if(r)return a;var e=b(t);return U(e)&&(t=e),e},a.inspect=function(){return t?t.inspect():{state:"pending"}},_.longStackSupport&&e)try{throw new Error}catch(e){a.stack=e.stack.substring(e.stack.indexOf("\n")+1)}function o(e){t=e,a.source=e,u(r,(function(t,r){_.nextTick((function(){e.promiseDispatch.apply(e,r)}))}),void 0),r=void 0,i=void 0}return n.promise=a,n.resolve=function(e){t||o(_(e))},n.fulfill=function(e){t||o(k(e))},n.reject=function(e){t||o(F(e))},n.notify=function(e){t||u(i,(function(t,r){_.nextTick((function(){r(e)}))}),void 0)},n}function A(e){if("function"!=typeof e)throw new TypeError("resolver must be a function.");var t=T();try{e(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}return t.promise}function I(e){return A((function(t,r){for(var i=0,n=e.length;i<n;i++)_(e[i]).then(t,r)}))}function D(e,t,r){void 0===t&&(t=function(e){return F(new Error("Promise does not support operation: "+e))}),void 0===r&&(r=function(){return{state:"unknown"}});var i=d(D.prototype);if(i.promiseDispatch=function(r,n,a){var o;try{o=e[n]?e[n].apply(i,a):t.call(i,n,a)}catch(e){o=F(e)}r&&r(o)},i.inspect=r,r){var n=r();"rejected"===n.state&&(i.exception=n.reason),i.valueOf=function(){var e=r();return"pending"===e.state||"rejected"===e.state?i:e.value}}return i}function w(e,t,r,i){return _(e).then(t,r,i)}function b(e){if(U(e)){var t=e.inspect();if("fulfilled"===t.state)return t.value}return e}function U(e){return e instanceof D}function R(e){return(t=e)===Object(t)&&"function"==typeof e.then;var t}_.resolve=_,_.nextTick=n,_.longStackSupport=!1,"object"==typeof process&&process&&process.env&&process.env.Q_DEBUG&&(_.longStackSupport=!0),_.defer=T,T.prototype.makeNodeResolver=function(){var e=this;return function(t,r){t?e.reject(t):arguments.length>2?e.resolve(c(arguments,1)):e.resolve(r)}},_.Promise=A,_.promise=A,A.race=I,A.all=j,A.reject=F,A.resolve=_,_.passByCopy=function(e){return e},D.prototype.passByCopy=function(){return this},_.join=function(e,t){return _(e).join(t)},D.prototype.join=function(e){return _([this,e]).spread((function(e,t){if(e===t)return e;throw new Error("Can't join: not the same: "+e+" "+t)}))},_.race=I,D.prototype.race=function(){return this.then(_.race)},_.makePromise=D,D.prototype.toString=function(){return"[object Promise]"},D.prototype.then=function(e,t,r){var i=this,n=T(),a=!1;return _.nextTick((function(){i.promiseDispatch((function(t){a||(a=!0,n.resolve(function(t){try{return"function"==typeof e?e(t):t}catch(e){return F(e)}}(t)))}),"when",[function(e){a||(a=!0,n.resolve(function(e){if("function"==typeof t){m(e,i);try{return t(e)}catch(e){return F(e)}}return F(e)}(e)))}])})),i.promiseDispatch(void 0,"when",[void 0,function(e){var t,i=!1;try{t=function(e){return"function"==typeof r?r(e):e}(e)}catch(e){if(i=!0,!_.onerror)throw e;_.onerror(e)}i||n.notify(t)}]),n.promise},_.tap=function(e,t){return _(e).tap(t)},D.prototype.tap=function(e){return e=_(e),this.then((function(t){return e.fcall(t).thenResolve(t)}))},_.when=w,D.prototype.thenResolve=function(e){return this.then((function(){return e}))},_.thenResolve=function(e,t){return _(e).thenResolve(t)},D.prototype.thenReject=function(e){return this.then((function(){throw e}))},_.thenReject=function(e,t){return _(e).thenReject(t)},_.nearer=b,_.isPromise=U,_.isPromiseAlike=R,_.isPending=function(e){return U(e)&&"pending"===e.inspect().state},D.prototype.isPending=function(){return"pending"===this.inspect().state},_.isFulfilled=function(e){return!U(e)||"fulfilled"===e.inspect().state},D.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},_.isRejected=function(e){return U(e)&&"rejected"===e.inspect().state},D.prototype.isRejected=function(){return"rejected"===this.inspect().state};var O,N,P,B=[],L=[],x=!0;function M(){B.length=0,L.length=0,x||(x=!0)}function F(e){var t=D({when:function(t){return t&&function(e){if(x){var t=l(L,e);-1!==t&&(L.splice(t,1),B.splice(t,1))}}(this),t?t(e):this}},(function(){return this}),(function(){return{state:"rejected",reason:e}}));return function(e,t){x&&(L.push(e),t&&void 0!==t.stack?B.push(t.stack):B.push("(no stack) "+t))}(t,e),t}function k(e){return D({when:function(){return e},get:function(t){return e[t]},set:function(t,r){e[t]=r},delete:function(t){delete e[t]},post:function(t,r){return null==t?e.apply(void 0,r):e[t].apply(e,r)},apply:function(t,r){return e.apply(t,r)},keys:function(){return f(e)}},void 0,(function(){return{state:"fulfilled",value:e}}))}function V(e,t,r){return _(e).spread(t,r)}function H(e,t,r){return _(e).dispatch(t,r)}function j(e){return w(e,(function(e){var t=0,r=T();return u(e,(function(i,n,a){var o;U(n)&&"fulfilled"===(o=n.inspect()).state?e[a]=o.value:(++t,w(n,(function(i){e[a]=i,0==--t&&r.resolve(e)}),r.reject,(function(e){r.notify({index:a,value:e})})))}),void 0),0===t&&r.resolve(e),r.promise}))}function G(e){return w(e,(function(e){return e=h(e,_),w(j(h(e,(function(e){return w(e,i,i)}))),(function(){return e}))}))}_.resetUnhandledRejections=M,_.getUnhandledReasons=function(){return B.slice()},_.stopUnhandledRejectionTracking=function(){M(),x=!1},M(),_.reject=F,_.fulfill=k,_.master=function(e){return D({isDef:function(){}},(function(t,r){return H(e,t,r)}),(function(){return _(e).inspect()}))},_.spread=V,D.prototype.spread=function(e,t){return this.all().then((function(t){return e.apply(void 0,t)}),t)},_.async=function(e){return function(){function t(e,t){var a;if("undefined"==typeof StopIteration){try{a=r[e](t)}catch(e){return F(e)}return a.done?_(a.value):w(a.value,i,n)}try{a=r[e](t)}catch(e){return function(e){return"[object StopIteration]"===v(e)||e instanceof s}(e)?_(e.value):F(e)}return w(a,i,n)}var r=e.apply(this,arguments),i=t.bind(t,"next"),n=t.bind(t,"throw");return i()}},_.spawn=function(e){_.done(_.async(e)())},_.return=function(e){throw new s(e)},_.promised=function(e){return function(){return V([this,j(arguments)],(function(t,r){return e.apply(t,r)}))}},_.dispatch=H,D.prototype.dispatch=function(e,t){var r=this,i=T();return _.nextTick((function(){r.promiseDispatch(i.resolve,e,t)})),i.promise},_.get=function(e,t){return _(e).dispatch("get",[t])},D.prototype.get=function(e){return this.dispatch("get",[e])},_.set=function(e,t,r){return _(e).dispatch("set",[t,r])},D.prototype.set=function(e,t){return this.dispatch("set",[e,t])},_.del=_.delete=function(e,t){return _(e).dispatch("delete",[t])},D.prototype.del=D.prototype.delete=function(e){return this.dispatch("delete",[e])},_.mapply=_.post=function(e,t,r){return _(e).dispatch("post",[t,r])},D.prototype.mapply=D.prototype.post=function(e,t){return this.dispatch("post",[e,t])},_.send=_.mcall=_.invoke=function(e,t){return _(e).dispatch("post",[t,c(arguments,2)])},D.prototype.send=D.prototype.mcall=D.prototype.invoke=function(e){return this.dispatch("post",[e,c(arguments,1)])},_.fapply=function(e,t){return _(e).dispatch("apply",[void 0,t])},D.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])},_.try=_.fcall=function(e){return _(e).dispatch("apply",[void 0,c(arguments,1)])},D.prototype.fcall=function(){return this.dispatch("apply",[void 0,c(arguments)])},_.fbind=function(e){var t=_(e),r=c(arguments,1);return function(){return t.dispatch("apply",[this,r.concat(c(arguments))])}},D.prototype.fbind=function(){var e=this,t=c(arguments);return function(){return e.dispatch("apply",[this,t.concat(c(arguments))])}},_.keys=function(e){return _(e).dispatch("keys",[])},D.prototype.keys=function(){return this.dispatch("keys",[])},_.all=j,D.prototype.all=function(){return j(this)},_.allResolved=(O=G,N="allResolved",P="allSettled",function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(N+" is deprecated, use "+P+" instead.",new Error("").stack),O.apply(O,arguments)}),D.prototype.allResolved=function(){return G(this)},_.allSettled=function(e){return _(e).allSettled()},D.prototype.allSettled=function(){return this.then((function(e){return j(h(e,(function(e){function t(){return e.inspect()}return(e=_(e)).then(t,t)})))}))},_.fail=_.catch=function(e,t){return _(e).then(void 0,t)},D.prototype.fail=D.prototype.catch=function(e){return this.then(void 0,e)},_.progress=function(e,t){return _(e).then(void 0,void 0,t)},D.prototype.progress=function(e){return this.then(void 0,void 0,e)},_.fin=_.finally=function(e,t){return _(e).finally(t)},D.prototype.fin=D.prototype.finally=function(e){return e=_(e),this.then((function(t){return e.fcall().then((function(){return t}))}),(function(t){return e.fcall().then((function(){throw t}))}))},_.done=function(e,t,r,i){return _(e).done(t,r,i)},D.prototype.done=function(e,t,r){var i=function(e){_.nextTick((function(){if(m(e,n),!_.onerror)throw e;_.onerror(e)}))},n=e||t||r?this.then(e,t,r):this;"object"==typeof process&&process&&process.domain&&(i=process.domain.bind(i)),n.then(void 0,i)},_.timeout=function(e,t,r){return _(e).timeout(t,r)},D.prototype.timeout=function(e,t){var r=T(),i=setTimeout((function(){t&&"string"!=typeof t||((t=new Error(t||"Timed out after "+e+" ms")).code="ETIMEDOUT"),r.reject(t)}),e);return this.then((function(e){clearTimeout(i),r.resolve(e)}),(function(e){clearTimeout(i),r.reject(e)}),r.notify),r.promise},_.delay=function(e,t){return void 0===t&&(t=e,e=void 0),_(e).delay(t)},D.prototype.delay=function(e){return this.then((function(t){var r=T();return setTimeout((function(){r.resolve(t)}),e),r.promise}))},_.nfapply=function(e,t){return _(e).nfapply(t)},D.prototype.nfapply=function(e){var t=T(),r=c(e);return r.push(t.makeNodeResolver()),this.fapply(r).fail(t.reject),t.promise},_.nfcall=function(e){var t=c(arguments,1);return _(e).nfapply(t)},D.prototype.nfcall=function(){var e=c(arguments),t=T();return e.push(t.makeNodeResolver()),this.fapply(e).fail(t.reject),t.promise},_.nfbind=_.denodeify=function(e){var t=c(arguments,1);return function(){var r=t.concat(c(arguments)),i=T();return r.push(i.makeNodeResolver()),_(e).fapply(r).fail(i.reject),i.promise}},D.prototype.nfbind=D.prototype.denodeify=function(){var e=c(arguments);return e.unshift(this),_.denodeify.apply(void 0,e)},_.nbind=function(e,t){var r=c(arguments,2);return function(){var i=r.concat(c(arguments)),n=T();return i.push(n.makeNodeResolver()),_((function(){return e.apply(t,arguments)})).fapply(i).fail(n.reject),n.promise}},D.prototype.nbind=function(){var e=c(arguments,0);return e.unshift(this),_.nbind.apply(void 0,e)},_.nmapply=_.npost=function(e,t,r){return _(e).npost(t,r)},D.prototype.nmapply=D.prototype.npost=function(e,t){var r=c(t||[]),i=T();return r.push(i.makeNodeResolver()),this.dispatch("post",[e,r]).fail(i.reject),i.promise},_.nsend=_.nmcall=_.ninvoke=function(e,t){var r=c(arguments,2),i=T();return r.push(i.makeNodeResolver()),_(e).dispatch("post",[t,r]).fail(i.reject),i.promise},D.prototype.nsend=D.prototype.nmcall=D.prototype.ninvoke=function(e){var t=c(arguments,1),r=T();return t.push(r.makeNodeResolver()),this.dispatch("post",[e,t]).fail(r.reject),r.promise},_.nodeify=function(e,t){return _(e).nodeify(t)},D.prototype.nodeify=function(e){if(!e)return this;this.then((function(t){_.nextTick((function(){e(null,t)}))}),(function(t){_.nextTick((function(){e(t)}))}))};var W=E();return _}))},7675:(e,t,r)=>{"use strict";var i=r(3206),n=r(9675),a=Object;e.exports=i((function(){if(null==this||this!==a(this))throw new n("RegExp.prototype.flags getter called on non-object");var e="";return this.hasIndices&&(e+="d"),this.global&&(e+="g"),this.ignoreCase&&(e+="i"),this.multiline&&(e+="m"),this.dotAll&&(e+="s"),this.unicode&&(e+="u"),this.unicodeSets&&(e+="v"),this.sticky&&(e+="y"),e}),"get flags",!0)},1589:(e,t,r)=>{"use strict";var i=r(8452),n=r(487),a=r(7675),o=r(5330),s=r(3984),c=n(o());i(c,{getPolyfill:o,implementation:a,shim:s}),e.exports=c},5330:(e,t,r)=>{"use strict";var i=r(7675),n=r(8452).supportsDescriptors,a=Object.getOwnPropertyDescriptor;e.exports=function(){if(n&&"gim"===/a/gim.flags){var e=a(RegExp.prototype,"flags");if(e&&"function"==typeof e.get&&"boolean"==typeof RegExp.prototype.dotAll&&"boolean"==typeof RegExp.prototype.hasIndices){var t="",r={};if(Object.defineProperty(r,"hasIndices",{get:function(){t+="d"}}),Object.defineProperty(r,"sticky",{get:function(){t+="y"}}),"dy"===t)return e.get}}return i}},3984:(e,t,r)=>{"use strict";var i=r(8452).supportsDescriptors,n=r(5330),a=Object.getOwnPropertyDescriptor,o=Object.defineProperty,s=TypeError,c=Object.getPrototypeOf,u=/a/;e.exports=function(){if(!i||!c)throw new s("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var e=n(),t=c(u),r=a(t,"flags");return r&&r.get===e||o(t,"flags",{configurable:!0,enumerable:!1,get:e}),e}},2861:(e,t,r)=>{
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
var i=r(181),n=i.Buffer;function a(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return n(e,t,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=i:(a(i,t),t.Buffer=o),o.prototype=Object.create(n.prototype),a(n,o),o.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return n(e,t,r)},o.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=n(e);return void 0!==t?"string"==typeof r?i.fill(t,r):i.fill(t):i.fill(0),i},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i.SlowBuffer(e)}},4043:(e,t,r)=>{!function(e){e.parser=function(e,t){return new n(e,t)},e.SAXParser=n,e.SAXStream=o,e.createStream=function(e,t){return new o(e,t)},e.MAX_BUFFER_LENGTH=65536;var t,i=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function n(t,r){if(!(this instanceof n))return new n(t,r);var a=this;!function(e){for(var t=0,r=i.length;t<r;t++)e[i[t]]=""}(a),a.q=a.c="",a.bufferCheckPosition=e.MAX_BUFFER_LENGTH,a.opt=r||{},a.opt.lowercase=a.opt.lowercase||a.opt.lowercasetags,a.looseCase=a.opt.lowercase?"toLowerCase":"toUpperCase",a.tags=[],a.closed=a.closedRoot=a.sawRoot=!1,a.tag=a.error=null,a.strict=!!t,a.noscript=!(!t&&!a.opt.noscript),a.state=A.BEGIN,a.strictEntities=a.opt.strictEntities,a.ENTITIES=a.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),a.attribList=[],a.opt.xmlns&&(a.ns=Object.create(h)),a.trackPosition=!1!==a.opt.position,a.trackPosition&&(a.position=a.line=a.column=0),D(a,"onready")}e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t}),n.prototype={end:function(){O(this)},write:function(t){var r=this;if(this.error)throw this.error;if(r.closed)return R(r,"Cannot write after close. Assign an onready handler.");if(null===t)return O(r);"object"==typeof t&&(t=t.toString());var n=0,a="";for(;a=V(t,n++),r.c=a,a;)switch(r.trackPosition&&(r.position++,"\n"===a?(r.line++,r.column=0):r.column++),r.state){case A.BEGIN:if(r.state=A.BEGIN_WHITESPACE,"\ufeff"===a)continue;k(r,a);continue;case A.BEGIN_WHITESPACE:k(r,a);continue;case A.TEXT:if(r.sawRoot&&!r.closedRoot){for(var o=n-1;a&&"<"!==a&&"&"!==a;)(a=V(t,n++))&&r.trackPosition&&(r.position++,"\n"===a?(r.line++,r.column=0):r.column++);r.textNode+=t.substring(o,n-1)}"<"!==a||r.sawRoot&&r.closedRoot&&!r.strict?(g(a)||r.sawRoot&&!r.closedRoot||N(r,"Text data outside of root node."),"&"===a?r.state=A.TEXT_ENTITY:r.textNode+=a):(r.state=A.OPEN_WAKA,r.startTagPosition=r.position);continue;case A.SCRIPT:"<"===a?r.state=A.SCRIPT_ENDING:r.script+=a;continue;case A.SCRIPT_ENDING:"/"===a?r.state=A.CLOSE_TAG:(r.script+="<"+a,r.state=A.SCRIPT);continue;case A.OPEN_WAKA:if("!"===a)r.state=A.SGML_DECL,r.sgmlDecl="";else if(g(a));else if(C(d,a))r.state=A.OPEN_TAG,r.tagName=a;else if("/"===a)r.state=A.CLOSE_TAG,r.tagName="";else if("?"===a)r.state=A.PROC_INST,r.procInstName=r.procInstBody="";else{if(N(r,"Unencoded <"),r.startTagPosition+1<r.position){var u=r.position-r.startTagPosition;a=new Array(u).join(" ")+a}r.textNode+="<"+a,r.state=A.TEXT}continue;case A.SGML_DECL:(r.sgmlDecl+a).toUpperCase()===s?(w(r,"onopencdata"),r.state=A.CDATA,r.sgmlDecl="",r.cdata=""):r.sgmlDecl+a==="--"?(r.state=A.COMMENT,r.comment="",r.sgmlDecl=""):(r.sgmlDecl+a).toUpperCase()===c?(r.state=A.DOCTYPE,(r.doctype||r.sawRoot)&&N(r,"Inappropriately located doctype declaration"),r.doctype="",r.sgmlDecl=""):">"===a?(w(r,"onsgmldeclaration",r.sgmlDecl),r.sgmlDecl="",r.state=A.TEXT):m(a)?(r.state=A.SGML_DECL_QUOTED,r.sgmlDecl+=a):r.sgmlDecl+=a;continue;case A.SGML_DECL_QUOTED:a===r.q&&(r.state=A.SGML_DECL,r.q=""),r.sgmlDecl+=a;continue;case A.DOCTYPE:">"===a?(r.state=A.TEXT,w(r,"ondoctype",r.doctype),r.doctype=!0):(r.doctype+=a,"["===a?r.state=A.DOCTYPE_DTD:m(a)&&(r.state=A.DOCTYPE_QUOTED,r.q=a));continue;case A.DOCTYPE_QUOTED:r.doctype+=a,a===r.q&&(r.q="",r.state=A.DOCTYPE);continue;case A.DOCTYPE_DTD:r.doctype+=a,"]"===a?r.state=A.DOCTYPE:m(a)&&(r.state=A.DOCTYPE_DTD_QUOTED,r.q=a);continue;case A.DOCTYPE_DTD_QUOTED:r.doctype+=a,a===r.q&&(r.state=A.DOCTYPE_DTD,r.q="");continue;case A.COMMENT:"-"===a?r.state=A.COMMENT_ENDING:r.comment+=a;continue;case A.COMMENT_ENDING:"-"===a?(r.state=A.COMMENT_ENDED,r.comment=U(r.opt,r.comment),r.comment&&w(r,"oncomment",r.comment),r.comment=""):(r.comment+="-"+a,r.state=A.COMMENT);continue;case A.COMMENT_ENDED:">"!==a?(N(r,"Malformed comment"),r.comment+="--"+a,r.state=A.COMMENT):r.state=A.TEXT;continue;case A.CDATA:"]"===a?r.state=A.CDATA_ENDING:r.cdata+=a;continue;case A.CDATA_ENDING:"]"===a?r.state=A.CDATA_ENDING_2:(r.cdata+="]"+a,r.state=A.CDATA);continue;case A.CDATA_ENDING_2:">"===a?(r.cdata&&w(r,"oncdata",r.cdata),w(r,"onclosecdata"),r.cdata="",r.state=A.TEXT):"]"===a?r.cdata+="]":(r.cdata+="]]"+a,r.state=A.CDATA);continue;case A.PROC_INST:"?"===a?r.state=A.PROC_INST_ENDING:g(a)?r.state=A.PROC_INST_BODY:r.procInstName+=a;continue;case A.PROC_INST_BODY:if(!r.procInstBody&&g(a))continue;"?"===a?r.state=A.PROC_INST_ENDING:r.procInstBody+=a;continue;case A.PROC_INST_ENDING:">"===a?(w(r,"onprocessinginstruction",{name:r.procInstName,body:r.procInstBody}),r.procInstName=r.procInstBody="",r.state=A.TEXT):(r.procInstBody+="?"+a,r.state=A.PROC_INST_BODY);continue;case A.OPEN_TAG:C(p,a)?r.tagName+=a:(P(r),">"===a?x(r):"/"===a?r.state=A.OPEN_TAG_SLASH:(g(a)||N(r,"Invalid character in tag name"),r.state=A.ATTRIB));continue;case A.OPEN_TAG_SLASH:">"===a?(x(r,!0),M(r)):(N(r,"Forward-slash in opening tag not followed by >"),r.state=A.ATTRIB);continue;case A.ATTRIB:if(g(a))continue;">"===a?x(r):"/"===a?r.state=A.OPEN_TAG_SLASH:C(d,a)?(r.attribName=a,r.attribValue="",r.state=A.ATTRIB_NAME):N(r,"Invalid attribute name");continue;case A.ATTRIB_NAME:"="===a?r.state=A.ATTRIB_VALUE:">"===a?(N(r,"Attribute without value"),r.attribValue=r.attribName,L(r),x(r)):g(a)?r.state=A.ATTRIB_NAME_SAW_WHITE:C(p,a)?r.attribName+=a:N(r,"Invalid attribute name");continue;case A.ATTRIB_NAME_SAW_WHITE:if("="===a)r.state=A.ATTRIB_VALUE;else{if(g(a))continue;N(r,"Attribute without value"),r.tag.attributes[r.attribName]="",r.attribValue="",w(r,"onattribute",{name:r.attribName,value:""}),r.attribName="",">"===a?x(r):C(d,a)?(r.attribName=a,r.state=A.ATTRIB_NAME):(N(r,"Invalid attribute name"),r.state=A.ATTRIB)}continue;case A.ATTRIB_VALUE:if(g(a))continue;m(a)?(r.q=a,r.state=A.ATTRIB_VALUE_QUOTED):(N(r,"Unquoted attribute value"),r.state=A.ATTRIB_VALUE_UNQUOTED,r.attribValue=a);continue;case A.ATTRIB_VALUE_QUOTED:if(a!==r.q){"&"===a?r.state=A.ATTRIB_VALUE_ENTITY_Q:r.attribValue+=a;continue}L(r),r.q="",r.state=A.ATTRIB_VALUE_CLOSED;continue;case A.ATTRIB_VALUE_CLOSED:g(a)?r.state=A.ATTRIB:">"===a?x(r):"/"===a?r.state=A.OPEN_TAG_SLASH:C(d,a)?(N(r,"No whitespace between attributes"),r.attribName=a,r.attribValue="",r.state=A.ATTRIB_NAME):N(r,"Invalid attribute name");continue;case A.ATTRIB_VALUE_UNQUOTED:if(!y(a)){"&"===a?r.state=A.ATTRIB_VALUE_ENTITY_U:r.attribValue+=a;continue}L(r),">"===a?x(r):r.state=A.ATTRIB;continue;case A.CLOSE_TAG:if(r.tagName)">"===a?M(r):C(p,a)?r.tagName+=a:r.script?(r.script+="</"+r.tagName,r.tagName="",r.state=A.SCRIPT):(g(a)||N(r,"Invalid tagname in closing tag"),r.state=A.CLOSE_TAG_SAW_WHITE);else{if(g(a))continue;S(d,a)?r.script?(r.script+="</"+a,r.state=A.SCRIPT):N(r,"Invalid tagname in closing tag."):r.tagName=a}continue;case A.CLOSE_TAG_SAW_WHITE:if(g(a))continue;">"===a?M(r):N(r,"Invalid characters in closing tag");continue;case A.TEXT_ENTITY:case A.ATTRIB_VALUE_ENTITY_Q:case A.ATTRIB_VALUE_ENTITY_U:var l,h;switch(r.state){case A.TEXT_ENTITY:l=A.TEXT,h="textNode";break;case A.ATTRIB_VALUE_ENTITY_Q:l=A.ATTRIB_VALUE_QUOTED,h="attribValue";break;case A.ATTRIB_VALUE_ENTITY_U:l=A.ATTRIB_VALUE_UNQUOTED,h="attribValue"}if(";"===a)if(r.opt.unparsedEntities){var E=F(r);r.entity="",r.state=l,r.write(E)}else r[h]+=F(r),r.entity="",r.state=l;else C(r.entity.length?v:f,a)?r.entity+=a:(N(r,"Invalid character in entity name"),r[h]+="&"+r.entity+a,r.entity="",r.state=l);continue;default:throw new Error(r,"Unknown state: "+r.state)}r.position>=r.bufferCheckPosition&&function(t){for(var r=Math.max(e.MAX_BUFFER_LENGTH,10),n=0,a=0,o=i.length;a<o;a++){var s=t[i[a]].length;if(s>r)switch(i[a]){case"textNode":b(t);break;case"cdata":w(t,"oncdata",t.cdata),t.cdata="";break;case"script":w(t,"onscript",t.script),t.script="";break;default:R(t,"Max buffer length exceeded: "+i[a])}n=Math.max(n,s)}var c=e.MAX_BUFFER_LENGTH-n;t.bufferCheckPosition=c+t.position}(r);return r}
/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var e;b(e=this),""!==e.cdata&&(w(e,"oncdata",e.cdata),e.cdata=""),""!==e.script&&(w(e,"onscript",e.script),e.script="")}};try{t=r(2203).Stream}catch(e){t=function(){}}t||(t=function(){});var a=e.EVENTS.filter((function(e){return"error"!==e&&"end"!==e}));function o(e,r){if(!(this instanceof o))return new o(e,r);t.apply(this),this._parser=new n(e,r),this.writable=!0,this.readable=!0;var i=this;this._parser.onend=function(){i.emit("end")},this._parser.onerror=function(e){i.emit("error",e),i._parser.error=null},this._decoder=null,a.forEach((function(e){Object.defineProperty(i,"on"+e,{get:function(){return i._parser["on"+e]},set:function(t){if(!t)return i.removeAllListeners(e),i._parser["on"+e]=t,t;i.on(e,t)},enumerable:!0,configurable:!1})}))}o.prototype=Object.create(t.prototype,{constructor:{value:o}}),o.prototype.write=function(e){if("function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(e)){if(!this._decoder){var t=r(3193).StringDecoder;this._decoder=new t("utf8")}e=this._decoder.write(e)}return this._parser.write(e.toString()),this.emit("data",e),!0},o.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},o.prototype.on=function(e,r){var i=this;return i._parser["on"+e]||-1===a.indexOf(e)||(i._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),i.emit.apply(i,t)}),t.prototype.on.call(i,e,r)};var s="[CDATA[",c="DOCTYPE",u="http://www.w3.org/XML/1998/namespace",l="http://www.w3.org/2000/xmlns/",h={xml:u,xmlns:l},d=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,p=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,f=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,v=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function g(e){return" "===e||"\n"===e||"\r"===e||"\t"===e}function m(e){return'"'===e||"'"===e}function y(e){return">"===e||g(e)}function C(e,t){return e.test(t)}function S(e,t){return!C(e,t)}var E,_,T,A=0;for(var I in e.STATE={BEGIN:A++,BEGIN_WHITESPACE:A++,TEXT:A++,TEXT_ENTITY:A++,OPEN_WAKA:A++,SGML_DECL:A++,SGML_DECL_QUOTED:A++,DOCTYPE:A++,DOCTYPE_QUOTED:A++,DOCTYPE_DTD:A++,DOCTYPE_DTD_QUOTED:A++,COMMENT_STARTING:A++,COMMENT:A++,COMMENT_ENDING:A++,COMMENT_ENDED:A++,CDATA:A++,CDATA_ENDING:A++,CDATA_ENDING_2:A++,PROC_INST:A++,PROC_INST_BODY:A++,PROC_INST_ENDING:A++,OPEN_TAG:A++,OPEN_TAG_SLASH:A++,ATTRIB:A++,ATTRIB_NAME:A++,ATTRIB_NAME_SAW_WHITE:A++,ATTRIB_VALUE:A++,ATTRIB_VALUE_QUOTED:A++,ATTRIB_VALUE_CLOSED:A++,ATTRIB_VALUE_UNQUOTED:A++,ATTRIB_VALUE_ENTITY_Q:A++,ATTRIB_VALUE_ENTITY_U:A++,CLOSE_TAG:A++,CLOSE_TAG_SAW_WHITE:A++,SCRIPT:A++,SCRIPT_ENDING:A++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach((function(t){var r=e.ENTITIES[t],i="number"==typeof r?String.fromCharCode(r):r;e.ENTITIES[t]=i})),e.STATE)e.STATE[e.STATE[I]]=I;function D(e,t,r){e[t]&&e[t](r)}function w(e,t,r){e.textNode&&b(e),D(e,t,r)}function b(e){e.textNode=U(e.opt,e.textNode),e.textNode&&D(e,"ontext",e.textNode),e.textNode=""}function U(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function R(e,t){return b(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=new Error(t),e.error=t,D(e,"onerror",t),e}function O(e){return e.sawRoot&&!e.closedRoot&&N(e,"Unclosed root tag"),e.state!==A.BEGIN&&e.state!==A.BEGIN_WHITESPACE&&e.state!==A.TEXT&&R(e,"Unexpected end"),b(e),e.c="",e.closed=!0,D(e,"onend"),n.call(e,e.strict,e.opt),e}function N(e,t){if("object"!=typeof e||!(e instanceof n))throw new Error("bad call to strictFail");e.strict&&R(e,t)}function P(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,r=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(r.ns=t.ns),e.attribList.length=0,w(e,"onopentagstart",r)}function B(e,t){var r=e.indexOf(":")<0?["",e]:e.split(":"),i=r[0],n=r[1];return t&&"xmlns"===e&&(i="xmlns",n=""),{prefix:i,local:n}}function L(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName))e.attribName=e.attribValue="";else{if(e.opt.xmlns){var t=B(e.attribName,!0),r=t.prefix,i=t.local;if("xmlns"===r)if("xml"===i&&e.attribValue!==u)N(e,"xml: prefix must be bound to "+u+"\nActual: "+e.attribValue);else if("xmlns"===i&&e.attribValue!==l)N(e,"xmlns: prefix must be bound to "+l+"\nActual: "+e.attribValue);else{var n=e.tag,a=e.tags[e.tags.length-1]||e;n.ns===a.ns&&(n.ns=Object.create(a.ns)),n.ns[i]=e.attribValue}e.attribList.push([e.attribName,e.attribValue])}else e.tag.attributes[e.attribName]=e.attribValue,w(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue=""}}function x(e,t){if(e.opt.xmlns){var r=e.tag,i=B(e.tagName);r.prefix=i.prefix,r.local=i.local,r.uri=r.ns[i.prefix]||"",r.prefix&&!r.uri&&(N(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),r.uri=i.prefix);var n=e.tags[e.tags.length-1]||e;r.ns&&n.ns!==r.ns&&Object.keys(r.ns).forEach((function(t){w(e,"onopennamespace",{prefix:t,uri:r.ns[t]})}));for(var a=0,o=e.attribList.length;a<o;a++){var s=e.attribList[a],c=s[0],u=s[1],l=B(c,!0),h=l.prefix,d=l.local,p=""===h?"":r.ns[h]||"",f={name:c,value:u,prefix:h,local:d,uri:p};h&&"xmlns"!==h&&!p&&(N(e,"Unbound namespace prefix: "+JSON.stringify(h)),f.uri=h),e.tag.attributes[c]=f,w(e,"onattribute",f)}e.attribList.length=0}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),w(e,"onopentag",e.tag),t||(e.noscript||"script"!==e.tagName.toLowerCase()?e.state=A.TEXT:e.state=A.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0}function M(e){if(!e.tagName)return N(e,"Weird empty close tag."),e.textNode+="</>",void(e.state=A.TEXT);if(e.script){if("script"!==e.tagName)return e.script+="</"+e.tagName+">",e.tagName="",void(e.state=A.SCRIPT);w(e,"onscript",e.script),e.script=""}var t=e.tags.length,r=e.tagName;e.strict||(r=r[e.looseCase]());for(var i=r;t--;){if(e.tags[t].name===i)break;N(e,"Unexpected close tag")}if(t<0)return N(e,"Unmatched closing tag: "+e.tagName),e.textNode+="</"+e.tagName+">",void(e.state=A.TEXT);e.tagName=r;for(var n=e.tags.length;n-- >t;){var a=e.tag=e.tags.pop();e.tagName=e.tag.name,w(e,"onclosetag",e.tagName);var o={};for(var s in a.ns)o[s]=a.ns[s];var c=e.tags[e.tags.length-1]||e;e.opt.xmlns&&a.ns!==c.ns&&Object.keys(a.ns).forEach((function(t){var r=a.ns[t];w(e,"onclosenamespace",{prefix:t,uri:r})}))}0===t&&(e.closedRoot=!0),e.tagName=e.attribValue=e.attribName="",e.attribList.length=0,e.state=A.TEXT}function F(e){var t,r=e.entity,i=r.toLowerCase(),n="";return e.ENTITIES[r]?e.ENTITIES[r]:e.ENTITIES[i]?e.ENTITIES[i]:("#"===(r=i).charAt(0)&&("x"===r.charAt(1)?(r=r.slice(2),n=(t=parseInt(r,16)).toString(16)):(r=r.slice(1),n=(t=parseInt(r,10)).toString(10))),r=r.replace(/^0+/,""),isNaN(t)||n.toLowerCase()!==r?(N(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t))}function k(e,t){"<"===t?(e.state=A.OPEN_WAKA,e.startTagPosition=e.position):g(t)||(N(e,"Non-whitespace before first tag."),e.textNode=t,e.state=A.TEXT)}function V(e,t){var r="";return t<e.length&&(r=e.charAt(t)),r}A=e.STATE,String.fromCodePoint||(E=String.fromCharCode,_=Math.floor,T=function(){var e,t,r=[],i=-1,n=arguments.length;if(!n)return"";for(var a="";++i<n;){var o=Number(arguments[i]);if(!isFinite(o)||o<0||o>1114111||_(o)!==o)throw RangeError("Invalid code point: "+o);o<=65535?r.push(o):(e=55296+((o-=65536)>>10),t=o%1024+56320,r.push(e,t)),(i+1===n||r.length>16384)&&(a+=E.apply(null,r),r.length=0)}return a},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:T,configurable:!0,writable:!0}):String.fromCodePoint=T)}(t)},6897:(e,t,r)=>{"use strict";var i=r(453),n=r(41),a=r(592)(),o=r(5795),s=r(9675),c=i("%Math.floor%");e.exports=function(e,t){if("function"!=typeof e)throw new s("`fn` is not a function");if("number"!=typeof t||t<0||t>4294967295||c(t)!==t)throw new s("`length` must be a positive 32-bit integer");var r=arguments.length>2&&!!arguments[2],i=!0,u=!0;if("length"in e&&o){var l=o(e,"length");l&&!l.configurable&&(i=!1),l&&!l.writable&&(u=!1)}return(i||u||!r)&&(a?n(e,"length",t,!0,!0):n(e,"length",t)),e}},3206:(e,t,r)=>{"use strict";var i=r(41),n=r(592)(),a=r(4462).functionsHaveConfigurableNames(),o=r(9675);e.exports=function(e,t){if("function"!=typeof e)throw new o("`fn` is not a function");return arguments.length>2&&!!arguments[2]&&!a||(n?i(e,"name",t,!0,!0):i(e,"name",t)),e}},920:(e,t,r)=>{"use strict";var i=r(453),n=r(8075),a=r(8859),o=r(9675),s=i("%WeakMap%",!0),c=i("%Map%",!0),u=n("WeakMap.prototype.get",!0),l=n("WeakMap.prototype.set",!0),h=n("WeakMap.prototype.has",!0),d=n("Map.prototype.get",!0),p=n("Map.prototype.set",!0),f=n("Map.prototype.has",!0),v=function(e,t){for(var r,i=e;null!==(r=i.next);i=r)if(r.key===t)return i.next=r.next,r.next=e.next,e.next=r,r};e.exports=function(){var e,t,r,i={assert:function(e){if(!i.has(e))throw new o("Side channel does not contain "+a(e))},get:function(i){if(s&&i&&("object"==typeof i||"function"==typeof i)){if(e)return u(e,i)}else if(c){if(t)return d(t,i)}else if(r)return function(e,t){var r=v(e,t);return r&&r.value}(r,i)},has:function(i){if(s&&i&&("object"==typeof i||"function"==typeof i)){if(e)return h(e,i)}else if(c){if(t)return f(t,i)}else if(r)return function(e,t){return!!v(e,t)}(r,i);return!1},set:function(i,n){s&&i&&("object"==typeof i||"function"==typeof i)?(e||(e=new s),l(e,i,n)):c?(t||(t=new c),p(t,i,n)):(r||(r={key:{},next:null}),function(e,t,r){var i=v(e,t);i?i.value=r:e.next={key:t,next:e.next,value:r}}(r,i,n))}};return i}},3476:(e,t,r)=>{r(2345).install()},2345:(e,t,r)=>{e=r.nmd(e);var i,n=r(9665).SourceMapConsumer,a=r(6928);try{(i=r(9896)).existsSync&&i.readFileSync||(i=null)}catch(e){}var o=r(2746);function s(e,t){return e.require(t)}var c=!1,u=!1,l=!1,h="auto",d={},p={},f=/^data:application\/json[^,]+base64,/,v=[],g=[];function m(){return"browser"===h||"node"!==h&&("undefined"!=typeof window&&"function"==typeof XMLHttpRequest&&!(window.require&&window.module&&window.process&&"renderer"===window.process.type))}function y(e){return function(t){for(var r=0;r<e.length;r++){var i=e[r](t);if(i)return i}return null}}var C=y(v);function S(e,t){if(!e)return t;var r=a.dirname(e),i=/^\w+:\/\/[^\/]*/.exec(r),n=i?i[0]:"",o=r.slice(n.length);return n&&/^\/\w\:/.test(o)?(n+="/")+a.resolve(r.slice(n.length),t).replace(/\\/g,"/"):n+a.resolve(r.slice(n.length),t)}v.push((function(e){if(e=e.trim(),/^file:/.test(e)&&(e=e.replace(/file:\/\/\/(\w:)?/,(function(e,t){return t?"":"/"}))),e in d)return d[e];var t="";try{if(i)i.existsSync(e)&&(t=i.readFileSync(e,"utf8"));else{var r=new XMLHttpRequest;r.open("GET",e,!1),r.send(null),4===r.readyState&&200===r.status&&(t=r.responseText)}}catch(e){}return d[e]=t}));var E=y(g);function _(e){var t=p[e.source];if(!t){var r=E(e.source);r?(t=p[e.source]={url:r.url,map:new n(r.map)}).map.sourcesContent&&t.map.sources.forEach((function(e,r){var i=t.map.sourcesContent[r];if(i){var n=S(t.url,e);d[n]=i}})):t=p[e.source]={url:null,map:null}}if(t&&t.map&&"function"==typeof t.map.originalPositionFor){var i=t.map.originalPositionFor(e);if(null!==i.source)return i.source=S(t.url,i.source),i}return e}function T(e){var t=/^eval at ([^(]+) \((.+):(\d+):(\d+)\)$/.exec(e);if(t){var r=_({source:t[2],line:+t[3],column:t[4]-1});return"eval at "+t[1]+" ("+r.source+":"+r.line+":"+(r.column+1)+")"}return(t=/^eval at ([^(]+) \((.+)\)$/.exec(e))?"eval at "+t[1]+" ("+T(t[2])+")":e}function A(){var e,t="";if(this.isNative())t="native";else{!(e=this.getScriptNameOrSourceURL())&&this.isEval()&&(t=this.getEvalOrigin(),t+=", "),t+=e||"<anonymous>";var r=this.getLineNumber();if(null!=r){t+=":"+r;var i=this.getColumnNumber();i&&(t+=":"+i)}}var n="",a=this.getFunctionName(),o=!0,s=this.isConstructor();if(!(this.isToplevel()||s)){var c=this.getTypeName();"[object Object]"===c&&(c="null");var u=this.getMethodName();a?(c&&0!=a.indexOf(c)&&(n+=c+"."),n+=a,u&&a.indexOf("."+u)!=a.length-u.length-1&&(n+=" [as "+u+"]")):n+=c+"."+(u||"<anonymous>")}else s?n+="new "+(a||"<anonymous>"):a?n+=a:(n+=t,o=!1);return o&&(n+=" ("+t+")"),n}function I(e){var t={};return Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach((function(r){t[r]=/^(?:is|get)/.test(r)?function(){return e[r].call(e)}:e[r]})),t.toString=A,t}function D(e,t){if(void 0===t&&(t={nextPosition:null,curPosition:null}),e.isNative())return t.curPosition=null,e;var r=e.getFileName()||e.getScriptNameOrSourceURL();if(r){var i=e.getLineNumber(),n=e.getColumnNumber()-1,a=/^v(10\.1[6-9]|10\.[2-9][0-9]|10\.[0-9]{3,}|1[2-9]\d*|[2-9]\d|\d{3,}|11\.11)/.test("object"==typeof process&&null!==process?process.version:"")?0:62;1===i&&n>a&&!m()&&!e.isEval()&&(n-=a);var o=_({source:r,line:i,column:n});t.curPosition=o;var s=(e=I(e)).getFunctionName;return e.getFunctionName=function(){return null==t.nextPosition?s():t.nextPosition.name||s()},e.getFileName=function(){return o.source},e.getLineNumber=function(){return o.line},e.getColumnNumber=function(){return o.column+1},e.getScriptNameOrSourceURL=function(){return o.source},e}var c=e.isEval()&&e.getEvalOrigin();return c?(c=T(c),(e=I(e)).getEvalOrigin=function(){return c},e):e}function w(e,t){l&&(d={},p={});for(var r=(e.name||"Error")+": "+(e.message||""),i={nextPosition:null,curPosition:null},n=[],a=t.length-1;a>=0;a--)n.push("\n    at "+D(t[a],i)),i.nextPosition=i.curPosition;return i.curPosition=i.nextPosition=null,r+n.reverse().join("")}function b(e){var t=/\n    at [^(]+ \((.*):(\d+):(\d+)\)/.exec(e.stack);if(t){var r=t[1],n=+t[2],a=+t[3],o=d[r];if(!o&&i&&i.existsSync(r))try{o=i.readFileSync(r,"utf8")}catch(e){o=""}if(o){var s=o.split(/(?:\r\n|\r|\n)/)[n-1];if(s)return r+":"+n+"\n"+s+"\n"+new Array(a).join(" ")+"^"}}return null}function U(e){var t=b(e),r=function(){if("object"==typeof process&&null!==process)return process.stderr}();r&&r._handle&&r._handle.setBlocking&&r._handle.setBlocking(!0),t&&(console.error(),console.error(t)),console.error(e.stack),function(e){if("object"==typeof process&&null!==process&&"function"==typeof process.exit)process.exit(e)}(1)}g.push((function(e){var t,r=function(e){var t;if(m())try{var r=new XMLHttpRequest;r.open("GET",e,!1),r.send(null),t=4===r.readyState?r.responseText:null;var i=r.getResponseHeader("SourceMap")||r.getResponseHeader("X-SourceMap");if(i)return i}catch(e){}t=C(e);for(var n,a,o=/(?:\/\/[@#][\s]*sourceMappingURL=([^\s'"]+)[\s]*$)|(?:\/\*[@#][\s]*sourceMappingURL=([^\s*'"]+)[\s]*(?:\*\/)[\s]*$)/gm;a=o.exec(t);)n=a;return n?n[1]:null}(e);if(!r)return null;if(f.test(r)){var i=r.slice(r.indexOf(",")+1);t=o(i,"base64").toString(),r=e}else r=S(e,r),t=C(r);return t?{url:r,map:t}:null}));var R=v.slice(0),O=g.slice(0);t.wrapCallSite=D,t.getErrorSource=b,t.mapSourcePosition=_,t.retrieveSourceMap=E,t.install=function(t){if((t=t||{}).environment&&(h=t.environment,-1===["node","browser","auto"].indexOf(h)))throw new Error("environment "+h+" was unknown. Available options are {auto, browser, node}");if(t.retrieveFile&&(t.overrideRetrieveFile&&(v.length=0),v.unshift(t.retrieveFile)),t.retrieveSourceMap&&(t.overrideRetrieveSourceMap&&(g.length=0),g.unshift(t.retrieveSourceMap)),t.hookRequire&&!m()){var r=s(e,"module"),i=r.prototype._compile;i.__sourceMapSupport||(r.prototype._compile=function(e,t){return d[t]=e,p[t]=void 0,i.call(this,e,t)},r.prototype._compile.__sourceMapSupport=!0)}if(l||(l="emptyCacheBetweenOperations"in t&&t.emptyCacheBetweenOperations),c||(c=!0,Error.prepareStackTrace=w),!u){var n=!("handleUncaughtExceptions"in t)||t.handleUncaughtExceptions;try{!1===s(e,"worker_threads").isMainThread&&(n=!1)}catch(e){}n&&"object"==typeof process&&null!==process&&"function"==typeof process.on&&(u=!0,a=process.emit,process.emit=function(e){if("uncaughtException"===e){var t=arguments[1]&&arguments[1].stack,r=this.listeners(e).length>0;if(t&&!r)return U(arguments[1])}return a.apply(this,arguments)})}var a},t.resetRetrieveHandlers=function(){v.length=0,g.length=0,v=R.slice(0),g=O.slice(0),E=y(g),C=y(v)}},735:(e,t,r)=>{var i=r(251),n=Object.prototype.hasOwnProperty,a="undefined"!=typeof Map;function o(){this._array=[],this._set=a?new Map:Object.create(null)}o.fromArray=function(e,t){for(var r=new o,i=0,n=e.length;i<n;i++)r.add(e[i],t);return r},o.prototype.size=function(){return a?this._set.size:Object.getOwnPropertyNames(this._set).length},o.prototype.add=function(e,t){var r=a?e:i.toSetString(e),o=a?this.has(e):n.call(this._set,r),s=this._array.length;o&&!t||this._array.push(e),o||(a?this._set.set(e,s):this._set[r]=s)},o.prototype.has=function(e){if(a)return this._set.has(e);var t=i.toSetString(e);return n.call(this._set,t)},o.prototype.indexOf=function(e){if(a){var t=this._set.get(e);if(t>=0)return t}else{var r=i.toSetString(e);if(n.call(this._set,r))return this._set[r]}throw new Error('"'+e+'" is not in the set.')},o.prototype.at=function(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)},o.prototype.toArray=function(){return this._array.slice()},t.C=o},7092:(e,t,r)=>{var i=r(2364);t.encode=function(e){var t,r="",n=function(e){return e<0?1+(-e<<1):0+(e<<1)}(e);do{t=31&n,(n>>>=5)>0&&(t|=32),r+=i.encode(t)}while(n>0);return r},t.decode=function(e,t,r){var n,a,o,s,c=e.length,u=0,l=0;do{if(t>=c)throw new Error("Expected more digits in base 64 VLQ value.");if(-1===(a=i.decode(e.charCodeAt(t++))))throw new Error("Invalid base64 digit: "+e.charAt(t-1));n=!!(32&a),u+=(a&=31)<<l,l+=5}while(n);r.value=(s=(o=u)>>1,1&~o?s:-s),r.rest=t}},2364:(e,t)=>{var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");t.encode=function(e){if(0<=e&&e<r.length)return r[e];throw new TypeError("Must be between 0 and 63: "+e)},t.decode=function(e){return 65<=e&&e<=90?e-65:97<=e&&e<=122?e-97+26:48<=e&&e<=57?e-48+52:43==e?62:47==e?63:-1}},1163:(e,t)=>{function r(e,i,n,a,o,s){var c=Math.floor((i-e)/2)+e,u=o(n,a[c],!0);return 0===u?c:u>0?i-c>1?r(c,i,n,a,o,s):s==t.LEAST_UPPER_BOUND?i<a.length?i:-1:c:c-e>1?r(e,c,n,a,o,s):s==t.LEAST_UPPER_BOUND?c:e<0?-1:e}t.GREATEST_LOWER_BOUND=1,t.LEAST_UPPER_BOUND=2,t.search=function(e,i,n,a){if(0===i.length)return-1;var o=r(-1,i.length,e,i,n,a||t.GREATEST_LOWER_BOUND);if(o<0)return-1;for(;o-1>=0&&0===n(i[o],i[o-1],!0);)--o;return o}},3302:(e,t,r)=>{var i=r(251);function n(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}n.prototype.unsortedForEach=function(e,t){this._array.forEach(e,t)},n.prototype.add=function(e){var t,r,n,a,o,s;t=this._last,r=e,n=t.generatedLine,a=r.generatedLine,o=t.generatedColumn,s=r.generatedColumn,a>n||a==n&&s>=o||i.compareByGeneratedPositionsInflated(t,r)<=0?(this._last=e,this._array.push(e)):(this._sorted=!1,this._array.push(e))},n.prototype.toArray=function(){return this._sorted||(this._array.sort(i.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},t.P=n},3801:(e,t)=>{function r(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}function i(e,t,n,a){if(n<a){var o=n-1;r(e,(l=n,h=a,Math.round(l+Math.random()*(h-l))),a);for(var s=e[a],c=n;c<a;c++)t(e[c],s)<=0&&r(e,o+=1,c);r(e,o+1,c);var u=o+1;i(e,t,n,u-1),i(e,t,u+1,a)}var l,h}t.g=function(e,t){i(e,t,0,e.length-1)}},7446:(e,t,r)=>{var i=r(251),n=r(1163),a=r(735).C,o=r(7092),s=r(3801).g;function c(e,t){var r=e;return"string"==typeof e&&(r=i.parseSourceMapInput(e)),null!=r.sections?new h(r,t):new u(r,t)}function u(e,t){var r=e;"string"==typeof e&&(r=i.parseSourceMapInput(e));var n=i.getArg(r,"version"),o=i.getArg(r,"sources"),s=i.getArg(r,"names",[]),c=i.getArg(r,"sourceRoot",null),u=i.getArg(r,"sourcesContent",null),l=i.getArg(r,"mappings"),h=i.getArg(r,"file",null);if(n!=this._version)throw new Error("Unsupported version: "+n);c&&(c=i.normalize(c)),o=o.map(String).map(i.normalize).map((function(e){return c&&i.isAbsolute(c)&&i.isAbsolute(e)?i.relative(c,e):e})),this._names=a.fromArray(s.map(String),!0),this._sources=a.fromArray(o,!0),this._absoluteSources=this._sources.toArray().map((function(e){return i.computeSourceURL(c,e,t)})),this.sourceRoot=c,this.sourcesContent=u,this._mappings=l,this._sourceMapURL=t,this.file=h}function l(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}function h(e,t){var r=e;"string"==typeof e&&(r=i.parseSourceMapInput(e));var n=i.getArg(r,"version"),o=i.getArg(r,"sections");if(n!=this._version)throw new Error("Unsupported version: "+n);this._sources=new a,this._names=new a;var s={line:-1,column:0};this._sections=o.map((function(e){if(e.url)throw new Error("Support for url field in sections not implemented.");var r=i.getArg(e,"offset"),n=i.getArg(r,"line"),a=i.getArg(r,"column");if(n<s.line||n===s.line&&a<s.column)throw new Error("Section offsets must be ordered and non-overlapping.");return s=r,{generatedOffset:{generatedLine:n+1,generatedColumn:a+1},consumer:new c(i.getArg(e,"map"),t)}}))}c.fromSourceMap=function(e,t){return u.fromSourceMap(e,t)},c.prototype._version=3,c.prototype.__generatedMappings=null,Object.defineProperty(c.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),c.prototype.__originalMappings=null,Object.defineProperty(c.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),c.prototype._charIsMappingSeparator=function(e,t){var r=e.charAt(t);return";"===r||","===r},c.prototype._parseMappings=function(e,t){throw new Error("Subclasses must implement _parseMappings")},c.GENERATED_ORDER=1,c.ORIGINAL_ORDER=2,c.GREATEST_LOWER_BOUND=1,c.LEAST_UPPER_BOUND=2,c.prototype.eachMapping=function(e,t,r){var n,a=t||null;switch(r||c.GENERATED_ORDER){case c.GENERATED_ORDER:n=this._generatedMappings;break;case c.ORIGINAL_ORDER:n=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var o=this.sourceRoot;n.map((function(e){var t=null===e.source?null:this._sources.at(e.source);return{source:t=i.computeSourceURL(o,t,this._sourceMapURL),generatedLine:e.generatedLine,generatedColumn:e.generatedColumn,originalLine:e.originalLine,originalColumn:e.originalColumn,name:null===e.name?null:this._names.at(e.name)}}),this).forEach(e,a)},c.prototype.allGeneratedPositionsFor=function(e){var t=i.getArg(e,"line"),r={source:i.getArg(e,"source"),originalLine:t,originalColumn:i.getArg(e,"column",0)};if(r.source=this._findSourceIndex(r.source),r.source<0)return[];var a=[],o=this._findMapping(r,this._originalMappings,"originalLine","originalColumn",i.compareByOriginalPositions,n.LEAST_UPPER_BOUND);if(o>=0){var s=this._originalMappings[o];if(void 0===e.column)for(var c=s.originalLine;s&&s.originalLine===c;)a.push({line:i.getArg(s,"generatedLine",null),column:i.getArg(s,"generatedColumn",null),lastColumn:i.getArg(s,"lastGeneratedColumn",null)}),s=this._originalMappings[++o];else for(var u=s.originalColumn;s&&s.originalLine===t&&s.originalColumn==u;)a.push({line:i.getArg(s,"generatedLine",null),column:i.getArg(s,"generatedColumn",null),lastColumn:i.getArg(s,"lastGeneratedColumn",null)}),s=this._originalMappings[++o]}return a},t.SourceMapConsumer=c,u.prototype=Object.create(c.prototype),u.prototype.consumer=c,u.prototype._findSourceIndex=function(e){var t,r=e;if(null!=this.sourceRoot&&(r=i.relative(this.sourceRoot,r)),this._sources.has(r))return this._sources.indexOf(r);for(t=0;t<this._absoluteSources.length;++t)if(this._absoluteSources[t]==e)return t;return-1},u.fromSourceMap=function(e,t){var r=Object.create(u.prototype),n=r._names=a.fromArray(e._names.toArray(),!0),o=r._sources=a.fromArray(e._sources.toArray(),!0);r.sourceRoot=e._sourceRoot,r.sourcesContent=e._generateSourcesContent(r._sources.toArray(),r.sourceRoot),r.file=e._file,r._sourceMapURL=t,r._absoluteSources=r._sources.toArray().map((function(e){return i.computeSourceURL(r.sourceRoot,e,t)}));for(var c=e._mappings.toArray().slice(),h=r.__generatedMappings=[],d=r.__originalMappings=[],p=0,f=c.length;p<f;p++){var v=c[p],g=new l;g.generatedLine=v.generatedLine,g.generatedColumn=v.generatedColumn,v.source&&(g.source=o.indexOf(v.source),g.originalLine=v.originalLine,g.originalColumn=v.originalColumn,v.name&&(g.name=n.indexOf(v.name)),d.push(g)),h.push(g)}return s(r.__originalMappings,i.compareByOriginalPositions),r},u.prototype._version=3,Object.defineProperty(u.prototype,"sources",{get:function(){return this._absoluteSources.slice()}}),u.prototype._parseMappings=function(e,t){for(var r,n,a,c,u,h=1,d=0,p=0,f=0,v=0,g=0,m=e.length,y=0,C={},S={},E=[],_=[];y<m;)if(";"===e.charAt(y))h++,y++,d=0;else if(","===e.charAt(y))y++;else{for((r=new l).generatedLine=h,c=y;c<m&&!this._charIsMappingSeparator(e,c);c++);if(a=C[n=e.slice(y,c)])y+=n.length;else{for(a=[];y<c;)o.decode(e,y,S),u=S.value,y=S.rest,a.push(u);if(2===a.length)throw new Error("Found a source, but no line and column");if(3===a.length)throw new Error("Found a source and line, but no column");C[n]=a}r.generatedColumn=d+a[0],d=r.generatedColumn,a.length>1&&(r.source=v+a[1],v+=a[1],r.originalLine=p+a[2],p=r.originalLine,r.originalLine+=1,r.originalColumn=f+a[3],f=r.originalColumn,a.length>4&&(r.name=g+a[4],g+=a[4])),_.push(r),"number"==typeof r.originalLine&&E.push(r)}s(_,i.compareByGeneratedPositionsDeflated),this.__generatedMappings=_,s(E,i.compareByOriginalPositions),this.__originalMappings=E},u.prototype._findMapping=function(e,t,r,i,a,o){if(e[r]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[r]);if(e[i]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[i]);return n.search(e,t,a,o)},u.prototype.computeColumnSpans=function(){for(var e=0;e<this._generatedMappings.length;++e){var t=this._generatedMappings[e];if(e+1<this._generatedMappings.length){var r=this._generatedMappings[e+1];if(t.generatedLine===r.generatedLine){t.lastGeneratedColumn=r.generatedColumn-1;continue}}t.lastGeneratedColumn=1/0}},u.prototype.originalPositionFor=function(e){var t={generatedLine:i.getArg(e,"line"),generatedColumn:i.getArg(e,"column")},r=this._findMapping(t,this._generatedMappings,"generatedLine","generatedColumn",i.compareByGeneratedPositionsDeflated,i.getArg(e,"bias",c.GREATEST_LOWER_BOUND));if(r>=0){var n=this._generatedMappings[r];if(n.generatedLine===t.generatedLine){var a=i.getArg(n,"source",null);null!==a&&(a=this._sources.at(a),a=i.computeSourceURL(this.sourceRoot,a,this._sourceMapURL));var o=i.getArg(n,"name",null);return null!==o&&(o=this._names.at(o)),{source:a,line:i.getArg(n,"originalLine",null),column:i.getArg(n,"originalColumn",null),name:o}}}return{source:null,line:null,column:null,name:null}},u.prototype.hasContentsOfAllSources=function(){return!!this.sourcesContent&&(this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some((function(e){return null==e})))},u.prototype.sourceContentFor=function(e,t){if(!this.sourcesContent)return null;var r=this._findSourceIndex(e);if(r>=0)return this.sourcesContent[r];var n,a=e;if(null!=this.sourceRoot&&(a=i.relative(this.sourceRoot,a)),null!=this.sourceRoot&&(n=i.urlParse(this.sourceRoot))){var o=a.replace(/^file:\/\//,"");if("file"==n.scheme&&this._sources.has(o))return this.sourcesContent[this._sources.indexOf(o)];if((!n.path||"/"==n.path)&&this._sources.has("/"+a))return this.sourcesContent[this._sources.indexOf("/"+a)]}if(t)return null;throw new Error('"'+a+'" is not in the SourceMap.')},u.prototype.generatedPositionFor=function(e){var t=i.getArg(e,"source");if((t=this._findSourceIndex(t))<0)return{line:null,column:null,lastColumn:null};var r={source:t,originalLine:i.getArg(e,"line"),originalColumn:i.getArg(e,"column")},n=this._findMapping(r,this._originalMappings,"originalLine","originalColumn",i.compareByOriginalPositions,i.getArg(e,"bias",c.GREATEST_LOWER_BOUND));if(n>=0){var a=this._originalMappings[n];if(a.source===r.source)return{line:i.getArg(a,"generatedLine",null),column:i.getArg(a,"generatedColumn",null),lastColumn:i.getArg(a,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},h.prototype=Object.create(c.prototype),h.prototype.constructor=c,h.prototype._version=3,Object.defineProperty(h.prototype,"sources",{get:function(){for(var e=[],t=0;t<this._sections.length;t++)for(var r=0;r<this._sections[t].consumer.sources.length;r++)e.push(this._sections[t].consumer.sources[r]);return e}}),h.prototype.originalPositionFor=function(e){var t={generatedLine:i.getArg(e,"line"),generatedColumn:i.getArg(e,"column")},r=n.search(t,this._sections,(function(e,t){var r=e.generatedLine-t.generatedOffset.generatedLine;return r||e.generatedColumn-t.generatedOffset.generatedColumn})),a=this._sections[r];return a?a.consumer.originalPositionFor({line:t.generatedLine-(a.generatedOffset.generatedLine-1),column:t.generatedColumn-(a.generatedOffset.generatedLine===t.generatedLine?a.generatedOffset.generatedColumn-1:0),bias:e.bias}):{source:null,line:null,column:null,name:null}},h.prototype.hasContentsOfAllSources=function(){return this._sections.every((function(e){return e.consumer.hasContentsOfAllSources()}))},h.prototype.sourceContentFor=function(e,t){for(var r=0;r<this._sections.length;r++){var i=this._sections[r].consumer.sourceContentFor(e,!0);if(i)return i}if(t)return null;throw new Error('"'+e+'" is not in the SourceMap.')},h.prototype.generatedPositionFor=function(e){for(var t=0;t<this._sections.length;t++){var r=this._sections[t];if(-1!==r.consumer._findSourceIndex(i.getArg(e,"source"))){var n=r.consumer.generatedPositionFor(e);if(n)return{line:n.line+(r.generatedOffset.generatedLine-1),column:n.column+(r.generatedOffset.generatedLine===n.line?r.generatedOffset.generatedColumn-1:0)}}}return{line:null,column:null}},h.prototype._parseMappings=function(e,t){this.__generatedMappings=[],this.__originalMappings=[];for(var r=0;r<this._sections.length;r++)for(var n=this._sections[r],a=n.consumer._generatedMappings,o=0;o<a.length;o++){var c=a[o],u=n.consumer._sources.at(c.source);u=i.computeSourceURL(n.consumer.sourceRoot,u,this._sourceMapURL),this._sources.add(u),u=this._sources.indexOf(u);var l=null;c.name&&(l=n.consumer._names.at(c.name),this._names.add(l),l=this._names.indexOf(l));var h={source:u,generatedLine:c.generatedLine+(n.generatedOffset.generatedLine-1),generatedColumn:c.generatedColumn+(n.generatedOffset.generatedLine===c.generatedLine?n.generatedOffset.generatedColumn-1:0),originalLine:c.originalLine,originalColumn:c.originalColumn,name:l};this.__generatedMappings.push(h),"number"==typeof h.originalLine&&this.__originalMappings.push(h)}s(this.__generatedMappings,i.compareByGeneratedPositionsDeflated),s(this.__originalMappings,i.compareByOriginalPositions)}},4041:(e,t,r)=>{var i=r(7092),n=r(251),a=r(735).C,o=r(3302).P;function s(e){e||(e={}),this._file=n.getArg(e,"file",null),this._sourceRoot=n.getArg(e,"sourceRoot",null),this._skipValidation=n.getArg(e,"skipValidation",!1),this._sources=new a,this._names=new a,this._mappings=new o,this._sourcesContents=null}s.prototype._version=3,s.fromSourceMap=function(e){var t=e.sourceRoot,r=new s({file:e.file,sourceRoot:t});return e.eachMapping((function(e){var i={generated:{line:e.generatedLine,column:e.generatedColumn}};null!=e.source&&(i.source=e.source,null!=t&&(i.source=n.relative(t,i.source)),i.original={line:e.originalLine,column:e.originalColumn},null!=e.name&&(i.name=e.name)),r.addMapping(i)})),e.sources.forEach((function(i){var a=i;null!==t&&(a=n.relative(t,i)),r._sources.has(a)||r._sources.add(a);var o=e.sourceContentFor(i);null!=o&&r.setSourceContent(i,o)})),r},s.prototype.addMapping=function(e){var t=n.getArg(e,"generated"),r=n.getArg(e,"original",null),i=n.getArg(e,"source",null),a=n.getArg(e,"name",null);this._skipValidation||this._validateMapping(t,r,i,a),null!=i&&(i=String(i),this._sources.has(i)||this._sources.add(i)),null!=a&&(a=String(a),this._names.has(a)||this._names.add(a)),this._mappings.add({generatedLine:t.line,generatedColumn:t.column,originalLine:null!=r&&r.line,originalColumn:null!=r&&r.column,source:i,name:a})},s.prototype.setSourceContent=function(e,t){var r=e;null!=this._sourceRoot&&(r=n.relative(this._sourceRoot,r)),null!=t?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[n.toSetString(r)]=t):this._sourcesContents&&(delete this._sourcesContents[n.toSetString(r)],0===Object.keys(this._sourcesContents).length&&(this._sourcesContents=null))},s.prototype.applySourceMap=function(e,t,r){var i=t;if(null==t){if(null==e.file)throw new Error('SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map\'s "file" property. Both were omitted.');i=e.file}var o=this._sourceRoot;null!=o&&(i=n.relative(o,i));var s=new a,c=new a;this._mappings.unsortedForEach((function(t){if(t.source===i&&null!=t.originalLine){var a=e.originalPositionFor({line:t.originalLine,column:t.originalColumn});null!=a.source&&(t.source=a.source,null!=r&&(t.source=n.join(r,t.source)),null!=o&&(t.source=n.relative(o,t.source)),t.originalLine=a.line,t.originalColumn=a.column,null!=a.name&&(t.name=a.name))}var u=t.source;null==u||s.has(u)||s.add(u);var l=t.name;null==l||c.has(l)||c.add(l)}),this),this._sources=s,this._names=c,e.sources.forEach((function(t){var i=e.sourceContentFor(t);null!=i&&(null!=r&&(t=n.join(r,t)),null!=o&&(t=n.relative(o,t)),this.setSourceContent(t,i))}),this)},s.prototype._validateMapping=function(e,t,r,i){if(t&&"number"!=typeof t.line&&"number"!=typeof t.column)throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if((!(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0)||t||r||i)&&!(e&&"line"in e&&"column"in e&&t&&"line"in t&&"column"in t&&e.line>0&&e.column>=0&&t.line>0&&t.column>=0&&r))throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:r,original:t,name:i}))},s.prototype._serializeMappings=function(){for(var e,t,r,a,o=0,s=1,c=0,u=0,l=0,h=0,d="",p=this._mappings.toArray(),f=0,v=p.length;f<v;f++){if(e="",(t=p[f]).generatedLine!==s)for(o=0;t.generatedLine!==s;)e+=";",s++;else if(f>0){if(!n.compareByGeneratedPositionsInflated(t,p[f-1]))continue;e+=","}e+=i.encode(t.generatedColumn-o),o=t.generatedColumn,null!=t.source&&(a=this._sources.indexOf(t.source),e+=i.encode(a-h),h=a,e+=i.encode(t.originalLine-1-u),u=t.originalLine-1,e+=i.encode(t.originalColumn-c),c=t.originalColumn,null!=t.name&&(r=this._names.indexOf(t.name),e+=i.encode(r-l),l=r)),d+=e}return d},s.prototype._generateSourcesContent=function(e,t){return e.map((function(e){if(!this._sourcesContents)return null;null!=t&&(e=n.relative(t,e));var r=n.toSetString(e);return Object.prototype.hasOwnProperty.call(this._sourcesContents,r)?this._sourcesContents[r]:null}),this)},s.prototype.toJSON=function(){var e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return null!=this._file&&(e.file=this._file),null!=this._sourceRoot&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e},s.prototype.toString=function(){return JSON.stringify(this.toJSON())},t.x=s},1683:(e,t,r)=>{var i=r(4041).x,n=r(251),a=/(\r?\n)/,o="$$$isSourceNode$$$";function s(e,t,r,i,n){this.children=[],this.sourceContents={},this.line=null==e?null:e,this.column=null==t?null:t,this.source=null==r?null:r,this.name=null==n?null:n,this[o]=!0,null!=i&&this.add(i)}s.fromStringWithSourceMap=function(e,t,r){var i=new s,o=e.split(a),c=0,u=function(){return e()+(e()||"");function e(){return c<o.length?o[c++]:void 0}},l=1,h=0,d=null;return t.eachMapping((function(e){if(null!==d){if(!(l<e.generatedLine)){var t=(r=o[c]||"").substr(0,e.generatedColumn-h);return o[c]=r.substr(e.generatedColumn-h),h=e.generatedColumn,p(d,t),void(d=e)}p(d,u()),l++,h=0}for(;l<e.generatedLine;)i.add(u()),l++;if(h<e.generatedColumn){var r=o[c]||"";i.add(r.substr(0,e.generatedColumn)),o[c]=r.substr(e.generatedColumn),h=e.generatedColumn}d=e}),this),c<o.length&&(d&&p(d,u()),i.add(o.splice(c).join(""))),t.sources.forEach((function(e){var a=t.sourceContentFor(e);null!=a&&(null!=r&&(e=n.join(r,e)),i.setSourceContent(e,a))})),i;function p(e,t){if(null===e||void 0===e.source)i.add(t);else{var a=r?n.join(r,e.source):e.source;i.add(new s(e.originalLine,e.originalColumn,a,t,e.name))}}},s.prototype.add=function(e){if(Array.isArray(e))e.forEach((function(e){this.add(e)}),this);else{if(!e[o]&&"string"!=typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);e&&this.children.push(e)}return this},s.prototype.prepend=function(e){if(Array.isArray(e))for(var t=e.length-1;t>=0;t--)this.prepend(e[t]);else{if(!e[o]&&"string"!=typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);this.children.unshift(e)}return this},s.prototype.walk=function(e){for(var t,r=0,i=this.children.length;r<i;r++)(t=this.children[r])[o]?t.walk(e):""!==t&&e(t,{source:this.source,line:this.line,column:this.column,name:this.name})},s.prototype.join=function(e){var t,r,i=this.children.length;if(i>0){for(t=[],r=0;r<i-1;r++)t.push(this.children[r]),t.push(e);t.push(this.children[r]),this.children=t}return this},s.prototype.replaceRight=function(e,t){var r=this.children[this.children.length-1];return r[o]?r.replaceRight(e,t):"string"==typeof r?this.children[this.children.length-1]=r.replace(e,t):this.children.push("".replace(e,t)),this},s.prototype.setSourceContent=function(e,t){this.sourceContents[n.toSetString(e)]=t},s.prototype.walkSourceContents=function(e){for(var t=0,r=this.children.length;t<r;t++)this.children[t][o]&&this.children[t].walkSourceContents(e);var i=Object.keys(this.sourceContents);for(t=0,r=i.length;t<r;t++)e(n.fromSetString(i[t]),this.sourceContents[i[t]])},s.prototype.toString=function(){var e="";return this.walk((function(t){e+=t})),e},s.prototype.toStringWithSourceMap=function(e){var t={code:"",line:1,column:0},r=new i(e),n=!1,a=null,o=null,s=null,c=null;return this.walk((function(e,i){t.code+=e,null!==i.source&&null!==i.line&&null!==i.column?(a===i.source&&o===i.line&&s===i.column&&c===i.name||r.addMapping({source:i.source,original:{line:i.line,column:i.column},generated:{line:t.line,column:t.column},name:i.name}),a=i.source,o=i.line,s=i.column,c=i.name,n=!0):n&&(r.addMapping({generated:{line:t.line,column:t.column}}),a=null,n=!1);for(var u=0,l=e.length;u<l;u++)10===e.charCodeAt(u)?(t.line++,t.column=0,u+1===l?(a=null,n=!1):n&&r.addMapping({source:i.source,original:{line:i.line,column:i.column},generated:{line:t.line,column:t.column},name:i.name})):t.column++})),this.walkSourceContents((function(e,t){r.setSourceContent(e,t)})),{code:t.code,map:r}}},251:(e,t)=>{t.getArg=function(e,t,r){if(t in e)return e[t];if(3===arguments.length)return r;throw new Error('"'+t+'" is a required argument.')};var r=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,i=/^data:.+\,.+$/;function n(e){var t=e.match(r);return t?{scheme:t[1],auth:t[2],host:t[3],port:t[4],path:t[5]}:null}function a(e){var t="";return e.scheme&&(t+=e.scheme+":"),t+="//",e.auth&&(t+=e.auth+"@"),e.host&&(t+=e.host),e.port&&(t+=":"+e.port),e.path&&(t+=e.path),t}function o(e){var r=e,i=n(e);if(i){if(!i.path)return e;r=i.path}for(var o,s=t.isAbsolute(r),c=r.split(/\/+/),u=0,l=c.length-1;l>=0;l--)"."===(o=c[l])?c.splice(l,1):".."===o?u++:u>0&&(""===o?(c.splice(l+1,u),u=0):(c.splice(l,2),u--));return""===(r=c.join("/"))&&(r=s?"/":"."),i?(i.path=r,a(i)):r}function s(e,t){""===e&&(e="."),""===t&&(t=".");var r=n(t),s=n(e);if(s&&(e=s.path||"/"),r&&!r.scheme)return s&&(r.scheme=s.scheme),a(r);if(r||t.match(i))return t;if(s&&!s.host&&!s.path)return s.host=t,a(s);var c="/"===t.charAt(0)?t:o(e.replace(/\/+$/,"")+"/"+t);return s?(s.path=c,a(s)):c}t.urlParse=n,t.urlGenerate=a,t.normalize=o,t.join=s,t.isAbsolute=function(e){return"/"===e.charAt(0)||r.test(e)},t.relative=function(e,t){""===e&&(e="."),e=e.replace(/\/$/,"");for(var r=0;0!==t.indexOf(e+"/");){var i=e.lastIndexOf("/");if(i<0)return t;if((e=e.slice(0,i)).match(/^([^\/]+:\/)?\/*$/))return t;++r}return Array(r+1).join("../")+t.substr(e.length+1)};var c=!("__proto__"in Object.create(null));function u(e){return e}function l(e){if(!e)return!1;var t=e.length;if(t<9)return!1;if(95!==e.charCodeAt(t-1)||95!==e.charCodeAt(t-2)||111!==e.charCodeAt(t-3)||116!==e.charCodeAt(t-4)||111!==e.charCodeAt(t-5)||114!==e.charCodeAt(t-6)||112!==e.charCodeAt(t-7)||95!==e.charCodeAt(t-8)||95!==e.charCodeAt(t-9))return!1;for(var r=t-10;r>=0;r--)if(36!==e.charCodeAt(r))return!1;return!0}function h(e,t){return e===t?0:null===e?1:null===t?-1:e>t?1:-1}t.toSetString=c?u:function(e){return l(e)?"$"+e:e},t.fromSetString=c?u:function(e){return l(e)?e.slice(1):e},t.compareByOriginalPositions=function(e,t,r){var i=h(e.source,t.source);return 0!==i||0!==(i=e.originalLine-t.originalLine)||0!==(i=e.originalColumn-t.originalColumn)||r||0!==(i=e.generatedColumn-t.generatedColumn)||0!==(i=e.generatedLine-t.generatedLine)?i:h(e.name,t.name)},t.compareByGeneratedPositionsDeflated=function(e,t,r){var i=e.generatedLine-t.generatedLine;return 0!==i||0!==(i=e.generatedColumn-t.generatedColumn)||r||0!==(i=h(e.source,t.source))||0!==(i=e.originalLine-t.originalLine)||0!==(i=e.originalColumn-t.originalColumn)?i:h(e.name,t.name)},t.compareByGeneratedPositionsInflated=function(e,t){var r=e.generatedLine-t.generatedLine;return 0!==r||0!==(r=e.generatedColumn-t.generatedColumn)||0!==(r=h(e.source,t.source))||0!==(r=e.originalLine-t.originalLine)||0!==(r=e.originalColumn-t.originalColumn)?r:h(e.name,t.name)},t.parseSourceMapInput=function(e){return JSON.parse(e.replace(/^\)]}'[^\n]*\n/,""))},t.computeSourceURL=function(e,t,r){if(t=t||"",e&&("/"!==e[e.length-1]&&"/"!==t[0]&&(e+="/"),t=e+t),r){var i=n(r);if(!i)throw new Error("sourceMapURL could not be parsed");if(i.path){var c=i.path.lastIndexOf("/");c>=0&&(i.path=i.path.substring(0,c+1))}t=s(a(i),t)}return o(t)}},9665:(e,t,r)=>{r(4041).x,t.SourceMapConsumer=r(7446).SourceMapConsumer,r(1683)},175:(e,t,r)=>{var i=r(1094),n=r(3193).StringDecoder;e.exports=function(e,t,r){var a=new n,o="",s=r&&r.maxLength,c=!r||!1!==r.trailing;"function"==typeof e&&(t=e,e=null);e||(e=/\r?\n/);function u(e,r){if(t){try{r=t(r)}catch(t){return e.emit("error",t)}void 0!==r&&e.queue(r)}else e.queue(r)}function l(t,r){var i=((null!=o?o:"")+r).split(e);if(o=i.pop(),s&&o.length>s)return t.emit("error",new Error("maximum buffer reached"));for(var n=0;n<i.length;n++){u(t,i[n])}}return i((function(e){l(this,a.write(e))}),(function(){a.end&&l(this,a.end()),c&&null!=o&&u(this,o),this.queue(null)}))}},8497:(e,t,r)=>{var i=r(4928),n=r(1094);e.exports=function(){var e;if(0==(e=1==arguments.length&&Array.isArray(arguments[0])?arguments[0]:[].slice.call(arguments)).length)return n();if(1==e.length)return e[0];var t=e[0],r=e[e.length-1],a=i(t,r);function o(){var e=[].slice.call(arguments);e.unshift("error"),a.emit.apply(a,e)}!function e(t){t.length<2||(t[0].pipe(t[1]),e(t.slice(1)))}(e);for(var s=1;s<e.length-1;s++)e[s].on("error",o);return a}},7687:(e,t,r)=>{"use strict";const i=r(857),n=r(2018),a=r(5884),{env:o}=process;let s;function c(e,{streamIsTTY:t,sniffFlags:r=!0}={}){const n=function(){if("FORCE_COLOR"in o)return"true"===o.FORCE_COLOR?1:"false"===o.FORCE_COLOR?0:0===o.FORCE_COLOR.length?1:Math.min(Number.parseInt(o.FORCE_COLOR,10),3)}();void 0!==n&&(s=n);const c=r?s:n;if(0===c)return 0;if(r){if(a("color=16m")||a("color=full")||a("color=truecolor"))return 3;if(a("color=256"))return 2}if(e&&!t&&void 0===c)return 0;const u=c||0;if("dumb"===o.TERM)return u;if("win32"===process.platform){const e=i.release().split(".");return Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in o)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE","DRONE"].some((e=>e in o))||"codeship"===o.CI_NAME?1:u;if("TEAMCITY_VERSION"in o)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(o.TEAMCITY_VERSION)?1:0;if("truecolor"===o.COLORTERM)return 3;if("TERM_PROGRAM"in o){const e=Number.parseInt((o.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(o.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(o.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(o.TERM)||"COLORTERM"in o?1:u}function u(e,t={}){return function(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}(c(e,{streamIsTTY:e&&e.isTTY,...t}))}a("no-color")||a("no-colors")||a("color=false")||a("color=never")?s=0:(a("color")||a("colors")||a("color=true")||a("color=always"))&&(s=1),e.exports={supportsColor:u,stdout:u({isTTY:n.isatty(1)}),stderr:u({isTTY:n.isatty(2)})}},1094:(e,t,r)=>{var i=r(2203);function n(e,t,r){e=e||function(e){this.queue(e)},t=t||function(){this.queue(null)};var n=!1,a=!1,o=[],s=!1,c=new i;function u(){for(;o.length&&!c.paused;){var e=o.shift();if(null===e)return c.emit("end");c.emit("data",e)}}return c.readable=c.writable=!0,c.paused=!1,c.autoDestroy=!(r&&!1===r.autoDestroy),c.write=function(t){return e.call(this,t),!c.paused},c.queue=c.push=function(e){return s||(null===e&&(s=!0),o.push(e),u()),c},c.on("end",(function(){c.readable=!1,!c.writable&&c.autoDestroy&&process.nextTick((function(){c.destroy()}))})),c.end=function(e){if(!n)return n=!0,arguments.length&&c.write(e),c.writable=!1,t.call(c),!c.readable&&c.autoDestroy&&c.destroy(),c},c.destroy=function(){if(!a)return a=!0,n=!0,o.length=0,c.writable=c.readable=!1,c.emit("close"),c},c.pause=function(){if(!c.paused)return c.paused=!0,c},c.resume=function(){return c.paused&&(c.paused=!1,c.emit("resume")),u(),c.paused||c.emit("drain"),c},c}e.exports=n,n.through=n},294:e=>{"use strict";var t=function(e,t,r){process.nextTick((function(){e(t,r)}))};function r(){}function i(e,t){e.apply(null,t)}process.nextTick((function(e){42===e&&(t=process.nextTick)}),42),e.exports=function(e){var n=function r(a){var o=[a];function s(e){o.push(e)}function c(e){var a=arguments;for(n=function(e){return"[object Error]"===Object.prototype.toString.call(e)}(e)?r:s;o.length;)s(o.shift());function s(e){t(i,e,a)}}n=s,e(c)};return function(e){n(e||r)}}},8947:(e,t,r)=>{!function(e){"use strict";var t=function(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;t++)r[t]=e[t];return r},i=function(){throw new Error("no PRNG")},n=new Uint8Array(16),a=new Uint8Array(32);a[0]=9;var o=t(),s=t([1]),c=t([56129,1]),u=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),l=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),h=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),d=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),p=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function f(e,t,r,i){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r,e[t+4]=i>>24&255,e[t+5]=i>>16&255,e[t+6]=i>>8&255,e[t+7]=255&i}function v(e,t,r,i,n){var a,o=0;for(a=0;a<n;a++)o|=e[t+a]^r[i+a];return(1&o-1>>>8)-1}function g(e,t,r,i){return v(e,t,r,i,16)}function m(e,t,r,i){return v(e,t,r,i,32)}function y(e,t,r,i){!function(e,t,r,i){for(var n,a=255&i[0]|(255&i[1])<<8|(255&i[2])<<16|(255&i[3])<<24,o=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,s=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,c=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,u=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,l=255&i[4]|(255&i[5])<<8|(255&i[6])<<16|(255&i[7])<<24,h=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,d=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,p=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,f=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,v=255&i[8]|(255&i[9])<<8|(255&i[10])<<16|(255&i[11])<<24,g=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,m=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,y=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,C=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,S=255&i[12]|(255&i[13])<<8|(255&i[14])<<16|(255&i[15])<<24,E=a,_=o,T=s,A=c,I=u,D=l,w=h,b=d,U=p,R=f,O=v,N=g,P=m,B=y,L=C,x=S,M=0;M<20;M+=2)E^=(n=(P^=(n=(U^=(n=(I^=(n=E+P|0)<<7|n>>>25)+E|0)<<9|n>>>23)+I|0)<<13|n>>>19)+U|0)<<18|n>>>14,D^=(n=(_^=(n=(B^=(n=(R^=(n=D+_|0)<<7|n>>>25)+D|0)<<9|n>>>23)+R|0)<<13|n>>>19)+B|0)<<18|n>>>14,O^=(n=(w^=(n=(T^=(n=(L^=(n=O+w|0)<<7|n>>>25)+O|0)<<9|n>>>23)+L|0)<<13|n>>>19)+T|0)<<18|n>>>14,x^=(n=(N^=(n=(b^=(n=(A^=(n=x+N|0)<<7|n>>>25)+x|0)<<9|n>>>23)+A|0)<<13|n>>>19)+b|0)<<18|n>>>14,E^=(n=(A^=(n=(T^=(n=(_^=(n=E+A|0)<<7|n>>>25)+E|0)<<9|n>>>23)+_|0)<<13|n>>>19)+T|0)<<18|n>>>14,D^=(n=(I^=(n=(b^=(n=(w^=(n=D+I|0)<<7|n>>>25)+D|0)<<9|n>>>23)+w|0)<<13|n>>>19)+b|0)<<18|n>>>14,O^=(n=(R^=(n=(U^=(n=(N^=(n=O+R|0)<<7|n>>>25)+O|0)<<9|n>>>23)+N|0)<<13|n>>>19)+U|0)<<18|n>>>14,x^=(n=(L^=(n=(B^=(n=(P^=(n=x+L|0)<<7|n>>>25)+x|0)<<9|n>>>23)+P|0)<<13|n>>>19)+B|0)<<18|n>>>14;E=E+a|0,_=_+o|0,T=T+s|0,A=A+c|0,I=I+u|0,D=D+l|0,w=w+h|0,b=b+d|0,U=U+p|0,R=R+f|0,O=O+v|0,N=N+g|0,P=P+m|0,B=B+y|0,L=L+C|0,x=x+S|0,e[0]=E>>>0&255,e[1]=E>>>8&255,e[2]=E>>>16&255,e[3]=E>>>24&255,e[4]=_>>>0&255,e[5]=_>>>8&255,e[6]=_>>>16&255,e[7]=_>>>24&255,e[8]=T>>>0&255,e[9]=T>>>8&255,e[10]=T>>>16&255,e[11]=T>>>24&255,e[12]=A>>>0&255,e[13]=A>>>8&255,e[14]=A>>>16&255,e[15]=A>>>24&255,e[16]=I>>>0&255,e[17]=I>>>8&255,e[18]=I>>>16&255,e[19]=I>>>24&255,e[20]=D>>>0&255,e[21]=D>>>8&255,e[22]=D>>>16&255,e[23]=D>>>24&255,e[24]=w>>>0&255,e[25]=w>>>8&255,e[26]=w>>>16&255,e[27]=w>>>24&255,e[28]=b>>>0&255,e[29]=b>>>8&255,e[30]=b>>>16&255,e[31]=b>>>24&255,e[32]=U>>>0&255,e[33]=U>>>8&255,e[34]=U>>>16&255,e[35]=U>>>24&255,e[36]=R>>>0&255,e[37]=R>>>8&255,e[38]=R>>>16&255,e[39]=R>>>24&255,e[40]=O>>>0&255,e[41]=O>>>8&255,e[42]=O>>>16&255,e[43]=O>>>24&255,e[44]=N>>>0&255,e[45]=N>>>8&255,e[46]=N>>>16&255,e[47]=N>>>24&255,e[48]=P>>>0&255,e[49]=P>>>8&255,e[50]=P>>>16&255,e[51]=P>>>24&255,e[52]=B>>>0&255,e[53]=B>>>8&255,e[54]=B>>>16&255,e[55]=B>>>24&255,e[56]=L>>>0&255,e[57]=L>>>8&255,e[58]=L>>>16&255,e[59]=L>>>24&255,e[60]=x>>>0&255,e[61]=x>>>8&255,e[62]=x>>>16&255,e[63]=x>>>24&255}(e,t,r,i)}function C(e,t,r,i){!function(e,t,r,i){for(var n,a=255&i[0]|(255&i[1])<<8|(255&i[2])<<16|(255&i[3])<<24,o=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,s=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,c=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,u=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,l=255&i[4]|(255&i[5])<<8|(255&i[6])<<16|(255&i[7])<<24,h=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,d=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,p=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,f=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,v=255&i[8]|(255&i[9])<<8|(255&i[10])<<16|(255&i[11])<<24,g=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,m=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,y=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,C=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,S=255&i[12]|(255&i[13])<<8|(255&i[14])<<16|(255&i[15])<<24,E=0;E<20;E+=2)a^=(n=(m^=(n=(p^=(n=(u^=(n=a+m|0)<<7|n>>>25)+a|0)<<9|n>>>23)+u|0)<<13|n>>>19)+p|0)<<18|n>>>14,l^=(n=(o^=(n=(y^=(n=(f^=(n=l+o|0)<<7|n>>>25)+l|0)<<9|n>>>23)+f|0)<<13|n>>>19)+y|0)<<18|n>>>14,v^=(n=(h^=(n=(s^=(n=(C^=(n=v+h|0)<<7|n>>>25)+v|0)<<9|n>>>23)+C|0)<<13|n>>>19)+s|0)<<18|n>>>14,S^=(n=(g^=(n=(d^=(n=(c^=(n=S+g|0)<<7|n>>>25)+S|0)<<9|n>>>23)+c|0)<<13|n>>>19)+d|0)<<18|n>>>14,a^=(n=(c^=(n=(s^=(n=(o^=(n=a+c|0)<<7|n>>>25)+a|0)<<9|n>>>23)+o|0)<<13|n>>>19)+s|0)<<18|n>>>14,l^=(n=(u^=(n=(d^=(n=(h^=(n=l+u|0)<<7|n>>>25)+l|0)<<9|n>>>23)+h|0)<<13|n>>>19)+d|0)<<18|n>>>14,v^=(n=(f^=(n=(p^=(n=(g^=(n=v+f|0)<<7|n>>>25)+v|0)<<9|n>>>23)+g|0)<<13|n>>>19)+p|0)<<18|n>>>14,S^=(n=(C^=(n=(y^=(n=(m^=(n=S+C|0)<<7|n>>>25)+S|0)<<9|n>>>23)+m|0)<<13|n>>>19)+y|0)<<18|n>>>14;e[0]=a>>>0&255,e[1]=a>>>8&255,e[2]=a>>>16&255,e[3]=a>>>24&255,e[4]=l>>>0&255,e[5]=l>>>8&255,e[6]=l>>>16&255,e[7]=l>>>24&255,e[8]=v>>>0&255,e[9]=v>>>8&255,e[10]=v>>>16&255,e[11]=v>>>24&255,e[12]=S>>>0&255,e[13]=S>>>8&255,e[14]=S>>>16&255,e[15]=S>>>24&255,e[16]=h>>>0&255,e[17]=h>>>8&255,e[18]=h>>>16&255,e[19]=h>>>24&255,e[20]=d>>>0&255,e[21]=d>>>8&255,e[22]=d>>>16&255,e[23]=d>>>24&255,e[24]=p>>>0&255,e[25]=p>>>8&255,e[26]=p>>>16&255,e[27]=p>>>24&255,e[28]=f>>>0&255,e[29]=f>>>8&255,e[30]=f>>>16&255,e[31]=f>>>24&255}(e,t,r,i)}var S=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function E(e,t,r,i,n,a,o){var s,c,u=new Uint8Array(16),l=new Uint8Array(64);for(c=0;c<16;c++)u[c]=0;for(c=0;c<8;c++)u[c]=a[c];for(;n>=64;){for(y(l,u,o,S),c=0;c<64;c++)e[t+c]=r[i+c]^l[c];for(s=1,c=8;c<16;c++)s=s+(255&u[c])|0,u[c]=255&s,s>>>=8;n-=64,t+=64,i+=64}if(n>0)for(y(l,u,o,S),c=0;c<n;c++)e[t+c]=r[i+c]^l[c];return 0}function _(e,t,r,i,n){var a,o,s=new Uint8Array(16),c=new Uint8Array(64);for(o=0;o<16;o++)s[o]=0;for(o=0;o<8;o++)s[o]=i[o];for(;r>=64;){for(y(c,s,n,S),o=0;o<64;o++)e[t+o]=c[o];for(a=1,o=8;o<16;o++)a=a+(255&s[o])|0,s[o]=255&a,a>>>=8;r-=64,t+=64}if(r>0)for(y(c,s,n,S),o=0;o<r;o++)e[t+o]=c[o];return 0}function T(e,t,r,i,n){var a=new Uint8Array(32);C(a,i,n,S);for(var o=new Uint8Array(8),s=0;s<8;s++)o[s]=i[s+16];return _(e,t,r,o,a)}function A(e,t,r,i,n,a,o){var s=new Uint8Array(32);C(s,a,o,S);for(var c=new Uint8Array(8),u=0;u<8;u++)c[u]=a[u+16];return E(e,t,r,i,n,c,s)}var I=function(e){var t,r,i,n,a,o,s,c;this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0,t=255&e[0]|(255&e[1])<<8,this.r[0]=8191&t,r=255&e[2]|(255&e[3])<<8,this.r[1]=8191&(t>>>13|r<<3),i=255&e[4]|(255&e[5])<<8,this.r[2]=7939&(r>>>10|i<<6),n=255&e[6]|(255&e[7])<<8,this.r[3]=8191&(i>>>7|n<<9),a=255&e[8]|(255&e[9])<<8,this.r[4]=255&(n>>>4|a<<12),this.r[5]=a>>>1&8190,o=255&e[10]|(255&e[11])<<8,this.r[6]=8191&(a>>>14|o<<2),s=255&e[12]|(255&e[13])<<8,this.r[7]=8065&(o>>>11|s<<5),c=255&e[14]|(255&e[15])<<8,this.r[8]=8191&(s>>>8|c<<8),this.r[9]=c>>>5&127,this.pad[0]=255&e[16]|(255&e[17])<<8,this.pad[1]=255&e[18]|(255&e[19])<<8,this.pad[2]=255&e[20]|(255&e[21])<<8,this.pad[3]=255&e[22]|(255&e[23])<<8,this.pad[4]=255&e[24]|(255&e[25])<<8,this.pad[5]=255&e[26]|(255&e[27])<<8,this.pad[6]=255&e[28]|(255&e[29])<<8,this.pad[7]=255&e[30]|(255&e[31])<<8};function D(e,t,r,i,n,a){var o=new I(a);return o.update(r,i,n),o.finish(e,t),0}function w(e,t,r,i,n,a){var o=new Uint8Array(16);return D(o,0,r,i,n,a),g(e,t,o,0)}function b(e,t,r,i,n){var a;if(r<32)return-1;for(A(e,0,t,0,r,i,n),D(e,16,e,32,r-32,e),a=0;a<16;a++)e[a]=0;return 0}function U(e,t,r,i,n){var a,o=new Uint8Array(32);if(r<32)return-1;if(T(o,0,32,i,n),0!==w(t,16,t,32,r-32,o))return-1;for(A(e,0,t,0,r,i,n),a=0;a<32;a++)e[a]=0;return 0}function R(e,t){var r;for(r=0;r<16;r++)e[r]=0|t[r]}function O(e){var t,r,i=1;for(t=0;t<16;t++)r=e[t]+i+65535,i=Math.floor(r/65536),e[t]=r-65536*i;e[0]+=i-1+37*(i-1)}function N(e,t,r){for(var i,n=~(r-1),a=0;a<16;a++)i=n&(e[a]^t[a]),e[a]^=i,t[a]^=i}function P(e,r){var i,n,a,o=t(),s=t();for(i=0;i<16;i++)s[i]=r[i];for(O(s),O(s),O(s),n=0;n<2;n++){for(o[0]=s[0]-65517,i=1;i<15;i++)o[i]=s[i]-65535-(o[i-1]>>16&1),o[i-1]&=65535;o[15]=s[15]-32767-(o[14]>>16&1),a=o[15]>>16&1,o[14]&=65535,N(s,o,1-a)}for(i=0;i<16;i++)e[2*i]=255&s[i],e[2*i+1]=s[i]>>8}function B(e,t){var r=new Uint8Array(32),i=new Uint8Array(32);return P(r,e),P(i,t),m(r,0,i,0)}function L(e){var t=new Uint8Array(32);return P(t,e),1&t[0]}function x(e,t){var r;for(r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function M(e,t,r){for(var i=0;i<16;i++)e[i]=t[i]+r[i]}function F(e,t,r){for(var i=0;i<16;i++)e[i]=t[i]-r[i]}function k(e,t,r){var i,n,a=0,o=0,s=0,c=0,u=0,l=0,h=0,d=0,p=0,f=0,v=0,g=0,m=0,y=0,C=0,S=0,E=0,_=0,T=0,A=0,I=0,D=0,w=0,b=0,U=0,R=0,O=0,N=0,P=0,B=0,L=0,x=r[0],M=r[1],F=r[2],k=r[3],V=r[4],H=r[5],j=r[6],G=r[7],W=r[8],Y=r[9],q=r[10],K=r[11],$=r[12],z=r[13],Q=r[14],X=r[15];a+=(i=t[0])*x,o+=i*M,s+=i*F,c+=i*k,u+=i*V,l+=i*H,h+=i*j,d+=i*G,p+=i*W,f+=i*Y,v+=i*q,g+=i*K,m+=i*$,y+=i*z,C+=i*Q,S+=i*X,o+=(i=t[1])*x,s+=i*M,c+=i*F,u+=i*k,l+=i*V,h+=i*H,d+=i*j,p+=i*G,f+=i*W,v+=i*Y,g+=i*q,m+=i*K,y+=i*$,C+=i*z,S+=i*Q,E+=i*X,s+=(i=t[2])*x,c+=i*M,u+=i*F,l+=i*k,h+=i*V,d+=i*H,p+=i*j,f+=i*G,v+=i*W,g+=i*Y,m+=i*q,y+=i*K,C+=i*$,S+=i*z,E+=i*Q,_+=i*X,c+=(i=t[3])*x,u+=i*M,l+=i*F,h+=i*k,d+=i*V,p+=i*H,f+=i*j,v+=i*G,g+=i*W,m+=i*Y,y+=i*q,C+=i*K,S+=i*$,E+=i*z,_+=i*Q,T+=i*X,u+=(i=t[4])*x,l+=i*M,h+=i*F,d+=i*k,p+=i*V,f+=i*H,v+=i*j,g+=i*G,m+=i*W,y+=i*Y,C+=i*q,S+=i*K,E+=i*$,_+=i*z,T+=i*Q,A+=i*X,l+=(i=t[5])*x,h+=i*M,d+=i*F,p+=i*k,f+=i*V,v+=i*H,g+=i*j,m+=i*G,y+=i*W,C+=i*Y,S+=i*q,E+=i*K,_+=i*$,T+=i*z,A+=i*Q,I+=i*X,h+=(i=t[6])*x,d+=i*M,p+=i*F,f+=i*k,v+=i*V,g+=i*H,m+=i*j,y+=i*G,C+=i*W,S+=i*Y,E+=i*q,_+=i*K,T+=i*$,A+=i*z,I+=i*Q,D+=i*X,d+=(i=t[7])*x,p+=i*M,f+=i*F,v+=i*k,g+=i*V,m+=i*H,y+=i*j,C+=i*G,S+=i*W,E+=i*Y,_+=i*q,T+=i*K,A+=i*$,I+=i*z,D+=i*Q,w+=i*X,p+=(i=t[8])*x,f+=i*M,v+=i*F,g+=i*k,m+=i*V,y+=i*H,C+=i*j,S+=i*G,E+=i*W,_+=i*Y,T+=i*q,A+=i*K,I+=i*$,D+=i*z,w+=i*Q,b+=i*X,f+=(i=t[9])*x,v+=i*M,g+=i*F,m+=i*k,y+=i*V,C+=i*H,S+=i*j,E+=i*G,_+=i*W,T+=i*Y,A+=i*q,I+=i*K,D+=i*$,w+=i*z,b+=i*Q,U+=i*X,v+=(i=t[10])*x,g+=i*M,m+=i*F,y+=i*k,C+=i*V,S+=i*H,E+=i*j,_+=i*G,T+=i*W,A+=i*Y,I+=i*q,D+=i*K,w+=i*$,b+=i*z,U+=i*Q,R+=i*X,g+=(i=t[11])*x,m+=i*M,y+=i*F,C+=i*k,S+=i*V,E+=i*H,_+=i*j,T+=i*G,A+=i*W,I+=i*Y,D+=i*q,w+=i*K,b+=i*$,U+=i*z,R+=i*Q,O+=i*X,m+=(i=t[12])*x,y+=i*M,C+=i*F,S+=i*k,E+=i*V,_+=i*H,T+=i*j,A+=i*G,I+=i*W,D+=i*Y,w+=i*q,b+=i*K,U+=i*$,R+=i*z,O+=i*Q,N+=i*X,y+=(i=t[13])*x,C+=i*M,S+=i*F,E+=i*k,_+=i*V,T+=i*H,A+=i*j,I+=i*G,D+=i*W,w+=i*Y,b+=i*q,U+=i*K,R+=i*$,O+=i*z,N+=i*Q,P+=i*X,C+=(i=t[14])*x,S+=i*M,E+=i*F,_+=i*k,T+=i*V,A+=i*H,I+=i*j,D+=i*G,w+=i*W,b+=i*Y,U+=i*q,R+=i*K,O+=i*$,N+=i*z,P+=i*Q,B+=i*X,S+=(i=t[15])*x,o+=38*(_+=i*F),s+=38*(T+=i*k),c+=38*(A+=i*V),u+=38*(I+=i*H),l+=38*(D+=i*j),h+=38*(w+=i*G),d+=38*(b+=i*W),p+=38*(U+=i*Y),f+=38*(R+=i*q),v+=38*(O+=i*K),g+=38*(N+=i*$),m+=38*(P+=i*z),y+=38*(B+=i*Q),C+=38*(L+=i*X),a=(i=(a+=38*(E+=i*M))+(n=1)+65535)-65536*(n=Math.floor(i/65536)),o=(i=o+n+65535)-65536*(n=Math.floor(i/65536)),s=(i=s+n+65535)-65536*(n=Math.floor(i/65536)),c=(i=c+n+65535)-65536*(n=Math.floor(i/65536)),u=(i=u+n+65535)-65536*(n=Math.floor(i/65536)),l=(i=l+n+65535)-65536*(n=Math.floor(i/65536)),h=(i=h+n+65535)-65536*(n=Math.floor(i/65536)),d=(i=d+n+65535)-65536*(n=Math.floor(i/65536)),p=(i=p+n+65535)-65536*(n=Math.floor(i/65536)),f=(i=f+n+65535)-65536*(n=Math.floor(i/65536)),v=(i=v+n+65535)-65536*(n=Math.floor(i/65536)),g=(i=g+n+65535)-65536*(n=Math.floor(i/65536)),m=(i=m+n+65535)-65536*(n=Math.floor(i/65536)),y=(i=y+n+65535)-65536*(n=Math.floor(i/65536)),C=(i=C+n+65535)-65536*(n=Math.floor(i/65536)),S=(i=S+n+65535)-65536*(n=Math.floor(i/65536)),a=(i=(a+=n-1+37*(n-1))+(n=1)+65535)-65536*(n=Math.floor(i/65536)),o=(i=o+n+65535)-65536*(n=Math.floor(i/65536)),s=(i=s+n+65535)-65536*(n=Math.floor(i/65536)),c=(i=c+n+65535)-65536*(n=Math.floor(i/65536)),u=(i=u+n+65535)-65536*(n=Math.floor(i/65536)),l=(i=l+n+65535)-65536*(n=Math.floor(i/65536)),h=(i=h+n+65535)-65536*(n=Math.floor(i/65536)),d=(i=d+n+65535)-65536*(n=Math.floor(i/65536)),p=(i=p+n+65535)-65536*(n=Math.floor(i/65536)),f=(i=f+n+65535)-65536*(n=Math.floor(i/65536)),v=(i=v+n+65535)-65536*(n=Math.floor(i/65536)),g=(i=g+n+65535)-65536*(n=Math.floor(i/65536)),m=(i=m+n+65535)-65536*(n=Math.floor(i/65536)),y=(i=y+n+65535)-65536*(n=Math.floor(i/65536)),C=(i=C+n+65535)-65536*(n=Math.floor(i/65536)),S=(i=S+n+65535)-65536*(n=Math.floor(i/65536)),a+=n-1+37*(n-1),e[0]=a,e[1]=o,e[2]=s,e[3]=c,e[4]=u,e[5]=l,e[6]=h,e[7]=d,e[8]=p,e[9]=f,e[10]=v,e[11]=g,e[12]=m,e[13]=y,e[14]=C,e[15]=S}function V(e,t){k(e,t,t)}function H(e,r){var i,n=t();for(i=0;i<16;i++)n[i]=r[i];for(i=253;i>=0;i--)V(n,n),2!==i&&4!==i&&k(n,n,r);for(i=0;i<16;i++)e[i]=n[i]}function j(e,r){var i,n=t();for(i=0;i<16;i++)n[i]=r[i];for(i=250;i>=0;i--)V(n,n),1!==i&&k(n,n,r);for(i=0;i<16;i++)e[i]=n[i]}function G(e,r,i){var n,a,o=new Uint8Array(32),s=new Float64Array(80),u=t(),l=t(),h=t(),d=t(),p=t(),f=t();for(a=0;a<31;a++)o[a]=r[a];for(o[31]=127&r[31]|64,o[0]&=248,x(s,i),a=0;a<16;a++)l[a]=s[a],d[a]=u[a]=h[a]=0;for(u[0]=d[0]=1,a=254;a>=0;--a)N(u,l,n=o[a>>>3]>>>(7&a)&1),N(h,d,n),M(p,u,h),F(u,u,h),M(h,l,d),F(l,l,d),V(d,p),V(f,u),k(u,h,u),k(h,l,p),M(p,u,h),F(u,u,h),V(l,u),F(h,d,f),k(u,h,c),M(u,u,d),k(h,h,u),k(u,d,f),k(d,l,s),V(l,p),N(u,l,n),N(h,d,n);for(a=0;a<16;a++)s[a+16]=u[a],s[a+32]=h[a],s[a+48]=l[a],s[a+64]=d[a];var v=s.subarray(32),g=s.subarray(16);return H(v,v),k(g,g,v),P(e,g),0}function W(e,t){return G(e,t,a)}function Y(e,t){return i(t,32),W(e,t)}function q(e,t,r){var i=new Uint8Array(32);return G(i,r,t),C(e,n,i,S)}I.prototype.blocks=function(e,t,r){for(var i,n,a,o,s,c,u,l,h,d,p,f,v,g,m,y,C,S,E,_=this.fin?0:2048,T=this.h[0],A=this.h[1],I=this.h[2],D=this.h[3],w=this.h[4],b=this.h[5],U=this.h[6],R=this.h[7],O=this.h[8],N=this.h[9],P=this.r[0],B=this.r[1],L=this.r[2],x=this.r[3],M=this.r[4],F=this.r[5],k=this.r[6],V=this.r[7],H=this.r[8],j=this.r[9];r>=16;)d=h=0,d+=(T+=8191&(i=255&e[t+0]|(255&e[t+1])<<8))*P,d+=(A+=8191&(i>>>13|(n=255&e[t+2]|(255&e[t+3])<<8)<<3))*(5*j),d+=(I+=8191&(n>>>10|(a=255&e[t+4]|(255&e[t+5])<<8)<<6))*(5*H),d+=(D+=8191&(a>>>7|(o=255&e[t+6]|(255&e[t+7])<<8)<<9))*(5*V),h=(d+=(w+=8191&(o>>>4|(s=255&e[t+8]|(255&e[t+9])<<8)<<12))*(5*k))>>>13,d&=8191,d+=(b+=s>>>1&8191)*(5*F),d+=(U+=8191&(s>>>14|(c=255&e[t+10]|(255&e[t+11])<<8)<<2))*(5*M),d+=(R+=8191&(c>>>11|(u=255&e[t+12]|(255&e[t+13])<<8)<<5))*(5*x),d+=(O+=8191&(u>>>8|(l=255&e[t+14]|(255&e[t+15])<<8)<<8))*(5*L),p=h+=(d+=(N+=l>>>5|_)*(5*B))>>>13,p+=T*B,p+=A*P,p+=I*(5*j),p+=D*(5*H),h=(p+=w*(5*V))>>>13,p&=8191,p+=b*(5*k),p+=U*(5*F),p+=R*(5*M),p+=O*(5*x),h+=(p+=N*(5*L))>>>13,p&=8191,f=h,f+=T*L,f+=A*B,f+=I*P,f+=D*(5*j),h=(f+=w*(5*H))>>>13,f&=8191,f+=b*(5*V),f+=U*(5*k),f+=R*(5*F),f+=O*(5*M),v=h+=(f+=N*(5*x))>>>13,v+=T*x,v+=A*L,v+=I*B,v+=D*P,h=(v+=w*(5*j))>>>13,v&=8191,v+=b*(5*H),v+=U*(5*V),v+=R*(5*k),v+=O*(5*F),g=h+=(v+=N*(5*M))>>>13,g+=T*M,g+=A*x,g+=I*L,g+=D*B,h=(g+=w*P)>>>13,g&=8191,g+=b*(5*j),g+=U*(5*H),g+=R*(5*V),g+=O*(5*k),m=h+=(g+=N*(5*F))>>>13,m+=T*F,m+=A*M,m+=I*x,m+=D*L,h=(m+=w*B)>>>13,m&=8191,m+=b*P,m+=U*(5*j),m+=R*(5*H),m+=O*(5*V),y=h+=(m+=N*(5*k))>>>13,y+=T*k,y+=A*F,y+=I*M,y+=D*x,h=(y+=w*L)>>>13,y&=8191,y+=b*B,y+=U*P,y+=R*(5*j),y+=O*(5*H),C=h+=(y+=N*(5*V))>>>13,C+=T*V,C+=A*k,C+=I*F,C+=D*M,h=(C+=w*x)>>>13,C&=8191,C+=b*L,C+=U*B,C+=R*P,C+=O*(5*j),S=h+=(C+=N*(5*H))>>>13,S+=T*H,S+=A*V,S+=I*k,S+=D*F,h=(S+=w*M)>>>13,S&=8191,S+=b*x,S+=U*L,S+=R*B,S+=O*P,E=h+=(S+=N*(5*j))>>>13,E+=T*j,E+=A*H,E+=I*V,E+=D*k,h=(E+=w*F)>>>13,E&=8191,E+=b*M,E+=U*x,E+=R*L,E+=O*B,T=d=8191&(h=(h=((h+=(E+=N*P)>>>13)<<2)+h|0)+(d&=8191)|0),A=p+=h>>>=13,I=f&=8191,D=v&=8191,w=g&=8191,b=m&=8191,U=y&=8191,R=C&=8191,O=S&=8191,N=E&=8191,t+=16,r-=16;this.h[0]=T,this.h[1]=A,this.h[2]=I,this.h[3]=D,this.h[4]=w,this.h[5]=b,this.h[6]=U,this.h[7]=R,this.h[8]=O,this.h[9]=N},I.prototype.finish=function(e,t){var r,i,n,a,o=new Uint16Array(10);if(this.leftover){for(a=this.leftover,this.buffer[a++]=1;a<16;a++)this.buffer[a]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(r=this.h[1]>>>13,this.h[1]&=8191,a=2;a<10;a++)this.h[a]+=r,r=this.h[a]>>>13,this.h[a]&=8191;for(this.h[0]+=5*r,r=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=r,r=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=r,o[0]=this.h[0]+5,r=o[0]>>>13,o[0]&=8191,a=1;a<10;a++)o[a]=this.h[a]+r,r=o[a]>>>13,o[a]&=8191;for(o[9]-=8192,i=(1^r)-1,a=0;a<10;a++)o[a]&=i;for(i=~i,a=0;a<10;a++)this.h[a]=this.h[a]&i|o[a];for(this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5),n=this.h[0]+this.pad[0],this.h[0]=65535&n,a=1;a<8;a++)n=(this.h[a]+this.pad[a]|0)+(n>>>16)|0,this.h[a]=65535&n;e[t+0]=this.h[0]>>>0&255,e[t+1]=this.h[0]>>>8&255,e[t+2]=this.h[1]>>>0&255,e[t+3]=this.h[1]>>>8&255,e[t+4]=this.h[2]>>>0&255,e[t+5]=this.h[2]>>>8&255,e[t+6]=this.h[3]>>>0&255,e[t+7]=this.h[3]>>>8&255,e[t+8]=this.h[4]>>>0&255,e[t+9]=this.h[4]>>>8&255,e[t+10]=this.h[5]>>>0&255,e[t+11]=this.h[5]>>>8&255,e[t+12]=this.h[6]>>>0&255,e[t+13]=this.h[6]>>>8&255,e[t+14]=this.h[7]>>>0&255,e[t+15]=this.h[7]>>>8&255},I.prototype.update=function(e,t,r){var i,n;if(this.leftover){for((n=16-this.leftover)>r&&(n=r),i=0;i<n;i++)this.buffer[this.leftover+i]=e[t+i];if(r-=n,t+=n,this.leftover+=n,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(r>=16&&(n=r-r%16,this.blocks(e,t,n),t+=n,r-=n),r){for(i=0;i<r;i++)this.buffer[this.leftover+i]=e[t+i];this.leftover+=r}};var K=b,$=U;var z=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Q(e,t,r,i){for(var n,a,o,s,c,u,l,h,d,p,f,v,g,m,y,C,S,E,_,T,A,I,D,w,b,U,R=new Int32Array(16),O=new Int32Array(16),N=e[0],P=e[1],B=e[2],L=e[3],x=e[4],M=e[5],F=e[6],k=e[7],V=t[0],H=t[1],j=t[2],G=t[3],W=t[4],Y=t[5],q=t[6],K=t[7],$=0;i>=128;){for(_=0;_<16;_++)T=8*_+$,R[_]=r[T+0]<<24|r[T+1]<<16|r[T+2]<<8|r[T+3],O[_]=r[T+4]<<24|r[T+5]<<16|r[T+6]<<8|r[T+7];for(_=0;_<80;_++)if(n=N,a=P,o=B,s=L,c=x,u=M,l=F,k,d=V,p=H,f=j,v=G,g=W,m=Y,y=q,K,D=65535&(I=K),w=I>>>16,b=65535&(A=k),U=A>>>16,D+=65535&(I=(W>>>14|x<<18)^(W>>>18|x<<14)^(x>>>9|W<<23)),w+=I>>>16,b+=65535&(A=(x>>>14|W<<18)^(x>>>18|W<<14)^(W>>>9|x<<23)),U+=A>>>16,D+=65535&(I=W&Y^~W&q),w+=I>>>16,b+=65535&(A=x&M^~x&F),U+=A>>>16,A=z[2*_],D+=65535&(I=z[2*_+1]),w+=I>>>16,b+=65535&A,U+=A>>>16,A=R[_%16],w+=(I=O[_%16])>>>16,b+=65535&A,U+=A>>>16,b+=(w+=(D+=65535&I)>>>16)>>>16,D=65535&(I=E=65535&D|w<<16),w=I>>>16,b=65535&(A=S=65535&b|(U+=b>>>16)<<16),U=A>>>16,D+=65535&(I=(V>>>28|N<<4)^(N>>>2|V<<30)^(N>>>7|V<<25)),w+=I>>>16,b+=65535&(A=(N>>>28|V<<4)^(V>>>2|N<<30)^(V>>>7|N<<25)),U+=A>>>16,w+=(I=V&H^V&j^H&j)>>>16,b+=65535&(A=N&P^N&B^P&B),U+=A>>>16,h=65535&(b+=(w+=(D+=65535&I)>>>16)>>>16)|(U+=b>>>16)<<16,C=65535&D|w<<16,D=65535&(I=v),w=I>>>16,b=65535&(A=s),U=A>>>16,w+=(I=E)>>>16,b+=65535&(A=S),U+=A>>>16,P=n,B=a,L=o,x=s=65535&(b+=(w+=(D+=65535&I)>>>16)>>>16)|(U+=b>>>16)<<16,M=c,F=u,k=l,N=h,H=d,j=p,G=f,W=v=65535&D|w<<16,Y=g,q=m,K=y,V=C,_%16==15)for(T=0;T<16;T++)A=R[T],D=65535&(I=O[T]),w=I>>>16,b=65535&A,U=A>>>16,A=R[(T+9)%16],D+=65535&(I=O[(T+9)%16]),w+=I>>>16,b+=65535&A,U+=A>>>16,S=R[(T+1)%16],D+=65535&(I=((E=O[(T+1)%16])>>>1|S<<31)^(E>>>8|S<<24)^(E>>>7|S<<25)),w+=I>>>16,b+=65535&(A=(S>>>1|E<<31)^(S>>>8|E<<24)^S>>>7),U+=A>>>16,S=R[(T+14)%16],w+=(I=((E=O[(T+14)%16])>>>19|S<<13)^(S>>>29|E<<3)^(E>>>6|S<<26))>>>16,b+=65535&(A=(S>>>19|E<<13)^(E>>>29|S<<3)^S>>>6),U+=A>>>16,U+=(b+=(w+=(D+=65535&I)>>>16)>>>16)>>>16,R[T]=65535&b|U<<16,O[T]=65535&D|w<<16;D=65535&(I=V),w=I>>>16,b=65535&(A=N),U=A>>>16,A=e[0],w+=(I=t[0])>>>16,b+=65535&A,U+=A>>>16,U+=(b+=(w+=(D+=65535&I)>>>16)>>>16)>>>16,e[0]=N=65535&b|U<<16,t[0]=V=65535&D|w<<16,D=65535&(I=H),w=I>>>16,b=65535&(A=P),U=A>>>16,A=e[1],w+=(I=t[1])>>>16,b+=65535&A,U+=A>>>16,U+=(b+=(w+=(D+=65535&I)>>>16)>>>16)>>>16,e[1]=P=65535&b|U<<16,t[1]=H=65535&D|w<<16,D=65535&(I=j),w=I>>>16,b=65535&(A=B),U=A>>>16,A=e[2],w+=(I=t[2])>>>16,b+=65535&A,U+=A>>>16,U+=(b+=(w+=(D+=65535&I)>>>16)>>>16)>>>16,e[2]=B=65535&b|U<<16,t[2]=j=65535&D|w<<16,D=65535&(I=G),w=I>>>16,b=65535&(A=L),U=A>>>16,A=e[3],w+=(I=t[3])>>>16,b+=65535&A,U+=A>>>16,U+=(b+=(w+=(D+=65535&I)>>>16)>>>16)>>>16,e[3]=L=65535&b|U<<16,t[3]=G=65535&D|w<<16,D=65535&(I=W),w=I>>>16,b=65535&(A=x),U=A>>>16,A=e[4],w+=(I=t[4])>>>16,b+=65535&A,U+=A>>>16,U+=(b+=(w+=(D+=65535&I)>>>16)>>>16)>>>16,e[4]=x=65535&b|U<<16,t[4]=W=65535&D|w<<16,D=65535&(I=Y),w=I>>>16,b=65535&(A=M),U=A>>>16,A=e[5],w+=(I=t[5])>>>16,b+=65535&A,U+=A>>>16,U+=(b+=(w+=(D+=65535&I)>>>16)>>>16)>>>16,e[5]=M=65535&b|U<<16,t[5]=Y=65535&D|w<<16,D=65535&(I=q),w=I>>>16,b=65535&(A=F),U=A>>>16,A=e[6],w+=(I=t[6])>>>16,b+=65535&A,U+=A>>>16,U+=(b+=(w+=(D+=65535&I)>>>16)>>>16)>>>16,e[6]=F=65535&b|U<<16,t[6]=q=65535&D|w<<16,D=65535&(I=K),w=I>>>16,b=65535&(A=k),U=A>>>16,A=e[7],w+=(I=t[7])>>>16,b+=65535&A,U+=A>>>16,U+=(b+=(w+=(D+=65535&I)>>>16)>>>16)>>>16,e[7]=k=65535&b|U<<16,t[7]=K=65535&D|w<<16,$+=128,i-=128}return i}function X(e,t,r){var i,n=new Int32Array(8),a=new Int32Array(8),o=new Uint8Array(256),s=r;for(n[0]=1779033703,n[1]=3144134277,n[2]=1013904242,n[3]=2773480762,n[4]=1359893119,n[5]=2600822924,n[6]=528734635,n[7]=1541459225,a[0]=4089235720,a[1]=2227873595,a[2]=4271175723,a[3]=1595750129,a[4]=2917565137,a[5]=725511199,a[6]=4215389547,a[7]=327033209,Q(n,a,t,r),r%=128,i=0;i<r;i++)o[i]=t[s-r+i];for(o[r]=128,o[(r=256-128*(r<112?1:0))-9]=0,f(o,r-8,s/536870912|0,s<<3),Q(n,a,o,r),i=0;i<8;i++)f(e,8*i,n[i],a[i]);return 0}function J(e,r){var i=t(),n=t(),a=t(),o=t(),s=t(),c=t(),u=t(),h=t(),d=t();F(i,e[1],e[0]),F(d,r[1],r[0]),k(i,i,d),M(n,e[0],e[1]),M(d,r[0],r[1]),k(n,n,d),k(a,e[3],r[3]),k(a,a,l),k(o,e[2],r[2]),M(o,o,o),F(s,n,i),F(c,o,a),M(u,o,a),M(h,n,i),k(e[0],s,c),k(e[1],h,u),k(e[2],u,c),k(e[3],s,h)}function Z(e,t,r){var i;for(i=0;i<4;i++)N(e[i],t[i],r)}function ee(e,r){var i=t(),n=t(),a=t();H(a,r[2]),k(i,r[0],a),k(n,r[1],a),P(e,n),e[31]^=L(i)<<7}function te(e,t,r){var i,n;for(R(e[0],o),R(e[1],s),R(e[2],s),R(e[3],o),n=255;n>=0;--n)Z(e,t,i=r[n/8|0]>>(7&n)&1),J(t,e),J(e,e),Z(e,t,i)}function re(e,r){var i=[t(),t(),t(),t()];R(i[0],h),R(i[1],d),R(i[2],s),k(i[3],h,d),te(e,i,r)}function ie(e,r,n){var a,o=new Uint8Array(64),s=[t(),t(),t(),t()];for(n||i(r,32),X(o,r,32),o[0]&=248,o[31]&=127,o[31]|=64,re(s,o),ee(e,s),a=0;a<32;a++)r[a+32]=e[a];return 0}var ne=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function ae(e,t){var r,i,n,a;for(i=63;i>=32;--i){for(r=0,n=i-32,a=i-12;n<a;++n)t[n]+=r-16*t[i]*ne[n-(i-32)],r=Math.floor((t[n]+128)/256),t[n]-=256*r;t[n]+=r,t[i]=0}for(r=0,n=0;n<32;n++)t[n]+=r-(t[31]>>4)*ne[n],r=t[n]>>8,t[n]&=255;for(n=0;n<32;n++)t[n]-=r*ne[n];for(i=0;i<32;i++)t[i+1]+=t[i]>>8,e[i]=255&t[i]}function oe(e){var t,r=new Float64Array(64);for(t=0;t<64;t++)r[t]=e[t];for(t=0;t<64;t++)e[t]=0;ae(e,r)}function se(e,r,i,n){var a,o,s=new Uint8Array(64),c=new Uint8Array(64),u=new Uint8Array(64),l=new Float64Array(64),h=[t(),t(),t(),t()];X(s,n,32),s[0]&=248,s[31]&=127,s[31]|=64;var d=i+64;for(a=0;a<i;a++)e[64+a]=r[a];for(a=0;a<32;a++)e[32+a]=s[32+a];for(X(u,e.subarray(32),i+32),oe(u),re(h,u),ee(e,h),a=32;a<64;a++)e[a]=n[a];for(X(c,e,i+64),oe(c),a=0;a<64;a++)l[a]=0;for(a=0;a<32;a++)l[a]=u[a];for(a=0;a<32;a++)for(o=0;o<32;o++)l[a+o]+=c[a]*s[o];return ae(e.subarray(32),l),d}function ce(e,r,i,n){var a,c=new Uint8Array(32),l=new Uint8Array(64),h=[t(),t(),t(),t()],d=[t(),t(),t(),t()];if(i<64)return-1;if(function(e,r){var i=t(),n=t(),a=t(),c=t(),l=t(),h=t(),d=t();return R(e[2],s),x(e[1],r),V(a,e[1]),k(c,a,u),F(a,a,e[2]),M(c,e[2],c),V(l,c),V(h,l),k(d,h,l),k(i,d,a),k(i,i,c),j(i,i),k(i,i,a),k(i,i,c),k(i,i,c),k(e[0],i,c),V(n,e[0]),k(n,n,c),B(n,a)&&k(e[0],e[0],p),V(n,e[0]),k(n,n,c),B(n,a)?-1:(L(e[0])===r[31]>>7&&F(e[0],o,e[0]),k(e[3],e[0],e[1]),0)}(d,n))return-1;for(a=0;a<i;a++)e[a]=r[a];for(a=0;a<32;a++)e[a+32]=n[a];if(X(l,e,i),oe(l),te(h,d,l),re(d,r.subarray(32)),J(h,d),ee(c,h),i-=64,m(r,0,c,0)){for(a=0;a<i;a++)e[a]=0;return-1}for(a=0;a<i;a++)e[a]=r[a+64];return i}var ue=16,le=64,he=32,de=64;function pe(e,t){if(32!==e.length)throw new Error("bad key size");if(24!==t.length)throw new Error("bad nonce size")}function fe(){for(var e=0;e<arguments.length;e++)if(!(arguments[e]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function ve(e){for(var t=0;t<e.length;t++)e[t]=0}e.lowlevel={crypto_core_hsalsa20:C,crypto_stream_xor:A,crypto_stream:T,crypto_stream_salsa20_xor:E,crypto_stream_salsa20:_,crypto_onetimeauth:D,crypto_onetimeauth_verify:w,crypto_verify_16:g,crypto_verify_32:m,crypto_secretbox:b,crypto_secretbox_open:U,crypto_scalarmult:G,crypto_scalarmult_base:W,crypto_box_beforenm:q,crypto_box_afternm:K,crypto_box:function(e,t,r,i,n,a){var o=new Uint8Array(32);return q(o,n,a),K(e,t,r,i,o)},crypto_box_open:function(e,t,r,i,n,a){var o=new Uint8Array(32);return q(o,n,a),$(e,t,r,i,o)},crypto_box_keypair:Y,crypto_hash:X,crypto_sign:se,crypto_sign_keypair:ie,crypto_sign_open:ce,crypto_secretbox_KEYBYTES:32,crypto_secretbox_NONCEBYTES:24,crypto_secretbox_ZEROBYTES:32,crypto_secretbox_BOXZEROBYTES:ue,crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32,crypto_box_PUBLICKEYBYTES:32,crypto_box_SECRETKEYBYTES:32,crypto_box_BEFORENMBYTES:32,crypto_box_NONCEBYTES:24,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_sign_BYTES:le,crypto_sign_PUBLICKEYBYTES:he,crypto_sign_SECRETKEYBYTES:de,crypto_sign_SEEDBYTES:32,crypto_hash_BYTES:64,gf:t,D:u,L:ne,pack25519:P,unpack25519:x,M:k,A:M,S:V,Z:F,pow2523:j,add:J,set25519:R,modL:ae,scalarmult:te,scalarbase:re},e.randomBytes=function(e){var t=new Uint8Array(e);return i(t,e),t},e.secretbox=function(e,t,r){fe(e,t,r),pe(r,t);for(var i=new Uint8Array(32+e.length),n=new Uint8Array(i.length),a=0;a<e.length;a++)i[a+32]=e[a];return b(n,i,i.length,t,r),n.subarray(ue)},e.secretbox.open=function(e,t,r){fe(e,t,r),pe(r,t);for(var i=new Uint8Array(ue+e.length),n=new Uint8Array(i.length),a=0;a<e.length;a++)i[a+ue]=e[a];return i.length<32||0!==U(n,i,i.length,t,r)?null:n.subarray(32)},e.secretbox.keyLength=32,e.secretbox.nonceLength=24,e.secretbox.overheadLength=ue,e.scalarMult=function(e,t){if(fe(e,t),32!==e.length)throw new Error("bad n size");if(32!==t.length)throw new Error("bad p size");var r=new Uint8Array(32);return G(r,e,t),r},e.scalarMult.base=function(e){if(fe(e),32!==e.length)throw new Error("bad n size");var t=new Uint8Array(32);return W(t,e),t},e.scalarMult.scalarLength=32,e.scalarMult.groupElementLength=32,e.box=function(t,r,i,n){var a=e.box.before(i,n);return e.secretbox(t,r,a)},e.box.before=function(e,t){fe(e,t),function(e,t){if(32!==e.length)throw new Error("bad public key size");if(32!==t.length)throw new Error("bad secret key size")}(e,t);var r=new Uint8Array(32);return q(r,e,t),r},e.box.after=e.secretbox,e.box.open=function(t,r,i,n){var a=e.box.before(i,n);return e.secretbox.open(t,r,a)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(32);return Y(e,t),{publicKey:e,secretKey:t}},e.box.keyPair.fromSecretKey=function(e){if(fe(e),32!==e.length)throw new Error("bad secret key size");var t=new Uint8Array(32);return W(t,e),{publicKey:t,secretKey:new Uint8Array(e)}},e.box.publicKeyLength=32,e.box.secretKeyLength=32,e.box.sharedKeyLength=32,e.box.nonceLength=24,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(e,t){if(fe(e,t),t.length!==de)throw new Error("bad secret key size");var r=new Uint8Array(le+e.length);return se(r,e,e.length,t),r},e.sign.open=function(e,t){if(fe(e,t),t.length!==he)throw new Error("bad public key size");var r=new Uint8Array(e.length),i=ce(r,e,e.length,t);if(i<0)return null;for(var n=new Uint8Array(i),a=0;a<n.length;a++)n[a]=r[a];return n},e.sign.detached=function(t,r){for(var i=e.sign(t,r),n=new Uint8Array(le),a=0;a<n.length;a++)n[a]=i[a];return n},e.sign.detached.verify=function(e,t,r){if(fe(e,t,r),t.length!==le)throw new Error("bad signature size");if(r.length!==he)throw new Error("bad public key size");var i,n=new Uint8Array(le+e.length),a=new Uint8Array(le+e.length);for(i=0;i<le;i++)n[i]=t[i];for(i=0;i<e.length;i++)n[i+le]=e[i];return ce(a,n,n.length,r)>=0},e.sign.keyPair=function(){var e=new Uint8Array(he),t=new Uint8Array(de);return ie(e,t),{publicKey:e,secretKey:t}},e.sign.keyPair.fromSecretKey=function(e){if(fe(e),e.length!==de)throw new Error("bad secret key size");for(var t=new Uint8Array(he),r=0;r<t.length;r++)t[r]=e[32+r];return{publicKey:t,secretKey:new Uint8Array(e)}},e.sign.keyPair.fromSeed=function(e){if(fe(e),32!==e.length)throw new Error("bad seed size");for(var t=new Uint8Array(he),r=new Uint8Array(de),i=0;i<32;i++)r[i]=e[i];return ie(t,r,!0),{publicKey:t,secretKey:r}},e.sign.publicKeyLength=he,e.sign.secretKeyLength=de,e.sign.seedLength=32,e.sign.signatureLength=le,e.hash=function(e){fe(e);var t=new Uint8Array(64);return X(t,e,e.length),t},e.hash.hashLength=64,e.verify=function(e,t){return fe(e,t),0!==e.length&&0!==t.length&&(e.length===t.length&&0===v(e,0,t,0,e.length))},e.setPRNG=function(e){i=e},function(){var t="undefined"!=typeof self?self.crypto||self.msCrypto:null;if(t&&t.getRandomValues){e.setPRNG((function(e,r){var i,n=new Uint8Array(r);for(i=0;i<r;i+=65536)t.getRandomValues(n.subarray(i,i+Math.min(r-i,65536)));for(i=0;i<r;i++)e[i]=n[i];ve(n)}))}else(t=r(6982))&&t.randomBytes&&e.setPRNG((function(e,r){var i,n=t.randomBytes(r);for(i=0;i<r;i++)e[i]=n[i];ve(n)}))}()}(e.exports?e.exports:self.nacl=self.nacl||{})},1539:(e,t,r)=>{"use strict";var i=r(4761),n=r(1703),a=r(5128),o=r(3612),s=r(9803);e.exports=function(e){return null==e||"object"!=typeof e&&"function"!=typeof e?null:i(e)?"String":n(e)?"Number":a(e)?"Boolean":o(e)?"Symbol":s(e)?"BigInt":void 0}},593:(e,t,r)=>{"use strict";var i=r(3802),n=r(256),a=r(7842),o=r(2648);e.exports=function(e){if(e&&"object"==typeof e){if(i(e))return"Map";if(n(e))return"Set";if(a(e))return"WeakMap";if(o(e))return"WeakSet"}return!1}},5767:(e,t,r)=>{"use strict";var i=r(2682),n=r(9209),a=r(487),o=r(8075),s=r(5795),c=o("Object.prototype.toString"),u=r(9092)(),l="undefined"==typeof globalThis?global:globalThis,h=n(),d=o("String.prototype.slice"),p=Object.getPrototypeOf,f=o("Array.prototype.indexOf",!0)||function(e,t){for(var r=0;r<e.length;r+=1)if(e[r]===t)return r;return-1},v={__proto__:null};i(h,u&&s&&p?function(e){var t=new l[e];if(Symbol.toStringTag in t){var r=p(t),i=s(r,Symbol.toStringTag);if(!i){var n=p(r);i=s(n,Symbol.toStringTag)}v["$"+e]=a(i.get)}}:function(e){var t=new l[e],r=t.slice||t.set;r&&(v["$"+e]=a(r))});e.exports=function(e){if(!e||"object"!=typeof e)return!1;if(!u){var t=d(c(e),8,-1);return f(h,t)>-1?t:"Object"===t&&function(e){var t=!1;return i(v,(function(r,i){if(!t)try{r(e),t=d(i,1)}catch(e){}})),t}(e)}return s?function(e){var t=!1;return i(v,(function(r,i){if(!t)try{"$"+r(e)===i&&(t=d(i,1))}catch(e){}})),t}(e):null}},3177:function(e,t){(function(){"use strict";t.stripBOM=function(e){return"\ufeff"===e[0]?e.substring(1):e}}).call(this)},6712:function(e,t,r){(function(){"use strict";var e,i,n,a,o,s={}.hasOwnProperty;e=r(2046),i=r(6465).defaults,a=function(e){return"string"==typeof e&&(e.indexOf("&")>=0||e.indexOf(">")>=0||e.indexOf("<")>=0)},o=function(e){return"<![CDATA["+n(e)+"]]>"},n=function(e){return e.replace("]]>","]]]]><![CDATA[>")},t.Builder=function(){function t(e){var t,r,n;for(t in this.options={},r=i[.2])s.call(r,t)&&(n=r[t],this.options[t]=n);for(t in e)s.call(e,t)&&(n=e[t],this.options[t]=n)}return t.prototype.buildObject=function(t){var r,n,c,u,l,h;return r=this.options.attrkey,n=this.options.charkey,1===Object.keys(t).length&&this.options.rootName===i[.2].rootName?t=t[l=Object.keys(t)[0]]:l=this.options.rootName,h=this,c=function(e,t){var i,u,l,d,p,f;if("object"!=typeof t)h.options.cdata&&a(t)?e.raw(o(t)):e.txt(t);else if(Array.isArray(t)){for(d in t)if(s.call(t,d))for(p in u=t[d])l=u[p],e=c(e.ele(p),l).up()}else for(p in t)if(s.call(t,p))if(u=t[p],p===r){if("object"==typeof u)for(i in u)f=u[i],e=e.att(i,f)}else if(p===n)e=h.options.cdata&&a(u)?e.raw(o(u)):e.txt(u);else if(Array.isArray(u))for(d in u)s.call(u,d)&&(e="string"==typeof(l=u[d])?h.options.cdata&&a(l)?e.ele(p).raw(o(l)).up():e.ele(p,l).up():c(e.ele(p),l).up());else"object"==typeof u?e=c(e.ele(p),u).up():"string"==typeof u&&h.options.cdata&&a(u)?e=e.ele(p).raw(o(u)).up():(null==u&&(u=""),e=e.ele(p,u.toString()).up());return e},u=e.create(l,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),c(u,t).end(this.options.renderOpts)},t}()}).call(this)},6465:function(e,t){(function(){t.defaults={.1:{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},.2:{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:"\n"},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}}}).call(this)},1912:function(e,t,r){(function(){"use strict";var e,i,n,a,o,s,c,u,l,h=function(e,t){return function(){return e.apply(t,arguments)}},d={}.hasOwnProperty;u=r(4043),a=r(4434),e=r(3177),c=r(2114),l=r(3557).setImmediate,i=r(6465).defaults,o=function(e){return"object"==typeof e&&null!=e&&0===Object.keys(e).length},s=function(e,t,r){var i,n;for(i=0,n=e.length;i<n;i++)t=(0,e[i])(t,r);return t},n=function(e,t,r){var i;return(i=Object.create(null)).value=r,i.writable=!0,i.enumerable=!0,i.configurable=!0,Object.defineProperty(e,t,i)},t.Parser=function(r){function a(e){var r,n,a;if(this.parseStringPromise=h(this.parseStringPromise,this),this.parseString=h(this.parseString,this),this.reset=h(this.reset,this),this.assignOrPush=h(this.assignOrPush,this),this.processAsync=h(this.processAsync,this),!(this instanceof t.Parser))return new t.Parser(e);for(r in this.options={},n=i[.2])d.call(n,r)&&(a=n[r],this.options[r]=a);for(r in e)d.call(e,r)&&(a=e[r],this.options[r]=a);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(c.normalize)),this.reset()}return function(e,t){for(var r in t)d.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(a,r),a.prototype.processAsync=function(){var e,t;try{return this.remaining.length<=this.options.chunkSize?(e=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(e),this.saxParser.close()):(e=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(e),l(this.processAsync))}catch(e){if(t=e,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(t)}},a.prototype.assignOrPush=function(e,t,r){return t in e?(e[t]instanceof Array||n(e,t,[e[t]]),e[t].push(r)):this.options.explicitArray?n(e,t,[r]):n(e,t,r)},a.prototype.reset=function(){var e,t,r,i,a;return this.removeAllListeners(),this.saxParser=u.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=(a=this,function(e){if(a.saxParser.resume(),!a.saxParser.errThrown)return a.saxParser.errThrown=!0,a.emit("error",e)}),this.saxParser.onend=function(e){return function(){if(!e.saxParser.ended)return e.saxParser.ended=!0,e.emit("end",e.resultObject)}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,i=[],e=this.options.attrkey,t=this.options.charkey,this.saxParser.onopentag=function(r){return function(a){var o,c,u,l,h;if((u={})[t]="",!r.options.ignoreAttrs)for(o in h=a.attributes)d.call(h,o)&&(e in u||r.options.mergeAttrs||(u[e]={}),c=r.options.attrValueProcessors?s(r.options.attrValueProcessors,a.attributes[o],o):a.attributes[o],l=r.options.attrNameProcessors?s(r.options.attrNameProcessors,o):o,r.options.mergeAttrs?r.assignOrPush(u,l,c):n(u[e],l,c));return u["#name"]=r.options.tagNameProcessors?s(r.options.tagNameProcessors,a.name):a.name,r.options.xmlns&&(u[r.options.xmlnskey]={uri:a.uri,local:a.local}),i.push(u)}}(this),this.saxParser.onclosetag=function(e){return function(){var r,a,c,u,l,h,p,f,v,g;if(h=i.pop(),l=h["#name"],e.options.explicitChildren&&e.options.preserveChildrenOrder||delete h["#name"],!0===h.cdata&&(r=h.cdata,delete h.cdata),v=i[i.length-1],h[t].match(/^\s*$/)&&!r?(a=h[t],delete h[t]):(e.options.trim&&(h[t]=h[t].trim()),e.options.normalize&&(h[t]=h[t].replace(/\s{2,}/g," ").trim()),h[t]=e.options.valueProcessors?s(e.options.valueProcessors,h[t],l):h[t],1===Object.keys(h).length&&t in h&&!e.EXPLICIT_CHARKEY&&(h=h[t])),o(h)&&(h="function"==typeof e.options.emptyTag?e.options.emptyTag():""!==e.options.emptyTag?e.options.emptyTag:a),null!=e.options.validator&&(g="/"+function(){var e,t,r;for(r=[],e=0,t=i.length;e<t;e++)u=i[e],r.push(u["#name"]);return r}().concat(l).join("/"),function(){var t;try{return h=e.options.validator(g,v&&v[l],h)}catch(r){return t=r,e.emit("error",t)}}()),e.options.explicitChildren&&!e.options.mergeAttrs&&"object"==typeof h)if(e.options.preserveChildrenOrder){if(v){for(c in v[e.options.childkey]=v[e.options.childkey]||[],p={},h)d.call(h,c)&&n(p,c,h[c]);v[e.options.childkey].push(p),delete h["#name"],1===Object.keys(h).length&&t in h&&!e.EXPLICIT_CHARKEY&&(h=h[t])}}else u={},e.options.attrkey in h&&(u[e.options.attrkey]=h[e.options.attrkey],delete h[e.options.attrkey]),!e.options.charsAsChildren&&e.options.charkey in h&&(u[e.options.charkey]=h[e.options.charkey],delete h[e.options.charkey]),Object.getOwnPropertyNames(h).length>0&&(u[e.options.childkey]=h),h=u;return i.length>0?e.assignOrPush(v,l,h):(e.options.explicitRoot&&(f=h,n(h={},l,f)),e.resultObject=h,e.saxParser.ended=!0,e.emit("end",e.resultObject))}}(this),r=function(e){return function(r){var n,a;if(a=i[i.length-1])return a[t]+=r,e.options.explicitChildren&&e.options.preserveChildrenOrder&&e.options.charsAsChildren&&(e.options.includeWhiteChars||""!==r.replace(/\\n/g,"").trim())&&(a[e.options.childkey]=a[e.options.childkey]||[],(n={"#name":"__text__"})[t]=r,e.options.normalize&&(n[t]=n[t].replace(/\s{2,}/g," ").trim()),a[e.options.childkey].push(n)),a}}(this),this.saxParser.ontext=r,this.saxParser.oncdata=function(e){var t;if(t=r(e))return t.cdata=!0}},a.prototype.parseString=function(t,r){var i;null!=r&&"function"==typeof r&&(this.on("end",(function(e){return this.reset(),r(null,e)})),this.on("error",(function(e){return this.reset(),r(e)})));try{return""===(t=t.toString()).trim()?(this.emit("end",null),!0):(t=e.stripBOM(t),this.options.async?(this.remaining=t,l(this.processAsync),this.saxParser):this.saxParser.write(t).close())}catch(e){if(i=e,!this.saxParser.errThrown&&!this.saxParser.ended)return this.emit("error",i),this.saxParser.errThrown=!0;if(this.saxParser.ended)throw i}},a.prototype.parseStringPromise=function(e){return new Promise((t=this,function(r,i){return t.parseString(e,(function(e,t){return e?i(e):r(t)}))}));var t},a}(a),t.parseString=function(e,r,i){var n,a;return null!=i?("function"==typeof i&&(n=i),"object"==typeof r&&(a=r)):("function"==typeof r&&(n=r),a={}),new t.Parser(a).parseString(e,n)},t.parseStringPromise=function(e,r){var i;return"object"==typeof r&&(i=r),new t.Parser(i).parseStringPromise(e)}}).call(this)},2114:function(e,t){(function(){"use strict";var e;e=new RegExp(/(?!xmlns)^.*:/),t.normalize=function(e){return e.toLowerCase()},t.firstCharLowerCase=function(e){return e.charAt(0).toLowerCase()+e.slice(1)},t.stripPrefix=function(t){return t.replace(e,"")},t.parseNumbers=function(e){return isNaN(e)||(e=e%1==0?parseInt(e,10):parseFloat(e)),e},t.parseBooleans=function(e){return/^(?:true|false)$/i.test(e)&&(e="true"===e.toLowerCase()),e}}).call(this)},8805:function(e,t,r){(function(){"use strict";var e,i,n,a,o={}.hasOwnProperty;i=r(6465),e=r(6712),n=r(1912),a=r(2114),t.defaults=i.defaults,t.processors=a,t.ValidationError=function(e){function t(e){this.message=e}return function(e,t){for(var r in t)o.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,Error),t}(),t.Builder=e.Builder,t.Parser=n.Parser,t.parseString=n.parseString,t.parseStringPromise=n.parseStringPromise}).call(this)},4923:function(e){(function(){e.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(this)},1737:function(e){(function(){e.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(this)},9241:function(e){(function(){var t,r,i,n,a,o,s,c=[].slice,u={}.hasOwnProperty;t=function(){var e,t,r,i,n,o;if(o=arguments[0],n=2<=arguments.length?c.call(arguments,1):[],a(Object.assign))Object.assign.apply(null,arguments);else for(e=0,r=n.length;e<r;e++)if(null!=(i=n[e]))for(t in i)u.call(i,t)&&(o[t]=i[t]);return o},a=function(e){return!!e&&"[object Function]"===Object.prototype.toString.call(e)},o=function(e){var t;return!!e&&("function"==(t=typeof e)||"object"===t)},i=function(e){return a(Array.isArray)?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)},n=function(e){var t;if(i(e))return!e.length;for(t in e)if(u.call(e,t))return!1;return!0},s=function(e){var t,r;return o(e)&&(r=Object.getPrototypeOf(e))&&(t=r.constructor)&&"function"==typeof t&&t instanceof t&&Function.prototype.toString.call(t)===Function.prototype.toString.call(Object)},r=function(e){return a(e.valueOf)?e.valueOf():e},e.exports.assign=t,e.exports.isFunction=a,e.exports.isObject=o,e.exports.isArray=i,e.exports.isEmpty=n,e.exports.isPlainObject=s,e.exports.getValue=r}).call(this)},8753:function(e){(function(){e.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(this)},4238:function(e,t,r){(function(){var t;t=r(1737),r(468),e.exports=function(){function e(e,r,i){if(this.parent=e,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),null==r)throw new Error("Missing attribute name. "+this.debugInfo(r));this.name=this.stringify.name(r),this.value=this.stringify.attValue(i),this.type=t.Attribute,this.isId=!1,this.schemaTypeInfo=null}return Object.defineProperty(e.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(e.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(e.prototype,"textContent",{get:function(){return this.value},set:function(e){return this.value=e||""}}),Object.defineProperty(e.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(e.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(e.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(e.prototype,"specified",{get:function(){return!0}}),e.prototype.clone=function(){return Object.create(this)},e.prototype.toString=function(e){return this.options.writer.attribute(this,this.options.writer.filterOptions(e))},e.prototype.debugInfo=function(e){return null==(e=e||this.name)?"parent: <"+this.parent.name+">":"attribute: {"+e+"}, parent: <"+this.parent.name+">"},e.prototype.isEqualNode=function(e){return e.namespaceURI===this.namespaceURI&&(e.prefix===this.prefix&&(e.localName===this.localName&&e.value===this.value))},e}()}).call(this)},2691:function(e,t,r){(function(){var t,i,n={}.hasOwnProperty;t=r(1737),i=r(7457),e.exports=function(e){function r(e,i){if(r.__super__.constructor.call(this,e),null==i)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=t.CData,this.value=this.stringify.cdata(i)}return function(e,t){for(var r in t)n.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(e){return this.options.writer.cdata(this,this.options.writer.filterOptions(e))},r}(i)}).call(this)},7457:function(e,t,r){(function(){var t,i={}.hasOwnProperty;t=r(468),e.exports=function(e){function t(e){t.__super__.constructor.call(this,e),this.value=""}return function(e,t){for(var r in t)i.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this.value},set:function(e){return this.value=e||""}}),Object.defineProperty(t.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(t.prototype,"textContent",{get:function(){return this.value},set:function(e){return this.value=e||""}}),t.prototype.clone=function(){return Object.create(this)},t.prototype.substringData=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.appendData=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.insertData=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.deleteData=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.replaceData=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.isEqualNode=function(e){return!!t.__super__.isEqualNode.apply(this,arguments).isEqualNode(e)&&e.data===this.data},t}(t)}).call(this)},2679:function(e,t,r){(function(){var t,i,n={}.hasOwnProperty;t=r(1737),i=r(7457),e.exports=function(e){function r(e,i){if(r.__super__.constructor.call(this,e),null==i)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=t.Comment,this.value=this.stringify.comment(i)}return function(e,t){for(var r in t)n.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(e){return this.options.writer.comment(this,this.options.writer.filterOptions(e))},r}(i)}).call(this)},3074:function(e,t,r){(function(){var t,i;t=r(5660),i=r(2527),e.exports=function(){function e(){this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new t,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=Object.create(this.defaultParams)}return Object.defineProperty(e.prototype,"parameterNames",{get:function(){return new i(Object.keys(this.defaultParams))}}),e.prototype.getParameter=function(e){return this.params.hasOwnProperty(e)?this.params[e]:null},e.prototype.canSetParameter=function(e,t){return!0},e.prototype.setParameter=function(e,t){return null!=t?this.params[e]=t:delete this.params[e]},e}()}).call(this)},5660:function(e){(function(){e.exports=function(){function e(){}return e.prototype.handleError=function(e){throw new Error(e)},e}()}).call(this)},7260:function(e){(function(){e.exports=function(){function e(){}return e.prototype.hasFeature=function(e,t){return!0},e.prototype.createDocumentType=function(e,t,r){throw new Error("This DOM method is not implemented.")},e.prototype.createDocument=function(e,t,r){throw new Error("This DOM method is not implemented.")},e.prototype.createHTMLDocument=function(e){throw new Error("This DOM method is not implemented.")},e.prototype.getFeature=function(e,t){throw new Error("This DOM method is not implemented.")},e}()}).call(this)},2527:function(e){(function(){e.exports=function(){function e(e){this.arr=e||[]}return Object.defineProperty(e.prototype,"length",{get:function(){return this.arr.length}}),e.prototype.item=function(e){return this.arr[e]||null},e.prototype.contains=function(e){return-1!==this.arr.indexOf(e)},e}()}).call(this)},4111:function(e,t,r){(function(){var t,i,n={}.hasOwnProperty;i=r(468),t=r(1737),e.exports=function(e){function r(e,i,n,a,o,s){if(r.__super__.constructor.call(this,e),null==i)throw new Error("Missing DTD element name. "+this.debugInfo());if(null==n)throw new Error("Missing DTD attribute name. "+this.debugInfo(i));if(!a)throw new Error("Missing DTD attribute type. "+this.debugInfo(i));if(!o)throw new Error("Missing DTD attribute default. "+this.debugInfo(i));if(0!==o.indexOf("#")&&(o="#"+o),!o.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(i));if(s&&!o.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(i));this.elementName=this.stringify.name(i),this.type=t.AttributeDeclaration,this.attributeName=this.stringify.name(n),this.attributeType=this.stringify.dtdAttType(a),s&&(this.defaultValue=this.stringify.dtdAttDefault(s)),this.defaultValueType=o}return function(e,t){for(var r in t)n.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),r.prototype.toString=function(e){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(e))},r}(i)}).call(this)},7696:function(e,t,r){(function(){var t,i,n={}.hasOwnProperty;i=r(468),t=r(1737),e.exports=function(e){function r(e,i,n){if(r.__super__.constructor.call(this,e),null==i)throw new Error("Missing DTD element name. "+this.debugInfo());n||(n="(#PCDATA)"),Array.isArray(n)&&(n="("+n.join(",")+")"),this.name=this.stringify.name(i),this.type=t.ElementDeclaration,this.value=this.stringify.dtdElementValue(n)}return function(e,t){for(var r in t)n.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),r.prototype.toString=function(e){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(e))},r}(i)}).call(this)},5529:function(e,t,r){(function(){var t,i,n,a={}.hasOwnProperty;n=r(9241).isObject,i=r(468),t=r(1737),e.exports=function(e){function r(e,i,a,o){if(r.__super__.constructor.call(this,e),null==a)throw new Error("Missing DTD entity name. "+this.debugInfo(a));if(null==o)throw new Error("Missing DTD entity value. "+this.debugInfo(a));if(this.pe=!!i,this.name=this.stringify.name(a),this.type=t.EntityDeclaration,n(o)){if(!o.pubID&&!o.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(a));if(o.pubID&&!o.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(a));if(this.internal=!1,null!=o.pubID&&(this.pubID=this.stringify.dtdPubID(o.pubID)),null!=o.sysID&&(this.sysID=this.stringify.dtdSysID(o.sysID)),null!=o.nData&&(this.nData=this.stringify.dtdNData(o.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(a))}else this.value=this.stringify.dtdEntityValue(o),this.internal=!0}return function(e,t){for(var r in t)a.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),Object.defineProperty(r.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(r.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(r.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(r.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(r.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(r.prototype,"xmlVersion",{get:function(){return null}}),r.prototype.toString=function(e){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(e))},r}(i)}).call(this)},8012:function(e,t,r){(function(){var t,i,n={}.hasOwnProperty;i=r(468),t=r(1737),e.exports=function(e){function r(e,i,n){if(r.__super__.constructor.call(this,e),null==i)throw new Error("Missing DTD notation name. "+this.debugInfo(i));if(!n.pubID&&!n.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(i));this.name=this.stringify.name(i),this.type=t.NotationDeclaration,null!=n.pubID&&(this.pubID=this.stringify.dtdPubID(n.pubID)),null!=n.sysID&&(this.sysID=this.stringify.dtdSysID(n.sysID))}return function(e,t){for(var r in t)n.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),Object.defineProperty(r.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(r.prototype,"systemId",{get:function(){return this.sysID}}),r.prototype.toString=function(e){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(e))},r}(i)}).call(this)},4130:function(e,t,r){(function(){var t,i,n,a={}.hasOwnProperty;n=r(9241).isObject,i=r(468),t=r(1737),e.exports=function(e){function r(e,i,a,o){var s;r.__super__.constructor.call(this,e),n(i)&&(i=(s=i).version,a=s.encoding,o=s.standalone),i||(i="1.0"),this.type=t.Declaration,this.version=this.stringify.xmlVersion(i),null!=a&&(this.encoding=this.stringify.xmlEncoding(a)),null!=o&&(this.standalone=this.stringify.xmlStandalone(o))}return function(e,t){for(var r in t)a.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),r.prototype.toString=function(e){return this.options.writer.declaration(this,this.options.writer.filterOptions(e))},r}(i)}).call(this)},6376:function(e,t,r){(function(){var t,i,n,a,o,s,c,u,l={}.hasOwnProperty;u=r(9241).isObject,c=r(468),t=r(1737),i=r(4111),a=r(5529),n=r(7696),o=r(8012),s=r(4797),e.exports=function(e){function r(e,i,n){var a,o,s,c,l,h;if(r.__super__.constructor.call(this,e),this.type=t.DocType,e.children)for(o=0,s=(c=e.children).length;o<s;o++)if((a=c[o]).type===t.Element){this.name=a.name;break}this.documentObject=e,u(i)&&(i=(l=i).pubID,n=l.sysID),null==n&&(n=(h=[i,n])[0],i=h[1]),null!=i&&(this.pubID=this.stringify.dtdPubID(i)),null!=n&&(this.sysID=this.stringify.dtdSysID(n))}return function(e,t){for(var r in t)l.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),Object.defineProperty(r.prototype,"entities",{get:function(){var e,r,i,n,a;for(n={},r=0,i=(a=this.children).length;r<i;r++)(e=a[r]).type!==t.EntityDeclaration||e.pe||(n[e.name]=e);return new s(n)}}),Object.defineProperty(r.prototype,"notations",{get:function(){var e,r,i,n,a;for(n={},r=0,i=(a=this.children).length;r<i;r++)(e=a[r]).type===t.NotationDeclaration&&(n[e.name]=e);return new s(n)}}),Object.defineProperty(r.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(r.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(r.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),r.prototype.element=function(e,t){var r;return r=new n(this,e,t),this.children.push(r),this},r.prototype.attList=function(e,t,r,n,a){var o;return o=new i(this,e,t,r,n,a),this.children.push(o),this},r.prototype.entity=function(e,t){var r;return r=new a(this,!1,e,t),this.children.push(r),this},r.prototype.pEntity=function(e,t){var r;return r=new a(this,!0,e,t),this.children.push(r),this},r.prototype.notation=function(e,t){var r;return r=new o(this,e,t),this.children.push(r),this},r.prototype.toString=function(e){return this.options.writer.docType(this,this.options.writer.filterOptions(e))},r.prototype.ele=function(e,t){return this.element(e,t)},r.prototype.att=function(e,t,r,i,n){return this.attList(e,t,r,i,n)},r.prototype.ent=function(e,t){return this.entity(e,t)},r.prototype.pent=function(e,t){return this.pEntity(e,t)},r.prototype.not=function(e,t){return this.notation(e,t)},r.prototype.up=function(){return this.root()||this.documentObject},r.prototype.isEqualNode=function(e){return!!r.__super__.isEqualNode.apply(this,arguments).isEqualNode(e)&&(e.name===this.name&&(e.publicId===this.publicId&&e.systemId===this.systemId))},r}(c)}).call(this)},1933:function(e,t,r){(function(){var t,i,n,a,o,s,c,u={}.hasOwnProperty;c=r(9241).isPlainObject,n=r(7260),i=r(3074),a=r(468),t=r(1737),s=r(3976),o=r(382),e.exports=function(e){function r(e){r.__super__.constructor.call(this,null),this.name="#document",this.type=t.Document,this.documentURI=null,this.domConfig=new i,e||(e={}),e.writer||(e.writer=new o),this.options=e,this.stringify=new s(e)}return function(e,t){for(var r in t)u.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),Object.defineProperty(r.prototype,"implementation",{value:new n}),Object.defineProperty(r.prototype,"doctype",{get:function(){var e,r,i,n;for(r=0,i=(n=this.children).length;r<i;r++)if((e=n[r]).type===t.DocType)return e;return null}}),Object.defineProperty(r.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(r.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(r.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(r.prototype,"xmlEncoding",{get:function(){return 0!==this.children.length&&this.children[0].type===t.Declaration?this.children[0].encoding:null}}),Object.defineProperty(r.prototype,"xmlStandalone",{get:function(){return 0!==this.children.length&&this.children[0].type===t.Declaration&&"yes"===this.children[0].standalone}}),Object.defineProperty(r.prototype,"xmlVersion",{get:function(){return 0!==this.children.length&&this.children[0].type===t.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(r.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(r.prototype,"origin",{get:function(){return null}}),Object.defineProperty(r.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(r.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(r.prototype,"contentType",{get:function(){return null}}),r.prototype.end=function(e){var t;return t={},e?c(e)&&(t=e,e=this.options.writer):e=this.options.writer,e.document(this,e.filterOptions(t))},r.prototype.toString=function(e){return this.options.writer.document(this,this.options.writer.filterOptions(e))},r.prototype.createElement=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createDocumentFragment=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createTextNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createComment=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createCDATASection=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createProcessingInstruction=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createAttribute=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createEntityReference=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.importNode=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createElementNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createAttributeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagNameNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementById=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.adoptNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.normalizeDocument=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.renameNode=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByClassName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createEvent=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createRange=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createNodeIterator=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createTreeWalker=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r}(a)}).call(this)},400:function(e,t,r){(function(){var t,i,n,a,o,s,c,u,l,h,d,p,f,v,g,m,y,C,S,E,_,T,A,I={}.hasOwnProperty;A=r(9241),_=A.isObject,E=A.isFunction,T=A.isPlainObject,S=A.getValue,t=r(1737),p=r(1933),f=r(3906),a=r(2691),o=r(2679),g=r(1268),C=r(2535),v=r(5915),h=r(4130),d=r(6376),s=r(4111),u=r(5529),c=r(7696),l=r(8012),n=r(4238),y=r(3976),m=r(382),i=r(8753),e.exports=function(){function e(e,r,i){var n;this.name="?xml",this.type=t.Document,e||(e={}),n={},e.writer?T(e.writer)&&(n=e.writer,e.writer=new m):e.writer=new m,this.options=e,this.writer=e.writer,this.writerOptions=this.writer.filterOptions(n),this.stringify=new y(e),this.onDataCallback=r||function(){},this.onEndCallback=i||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return e.prototype.createChildNode=function(e){var r,i,n,a,o,s,c,u;switch(e.type){case t.CData:this.cdata(e.value);break;case t.Comment:this.comment(e.value);break;case t.Element:for(i in n={},c=e.attribs)I.call(c,i)&&(r=c[i],n[i]=r.value);this.node(e.name,n);break;case t.Dummy:this.dummy();break;case t.Raw:this.raw(e.value);break;case t.Text:this.text(e.value);break;case t.ProcessingInstruction:this.instruction(e.target,e.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+e.constructor.name)}for(o=0,s=(u=e.children).length;o<s;o++)a=u[o],this.createChildNode(a),a.type===t.Element&&this.up();return this},e.prototype.dummy=function(){return this},e.prototype.node=function(e,t,r){var i;if(null==e)throw new Error("Missing node name.");if(this.root&&-1===this.currentLevel)throw new Error("Document can only have one root node. "+this.debugInfo(e));return this.openCurrent(),e=S(e),null==t&&(t={}),t=S(t),_(t)||(r=(i=[t,r])[0],t=i[1]),this.currentNode=new f(this,e,t),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,null!=r&&this.text(r),this},e.prototype.element=function(e,r,i){var n,a,o,s,c,u;if(this.currentNode&&this.currentNode.type===t.DocType)this.dtdElement.apply(this,arguments);else if(Array.isArray(e)||_(e)||E(e))for(s=this.options.noValidation,this.options.noValidation=!0,(u=new p(this.options).element("TEMP_ROOT")).element(e),this.options.noValidation=s,a=0,o=(c=u.children).length;a<o;a++)n=c[a],this.createChildNode(n),n.type===t.Element&&this.up();else this.node(e,r,i);return this},e.prototype.attribute=function(e,t){var r,i;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(e));if(null!=e&&(e=S(e)),_(e))for(r in e)I.call(e,r)&&(i=e[r],this.attribute(r,i));else E(t)&&(t=t.apply()),this.options.keepNullAttributes&&null==t?this.currentNode.attribs[e]=new n(this,e,""):null!=t&&(this.currentNode.attribs[e]=new n(this,e,t));return this},e.prototype.text=function(e){var t;return this.openCurrent(),t=new C(this,e),this.onData(this.writer.text(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.cdata=function(e){var t;return this.openCurrent(),t=new a(this,e),this.onData(this.writer.cdata(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.comment=function(e){var t;return this.openCurrent(),t=new o(this,e),this.onData(this.writer.comment(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.raw=function(e){var t;return this.openCurrent(),t=new g(this,e),this.onData(this.writer.raw(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.instruction=function(e,t){var r,i,n,a,o;if(this.openCurrent(),null!=e&&(e=S(e)),null!=t&&(t=S(t)),Array.isArray(e))for(r=0,a=e.length;r<a;r++)i=e[r],this.instruction(i);else if(_(e))for(i in e)I.call(e,i)&&(n=e[i],this.instruction(i,n));else E(t)&&(t=t.apply()),o=new v(this,e,t),this.onData(this.writer.processingInstruction(o,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this},e.prototype.declaration=function(e,t,r){var i;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return i=new h(this,e,t,r),this.onData(this.writer.declaration(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.doctype=function(e,t,r){if(this.openCurrent(),null==e)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new d(this,t,r),this.currentNode.rootNodeName=e,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},e.prototype.dtdElement=function(e,t){var r;return this.openCurrent(),r=new c(this,e,t),this.onData(this.writer.dtdElement(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.attList=function(e,t,r,i,n){var a;return this.openCurrent(),a=new s(this,e,t,r,i,n),this.onData(this.writer.dtdAttList(a,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.entity=function(e,t){var r;return this.openCurrent(),r=new u(this,!1,e,t),this.onData(this.writer.dtdEntity(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.pEntity=function(e,t){var r;return this.openCurrent(),r=new u(this,!0,e,t),this.onData(this.writer.dtdEntity(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.notation=function(e,t){var r;return this.openCurrent(),r=new l(this,e,t),this.onData(this.writer.dtdNotation(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},e.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},e.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},e.prototype.openNode=function(e){var r,n,a,o;if(!e.isOpen){if(this.root||0!==this.currentLevel||e.type!==t.Element||(this.root=e),n="",e.type===t.Element){for(a in this.writerOptions.state=i.OpenTag,n=this.writer.indent(e,this.writerOptions,this.currentLevel)+"<"+e.name,o=e.attribs)I.call(o,a)&&(r=o[a],n+=this.writer.attribute(r,this.writerOptions,this.currentLevel));n+=(e.children?">":"/>")+this.writer.endline(e,this.writerOptions,this.currentLevel),this.writerOptions.state=i.InsideTag}else this.writerOptions.state=i.OpenTag,n=this.writer.indent(e,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+e.rootNodeName,e.pubID&&e.sysID?n+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(n+=' SYSTEM "'+e.sysID+'"'),e.children?(n+=" [",this.writerOptions.state=i.InsideTag):(this.writerOptions.state=i.CloseTag,n+=">"),n+=this.writer.endline(e,this.writerOptions,this.currentLevel);return this.onData(n,this.currentLevel),e.isOpen=!0}},e.prototype.closeNode=function(e){var r;if(!e.isClosed)return r="",this.writerOptions.state=i.CloseTag,r=e.type===t.Element?this.writer.indent(e,this.writerOptions,this.currentLevel)+"</"+e.name+">"+this.writer.endline(e,this.writerOptions,this.currentLevel):this.writer.indent(e,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(e,this.writerOptions,this.currentLevel),this.writerOptions.state=i.None,this.onData(r,this.currentLevel),e.isClosed=!0},e.prototype.onData=function(e,t){return this.documentStarted=!0,this.onDataCallback(e,t+1)},e.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},e.prototype.debugInfo=function(e){return null==e?"":"node: <"+e+">"},e.prototype.ele=function(){return this.element.apply(this,arguments)},e.prototype.nod=function(e,t,r){return this.node(e,t,r)},e.prototype.txt=function(e){return this.text(e)},e.prototype.dat=function(e){return this.cdata(e)},e.prototype.com=function(e){return this.comment(e)},e.prototype.ins=function(e,t){return this.instruction(e,t)},e.prototype.dec=function(e,t,r){return this.declaration(e,t,r)},e.prototype.dtd=function(e,t,r){return this.doctype(e,t,r)},e.prototype.e=function(e,t,r){return this.element(e,t,r)},e.prototype.n=function(e,t,r){return this.node(e,t,r)},e.prototype.t=function(e){return this.text(e)},e.prototype.d=function(e){return this.cdata(e)},e.prototype.c=function(e){return this.comment(e)},e.prototype.r=function(e){return this.raw(e)},e.prototype.i=function(e,t){return this.instruction(e,t)},e.prototype.att=function(){return this.currentNode&&this.currentNode.type===t.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},e.prototype.a=function(){return this.currentNode&&this.currentNode.type===t.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},e.prototype.ent=function(e,t){return this.entity(e,t)},e.prototype.pent=function(e,t){return this.pEntity(e,t)},e.prototype.not=function(e,t){return this.notation(e,t)},e}()}).call(this)},1218:function(e,t,r){(function(){var t,i,n={}.hasOwnProperty;i=r(468),t=r(1737),e.exports=function(e){function r(e){r.__super__.constructor.call(this,e),this.type=t.Dummy}return function(e,t){for(var r in t)n.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(e){return""},r}(i)}).call(this)},3906:function(e,t,r){(function(){var t,i,n,a,o,s,c,u,l={}.hasOwnProperty;u=r(9241),c=u.isObject,s=u.isFunction,o=u.getValue,a=r(468),t=r(1737),i=r(4238),n=r(4797),e.exports=function(e){function r(e,i,n){var a,o,s,c;if(r.__super__.constructor.call(this,e),null==i)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(i),this.type=t.Element,this.attribs={},this.schemaTypeInfo=null,null!=n&&this.attribute(n),e.type===t.Document&&(this.isRoot=!0,this.documentObject=e,e.rootObject=this,e.children))for(o=0,s=(c=e.children).length;o<s;o++)if((a=c[o]).type===t.DocType){a.name=this.name;break}}return function(e,t){for(var r in t)l.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),Object.defineProperty(r.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(r.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(r.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(r.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(r.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(r.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(r.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(r.prototype,"attributes",{get:function(){return this.attributeMap&&this.attributeMap.nodes||(this.attributeMap=new n(this.attribs)),this.attributeMap}}),r.prototype.clone=function(){var e,t,r,i;for(t in(r=Object.create(this)).isRoot&&(r.documentObject=null),r.attribs={},i=this.attribs)l.call(i,t)&&(e=i[t],r.attribs[t]=e.clone());return r.children=[],this.children.forEach((function(e){var t;return(t=e.clone()).parent=r,r.children.push(t)})),r},r.prototype.attribute=function(e,t){var r,n;if(null!=e&&(e=o(e)),c(e))for(r in e)l.call(e,r)&&(n=e[r],this.attribute(r,n));else s(t)&&(t=t.apply()),this.options.keepNullAttributes&&null==t?this.attribs[e]=new i(this,e,""):null!=t&&(this.attribs[e]=new i(this,e,t));return this},r.prototype.removeAttribute=function(e){var t,r,i;if(null==e)throw new Error("Missing attribute name. "+this.debugInfo());if(e=o(e),Array.isArray(e))for(r=0,i=e.length;r<i;r++)t=e[r],delete this.attribs[t];else delete this.attribs[e];return this},r.prototype.toString=function(e){return this.options.writer.element(this,this.options.writer.filterOptions(e))},r.prototype.att=function(e,t){return this.attribute(e,t)},r.prototype.a=function(e,t){return this.attribute(e,t)},r.prototype.getAttribute=function(e){return this.attribs.hasOwnProperty(e)?this.attribs[e].value:null},r.prototype.setAttribute=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getAttributeNode=function(e){return this.attribs.hasOwnProperty(e)?this.attribs[e]:null},r.prototype.setAttributeNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.removeAttributeNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getAttributeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.setAttributeNS=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.removeAttributeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getAttributeNodeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.setAttributeNodeNS=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagNameNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.hasAttribute=function(e){return this.attribs.hasOwnProperty(e)},r.prototype.hasAttributeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.setIdAttribute=function(e,t){return this.attribs.hasOwnProperty(e)?this.attribs[e].isId:t},r.prototype.setIdAttributeNS=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.setIdAttributeNode=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagNameNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByClassName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.isEqualNode=function(e){var t,i,n;if(!r.__super__.isEqualNode.apply(this,arguments).isEqualNode(e))return!1;if(e.namespaceURI!==this.namespaceURI)return!1;if(e.prefix!==this.prefix)return!1;if(e.localName!==this.localName)return!1;if(e.attribs.length!==this.attribs.length)return!1;for(t=i=0,n=this.attribs.length-1;0<=n?i<=n:i>=n;t=0<=n?++i:--i)if(!this.attribs[t].isEqualNode(e.attribs[t]))return!1;return!0},r}(a)}).call(this)},4797:function(e){(function(){e.exports=function(){function e(e){this.nodes=e}return Object.defineProperty(e.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),e.prototype.clone=function(){return this.nodes=null},e.prototype.getNamedItem=function(e){return this.nodes[e]},e.prototype.setNamedItem=function(e){var t;return t=this.nodes[e.nodeName],this.nodes[e.nodeName]=e,t||null},e.prototype.removeNamedItem=function(e){var t;return t=this.nodes[e],delete this.nodes[e],t||null},e.prototype.item=function(e){return this.nodes[Object.keys(this.nodes)[e]]||null},e.prototype.getNamedItemNS=function(e,t){throw new Error("This DOM method is not implemented.")},e.prototype.setNamedItemNS=function(e){throw new Error("This DOM method is not implemented.")},e.prototype.removeNamedItemNS=function(e,t){throw new Error("This DOM method is not implemented.")},e}()}).call(this)},468:function(e,t,r){(function(){var t,i,n,a,o,s,c,u,l,h,d,p,f,v,g,m,y,C={}.hasOwnProperty;y=r(9241),m=y.isObject,g=y.isFunction,v=y.isEmpty,f=y.getValue,u=null,n=null,a=null,o=null,s=null,d=null,p=null,h=null,c=null,i=null,l=null,t=null,e.exports=function(){function e(e){this.parent=e,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,u||(u=r(3906),n=r(2691),a=r(2679),o=r(4130),s=r(6376),d=r(1268),p=r(2535),h=r(5915),c=r(1218),i=r(1737),l=r(6684),r(4797),t=r(4923))}return Object.defineProperty(e.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(e.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(e.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(e.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(e.prototype,"childNodes",{get:function(){return this.childNodeList&&this.childNodeList.nodes||(this.childNodeList=new l(this.children)),this.childNodeList}}),Object.defineProperty(e.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(e.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){var e;return e=this.parent.children.indexOf(this),this.parent.children[e-1]||null}}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){var e;return e=this.parent.children.indexOf(this),this.parent.children[e+1]||null}}),Object.defineProperty(e.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(e.prototype,"textContent",{get:function(){var e,t,r,n,a;if(this.nodeType===i.Element||this.nodeType===i.DocumentFragment){for(a="",t=0,r=(n=this.children).length;t<r;t++)(e=n[t]).textContent&&(a+=e.textContent);return a}return null},set:function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),e.prototype.setParent=function(e){var t,r,i,n,a;for(this.parent=e,e&&(this.options=e.options,this.stringify=e.stringify),a=[],r=0,i=(n=this.children).length;r<i;r++)t=n[r],a.push(t.setParent(this));return a},e.prototype.element=function(e,t,r){var i,n,a,o,s,c,u,l,h,d,p;if(c=null,null===t&&null==r&&(t=(h=[{},null])[0],r=h[1]),null==t&&(t={}),t=f(t),m(t)||(r=(d=[t,r])[0],t=d[1]),null!=e&&(e=f(e)),Array.isArray(e))for(a=0,u=e.length;a<u;a++)n=e[a],c=this.element(n);else if(g(e))c=this.element(e.apply());else if(m(e)){for(s in e)if(C.call(e,s))if(p=e[s],g(p)&&(p=p.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&0===s.indexOf(this.stringify.convertAttKey))c=this.attribute(s.substr(this.stringify.convertAttKey.length),p);else if(!this.options.separateArrayItems&&Array.isArray(p)&&v(p))c=this.dummy();else if(m(p)&&v(p))c=this.element(s);else if(this.options.keepNullNodes||null!=p)if(!this.options.separateArrayItems&&Array.isArray(p))for(o=0,l=p.length;o<l;o++)n=p[o],(i={})[s]=n,c=this.element(i);else m(p)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===s.indexOf(this.stringify.convertTextKey)?c=this.element(p):(c=this.element(s)).element(p):c=this.element(s,p);else c=this.dummy()}else c=this.options.keepNullNodes||null!==r?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===e.indexOf(this.stringify.convertTextKey)?this.text(r):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&0===e.indexOf(this.stringify.convertCDataKey)?this.cdata(r):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&0===e.indexOf(this.stringify.convertCommentKey)?this.comment(r):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&0===e.indexOf(this.stringify.convertRawKey)?this.raw(r):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&0===e.indexOf(this.stringify.convertPIKey)?this.instruction(e.substr(this.stringify.convertPIKey.length),r):this.node(e,t,r):this.dummy();if(null==c)throw new Error("Could not create any elements with: "+e+". "+this.debugInfo());return c},e.prototype.insertBefore=function(e,t,r){var i,n,a,o,s;if(null!=e?e.type:void 0)return o=t,(a=e).setParent(this),o?(n=children.indexOf(o),s=children.splice(n),children.push(a),Array.prototype.push.apply(children,s)):children.push(a),a;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(e));return n=this.parent.children.indexOf(this),s=this.parent.children.splice(n),i=this.parent.element(e,t,r),Array.prototype.push.apply(this.parent.children,s),i},e.prototype.insertAfter=function(e,t,r){var i,n,a;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(e));return n=this.parent.children.indexOf(this),a=this.parent.children.splice(n+1),i=this.parent.element(e,t,r),Array.prototype.push.apply(this.parent.children,a),i},e.prototype.remove=function(){var e;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return e=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[e,e-e+1].concat([])),this.parent},e.prototype.node=function(e,t,r){var i,n;return null!=e&&(e=f(e)),t||(t={}),t=f(t),m(t)||(r=(n=[t,r])[0],t=n[1]),i=new u(this,e,t),null!=r&&i.text(r),this.children.push(i),i},e.prototype.text=function(e){var t;return m(e)&&this.element(e),t=new p(this,e),this.children.push(t),this},e.prototype.cdata=function(e){var t;return t=new n(this,e),this.children.push(t),this},e.prototype.comment=function(e){var t;return t=new a(this,e),this.children.push(t),this},e.prototype.commentBefore=function(e){var t,r;return t=this.parent.children.indexOf(this),r=this.parent.children.splice(t),this.parent.comment(e),Array.prototype.push.apply(this.parent.children,r),this},e.prototype.commentAfter=function(e){var t,r;return t=this.parent.children.indexOf(this),r=this.parent.children.splice(t+1),this.parent.comment(e),Array.prototype.push.apply(this.parent.children,r),this},e.prototype.raw=function(e){var t;return t=new d(this,e),this.children.push(t),this},e.prototype.dummy=function(){return new c(this)},e.prototype.instruction=function(e,t){var r,i,n,a,o;if(null!=e&&(e=f(e)),null!=t&&(t=f(t)),Array.isArray(e))for(a=0,o=e.length;a<o;a++)r=e[a],this.instruction(r);else if(m(e))for(r in e)C.call(e,r)&&(i=e[r],this.instruction(r,i));else g(t)&&(t=t.apply()),n=new h(this,e,t),this.children.push(n);return this},e.prototype.instructionBefore=function(e,t){var r,i;return r=this.parent.children.indexOf(this),i=this.parent.children.splice(r),this.parent.instruction(e,t),Array.prototype.push.apply(this.parent.children,i),this},e.prototype.instructionAfter=function(e,t){var r,i;return r=this.parent.children.indexOf(this),i=this.parent.children.splice(r+1),this.parent.instruction(e,t),Array.prototype.push.apply(this.parent.children,i),this},e.prototype.declaration=function(e,t,r){var n,a;return n=this.document(),a=new o(n,e,t,r),0===n.children.length?n.children.unshift(a):n.children[0].type===i.Declaration?n.children[0]=a:n.children.unshift(a),n.root()||n},e.prototype.dtd=function(e,t){var r,n,a,o,c,u,l,h,d;for(r=this.document(),n=new s(r,e,t),a=o=0,u=(h=r.children).length;o<u;a=++o)if(h[a].type===i.DocType)return r.children[a]=n,n;for(a=c=0,l=(d=r.children).length;c<l;a=++c)if(d[a].isRoot)return r.children.splice(a,0,n),n;return r.children.push(n),n},e.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},e.prototype.root=function(){var e;for(e=this;e;){if(e.type===i.Document)return e.rootObject;if(e.isRoot)return e;e=e.parent}},e.prototype.document=function(){var e;for(e=this;e;){if(e.type===i.Document)return e;e=e.parent}},e.prototype.end=function(e){return this.document().end(e)},e.prototype.prev=function(){var e;if((e=this.parent.children.indexOf(this))<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[e-1]},e.prototype.next=function(){var e;if(-1===(e=this.parent.children.indexOf(this))||e===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[e+1]},e.prototype.importDocument=function(e){var t;return(t=e.root().clone()).parent=this,t.isRoot=!1,this.children.push(t),this},e.prototype.debugInfo=function(e){var t,r;return null!=(e=e||this.name)||(null!=(t=this.parent)?t.name:void 0)?null==e?"parent: <"+this.parent.name+">":(null!=(r=this.parent)?r.name:void 0)?"node: <"+e+">, parent: <"+this.parent.name+">":"node: <"+e+">":""},e.prototype.ele=function(e,t,r){return this.element(e,t,r)},e.prototype.nod=function(e,t,r){return this.node(e,t,r)},e.prototype.txt=function(e){return this.text(e)},e.prototype.dat=function(e){return this.cdata(e)},e.prototype.com=function(e){return this.comment(e)},e.prototype.ins=function(e,t){return this.instruction(e,t)},e.prototype.doc=function(){return this.document()},e.prototype.dec=function(e,t,r){return this.declaration(e,t,r)},e.prototype.e=function(e,t,r){return this.element(e,t,r)},e.prototype.n=function(e,t,r){return this.node(e,t,r)},e.prototype.t=function(e){return this.text(e)},e.prototype.d=function(e){return this.cdata(e)},e.prototype.c=function(e){return this.comment(e)},e.prototype.r=function(e){return this.raw(e)},e.prototype.i=function(e,t){return this.instruction(e,t)},e.prototype.u=function(){return this.up()},e.prototype.importXMLBuilder=function(e){return this.importDocument(e)},e.prototype.replaceChild=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.removeChild=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.appendChild=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.hasChildNodes=function(){return 0!==this.children.length},e.prototype.cloneNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.normalize=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.isSupported=function(e,t){return!0},e.prototype.hasAttributes=function(){return 0!==this.attribs.length},e.prototype.compareDocumentPosition=function(e){var r,i;return(r=this)===e?0:this.document()!==e.document()?(i=t.Disconnected|t.ImplementationSpecific,Math.random()<.5?i|=t.Preceding:i|=t.Following,i):r.isAncestor(e)?t.Contains|t.Preceding:r.isDescendant(e)?t.Contains|t.Following:r.isPreceding(e)?t.Preceding:t.Following},e.prototype.isSameNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.lookupPrefix=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.isDefaultNamespace=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.lookupNamespaceURI=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.isEqualNode=function(e){var t,r,i;if(e.nodeType!==this.nodeType)return!1;if(e.children.length!==this.children.length)return!1;for(t=r=0,i=this.children.length-1;0<=i?r<=i:r>=i;t=0<=i?++r:--r)if(!this.children[t].isEqualNode(e.children[t]))return!1;return!0},e.prototype.getFeature=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.setUserData=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.getUserData=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.contains=function(e){return!!e&&(e===this||this.isDescendant(e))},e.prototype.isDescendant=function(e){var t,r,i,n;for(r=0,i=(n=this.children).length;r<i;r++){if(e===(t=n[r]))return!0;if(t.isDescendant(e))return!0}return!1},e.prototype.isAncestor=function(e){return e.isDescendant(this)},e.prototype.isPreceding=function(e){var t,r;return t=this.treePosition(e),r=this.treePosition(this),-1!==t&&-1!==r&&t<r},e.prototype.isFollowing=function(e){var t,r;return t=this.treePosition(e),r=this.treePosition(this),-1!==t&&-1!==r&&t>r},e.prototype.treePosition=function(e){var t,r;return r=0,t=!1,this.foreachTreeNode(this.document(),(function(i){if(r++,!t&&i===e)return t=!0})),t?r:-1},e.prototype.foreachTreeNode=function(e,t){var r,i,n,a,o;for(e||(e=this.document()),i=0,n=(a=e.children).length;i<n;i++){if(o=t(r=a[i]))return o;if(o=this.foreachTreeNode(r,t))return o}},e}()}).call(this)},6684:function(e){(function(){e.exports=function(){function e(e){this.nodes=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this.nodes.length||0}}),e.prototype.clone=function(){return this.nodes=null},e.prototype.item=function(e){return this.nodes[e]||null},e}()}).call(this)},5915:function(e,t,r){(function(){var t,i,n={}.hasOwnProperty;t=r(1737),i=r(7457),e.exports=function(e){function r(e,i,n){if(r.__super__.constructor.call(this,e),null==i)throw new Error("Missing instruction target. "+this.debugInfo());this.type=t.ProcessingInstruction,this.target=this.stringify.insTarget(i),this.name=this.target,n&&(this.value=this.stringify.insValue(n))}return function(e,t){for(var r in t)n.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(e){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(e))},r.prototype.isEqualNode=function(e){return!!r.__super__.isEqualNode.apply(this,arguments).isEqualNode(e)&&e.target===this.target},r}(i)}).call(this)},1268:function(e,t,r){(function(){var t,i,n={}.hasOwnProperty;t=r(1737),i=r(468),e.exports=function(e){function r(e,i){if(r.__super__.constructor.call(this,e),null==i)throw new Error("Missing raw text. "+this.debugInfo());this.type=t.Raw,this.value=this.stringify.raw(i)}return function(e,t){for(var r in t)n.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(e){return this.options.writer.raw(this,this.options.writer.filterOptions(e))},r}(i)}).call(this)},6775:function(e,t,r){(function(){var t,i,n,a={}.hasOwnProperty;t=r(1737),n=r(6286),i=r(8753),e.exports=function(e){function r(e,t){this.stream=e,r.__super__.constructor.call(this,t)}return function(e,t){for(var r in t)a.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),r.prototype.endline=function(e,t,n){return e.isLastRootNode&&t.state===i.CloseTag?"":r.__super__.endline.call(this,e,t,n)},r.prototype.document=function(e,t){var r,i,n,a,o,s,c,u,l;for(i=n=0,o=(c=e.children).length;n<o;i=++n)(r=c[i]).isLastRootNode=i===e.children.length-1;for(t=this.filterOptions(t),l=[],a=0,s=(u=e.children).length;a<s;a++)r=u[a],l.push(this.writeChildNode(r,t,0));return l},r.prototype.attribute=function(e,t,i){return this.stream.write(r.__super__.attribute.call(this,e,t,i))},r.prototype.cdata=function(e,t,i){return this.stream.write(r.__super__.cdata.call(this,e,t,i))},r.prototype.comment=function(e,t,i){return this.stream.write(r.__super__.comment.call(this,e,t,i))},r.prototype.declaration=function(e,t,i){return this.stream.write(r.__super__.declaration.call(this,e,t,i))},r.prototype.docType=function(e,t,r){var n,a,o,s;if(r||(r=0),this.openNode(e,t,r),t.state=i.OpenTag,this.stream.write(this.indent(e,t,r)),this.stream.write("<!DOCTYPE "+e.root().name),e.pubID&&e.sysID?this.stream.write(' PUBLIC "'+e.pubID+'" "'+e.sysID+'"'):e.sysID&&this.stream.write(' SYSTEM "'+e.sysID+'"'),e.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(e,t,r)),t.state=i.InsideTag,a=0,o=(s=e.children).length;a<o;a++)n=s[a],this.writeChildNode(n,t,r+1);t.state=i.CloseTag,this.stream.write("]")}return t.state=i.CloseTag,this.stream.write(t.spaceBeforeSlash+">"),this.stream.write(this.endline(e,t,r)),t.state=i.None,this.closeNode(e,t,r)},r.prototype.element=function(e,r,n){var o,s,c,u,l,h,d,p,f;for(d in n||(n=0),this.openNode(e,r,n),r.state=i.OpenTag,this.stream.write(this.indent(e,r,n)+"<"+e.name),p=e.attribs)a.call(p,d)&&(o=p[d],this.attribute(o,r,n));if(u=0===(c=e.children.length)?null:e.children[0],0===c||e.children.every((function(e){return(e.type===t.Text||e.type===t.Raw)&&""===e.value})))r.allowEmpty?(this.stream.write(">"),r.state=i.CloseTag,this.stream.write("</"+e.name+">")):(r.state=i.CloseTag,this.stream.write(r.spaceBeforeSlash+"/>"));else if(!r.pretty||1!==c||u.type!==t.Text&&u.type!==t.Raw||null==u.value){for(this.stream.write(">"+this.endline(e,r,n)),r.state=i.InsideTag,l=0,h=(f=e.children).length;l<h;l++)s=f[l],this.writeChildNode(s,r,n+1);r.state=i.CloseTag,this.stream.write(this.indent(e,r,n)+"</"+e.name+">")}else this.stream.write(">"),r.state=i.InsideTag,r.suppressPrettyCount++,!0,this.writeChildNode(u,r,n+1),r.suppressPrettyCount--,!1,r.state=i.CloseTag,this.stream.write("</"+e.name+">");return this.stream.write(this.endline(e,r,n)),r.state=i.None,this.closeNode(e,r,n)},r.prototype.processingInstruction=function(e,t,i){return this.stream.write(r.__super__.processingInstruction.call(this,e,t,i))},r.prototype.raw=function(e,t,i){return this.stream.write(r.__super__.raw.call(this,e,t,i))},r.prototype.text=function(e,t,i){return this.stream.write(r.__super__.text.call(this,e,t,i))},r.prototype.dtdAttList=function(e,t,i){return this.stream.write(r.__super__.dtdAttList.call(this,e,t,i))},r.prototype.dtdElement=function(e,t,i){return this.stream.write(r.__super__.dtdElement.call(this,e,t,i))},r.prototype.dtdEntity=function(e,t,i){return this.stream.write(r.__super__.dtdEntity.call(this,e,t,i))},r.prototype.dtdNotation=function(e,t,i){return this.stream.write(r.__super__.dtdNotation.call(this,e,t,i))},r}(n)}).call(this)},382:function(e,t,r){(function(){var t,i={}.hasOwnProperty;t=r(6286),e.exports=function(e){function t(e){t.__super__.constructor.call(this,e)}return function(e,t){for(var r in t)i.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(t,e),t.prototype.document=function(e,t){var r,i,n,a,o;for(t=this.filterOptions(t),a="",i=0,n=(o=e.children).length;i<n;i++)r=o[i],a+=this.writeChildNode(r,t,0);return t.pretty&&a.slice(-t.newline.length)===t.newline&&(a=a.slice(0,-t.newline.length)),a},t}(t)}).call(this)},3976:function(e){(function(){var t=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty;e.exports=function(){function e(e){var i,n,a;for(i in this.assertLegalName=t(this.assertLegalName,this),this.assertLegalChar=t(this.assertLegalChar,this),e||(e={}),this.options=e,this.options.version||(this.options.version="1.0"),n=e.stringify||{})r.call(n,i)&&(a=n[i],this[i]=a)}return e.prototype.name=function(e){return this.options.noValidation?e:this.assertLegalName(""+e||"")},e.prototype.text=function(e){return this.options.noValidation?e:this.assertLegalChar(this.textEscape(""+e||""))},e.prototype.cdata=function(e){return this.options.noValidation?e:(e=(e=""+e||"").replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(e))},e.prototype.comment=function(e){if(this.options.noValidation)return e;if((e=""+e||"").match(/--/))throw new Error("Comment text cannot contain double-hypen: "+e);return this.assertLegalChar(e)},e.prototype.raw=function(e){return this.options.noValidation?e:""+e||""},e.prototype.attValue=function(e){return this.options.noValidation?e:this.assertLegalChar(this.attEscape(e=""+e||""))},e.prototype.insTarget=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.insValue=function(e){if(this.options.noValidation)return e;if((e=""+e||"").match(/\?>/))throw new Error("Invalid processing instruction value: "+e);return this.assertLegalChar(e)},e.prototype.xmlVersion=function(e){if(this.options.noValidation)return e;if(!(e=""+e||"").match(/1\.[0-9]+/))throw new Error("Invalid version number: "+e);return e},e.prototype.xmlEncoding=function(e){if(this.options.noValidation)return e;if(!(e=""+e||"").match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+e);return this.assertLegalChar(e)},e.prototype.xmlStandalone=function(e){return this.options.noValidation?e:e?"yes":"no"},e.prototype.dtdPubID=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdSysID=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdElementValue=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdAttType=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdAttDefault=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdEntityValue=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdNData=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.convertAttKey="@",e.prototype.convertPIKey="?",e.prototype.convertTextKey="#text",e.prototype.convertCDataKey="#cdata",e.prototype.convertCommentKey="#comment",e.prototype.convertRawKey="#raw",e.prototype.assertLegalChar=function(e){var t,r;if(this.options.noValidation)return e;if(t="","1.0"===this.options.version){if(t=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,r=e.match(t))throw new Error("Invalid character in string: "+e+" at index "+r.index)}else if("1.1"===this.options.version&&(t=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,r=e.match(t)))throw new Error("Invalid character in string: "+e+" at index "+r.index);return e},e.prototype.assertLegalName=function(e){var t;if(this.options.noValidation)return e;if(this.assertLegalChar(e),t=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!e.match(t))throw new Error("Invalid character in name");return e},e.prototype.textEscape=function(e){var t;return this.options.noValidation?e:(t=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,e.replace(t,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))},e.prototype.attEscape=function(e){var t;return this.options.noValidation?e:(t=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,e.replace(t,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))},e}()}).call(this)},2535:function(e,t,r){(function(){var t,i,n={}.hasOwnProperty;t=r(1737),i=r(7457),e.exports=function(e){function r(e,i){if(r.__super__.constructor.call(this,e),null==i)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=t.Text,this.value=this.stringify.text(i)}return function(e,t){for(var r in t)n.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),Object.defineProperty(r.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(r.prototype,"wholeText",{get:function(){var e,t,r;for(r="",t=this.previousSibling;t;)r=t.data+r,t=t.previousSibling;for(r+=this.data,e=this.nextSibling;e;)r+=e.data,e=e.nextSibling;return r}}),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(e){return this.options.writer.text(this,this.options.writer.filterOptions(e))},r.prototype.splitText=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.replaceWholeText=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r}(i)}).call(this)},6286:function(e,t,r){(function(){var t,i,n,a={}.hasOwnProperty;n=r(9241).assign,t=r(1737),r(4130),r(6376),r(2691),r(2679),r(3906),r(1268),r(2535),r(5915),r(1218),r(4111),r(7696),r(5529),r(8012),i=r(8753),e.exports=function(){function e(e){var t,r,i;for(t in e||(e={}),this.options=e,r=e.writer||{})a.call(r,t)&&(i=r[t],this["_"+t]=this[t],this[t]=i)}return e.prototype.filterOptions=function(e){var t,r,a,o,s,c,u,l;return e||(e={}),e=n({},this.options,e),(t={writer:this}).pretty=e.pretty||!1,t.allowEmpty=e.allowEmpty||!1,t.indent=null!=(r=e.indent)?r:"  ",t.newline=null!=(a=e.newline)?a:"\n",t.offset=null!=(o=e.offset)?o:0,t.dontPrettyTextNodes=null!=(s=null!=(c=e.dontPrettyTextNodes)?c:e.dontprettytextnodes)?s:0,t.spaceBeforeSlash=null!=(u=null!=(l=e.spaceBeforeSlash)?l:e.spacebeforeslash)?u:"",!0===t.spaceBeforeSlash&&(t.spaceBeforeSlash=" "),t.suppressPrettyCount=0,t.user={},t.state=i.None,t},e.prototype.indent=function(e,t,r){var i;return!t.pretty||t.suppressPrettyCount?"":t.pretty&&(i=(r||0)+t.offset+1)>0?new Array(i).join(t.indent):""},e.prototype.endline=function(e,t,r){return!t.pretty||t.suppressPrettyCount?"":t.newline},e.prototype.attribute=function(e,t,r){var i;return this.openAttribute(e,t,r),i=" "+e.name+'="'+e.value+'"',this.closeAttribute(e,t,r),i},e.prototype.cdata=function(e,t,r){var n;return this.openNode(e,t,r),t.state=i.OpenTag,n=this.indent(e,t,r)+"<![CDATA[",t.state=i.InsideTag,n+=e.value,t.state=i.CloseTag,n+="]]>"+this.endline(e,t,r),t.state=i.None,this.closeNode(e,t,r),n},e.prototype.comment=function(e,t,r){var n;return this.openNode(e,t,r),t.state=i.OpenTag,n=this.indent(e,t,r)+"\x3c!-- ",t.state=i.InsideTag,n+=e.value,t.state=i.CloseTag,n+=" --\x3e"+this.endline(e,t,r),t.state=i.None,this.closeNode(e,t,r),n},e.prototype.declaration=function(e,t,r){var n;return this.openNode(e,t,r),t.state=i.OpenTag,n=this.indent(e,t,r)+"<?xml",t.state=i.InsideTag,n+=' version="'+e.version+'"',null!=e.encoding&&(n+=' encoding="'+e.encoding+'"'),null!=e.standalone&&(n+=' standalone="'+e.standalone+'"'),t.state=i.CloseTag,n+=t.spaceBeforeSlash+"?>",n+=this.endline(e,t,r),t.state=i.None,this.closeNode(e,t,r),n},e.prototype.docType=function(e,t,r){var n,a,o,s,c;if(r||(r=0),this.openNode(e,t,r),t.state=i.OpenTag,s=this.indent(e,t,r),s+="<!DOCTYPE "+e.root().name,e.pubID&&e.sysID?s+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(s+=' SYSTEM "'+e.sysID+'"'),e.children.length>0){for(s+=" [",s+=this.endline(e,t,r),t.state=i.InsideTag,a=0,o=(c=e.children).length;a<o;a++)n=c[a],s+=this.writeChildNode(n,t,r+1);t.state=i.CloseTag,s+="]"}return t.state=i.CloseTag,s+=t.spaceBeforeSlash+">",s+=this.endline(e,t,r),t.state=i.None,this.closeNode(e,t,r),s},e.prototype.element=function(e,r,n){var o,s,c,u,l,h,d,p,f,v,g,m,y,C;for(f in n||(n=0),v=!1,g="",this.openNode(e,r,n),r.state=i.OpenTag,g+=this.indent(e,r,n)+"<"+e.name,m=e.attribs)a.call(m,f)&&(o=m[f],g+=this.attribute(o,r,n));if(u=0===(c=e.children.length)?null:e.children[0],0===c||e.children.every((function(e){return(e.type===t.Text||e.type===t.Raw)&&""===e.value})))r.allowEmpty?(g+=">",r.state=i.CloseTag,g+="</"+e.name+">"+this.endline(e,r,n)):(r.state=i.CloseTag,g+=r.spaceBeforeSlash+"/>"+this.endline(e,r,n));else if(!r.pretty||1!==c||u.type!==t.Text&&u.type!==t.Raw||null==u.value){if(r.dontPrettyTextNodes)for(l=0,d=(y=e.children).length;l<d;l++)if(((s=y[l]).type===t.Text||s.type===t.Raw)&&null!=s.value){r.suppressPrettyCount++,v=!0;break}for(g+=">"+this.endline(e,r,n),r.state=i.InsideTag,h=0,p=(C=e.children).length;h<p;h++)s=C[h],g+=this.writeChildNode(s,r,n+1);r.state=i.CloseTag,g+=this.indent(e,r,n)+"</"+e.name+">",v&&r.suppressPrettyCount--,g+=this.endline(e,r,n),r.state=i.None}else g+=">",r.state=i.InsideTag,r.suppressPrettyCount++,v=!0,g+=this.writeChildNode(u,r,n+1),r.suppressPrettyCount--,v=!1,r.state=i.CloseTag,g+="</"+e.name+">"+this.endline(e,r,n);return this.closeNode(e,r,n),g},e.prototype.writeChildNode=function(e,r,i){switch(e.type){case t.CData:return this.cdata(e,r,i);case t.Comment:return this.comment(e,r,i);case t.Element:return this.element(e,r,i);case t.Raw:return this.raw(e,r,i);case t.Text:return this.text(e,r,i);case t.ProcessingInstruction:return this.processingInstruction(e,r,i);case t.Dummy:return"";case t.Declaration:return this.declaration(e,r,i);case t.DocType:return this.docType(e,r,i);case t.AttributeDeclaration:return this.dtdAttList(e,r,i);case t.ElementDeclaration:return this.dtdElement(e,r,i);case t.EntityDeclaration:return this.dtdEntity(e,r,i);case t.NotationDeclaration:return this.dtdNotation(e,r,i);default:throw new Error("Unknown XML node type: "+e.constructor.name)}},e.prototype.processingInstruction=function(e,t,r){var n;return this.openNode(e,t,r),t.state=i.OpenTag,n=this.indent(e,t,r)+"<?",t.state=i.InsideTag,n+=e.target,e.value&&(n+=" "+e.value),t.state=i.CloseTag,n+=t.spaceBeforeSlash+"?>",n+=this.endline(e,t,r),t.state=i.None,this.closeNode(e,t,r),n},e.prototype.raw=function(e,t,r){var n;return this.openNode(e,t,r),t.state=i.OpenTag,n=this.indent(e,t,r),t.state=i.InsideTag,n+=e.value,t.state=i.CloseTag,n+=this.endline(e,t,r),t.state=i.None,this.closeNode(e,t,r),n},e.prototype.text=function(e,t,r){var n;return this.openNode(e,t,r),t.state=i.OpenTag,n=this.indent(e,t,r),t.state=i.InsideTag,n+=e.value,t.state=i.CloseTag,n+=this.endline(e,t,r),t.state=i.None,this.closeNode(e,t,r),n},e.prototype.dtdAttList=function(e,t,r){var n;return this.openNode(e,t,r),t.state=i.OpenTag,n=this.indent(e,t,r)+"<!ATTLIST",t.state=i.InsideTag,n+=" "+e.elementName+" "+e.attributeName+" "+e.attributeType,"#DEFAULT"!==e.defaultValueType&&(n+=" "+e.defaultValueType),e.defaultValue&&(n+=' "'+e.defaultValue+'"'),t.state=i.CloseTag,n+=t.spaceBeforeSlash+">"+this.endline(e,t,r),t.state=i.None,this.closeNode(e,t,r),n},e.prototype.dtdElement=function(e,t,r){var n;return this.openNode(e,t,r),t.state=i.OpenTag,n=this.indent(e,t,r)+"<!ELEMENT",t.state=i.InsideTag,n+=" "+e.name+" "+e.value,t.state=i.CloseTag,n+=t.spaceBeforeSlash+">"+this.endline(e,t,r),t.state=i.None,this.closeNode(e,t,r),n},e.prototype.dtdEntity=function(e,t,r){var n;return this.openNode(e,t,r),t.state=i.OpenTag,n=this.indent(e,t,r)+"<!ENTITY",t.state=i.InsideTag,e.pe&&(n+=" %"),n+=" "+e.name,e.value?n+=' "'+e.value+'"':(e.pubID&&e.sysID?n+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(n+=' SYSTEM "'+e.sysID+'"'),e.nData&&(n+=" NDATA "+e.nData)),t.state=i.CloseTag,n+=t.spaceBeforeSlash+">"+this.endline(e,t,r),t.state=i.None,this.closeNode(e,t,r),n},e.prototype.dtdNotation=function(e,t,r){var n;return this.openNode(e,t,r),t.state=i.OpenTag,n=this.indent(e,t,r)+"<!NOTATION",t.state=i.InsideTag,n+=" "+e.name,e.pubID&&e.sysID?n+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.pubID?n+=' PUBLIC "'+e.pubID+'"':e.sysID&&(n+=' SYSTEM "'+e.sysID+'"'),t.state=i.CloseTag,n+=t.spaceBeforeSlash+">"+this.endline(e,t,r),t.state=i.None,this.closeNode(e,t,r),n},e.prototype.openNode=function(e,t,r){},e.prototype.closeNode=function(e,t,r){},e.prototype.openAttribute=function(e,t,r){},e.prototype.closeAttribute=function(e,t,r){},e}()}).call(this)},2046:function(e,t,r){(function(){var t,i,n,a,o,s,c,u,l,h;h=r(9241),u=h.assign,l=h.isFunction,n=r(7260),a=r(1933),o=r(400),c=r(382),s=r(6775),t=r(1737),i=r(8753),e.exports.create=function(e,t,r,i){var n,o;if(null==e)throw new Error("Root element needs a name.");return i=u({},t,r,i),o=(n=new a(i)).element(e),i.headless||(n.declaration(i),null==i.pubID&&null==i.sysID||n.dtd(i)),o},e.exports.begin=function(e,t,r){var i;return l(e)&&(t=(i=[e,t])[0],r=i[1],e={}),t?new o(e,t,r):new a(e)},e.exports.stringWriter=function(e){return new c(e)},e.exports.streamWriter=function(e,t){return new s(e,t)},e.exports.implementation=new n,e.exports.nodeType=t,e.exports.writerState=i}).call(this)},2613:e=>{"use strict";e.exports=require("assert")},181:e=>{"use strict";e.exports=require("buffer")},5317:e=>{"use strict";e.exports=require("child_process")},6982:e=>{"use strict";e.exports=require("crypto")},7194:e=>{"use strict";e.exports=require("dgram")},4434:e=>{"use strict";e.exports=require("events")},9896:e=>{"use strict";e.exports=require("fs")},8611:e=>{"use strict";e.exports=require("http")},9278:e=>{"use strict";e.exports=require("net")},857:e=>{"use strict";e.exports=require("os")},6928:e=>{"use strict";e.exports=require("path")},2203:e=>{"use strict";e.exports=require("stream")},3193:e=>{"use strict";e.exports=require("string_decoder")},3557:e=>{"use strict";e.exports=require("timers")},2018:e=>{"use strict";e.exports=require("tty")},7016:e=>{"use strict";e.exports=require("url")},9023:e=>{"use strict";e.exports=require("util")},6094:(e,t,r)=>{var i,n=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;
/**
   * @license
   * Copyright 2009 The Closure Library Authors
   * Copyright 2020 Daniel Wirtz / The long.js Authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *
   * SPDX-License-Identifier: Apache-2.0
   */
var t=null;try{if(r(857).cpus().find((e=>cpus.model.toLowerCase().includes("armv6"))))throw new Error("Workaround for V8 crashing on ARMv6 platform when using WASM");t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function i(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function n(e){return!0===(e&&e.__isLong__)}function a(e){var t=Math.clz32(e&-e);return e?31-t:t}i.prototype.__isLong__,Object.defineProperty(i.prototype,"__isLong__",{value:!0}),i.isLong=n;var o={},s={};function c(e,t){var r,i,n;return t?(n=0<=(e>>>=0)&&e<256)&&(i=s[e])?i:(r=l(e,0,!0),n&&(s[e]=r),r):(n=-128<=(e|=0)&&e<128)&&(i=o[e])?i:(r=l(e,e<0?-1:0,!1),n&&(o[e]=r),r)}function u(e,t){if(isNaN(e))return t?C:y;if(t){if(e<0)return C;if(e>=v)return A}else{if(e<=-g)return I;if(e+1>=g)return T}return e<0?u(-e,t).neg():l(e%f|0,e/f|0,t)}function l(e,t,r){return new i(e,t,r)}i.fromInt=c,i.fromNumber=u,i.fromBits=l;var h=Math.pow;function d(e,t,r){if(0===e.length)throw Error("empty string");if("number"==typeof t?(r=t,t=!1):t=!!t,"NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t?C:y;if((r=r||10)<2||36<r)throw RangeError("radix");var i;if((i=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===i)return d(e.substring(1),t,r).neg();for(var n=u(h(r,8)),a=y,o=0;o<e.length;o+=8){var s=Math.min(8,e.length-o),c=parseInt(e.substring(o,o+s),r);if(s<8){var l=u(h(r,s));a=a.mul(l).add(u(c))}else a=(a=a.mul(n)).add(u(c))}return a.unsigned=t,a}function p(e,t){return"number"==typeof e?u(e,t):"string"==typeof e?d(e,t):l(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}i.fromString=d,i.fromValue=p;var f=4294967296,v=f*f,g=v/2,m=c(1<<24),y=c(0);i.ZERO=y;var C=c(0,!0);i.UZERO=C;var S=c(1);i.ONE=S;var E=c(1,!0);i.UONE=E;var _=c(-1);i.NEG_ONE=_;var T=l(-1,2147483647,!1);i.MAX_VALUE=T;var A=l(-1,-1,!0);i.MAX_UNSIGNED_VALUE=A;var I=l(0,-2147483648,!1);i.MIN_VALUE=I;var D=i.prototype;D.toInt=function(){return this.unsigned?this.low>>>0:this.low},D.toNumber=function(){return this.unsigned?(this.high>>>0)*f+(this.low>>>0):this.high*f+(this.low>>>0)},D.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(I)){var t=u(e),r=this.div(t),i=r.mul(t).sub(this);return r.toString(e)+i.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var n=u(h(e,6),this.unsigned),a=this,o="";;){var s=a.div(n),c=(a.sub(s.mul(n)).toInt()>>>0).toString(e);if((a=s).isZero())return c+o;for(;c.length<6;)c="0"+c;o=""+c+o}},D.getHighBits=function(){return this.high},D.getHighBitsUnsigned=function(){return this.high>>>0},D.getLowBits=function(){return this.low},D.getLowBitsUnsigned=function(){return this.low>>>0},D.getNumBitsAbs=function(){if(this.isNegative())return this.eq(I)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return 0!=this.high?t+33:t+1},D.isZero=function(){return 0===this.high&&0===this.low},D.eqz=D.isZero,D.isNegative=function(){return!this.unsigned&&this.high<0},D.isPositive=function(){return this.unsigned||this.high>=0},D.isOdd=function(){return!(1&~this.low)},D.isEven=function(){return!(1&this.low)},D.equals=function(e){return n(e)||(e=p(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},D.eq=D.equals,D.notEquals=function(e){return!this.eq(e)},D.neq=D.notEquals,D.ne=D.notEquals,D.lessThan=function(e){return this.comp(e)<0},D.lt=D.lessThan,D.lessThanOrEqual=function(e){return this.comp(e)<=0},D.lte=D.lessThanOrEqual,D.le=D.lessThanOrEqual,D.greaterThan=function(e){return this.comp(e)>0},D.gt=D.greaterThan,D.greaterThanOrEqual=function(e){return this.comp(e)>=0},D.gte=D.greaterThanOrEqual,D.ge=D.greaterThanOrEqual,D.compare=function(e){if(n(e)||(e=p(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},D.comp=D.compare,D.negate=function(){return!this.unsigned&&this.eq(I)?I:this.not().add(S)},D.neg=D.negate,D.add=function(e){n(e)||(e=p(e));var t=this.high>>>16,r=65535&this.high,i=this.low>>>16,a=65535&this.low,o=e.high>>>16,s=65535&e.high,c=e.low>>>16,u=0,h=0,d=0,f=0;return d+=(f+=a+(65535&e.low))>>>16,h+=(d+=i+c)>>>16,u+=(h+=r+s)>>>16,u+=t+o,l((d&=65535)<<16|(f&=65535),(u&=65535)<<16|(h&=65535),this.unsigned)},D.subtract=function(e){return n(e)||(e=p(e)),this.add(e.neg())},D.sub=D.subtract,D.multiply=function(e){if(this.isZero())return this;if(n(e)||(e=p(e)),t)return l(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return this.unsigned?C:y;if(this.eq(I))return e.isOdd()?I:y;if(e.eq(I))return this.isOdd()?I:y;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(m)&&e.lt(m))return u(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,i=65535&this.high,a=this.low>>>16,o=65535&this.low,s=e.high>>>16,c=65535&e.high,h=e.low>>>16,d=65535&e.low,f=0,v=0,g=0,S=0;return g+=(S+=o*d)>>>16,v+=(g+=a*d)>>>16,g&=65535,v+=(g+=o*h)>>>16,f+=(v+=i*d)>>>16,v&=65535,f+=(v+=a*h)>>>16,v&=65535,f+=(v+=o*c)>>>16,f+=r*d+i*h+a*c+o*s,l((g&=65535)<<16|(S&=65535),(f&=65535)<<16|(v&=65535),this.unsigned)},D.mul=D.multiply,D.divide=function(e){if(n(e)||(e=p(e)),e.isZero())throw Error("division by zero");var r,i,a;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?l((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?C:y;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return C;if(e.gt(this.shru(1)))return E;a=C}else{if(this.eq(I))return e.eq(S)||e.eq(_)?I:e.eq(I)?S:(r=this.shr(1).div(e).shl(1)).eq(y)?e.isNegative()?S:_:(i=this.sub(e.mul(r)),a=r.add(i.div(e)));if(e.eq(I))return this.unsigned?C:y;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();a=y}for(i=this;i.gte(e);){r=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(r)/Math.LN2),s=o<=48?1:h(2,o-48),c=u(r),d=c.mul(e);d.isNegative()||d.gt(i);)d=(c=u(r-=s,this.unsigned)).mul(e);c.isZero()&&(c=S),a=a.add(c),i=i.sub(d)}return a},D.div=D.divide,D.modulo=function(e){return n(e)||(e=p(e)),t?l((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},D.mod=D.modulo,D.rem=D.modulo,D.not=function(){return l(~this.low,~this.high,this.unsigned)},D.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},D.clz=D.countLeadingZeros,D.countTrailingZeros=function(){return this.low?a(this.low):a(this.high)+32},D.ctz=D.countTrailingZeros,D.and=function(e){return n(e)||(e=p(e)),l(this.low&e.low,this.high&e.high,this.unsigned)},D.or=function(e){return n(e)||(e=p(e)),l(this.low|e.low,this.high|e.high,this.unsigned)},D.xor=function(e){return n(e)||(e=p(e)),l(this.low^e.low,this.high^e.high,this.unsigned)},D.shiftLeft=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):l(0,this.low<<e-32,this.unsigned)},D.shl=D.shiftLeft,D.shiftRight=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):l(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},D.shr=D.shiftRight,D.shiftRightUnsigned=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):l(32===e?this.high:this.high>>>e-32,0,this.unsigned)},D.shru=D.shiftRightUnsigned,D.shr_u=D.shiftRightUnsigned,D.rotateLeft=function(e){var t;return n(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?l(this.high,this.low,this.unsigned):e<32?(t=32-e,l(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(t=32-(e-=32),l(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))},D.rotl=D.rotateLeft,D.rotateRight=function(e){var t;return n(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?l(this.high,this.low,this.unsigned):e<32?(t=32-e,l(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(t=32-(e-=32),l(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))},D.rotr=D.rotateRight,D.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},D.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},D.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},D.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},D.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},i.fromBytes=function(e,t,r){return r?i.fromBytesLE(e,t):i.fromBytesBE(e,t)},i.fromBytesLE=function(e,t){return new i(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},i.fromBytesBE=function(e,t){return new i(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};var w=i;return e.default=w,"default"in e?e.default:e}({});void 0===(i=function(){return n}.apply(t,[]))||(e.exports=i)},26:(e,t)=>{var r,i=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.decode=function(e,t,r){if(t=~~t,(r=r||e.length-t)===i.size)return i.decode(e,t,r);if(r===n.size)return n.decode(e,t,r);throw Error(`Invalid buffer size needs to be ${i.size} for v4 or ${n.size} for v6.`)},e.encode=function(e,t,r){r=~~r;const o=a(e);"function"==typeof t&&(t=t(r+o));if(o===i.size)return i.encode(e,t,r);return n.encode(e,t,r)},e.familyOf=function(e){return a(e)===i.size?1:2},e.name=void 0,e.sizeOf=a,e.v6=e.v4=void 0;const t=/^(\d{1,3}\.){3,3}\d{1,3}$/,r=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i,i={name:"v4",size:4,isFormat:e=>t.test(e),encode(e,t,r){r=~~r,t=t||new Uint8Array(r+4);const i=e.length;let n=0;for(let a=0;a<i;){const i=e.charCodeAt(a++);46===i?(t[r++]=n,n=0):n=10*n+(i-48)}return t[r]=n,t},decode:(e,t)=>(t=~~t,`${e[t++]}.${e[t++]}.${e[t++]}.${e[t]}`)};e.v4=i;const n={name:"v6",size:16,isFormat:e=>e.length>0&&r.test(e),encode(e,t,r){let i=(r=~~r)+16,n=-1,a=0,o=0,s=!0,c=!1;t=t||new Uint8Array(r+16);for(let u=0;u<e.length;u++){let l=e.charCodeAt(u);58===l?(s?-1!==n?(r<i&&(t[r]=0),r<i-1&&(t[r+1]=0),r+=2):r<i&&(n=r):(!0===c?(r<i&&(t[r]=o),r++):(r<i&&(t[r]=a>>8),r<i-1&&(t[r+1]=255&a),r+=2),a=0,o=0),s=!0,c=!1):46===l?(r<i&&(t[r]=o),r++,o=0,a=0,s=!1,c=!0):(s=!1,l>=97?l-=87:l>=65?l-=55:(l-=48,o=10*o+l),a=(a<<4)+l)}if(!1===s)!0===c?(r<i&&(t[r]=o),r++):(r<i&&(t[r]=a>>8),r<i-1&&(t[r+1]=255&a),r+=2);else if(0===n)r<i&&(t[r]=0),r<i-1&&(t[r+1]=0),r+=2;else if(-1!==n){r+=2;for(let e=Math.min(r-1,i-1);e>=n+2;e--)t[e]=t[e-2];t[n]=0,t[n+1]=0,n=r}if(n!==r&&-1!==n)for(r>i-2&&(r=i-2);i>n;)t[--i]=r<i&&r>n?t[--r]:0;else for(;r<i;)t[r++]=0;return t},decode(e,t){t=~~t;let r="";for(let i=0;i<16;i+=2)0!==i&&(r+=":"),r+=(e[t+i]<<8|e[t+i+1]).toString(16);return r.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}};e.v6=n;function a(e){if(i.isFormat(e))return i.size;if(n.isFormat(e))return n.size;throw Error(`Invalid ip address: ${e}`)}return e.name="ip","default"in e?e.default:e}({});void 0===(r=function(){return i}.apply(t,[]))||(e.exports=r)},9209:(e,t,r)=>{"use strict";var i=r(6578),n="undefined"==typeof globalThis?global:globalThis;e.exports=function(){for(var e=[],t=0;t<i.length;t++)"function"==typeof n[i[t]]&&(e[e.length]=i[t]);return e}},1158:e=>{"use strict";var t=Symbol.iterator;e.exports=function(e){if(null!=e&&void 0!==e[t])return e[t]()}},1635:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__addDisposableResource:()=>B,__assign:()=>a,__asyncDelegator:()=>I,__asyncGenerator:()=>A,__asyncValues:()=>D,__await:()=>T,__awaiter:()=>f,__classPrivateFieldGet:()=>O,__classPrivateFieldIn:()=>P,__classPrivateFieldSet:()=>N,__createBinding:()=>g,__decorate:()=>s,__disposeResources:()=>x,__esDecorate:()=>u,__exportStar:()=>m,__extends:()=>n,__generator:()=>v,__importDefault:()=>R,__importStar:()=>U,__makeTemplateObject:()=>w,__metadata:()=>p,__param:()=>c,__propKey:()=>h,__read:()=>C,__rest:()=>o,__runInitializers:()=>l,__setFunctionName:()=>d,__spread:()=>S,__spreadArray:()=>_,__spreadArrays:()=>E,__values:()=>y,default:()=>M});var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},i(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return a=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},a.apply(this,arguments)};function o(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}function s(e,t,r,i){var n,a=arguments.length,o=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(o=(a<3?n(o):a>3?n(t,r,o):n(t,r))||o);return a>3&&o&&Object.defineProperty(t,r,o),o}function c(e,t){return function(r,i){t(r,i,e)}}function u(e,t,r,i,n,a){function o(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,c=i.kind,u="getter"===c?"get":"setter"===c?"set":"value",l=!t&&e?i.static?e:e.prototype:null,h=t||(l?Object.getOwnPropertyDescriptor(l,i.name):{}),d=!1,p=r.length-1;p>=0;p--){var f={};for(var v in i)f[v]="access"===v?{}:i[v];for(var v in i.access)f.access[v]=i.access[v];f.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(e||null))};var g=(0,r[p])("accessor"===c?{get:h.get,set:h.set}:h[u],f);if("accessor"===c){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(s=o(g.get))&&(h.get=s),(s=o(g.set))&&(h.set=s),(s=o(g.init))&&n.unshift(s)}else(s=o(g))&&("field"===c?n.unshift(s):h[u]=s)}l&&Object.defineProperty(l,i.name,h),d=!0}function l(e,t,r){for(var i=arguments.length>2,n=0;n<t.length;n++)r=i?t[n].call(e,r):t[n].call(e);return i?r:void 0}function h(e){return"symbol"==typeof e?e:"".concat(e)}function d(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,r,i){return new(r||(r=Promise))((function(n,a){function o(e){try{c(i.next(e))}catch(e){a(e)}}function s(e){try{c(i.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}c((i=i.apply(e,t||[])).next())}))}function v(e,t){var r,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(r=1,i&&(n=2&s[0]?i.return:s[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,s[1])).done)return n;switch(i=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(6===s[0]&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],i=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}var g=Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]};function m(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||g(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function C(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return o}function S(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(C(arguments[t]));return e}function E(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var i=Array(e),n=0;for(t=0;t<r;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,n++)i[n]=a[o];return i}function _(e,t,r){if(r||2===arguments.length)for(var i,n=0,a=t.length;n<a;n++)!i&&n in t||(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function T(e){return this instanceof T?(this.v=e,this):new T(e)}function A(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=r.apply(e,t||[]),a=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(e){n[e]&&(i[e]=function(t){return new Promise((function(r,i){a.push([e,t,r,i])>1||s(e,t)}))})}function s(e,t){try{(r=n[e](t)).value instanceof T?Promise.resolve(r.value.v).then(c,u):l(a[0][2],r)}catch(e){l(a[0][3],e)}var r}function c(e){s("next",e)}function u(e){s("throw",e)}function l(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function I(e){var t,r;return t={},i("next"),i("throw",(function(e){throw e})),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,n){t[i]=e[i]?function(t){return(r=!r)?{value:T(e[i](t)),done:!1}:n?n(t):t}:n}}function D(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=e[r]&&function(t){return new Promise((function(i,n){(function(e,t,r,i){Promise.resolve(i).then((function(t){e({value:t,done:r})}),t)})(i,n,(t=e[r](t)).done,t.value)}))}}}function w(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var b=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function U(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&g(t,e,r);return b(t,e),t}function R(e){return e&&e.__esModule?e:{default:e}}function O(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)}function N(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r}function P(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function B(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(void 0===i){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose]}if("function"!=typeof i)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:i,async:r})}else r&&e.stack.push({async:!0});return t}var L="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var i=new Error(r);return i.name="SuppressedError",i.error=e,i.suppressed=t,i};function x(e){function t(t){e.error=e.hasError?new L(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var i=e.stack.pop();try{var n=i.dispose&&i.dispose.call(i.value);if(i.async)return Promise.resolve(n).then(r,(function(e){return t(e),r()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const M={__extends:n,__assign:a,__rest:o,__decorate:s,__param:c,__metadata:p,__awaiter:f,__generator:v,__createBinding:g,__exportStar:m,__values:y,__read:C,__spread:S,__spreadArrays:E,__spreadArray:_,__await:T,__asyncGenerator:A,__asyncDelegator:I,__asyncValues:D,__makeTemplateObject:w,__importStar:U,__importDefault:R,__classPrivateFieldGet:O,__classPrivateFieldSet:N,__classPrivateFieldIn:P,__addDisposableResource:B,__disposeResources:x}},3325:e=>{"use strict";e.exports={rE:"1.2.0"}},4268:e=>{"use strict";e.exports=JSON.parse('[{"type":"a","child":[{"type":"(","child":[{"type":"y","child":[]},{"type":"v","child":[]}]}]}]')},8389:e=>{"use strict";e.exports=JSON.parse('{"name":"hap-nodejs","version":"0.12.1","description":"HAP-NodeJS is a Node.js implementation of HomeKit Accessory Server.","main":"dist/index.js","types":"dist/index.d.ts","maintainers":["Andreas Bauer <mail@anderl-bauer.de>"],"author":"Khaos Tian <khaos.tian@gmail.com> (https://tz.is/)","homepage":"https://github.com/homebridge/HAP-NodeJS","license":"Apache-2.0","scripts":{"clean":"rimraf dist && rimraf coverage","lint":"eslint \'src/**/*.{js,ts,json}\'","build":"rimraf dist && tsc && node .github/node-persist-ignore.js","prepublishOnly":"npm run build","postpublish":"npm run clean","test":"jest","test-coverage":"jest --coverage","start":"node dist/BridgedCore.js","docs":"typedoc","lint-docs":"typedoc --emit none --treatWarningsAsErrors"},"keywords":["hap-nodejs","hap","homekit","homekit-accessory-protocol","homekit-server","homekit-protocol","homekit-device","homekit-accessory","hap-server","homekit-support","siri"],"repository":{"type":"git","url":"git+https://github.com/homebridge/HAP-NodeJS.git"},"bugs":{"url":"https://github.com/homebridge/HAP-NodeJS/issues"},"engines":{"node":"^18 || ^20"},"files":["README.md","LICENSE","dist","@types"],"dependencies":{"@homebridge/ciao":"^1.2.0","@homebridge/dbus-native":"^0.6.0","bonjour-hap":"^3.7.2","debug":"^4.3.4","fast-srp-hap":"^2.0.4","futoin-hkdf":"^1.5.3","node-persist":"^0.0.11","source-map-support":"^0.5.21","tslib":"^2.6.2","tweetnacl":"^1.0.3"},"devDependencies":{"@types/debug":"^4.1.12","@types/escape-html":"^1.0.4","@types/jest":"^29.5.12","@types/node":"^10.17.60","@typescript-eslint/eslint-plugin":"^5.62.0","@typescript-eslint/parser":"^5.62.0","axios":"^1.6.8","commander":"^12.0.0","escape-html":"^1.0.3","eslint":"^8.57.0","http-parser-js":"^0.5.8","jest":"^29.7.0","rimraf":"^3.0.2","semver":"^7.6.2","simple-plist":"~1.1.1","ts-jest":"^29.1.2","ts-node":"^10.9.2","typedoc":"^0.25.13","typescript":"^4.9.5"}}')}},t={};function r(i){var n=t[i];if(void 0!==n)return n.exports;var a=t[i]={id:i,loaded:!1,exports:{}};return e[i].call(a.exports,a,a.exports,r),a.loaded=!0,a.exports}r.d=(e,t)=>{for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var i={};(()=>{"use strict";var e=i;Object.defineProperty(e,"__esModule",{value:!0}),e.HomekitManager=e.randomPinCode=e.createHAPUsername=void 0;const t=r(3103),n=r(6982),{spawn:a}=r(5317);t.HAPStorage.setCustomStoragePath(__dirname+"/storage");let o="0.0.0",s="0.0.0",c="C100X/C300X";function u(e){const r=e.getService(t.Service.AccessoryInformation);r.setCharacteristic(t.Characteristic.Manufacturer,"c300x-controller"),r.setCharacteristic(t.Characteristic.Model,c),r.setCharacteristic(t.Characteristic.SerialNumber,"v"+o),r.setCharacteristic(t.Characteristic.FirmwareRevision,s)}class l{constructor(e,r,i,n){if(this.name=e,this.onFunction=i,this.offFunction=n,this.pollerFunction=r,this.uuid=t.uuid.generate("hap-nodejs:accessories:switch:"+e),this.accessory=new t.Accessory(e,this.uuid),this.switchService=this.accessory.addService(t.Service.Switch,e),this.switchService.getCharacteristic(t.Characteristic.On).on("set",((e,t)=>{e?this.onFunction():this.offFunction(),t(null)})),this.pollerFunction){const e=(a=500,o=5e3,Math.round(Math.random()*(o-a)+a));setTimeout((()=>{this.updateSwitchState()}),e)}var a,o}updateSwitchState(){this.pollerFunction().then((e=>{this.switchService.getCharacteristic(t.Characteristic.On).updateValue(e)})).finally((()=>{setTimeout((()=>{this.updateSwitchState()}),6e4)}))}}class h{constructor(e,r,i){this.locked=!0,this.name=e,this.unlockFunction=r,this.lockFunction=i,this.uuid=t.uuid.generate("hap-nodejs:accessories:lock:"+e),this.accessory=new t.Accessory(e,this.uuid),u(this.accessory),this.lockService=this.accessory.addService(t.Service.LockMechanism,e),this.lockService.getCharacteristic(t.Characteristic.LockTargetState).on("set",((e,r)=>{e===t.Characteristic.LockTargetState.UNSECURED?(this.locked=!1,this.unlockFunction(),r(),this.lockService.updateCharacteristic(t.Characteristic.LockCurrentState,t.Characteristic.LockCurrentState.UNSECURED),setTimeout((()=>{this.locked=!0,this.lockFunction&&this.lockFunction(),this.lockService.updateCharacteristic(t.Characteristic.LockCurrentState,t.Characteristic.LockTargetState.SECURED),this.lockService.updateCharacteristic(t.Characteristic.LockTargetState,t.Characteristic.LockTargetState.SECURED)}),3e3)):e===t.Characteristic.LockTargetState.SECURED&&(r(),this.lockService.updateCharacteristic(t.Characteristic.LockCurrentState,t.Characteristic.LockCurrentState.SECURED))})),this.lockService.getCharacteristic(t.Characteristic.LockCurrentState).on("get",(e=>{this.locked?e(void 0,t.Characteristic.LockCurrentState.SECURED):e(void 0,t.Characteristic.LockCurrentState.UNSECURED)})),this.lockService.updateCharacteristic(t.Characteristic.LockTargetState,t.Characteristic.LockCurrentState.SECURED)}}function d(){return Math.round(1e5*Math.random())%10}e.createHAPUsername=function(){const e=[];for(let t=0;t<6;t++)e.push((0,n.randomBytes)(1).toString("hex"));return e.join(":")},e.randomPinCode=function(){return`${d()}${d()}${d()}-${d()}${d()}-${d()}${d()}${d()}`};e.HomekitManager=class{constructor(e,r,i){c=i,o=r,this.bridge=new t.Bridge(e.displayName,t.uuid.generate("hap-nodejs:bridges:homebridge")),u(this.bridge),console.log("Bridge pin code: "+e.pinCode),this.bridge.publish({username:e.username,pincode:e.pinCode,category:2,addIdentifyingMaterial:!1}),this.bridge._server.on("listening",(e=>{console.log("Accessory is bound to port:",e)}))}addLock(e,t,r){const i=new h(e,t,r);this.bridge.addBridgedAccessory(i.accessory)}addSwitch(e,t,r,i){const n=new l(e,t,r,i);u(n.accessory),this.bridge.addBridgedAccessory(n.accessory)}updateFirmwareVersion(e){s=e,u(this.bridge),this.bridge.bridgedAccessories.forEach((e=>{u(e)}))}}})();for(var n in i)this[n]=i[n];i.__esModule&&Object.defineProperty(this,"__esModule",{value:!0})})();
//# sourceMappingURL=homekit-bundle.js.map