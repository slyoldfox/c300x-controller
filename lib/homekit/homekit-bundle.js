// =======================================================================================================================
// DO NOT EDIT, this is a generated file, generate it with $ npm run build:homekitbundle:dev or npm run build:homekitbundle:prod
// =======================================================================================================================
(()=>{var e={141:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CiaoService=t.InternalServiceEvent=t.ServiceEvent=t.ServiceState=t.ServiceType=void 0;const i=r(1635),n=i.__importDefault(r(2613)),o=i.__importDefault(r(5753)),a=r(4434),s=i.__importDefault(r(9278)),c=r(1360),u=r(4495),l=r(6343),h=r(482),d=r(8225),p=r(1576),f=r(5231),g=r(8318),m=r(8937),v=r(7585),y=i.__importStar(r(9152)),C=r(9152),S=(0,o.default)("ciao:CiaoService"),E=/^(.*) \((\d+)\)$/,_=/^(.*)-\((\d+)\)(\.\w{2,}.)$/;var T,A,I,D;!function(e){e.AIRDROP="airdrop",e.AIRPLAY="airplay",e.AIRPORT="airport",e.COMPANION_LINK="companion-link",e.DACP="dacp",e.HAP="hap",e.HOMEKIT="homekit",e.HTTP="http",e.HTTP_ALT="http_alt",e.IPP="ipp",e.IPPS="ipps",e.RAOP="raop",e.scanner="scanner",e.TOUCH_ABLE="touch-able",e.DNS_SD="dns-sd",e.PRINTER="printer"}(T||(t.ServiceType=T={})),function(e){e.UNANNOUNCED="unannounced",e.PROBING="probing",e.PROBED="probed",e.ANNOUNCING="announcing",e.ANNOUNCED="announced"}(A||(t.ServiceState=A={})),function(e){e.NAME_CHANGED="name-change",e.HOSTNAME_CHANGED="hostname-change"}(I||(t.ServiceEvent=I={})),function(e){e.PUBLISH="publish",e.UNPUBLISH="unpublish",e.REPUBLISH="republish",e.RECORD_UPDATE="records-update",e.RECORD_UPDATE_ON_INTERFACE="records-update-interface"}(D||(t.InternalServiceEvent=D={}));class w extends a.EventEmitter{constructor(e,t){if(super(),this.serviceState="unannounced",this.destroyed=!1,(0,n.default)(e,"networkManager is required"),(0,n.default)(t,"parameters options is required"),(0,n.default)(t.name,"service options parameter 'name' is required"),(0,n.default)(t.type,"service options parameter 'type' is required"),(0,n.default)(t.type.length<=15,"service options parameter 'type' must not be longer than 15 characters"),this.networkManager=e,this.name=t.name,this.type=t.type,this.subTypes=t.subtypes,this.protocol=t.protocol||"tcp",this.serviceDomain=t.domain||"local",this.fqdn=this.formatFQDN(),this.loweredFqdn=(0,v.dnsLowerCase)(this.fqdn),this.typePTR=y.stringify({type:this.type,protocol:this.protocol,domain:this.serviceDomain}),this.loweredTypePTR=(0,v.dnsLowerCase)(this.typePTR),this.subTypes&&(this.subTypePTRs=this.subTypes.map((e=>y.stringify({subtype:e,type:this.type,protocol:this.protocol,domain:this.serviceDomain}))).map(v.dnsLowerCase)),this.hostname=y.formatHostname(t.hostname||this.name,this.serviceDomain).replace(/ /g,"-"),this.loweredHostname=(0,v.dnsLowerCase)(this.hostname),this.port=t.port,t.restrictedAddresses){(0,n.default)(t.restrictedAddresses.length,"The service property 'restrictedAddresses' cannot be an empty array!"),this.restrictedAddresses=new Map;for(const e of t.restrictedAddresses)if(s.default.isIP(e)){if("0.0.0.0"===e||"::"===e)throw new Error(`[${this.fqdn}] Unspecified ip address (${e}) cannot be used to restrict on to!`);const t=m.NetworkManager.resolveInterface(e);if(!t)throw new Error(`[${this.fqdn}] Could not restrict service to address ${e} as we could not resolve it to an interface name!`);const r=this.restrictedAddresses.get(t);r?r.length&&!r.includes(e)&&r.push(e):this.restrictedAddresses.set(t,[e])}else this.restrictedAddresses.set(e,[])}this.disableIpv6=t.disabledIpv6,this.txt=t.txt?w.txtBuffersFromRecord(t.txt):[],this.incrementName(!0)}advertise(){return(0,n.default)(!this.destroyed,"Cannot publish destroyed service!"),(0,n.default)(this.port,"Service port must be defined before advertising the service on the network!"),0===this.listeners("name-change").length&&S("[%s] WARN: No listeners found for a potential name change on the 'name-change' event!",this.name),new Promise(((e,t)=>{this.emit("publish",(r=>r?t(r):e()))}))}end(){return(0,n.default)(!this.destroyed,"Cannot end destroyed service!"),"unannounced"===this.serviceState?Promise.resolve():new Promise(((e,t)=>{this.emit("unpublish",(r=>r?t(r):e()))}))}async destroy(){await this.end(),this.destroyed=!0,this.removeAllListeners()}getFQDN(){return this.fqdn}getTypePTR(){return this.typePTR}getLowerCasedSubtypePTRs(){return this.subTypePTRs}getHostname(){return this.hostname}getPort(){return this.port||-1}getTXT(){return this.txt}getLowerCasedFQDN(){return this.loweredFqdn}getLowerCasedTypePTR(){return this.loweredTypePTR}getLowerCasedHostname(){return this.loweredHostname}updateTxt(e,t=!1){if((0,n.default)(!this.destroyed,"Cannot update destroyed service!"),(0,n.default)(e,"txt cannot be undefined"),this.txt=w.txtBuffersFromRecord(e),S("[%s] Updating txt record%s...",this.name,t?" silently":""),"announcing"===this.serviceState){if(this.rebuildServiceRecords(),t)return;this.currentAnnouncer.hasSentLastAnnouncement()&&this.currentAnnouncer.awaitAnnouncement().then((()=>{this.queueTxtUpdate()}))}else if("announced"===this.serviceState){if(this.rebuildServiceRecords(),t)return;this.queueTxtUpdate()}}queueTxtUpdate(){this.txtTimer||(this.txtTimer=setTimeout((()=>{this.txtTimer=void 0,"announced"===this.serviceState&&this.emit("records-update",{answers:[this.txtRecord()],additionals:[this.serviceNSECRecord()]})}),50))}updatePort(e){(0,n.default)("unannounced"===this.serviceState,"Port number cannot be changed when service is already advertised!"),this.port=e}updateName(e){return"unannounced"===this.serviceState?(this.name=e,this.fqdn=this.formatFQDN(),this.loweredFqdn=(0,v.dnsLowerCase)(this.fqdn),Promise.resolve()):this.end().then((()=>(this.name=e,this.fqdn=this.formatFQDN(),this.loweredFqdn=(0,v.dnsLowerCase)(this.fqdn),this.advertise())))}static txtBuffersFromRecord(e){const t=[];return Object.entries(e).forEach((([e,r])=>{const i=e+"="+r;t.push(Buffer.from(i))})),t}handleNetworkInterfaceUpdate(e){(0,n.default)(!this.destroyed,"Cannot update network of destroyed service!"),"announced"===this.serviceState?(this.rebuildServiceRecords(),(e.added||e.changes)&&this.emit("republish",(e=>{e&&(console.log("FATAL Error occurred trying to re-announce service "+this.fqdn+"! We can't recover from this!"),console.log(e.stack),process.exit(1))}))):"announcing"===this.serviceState&&(this.rebuildServiceRecords(),this.currentAnnouncer.hasSentLastAnnouncement()&&this.currentAnnouncer.awaitAnnouncement().then((()=>{this.handleNetworkInterfaceUpdate(e)})))}incrementName(e){if("unannounced"!==this.serviceState)throw new Error("Service name can only be incremented when in state UNANNOUNCED!");const t=this.name,r=this.hostname;let i,o,a,s,c;const u=this.name.match(E);u?(i=u[1],o=parseInt(u[2]),(0,n.default)(o,`Failed to extract name number from ${this.name}. Resulted in ${o}`)):(i=this.name,o=1);const l=this.hostname.match(_);if(l)a=l[1],s=l[3],c=parseInt(l[2]),(0,n.default)(c,`Failed to extract hostname number from ${this.hostname}. Resulted in ${c}`);else{const e=this.hostname.substring(0,this.hostname.length-1).lastIndexOf(".");a=this.hostname.slice(0,e),s=this.hostname.slice(e),c=1}e||(o++,c++);const h=Math.max(o,c);this.name=1===h?i:`${i} (${h})`,this.hostname=1===h?`${a}${s}`:`${a}-(${h})${s}`,this.loweredHostname=(0,v.dnsLowerCase)(this.hostname),this.fqdn=this.formatFQDN(),this.loweredFqdn=(0,v.dnsLowerCase)(this.fqdn),this.name===t&&this.hostname===r||S("[%s] Service changed name '%s' -> '%s', '%s' -> '%s'",this.name,t,this.name,r,this.hostname),e||this.rebuildServiceRecords()}informAboutNameUpdates(){const e=this.emit("name-change",this.name),t=this.emit("hostname-change",y.removeTLD(this.hostname));e||t||console.warn(`CIAO: [${this.name}] Service changed name but nobody was listening on the 'name-change' event!`)}formatFQDN(){if("unannounced"!==this.serviceState)throw new Error("Name can't be changed after service was already announced!");const e=y.stringify({name:this.name,type:this.type,protocol:this.protocol,domain:this.serviceDomain});return(0,n.default)(e.length<=255,"A fully qualified domain name cannot be longer than 255 characters"),e}rebuildServiceRecords(){(0,n.default)(this.port,"port must be set before building records"),S("[%s] Rebuilding service records...",this.name);const e={},t={},r={},i={},o={};let a;for(const[n,a]of this.networkManager.getInterfaceMap()){if(!this.advertisesOnInterface(n,!0))continue;let s=this.restrictedAddresses?this.restrictedAddresses.get(n):void 0;s&&0===s.length&&(s=void 0),!a.ipv4||s&&!s.includes(a.ipv4)||(e[n]=new u.ARecord(this.hostname,a.ipv4,!0),o[a.ipv4]=new h.PTRRecord((0,C.formatReverseAddressPTRName)(a.ipv4),this.hostname)),!a.ipv6||this.disableIpv6||s&&!s.includes(a.ipv6)||(t[n]=new c.AAAARecord(this.hostname,a.ipv6,!0),o[a.ipv6]=new h.PTRRecord((0,C.formatReverseAddressPTRName)(a.ipv6),this.hostname)),!a.globallyRoutableIpv6||this.disableIpv6||s&&!s.includes(a.globallyRoutableIpv6)||(r[n]=new c.AAAARecord(this.hostname,a.globallyRoutableIpv6,!0),o[a.globallyRoutableIpv6]=new h.PTRRecord((0,C.formatReverseAddressPTRName)(a.globallyRoutableIpv6),this.hostname)),!a.uniqueLocalIpv6||this.disableIpv6||s&&!s.includes(a.uniqueLocalIpv6)||(i[n]=new c.AAAARecord(this.hostname,a.uniqueLocalIpv6,!0),o[a.uniqueLocalIpv6]=new h.PTRRecord((0,C.formatReverseAddressPTRName)(a.uniqueLocalIpv6),this.hostname))}if(this.subTypePTRs){a=[];for(const e of this.subTypePTRs)a.push(new h.PTRRecord(e,this.fqdn))}this.serviceRecords={ptr:new h.PTRRecord(this.typePTR,this.fqdn),subtypePTRs:a,metaQueryPtr:new h.PTRRecord(g.Responder.SERVICE_TYPE_ENUMERATION_NAME,this.typePTR),srv:new d.SRVRecord(this.fqdn,this.hostname,this.port,!0),txt:new p.TXTRecord(this.fqdn,this.txt,!0),serviceNSEC:new l.NSECRecord(this.fqdn,this.fqdn,[16,33],4500,!0),a:e,aaaa:t,aaaaR:r,aaaaULA:i,reverseAddressPTRs:o,addressNSEC:new l.NSECRecord(this.hostname,this.hostname,[1,28],120,!0)}}advertisesOnInterface(e,t){var r,i,n,o;return!this.restrictedAddresses||this.restrictedAddresses.has(e)&&(t||!!(null===(r=this.serviceRecords)||void 0===r?void 0:r.a[e])||!!(null===(i=this.serviceRecords)||void 0===i?void 0:i.aaaa[e])||!!(null===(n=this.serviceRecords)||void 0===n?void 0:n.aaaaR[e])||!!(null===(o=this.serviceRecords)||void 0===o?void 0:o.aaaaULA[e]))}ptrRecord(){return this.serviceRecords.ptr.clone()}subtypePtrRecords(){return this.serviceRecords.subtypePTRs?f.ResourceRecord.clone(this.serviceRecords.subtypePTRs):[]}metaQueryPtrRecord(){return this.serviceRecords.metaQueryPtr.clone()}srvRecord(){return this.serviceRecords.srv.clone()}txtRecord(){return this.serviceRecords.txt.clone()}aRecord(e){const t=this.serviceRecords.a[e];return t?t.clone():void 0}aaaaRecord(e){const t=this.serviceRecords.aaaa[e];return t?t.clone():void 0}aaaaRoutableRecord(e){const t=this.serviceRecords.aaaaR[e];return t?t.clone():void 0}aaaaUniqueLocalRecord(e){const t=this.serviceRecords.aaaaULA[e];return t?t.clone():void 0}allAddressRecords(){const e=[];return Object.values(this.serviceRecords.a).forEach((t=>{e.push(t.clone())})),Object.values(this.serviceRecords.aaaa).forEach((t=>{e.push(t.clone())})),Object.values(this.serviceRecords.aaaaR).forEach((t=>{e.push(t.clone())})),Object.values(this.serviceRecords.aaaaULA).forEach((t=>{e.push(t.clone())})),e}addressNSECRecord(){return this.serviceRecords.addressNSEC.clone()}serviceNSECRecord(e=!1){const t=this.serviceRecords.serviceNSEC.clone();return e&&(t.ttl=120),t}hasAddress(e){return!!this.serviceRecords.reverseAddressPTRs[e]}}t.CiaoService=w},2361:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MDNSServer=t.SendResultFormatError=t.SendResultFailedRatio=void 0;const i=r(1635),n=i.__importDefault(r(2613)),o=i.__importDefault(r(5753)),a=i.__importDefault(r(7194)),s=r(4119),c=r(8937),u=r(9152),l=r(16),h=r(8390),d=(0,o.default)("ciao:MDNSServer");t.SendResultFailedRatio=function(e){if(0===e.length)return 0;let t=0;for(const r of e)"fulfilled"!==r.status&&t++;return t/e.length},t.SendResultFormatError=function(e,t,r=!1){let i=0;for(const t of e)"fulfilled"!==t.status&&i++;if(t||(t="Failed to send packets"),i<e.length?t+=` (${i}/${e.length}):`:t+=":",r){let r="=============================\n"+t;for(const t of e)"rejected"===t.status?r+="\n--------------------\nFailed to send packet on interface "+t.interface+": "+t.reason.stack:"timeout"===t.status&&(r+="\n--------------------\nSending packet on interface "+t.interface+" timed out!");return r+="\n=============================",r}{let r=t;for(const t of e)"rejected"===t.status?r+="\n- Failed to send packet on interface "+t.interface+": "+t.reason.message:"timeout"===t.status&&(r+="\n- Sending packet on interface "+t.interface+" timed out!");return r}};class p{constructor(e,t){this.sockets=new Map,this.sentPackets=new Map,this.suppressUnicastResponseFlag=!1,this.bound=!1,this.closed=!1,(0,n.default)(e,"handler cannot be undefined"),this.handler=e,this.networkManager=new c.NetworkManager({interface:t&&t.interface,excludeIpv6:t&&t.disableIpv6,excludeIpv6Only:!0}),this.networkManager.on("network-update",this.handleUpdatedNetworkInterfaces.bind(this))}getNetworkManager(){return this.networkManager}getBoundInterfaceNames(){return this.sockets.keys()}async bind(){if(this.closed)throw new Error("Cannot rebind closed server!");this.suppressUnicastResponseFlag=!0,await this.networkManager.waitForInit();const e=[];for(const[t,r]of this.networkManager.getInterfaceMap()){const i=this.createDgramSocket(t,!0),n=this.bindSocket(i,r,"IPv4").catch((e=>{console.log("Could not bind detected network interface: "+e.stack)}));e.push(n)}return Promise.all(e).then((()=>{this.bound=!0}))}shutdown(){this.networkManager.shutdown();for(const e of this.sockets.values())e.close();this.bound=!1,this.closed=!0,this.sockets.clear()}sendQueryBroadcast(e,t){const r=s.DNSPacket.createDNSQueryPackets(e);r.length>1&&d("Query broadcast is split into %d packets!",r.length);const i=[];for(const e of r)i.push(this.sendOnAllNetworksForService(e,t));return Promise.all(i).then((e=>{const t=[];for(const r of e)t.concat(r);return t}))}sendResponseBroadcast(e,t){const r=s.DNSPacket.createDNSResponsePacketsFromRRSet(e);return this.sendOnAllNetworksForService(r,t)}sendResponse(e,t,r){this.send(e,t).then((e=>{"rejected"===e.status?r?r(new Error("Encountered socket error on "+e.reason.name+": "+e.reason.message)):p.logSocketError(e.interface,e.reason):r&&r()}))}sendOnAllNetworksForService(e,t){this.checkUnicastResponseFlag(e);const r=e.encode();this.assertBeforeSend(r,"IPv4");const i=[];for(const[e,n]of this.sockets){if(!t.advertisesOnInterface(e))continue;const o=new Promise((t=>{n.send(r,p.MDNS_PORT,p.MULTICAST_IPV4,(i=>{if(i){if(!p.isSilencedSocketError(i))return void t({status:"rejected",interface:e,reason:i})}else this.maintainSentPacketsInterface(e,r);t({status:"fulfilled",interface:e})}))}));i.push(Promise.race([o,(0,h.PromiseTimeout)(p.SEND_TIMEOUT).then((()=>({status:"timeout",interface:e})))]))}return Promise.all(i)}send(e,t){this.checkUnicastResponseFlag(e);const r=e.encode();let i,n,o;this.assertBeforeSend(r,"IPv4"),"string"==typeof t?(i=p.MULTICAST_IPV4,n=p.MDNS_PORT,o=t):(i=t.address,n=t.port,o=t.interface);const a=this.sockets.get(o);if(!a)throw new l.InterfaceNotFoundError(`Could not find socket for given network interface '${o}'`);return new Promise((e=>{a.send(r,n,i,(t=>{if(t){if(!p.isSilencedSocketError(t))return void e({status:"rejected",interface:o,reason:t})}else this.maintainSentPacketsInterface(o,r);e({status:"fulfilled",interface:o})}))}))}checkUnicastResponseFlag(e){this.suppressUnicastResponseFlag&&0===e.type&&e.questions.forEach((e=>e.unicastResponseFlag=!1))}assertBeforeSend(e,t){if(this.closed)throw new l.ServerClosedError("Cannot send packets on a closed mdns server!");(0,n.default)(this.bound,"Cannot send packets before server is not bound!");const r="IPv4"===t?p.DEFAULT_IP4_HEADER:p.DEFAULT_IP6_HEADER;(0,n.default)(r+p.UDP_HEADER+e.length<=9e3,"DNS cannot exceed the size of 9000 bytes even with IP Fragmentation!")}maintainSentPacketsInterface(e,t){const r=t.toString("base64"),i=this.sentPackets.get(e);i?i.push(r):this.sentPackets.set(e,[r])}checkIfPacketWasPreviouslySentFromUs(e,t){const r=t.toString("base64"),i=this.sentPackets.get(e);if(i){const e=i.indexOf(r);if(-1!==e)return i.splice(e,1),!0}return!1}createDgramSocket(e,t=!1,r="udp4"){const i=a.default.createSocket({type:r,reuseAddr:t});return i.on("message",this.handleMessage.bind(this,e)),i.on("error",(t=>{p.isSilencedSocketError(t)||p.logSocketError(e,t)})),i}bindSocket(e,t,r){return new Promise(((i,o)=>{const a=e=>o(new Error("Failed to bind on interface "+t.name+": "+e.message));e.once("error",a),e.on("close",(()=>{this.sockets.delete(t.name)})),e.bind(p.MDNS_PORT,(()=>{e.setRecvBufferSize(819200),e.removeListener("error",a);const s="IPv4"===r?p.MULTICAST_IPV4:p.MULTICAST_IPV6,c="IPv4"===r?t.ipv4:t.ipv6;(0,n.default)(c,"Interface address for "+t.name+" cannot be undefined!");try{e.addMembership(s,c),e.setMulticastInterface(c),e.setMulticastTTL(p.MDNS_TTL),e.setTTL(p.MDNS_TTL),e.setMulticastLoopback(!0),this.sockets.set(t.name,e),i()}catch(r){try{e.close()}catch(e){d("Error while closing socket which failed to bind. Error may be expected: "+e.message)}o(new Error("Error binding socket on "+t.name+": "+r.stack))}}))}))}handleMessage(e,t,r){if(!this.bound)return;const i=this.networkManager.getInterface(e);if(!i)return void d("Received packet on non existing network interface: %s!",e);if(this.checkIfPacketWasPreviouslySentFromUs(i.name,t))return;const n=(0,u.getNetAddress)(r.address,i.ip4Netmask);if(i.loopback){if(n!==i.ipv4Netaddress)return}else if(this.networkManager.isLoopbackNetaddressV4(n))return void d("Received packet on interface '%s' which is not coming from the same subnet: %o",e,{address:r.address,netaddress:n,interface:i.ipv4});let o;try{o=s.DNSPacket.decode(r,t)}catch(i){return void d("Received a malformed packet from %o on interface %s. This might or might not be a problem. Here is the received packet for debugging purposes '%s'. Packet decoding failed with %s",r,e,t.toString("base64"),i.stack)}if(0!==o.opcode)return;if(0!==o.rcode)return;const a={address:r.address,port:r.port,interface:e};if(0===o.type)try{this.handler.handleQuery(o,a)}catch(t){console.warn("Error occurred handling incoming (on "+e+") dns query packet: "+t.stack)}else if(1===o.type){if(r.port!==p.MDNS_PORT)return;try{this.handler.handleResponse(o,a)}catch(t){console.warn("Error occurred handling incoming (on "+e+") dns response packet: "+t.stack)}}}static isSilencedSocketError(e){const t=e.message.includes("EADDRNOTAVAIL")||e.message.includes("EHOSTDOWN")||e.message.includes("ENETUNREACH")||e.message.includes("EHOSTUNREACH")||e.message.includes("EPERM")||e.message.includes("EINVAL");return t&&d("Silenced and ignored error (This is/should not be a problem, this message is only for informational purposes): "+e.message),t}static logSocketError(e,t){console.warn(`Encountered MDNS socket error on socket '${e}' : ${t.stack}`)}handleUpdatedNetworkInterfaces(e){if(e.removed)for(const t of e.removed){const e=this.sockets.get(t.name);this.sockets.delete(t.name),e&&e.close()}if(e.changes)for(const t of e.changes){const e=this.sockets.get(t.name);if((0,n.default)(e,"Couldn't find socket for network change!"),!t.outdatedIpv4&&t.updatedIpv4)n.default.fail("Reached illegal state! IPv4 address changed from undefined to defined!");else if(t.outdatedIpv4&&!t.updatedIpv4)n.default.fail("Reached illegal state! IPV4 address change from defined to undefined!");else if(t.outdatedIpv4&&t.updatedIpv4){try{e.dropMembership(p.MULTICAST_IPV4,t.outdatedIpv4)}catch(e){d("Thrown expected error when dropping outdated address membership: "+e.message)}try{e.addMembership(p.MULTICAST_IPV4,t.updatedIpv4)}catch(e){d("Thrown expected error when adding new address membership: "+e.message)}e.setMulticastInterface(t.updatedIpv4)}}if(e.added)for(const t of e.added){const e=this.createDgramSocket(t.name,!0);this.bindSocket(e,t,"IPv4").catch((e=>{console.log("Could not bind detected network interface: "+e.stack)}))}}}t.MDNSServer=p,p.DEFAULT_IP4_HEADER=20,p.DEFAULT_IP6_HEADER=40,p.UDP_HEADER=8,p.MDNS_PORT=5353,p.MDNS_TTL=255,p.MULTICAST_IPV4="224.0.0.251",p.MULTICAST_IPV6="FF02::FB",p.SEND_TIMEOUT=200},8937:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkManager=t.NetworkManagerEvent=t.WifiState=t.IPFamily=void 0;const i=r(1635),n=i.__importDefault(r(2613)),o=i.__importDefault(r(5317)),a=i.__importDefault(r(5753)),s=r(4434),c=i.__importDefault(r(2017)),u=i.__importDefault(r(9278)),l=i.__importDefault(r(857)),h=r(9152),d=(0,a.default)("ciao:NetworkManager");var p,f,g;!function(e){e.IPv4="IPv4",e.IPv6="IPv6"}(p||(t.IPFamily=p={})),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.NOT_A_WIFI_INTERFACE=1]="NOT_A_WIFI_INTERFACE",e[e.NOT_ASSOCIATED=2]="NOT_ASSOCIATED",e[e.CONNECTED=3]="CONNECTED"}(f||(t.WifiState=f={})),function(e){e.NETWORK_UPDATE="network-update"}(g||(t.NetworkManagerEvent=g={}));class m extends s.EventEmitter{constructor(e){if(super(),this.currentInterfaces=new Map,this.loopbackInterfaces=new Map,this.setMaxListeners(100),e&&e.interface){let t;if("string"==typeof e.interface)t=[e.interface];else{if(!Array.isArray(e.interface))throw new Error("Found invalid type for 'interfaces' NetworkManager option!");t=e.interface}const r=[];for(const i of t)if(u.default.isIP(i)){const t=m.resolveInterface(i);t?r.push(t):console.log("CIAO: Interface was specified as ip (%s), though couldn't find a matching interface for the given address.",e.interface)}else r.push(i);0===r.length?console.log("CIAO: 'restrictedInterfaces' array was empty. Going to fallback to bind on all available interfaces."):this.restrictedInterfaces=r}this.excludeIpv6=!(!e||!e.excludeIpv6),this.excludeIpv6Only=this.excludeIpv6||!(!e||!e.excludeIpv6Only),e&&d("Created NetworkManager with options: %s",JSON.stringify(e)),this.initPromise=new Promise((e=>{this.getCurrentNetworkInterfaces().then((t=>{this.currentInterfaces=t;const r=Object.keys(l.default.networkInterfaces()),i=[];for(const e of this.currentInterfaces.keys()){i.push(e);const t=r.indexOf(e);-1!==t&&r.splice(t,1)}d("Initial networks [%s] ignoring [%s]",i.join(", "),r.join(", ")),this.initPromise=void 0,e(),this.scheduleNextJob()}))}))}async waitForInit(){this.initPromise&&await this.initPromise}shutdown(){this.currentTimer&&(clearTimeout(this.currentTimer),this.currentTimer=void 0),this.removeAllListeners()}getInterfaceMap(){return this.initPromise&&n.default.fail("Not yet initialized!"),this.currentInterfaces}getInterface(e){return this.initPromise&&n.default.fail("Not yet initialized!"),this.currentInterfaces.get(e)}isLoopbackNetaddressV4(e){for(const t of this.loopbackInterfaces.values())if(t.ipv4Netaddress===e)return!0;return!1}scheduleNextJob(){this.currentTimer=setTimeout(this.checkForNewInterfaces.bind(this),m.POLLING_TIME),this.currentTimer.unref()}async checkForNewInterfaces(){const e=await this.getCurrentNetworkInterfaces();if(!this.currentTimer)return;let t,r,i;for(const[r,n]of e){const e=this.currentInterfaces.get(r);if(e){if(!(0,c.default)(e,n)){const t={name:r};e.ipv4!==n.ipv4&&(e.ipv4&&(t.outdatedIpv4=e.ipv4),n.ipv4&&(t.updatedIpv4=n.ipv4)),e.ipv6!==n.ipv6&&(e.ipv6&&(t.outdatedIpv6=e.ipv6),n.ipv6&&(t.updatedIpv6=n.ipv6)),e.globallyRoutableIpv6!==n.globallyRoutableIpv6&&(e.globallyRoutableIpv6&&(t.outdatedGloballyRoutableIpv6=e.globallyRoutableIpv6),n.globallyRoutableIpv6&&(t.updatedGloballyRoutableIpv6=n.globallyRoutableIpv6)),e.uniqueLocalIpv6!==n.uniqueLocalIpv6&&(e.uniqueLocalIpv6&&(t.outdatedUniqueLocalIpv6=e.uniqueLocalIpv6),n.uniqueLocalIpv6&&(t.updatedUniqueLocalIpv6=n.uniqueLocalIpv6)),this.currentInterfaces.set(r,n),n.loopback&&this.loopbackInterfaces.set(r,n),(null!=i?i:i=[]).push(t)}}else this.currentInterfaces.set(r,n),n.loopback&&this.currentInterfaces.set(r,n),(null!=t?t:t=[]).push(n)}if(this.currentInterfaces.size!==e.size)for(const[t,i]of this.currentInterfaces)e.has(t)||(this.currentInterfaces.delete(t),this.loopbackInterfaces.delete(t),(null!=r?r:r=[]).push(i));if(t||r||i){const e=t?t.map((e=>e.name)).join(","):"",n=r?r.map((e=>e.name)).join(","):"",o=i?i.map((e=>{let t=`{ name: ${e.name} `;return(e.outdatedIpv4||e.updatedIpv4)&&(t+=`, ${e.outdatedIpv4} -> ${e.updatedIpv4} `),(e.outdatedIpv6||e.updatedIpv6)&&(t+=`, ${e.outdatedIpv6} -> ${e.updatedIpv6} `),(e.outdatedGloballyRoutableIpv6||e.updatedGloballyRoutableIpv6)&&(t+=`, ${e.outdatedGloballyRoutableIpv6} -> ${e.updatedGloballyRoutableIpv6} `),(e.outdatedUniqueLocalIpv6||e.updatedUniqueLocalIpv6)&&(t+=`, ${e.outdatedUniqueLocalIpv6} -> ${e.updatedUniqueLocalIpv6} `),t+"}"})).join(","):"";d("Detected network changes: added: [%s], removed: [%s], changes: [%s]!",e,n,o),this.emit("network-update",{added:t,removed:r,changes:i})}this.scheduleNextJob()}async getCurrentNetworkInterfaces(){let e;if(this.restrictedInterfaces){e=this.restrictedInterfaces;const t=m.getLoopbackInterface();e.includes(t)||e.push(t)}else try{e=await m.getNetworkInterfaceNames()}catch(t){d(`WARNING Detecting network interfaces for platform '${l.default.platform()}' failed. Trying to assume network interfaces! (${t.message})`),e=m.assumeNetworkInterfaceNames()}const t=new Map,r=l.default.networkInterfaces();for(const i of e){const e=r[i];if(!e)continue;let o,a,s,c,u=!1;for(const t of e){if(t.internal&&(u=!0),"IPv4"!==t.family&&4!==t.family||o){if("IPv6"===t.family||6===t.family){if(this.excludeIpv6)continue;t.scopeid&&!a?a=t:0===t.scopeid&&(t.address.startsWith("fc")||t.address.startsWith("fd")?c||(c=t):s||(s=t))}}else o=t;if(o&&a&&s&&c)break}if((0,n.default)(o||a,"Could not find valid addresses for interface '"+i+"'"),this.excludeIpv6Only&&!o)continue;const l={name:i,loopback:u,mac:(null==o?void 0:o.mac)||(null==a?void 0:a.mac)};o&&(l.ipv4=o.address,l.ip4Netmask=o.netmask,l.ipv4Netaddress=(0,h.getNetAddress)(o.address,o.netmask)),a&&(l.ipv6=a.address,l.ipv6Netmask=a.netmask),s&&(l.globallyRoutableIpv6=s.address,l.globallyRoutableIpv6Netmask=s.netmask),c&&(l.uniqueLocalIpv6=c.address,l.uniqueLocalIpv6Netmask=c.netmask),t.set(i,l)}return t}static resolveInterface(e){let t;e:for(const[r,i]of Object.entries(l.default.networkInterfaces()))for(const n of null!=i?i:[])if(n.address===e){t=r;break e}return t}static async getNetworkInterfaceNames(){let e,t;switch(l.default.platform()){case"win32":e=m.getWindowsNetworkInterfaces();break;case"linux":e=m.getLinuxNetworkInterfaces();break;case"darwin":e=m.getDarwinNetworkInterfaces();break;case"freebsd":e=m.getFreeBSDNetworkInterfaces();break;case"openbsd":case"sunos":e=m.getOpenBSD_SUNOS_NetworkInterfaces();break;default:return d("Found unsupported platform %s",l.default.platform()),Promise.reject(new Error("unsupported platform!"))}try{t=await e}catch(e){if(e.message!==m.NOTHING_FOUND_MESSAGE)throw e;t=[]}const r=m.getLoopbackInterface();return t.includes(r)||t.unshift(r),e}static assumeNetworkInterfaceNames(){const e=[];return Object.entries(l.default.networkInterfaces()).forEach((([t,r])=>{for(const i of null!=r?r:[])if(i.internal||"IPv4"===i.family||4===i.family||("IPv6"===i.family||6===i.family)&&0===i.scopeid){e.includes(t)||e.push(t);break}})),e}static getLoopbackInterface(){for(const[e,t]of Object.entries(l.default.networkInterfaces()))for(const r of null!=t?t:[])if(r.internal)return e;throw new Error("Could not detect loopback interface!")}static getWindowsNetworkInterfaces(){return new Promise(((e,t)=>{o.default.exec('arp -a | findstr /C:"---"',((r,i)=>{if(r)return void t(r);const n=i.split(l.default.EOL),o=[];for(let e=0;e<n.length-1;e++){const t=n[e].trim().split(" ");t[t.length-3]?o.push(t[t.length-3]):d(`WINDOWS: Failed to read interface name from line ${e}: '${n[e]}'`)}const a=[];for(const e of o){const t=m.resolveInterface(e);t?a.includes(t)||a.push(t):d(`WINDOWS: Couldn't resolve to an interface name from '${e}'`)}a.length?e(a):t(new Error(m.NOTHING_FOUND_MESSAGE))}))}))}static getDarwinNetworkInterfaces(){return new Promise(((e,t)=>{o.default.exec("arp -a -n -l",(async(r,i)=>{if(r)return void t(r);const n=i.split(l.default.EOL),o=[];for(let e=1;e<n.length-1;e++){const t=n[e].trim().split(m.SPACE_PATTERN)[4];t?o.includes(t)||o.push(t):d(`DARWIN: Failed to read interface name from line ${e}: '${n[e]}'`)}const a=[];for(const e of o){const t=m.getDarwinWifiNetworkState(e).then((t=>{if(1!==t&&3!==t){const t=o.indexOf(e);-1!==t&&o.splice(t,1)}}));a.push(t)}await Promise.all(a),o.length?e(o):t(new Error(m.NOTHING_FOUND_MESSAGE))}))}))}static getLinuxNetworkInterfaces(){return new Promise(((e,t)=>{o.default.exec("ip neigh show",((r,i)=>{if(r)return r.message.includes("ip: not found")?(d("LINUX: ip was not found on the system. Falling back to assuming network interfaces!"),void e(m.assumeNetworkInterfaceNames())):void t(r);const n=i.split(l.default.EOL),o=[];for(let e=0;e<n.length-1;e++){const t=n[e].trim().split(m.SPACE_PATTERN);let r=0;for(;r<t.length&&"dev"!==t[r];r++);if(r>=t.length){d(`LINUX: Out of bounds when reading interface name from line ${e}: '${n[e]}'`);continue}const i=t[r+1];i?o.includes(i)||o.push(i):d(`LINUX: Failed to read interface name from line ${e}: '${n[e]}'`)}o.length?e(o):t(new Error(m.NOTHING_FOUND_MESSAGE))}))}))}static getFreeBSDNetworkInterfaces(){return new Promise(((e,t)=>{o.default.exec("arp -a -n",((r,i)=>{if(r)return void t(r);const n=i.split(l.default.EOL),o=[];for(let e=0;e<n.length-1;e++){const t=n[e].trim().split(m.SPACE_PATTERN)[5];t?o.includes(t)||o.push(t):d(`FreeBSD: Failed to read interface name from line ${e}: '${n[e]}'`)}o.length?e(o):t(new Error(m.NOTHING_FOUND_MESSAGE))}))}))}static getOpenBSD_SUNOS_NetworkInterfaces(){return new Promise(((e,t)=>{o.default.exec("arp -a -n",((r,i)=>{if(r)return void t(r);const n="sunos"===l.default.platform()?0:2,o=i.split(l.default.EOL),a=[];for(let e=1;e<o.length-1;e++){const t=o[e].trim().split(m.SPACE_PATTERN)[n];t?a.includes(t)||a.push(t):d(`${l.default.platform()}: Failed to read interface name from line ${e}: '${o[e]}'`)}a.length?e(a):t(new Error(m.NOTHING_FOUND_MESSAGE))}))}))}static getDarwinWifiNetworkState(e){return new Promise((t=>{o.default.exec("networksetup -getairportnetwork "+e,((r,i)=>{if(r)return i.includes("not a Wi-Fi interface")?void t(1):(console.log(`CIAO WARN: While checking networksetup for ${e} encountered an error (${r.message}) with output: ${i.replace(l.default.EOL,"; ")}`),void t(0));let n=0;i.includes("not a Wi-Fi interface")?n=1:i.includes("Current Wi-Fi Network")?n=3:i.includes("not associated")?n=2:i.includes("All Wi-Fi network services are disabled")?n=1:console.log(`CIAO WARN: While checking networksetup for ${e} encountered an unknown output: ${i.replace(l.default.EOL,"; ")}`),t(n)}))}))}}t.NetworkManager=m,m.SPACE_PATTERN=/\s+/g,m.NOTHING_FOUND_MESSAGE="no interfaces found",m.POLLING_TIME=15e3},4288:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Responder=void 0;const i=r(1635),n=i.__importDefault(r(2613)),o=i.__importDefault(r(5753)),a=r(141),s=r(4119),c=r(5682),u=r(1360),l=r(4495),h=r(482),d=r(8225),p=r(1576),f=r(2361),g=r(9983),m=r(2475),v=r(572),y=r(8126),C=r(341),S=r(16),E=r(8390),_=r(5762),T=(0,o.default)("ciao:Responder"),A=(e,t)=>e.estimatedTimeToBeSent-t.estimatedTimeToBeSent;var I;!function(e){e[e.NO_CONFLICT=0]="NO_CONFLICT",e[e.CONFLICTING_RDATA=1]="CONFLICTING_RDATA",e[e.CONFLICTING_TTL=2]="CONFLICTING_TTL"}(I||(I={}));class D{static getResponder(e){const t=e?JSON.stringify(e):"",r=this.INSTANCES.get(t);if(r)return r.refCount++,r;{const r=new D(e);return this.INSTANCES.set(t,r),r.optionsString=t,r}}constructor(e){this.refCount=1,this.optionsString="",this.bound=!1,this.announcedServices=new Map,this.servicePointer=new Map,this.truncatedQueries={},this.delayedMulticastResponses=[],this.server=new f.MDNSServer(this,e),this.promiseChain=this.start(),this.server.getNetworkManager().on("network-update",this.handleNetworkUpdate.bind(this)),this.ignoreUnicastResponseFlag=null==e?void 0:e.ignoreUnicastResponseFlag,(null==e?void 0:e.periodicBroadcasts)&&(this.broadcastInterval=setTimeout(this.handlePeriodicBroadcasts.bind(this),3e4).unref())}handlePeriodicBroadcasts(){this.broadcastInterval=void 0,T("Sending periodic announcement on "+Array.from(this.server.getNetworkManager().getInterfaceMap().keys()).join(", "));for(const e of this.server.getNetworkManager().getInterfaceMap().values()){const t=new c.Question("_hap._tcp.local.",12,!1),r=this.answerQuestion(t,{port:5353,address:e.ipv4Netaddress||e.globallyRoutableIpv6||e.uniqueLocalIpv6||e.ipv6,interface:e.name});v.QueryResponse.combineResponses(r);for(const t of r)t.hasAnswers()&&this.server.sendResponse(t.asPacket(),e.name)}this.broadcastInterval=setTimeout(this.handlePeriodicBroadcasts.bind(this),3e3*Math.random()+27e3).unref()}createService(e){const t=new a.CiaoService(this.server.getNetworkManager(),e);return t.on("publish",this.advertiseService.bind(this,t)),t.on("unpublish",this.unpublishService.bind(this,t)),t.on("republish",this.republishService.bind(this,t)),t.on("records-update",this.handleServiceRecordUpdate.bind(this,t)),t.on("records-update-interface",this.handleServiceRecordUpdateOnInterface.bind(this,t)),t}shutdown(){if(this.refCount--,this.refCount>0)return Promise.resolve();this.currentProber&&this.currentProber.cancel(),this.broadcastInterval&&clearTimeout(this.broadcastInterval),D.INSTANCES.delete(this.optionsString),T("Shutting down Responder...");const e=[];for(const t of this.announcedServices.values())e.push(this.unpublishService(t));return Promise.all(e).then((()=>{this.server.shutdown(),this.bound=!1}))}getAnnouncedServices(){return this.announcedServices.values()}start(){if(this.bound)throw new Error("Server is already bound!");return this.bound=!0,this.server.bind()}advertiseService(e,t){if("announced"===e.serviceState)throw new Error("Can't publish a service that is already announced. Received "+e.serviceState+" for service "+e.getFQDN());return"probing"===e.serviceState?this.promiseChain.then((()=>{if(e.currentAnnouncer)return e.currentAnnouncer.awaitAnnouncement()})):"announcing"===e.serviceState?((0,n.default)(e.currentAnnouncer,"Service is in state ANNOUNCING though has no linked announcer!"),e.currentAnnouncer.isSendingGoodbye()?e.currentAnnouncer.awaitAnnouncement().then((()=>this.advertiseService(e,t))):e.currentAnnouncer.cancel().then((()=>this.advertiseService(e,t)))):(T("[%s] Going to advertise service...",e.getFQDN()),this.promiseChain=this.promiseChain.then((()=>e.rebuildServiceRecords())).then((()=>this.probe(e))),this.promiseChain.then((()=>{this.announce(e).catch((t=>(console.log(`[${e.getFQDN()}] failed announcing with reason: ${t}. Trying again in 2 seconds!`),(0,E.PromiseTimeout)(2e3).then((()=>this.advertiseService(e,(()=>{}))))))),t()}),(r=>{if(r!==m.Prober.CANCEL_REASON)return console.log(`[${e.getFQDN()}] failed probing with reason: ${r}. Trying again in 2 seconds!`),(0,E.PromiseTimeout)(2e3).then((()=>this.advertiseService(e,t)));t()})))}async republishService(e,t,r=!1){if("announced"!==e.serviceState&&"announcing"!==e.serviceState)throw new Error("Can't unpublish a service which isn't announced yet. Received "+e.serviceState+" for service "+e.getFQDN());if(T("[%s] Readvertising service...",e.getFQDN()),"announcing"===e.serviceState){(0,n.default)(e.currentAnnouncer,"Service is in state ANNOUNCING though has no linked announcer!");return(e.currentAnnouncer.isSendingGoodbye()?e.currentAnnouncer.awaitAnnouncement():e.currentAnnouncer.cancel()).then((()=>this.advertiseService(e,t)))}return this.clearService(e),e.serviceState="unannounced",r?(0,E.PromiseTimeout)(1e3).then((()=>this.advertiseService(e,t))):this.advertiseService(e,t)}unpublishService(e,t){if("unannounced"===e.serviceState)throw new Error("Can't unpublish a service which isn't announced yet. Received "+e.serviceState+" for service "+e.getFQDN());if("announced"===e.serviceState||"announcing"===e.serviceState){if("announcing"===e.serviceState)return(0,n.default)(e.currentAnnouncer,"Service is in state ANNOUNCING though has no linked announcer!"),e.currentAnnouncer.isSendingGoodbye()?e.currentAnnouncer.awaitAnnouncement():e.currentAnnouncer.cancel().then((()=>(e.serviceState="announced",this.unpublishService(e,t))));T("[%s] Removing service from the network",e.getFQDN()),this.clearService(e),e.serviceState="unannounced";let r=this.goodbye(e);return t&&(r=r.then((()=>t()),(r=>{console.log(`[${e.getFQDN()}] failed goodbye with reason: ${r}.`),t()}))),r}return"probing"===e.serviceState&&(T("[%s] Canceling probing",e.getFQDN()),this.currentProber&&this.currentProber.getService()===e&&(this.currentProber.cancel(),this.currentProber=void 0),e.serviceState="unannounced"),t&&t(),Promise.resolve()}clearService(e){const t=e.getLowerCasedFQDN(),r=e.getLowerCasedTypePTR(),i=e.getLowerCasedSubtypePTRs();if(this.removePTR(D.SERVICE_TYPE_ENUMERATION_NAME,r),this.removePTR(r,t),i)for(const e of i)this.removePTR(e,t);this.announcedServices.delete(e.getLowerCasedFQDN())}addPTR(e,t){const r=this.servicePointer.get(e);r?r.includes(t)||r.push(t):this.servicePointer.set(e,[t])}removePTR(e,t){const r=this.servicePointer.get(e);if(r){const i=r.indexOf(t);-1!==i&&r.splice(i,1),0===r.length&&this.servicePointer.delete(e)}}probe(e){if("unannounced"!==e.serviceState)throw new Error("Can't probe for a service which is announced already. Received "+e.serviceState+" for service "+e.getFQDN());return e.serviceState="probing",(0,n.default)(void 0===this.currentProber,"Tried creating new Prober when there already was one active!"),this.currentProber=new m.Prober(this,this.server,e),this.currentProber.probe().then((()=>{this.currentProber=void 0,e.serviceState="probed"}),(t=>(e.serviceState="unannounced",this.currentProber=void 0,Promise.reject(t))))}announce(e){if("probed"!==e.serviceState)throw new Error("Cannot announce service which was not probed unique. Received "+e.serviceState+" for service "+e.getFQDN());(0,n.default)(void 0===e.currentAnnouncer,"Service "+e.getFQDN()+" is already announcing!"),e.serviceState="announcing";const t=new g.Announcer(this.server,e,{repetitions:3});e.currentAnnouncer=t;const r=e.getLowerCasedFQDN(),i=e.getLowerCasedTypePTR(),o=e.getLowerCasedSubtypePTRs();if(this.addPTR(D.SERVICE_TYPE_ENUMERATION_NAME,i),this.addPTR(i,r),o)for(const e of o)this.addPTR(e,r);return this.announcedServices.set(r,e),t.announce().then((()=>{e.serviceState="announced",e.currentAnnouncer=void 0}),(t=>{if(e.serviceState="unannounced",e.currentAnnouncer=void 0,this.clearService(e),t!==g.Announcer.CANCEL_REASON)return Promise.reject(t)}))}handleServiceRecordUpdate(e,t,r){var i;if("announced"!==e.serviceState)throw new Error("Cannot update txt of service which is not announced yet. Received "+e.serviceState+" for service "+e.getFQDN());T("[%s] Updating %d record(s) for given service!",e.getFQDN(),t.answers.length+((null===(i=t.additionals)||void 0===i?void 0:i.length)||0)),this.server.sendResponseBroadcast(t,e).then((t=>{const i=(0,f.SendResultFailedRatio)(t);if(1===i)return console.log((0,f.SendResultFormatError)(t,`Failed to send records update for '${e.getFQDN()}'`),!0),void(r&&r(new Error("Updating records failed as of socket errors!")));i>0&&T((0,f.SendResultFormatError)(t,`Some of the record updates for '${e.getFQDN()}' failed`)),r&&r()}))}handleServiceRecordUpdateOnInterface(e,t,r,i){if("announced"!==e.serviceState)throw new Error("Cannot update txt of service which is not announced yet. Received "+e.serviceState+" for service "+e.getFQDN());T("[%s] Updating %d record(s) for given service on interface %s!",e.getFQDN(),r.length,t);const n=s.DNSPacket.createDNSResponsePacketsFromRRSet({answers:r});this.server.sendResponse(n,t,i)}goodbye(e){(0,n.default)(void 0===e.currentAnnouncer,"Service "+e.getFQDN()+" is already announcing!"),e.serviceState="announcing";const t=new g.Announcer(this.server,e,{repetitions:1,goodbye:!0});return e.currentAnnouncer=t,t.announce().then((()=>{e.serviceState="unannounced",e.currentAnnouncer=void 0}),(t=>(e.serviceState="unannounced",e.currentAnnouncer=void 0,Promise.reject(t))))}handleNetworkUpdate(e){for(const t of this.announcedServices.values())t.handleNetworkInterfaceUpdate(e)}handleQuery(e,t){const r=(new Date).getTime(),i=t.address+":"+t.port+":"+t.interface,n=this.truncatedQueries[i];if(n){switch(n.appendDNSPacket(e)){case 1:return delete this.truncatedQueries[i],void T("[%s] Aborting to wait for more truncated queries. Waited a total of %d ms receiving %d queries",i,n.getTotalWaitTime(),n.getArrivedPacketCount());case 2:return void T("[%s] Received a query marked as truncated, waiting for more to arrive",i);case 3:delete this.truncatedQueries[i],e=n.getPacket(),T("[%s] Last part of the truncated query arrived. Received %d packets taking a total of %d ms",i,n.getArrivedPacketCount(),n.getTotalWaitTime())}}else if(e.flags.truncation){T("Received truncated query from "+JSON.stringify(t)+" waiting for more to come!");const r=new C.TruncatedQuery(e);return this.truncatedQueries[i]=r,void r.on("timeout",(()=>{T("[%s] Timeout passed since the last truncated query was received. Discarding %d packets received in %d ms.",i,r.getArrivedPacketCount(),r.getTotalWaitTime()),delete this.truncatedQueries[i]}))}const o=t.port!==f.MDNSServer.MDNS_PORT,a=e.authorities.size>0;let s;for(const t of e.additionals.values())if(41===t.type){s=t.udpPayloadSize;break}const c=[],u=[];if(e.questions.forEach((r=>{const i=this.answerQuestion(r,t,e.answers);o||r.unicastResponseFlag&&!this.ignoreUnicastResponseFlag?u.push(...i):c.push(...i)})),this.currentProber&&this.currentProber.handleQuery(e,t),o)for(let t=0;t<u.length;t++){u[t].markLegacyUnicastResponse(e.id,0===t?Array.from(e.questions.values()):void 0)}v.QueryResponse.combineResponses(c,s),v.QueryResponse.combineResponses(u,s),o&&u.length>1&&(u.splice(1,u.length-1),u[0].markTruncated());for(const e of u){if(!e.hasAnswers())continue;this.server.sendResponse(e.asPacket(),t);const i=(new Date).getTime()-r;T("Sending response via unicast to %s (took %d ms): %s",JSON.stringify(t),i,e.asString(s))}for(const i of c)if(i.hasAnswers())if((i.containsSharedAnswer()||e.questions.size>1)&&!a){const e=(new Date).getTime()-r;this.enqueueDelayedMulticastResponse(i.asPacket(),t.interface,e)}else{let e=!1;for(let n=0;n<this.delayedMulticastResponses.length;n++){const o=this.delayedMulticastResponses[n];if(o.getTimeTillSent()>y.QueuedResponse.MAX_DELAY)break;if(o.combineWithUniqueResponseIfPossible(i,t.interface)){const i=(new Date).getTime()-r;e=!0,T("Multicast response on interface %s containing unique records (took %d ms) was combined with response which is sent out later",t.interface,i);break}}if(!e){this.server.sendResponse(i.asPacket(),t.interface);const e=(new Date).getTime()-r;T("Sending response via multicast on network %s (took %d ms): %s",t.interface,e,i.asString(s))}}}handleResponse(e,t){this.currentProber&&this.currentProber.handleResponse(e,t);for(const r of this.announcedServices.values()){let i=!1,n=0;for(const o of e.answers.values()){const e=D.checkRecordConflictType(r,o,t);if(1===e){i=!0;break}2===e&&n++}if(!i)for(const o of e.additionals.values()){const e=D.checkRecordConflictType(r,o,t);if(1===e){i=!0;break}2===e&&n++}if(i)this.republishService(r,(e=>{e&&(console.log(`FATAL Error occurred trying to resolve conflict for service ${r.getFQDN()}! We can't recover from this!`),console.log(e.stack),process.exit(1))}),!0);else if(n&&!r.currentAnnouncer){r.serviceState="announcing";const e=new g.Announcer(this.server,r,{repetitions:1});r.currentAnnouncer=e,e.announce().then((()=>{r.currentAnnouncer=void 0,r.serviceState="announced"}),(e=>{r.currentAnnouncer=void 0,r.serviceState="announced",e!==g.Announcer.CANCEL_REASON&&console.warn("When trying to resolve a ttl conflict on the network, we were unable to send our response packet: "+e.message)}))}}}static checkRecordConflictType(e,t,r){if(!e.advertisesOnInterface(r.interface))return 0;const i=t.getLowerCasedName();if(i===e.getLowerCasedFQDN()){if(33===t.type){const r=t;if(r.getLowerCasedHostname()!==e.getLowerCasedHostname())return T("[%s] Noticed conflicting record on the network. SRV with hostname: %s",e.getFQDN(),r.hostname),1;if(r.port!==e.getPort())return T("[%s] Noticed conflicting record on the network. SRV with port: %s",e.getFQDN(),r.port),1;if(r.ttl<d.SRVRecord.DEFAULT_TTL/2)return 2}else if(16===t.type){const r=t,i=e.getTXT();if(i.length!==r.txt.length)return T("[%s] Noticed conflicting record on the network. TXT with differing data length",e.getFQDN()),1;for(let t=0;t<i.length;t++){const n=i[t],o=r.txt[t];if(n.length!==o.length||n.toString("hex")!==o.toString("hex"))return T("[%s] Noticed conflicting record on the network. TXT with differing data.",e.getFQDN()),1}if(r.ttl<p.TXTRecord.DEFAULT_TTL/2)return 2}}else if(i===e.getLowerCasedHostname()){if(1===t.type){const r=t;if(!e.hasAddress(r.ipAddress))return T("[%s] Noticed conflicting record on the network. A with ip address: %s",e.getFQDN(),r.ipAddress),1;if(r.ttl<l.ARecord.DEFAULT_TTL/2)return 2}else if(28===t.type){const r=t;if(!e.hasAddress(r.ipAddress))return T("[%s] Noticed conflicting record on the network. AAAA with ip address: %s",e.getFQDN(),r.ipAddress),1;if(r.ttl<u.AAAARecord.DEFAULT_TTL/2)return 2}}else if(12===t.type){const r=t;if(i===e.getLowerCasedTypePTR()){if(r.getLowerCasedPTRName()===e.getLowerCasedFQDN()&&r.ttl<h.PTRRecord.DEFAULT_TTL/2)return 2}else if(i===D.SERVICE_TYPE_ENUMERATION_NAME);else{const t=e.getLowerCasedSubtypePTRs();if(t&&t.includes(i)&&r.getLowerCasedPTRName()===e.getLowerCasedFQDN()&&r.ttl<h.PTRRecord.DEFAULT_TTL/2)return 2}}return 0}enqueueDelayedMulticastResponse(e,t,r){const i=new y.QueuedResponse(e,t);i.calculateRandomDelay(),(0,_.sortedInsert)(this.delayedMulticastResponses,i,A);for(let e=0;e<this.delayedMulticastResponses.length;e++){const t=this.delayedMulticastResponses[e];for(let r=e+1;r<this.delayedMulticastResponses.length;r++){const i=this.delayedMulticastResponses[r];if(!t.delayWouldBeInTimelyManner(i))break;if(t.combineWithNextPacketIfPossible(i)){const r=this.delayedMulticastResponses.indexOf(t);-1!==r&&this.delayedMulticastResponses.splice(r,1),e--;break}}}i.delayed||i.scheduleResponse((()=>{const e=this.delayedMulticastResponses.indexOf(i);-1!==e&&this.delayedMulticastResponses.splice(e,1);try{this.server.sendResponse(i.getPacket(),t),T("Sending (delayed %dms) response via multicast on network interface %s (took %d ms): %s",Math.round(i.getTimeSinceCreation()),t,r,i.getPacket().asLoggingString())}catch(e){if(e.name===S.ERR_INTERFACE_NOT_FOUND)T("Multicast response (delayed %dms) was cancelled as the network interface %s is no longer available!",Math.round(i.getTimeSinceCreation()),t);else{if(e.name!==S.ERR_SERVER_CLOSED)throw e;T("Multicast response (delayed %dms) was cancelled as the server is about to be shutdown!",Math.round(i.getTimeSinceCreation()))}}}))}answerQuestion(e,t,r){if(1!==e.class&&255!==e.class)return[];const i=[];let n;if(12===e.type||255===e.type||5===e.type){const o=this.servicePointer.get(e.getLowerCasedName());if(o){for(const a of o){const o=this.announcedServices.get(a);if(o){if(o.advertisesOnInterface(t.interface)){const n=D.answerServiceQuestion(o,e,t,r);n.hasAnswers()&&i.push(n)}}else n||(n=new v.QueryResponse(r),i.unshift(n)),n.addAnswer(new h.PTRRecord(e.name,a))}return i}}for(const n of this.announcedServices.values()){if(!n.advertisesOnInterface(t.interface))continue;const o=D.answerServiceQuestion(n,e,t,r);o.hasAnswers()&&i.push(o)}return i}static answerServiceQuestion(e,t,r,i){const o=new v.QueryResponse(i),a=t.getLowerCasedName(),s=255===t.type||5===t.type,c=o.addAnswer.bind(o),u=o.addAdditional.bind(o);if(a===e.getLowerCasedTypePTR()){if(s||12===t.type){o.addAnswer(e.ptrRecord())&&(o.addAdditional(e.txtRecord(),e.srvRecord()),this.addAddressRecords(e,r,1,u),this.addAddressRecords(e,r,28,u),o.addAdditional(e.serviceNSECRecord(),e.addressNSECRecord()))}}else if(a===e.getLowerCasedFQDN())if(s){o.addAnswer(e.txtRecord());o.addAnswer(e.srvRecord())&&(this.addAddressRecords(e,r,1,u),this.addAddressRecords(e,r,28,u),o.addAdditional(e.serviceNSECRecord(),e.addressNSECRecord()))}else if(33===t.type){o.addAnswer(e.srvRecord())&&(this.addAddressRecords(e,r,1,u),this.addAddressRecords(e,r,28,u),o.addAdditional(e.serviceNSECRecord(!0),e.addressNSECRecord()))}else 16===t.type&&(o.addAnswer(e.txtRecord()),o.addAdditional(e.serviceNSECRecord()));else if(a===e.getLowerCasedHostname()||a+"local."===e.getLowerCasedHostname()){if(s)this.addAddressRecords(e,r,1,c),this.addAddressRecords(e,r,28,c),o.addAdditional(e.addressNSECRecord());else if(1===t.type){this.addAddressRecords(e,r,1,c)&&this.addAddressRecords(e,r,28,u),o.addAdditional(e.addressNSECRecord())}else if(28===t.type){this.addAddressRecords(e,r,28,c)&&this.addAddressRecords(e,r,1,u),o.addAdditional(e.addressNSECRecord())}}else if(e.getLowerCasedSubtypePTRs()&&(s||12===t.type)){const t=e.getLowerCasedSubtypePTRs().indexOf(a);if(-1!==t){const i=e.subtypePtrRecords()[t];(0,n.default)(a===i.name,"Question Name didn't match selected sub type ptr record!");o.addAnswer(i)&&(o.addAdditional(e.txtRecord(),e.srvRecord()),this.addAddressRecords(e,r,1,u),this.addAddressRecords(e,r,28,u),o.addAdditional(e.serviceNSECRecord(),e.addressNSECRecord()))}}return o}static addAddressRecords(e,t,r,i){if(1===r){const r=e.aRecord(t.interface);return!!r&&i(r)}if(28===r){const r=e.aaaaRecord(t.interface),n=e.aaaaRoutableRecord(t.interface),o=e.aaaaUniqueLocalRecord(t.interface);let a=!1;if(r&&(a=i(r)),n){const e=i(n);a=a||e}if(o){const e=i(o);a=a||e}return a}n.default.fail("Illegal argument!")}}t.Responder=D,D.SERVICE_TYPE_ENUMERATION_NAME="_services._dns-sd._udp.local.",D.INSTANCES=new Map},7352:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NonCompressionLabelCoder=t.DNSLabelCoder=void 0;const i=r(1635).__importDefault(r(2613));class n{constructor(e){this.trackedLengths=[],this.writtenNames=[],this.legacyUnicastEncoding=e||!1}initBuf(e){this.buffer=e}initRRLocation(e,t,r){this.startOfRR=e,this.startOfRData=t,this.rDataLength=r}clearRRLocation(){this.startOfRR=void 0,this.startOfRData=void 0,this.rDataLength=void 0}getUncompressedNameLength(e){if("."===e)return 1;(0,i.default)(e.endsWith("."),"Supplied illegal name which doesn't end with the root label!");let t=0;const r=e.split(".");for(let o=0;o<r.length;o++){const a=r[o];!a&&o<r.length-1&&i.default.fail("Label "+o+" in name '"+e+"' was empty"),t+=n.getLabelLength(a)}return t}getNameLength(e){if(n.DISABLE_COMPRESSION)return this.getUncompressedNameLength(e);if("."===e)return 1;(0,i.default)(e.endsWith("."),"Supplied illegal name which doesn't end with the root label!");const t=e.split(".").map((e=>n.getLabelLength(e))),r={name:e,length:0,labelLengths:t};let o,a=0;for(let t=0;t<this.trackedLengths.length;t++){const r=this.trackedLengths[t],i=n.computeLabelSuffixLength(r.name,e);i>a&&(o=r,a=i)}let s=0;if(o){const e=t.length-1-a;for(let r=0;r<e;r++)s+=t[r];s+=2}else for(let e=0;e<t.length;e++)s+=t[e];return r.length=s,this.trackedLengths.push(r),r.length}encodeUncompressedName(e,t){return this.buffer||i.default.fail("Illegal state. Buffer not initialized!"),n.encodeUncompressedName(e,this.buffer,t)}static encodeUncompressedName(e,t,r){(0,i.default)(e.endsWith("."),"Name does not end with the root label");const n=r,o="."===e?[""]:e.split(".");for(let e=0;e<o.length;e++){const n=o[e];if(""===n){(0,i.default)(e===o.length-1,"Encountered root label being not at the end of the domain name"),t.writeUInt8(0,r++);break}const a=t.write(n,r+1);t.writeUInt8(a,r),r+=a+1}return r-n}encodeName(e,t){if(n.DISABLE_COMPRESSION)return this.encodeUncompressedName(e,t);if(this.buffer||i.default.fail("Illegal state. Buffer not initialized!"),"."===e)return this.buffer.writeUInt8(0,t),1;const r=t,o=e.split("."),a={name:e,writtenLabels:new Array(o.length).fill(-1)};let s,c=0;for(let t=0;t<this.writtenNames.length;t++){const r=this.writtenNames[t],i=n.computeLabelSuffixLength(r.name,e);i>c&&(s=r,c=i)}if(s){const e=o.length-1-c,r=s.writtenLabels.length-1-c;for(let r=0;r<e;r++)a.writtenLabels[r]=t,t+=n.writeLabel(o[r],this.buffer,t);const u=s.writtenLabels[r];(0,i.default)(-1!==u,"Label which was pointed at wasn't yet written to the buffer!"),(0,i.default)(u<=n.NOT_POINTER_MASK,"Pointer exceeds to length of a maximum of 14 bits"),(0,i.default)(u<t,"Pointer can only point to a prior location");const l=n.POINTER_MASK|u;this.buffer.writeUInt16BE(l,t),t+=2}else for(let e=0;e<o.length;e++)a.writtenLabels[e]=t,t+=n.writeLabel(o[e],this.buffer,t);return this.writtenNames.push(a),t-r}decodeName(e,t=!0){this.buffer||i.default.fail("Illegal state. Buffer not initialized!");const r=e;let o="";for(;;){const a=this.buffer.readUInt8(e++);if(0===a){o+=".";break}const s=a&n.POINTER_MASK_ONE_BYTE;if(s){if(s===n.POINTER_MASK_ONE_BYTE){const a=this.buffer.readUInt16BE(e-1)&n.NOT_POINTER_MASK;if(e++,!t){o+=o?".~":"~";break}(0,i.default)(a<r,"Pointer at "+(e-2)+" MUST point to a prior location!"),o+=(o?".":"")+this.decodeName(a).data;break}if(s===n.LOCAL_COMPRESSION_ONE_BYTE){let a=this.buffer.readUInt16BE(e-1)&n.NOT_POINTER_MASK;if(e++,!t){o+=o?".~":"~";break}a>=0&&a<255?((0,i.default)(void 0!==this.startOfRR,"Cannot decompress locally compressed name as record is not initialized!"),a+=this.startOfRR,(0,i.default)(a<r,"LocalPointer <255 at "+(e-2)+" MUST point to a prior location!"),o+=(o?".":"")+this.decodeName(a).data):a>=256?((0,i.default)(void 0!==this.startOfRData&&void 0!==this.rDataLength,"Cannot decompress locally compressed name as record is not initialized!"),a-=-256,a+=this.startOfRData,(0,i.default)(a<r,"LocationPoint >265 at "+(e+2)+" MUST point to a prior location!"),o+=(o?".":"")+this.decodeName(a).data):i.default.fail("Encountered unknown pointer range "+a);break}if(s===n.EXTENDED_LABEL_TYPE_ONE_BYTE){const t=a&n.NOT_POINTER_MASK_ONE_BYTE;i.default.fail("Received extended label type "+t+" at "+(e-1))}else i.default.fail("Encountered unknown pointer type: "+Buffer.from([s>>6]).toString("hex")+" (with original byte "+Buffer.from([a]).toString("hex")+")")}const c=this.buffer.toString("utf-8",e,e+a);e+=a,o+=(o?".":"")+c}return{data:o,readBytes:e-r}}static getLabelLength(e){if(e){const t=Buffer.byteLength(e);return(0,i.default)(t<=63,"Label cannot be longer than 63 bytes ("+e+")"),1+t}return 1}static writeLabel(e,t,r){if(e){const i=t.write(e,r+1);return t.writeUInt8(i,r),i+1}return t.writeUInt8(0,r),1}static computeLabelSuffixLength(e,t){(0,i.default)(0!==e.length&&0!==t.length,"Encountered empty name when comparing suffixes!");const r=e.length-1,n=t.length-1;let o=0,a=!1;for(let s=1;s<=r&&s<=n;s++){const c=e.charAt(r-s),u=t.charAt(n-s);if((0,i.default)(!!c&&!!u,"Seemingly encountered out of bounds trying to calculate suffixes"),c!==u){a=!0;break}"."===c&&o++}return a||o++,o}}t.DNSLabelCoder=n,n.DISABLE_COMPRESSION=!1,n.POINTER_MASK=49152,n.POINTER_MASK_ONE_BYTE=192,n.LOCAL_COMPRESSION_ONE_BYTE=128,n.EXTENDED_LABEL_TYPE_ONE_BYTE=64,n.NOT_POINTER_MASK=16383,n.NOT_POINTER_MASK_ONE_BYTE=63;class o extends n{getNameLength(e){return this.getUncompressedNameLength(e)}encodeName(e,t){return this.encodeUncompressedName(e,t)}}t.NonCompressionLabelCoder=o,o.INSTANCE=new o},4119:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DNSPacket=t.PacketType=t.QClass=t.RClass=t.QType=t.RType=t.RCode=t.OpCode=void 0;const i=r(1635),n=i.__importDefault(r(2613)),o=i.__importDefault(r(2017)),a=r(1673),s=r(7352),c=r(5682);r(9577);const u=r(5231);var l,h,d,p,f,g,m;function v(e){return"answers"in e}!function(e){e[e.QUERY=0]="QUERY"}(l||(t.OpCode=l={})),function(e){e[e.NoError=0]="NoError"}(h||(t.RCode=h={})),function(e){e[e.A=1]="A",e[e.CNAME=5]="CNAME",e[e.PTR=12]="PTR",e[e.TXT=16]="TXT",e[e.AAAA=28]="AAAA",e[e.SRV=33]="SRV",e[e.OPT=41]="OPT",e[e.NSEC=47]="NSEC"}(d||(t.RType=d={})),function(e){e[e.A=1]="A",e[e.CNAME=5]="CNAME",e[e.PTR=12]="PTR",e[e.TXT=16]="TXT",e[e.AAAA=28]="AAAA",e[e.SRV=33]="SRV",e[e.NSEC=47]="NSEC",e[e.ANY=255]="ANY"}(p||(t.QType=p={})),function(e){e[e.IN=1]="IN"}(f||(t.RClass=f={})),function(e){e[e.IN=1]="IN",e[e.ANY=255]="ANY"}(g||(t.QClass=g={})),function(e){e[e.QUERY=0]="QUERY",e[e.RESPONSE=1]="RESPONSE"}(m||(t.PacketType=m={}));class y{constructor(e){this.questions=new Map,this.answers=new Map,this.authorities=new Map,this.additionals=new Map,this.estimatedEncodingLength=0,this.lastCalculatedLength=0,this.lengthDirty=!0,this.id=e.id||0,this.legacyUnicastEncoding=e.legacyUnicast||!1,this.type=e.type,this.opcode=e.opcode||0,this.flags=e.flags||{},this.rcode=e.rCode||0,1===this.type&&(this.flags.authoritativeAnswer=!0),e.questions&&this.addQuestions(...e.questions),e.answers&&this.addAnswers(...e.answers),e.authorities&&this.addAuthorities(...e.authorities),e.additionals&&this.addAdditionals(...e.additionals)}static createDNSQueryPacket(e,t=this.UDP_PAYLOAD_SIZE_IPV4){const r=this.createDNSQueryPackets(e,t);return(0,n.default)(1===r.length,"Cannot user short method createDNSQueryPacket when query packets are more than one: is "+r.length),r[0]}static createDNSQueryPackets(e,t=this.UDP_PAYLOAD_SIZE_IPV4){const r=[],i=new y({type:0,questions:e.questions,additionals:v(e)?e.additionals:void 0});if(r.push(i),i.getEstimatedEncodingLength()>t){const e=i.getEncodingLength();e>t&&n.default.fail("Cannot send query where already the query section is exceeding the udpPayloadSize ("+e+">"+t+")!")}if(v(e)&&e.answers){let n=i,o=0;const a=e.answers.concat([]);for(a.sort(((e,t)=>e.getEncodingLength(s.NonCompressionLabelCoder.INSTANCE)-t.getEncodingLength(s.NonCompressionLabelCoder.INSTANCE)));o<a.length;){for(;o<a.length;o++){const e=a[o],r=e.getEncodingLength(s.NonCompressionLabelCoder.INSTANCE);if(i.getEstimatedEncodingLength()+r<=t)n.addAnswers(e);else{if(!(i.getEncodingLength()+r<=t)){0===n.questions.size&&0===n.answers.size&&i.addAnswers(e);break}n.addAnswers(e)}}o<a.length&&(n.flags.truncation=!0,n=new y({type:0}),r.push(n))}}else if("authorities"in e&&e.authorities){i.addAuthorities(...e.authorities);const r=i.getEncodingLength();r>t&&n.default.fail(`Probe query packet exceeds the mtu size (${r}>${t}). Can't split probe queries at the moment!`)}return r}static createDNSResponsePacketsFromRRSet(e,t=this.UDP_PAYLOAD_SIZE_IPV4){const r=new y({id:e.id,legacyUnicast:e.legacyUnicast,type:1,flags:{authoritativeAnswer:!0},questions:e.questions,answers:e.answers,additionals:e.additionals});return r.getEncodingLength()>t&&n.default.fail("Couldn't construct a dns response packet from a rr set which fits in an udp payload sized packet!"),r}canBeCombinedWith(e,t=y.UDP_PAYLOAD_SIZE_IPV4){return this.id===e.id&&this.type===e.type&&this.opcode===e.opcode&&(0,o.default)(this.flags,e.flags)&&this.rcode===e.rcode&&this.getEncodingLength()+e.getEncodingLength()<=t}combineWith(e){this.setLegacyUnicastEncoding(this.legacyUnicastEncoding||e.legacyUnicastEncoding),this.addRecords(this.questions,e.questions.values()),this.addRecords(this.answers,e.answers.values(),this.additionals),this.addRecords(this.authorities,e.authorities.values()),this.addRecords(this.additionals,e.additionals.values())}addQuestions(...e){return this.addRecords(this.questions,e)}addAnswers(...e){return this.addRecords(this.answers,e,this.additionals)}addAuthorities(...e){return this.addRecords(this.authorities,e)}addAdditionals(...e){return this.addRecords(this.additionals,e)}addRecords(e,t,r){let i=!1;for(const n of t)e.has(n.asString())||(this.estimatedEncodingLength&&(this.estimatedEncodingLength+=n.getEncodingLength(s.NonCompressionLabelCoder.INSTANCE)),e.set(n.asString(),n),i=!0,this.lengthDirty=!0,r&&r.delete(n.asString()));return i}setLegacyUnicastEncoding(e){this.legacyUnicastEncoding!==e&&(this.lengthDirty=!0),this.legacyUnicastEncoding=e}legacyUnicastEncodingEnabled(){return this.legacyUnicastEncoding}getEstimatedEncodingLength(){if(this.estimatedEncodingLength)return this.estimatedEncodingLength;const e=s.NonCompressionLabelCoder.INSTANCE;let t=y.DNS_PACKET_HEADER_SIZE;for(const r of this.questions.values())t+=r.getEncodingLength(e);for(const r of this.answers.values())t+=r.getEncodingLength(e);for(const r of this.authorities.values())t+=r.getEncodingLength(e);for(const r of this.additionals.values())t+=r.getEncodingLength(e);return this.estimatedEncodingLength=t,t}getEncodingLength(e){if(!this.lengthDirty)return this.lastCalculatedLength;const t=e||new s.DNSLabelCoder(this.legacyUnicastEncoding);let r=y.DNS_PACKET_HEADER_SIZE;for(const e of this.questions.values())r+=e.getEncodingLength(t);for(const e of this.answers.values())r+=e.getEncodingLength(t);for(const e of this.authorities.values())r+=e.getEncodingLength(t);for(const e of this.additionals.values())r+=e.getEncodingLength(t);return this.lengthDirty=!1,this.lastCalculatedLength=r,this.estimatedEncodingLength=r,r}encode(){const e=new s.DNSLabelCoder(this.legacyUnicastEncoding),t=this.getEncodingLength(e),r=Buffer.allocUnsafe(t);e.initBuf(r);let i=0;r.writeUInt16BE(this.id,i),i+=2;let o=this.type<<15|this.opcode<<11|this.rcode;this.flags.authoritativeAnswer&&(o|=y.AUTHORITATIVE_ANSWER_MASK),this.flags.truncation&&(o|=y.TRUNCATION_MASK),this.flags.recursionDesired&&(o|=y.RECURSION_DESIRED_MASK),this.flags.recursionAvailable&&(o|=y.RECURSION_AVAILABLE_MASK),this.flags.zero&&(o|=y.ZERO_HEADER_MASK),this.flags.authenticData&&(o|=y.AUTHENTIC_DATA_MASK),this.flags.checkingDisabled&&(o|=y.CHECKING_DISABLED_MASK),r.writeUInt16BE(o,i),i+=2,r.writeUInt16BE(this.questions.size,i),i+=2,r.writeUInt16BE(this.answers.size,i),i+=2,r.writeUInt16BE(this.authorities.size,i),i+=2,r.writeUInt16BE(this.additionals.size,i),i+=2;for(const t of this.questions.values()){i+=t.encode(e,r,i)}for(const t of this.answers.values()){i+=t.encode(e,r,i)}for(const t of this.authorities.values()){i+=t.encode(e,r,i)}for(const t of this.additionals.values()){i+=t.encode(e,r,i)}return(0,n.default)(i===r.length,"Bytes written didn't match the buffer size!"),r}static decode(e,t,r=0){const i=new s.DNSLabelCoder;i.initBuf(t);const o=t.readUInt16BE(r);r+=2;const a=t.readUInt16BE(r);r+=2;const l=t.readUInt16BE(r);r+=2;const h=t.readUInt16BE(r);r+=2;const d=t.readUInt16BE(r);r+=2;const p=t.readUInt16BE(r);r+=2;const f=[],g=[],m=[],v=[];r+=y.decodeList(e,i,t,r,l,c.Question.decode.bind(c.Question),f),r+=y.decodeList(e,i,t,r,h,u.ResourceRecord.decode.bind(u.ResourceRecord),g),r+=y.decodeList(e,i,t,r,d,u.ResourceRecord.decode.bind(u.ResourceRecord),m),r+=y.decodeList(e,i,t,r,p,u.ResourceRecord.decode.bind(u.ResourceRecord),v),(0,n.default)(r===t.length,"Didn't read the full buffer (offset="+r+", length="+t.length+")");const C=a>>15,S=a>>11&15,E=15&a,_={};return a&this.AUTHORITATIVE_ANSWER_MASK&&(_.authoritativeAnswer=!0),a&this.TRUNCATION_MASK&&(_.truncation=!0),a&this.RECURSION_DESIRED_MASK&&(_.recursionDesired=!0),a&this.RECURSION_AVAILABLE_MASK&&(_.recursionAvailable=!0),a&this.ZERO_HEADER_MASK&&(_.zero=!0),a&this.AUTHENTIC_DATA_MASK&&(_.authenticData=!0),a&this.CHECKING_DISABLED_MASK&&(_.checkingDisabled=!0),new y({id:o,type:C,opcode:S,rCode:E,flags:_,questions:f,answers:g,authorities:m,additionals:v})}static decodeList(e,t,r,i,n,o,a){const s=i;for(let s=0;s<n;s++){const n=o(e,t,r,i);i+=n.readBytes,n.data&&a.push(n.data)}return i-s}asLoggingString(e){let t="",r="";for(const e of this.answers.values())t&&(t+=","),t+=(0,a.dnsTypeToString)(e.type);for(const e of this.additionals.values())r&&(r+=","),r+=(0,a.dnsTypeToString)(e.type);const i=[];this.legacyUnicastEncodingEnabled()&&i.push("U"),e&&i.push("UPS: "+e);const n=0!==i.length?` (${i})`:"";return`[${t}] answers and [${r}] additionals with size ${this.getEncodingLength()}B${n}`}}t.DNSPacket=y,y.UDP_PAYLOAD_SIZE_IPV4=process.env.CIAO_UPS?parseInt(process.env.CIAO_UPS):1440,y.UDP_PAYLOAD_SIZE_IPV6=process.env.CIAO_UPS?parseInt(process.env.CIAO_UPS):1440,y.AUTHORITATIVE_ANSWER_MASK=1024,y.TRUNCATION_MASK=512,y.RECURSION_DESIRED_MASK=256,y.RECURSION_AVAILABLE_MASK=128,y.ZERO_HEADER_MASK=64,y.AUTHENTIC_DATA_MASK=32,y.CHECKING_DISABLED_MASK=16,y.DNS_PACKET_HEADER_SIZE=12},5682:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Question=void 0;const i=r(7585);class n{constructor(e,t,r=!1,i=1){this.unicastResponseFlag=!1,e.endsWith(".")||(e+="."),this.name=e,this.type=t,this.class=i,this.unicastResponseFlag=r}getLowerCasedName(){return this.lowerCasedName||(this.lowerCasedName=(0,i.dnsLowerCase)(this.name))}getEncodingLength(e){return e.getNameLength(this.name)+4}encode(e,t,r){const i=r;r+=e.encodeName(this.name,r),t.writeUInt16BE(this.type,r),r+=2;let o=this.class;return this.unicastResponseFlag&&(o|=n.QU_MASK),t.writeUInt16BE(o,r),(r+=2)-i}clone(){return new n(this.name,this.type,this.unicastResponseFlag,this.class)}asString(){return`Q ${this.name} ${this.type} ${this.class}`}static decode(e,t,r,i){const o=i,a=t.decodeName(i);i+=a.readBytes;const s=r.readUInt16BE(i);i+=2;const c=r.readUInt16BE(i);i+=2;const u=c&this.NOT_QU_MASK,l=!!(c&this.QU_MASK);return{data:new n(a.data,s,l,u),readBytes:i-o}}}t.Question=n,n.QU_MASK=32768,n.NOT_QU_MASK=32767},5231:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResourceRecord=void 0;const i=r(1635),n=i.__importDefault(r(2613)),o=i.__importDefault(r(5753)),a=r(7585),s=r(1673),c=r(7352),u=(0,o.default)("ciao:decoder");class l{constructor(e,t,r=l.RR_DEFAULT_TTL,i=!1,n=1){this.flushFlag=!1,"string"==typeof e?(e.endsWith(".")||(e+="."),this.name=e,this.type=t,this.class=n,this.ttl=r,this.flushFlag=i):(this.name=e.name,this.type=e.type,this.class=e.class,this.ttl=e.ttl,this.flushFlag=e.flushFlag)}getLowerCasedName(){return this.lowerCasedName||(this.lowerCasedName=(0,a.dnsLowerCase)(this.name))}getEncodingLength(e){return e.getNameLength(this.name)+10+this.getRDataEncodingLength(e)}encode(e,t,r){const i=r;r+=e.encodeName(this.name,r),t.writeUInt16BE(this.type,r),r+=2;let n=this.class;this.flushFlag&&(n|=l.FLUSH_MASK),t.writeUInt16BE(n,r),r+=2,t.writeUInt32BE(this.ttl,r),r+=4;const o=this.encodeRData(e,t,r+2);return t.writeUInt16BE(o,r),(r+=2+o)-i}getRawData(){const e=c.NonCompressionLabelCoder.INSTANCE,t=this.getRDataEncodingLength(e),r=Buffer.allocUnsafe(t);e.initBuf(r);const i=this.encodeRData(e,r,0);return(0,n.default)(i===r.length,"Didn't completely write to the buffer! ("+i+"!="+r.length+")"),e.initBuf(),r}static clone(e){return e.map((e=>e.clone()))}getRecordRepresentation(){return{name:this.name,type:this.type,class:this.class,ttl:this.ttl,flushFlag:this.flushFlag}}aboutEqual(e){return this.type===e.type&&this.name===e.name&&this.class===e.class&&this.dataEquals(e)}representsSameData(e){return this.type===e.type&&this.name===e.name&&this.class===e.class}asString(){return`RR ${this.name} ${this.type} ${this.class} ${this.dataAsString()}`}static decode(e,t,r,i){const n=i,o=this.decodeRecordHeader(t,r,i);i+=o.readBytes;const a=o.data,c=this.typeToRecordDecoder.get(a.type);if(!c)return{readBytes:i+a.rDataLength-n};t.initRRLocation(n,i,a.rDataLength);const l=r.subarray(0,i+a.rDataLength);let h;try{h=c(t,a,l,i)}catch(t){return u(`Received malformed rdata section for ${(0,s.dnsTypeToString)(a.type)} ${a.name} ${a.ttl} from ${e.address}:${e.port} with data '${l.subarray(i).toString("hex")}': ${t.stack}`),{readBytes:i+a.rDataLength-n}}return i+=h.readBytes,t.clearRRLocation(),{data:h.data,readBytes:i-n}}static decodeRecordHeader(e,t,r){const i=r,n=e.decodeName(r);r+=n.readBytes;const o=t.readUInt16BE(r);r+=2;const a=t.readUInt16BE(r);let s;r+=2;let c=!1;41!==o?(s=a&this.NOT_FLUSH_MASK,c=!!(a&this.FLUSH_MASK)):s=a;const u=t.readUInt32BE(r);r+=4;const l=t.readUInt16BE(r);r+=2;return{data:{name:n.data,type:o,class:s,ttl:u,flushFlag:c,rDataLength:l},readBytes:r-i}}}t.ResourceRecord=l,l.typeToRecordDecoder=new Map,l.FLUSH_MASK=32768,l.NOT_FLUSH_MASK=32767,l.RR_DEFAULT_TTL_SHORT=120,l.RR_DEFAULT_TTL=4500},1673:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dnsTypeToString=void 0,t.dnsTypeToString=function(e){switch(e){case 1:return"A";case 5:return"CNAME";case 12:return"PTR";case 16:return"TXT";case 28:return"AAAA";case 33:return"SRV";case 41:return"OPT";case 47:return"NSEC";case 255:return"ANY"}return"UNSUPPORTED_"+e}},1360:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AAAARecord=void 0;const i=r(1635),n=i.__importDefault(r(2613)),o=i.__importDefault(r(9278)),a=r(9152),s=r(5231);class c extends s.ResourceRecord{constructor(e,t,r,i){"string"==typeof e?super(e,28,i||c.RR_DEFAULT_TTL_SHORT,r):((0,n.default)(28===e.type),super(e)),(0,n.default)(o.default.isIPv6(t),"IP address is not in v6 format!"),this.ipAddress=t}getRDataEncodingLength(){return 16}encodeRData(e,t,r){const i=r,o=(0,a.enlargeIPv6)(this.ipAddress).split(":");(0,n.default)(8===o.length,"invalid ip address");for(const e of o){const i=parseInt(e,16);t.writeUInt16BE(i,r),r+=2}return r-i}static decodeData(e,t,r,i){const n=i,o=new Array(8);for(let e=0;e<8;e++){const t=r.readUInt16BE(i);i+=2,o[e]=t.toString(16)}const s=(0,a.shortenIPv6)(o.join(":"));return{data:new c(t,s),readBytes:i-n}}clone(){return new c(this.getRecordRepresentation(),this.ipAddress)}dataAsString(){return this.ipAddress}dataEquals(e){return this.ipAddress===e.ipAddress}}t.AAAARecord=c,c.DEFAULT_TTL=120},4495:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ARecord=void 0;const i=r(1635),n=i.__importDefault(r(2613)),o=i.__importDefault(r(9278)),a=r(5231);class s extends a.ResourceRecord{constructor(e,t,r,i){"string"==typeof e?super(e,1,i||s.RR_DEFAULT_TTL_SHORT,r):((0,n.default)(1===e.type),super(e)),(0,n.default)(o.default.isIPv4(t),"IP address is not in v4 format!"),this.ipAddress=t}getRDataEncodingLength(){return 4}encodeRData(e,t,r){const i=r,o=this.ipAddress.split(".");(0,n.default)(4===o.length,"invalid ip address");for(const e of o){const i=parseInt(e,10);t.writeUInt8(i,r++)}return r-i}static decodeData(e,t,r,i){const n=i,o=new Array(4);for(let e=0;e<4;e++){const t=r.readUInt8(i++);o[e]=t.toString(10)}const a=o.join(".");return{data:new s(t,a),readBytes:i-n}}clone(){return new s(this.getRecordRepresentation(),this.ipAddress)}dataAsString(){return this.ipAddress}dataEquals(e){return this.ipAddress===e.ipAddress}}t.ARecord=s,s.DEFAULT_TTL=120},5102:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CNAMERecord=void 0;const i=r(1635).__importDefault(r(2613)),n=r(7585),o=r(5231);class a extends o.ResourceRecord{constructor(e,t,r,n){"string"==typeof e?super(e,5,n,r):((0,i.default)(5===e.type),super(e)),t.endsWith(".")||(t+="."),this.cname=t}getLowerCasedCName(){return this.lowerCasedCName||(this.lowerCasedCName=(0,n.dnsLowerCase)(this.cname))}getRDataEncodingLength(e){return e.getNameLength(this.cname)}encodeRData(e,t,r){const i=r;return(r+=e.encodeName(this.cname,r))-i}static decodeData(e,t,r,i){const n=i,o=e.decodeName(i);return i+=o.readBytes,{data:new a(t,o.data),readBytes:i-n}}clone(){return new a(this.getRecordRepresentation(),this.cname)}dataAsString(){return this.cname}dataEquals(e){return this.getLowerCasedCName()===e.getLowerCasedCName()}}t.CNAMERecord=a,a.DEFAULT_TTL=o.ResourceRecord.RR_DEFAULT_TTL},6343:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NSECRecord=void 0;const i=r(1635),n=i.__importDefault(r(2613)),o=i.__importDefault(r(2017)),a=r(7585),s=r(5231);class c extends s.ResourceRecord{constructor(e,t,r,i,o){"string"==typeof e?super(e,47,i||c.RR_DEFAULT_TTL_SHORT,o):((0,n.default)(47===e.type),super(e)),t.endsWith(".")||(t+="."),this.nextDomainName=t,this.rrTypeWindows=c.rrTypesToWindowMap(r)}getLowerCasedNextDomainName(){return this.lowerCasedNextDomainName||(this.lowerCasedNextDomainName=(0,a.dnsLowerCase)(this.nextDomainName))}getRRTypesBitMapEncodingLength(){let e=0;for(const t of this.rrTypeWindows)(0,n.default)(t.rrtypes.length>0,"types array for windowId "+t.windowId+" cannot be empty!"),e+=2+t.bitMapSize;return e}getRDataEncodingLength(e){return e.legacyUnicastEncoding,e.getUncompressedNameLength(this.nextDomainName)+this.getRRTypesBitMapEncodingLength()}encodeRData(e,t,r){const i=r;r+=(e.legacyUnicastEncoding,e.encodeUncompressedName(this.nextDomainName,r));for(const e of this.rrTypeWindows){t.writeUInt8(e.windowId,r++),t.writeUInt8(e.bitMapSize,r++);const i=Buffer.alloc(e.bitMapSize);for(const t of e.rrtypes){const e=(255&t)>>3;let r=i.readUInt8(e);r|=1<<7-(7&t),i.writeUInt8(r,e)}i.copy(t,r),r+=i.length}return r-i}static decodeData(e,t,r,i){const n=i,o=e.decodeName(i,!1);i+=o.readBytes;const a=[];for(;i<r.length;){const e=r.readUInt8(i++),t=r.readUInt8(i++),n=e<<8;for(let e=0;e<t;e++){const t=r.readUInt8(i++);for(let r=0;r<8;r++)if(t&1<<7-r){const t=n|e<<3|r;a.push(t)}}}return{data:new c(t,o.data,a),readBytes:i-n}}clone(){return new c(this.getRecordRepresentation(),this.nextDomainName,c.windowsToRRTypes(this.rrTypeWindows))}dataAsString(){return`${this.nextDomainName} [${c.windowsToRRTypes(this.rrTypeWindows).map((e=>""+e)).join(",")}]`}dataEquals(e){return this.getLowerCasedNextDomainName()===e.getLowerCasedNextDomainName()&&(0,o.default)(this.rrTypeWindows,e.rrTypeWindows)}static rrTypesToWindowMap(e){const t=[];for(const r of e){const e=r>>8;let i;for(const r of t)if(r.windowId===e){i=r;break}if(i){i.rrtypes.push(r);const e=Math.ceil((255&r)/8);e>i.bitMapSize&&(i.bitMapSize=e)}else i={windowId:e,bitMapSize:Math.ceil((255&r)/8),rrtypes:[r]},t.push(i)}return t.sort(((e,t)=>e.windowId-t.windowId)),t.forEach((e=>e.rrtypes.sort(((e,t)=>e-t)))),t}static windowsToRRTypes(e){const t=[];for(const r of e)t.push(...r.rrtypes);return t}}t.NSECRecord=c},6141:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OPTRecord=void 0;const i=r(1635),n=i.__importDefault(r(2613)),o=i.__importDefault(r(2017)),a=r(5231);class s extends a.ResourceRecord{constructor(e,t,r,i,o,a){"number"==typeof e?(super(".",41,a,!1,e),this.udpPayloadSize=e):((0,n.default)(41===e.type),super(e),this.udpPayloadSize=e.class),this.extendedRCode=r||0,this.ednsVersion=o||s.EDNS_VERSION,this.flags={dnsSecOK:(null==i?void 0:i.dnsSecOK)||!1,zero:(null==i?void 0:i.zero)||0,...i},this.options=t||[]}getRDataEncodingLength(){let e=0;for(const t of this.options)e+=4+t.data.length;return e}encodeRData(e,t,r){const i=r,n=r-8,o=r-6;t.writeUInt16BE(this.udpPayloadSize,n),t.writeUInt8(this.extendedRCode,o),t.writeUInt8(this.ednsVersion,o+1);let a=this.flags.zero||0;this.flags.dnsSecOK&&(a|=s.DNS_SEC_OK_MASK),t.writeUInt16BE(a,o+2);for(const e of this.options)t.writeUInt16BE(e.code,r),r+=2,t.writeUInt16BE(e.data.length,r),r+=2,e.data.copy(t,r),r+=e.data.length;return r-i}static decodeData(e,t,r,i){const n=i,o=i-8,a=i-6,c=r.readUInt16BE(o),u=r.readUInt8(a),l=r.readUInt8(a+1),h=r.readUInt16BE(a+2),d={dnsSecOK:!!(h&s.DNS_SEC_OK_MASK),zero:h&s.NOT_DNS_SEC_OK_MASK},p=[];for(;i<r.length;){const e=r.readUInt16BE(i);i+=2;const t=r.readUInt16BE(i);i+=2;const n=r.subarray(i,i+t);i+=t,p.push({code:e,data:n})}return t.class=c,t.ttl=4500,{data:new s(t,p,u,d,l),readBytes:i-n}}clone(){return new s(this.getRecordRepresentation(),this.options,this.extendedRCode,this.flags,this.ednsVersion)}dataAsString(){return`${this.udpPayloadSize} ${this.extendedRCode} ${this.ednsVersion} ${JSON.stringify(this.flags)} [${this.options.map((e=>`${e.code} ${e.data.toString("base64")}`)).join(",")}]`}dataEquals(e){return this.udpPayloadSize===e.udpPayloadSize&&this.extendedRCode===e.extendedRCode&&this.ednsVersion===e.ednsVersion&&s.optionsEquality(this.options,e.options)&&(0,o.default)(this.flags,e.flags)}static optionsEquality(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++){if(e[r].code!==t[r].code)return!1;if(e[r].data.toString("hex")!==t[r].data.toString("hex"))return!1}return!0}}t.OPTRecord=s,s.EDNS_VERSION=0,s.DNS_SEC_OK_MASK=32768,s.NOT_DNS_SEC_OK_MASK=32767},482:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PTRRecord=void 0;const i=r(1635).__importDefault(r(2613)),n=r(7585),o=r(5231);class a extends o.ResourceRecord{constructor(e,t,r,n){"string"==typeof e?super(e,12,n,r):((0,i.default)(12===e.type),super(e)),t.endsWith(".")||(t+="."),this.ptrName=t}getLowerCasedPTRName(){return this.lowerCasedPtrName||(this.lowerCasedPtrName=(0,n.dnsLowerCase)(this.ptrName))}getRDataEncodingLength(e){return e.getNameLength(this.ptrName)}encodeRData(e,t,r){const i=r;return(r+=e.encodeName(this.ptrName,r))-i}static decodeData(e,t,r,i){const n=i,o=e.decodeName(i);return i+=o.readBytes,{data:new a(t,o.data),readBytes:i-n}}clone(){return new a(this.getRecordRepresentation(),this.ptrName)}dataAsString(){return this.ptrName}dataEquals(e){return this.getLowerCasedPTRName()===e.getLowerCasedPTRName()}}t.PTRRecord=a,a.DEFAULT_TTL=o.ResourceRecord.RR_DEFAULT_TTL},8225:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SRVRecord=void 0;const i=r(1635).__importDefault(r(2613)),n=r(7585),o=r(5231);class a extends o.ResourceRecord{constructor(e,t,r,n,o){"string"==typeof e?super(e,33,o||a.RR_DEFAULT_TTL_SHORT,n):((0,i.default)(33===e.type),super(e)),t.endsWith(".")?this.hostname=t:this.hostname=t+".",this.port=r,this.priority=0,this.weight=0}getLowerCasedHostname(){return this.lowerCasedHostname||(this.lowerCasedHostname=(0,n.dnsLowerCase)(this.hostname))}getRDataEncodingLength(e){return 6+(e.legacyUnicastEncoding?e.getUncompressedNameLength(this.hostname):e.getNameLength(this.hostname))}encodeRData(e,t,r){const i=r;t.writeUInt16BE(this.priority,r),r+=2,t.writeUInt16BE(this.weight,r),r+=2,t.writeUInt16BE(this.port,r),r+=2;return(r+=e.legacyUnicastEncoding?e.encodeUncompressedName(this.hostname,r):e.encodeName(this.hostname,r))-i}static decodeData(e,t,r,i){const n=i;i+=2,i+=2;const o=r.readUInt16BE(i);i+=2;const s=e.decodeName(i);return i+=s.readBytes,{data:new a(t,s.data,o),readBytes:i-n}}clone(){return new a(this.getRecordRepresentation(),this.hostname,this.port)}dataAsString(){return`${this.hostname} ${this.port} ${this.priority} ${this.weight}`}dataEquals(e){return this.getLowerCasedHostname()===e.getLowerCasedHostname()&&this.port===e.port&&this.weight===e.weight&&this.priority===e.priority}}t.SRVRecord=a,a.DEFAULT_TTL=120},1576:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TXTRecord=void 0;const i=r(1635).__importDefault(r(2613)),n=r(5231);class o extends n.ResourceRecord{constructor(e,t,r,n){"string"==typeof e?super(e,16,n,r):((0,i.default)(16===e.type),super(e)),this.txt=0===t.length?[Buffer.from([])]:t}getRDataEncodingLength(){let e=0;for(const t of this.txt)e+=1+t.length,(0,i.default)(t.length<=255,"One txt character-string can only have a length of 255 chars");return e}encodeRData(e,t,r){const i=r;for(const e of this.txt)t.writeUInt8(e.length,r++),e.copy(t,r),r+=e.length;return r-i}clone(){return new o(this.getRecordRepresentation(),this.txt)}dataAsString(){return`[${this.txt.map((e=>`${e.toString("base64")}`)).join(",")}]`}dataEquals(e){if(this.txt.length!==e.txt.length)return!1;for(let t=0;t<this.txt.length;t++)if(this.txt[t].toString("hex")!==e.txt[t].toString("hex"))return!1;return!0}static decodeData(e,t,r,i){const n=i,a=[];for(;i<r.length;){const e=r.readUInt8(i++);a.push(r.subarray(i,i+e)),i+=e}return{data:new o(t,a),readBytes:i-n}}}t.TXTRecord=o,o.DEFAULT_TTL=n.ResourceRecord.RR_DEFAULT_TTL},9577:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(5231),n=r(1360),o=r(4495),a=r(5102),s=r(6343),c=r(6141),u=r(482),l=r(8225),h=r(1576);i.ResourceRecord.typeToRecordDecoder.set(28,n.AAAARecord.decodeData),i.ResourceRecord.typeToRecordDecoder.set(1,o.ARecord.decodeData),i.ResourceRecord.typeToRecordDecoder.set(5,a.CNAMERecord.decodeData),i.ResourceRecord.typeToRecordDecoder.set(47,s.NSECRecord.decodeData),i.ResourceRecord.typeToRecordDecoder.set(12,u.PTRRecord.decodeData),i.ResourceRecord.typeToRecordDecoder.set(33,l.SRVRecord.decodeData),i.ResourceRecord.typeToRecordDecoder.set(41,c.OPTRecord.decodeData),i.ResourceRecord.typeToRecordDecoder.set(16,h.TXTRecord.decodeData)},8318:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getResponder=t.Protocol=void 0;const i=r(1635);r(3476);const n=i.__importDefault(r(5753)),o=r(3325).rE;if(o.includes("beta")||process.env.BCT){const e=process.env.DEBUG;e&&e.includes("ciao")||(e?n.default.enable(e+",ciao:*"):n.default.enable("ciao:*"))}r(9577);const a=r(4288);var s;function c(e){return a.Responder.getResponder(e)}i.__exportStar(r(141),t),i.__exportStar(r(4288),t),(0,n.default)("ciao:init")("Loading ciao v"+o+"..."),function(e){e.TCP="tcp",e.UDP="udp"}(s||(t.Protocol=s={})),t.getResponder=c,t.default={getResponder:c}},9983:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Announcer=void 0;const i=r(1635),n=i.__importDefault(r(2613)),o=i.__importDefault(r(5753)),a=r(4119),s=r(2361),c=r(8390),u=(0,o.default)("ciao:Announcer");class l{constructor(e,t,r){this.repetitions=1,this.announceIntervalIncreaseFactor=2,this.goodbye=!1,this.sentAnnouncements=0,this.sentLastAnnouncement=!1,this.nextInterval=1e3,this.nextAnnouncementTime=0,(0,n.default)(e,"server must be defined"),(0,n.default)(t,"service must be defined"),this.server=e,this.service=t,r&&(void 0!==r.repetitions&&(this.repetitions=r.repetitions),r.goodbye&&(this.goodbye=!0)),(0,n.default)(this.repetitions>0&&this.repetitions<=8,"repetitions must in [1;8]")}announce(){return u("[%s] Sending %s for service",this.service.getFQDN(),this.goodbye?"goodbye":"announcement"),this.goodbye||this.service.rebuildServiceRecords(),this.promise=new Promise(((e,t)=>{this.promiseResolve=e,this.promiseReject=t,this.timer=setTimeout(this.sendAnnouncement.bind(this),0),this.timer.unref(),this.nextAnnouncementTime=(new Date).getTime()}))}async cancel(){return u("[%s] Canceling %s",this.service.getFQDN(),this.goodbye?"goodbye":"announcement"),this.timer&&(clearTimeout(this.timer),this.timer=void 0),this.promiseReject(l.CANCEL_REASON),this.awaitAnnouncement().catch((e=>{if(e!==l.CANCEL_REASON)return Promise.reject(e)}))}hasSentLastAnnouncement(){return this.sentLastAnnouncement}async awaitAnnouncement(){await this.promise}isSendingGoodbye(){return this.goodbye}sendAnnouncement(){u("[%s] Sending %s number %d",this.service.getFQDN(),this.goodbye?"goodbye":"announcement",this.sentAnnouncements+1);const e=[this.service.ptrRecord(),...this.service.subtypePtrRecords(),this.service.srvRecord(),this.service.txtRecord()];if(this.goodbye)for(const t of e)t.ttl=0;else e.push(this.service.metaQueryPtrRecord());this.sentAnnouncements+1>=this.repetitions&&(this.sentLastAnnouncement=!0),l.sendResponseAddingAddressRecords(this.server,this.service,e,this.goodbye).then((e=>{const t=(0,s.SendResultFailedRatio)(e);if(1===t)return console.error((0,s.SendResultFormatError)(e,`[${this.service.getFQDN()}] Failed to send ${this.goodbye?"goodbye":"announcement"} requests`),!0),void this.promiseReject(new Error((this.goodbye?"Goodbye":"Announcement")+" failed as of socket errors!"));t>0&&u((0,s.SendResultFormatError)(e,`Some of the ${this.goodbye?"goodbye":"announcement"} requests for '${this.service.getFQDN()}' encountered an error`)),"announcing"===this.service.serviceState?(this.sentAnnouncements++,this.sentAnnouncements>=this.repetitions?this.promiseResolve():(this.timer=setTimeout(this.sendAnnouncement.bind(this),this.nextInterval),this.timer.unref(),this.nextAnnouncementTime=(new Date).getTime()+this.nextInterval,this.nextInterval*=this.announceIntervalIncreaseFactor)):u("[%s] Service is no longer in announcing state. Stopping. (Received %s)",this.service.getFQDN(),this.service.serviceState)}))}static sendResponseAddingAddressRecords(e,t,r,i){const n=[];for(const o of e.getBoundInterfaceNames()){if(!t.advertisesOnInterface(o))continue;const u=r.concat([]),l=t.aRecord(o),h=t.aaaaRecord(o),d=t.aaaaRoutableRecord(o),p=t.aaaaUniqueLocalRecord(o),f=t.addressNSECRecord(),g=t.serviceNSECRecord();l&&(i&&(l.ttl=0),u.push(l)),h&&(i&&(h.ttl=0),u.push(h)),d&&(i&&(d.ttl=0),u.push(d)),p&&(i&&(p.ttl=0),u.push(p)),i&&(f.ttl=0,g.ttl=0);const m=[];m.push(f,g);const v=a.DNSPacket.createDNSResponsePacketsFromRRSet({answers:u,additionals:m});n.push(Promise.race([e.send(v,o),(0,c.PromiseTimeout)(s.MDNSServer.SEND_TIMEOUT).then((()=>({status:"timeout",interface:o})))]))}return Promise.all(n)}}t.Announcer=l,l.CANCEL_REASON="CIAO ANNOUNCEMENT CANCELLED"},2475:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Prober=void 0;const i=r(1635),n=i.__importDefault(r(2613)),o=i.__importDefault(r(5753)),a=r(5682),s=r(2361),c=i.__importStar(r(6948)),u=r(6948),l=(0,o.default)("ciao:Prober");class h{constructor(e,t,r){this.records=[],this.currentInterval=250,this.serviceEncounteredNameChange=!1,this.sentFirstProbeQuery=!1,this.sentQueriesForCurrentTry=0,this.sentQueries=0,(0,n.default)(e,"responder must be defined"),(0,n.default)(t,"server must be defined"),(0,n.default)(r,"service must be defined"),this.responder=e,this.server=t,this.service=r}getService(){return this.service}probe(){return l("Starting to probe for '%s'...",this.service.getFQDN()),new Promise(((e,t)=>{this.promiseResolve=e,this.promiseReject=t,this.timer=setTimeout(this.sendProbeRequest.bind(this),250*Math.random()),this.timer.unref()}))}cancel(){this.clear(),this.promiseReject(h.CANCEL_REASON)}clear(){this.timer&&(clearTimeout(this.timer),this.timer=void 0),this.sentFirstProbeQuery=!1,this.sentQueriesForCurrentTry=0}endProbing(e){this.clear(),e&&(l("Probing for '%s' finished successfully",this.service.getFQDN()),this.promiseResolve(),this.serviceEncounteredNameChange&&this.service.informAboutNameUpdates())}sendProbeRequest(){if(0===this.sentQueriesForCurrentTry&&(this.records=[this.service.srvRecord(),this.service.txtRecord(),this.service.ptrRecord(),...this.service.subtypePtrRecords(),...this.service.allAddressRecords()].sort(u.rrComparator),this.records.forEach((e=>e.flushFlag=!1))),this.sentQueriesForCurrentTry>=3)return void this.endProbing(!0);this.sentQueries>=15&&(this.currentInterval=1e3),l("Sending prober query number %d for '%s'...",this.sentQueriesForCurrentTry+1,this.service.getFQDN()),(0,n.default)(this.records.length>0,"Tried sending probing request for zero record length!");const e=[new a.Question(this.service.getFQDN(),255,!0),new a.Question(this.service.getHostname(),255,!0)];this.server.sendQueryBroadcast({questions:e,authorities:this.records},this.service).then((e=>{const t=(0,s.SendResultFailedRatio)(e);if(1===t)return console.error((0,s.SendResultFormatError)(e,`Failed to send probe queries for '${this.service.getFQDN()}'`),!0),this.endProbing(!1),void this.promiseReject(new Error("Probing failed as of socket errors!"));t>0&&l((0,s.SendResultFormatError)(e,`Some of the probe queries for '${this.service.getFQDN()}' encountered an error`)),"probing"===this.service.serviceState?(this.sentFirstProbeQuery=!0,this.sentQueriesForCurrentTry++,this.sentQueries++,this.timer=setTimeout(this.sendProbeRequest.bind(this),this.currentInterval),this.timer.unref(),this.checkLocalConflicts()):l("Service '%s' is no longer in probing state. Stopping.",this.service.getFQDN())}))}checkLocalConflicts(){let e=!1;for(const t of this.responder.getAnnouncedServices())if(t.getLowerCasedFQDN()===this.service.getLowerCasedFQDN()||t.getLowerCasedHostname()===this.service.getLowerCasedHostname()){e=!0;break}e&&(l("Probing for '%s' failed as of local service. Doing a name change",this.service.getFQDN()),this.handleNameChange())}handleResponse(e,t){if(!this.sentFirstProbeQuery||!this.service.advertisesOnInterface(t.interface))return;let r=!1;for(const t of e.answers.values())if(t.getLowerCasedName()===this.service.getLowerCasedFQDN()||t.getLowerCasedName()===this.service.getLowerCasedHostname()){r=!0;break}for(const t of e.additionals.values())if(t.getLowerCasedName()===this.service.getLowerCasedFQDN()||t.getLowerCasedName()===this.service.getLowerCasedHostname()){r=!0;break}r&&(l("Probing for '%s' failed. Doing a name change",this.service.getFQDN()),this.handleNameChange())}handleNameChange(){this.endProbing(!1),this.service.serviceState="unannounced",this.service.incrementName(),this.service.serviceState="probing",this.serviceEncounteredNameChange=!0,this.timer=setTimeout(this.sendProbeRequest.bind(this),1e3),this.timer.unref()}handleQuery(e,t){if(!this.sentFirstProbeQuery||!this.service.advertisesOnInterface(t.interface))return;let r=!1;for(const t of e.questions.values())if(t.getLowerCasedName()===this.service.getLowerCasedFQDN()||t.getLowerCasedName()===this.service.getLowerCasedHostname()){r=!0;break}r&&this.doTiebreaking(e)}doTiebreaking(e){if(!this.sentFirstProbeQuery)return;let t=0===e.authorities.size;for(const r of e.authorities.values())if(r.getLowerCasedName()===this.service.getLowerCasedFQDN()||r.getLowerCasedName()===this.service.getLowerCasedHostname()){t=!0;break}if(!t)return;const r=this.records,i=Array.from(e.authorities.values()).sort(c.rrComparator),n=c.runTiebreaking(r,i);1===n?l("'%s' won the tiebreak. We gonna ignore the other probing request!",this.service.getFQDN()):-1===n&&(l("'%s' lost the tiebreak. We are waiting a second and try to probe again...",this.service.getFQDN()),this.endProbing(!1),this.timer=setTimeout(this.sendProbeRequest.bind(this),1e3),this.timer.unref())}}t.Prober=h,h.CANCEL_REASON="CIAO PROBING CANCELLED"},572:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueryResponse=void 0;const i=r(4119);t.QueryResponse=class{constructor(e){this.sharedAnswer=!1,this.dnsPacket=new i.DNSPacket({type:1}),this.knownAnswers=e}asPacket(){return this.dnsPacket}asString(e){return this.dnsPacket.asLoggingString(e)}containsSharedAnswer(){return this.sharedAnswer}addAnswer(...e){let t=!1;for(const r of e){if(this.isKnownAnswer(r))continue;this.dnsPacket.addAnswers(r)&&(t=!0,r.flushFlag||(this.sharedAnswer=!0))}return t}addAdditional(...e){let t=!1;for(const r of e){if(this.isKnownAnswer(r))continue;if(this.dnsPacket.answers.has(r.asString()))continue;this.dnsPacket.addAdditionals(r)&&(t=!0)}return t}markLegacyUnicastResponse(e,t){this.dnsPacket.id=e,t&&this.dnsPacket.addQuestions(...t),this.dnsPacket.answers.forEach((e=>{e.flushFlag=!1,e.ttl=10})),this.dnsPacket.additionals.forEach((e=>{e.flushFlag=!1,e.ttl=10})),this.dnsPacket.setLegacyUnicastEncoding(!0)}markTruncated(){this.dnsPacket.flags.truncation=!0}hasAnswers(){return this.dnsPacket.answers.size>0}isKnownAnswer(e){if(!this.knownAnswers)return!1;const t=this.knownAnswers.get(e.asString());return void 0!==t&&t.ttl>e.ttl/2}static combineResponses(e,t){for(let r=0;r<e.length-1;r++){const i=e[r],n=i.dnsPacket,o=e[r+1],a=o.dnsPacket;n.canBeCombinedWith(a,t)&&(n.combineWith(a),e.splice(r+1,1),i.sharedAnswer=i.sharedAnswer||o.sharedAnswer,r--)}}}},8126:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueuedResponse=void 0;class r{constructor(e,t){this.timeOfCreation=(new Date).getTime(),this.estimatedTimeToBeSent=0,this.delay=-1,this.packet=e,this.interfaceName=t}getPacket(){return this.packet}getTimeSinceCreation(){return(new Date).getTime()-this.timeOfCreation}getTimeTillSent(){return Math.max(0,this.estimatedTimeToBeSent-(new Date).getTime())}calculateRandomDelay(){this.delay=100*Math.random()+20,this.estimatedTimeToBeSent=(new Date).getTime()+this.delay}scheduleResponse(e){this.timer=setTimeout(e,this.delay),this.timer.unref()}delayWouldBeInTimelyManner(e){return e.estimatedTimeToBeSent-this.timeOfCreation<=r.MAX_DELAY}combineWithNextPacketIfPossible(e){return this.interfaceName===e.interfaceName&&(!!e.packet.canBeCombinedWith(this.packet)&&(e.packet.combineWith(this.packet),e.timeOfCreation=Math.min(this.timeOfCreation,e.timeOfCreation),this.timer&&(clearTimeout(this.timer),this.timer=void 0),this.delayed=!0,!0))}combineWithUniqueResponseIfPossible(e,t){return this.interfaceName===t&&(!!this.packet.canBeCombinedWith(e.asPacket())&&(this.packet.combineWith(e.asPacket()),!0))}}t.QueuedResponse=r,r.MAX_DELAY=500},341:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TruncatedQuery=t.TruncatedQueryEvent=t.TruncatedQueryResult=void 0;const i=r(4434);var n,o;!function(e){e[e.ABORT=1]="ABORT",e[e.AGAIN_TRUNCATED=2]="AGAIN_TRUNCATED",e[e.FINISHED=3]="FINISHED"}(n||(t.TruncatedQueryResult=n={})),function(e){e.TIMEOUT="timeout"}(o||(t.TruncatedQueryEvent=o={}));class a extends i.EventEmitter{constructor(e){super(),this.arrivedPackets=1,this.timeOfArrival=(new Date).getTime(),this.packet=e,this.timer=this.resetTimer()}getPacket(){return this.packet}getArrivedPacketCount(){return this.arrivedPackets}getTotalWaitTime(){return(new Date).getTime()-this.timeOfArrival}appendDNSPacket(e){if(this.packet.combineWith(e),this.arrivedPackets++,e.flags.truncation){return(new Date).getTime()-this.timeOfArrival>5e3?1:(this.resetTimer(),2)}return clearTimeout(this.timer),this.removeAllListeners(),3}resetTimer(){return this.timer&&clearTimeout(this.timer),this.timer=setTimeout(this.timeout.bind(this),400+100*Math.random())}timeout(){this.emit("timeout"),this.removeAllListeners()}}t.TruncatedQuery=a},7585:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dnsLowerCase=void 0;const r=/[A-Z]/g;t.dnsLowerCase=function(e){return e.replace(r,(e=>e.toLowerCase()))}},9152:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNetAddress=t.ipAddressFromReversAddressName=t.formatReverseAddressPTRName=t.shortenIPv6=t.enlargeIPv6=t.removeTLD=t.formatHostname=t.stringify=t.parseFQDN=void 0;const i=r(1635),n=i.__importDefault(r(2613)),o=i.__importDefault(r(9278));function a(e){return e.startsWith("_")?e.slice(1):e}function s(e){(0,n.default)(o.default.isIPv6(e),"Illegal argument. Must be ipv6 address!"),(0,n.default)(!e.includes("."),"ipv4-mapped ipv6 addresses are currently unsupported!");const t=e.split(":");if(""===t[0])for(t.splice(0,1);t.length<8;)t.unshift("0000");else if(""===t[t.length-1])for(t.splice(t.length-1,1);t.length<8;)t.push("0000");else if(t.length<8){let e;for(e=0;e<t.length&&""!==t[e];e++);const r=new Array(9-t.length).fill("0000");t.splice(e,1,...r)}for(let e=0;e<t.length;e++){const r=t[e];if(r.length<4){const i=new Array(4-r.length).fill("0").join("");t.splice(e,1,i+r)}}const r=t.join(":");return(0,n.default)(t.length<=8,`Resulting ipv6 address has more than 8 sections (${r})!`),r}function c(e){"string"==typeof e&&(e=e.split(":"));for(let t=0;t<e.length;t++){const r=e[t];let i=0;for(;i<Math.min(3,r.length-1)&&"0"===r.charAt(i);i++);e[t]=r.substr(i)}let t=-1,r=0;for(let i=0;i<e.length;i++){if("0"!==e[i])continue;let n=1,o=i+1;for(;o<e.length&&"0"===e[o];o++)n++;n>r&&(t=i,r=n),i=o}if(-1!==t){const i=0===t||t+r===8;e[t]=i?":":"",r>1&&e.splice(t+1,r-1)}const i=e.join(":");return":"===i?"::":i}t.parseFQDN=function(e){const t=e.split(".");(0,n.default)(t.length>=3,"Received illegal fqdn: "+e);let r=t.length-1,i="";for(;"_tcp"!==(o=t[r])&&"_udp"!==o;)i=a(t[r])+(i?"."+i:""),r--;var o;(0,n.default)(r>=1,"Failed to parse illegal fqdn: "+e);const s=a(t[r--]),c=a(t[r--]);if(r<0)return{domain:i,protocol:s,type:c};if(function(e){return"_sub"===e}(t[r])){r--,(0,n.default)(0===r,"Received illegal formatted sub type fqdn: "+e);return{domain:i,protocol:s,type:c,subtype:a(t[r])}}return{domain:i,protocol:s,type:c,name:a(t.slice(0,r+1).join("."))}},t.stringify=function(e){let t;return(0,n.default)(e.type,"type cannot be undefined"),(0,n.default)(e.type.length<=15,"type must not be longer than 15 characters"),t=function(e){return"subtype"in e}(e)?`_${e.subtype}._sub.`:e.name?`${e.name}.`:"",`${t}_${e.type}._${e.protocol||"tcp"}.${e.domain||"local"}.`},t.formatHostname=function(e,t="local"){(0,n.default)(!e.endsWith("."),"hostname must not end with the root label!");const r="."+t;return(e.endsWith(r)?e:e+r)+"."},t.removeTLD=function(e){e.endsWith(".")&&(e=e.substring(0,e.length-1));const t=e.lastIndexOf(".");return e.slice(0,t)},t.enlargeIPv6=s,t.shortenIPv6=c,t.formatReverseAddressPTRName=function(e){if(o.default.isIPv4(e)){return e.split(".").reverse().join(".")+".in-addr.arpa"}if(o.default.isIPv6(e)){const t=(e=s(e).toUpperCase()).replace(/:/g,"").split("").reverse();return(0,n.default)(32===t.length,"Encountered invalid ipv6 address length! "+t.length),t.join(".")+".ip6.arpa"}throw new Error("Supplied illegal ip address format: "+e)},t.ipAddressFromReversAddressName=function(e){if((e=e.toLowerCase()).endsWith(".in-addr.arpa")){return e.replace(".in-addr.arpa","").split(".").reverse().join(".")}if(e.endsWith(".ip6.arpa")){const t=e.replace(".ip6.arpa","").split(".").reverse();(0,n.default)(32===t.length,"Encountered illegal length for .ip6.arpa split!");const r=[];for(let e=0;e<t.length;e+=4)r.push(t.slice(e,e+4).join(""));return c(r.join(":"))}throw new Error("Supplied unknown reverse address name format: "+e)},t.getNetAddress=function(e,t){if((0,n.default)(o.default.isIP(e)===o.default.isIP(t),"IP address version must match. Netmask cannot have a version different from the address!"),o.default.isIPv4(e)){const r=e.split("."),i=t.split("."),n=new Array(4);for(let e=0;e<r.length;e++){const t=parseInt(r[e]),o=parseInt(i[e]);n[e]=(t&o).toString()}return n.join(".")}if(o.default.isIPv6(e)){const r=s(e).split(":"),i=s(t).split(":"),n=new Array(8);for(let e=0;e<r.length;e++){const t=parseInt(r[e],16),o=parseInt(i[e],16);n[e]=(t&o).toString(16)}return c(s(n.join(":")))}throw new Error("Illegal argument. Address is not an ip address!")}},16:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServerClosedError=t.InterfaceNotFoundError=t.ERR_SERVER_CLOSED=t.ERR_INTERFACE_NOT_FOUND=void 0,t.ERR_INTERFACE_NOT_FOUND="ERR_INTERFACE_NOT_FOUND",t.ERR_SERVER_CLOSED="ERR_SERVER_CLOSED";class r extends Error{constructor(e){super(e),this.name="ERR_INTERFACE_NOT_FOUND"}}t.InterfaceNotFoundError=r;class i extends Error{constructor(e){super(e),this.name=t.ERR_SERVER_CLOSED}}t.ServerClosedError=i},8390:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseTimeout=void 0,t.PromiseTimeout=function(e){return new Promise((t=>{setTimeout((()=>t()),e)}))}},5762:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sortedInsert=void 0,t.sortedInsert=function(e,t,r){let i=0,n=e.length-1,o=-1;for(;i<n;){const a=Math.floor((i+n)/2),s=r(t,e[a]);if(0===s){o=a+1;break}s<0?n=a-1:i=a+1}0===e.length?o=0:o<0&&(o=r(t,e[i])>0?i+1:i),e.splice(o,0,t)}},6948:(e,t)=>{"use strict";function r(e,t){if(e.class!==t.class)return e.class-t.class;if(e.type!==t.type)return e.type-t.type;const r=e.getRawData(),i=t.getRawData(),n=Math.max(r.length,i.length);for(let e=0;e<n;e++){if(e>=r.length&&e<i.length)return-1;if(e>=i.length&&e<r.length)return 1;const t=r.readUInt8(e),n=i.readUInt8(e);if(t!==n)return t<n?-1:1}return 0}var i;Object.defineProperty(t,"__esModule",{value:!0}),t.runTiebreaking=t.TiebreakingResult=t.rrComparator=void 0,t.rrComparator=r,function(e){e[e.OPPONENT=-1]="OPPONENT",e[e.TIE=0]="TIE",e[e.HOST=1]="HOST"}(i||(t.TiebreakingResult=i={})),t.runTiebreaking=function(e,t){const i=Math.max(e.length,t.length);for(let n=0;n<i;n++){if(n>=e.length&&n<t.length)return-1;if(n>=t.length&&n<e.length)return 1;const i=r(e[n],t[n]);if(0!==i)return i}return 0}},9640:(e,t,r)=>{const i=r(4434).EventEmitter,n=r(9278),o=r(1145),a=r(9343),s=r(2293),c=r(9453),u=r(454),l=r(5657);function h(e){var t=new i;e||(e={});var o=t.stream=function(e){if(e.stream)return e.stream;var t=e.host,i=e.port,o=e.socket;if(o)return n.createConnection(o);if(i)return n.createConnection(i,t);var a=e.busAddress||process.env.DBUS_SESSION_BUS_ADDRESS;if(!a)throw new Error("unknown bus address");for(var s=a.split(";"),c=0;c<s.length;++c){var u=s[c].split(":"),l=u[0],h={};u[1].split(",").map((function(e){var t=e.split("=");h[t[0]]=t[1]}));try{switch(l.toLowerCase()){case"tcp":return t=h.host||"localhost",i=h.port,n.createConnection(i,t);case"unix":if(h.socket)return n.createConnection(h.socket);if(h.abstract)return r(Object(function(){var e=new Error("Cannot find module 'abstract-socket'");throw e.code="MODULE_NOT_FOUND",e}())).connect("\0"+h.abstract);if(h.path)return n.createConnection(h.path);throw new Error("not enough parameters for 'unix' connection - you need to specify 'socket' or 'abstract' or 'path' parameter");case"unixexec":for(var d=r(8954),p=r(5317).spawn,f=[],g=1;h["arg"+g];g++)f.push(h["arg"+g]);var m=p(h.path,f);return d.duplex(m.stdin,m.stdout);default:throw new Error("unknown address type:"+l)}}catch(e){if(c<s.length-1){console.warn(e.message);continue}throw e}}}(e);return o.setNoDelay(),o.on("error",(function(e){t.emit("error",e)})),o.on("end",(function(){t.emit("end"),t.message=function(){console.warn("Didn't write bytes to closed stream")}})),t.end=function(){return o.end(),t},(e.server?c:s)(o,e,(function(r,i){if(r)return t.emit("error",r);t.guid=i,t.emit("connect"),a.unmarshalMessages(o,(function(e){t.emit("message",e)}),e)})),t._messages=[],t.message=function(e){t._messages.push(e)},t.once("connect",(function(){t.state="connected";for(var e=0;e<t._messages.length;++e)o.write(a.marshall(t._messages[e]));t._messages.length=0,t.message=function(e){o.write(a.marshall(e))}})),t}e.exports.createClient=function(e){var t=h(e||{});return new u(t,e||{})},e.exports.systemBus=function(){return e.exports.createClient({busAddress:process.env.DBUS_SYSTEM_BUS_ADDRESS||"unix:path=/var/run/dbus/system_bus_socket"})},e.exports.sessionBus=function(t){return e.exports.createClient(t)},e.exports.messageType=o.messageType,e.exports.createConnection=h,e.exports.createServer=l.createServer},3597:(e,t,r)=>{const i=r(2861).Buffer;t.M=function(e,t){var r=t-e._offset%t;if(0!==r&&r!==t){var n=i.alloc(r);e.put(i.from(n)),e._offset+=r}}},454:(e,t,r)=>{const i=r(4434).EventEmitter,n=r(1145),o=r(8894),a=r(5769).introspectBus;e.exports=function e(t,r){if(!(this instanceof e))return new e(t);r||(r={});var s=this;function c(e,t){this.name=e,this.service=t,this.as=function(e){return this.proxy[e]}}function u(e,t){this.name=e,this.bus=t,this.getObject=function(e,t){if(void 0===e)return t(new Error("Object name is null or undefined"));var r=new c(e,this);a(r,(function(e,i,n){if(e)return t(e);r.proxy=i,r.nodes=n,t(null,r)}))},this.getInterface=function(e,t,r){this.getObject(e,(function(e,i){if(e)return r(e);r(null,i.as(t))}))}}this.connection=t,this.serial=1,this.cookies={},this.methodCallHandlers={},this.signals=new i,this.exportedObjects={},this.invoke=function(e,t){e.type||(e.type=n.messageType.methodCall),e.serial=s.serial++,this.cookies[e.serial]=t,s.connection.message(e)},this.invokeDbus=function(e,t){e.path||(e.path="/org/freedesktop/DBus"),e.destination||(e.destination="org.freedesktop.DBus"),e.interface||(e.interface="org.freedesktop.DBus"),s.invoke(e,t)},this.mangle=function(e,t,r){var i={};return"object"==typeof e?(i.path=e.path,i.interface=e.interface,i.member=e.member):(i.path=e,i.interface=t,i.member=r),JSON.stringify(i)},this.sendSignal=function(e,t,r,i,o){var a={type:n.messageType.signal,serial:s.serial++,interface:t,path:e,member:r};i&&(a.signature=i,a.body=o),s.connection.message(a)},this.sendError=function(e,t,r){var i={type:n.messageType.error,serial:s.serial++,replySerial:e.serial,destination:e.sender,errorName:t,signature:"s",body:[r]};this.connection.message(i)},this.sendReply=function(e,t,r){var i={type:n.messageType.methodReturn,serial:s.serial++,replySerial:e.serial,destination:e.sender,signature:t,body:r};this.connection.message(i)},this.connection.on("message",(function(e){function t(t,r,i){Promise.resolve().then((function(){return r.apply(t,(e.body||[]).concat(e))})).then((function(t){var r={type:n.messageType.methodReturn,serial:s.serial++,destination:e.sender,replySerial:e.serial};null!==t&&(r.signature=i,r.body=[t]),s.connection.message(r)}),(function(t){s.sendError(e,t.dbusName||"org.freedesktop.DBus.Error.Failed",t.message||"")}))}var r;if(e.type===n.messageType.methodReturn||e.type===n.messageType.error){if(r=s.cookies[e.replySerial]){delete s.cookies[e.replySerial];var i={connection:s.connection,bus:s,message:e,signature:e.signature},a=e.body||[];e.type===n.messageType.methodReturn?(a=[null].concat(a),r.apply(i,a)):r.call(i,{name:e.errorName,message:a})}}else if(e.type===n.messageType.signal)s.signals.emit(s.mangle(e),e.body,e.signature);else{if(o(e,s))return;var c,u,l;if(c=s.exportedObjects[e.path]){if(u=c[e.interface]){var h=(l=u[1])[e.member];return h?void t(l,h,u[0].methods[e.member][1]):void s.sendError(e,"org.freedesktop.DBus.Error.UnknownMethod",`Method "${e.member}" on interface "${e.interface}" doesn't exist`)}console.error(`Interface ${e.interface} is not supported`)}(r=s.methodCallHandlers[s.mangle(e)])?t(null,r[0],r[1]):s.sendError(e,"org.freedesktop.DBus.Error.UnknownService","Uh oh oh")}})),this.setMethodCallHandler=function(e,t,r,i){var n=s.mangle(e,t,r);s.methodCallHandlers[n]=i},this.exportInterface=function(e,t,r){if((s.exportedObjects[t]?s.exportedObjects[t]:s.exportedObjects[t]={})[r.name]=[r,e],"function"==typeof e.emit){var i=e.emit;e.emit=function(){var o,a=Array.prototype.slice.apply(arguments),c=a[0];if(!c)throw new Error("Trying to emit undefined signa");if(r.signals&&r.signals[c]){o=r.signals[c];var u={type:n.messageType.signal,serial:s.serial++,interface:r.name,path:t,member:c};o[0]&&(u.signature=o[0],u.body=a.slice(1)),s.connection.message(u),s.serial++}i.apply(e,a)}}},!0!==r.direct?this.invokeDbus({member:"Hello"},(function(e,t){if(e)throw new Error(e);s.name=t})):s.name=null,this.getService=function(e){return new u(e,this)},this.getObject=function(e,t,r){return this.getService(e).getObject(t,r)},this.getInterface=function(e,t,r,i){return this.getObject(e,t,(function(e,t){if(e)return i(e);i(null,t.as(r))}))},this.addMatch=function(e,t){this.invokeDbus({member:"AddMatch",signature:"s",body:[e]},t)},this.removeMatch=function(e,t){this.invokeDbus({member:"RemoveMatch",signature:"s",body:[e]},t)},this.getId=function(e){this.invokeDbus({member:"GetId"},e)},this.requestName=function(e,t,r){this.invokeDbus({member:"RequestName",signature:"su",body:[e,t]},(function(e,t){r&&r(e,t)}))},this.releaseName=function(e,t){this.invokeDbus({member:"ReleaseName",signature:"s",body:[e]},t)},this.listNames=function(e){this.invokeDbus({member:"ListNames"},e)},this.listActivatableNames=function(e){this.invokeDbus({member:"ListActivatableNames"},e)},this.updateActivationEnvironment=function(e,t){this.invokeDbus({member:"UpdateActivationEnvironment",signature:"a{ss}",body:[e]},t)},this.startServiceByName=function(e,t,r){this.invokeDbus({member:"StartServiceByName",signature:"su",body:[e,t]},r)},this.getConnectionUnixUser=function(e,t){this.invokeDbus({member:"GetConnectionUnixUser",signature:"s",body:[e]},t)},this.getConnectionUnixProcessId=function(e,t){this.invokeDbus({member:"GetConnectionUnixProcessID",signature:"s",body:[e]},t)},this.getNameOwner=function(e,t){this.invokeDbus({member:"GetNameOwner",signature:"s",body:[e]},t)},this.nameHasOwner=function(e,t){this.invokeDbus({member:"NameHasOwner",signature:"s",body:[e]},t)}}},1145:e=>{e.exports={messageType:{invalid:0,methodCall:1,methodReturn:2,error:3,signal:4},headerTypeName:[null,"path","interface","member","errorName","replySerial","destination","sender","signature"],fieldSignature:{path:"o",interface:"s",member:"s",errorName:"s",replySerial:"u",destination:"s",sender:"s",signature:"g"},headerTypeId:{path:1,interface:2,member:3,errorName:4,replySerial:5,destination:6,sender:7,signature:8},protocolVersion:1,flags:{noReplyExpected:1,noAutoStart:2},endianness:{le:108,be:66},messageSignature:"yyyyuua(yv)",defaultAuthMethods:["EXTERNAL","DBUS_COOKIE_SHA1","ANONYMOUS"]}},191:(e,t,r)=>{const i=r(6094),n=r(5970);function o(e,t,r){"object"!=typeof r?r={ayBuffer:!0,ReturnLongjs:!1}:void 0===r.ayBuffer&&(r.ayBuffer=!0),this.options=r,this.buffer=e,this.startPos=t||0,this.pos=0}o.prototype.align=function(e){var t=(1<<e)-1,r=this.pos+this.startPos+t>>e<<e;this.pos=r-this.startPos},o.prototype.readInt8=function(){return this.pos++,this.buffer[this.pos-1]},o.prototype.readSInt16=function(){this.align(1);var e=this.buffer.readInt16LE(this.pos);return this.pos+=2,e},o.prototype.readInt16=function(){this.align(1);var e=this.buffer.readUInt16LE(this.pos);return this.pos+=2,e},o.prototype.readSInt32=function(){this.align(2);var e=this.buffer.readInt32LE(this.pos);return this.pos+=4,e},o.prototype.readInt32=function(){this.align(2);var e=this.buffer.readUInt32LE(this.pos);return this.pos+=4,e},o.prototype.readDouble=function(){this.align(3);var e=this.buffer.readDoubleLE(this.pos);return this.pos+=8,e},o.prototype.readString=function(e){if(0===e)return this.pos++,"";var t=this.buffer.toString("utf8",this.pos,this.pos+e);return this.pos+=e+1,t},o.prototype.readTree=function(e){switch(e.type){case"(":case"{":case"r":return this.align(3),this.readStruct(e.child);case"a":if(!e.child||1!==e.child.length)throw new Error("Incorrect array element signature");var t=this.readInt32();return this.readArray(e.child[0],t);case"v":return this.readVariant();default:return this.readSimpleType(e.type)}},o.prototype.read=function(e){var t=n(e);return this.readStruct(t)},o.prototype.readVariant=function(){var e=this.readSimpleType("g"),t=n(e);return[t,this.readStruct(t)]},o.prototype.readStruct=function(e){for(var t=[],r=0;r<e.length;++r)t.push(this.readTree(e[r]));return t},o.prototype.readArray=function(e,t){var r,i=this.pos;if("y"===e.type&&this.options.ayBuffer)return this.pos+=t,this.buffer.slice(i,this.pos);-1!==["x","t","d","{","(","r"].indexOf(e.type)&&this.align(3);var n=this.pos+t;for(r=[];this.pos<n;)r.push(this.readTree(e));return r},o.prototype.readSimpleType=function(e){var t,r,n,o;switch(e){case"y":return this.readInt8();case"b":return!!this.readInt32();case"n":return this.readSInt16();case"q":return this.readInt16();case"u":return this.readInt32();case"i":return this.readSInt32();case"g":return r=this.readInt8(),this.readString(r);case"s":case"o":return r=this.readInt32(),this.readString(r);case"x":return this.align(3),n=this.readInt32(),o=this.readInt32(),t=i.fromBits(n,o,!1),this.options.ReturnLongjs?t:t.toNumber();case"t":return this.align(3),n=this.readInt32(),o=this.readInt32(),t=i.fromBits(n,o,!0),this.options.ReturnLongjs?t:t.toNumber();case"d":return this.readDouble();default:throw new Error(`Unsupported type: ${e}`)}},e.exports=o},2293:(e,t,r)=>{const i=r(2861).Buffer,n=r(6982),o=r(9896),a=r(6928),s=r(1145),c=r(4888);function u(e,t,r){var i=a.join(process.env[process.platform.match(/$win/)?"USERPROFILE":"HOME"],".dbus-keyrings");0===e.length&&(e="org_freedesktop_general");var n=a.join(i,e);o.stat(i,(function(e,i){return e?r(e):18&i.mode?r(new Error("User keyrings directory is writeable by other users. Aborting authentication")):process.hasOwnProperty("getuid")&&i.uid!==process.getuid()?r(new Error("Keyrings directory is not owned by the current user. Aborting authentication!")):void o.readFile(n,"ascii",(function(e,i){if(e)return r(e);for(var n=i.split("\n"),o=0;o<n.length;++o){var a=n[o].split(" ");if(t===a[0])return r(null,a[2])}return r(new Error("cookie not found"))}))}))}function l(e){return i.from(e.toString(),"ascii").toString("hex")}function h(e,t,r){if(0===t.length)return r(new Error("No authentication methods left to try"));var o=t.shift(),a=l(process.hasOwnProperty("getuid")?process.getuid():0);function s(){c(e,(function(i){var n=i.toString("ascii").match(/^([A-Za-z]+) (.*)/);return n&&"OK"===n[1]?(e.write("BEGIN\r\n"),r(null,n[2])):t.empty?r(i):void h(e,t,r)}))}switch(o){case"EXTERNAL":e.write(`AUTH ${o} ${a}\r\n`),s();break;case"DBUS_COOKIE_SHA1":e.write(`AUTH ${o} ${a}\r\n`),c(e,(function(t){var o=i.from(t.toString().split(" ")[1].trim(),"hex").toString().split(" "),a=o[0],c=o[1],h=o[2],d=n.randomBytes(16).toString("hex");u(a,c,(function(t,i){if(t)return r(t);var o,a,c=(o=[h,d,i].join(":"),(a=n.createHash("sha1")).update(o),a.digest("hex")),u=l(d+c);e.write(`DATA ${u}\r\n`),s()}))}));break;case"ANONYMOUS":e.write("AUTH ANONYMOUS \r\n"),s();break;default:console.error(`Unsupported auth method: ${o}`),s()}}e.exports=function(e,t,r){var i;i=t.authMethods?t.authMethods:s.defaultAuthMethods,e.write("\0"),h(e,i.slice(),r)}},5769:(e,t,r)=>{const i=r(8805);function n(e,t){this.$parent=e,this.$name=t,this.$methods={},this.$properties={},this.$callbacks=[],this.$sigHandlers=[]}function o(e,t,r){return`type='signal',path='${e}',interface='${t}',member='${r}'`}e.exports.introspectBus=function(t,r){t.service.bus.invoke({destination:t.service.name,path:t.name,interface:"org.freedesktop.DBus.Introspectable",member:"Introspect"},(function(i,n){e.exports.processXML(i,n,t,r)}))},e.exports.processXML=function(t,r,o,a){if(t)return a(t);(new i.Parser).parseString(r,(function(t,r){if(t)return a(t);if(!r.node)throw new Error("No root XML node");if(!(r=r.node).interface){if(r.node&&r.node.length>0&&r.node[0].$){var i=Object.assign(o,{});return"/"!==i.name.slice(-1)&&(i.name+="/"),i.name+=r.node[0].$.name,e.exports.introspectBus(i,a)}return a(new Error("No such interface found"))}for(var s,c,u,l,h,d,p,f={},g=[],m=r.interface,v=r.node||[],y=1;y<v.length;++y)g.push(v[y].$.name);for(var C=0;C<m.length;++C){p=f[s=(l=m[C]).$.name]=new n(o,s);for(var S=0;l.method&&S<l.method.length;++S){d="";for(var E=(c=l.method[S]).$.name,_=0;c.arg&&_<c.arg.length;++_)"in"===(h=c.arg[_].$).direction&&(d+=h.type);p.$createMethod(E,d)}for(var T=0;l.property&&T<l.property.length;++T)u=l.property[T],p.$createProp(u.$.name,u.$.type,u.$.access)}a(null,f,g)}))},n.prototype.$getSigHandler=function(e){var t;return-1===(t=this.$callbacks.indexOf(e))&&(t=this.$callbacks.push(e)-1,this.$sigHandlers[t]=function(t){e.apply(null,t)}),this.$sigHandlers[t]},n.prototype.addListener=n.prototype.on=function(e,t){var r=this.$parent.service.bus,i=r.mangle(this.$parent.name,this.$name,e);if(r.signals.listeners(i).length)r.signals.on(i,this.$getSigHandler(t));else{var n=o(this.$parent.name,this.$name,e);r.addMatch(n,function(e){if(e)throw new Error(e);r.signals.on(i,this.$getSigHandler(t))}.bind(this))}},n.prototype.removeListener=n.prototype.off=function(e,t){var r=this.$parent.service.bus,i=r.mangle(this.$parent.name,this.$name,e);if(r.signals.removeListener(i,this.$getSigHandler(t)),!r.signals.listeners(i).length){var n=o(this.$parent.name,this.$name,e);r.removeMatch(n,function(e){if(e)throw new Error(e);this.$callbacks.length=0,this.$sigHandlers.length=0}.bind(this))}},n.prototype.$createMethod=function(e,t){this.$methods[e]=t,this[e]=function(){this.$callMethod(e,arguments)}},n.prototype.$callMethod=function(e,t){var r=this.$parent.service.bus;Array.isArray(t)||(t=Array.from(t));var i="function"==typeof t[t.length-1]?t.pop():function(){},n={destination:this.$parent.service.name,path:this.$parent.name,interface:this.$name,member:e};""!==this.$methods[e]&&(n.signature=this.$methods[e],n.body=t),r.invoke(n,i)},n.prototype.$createProp=function(e,t,r){this.$properties[e]={type:t,access:r},Object.defineProperty(this,e,{enumerable:!0,get:()=>t=>this.$readProp(e,t),set:function(t){this.$writeProp(e,t)}})},n.prototype.$readProp=function(e,t){this.$parent.service.bus.invoke({destination:this.$parent.service.name,path:this.$parent.name,interface:"org.freedesktop.DBus.Properties",member:"Get",signature:"ss",body:[this.$name,e]},(function(e,r){e?t(e):1===r[0].length?t(e,r[1][0]):t(e,r[1])}))},n.prototype.$writeProp=function(e,t){this.$parent.service.bus.invoke({destination:this.$parent.service.name,path:this.$parent.name,interface:"org.freedesktop.DBus.Properties",member:"Set",signature:"ssv",body:[this.$name,e,[this.$properties[e].type,t]]})}},5068:(e,t,r)=>{const i=r(2613),n=r(5970),o=r(7019),a=r(7030),s=r(3597).M;function c(e,t,r){if(t.length!==r.length)throw new Error("Invalid struct data");for(var i=0;i<t.length;++i)u(e,t[i],r[i]);return e}function u(e,t,r){switch(t.type){case"(":case"{":s(e,8),c(e,t.child,r);break;case"a":var a=o();a._offset=e._offset;var l=a._offset;h(a,"u",0);var d=a._offset-4-l;-1!==["x","t","d","{","("].indexOf(t.child[0].type)&&s(a,8);for(var p=a._offset,f=0;f<r.length;++f)u(a,t.child[0],r[f]);var g=a.buffer(),m=a._offset-p;g.writeUInt32LE(m,d),e.put(g),e._offset+=g.length;break;case"v":i.equal(r.length,2,"variant data should be [signature, data]");u(e,{type:"g",child:[]},r[0]);var v=n(r[0]);i(1===v.length),u(e,v[0],r[1]);break;default:return h(e,t.type,r)}}e.exports=function(e,t,r){void 0===r&&(r=0);var i=n(e);if(!Array.isArray(t)||t.length!==i.length)throw new Error(`message body does not match message signature. Body:${JSON.stringify(t)}, signature:${e}`);var a=o();return a._offset=r,c(a,i,t).buffer()};var l=["g","o","s"];function h(e,t,r){if(void 0===r)throw new Error("Serialisation of JS 'undefined' type is not supported by d-bus");if(null===r)throw new Error("Serialisation of null value is not supported by d-bus");if(Buffer.isBuffer(r)&&(r=r.toString()),-1!==l.indexOf(t)&&"string"!=typeof r)throw new Error(`Expected string or buffer argument, got ${JSON.stringify(r)} of type '${t}'`);return a.MakeSimpleMarshaller(t).marshall(e,r),e}},7030:(e,t,r)=>{const i=r(2861).Buffer,n=r(3597).M,o=r(5970),a=r(6094);t.MakeSimpleMarshaller=function(e){var t={};function r(e){if("string"!=typeof e)throw new Error(`Data: ${e} was not of type string`);if(-1!==e.indexOf("\0"))throw new Error("String contains null byte")}switch(e){case"o":case"s":t.check=function(e){r(e)},t.marshall=function(e,t){this.check(t),n(e,4);const r=i.from(t,"utf8");e.word32le(r.length).put(r).word8(0),e._offset+=5+r.length};break;case"g":t.check=function(e){r(e),function(e){if(e.length>255)throw new Error(`Data: ${e} is too long for signature type (${e.length} > 255)`);for(var t=0,r=0;r<e.length;++r){if(t>32)throw new Error(`Maximum container type nesting exceeded in signature type:${e}`);switch(e[r]){case"(":++t;break;case")":--t}}o(e)}(e)},t.marshall=function(e,t){this.check(t);const r=i.from(t,"ascii");e.word8(t.length).put(r).word8(0),e._offset+=2+r.length};break;case"y":t.check=function(e){c(e),s(0,255,e)},t.marshall=function(e,t){this.check(t),e.word8(t),e._offset++};break;case"b":t.check=function(e){u(e)},t.marshall=function(e,t){this.check(t),t=t?1:0,n(e,4),e.word32le(t),e._offset+=4};break;case"n":t.check=function(e){c(e),s(-32768,32767,e)},t.marshall=function(e,t){this.check(t),n(e,2);const r=i.alloc(2);r.writeInt16LE(parseInt(t),0),e.put(r),e._offset+=2};break;case"q":t.check=function(e){c(e),s(0,65535,e)},t.marshall=function(e,t){this.check(t),n(e,2),e.word16le(t),e._offset+=2};break;case"i":t.check=function(e){c(e),s(-2147483648,2147483647,e)},t.marshall=function(e,t){this.check(t),n(e,4);const r=i.alloc(4);r.writeInt32LE(parseInt(t),0),e.put(r),e._offset+=4};break;case"u":t.check=function(e){c(e),s(0,4294967295,e)},t.marshall=function(e,t){this.check(t),n(e,4),e.word32le(t),e._offset+=4};break;case"t":t.check=function(e){return l(e,!1)},t.marshall=function(e,t){t=this.check(t),n(e,8),e.word32le(t.low),e.word32le(t.high),e._offset+=8};break;case"x":t.check=function(e){return l(e,!0)},t.marshall=function(e,t){t=this.check(t),n(e,8),e.word32le(t.low),e.word32le(t.high),e._offset+=8};break;case"d":t.check=function(e){if("number"!=typeof e)throw new Error(`Data: ${e} was not of type number`);if(Number.isNaN(e))throw new Error(`Data: ${e} was not a number`);if(!Number.isFinite(e))throw new Error("Number outside range")},t.marshall=function(e,t){this.check(t),n(e,8);const r=i.alloc(8);r.writeDoubleLE(parseFloat(t),0),e.put(r),e._offset+=8};break;default:throw new Error(`Unknown data type format: ${e}`)}return t};var s=function(e,t,r){if(r>t||r<e)throw new Error("Number outside range")},c=function(e){if("number"!=typeof e)throw new Error(`Data: ${e} was not of type number`);if(Math.floor(e)!==e)throw new Error(`Data: ${e} was not an integer`)},u=function(e){if("boolean"!=typeof e&&0!==e&&1!==e)throw new Error(`Data: ${e} was not of type boolean`)},l=function(e,t){if(a.isLong(e)||(e=function(e,t){if(e instanceof a)return e;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e){try{c(e),s(t?-9007199254740991:0,9007199254740991,e)}catch(e){throw e.message+=" (Number type can only carry 53 bit integer)",e}try{return a.fromNumber(e,!t)}catch(e){throw e.message=`Error converting number to 64bit integer "${e.message}"`,e}}if("string"==typeof e||e instanceof String){var r,i=10;"0X"===(e=e.trim().toUpperCase()).substring(0,2)?(i=16,e=e.substring(2)):"-0X"===e.substring(0,3)&&(i=16,e=`-${e.substring(3)}`),e=e.replace(/^0+(?=\d)/,"");try{r=a.fromString(e,!t,i)}catch(e){throw e.message=`Error converting string to 64bit integer '${e.message}'`,e}if(r.toString(i).toUpperCase()!==e)throw new Error(`Data: '${e}' did not convert correctly to ${t?"signed":"unsigned"} 64 bit`);return r}try{return a.fromBits(e.low,e.high,e.unsigned)}catch(e){throw e.message=`Error converting object to 64bit integer '${e.message}'`,e}}(e,t)),t){if(e.unsigned)throw new Error("Longjs object is unsigned, but marshalling into signed 64 bit field");if(e.gt(a.MAX_VALUE)||e.lt(a.MIN_VALUE))throw new Error(`Data: ${e} was out of range (64-bit signed)`)}else{if(!e.unsigned)throw new Error("Longjs object is signed, but marshalling into unsigned 64 bit field");if(e.gt(a.MAX_UNSIGNED_VALUE)||e.lt(0))throw new Error(`Data: ${e} was out of range (64-bit unsigned)`)}return e}},9343:(e,t,r)=>{const i=r(2861).Buffer,n=r(5068),o=r(1145),a=r(191),s=r(5783);e.exports.unmarshalMessages=function(e,t,r){var i,n,c,u,l=0,h=0,d=0;e.on("readable",(function(){for(;;)if(0===l){if(!(i=e.read(16)))break;l=1,c=i.readUInt32LE(12),u=c+7>>3<<3,d=i.readUInt32LE(4),h=u+d}else{if(!(n=e.read(h)))break;l=0;var p=new a(n,void 0,r),f=p.readArray(s[0].child[0],c);p.align(3);var g={};g.serial=i.readUInt32LE(8);for(var m=0;m<f.length;++m)g[o.headerTypeName[f[m][0]]]=f[m][1][1][0];g.type=i[1],g.flags=i[2],d>0&&g.signature&&(g.body=p.read(g.signature)),t(g)}}))},e.exports.unmarshall=function(e,t){for(var r=new a(e,void 0,t),i=r.read("yyyyuua(yv)"),n={},s=0;s<i[6].length;++s){n[o.headerTypeName[i[6][s][0]]]=i[6][s][1][1][0]}return n.type=i[1],n.flags=i[2],n.serial=i[5],r.align(3),n.body=r.read(n.signature),n},e.exports.marshall=function(e){if(!e.serial)throw new Error("Missing or invalid serial");var t,r=e.flags||0,a=e.type||o.messageType.methodCall,s=0;e.signature&&e.body&&(s=(t=n(e.signature,e.body)).length);var c=[o.endianness.le,a,r,o.protocolVersion,s,e.serial],u=n("yyyyuu",c),l=[];o.headerTypeName.forEach((function(t){var r=e[t];r&&l.push([o.headerTypeId[t],[o.fieldSignature[t],r]])}));var h=n("a(yv)",[l],12),d=u.length+h.length+7>>3<<3,p=d+s,f=i.alloc(p);return u.copy(f),h.copy(f,u.length),s>0&&t.copy(f,d),f}},4888:(e,t,r)=>{const i=r(2861).Buffer;e.exports=function(e,t){var r=[];e.on("readable",(function n(){for(;;){var o=e.read(1);if(!o)return;var a=o[0];if(10===a){try{t(i.from(r))}catch(t){e.emit("error",t)}return void e.removeListener("readable",n)}r.push(a)}}))}},9453:(e,t,r)=>{const i=r(2861).Buffer,n=r(4888);e.exports=function(e,t,r){e.name="SERVER SERVER",n(e,(function(t){console.log(["hello string: ",t.toString(),t]),e.write("REJECTED EXTERNAL DBUS_COOKIE_SHA1 ANONYMOUS\r\n"),n(e,(function(){e.write(`DATA ${i.from("org_freedesktop_general 642038150 b9ce247a275f427c8586e4c9de9bb951").toString("hex")}\r\n`),n(e,(function(){e.write("OK 6f72675f667265656465736b746f705f67656e6572616c20353631303331333937206239636532343761323735663432376338353836653463396465396262393531\r\n"),n(e,(function(e){console.log(["AFTER begin: ",e.toString()]),r(null)}))}))}))}))}},5657:(e,t,r)=>{const i=r(9640),n=r(9278);e.exports.createServer=function(e){return new function(){var t=123;this.server=n.createServer((function(r){r.idd=t,t++;var n=i.createConnection({stream:r,server:!0});e&&e(n)})),this.listen=this.server.listen.bind(this.server)}}},5970:e=>{var t={"{":"}","(":")"},r={};"(){}ybnqiuxtdsogarvehm*?@&^".split("").forEach((function(e){r[e]=!0})),e.exports=function(e){var i=0;function n(){if(i<e.length){var t=e[i];return++i,t}return null}function o(i){function a(e){if(!e)throw new Error("Bad signature: unexpected end");return e}if(!r[i])throw new Error(`Unknown type: "${i}" in signature "${e}"`);var s,c={type:i,child:[]};switch(i){case"a":return a(s=n()),c.child.push(o(s)),c;case"{":case"(":for(;null!==(s=n())&&s!==t[i];)c.child.push(o(s));return a(s),c}return c}for(var a,s=[];null!==(a=n());)s.push(o(a));return s}},8894:(e,t,r)=>{const i=r(1145),n=r(5970);var o;function a(e){var t=[],r=function(e,r,i){e&&n(e).forEach((function(e,n){var o=r?r[n]:i+n,a="signal"===i?"":`" direction="${i}`;t.push(`      <arg type="${s([e])}" name="${o}${a}" />`)}))};if(t.push(`  <interface name="${e.name}">`),e.methods)for(var i in e.methods){var o=e.methods[i];t.push(`    <method name="${i}">`),r(o[0],o[2],"in"),r(o[1],o[3],"out"),t.push("    </method>")}if(e.signals)for(var a in e.signals){var c=e.signals[a];t.push(`    <signal name="${a}">`),r(c[0],c.slice(1),"signal"),t.push("    </signal>")}if(e.properties)for(const r in e.properties)t.push(`    <property name="${r}" type="${e.properties[r]}" access="readwrite"/>`);return t.push("  </interface>"),t.join("\n")}function s(e){var t=[];return e.forEach((function(e){t.push(e.type+s(e.child)),"{"===e.type&&t.push("}"),"("===e.type&&t.push(")")})),t.join("")}e.exports=function(e,t){if("org.freedesktop.DBus.Introspectable"===e.interface&&"Introspect"===e.member){"/"===e.path&&(e.path="");var r=['<!DOCTYPE node PUBLIC "-//freedesktop//DTD D-BUS Object Introspection 1.0//EN"\n    "http://www.freedesktop.org/standards/dbus/1.0/introspect.dtd">'],n={};for(var s in t.exportedObjects)if(0===s.indexOf(e.path)){var c=t.exportedObjects[e.path];if(c)n[e.path]=c;else{if("/"!==s[e.path.length])continue;n[s.substr(e.path.length).split("/")[1]]=null}}var u=Object.keys(n).length;if(0===u)r.push("<node/>");else if(1===u){var l=n[Object.keys(n)[0]];if(l){for(var h in r.push("<node>"),l)r.push(a(l[h][0]));r.push(o),r.push("</node>")}else r.push(`<node>\n  <node name="${Object.keys(n)[0]}"/>\n  </node>`)}else{for(var d in r.push("<node>"),n)if(null===n[d])r.push(`  <node name="${d}" />`);else{for(var p in l=n[d],r.push(`  <node name="${d}" >`),l)r.push(a(l[p][0]));r.push(o),r.push("  </node>")}r.push("</node>")}const f={type:i.messageType.methodReturn,serial:t.serial++,replySerial:e.serial,destination:e.sender,signature:"s",body:[r.join("\n")]};return t.connection.message(f),1}if("org.freedesktop.DBus.Properties"===e.interface){var f=e.body[0],g=t.exportedObjects[e.path];if(!g||!g[f])return t.sendError(e,"org.freedesktop.DBus.Error.UnknownMethod","Uh oh oh"),1;var m=g[f][1];const r={type:i.messageType.methodReturn,serial:t.serial++,replySerial:e.serial,destination:e.sender};if("Get"===e.member||"Set"===e.member){var v=e.body[1],y=g[f][0].properties[v];if("Get"===e.member){var C=m[v];r.signature="v",r.body=[[y,C]]}else m[v]=1234}else if("GetAll"===e.member){r.signature="a{sv}";var S=[];for(var E in g[f][0].properties){var _=g[f][0].properties[E];S.push([E,[_,m[E]]])}r.body=[S]}return t.connection.message(r),1}if("org.freedesktop.DBus.Peer"===e.interface){const r={type:i.messageType.methodReturn,serial:t.serial++,replySerial:e.serial,destination:e.sender};return"Ping"===e.member||"GetMachineId"===e.member&&(r.signature="s",r.body=["This is a machine id. TODO: implement"]),t.connection.message(r),1}return 0},o='  <interface name="org.freedesktop.DBus.Properties">\n    <method name="Get">\n      <arg type="s" name="interface_name" direction="in"/>\n      <arg type="s" name="property_name" direction="in"/>\n      <arg type="v" name="value" direction="out"/>\n    </method>\n    <method name="GetAll">\n      <arg type="s" name="interface_name" direction="in"/>\n      <arg type="a{sv}" name="properties" direction="out"/>\n    </method>\n    <method name="Set">\n      <arg type="s" name="interface_name" direction="in"/>\n      <arg type="s" name="property_name" direction="in"/>\n      <arg type="v" name="value" direction="in"/>\n    </method>\n    <signal name="PropertiesChanged">\n      <arg type="s" name="interface_name"/>\n      <arg type="a{sv}" name="changed_properties"/>\n      <arg type="as" name="invalidated_properties"/>\n    </signal>\n  </interface>\n  <interface name="org.freedesktop.DBus.Introspectable">\n    <method name="Introspect">\n      <arg type="s" name="xml_data" direction="out"/>\n    </method>\n  </interface>\n  <interface name="org.freedesktop.DBus.Peer">\n    <method name="Ping"/>\n    <method name="GetMachineId">\n      <arg type="s" name="machine_uuid" direction="out"/>\n    </method>\n  </interface>'},7019:(e,t,r)=>{const i=r(2613);e.exports=function e(){if(!(this instanceof e))return new e;var t=[],r=0;this.put=function(e){return t.push({buffer:e}),r+=e.length,this},this.word8=function(e){return t.push({bytes:1,value:e}),r+=1,this},this.floatle=function(e){return t.push({bytes:"float",endian:"little",value:e}),r+=4,this},[8,16,24,32,64].forEach(function(e){this["word"+e+"be"]=function(i){return t.push({endian:"big",bytes:e/8,value:i}),r+=e/8,this},this["word"+e+"le"]=function(i){return t.push({endian:"little",bytes:e/8,value:i}),r+=e/8,this}}.bind(this)),this.pad=function(e){return i(Number.isInteger(e),"pad(bytes) must be supplied with an integer!"),t.push({endian:"big",bytes:e,value:0}),r+=e,this},this.length=function(){return r},this.buffer=function(){var e=Buffer.alloc(r),i=0;return t.forEach((function(t){if(t.buffer)t.buffer.copy(e,i,0),i+=t.buffer.length;else if("float"===t.bytes){var r=Math.abs(t.value),n=1*(t.value>=0),o=Math.ceil(Math.log(r)/Math.LN2),a=r/(1<<o);console.dir([n,o,a]),console.log(t.value),e[i++]=n<<7&o/2,e[i++]=(1&o)<<7&a/65536,e[i++]=0,e[i++]=0,i+=4}else for(var s="big"===t.endian,c=s?[8*(t.bytes-1),-8]:[0,8],u=c[0];s?u>=0:u<8*t.bytes;u+=c[1])e[i++]=u>=32?255&Math.floor(t.value/Math.pow(2,u)):t.value>>u&255})),e},this.write=function(e){e.write(this.buffer())}}},9511:(e,t,r)=>{"use strict";var i=r(8075)("ArrayBuffer.prototype.byteLength",!0),n=r(4670);e.exports=function(e){return n(e)?i?i(e):e.byteLength:NaN}},804:(e,t,r)=>{"use strict";function i(e){var t=[];return n(e,t),t}function n(e,t){for(var r=0;r<e.length;r++){var i=e[r];Array.isArray(i)?n(i,t):t.push(i)}}r.d(t,{B:()=>i})},8404:(e,t,r)=>{"use strict";const i=r(4033),n=r(8525),o=r(4060);function a(e){if(!(this instanceof a))return new a(e);this._server=new n(e),this._registry=new i(this._server)}a.prototype={publish:function(e){return this._registry.publish(e)},unpublishAll:function(e){this._registry.unpublishAll(e)},find:function(e,t){return new o(this._server.mdns,e,t)},findOne:function(e,t){const r=new o(this._server.mdns,e);return r.once("up",(function(e){r.stop(),t&&t(e)})),r},destroy:function(){this._registry.destroy(),this._server.mdns.destroy()}},e.exports=a},4060:(e,t,r)=>{"use strict";const i=r(9023),n=r(4434).EventEmitter,o=r(2781),a=r(6917),s=r(3272),c=".local",u="_services._dns-sd._udp"+c;function l(e,t,r){if("function"==typeof t)return new l(e,null,t);n.call(this),this._mdns=e,this._onresponse=null,this._serviceMap={},this._txt=s(t.txt),t&&t.type?(this._name=o.stringify(t.type,t.protocol||"tcp")+c,t.name&&(this._name=t.name+"."+this._name),this._wildcard=!1):(this._name=u,this._wildcard=!0),this.services=[],r&&this.on("up",r),this.start()}e.exports=l,i.inherits(l,n),l.prototype.start=function(){if(this._onresponse)return;const e=this,t={};this._wildcard||(t[this._name]=!0),this._onresponse=function(r,i){e._wildcard&&r.answers.forEach((function(r){"PTR"!==r.type||r.name!==e._name||r.name in t||(t[r.data]=!0,e._mdns.query(r.data,"PTR"))})),Object.keys(t).forEach((function(t){(function(e,t){return t.answers.concat(t.additionals).filter((function(t){return"PTR"===t.type&&0===t.ttl&&a(t.name,e)})).map((function(e){return e.data}))})(t,r).forEach(e._removeService.bind(e));const n=function(e,t,r,i){const n=t.answers.concat(t.additionals).filter((function(e){return e.ttl>0}));return n.filter((function(t){return"PTR"===t.type&&a(t.name,e)})).map((function(e){const t={addresses:[]};if(n.filter((function(t){return("SRV"===t.type||"TXT"===t.type)&&a(t.name,e.data)})).forEach((function(e){if("SRV"===e.type){const r=e.name.split("."),n=r[0],a=o.parse(r.slice(1,-1).join("."));t.name=n,t.fqdn=e.name,t.host=e.data.target,t.referer=i,t.port=e.data.port,t.type=a.name,t.protocol=a.protocol,t.subtypes=a.subtypes}else"TXT"===e.type&&(t.rawTxt=e.data,t.txt=r.decodeBlocks(t.rawTxt))})),t.name)return n.filter((function(e){return("A"===e.type||"AAAA"===e.type)&&a(e.name,t.host)})).forEach((function(e){t.addresses.push(e.data)})),t})).filter((function(e){return!!e}))}(t,r,e._txt,i);0!==n.length&&n.forEach((function(t){e._serviceMap[t.fqdn]?e._updateService(t):e._addService(t)}))}))},this._mdns.on("response",this._onresponse),this.update()},l.prototype.stop=function(){this._onresponse&&(this._mdns.removeListener("response",this._onresponse),this._onresponse=null)},l.prototype.update=function(){this._mdns.query(this._name,"PTR")},l.prototype._addService=function(e){this.services.push(e),this._serviceMap[e.fqdn]=!0,this.emit("up",e)},l.prototype._updateService=function(e){let t,r;this.services.some((function(i,n){return!!a(i.fqdn,e.fqdn)&&(t=i,r=n,!0)})),t&&(this.services[r]=e,this.emit("update",e))},l.prototype._removeService=function(e){let t,r;this.services.some((function(i,n){return!!a(i.fqdn,e)&&(t=i,r=n,!0)})),t&&(this.services.splice(r,1),delete this._serviceMap[e],this.emit("down",t))}},2754:(e,t,r)=>{"use strict";const i=r(6917),n=function(e,t,r){this.sent=!1,this.retries=0,this.timer=null,this.cb=r,this.mdns=e,this.service=t,this.bound=this.onMDNSresponse.bind(this),this.matchRRBound=this.matchRR.bind(this)};n.prototype={start:function(){this.mdns.on("response",this.bound),setTimeout(this.try.bind(this),250*Math.random())},try:function(){this.service._activated&&!this.service._destroyed&&this.mdns.query(this.service.fqdn,"ANY",function(){this.sent=!0,this.timer=setTimeout(++this.retries<3?this.try.bind(this):this.done.bind(this,!1),250),this.timer.unref()}.bind(this))},matchRR:function(e){return i(e.name,this.service.fqdn)},onMDNSresponse:function(e){this.sent&&(e.answers.some(this.matchRRBound)||e.additionals.some(this.matchRRBound))&&this.done(!0)},done:function(e){this.mdns.removeListener("response",this.bound),clearTimeout(this.timer),this.cb(e)}},e.exports=n},4033:(e,t,r)=>{"use strict";const i=r(804).B,n=r(5259),o=r(2754),a=function(e){this._server=e,this._services=[]};a.prototype={publish:function(e){const t=new n(e=e||{});return t.on("service-publish",this._onServicePublish.bind(this)),t.on("service-unpublish",this._onServiceUnpublish.bind(this)),t.on("service-announce-request",this._onAnnounceRequest.bind(this)),t.on("service-packet-change",this._onServiceChange.bind(this)),t.start(),t},unpublishAll:function(e){this._tearDown(this._services,e),this._services=[]},destroy:function(){for(let e=0;e<this._services.length;e++)this._services[e].destroy()},_tearDown:function(e,t){Array.isArray(e)||(e=[e]),e=e.filter((function(e){return e._activated}));const r=i(e.map((function(e){e.deactivate();const t=e._records(!0);return t.forEach((function(e){e.ttl=0})),t})),1);if(0===r.length)return t&&t();this._server.unregister(r),this._server.mdns.respond(r,this._onTearDownComplete.bind(this,e,t))},_onTearDownComplete:function(e,t){for(let t=0;t<e.length;t++)e[t].published=!1;t&&t.apply(null,Array.prototype.slice.call(arguments,2))},_onServiceChange:function(e){this._server.unregister(e)},_onAnnounceRequest:function(e,t,r){this._server.register(e),t||this._server.mdns.respond(e,r)},_onServiceUnpublish:function(e,t){const r=this._services.indexOf(e);this._tearDown(e,t),-1!==r&&this._services.splice(r,1)},_onServicePublish:function(e){this._services.push(e),e.probe?new o(this._server.mdns,e,this._onProbeComplete.bind(this,e)).start():e.announce()},_onProbeComplete:function(e,t){if(!t)return e.announce();e.stop(),e.emit("error",new Error('Service name "'+e.name+'" is already in use on the network'))}},e.exports=a},8525:(e,t,r)=>{"use strict";const i=r(2567),n=r(6917),o=r(804).B,a=r(3805),s=function(e){this.mdns=i(e),this.mdns.setMaxListeners(0),this.registry={},this.mdns.on("query",this._respondToQuery.bind(this))};s.prototype={_respondToQuery:function(e){for(let t=0;t<e.questions.length;t++){const r=e.questions[t],i=r.type,n=r.name,s="ANY"===i?o(Object.keys(this.registry).map(this._recordsFor.bind(this,n)),1):this._recordsFor(n,i);if(0===s.length)return;let c=[];"ANY"!==i&&(s.forEach((e=>{"PTR"===e.type&&(c=c.concat(this._recordsFor(e.data,"SRV")).concat(this._recordsFor(e.data,"TXT")))})),c.filter((e=>"SRV"===e.type)).map((e=>e.data.target)).filter(a.unique()).forEach((e=>{c=c.concat(this._recordsFor(e,"A")).concat(this._recordsFor(e,"AAAA"))}))),this.mdns.respond({answers:s,additionals:c},(e=>{if(e)throw e}))}},register:function(e){Array.isArray(e)||(e=[e]);for(let t=0;t<e.length;t++){const r=e[t];let i=this.registry[r.type];if(i){if(i.some(a.isDuplicateRecord(r)))continue}else i=this.registry[r.type]=[];i.push(r)}},unregister:function(e){Array.isArray(e)||(e=[e]);for(let t=0;t<e.length;t++){const r=e[t],i=r.type;i in this.registry&&(this.registry[i]=this.registry[i].filter((e=>e.name!==r.name)))}},_recordsFor:function(e,t){return t in this.registry?this.registry[t].filter((t=>{const r=~e.indexOf(".")?t.name:t.name.split(".")[0];return n(r,e)})):[]}},e.exports=s},5259:(e,t,r)=>{"use strict";const i=r(857),n=r(9023),o=r(9278),a=r(2613),s=r(4434).EventEmitter,c=r(2781),u=r(6480),l=".local",h=function(e){if(!e.name)throw new Error("Required name not given");if(!e.type)throw new Error("Required type not given");if(!e.port)throw new Error("Required port not given");if(this.name=e.name,this.protocol=e.protocol||"tcp",this.probe=!1!==e.probe,this.type=c.stringify(e.type,this.protocol),this.host=e.host||i.hostname(),this.port=e.port,this.fqdn=this.name+"."+this.type+l,this.subtypes=e.subtypes||null,this.txt=e.txt||null,this.published=!1,this.addUnsafeServiceEnumerationRecord=e.addUnsafeServiceEnumerationRecord||!1,this.restrictedAddresses=void 0,e.restrictedAddresses){a(e.restrictedAddresses.length,"The service property 'restrictedAddresses' cannot be an empty array!"),this.restrictedAddresses=new Map;for(const t of e.restrictedAddresses)if(o.isIP(t)){if("0.0.0.0"===t||"::"===t)throw new Error(`[${this.fqdn}] Unspecified ip address (${t}) cannot be used to restrict on to!`);const e=u.resolveInterface(t);if(!e)throw new Error(`[${this.fqdn}] Could not restrict service to address ${t} as we could not resolve it to an interface name!`);const r=this.restrictedAddresses.get(e);r?r.length&&!r.includes(t)&&r.push(t):this.restrictedAddresses.set(e,[t])}else this.restrictedAddresses.set(t,[])}this.disabledIpv6=e.disabledIpv6||!1,this._activated=!1};n.inherits(h,s);const d={start:function(){this._activated||(this._activated=!0,this.emit("service-publish",this))},stop:function(e){this._activated?this.emit("service-unpublish",this,e):e()},updateTxt:function(e,t){this.packet&&this.emit("service-packet-change",this.packet,this.onAnnounceComplete.bind(this)),this.packet=null,this.txt=e,this.published&&(this._unpublish(),this.announce(t))},announce:function(e){this._destroyed||(this.packet||(this.packet=this._records()),this.timer&&clearTimeout(this.timer),this.delay=1e3,this.emit("service-announce-request",this.packet,e||!1,this.onAnnounceComplete.bind(this)))},onAnnounceComplete:function(){this.published||(this._activated=!0,this.published=!0,this.emit("up")),this.delay=3*this.delay,this.delay<36e5&&!this._destroyed&&this._activated?this.timer=setTimeout(this.announce.bind(this),this.delay).unref():(this.timer=void 0,this.delay=void 0)},deactivate:function(){this._unpublish(),this._activated=!1},destroy:function(){this._unpublish(),this.removeAllListeners(),this._destroyed=!0},_unpublish:function(){this.timer&&clearTimeout(this.timer),this.published=!1},_records:function(e){const t=[this._rrPtr(),this._rrSrv(),this._rrTxt()];return t.push(...this._addressRecords()),!e&&this.addUnsafeServiceEnumerationRecord&&t.push(this._rrMetaPtr()),t},_addressRecords:function(){const e=[],t=[];return Object.entries(i.networkInterfaces()).forEach((([r,i])=>{let n=this.restrictedAddresses?this.restrictedAddresses.get(r):void 0;this.restrictedAddresses&&!n||(n&&0===n.length&&(n=void 0),i.forEach((r=>{r.internal||t.includes(r.address)||n&&n.includes(r.address)||("IPv4"===r.family?(e.push(this._rrA(r.address)),t.push(r.address)):this.disabledIpv6||(e.push(this._rrAaaa(r.address)),t.push(r.address)))})))})),e},_rrMetaPtr:function(){return{name:"_services._dns-sd._udp.local",type:"PTR",ttl:4500,data:this.type+l}},_rrPtr:function(){return{name:this.type+l,type:"PTR",ttl:4500,data:this.fqdn}},_rrSrv:function(){return{name:this.fqdn,type:"SRV",ttl:120,flush:!0,data:{port:this.port,target:this.host}}},_rrTxt:function(){const e=[];if(this.txt){const t=this.txt;Object.keys(t).forEach((r=>{const i=t[r];e.push(r+"="+i)}))}return{name:this.fqdn,type:"TXT",ttl:4500,flush:!0,data:e}},_rrA:function(e){return{name:this.host,type:"A",ttl:120,flush:!0,data:e}},_rrAaaa:function(e){return{name:this.host,type:"AAAA",ttl:120,flush:!0,data:e}}};for(const e in d)h.prototype[e]=d[e];e.exports=h},3805:(e,t,r)=>{const i=r(4982);e.exports={isDuplicateRecord:function(e){return function(t){return e.type===t.type&&e.name===t.name&&i(e.data,t.data)}},unique:function(){const e=[];return function(t){return!~e.indexOf(t)&&(e.push(t),!0)}}}},6917:e=>{"use strict";const t=/[A-Z]/g;function r(e){return e.toLowerCase()}e.exports=function(e,i){return(e=e.replace(t,r))===(i=i.replace(t,r))}},6480:(e,t,r)=>{const i=r(857);e.exports={resolveInterface:function(e){for(const[t,r]of Object.entries(i.networkInterfaces()))for(const i of r)if(i.address===e)return t}}},3272:e=>{"use strict";const t=Buffer.from("=");e.exports=function(e){const r=!!e&&e.binary,i={decodeBlocks:function(e){const i={};return e.forEach((e=>{if(0===e.length)return;const n=e.indexOf(t);if(-1===n)i[e.toString().toLowerCase()]=!0;else if(n>0){const t=e.slice(0,n).toString().toLowerCase();if(t in i)return;const o=e.slice(n+1);i[t]=r?o:o.toString()}})),i}};return i}},2746:e=>{var t=Object.prototype.toString,r="undefined"!=typeof Buffer&&"function"==typeof Buffer.alloc&&"function"==typeof Buffer.allocUnsafe&&"function"==typeof Buffer.from;e.exports=function(e,i,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return o=e,"ArrayBuffer"===t.call(o).slice(8,-1)?function(e,t,i){t>>>=0;var n=e.byteLength-t;if(n<0)throw new RangeError("'offset' is out of bounds");if(void 0===i)i=n;else if((i>>>=0)>n)throw new RangeError("'length' is out of bounds");return r?Buffer.from(e.slice(t,t+i)):new Buffer(new Uint8Array(e.slice(t,t+i)))}(e,i,n):"string"==typeof e?function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!Buffer.isEncoding(t))throw new TypeError('"encoding" must be a valid string encoding');return r?Buffer.from(e,t):new Buffer(e,t)}(e,i):r?Buffer.from(e):new Buffer(e);var o}},8075:(e,t,r)=>{"use strict";var i=r(453),n=r(487),o=n(i("String.prototype.indexOf"));e.exports=function(e,t){var r=i(e,!!t);return"function"==typeof r&&o(e,".prototype.")>-1?n(r):r}},487:(e,t,r)=>{"use strict";var i=r(6743),n=r(453),o=r(6897),a=r(9675),s=n("%Function.prototype.apply%"),c=n("%Function.prototype.call%"),u=n("%Reflect.apply%",!0)||i.call(c,s),l=r(655),h=n("%Math.max%");e.exports=function(e){if("function"!=typeof e)throw new a("a function is required");var t=u(i,c,arguments);return o(t,1+h(0,e.length-(arguments.length-1)),!0)};var d=function(){return u(i,s,arguments)};l?l(e.exports,"apply",{value:d}):e.exports.apply=d},7833:(e,t,r)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let i=0,n=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(i++,"%c"===e&&(n=i))})),t.splice(n,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(736)(t);const{formatters:i}=e.exports;i.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},736:(e,t,r)=>{e.exports=function(e){function t(e){let r,n,o,a=null;function s(...e){if(!s.enabled)return;const i=s,n=Number(new Date),o=n-(r||n);i.diff=o,i.prev=r,i.curr=n,r=n,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,n)=>{if("%%"===r)return"%";a++;const o=t.formatters[n];if("function"==typeof o){const t=e[a];r=o.call(i,t),e.splice(a,1),a--}return r})),t.formatArgs.call(i,e);(i.log||t.log).apply(i,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=i,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(n!==t.namespaces&&(n=t.namespaces,o=t.enabled(e)),o),set:e=>{a=e}}),"function"==typeof t.init&&t.init(s),s}function i(e,r){const i=t(this.namespace+(void 0===r?":":r)+e);return i.log=this.log,i}function n(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(n),...t.skips.map(n).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const i=("string"==typeof e?e:"").split(/[\s,]+/),n=i.length;for(r=0;r<n;r++)i[r]&&("-"===(e=i[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,i;for(r=0,i=t.skips.length;r<i;r++)if(t.skips[r].test(e))return!1;for(r=0,i=t.names.length;r<i;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(6585),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},5753:(e,t,r)=>{"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=r(7833):e.exports=r(6033)},6033:(e,t,r)=>{const i=r(2018),n=r(9023);t.init=function(e){e.inspectOpts={};const r=Object.keys(t.inspectOpts);for(let i=0;i<r.length;i++)e.inspectOpts[r[i]]=t.inspectOpts[r[i]]},t.log=function(...e){return process.stderr.write(n.formatWithOptions(t.inspectOpts,...e)+"\n")},t.formatArgs=function(r){const{namespace:i,useColors:n}=this;if(n){const t=this.color,n="[3"+(t<8?t:"8;5;"+t),o=`  ${n};1m${i} [0m`;r[0]=o+r[0].split("\n").join("\n"+o),r.push(n+"m+"+e.exports.humanize(this.diff)+"[0m")}else r[0]=function(){if(t.inspectOpts.hideDate)return"";return(new Date).toISOString()+" "}()+i+" "+r[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):i.isatty(process.stderr.fd)},t.destroy=n.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{const e=r(7687);e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter((e=>/^debug_/i.test(e))).reduce(((e,t)=>{const r=t.substring(6).toLowerCase().replace(/_([a-z])/g,((e,t)=>t.toUpperCase()));let i=process.env[t];return i=!!/^(yes|on|true|enabled)$/i.test(i)||!/^(no|off|false|disabled)$/i.test(i)&&("null"===i?null:Number(i)),e[r]=i,e}),{}),e.exports=r(736)(t);const{formatters:o}=e.exports;o.o=function(e){return this.inspectOpts.colors=this.useColors,n.inspect(e,this.inspectOpts).split("\n").map((e=>e.trim())).join(" ")},o.O=function(e){return this.inspectOpts.colors=this.useColors,n.inspect(e,this.inspectOpts)}},4982:(e,t,r)=>{"use strict";var i=r(6525),n=r(8075),o=r(1589),a=r(453),s=r(1158),c=r(920),u=r(7653),l=r(7244),h=r(4634),d=r(4670),p=r(2120),f=r(4035),g=r(7070),m=r(1189),v=r(1539),y=r(593),C=r(5767),S=r(9511),E=n("SharedArrayBuffer.prototype.byteLength",!0),_=n("Date.prototype.getTime"),T=Object.getPrototypeOf,A=n("Object.prototype.toString"),I=a("%Set%",!0),D=n("Map.prototype.has",!0),w=n("Map.prototype.get",!0),b=n("Map.prototype.size",!0),U=n("Set.prototype.add",!0),R=n("Set.prototype.delete",!0),O=n("Set.prototype.has",!0),N=n("Set.prototype.size",!0);function P(e,t,r,i){for(var n,o=s(e);(n=o.next())&&!n.done;)if(F(t,n.value,r,i))return R(e,n.value),!0;return!1}function B(e){return void 0===e?null:"object"!=typeof e?"symbol"!=typeof e&&("string"!=typeof e&&"number"!=typeof e||+e==+e):void 0}function L(e,t,r,n,o,a){var s=B(r);if(null!=s)return s;var c=w(t,s),u=i({},o,{strict:!1});return!(void 0===c&&!D(t,s)||!F(n,c,u,a))&&(!D(e,s)&&F(n,c,u,a))}function x(e,t,r){var i=B(r);return null!=i?i:O(t,i)&&!O(e,i)}function M(e,t,r,i,n,o){for(var a,c,u=s(e);(a=u.next())&&!a.done;)if(F(r,c=a.value,n,o)&&F(i,w(t,c),n,o))return R(e,c),!0;return!1}function F(e,t,r,n){var a=r||{};if(a.strict?u(e,t):e===t)return!0;if(v(e)!==v(t))return!1;if(!e||!t||"object"!=typeof e&&"object"!=typeof t)return a.strict?u(e,t):e==t;var c,R=n.has(e),B=n.has(t);if(R&&B){if(n.get(e)===n.get(t))return!0}else c={};return R||n.set(e,c),B||n.set(t,c),function(e,t,r,n){var a,c;if(typeof e!=typeof t)return!1;if(null==e||null==t)return!1;if(A(e)!==A(t))return!1;if(l(e)!==l(t))return!1;var u=h(e),v=h(t);if(u!==v)return!1;var R=e instanceof Error,B=t instanceof Error;if(R!==B)return!1;if((R||B)&&(e.name!==t.name||e.message!==t.message))return!1;var V=f(e),H=f(t);if(V!==H)return!1;if((V||H)&&(e.source!==t.source||o(e)!==o(t)))return!1;var j=p(e),G=p(t);if(j!==G)return!1;if((j||G)&&_(e)!==_(t))return!1;if(r.strict&&T&&T(e)!==T(t))return!1;var W=C(e),Y=C(t);if(W!==Y)return!1;if(W||Y){if(e.length!==t.length)return!1;for(a=0;a<e.length;a++)if(e[a]!==t[a])return!1;return!0}var q=k(e),K=k(t);if(q!==K)return!1;if(q||K){if(e.length!==t.length)return!1;for(a=0;a<e.length;a++)if(e[a]!==t[a])return!1;return!0}var $=d(e),z=d(t);if($!==z)return!1;if($||z)return S(e)===S(t)&&("function"==typeof Uint8Array&&F(new Uint8Array(e),new Uint8Array(t),r,n));var Q=g(e),X=g(t);if(Q!==X)return!1;if(Q||X)return E(e)===E(t)&&("function"==typeof Uint8Array&&F(new Uint8Array(e),new Uint8Array(t),r,n));if(typeof e!=typeof t)return!1;var J=m(e),Z=m(t);if(J.length!==Z.length)return!1;for(J.sort(),Z.sort(),a=J.length-1;a>=0;a--)if(J[a]!=Z[a])return!1;for(a=J.length-1;a>=0;a--)if(!F(e[c=J[a]],t[c],r,n))return!1;var ee=y(e),te=y(t);if(ee!==te)return!1;if("Set"===ee||"Set"===te)return function(e,t,r,i){if(N(e)!==N(t))return!1;var n,o,a,c=s(e),u=s(t);for(;(n=c.next())&&!n.done;)if(n.value&&"object"==typeof n.value)a||(a=new I),U(a,n.value);else if(!O(t,n.value)){if(r.strict)return!1;if(!x(e,t,n.value))return!1;a||(a=new I),U(a,n.value)}if(a){for(;(o=u.next())&&!o.done;)if(o.value&&"object"==typeof o.value){if(!P(a,o.value,r.strict,i))return!1}else if(!r.strict&&!O(e,o.value)&&!P(a,o.value,r.strict,i))return!1;return 0===N(a)}return!0}(e,t,r,n);if("Map"===ee)return function(e,t,r,n){if(b(e)!==b(t))return!1;var o,a,c,u,l,h,d=s(e),p=s(t);for(;(o=d.next())&&!o.done;)if(u=o.value[0],l=o.value[1],u&&"object"==typeof u)c||(c=new I),U(c,u);else if(void 0===(h=w(t,u))&&!D(t,u)||!F(l,h,r,n)){if(r.strict)return!1;if(!L(e,t,u,l,r,n))return!1;c||(c=new I),U(c,u)}if(c){for(;(a=p.next())&&!a.done;)if(u=a.value[0],h=a.value[1],u&&"object"==typeof u){if(!M(c,e,u,h,r,n))return!1}else if(!(r.strict||e.has(u)&&F(w(e,u),h,r,n)||M(c,e,u,h,i({},r,{strict:!1}),n)))return!1;return 0===N(c)}return!0}(e,t,r,n);return!0}(e,t,a,n)}function k(e){return!(!e||"object"!=typeof e||"number"!=typeof e.length)&&("function"==typeof e.copy&&"function"==typeof e.slice&&(!(e.length>0&&"number"!=typeof e[0])&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))))}e.exports=function(e,t,r){return F(e,t,r,c())}},41:(e,t,r)=>{"use strict";var i=r(655),n=r(8068),o=r(9675),a=r(5795);e.exports=function(e,t,r){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new o("`obj` must be an object or a function`");if("string"!=typeof t&&"symbol"!=typeof t)throw new o("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new o("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new o("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new o("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!=typeof arguments[6])throw new o("`loose`, if provided, must be a boolean");var s=arguments.length>3?arguments[3]:null,c=arguments.length>4?arguments[4]:null,u=arguments.length>5?arguments[5]:null,l=arguments.length>6&&arguments[6],h=!!a&&a(e,t);if(i)i(e,t,{configurable:null===u&&h?h.configurable:!u,enumerable:null===s&&h?h.enumerable:!s,value:r,writable:null===c&&h?h.writable:!c});else{if(!l&&(s||c||u))throw new n("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");e[t]=r}}},8452:(e,t,r)=>{"use strict";var i=r(1189),n="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),o=Object.prototype.toString,a=Array.prototype.concat,s=r(41),c=r(592)(),u=function(e,t,r,i){if(t in e)if(!0===i){if(e[t]===r)return}else if("function"!=typeof(n=i)||"[object Function]"!==o.call(n)||!i())return;var n;c?s(e,t,r,!0):s(e,t,r)},l=function(e,t){var r=arguments.length>2?arguments[2]:{},o=i(t);n&&(o=a.call(o,Object.getOwnPropertySymbols(t)));for(var s=0;s<o.length;s+=1)u(e,o[s],t[o[s]],r[o[s]])};l.supportsDescriptors=!!c,e.exports=l},4731:(e,t)=>{"use strict";t.toString=function(e){switch(e){case 1:return"IN";case 2:return"CS";case 3:return"CH";case 4:return"HS";case 255:return"ANY"}return"UNKNOWN_"+e},t.toClass=function(e){switch(e.toUpperCase()){case"IN":return 1;case"CS":return 2;case"CH":return 3;case"HS":return 4;case"ANY":return 255}return 0}},3843:(e,t,r)=>{"use strict";const i=r(181).Buffer,n=r(834),o=r(2111),a=r(628),s=r(4731),c=r(5874),u=r(26),l=32768,h=t.name={};h.encode=function(e,t,r,{mail:n=!1}={}){t||(t=i.alloc(h.encodingLength(e))),r||(r=0);const o=r,a=e.replace(/^\.|\.$/gm,"");if(a.length){let e=[];if(n){let t="";a.split(".").forEach((r=>{r.endsWith("\\")?t+=(t.length?".":"")+r.slice(0,-1):0===e.length&&t.length?e.push(t+"."+r):e.push(r)}))}else e=a.split(".");for(let i=0;i<e.length;i++){const n=t.write(e[i],r+1);t[r]=n,r+=n+1}}return t[r++]=0,h.encode.bytes=r-o,t},h.encode.bytes=0,h.decode=function(e,t,{mail:r=!1}={}){t||(t=0);const i=[];let n=t,o=0,a=0,s=!1;for(;;){if(t>=e.length)throw new Error("Cannot decode name (buffer overflow)");const c=e[t++];if(a+=s?0:1,0===c)break;if(192&c){if(192&~c)throw new Error("Cannot decode name (bad label)");{if(t+1>e.length)throw new Error("Cannot decode name (buffer overflow)");const r=e.readUInt16BE(t-1)-49152;if(r>=n)throw new Error("Cannot decode name (bad pointer)");t=r,n=r,a+=s?0:1,s=!0}}else{if(t+c>e.length)throw new Error("Cannot decode name (buffer overflow)");if(o+=c+1,o>254)throw new Error("Cannot decode name (name too long)");let n=e.toString("utf-8",t,t+c);r&&(n=n.replace(/\./g,"\\.")),i.push(n),t+=c,a+=s?0:c}}return h.decode.bytes=a,0===i.length?".":i.join(".")},h.decode.bytes=0,h.encodingLength=function(e){return"."===e||".."===e?1:i.byteLength(e.replace(/^\.|\.$/gm,""))+2};const d={encode:function(e,t,r){t||(t=i.alloc(d.encodingLength(e))),r||(r=0);const n=t.write(e,r+1);return t[r]=n,d.encode.bytes=n+1,t}};d.encode.bytes=0,d.decode=function(e,t){t||(t=0);const r=e[t],i=e.toString("utf-8",t+1,t+1+r);return d.decode.bytes=r+1,i},d.decode.bytes=0,d.encodingLength=function(e){return i.byteLength(e)+1};const p={encode:function(e,t,r){t||(t=p.encodingLength(e)),r||(r=0);const i=32767&(e.flags||0),n="response"===e.type?32768:0;return t.writeUInt16BE(e.id||0,r),t.writeUInt16BE(i|n,r+2),t.writeUInt16BE(e.questions.length,r+4),t.writeUInt16BE(e.answers.length,r+6),t.writeUInt16BE(e.authorities.length,r+8),t.writeUInt16BE(e.additionals.length,r+10),t}};p.encode.bytes=12,p.decode=function(e,t){if(t||(t=0),e.length<12)throw new Error("Header must be 12 bytes");const r=e.readUInt16BE(t+2);return{id:e.readUInt16BE(t),type:32768&r?"response":"query",flags:32767&r,flag_qr:1==(r>>15&1),opcode:a.toString(r>>11&15),flag_aa:1==(r>>10&1),flag_tc:1==(r>>9&1),flag_rd:1==(r>>8&1),flag_ra:1==(r>>7&1),flag_z:1==(r>>6&1),flag_ad:1==(r>>5&1),flag_cd:1==(r>>4&1),rcode:o.toString(15&r),questions:new Array(e.readUInt16BE(t+4)),answers:new Array(e.readUInt16BE(t+6)),authorities:new Array(e.readUInt16BE(t+8)),additionals:new Array(e.readUInt16BE(t+10))}},p.decode.bytes=12,p.encodingLength=function(){return 12};const f=t.unknown={};f.encode=function(e,t,r){return t||(t=i.alloc(f.encodingLength(e))),r||(r=0),t.writeUInt16BE(e.length,r),e.copy(t,r+2),f.encode.bytes=e.length+2,t},f.encode.bytes=0,f.decode=function(e,t){t||(t=0);const r=e.readUInt16BE(t),i=e.slice(t+2,t+2+r);return f.decode.bytes=r+2,i},f.decode.bytes=0,f.encodingLength=function(e){return e.length+2};const g=t.ns={};g.encode=function(e,t,r){return t||(t=i.alloc(g.encodingLength(e))),r||(r=0),h.encode(e,t,r+2),t.writeUInt16BE(h.encode.bytes,r),g.encode.bytes=h.encode.bytes+2,t},g.encode.bytes=0,g.decode=function(e,t){t||(t=0);const r=e.readUInt16BE(t),i=h.decode(e,t+2);return g.decode.bytes=r+2,i},g.decode.bytes=0,g.encodingLength=function(e){return h.encodingLength(e)+2};const m=t.soa={};m.encode=function(e,t,r){t||(t=i.alloc(m.encodingLength(e))),r||(r=0);const n=r;return r+=2,h.encode(e.mname,t,r),r+=h.encode.bytes,h.encode(e.rname,t,r,{mail:!0}),r+=h.encode.bytes,t.writeUInt32BE(e.serial||0,r),r+=4,t.writeUInt32BE(e.refresh||0,r),r+=4,t.writeUInt32BE(e.retry||0,r),r+=4,t.writeUInt32BE(e.expire||0,r),r+=4,t.writeUInt32BE(e.minimum||0,r),r+=4,t.writeUInt16BE(r-n-2,n),m.encode.bytes=r-n,t},m.encode.bytes=0,m.decode=function(e,t){t||(t=0);const r=t,i={};return t+=2,i.mname=h.decode(e,t),t+=h.decode.bytes,i.rname=h.decode(e,t,{mail:!0}),t+=h.decode.bytes,i.serial=e.readUInt32BE(t),t+=4,i.refresh=e.readUInt32BE(t),t+=4,i.retry=e.readUInt32BE(t),t+=4,i.expire=e.readUInt32BE(t),t+=4,i.minimum=e.readUInt32BE(t),t+=4,m.decode.bytes=t-r,i},m.decode.bytes=0,m.encodingLength=function(e){return 22+h.encodingLength(e.mname)+h.encodingLength(e.rname)};const v=t.txt={};v.encode=function(e,t,r){Array.isArray(e)||(e=[e]);for(let t=0;t<e.length;t++)if("string"==typeof e[t]&&(e[t]=i.from(e[t])),!i.isBuffer(e[t]))throw new Error("Must be a Buffer");t||(t=i.alloc(v.encodingLength(e))),r||(r=0);const n=r;return r+=2,e.forEach((function(e){t[r++]=e.length,e.copy(t,r,0,e.length),r+=e.length})),t.writeUInt16BE(r-n-2,n),v.encode.bytes=r-n,t},v.encode.bytes=0,v.decode=function(e,t){t||(t=0);const r=t;let i=e.readUInt16BE(t);t+=2;let n=[];for(;i>0;){const r=e[t++];if(--i,i<r)throw new Error("Buffer overflow");n.push(e.slice(t,t+r)),t+=r,i-=r}return v.decode.bytes=t-r,n},v.decode.bytes=0,v.encodingLength=function(e){Array.isArray(e)||(e=[e]);let t=2;return e.forEach((function(e){t+="string"==typeof e?i.byteLength(e)+1:e.length+1})),t};const y=t.null={};y.encode=function(e,t,r){t||(t=i.alloc(y.encodingLength(e))),r||(r=0),"string"==typeof e&&(e=i.from(e)),e||(e=i.alloc(0));const n=r;r+=2;const o=e.length;return e.copy(t,r,0,o),r+=o,t.writeUInt16BE(r-n-2,n),y.encode.bytes=r-n,t},y.encode.bytes=0,y.decode=function(e,t){t||(t=0);const r=t,i=e.readUInt16BE(t);t+=2;const n=e.slice(t,t+i);return t+=i,y.decode.bytes=t-r,n},y.decode.bytes=0,y.encodingLength=function(e){return e?(i.isBuffer(e)?e.length:i.byteLength(e))+2:2};const C=t.hinfo={};C.encode=function(e,t,r){t||(t=i.alloc(C.encodingLength(e))),r||(r=0);const n=r;return r+=2,d.encode(e.cpu,t,r),r+=d.encode.bytes,d.encode(e.os,t,r),r+=d.encode.bytes,t.writeUInt16BE(r-n-2,n),C.encode.bytes=r-n,t},C.encode.bytes=0,C.decode=function(e,t){t||(t=0);const r=t,i={};return t+=2,i.cpu=d.decode(e,t),t+=d.decode.bytes,i.os=d.decode(e,t),t+=d.decode.bytes,C.decode.bytes=t-r,i},C.decode.bytes=0,C.encodingLength=function(e){return d.encodingLength(e.cpu)+d.encodingLength(e.os)+2};const S=t.ptr={},E=t.cname=S,_=t.dname=S;S.encode=function(e,t,r){return t||(t=i.alloc(S.encodingLength(e))),r||(r=0),h.encode(e,t,r+2),t.writeUInt16BE(h.encode.bytes,r),S.encode.bytes=h.encode.bytes+2,t},S.encode.bytes=0,S.decode=function(e,t){t||(t=0);const r=h.decode(e,t+2);return S.decode.bytes=h.decode.bytes+2,r},S.decode.bytes=0,S.encodingLength=function(e){return h.encodingLength(e)+2};const T=t.srv={};T.encode=function(e,t,r){t||(t=i.alloc(T.encodingLength(e))),r||(r=0),t.writeUInt16BE(e.priority||0,r+2),t.writeUInt16BE(e.weight||0,r+4),t.writeUInt16BE(e.port||0,r+6),h.encode(e.target,t,r+8);const n=h.encode.bytes+6;return t.writeUInt16BE(n,r),T.encode.bytes=n+2,t},T.encode.bytes=0,T.decode=function(e,t){t||(t=0);const r=e.readUInt16BE(t),i={};return i.priority=e.readUInt16BE(t+2),i.weight=e.readUInt16BE(t+4),i.port=e.readUInt16BE(t+6),i.target=h.decode(e,t+8),T.decode.bytes=r+2,i},T.decode.bytes=0,T.encodingLength=function(e){return 8+h.encodingLength(e.target)};const A=t.caa={};A.ISSUER_CRITICAL=128,A.encode=function(e,t,r){const n=A.encodingLength(e);return t||(t=i.alloc(A.encodingLength(e))),r||(r=0),e.issuerCritical&&(e.flags=A.ISSUER_CRITICAL),t.writeUInt16BE(n-2,r),r+=2,t.writeUInt8(e.flags||0,r),r+=1,d.encode(e.tag,t,r),r+=d.encode.bytes,t.write(e.value,r),r+=i.byteLength(e.value),A.encode.bytes=n,t},A.encode.bytes=0,A.decode=function(e,t){t||(t=0);const r=e.readUInt16BE(t),i=t+=2,n={};return n.flags=e.readUInt8(t),t+=1,n.tag=d.decode(e,t),t+=d.decode.bytes,n.value=e.toString("utf-8",t,i+r),n.issuerCritical=!!(n.flags&A.ISSUER_CRITICAL),A.decode.bytes=r+2,n},A.decode.bytes=0,A.encodingLength=function(e){return d.encodingLength(e.tag)+d.encodingLength(e.value)+2};const I=t.mx={};I.encode=function(e,t,r){t||(t=i.alloc(I.encodingLength(e))),r||(r=0);const n=r;return r+=2,t.writeUInt16BE(e.preference||0,r),r+=2,h.encode(e.exchange,t,r),r+=h.encode.bytes,t.writeUInt16BE(r-n-2,n),I.encode.bytes=r-n,t},I.encode.bytes=0,I.decode=function(e,t){t||(t=0);const r=t,i={};return t+=2,i.preference=e.readUInt16BE(t),t+=2,i.exchange=h.decode(e,t),t+=h.decode.bytes,I.decode.bytes=t-r,i},I.encodingLength=function(e){return 4+h.encodingLength(e.exchange)};const D=t.a={};D.encode=function(e,t,r){return t||(t=i.alloc(D.encodingLength(e))),r||(r=0),t.writeUInt16BE(4,r),r+=2,u.v4.encode(e,t,r),D.encode.bytes=6,t},D.encode.bytes=0,D.decode=function(e,t){t||(t=0),t+=2;const r=u.v4.decode(e,t);return D.decode.bytes=6,r},D.decode.bytes=0,D.encodingLength=function(){return 6};const w=t.aaaa={};w.encode=function(e,t,r){return t||(t=i.alloc(w.encodingLength(e))),r||(r=0),t.writeUInt16BE(16,r),r+=2,u.v6.encode(e,t,r),w.encode.bytes=18,t},w.encode.bytes=0,w.decode=function(e,t){t||(t=0),t+=2;const r=u.v6.decode(e,t);return w.decode.bytes=18,r},w.decode.bytes=0,w.encodingLength=function(){return 18};const b=t.option={};b.encode=function(e,t,r){t||(t=i.alloc(b.encodingLength(e))),r||(r=0);const n=r,o=c.toCode(e.code);if(t.writeUInt16BE(o,r),r+=2,e.data)t.writeUInt16BE(e.data.length,r),r+=2,e.data.copy(t,r),r+=e.data.length;else switch(o){case 8:const n=e.sourcePrefixLength||0,o=e.family||u.familyOf(e.ip),a=u.encode(e.ip,i.alloc),s=Math.ceil(n/8);t.writeUInt16BE(s+4,r),r+=2,t.writeUInt16BE(o,r),r+=2,t.writeUInt8(n,r++),t.writeUInt8(e.scopePrefixLength||0,r++),a.copy(t,r,0,s),r+=s;break;case 11:e.timeout?(t.writeUInt16BE(2,r),r+=2,t.writeUInt16BE(e.timeout,r),r+=2):(t.writeUInt16BE(0,r),r+=2);break;case 12:const c=e.length||0;t.writeUInt16BE(c,r),r+=2,t.fill(0,r,r+c),r+=c;break;case 14:const l=2*e.tags.length;t.writeUInt16BE(l,r),r+=2;for(const i of e.tags)t.writeUInt16BE(i,r),r+=2;break;default:throw new Error(`Unknown roption code: ${e.code}`)}return b.encode.bytes=r-n,t},b.encode.bytes=0,b.decode=function(e,t){t||(t=0);const r={};r.code=e.readUInt16BE(t),r.type=c.toString(r.code),t+=2;const n=e.readUInt16BE(t);switch(t+=2,r.data=e.slice(t,t+n),r.code){case 8:r.family=e.readUInt16BE(t),t+=2,r.sourcePrefixLength=e.readUInt8(t++),r.scopePrefixLength=e.readUInt8(t++);const o=i.alloc(1===r.family?4:16);e.copy(o,0,t,t+n-4),r.ip=u.decode(o);break;case 11:n>0&&(r.timeout=e.readUInt16BE(t),t+=2);break;case 14:r.tags=[];for(let i=0;i<n;i+=2)r.tags.push(e.readUInt16BE(t)),t+=2}return b.decode.bytes=n+4,r},b.decode.bytes=0,b.encodingLength=function(e){if(e.data)return e.data.length+4;switch(c.toCode(e.code)){case 8:const t=e.sourcePrefixLength||0;return Math.ceil(t/8)+8;case 11:return"number"==typeof e.timeout?6:4;case 12:return e.length+4;case 14:return 4+2*e.tags.length}throw new Error(`Unknown roption code: ${e.code}`)};const U=t.opt={};U.encode=function(e,t,r){t||(t=i.alloc(U.encodingLength(e))),r||(r=0);const n=r,o=G(e,b);return t.writeUInt16BE(o,r),r=W(e,b,t,r+2),U.encode.bytes=r-n,t},U.encode.bytes=0,U.decode=function(e,t){t||(t=0);const r=t,i=[];let n=e.readUInt16BE(t);t+=2;let o=0;for(;n>0;)i[o++]=b.decode(e,t),t+=b.decode.bytes,n-=b.decode.bytes;return U.decode.bytes=t-r,i},U.decode.bytes=0,U.encodingLength=function(e){return 2+G(e||[],b)};const R=t.dnskey={};R.PROTOCOL_DNSSEC=3,R.ZONE_KEY=128,R.SECURE_ENTRYPOINT=32768,R.encode=function(e,t,r){t||(t=i.alloc(R.encodingLength(e))),r||(r=0);const n=r,o=e.key;if(!i.isBuffer(o))throw new Error("Key must be a Buffer");return r+=2,t.writeUInt16BE(e.flags,r),r+=2,t.writeUInt8(R.PROTOCOL_DNSSEC,r),r+=1,t.writeUInt8(e.algorithm,r),r+=1,o.copy(t,r,0,o.length),r+=o.length,R.encode.bytes=r-n,t.writeUInt16BE(R.encode.bytes-2,n),t},R.encode.bytes=0,R.decode=function(e,t){t||(t=0);const r=t;var i={},n=e.readUInt16BE(t);if(t+=2,i.flags=e.readUInt16BE(t),t+=2,e.readUInt8(t)!==R.PROTOCOL_DNSSEC)throw new Error("Protocol must be 3");return t+=1,i.algorithm=e.readUInt8(t),t+=1,i.key=e.slice(t,r+n+2),t+=i.key.length,R.decode.bytes=t-r,i},R.decode.bytes=0,R.encodingLength=function(e){return 6+i.byteLength(e.key)};const O=t.rrsig={};O.encode=function(e,t,r){t||(t=i.alloc(O.encodingLength(e))),r||(r=0);const o=r,a=e.signature;if(!i.isBuffer(a))throw new Error("Signature must be a Buffer");return r+=2,t.writeUInt16BE(n.toType(e.typeCovered),r),r+=2,t.writeUInt8(e.algorithm,r),r+=1,t.writeUInt8(e.labels,r),r+=1,t.writeUInt32BE(e.originalTTL,r),r+=4,t.writeUInt32BE(e.expiration,r),r+=4,t.writeUInt32BE(e.inception,r),r+=4,t.writeUInt16BE(e.keyTag,r),r+=2,h.encode(e.signersName,t,r),r+=h.encode.bytes,a.copy(t,r,0,a.length),r+=a.length,O.encode.bytes=r-o,t.writeUInt16BE(O.encode.bytes-2,o),t},O.encode.bytes=0,O.decode=function(e,t){t||(t=0);const r=t;var i={},o=e.readUInt16BE(t);return t+=2,i.typeCovered=n.toString(e.readUInt16BE(t)),t+=2,i.algorithm=e.readUInt8(t),t+=1,i.labels=e.readUInt8(t),t+=1,i.originalTTL=e.readUInt32BE(t),t+=4,i.expiration=e.readUInt32BE(t),t+=4,i.inception=e.readUInt32BE(t),t+=4,i.keyTag=e.readUInt16BE(t),t+=2,i.signersName=h.decode(e,t),t+=h.decode.bytes,i.signature=e.slice(t,r+o+2),t+=i.signature.length,O.decode.bytes=t-r,i},O.decode.bytes=0,O.encodingLength=function(e){return 20+h.encodingLength(e.signersName)+i.byteLength(e.signature)};const N=t.rp={};N.encode=function(e,t,r){t||(t=i.alloc(N.encodingLength(e))),r||(r=0);const n=r;return r+=2,h.encode(e.mbox||".",t,r,{mail:!0}),r+=h.encode.bytes,h.encode(e.txt||".",t,r),r+=h.encode.bytes,N.encode.bytes=r-n,t.writeUInt16BE(N.encode.bytes-2,n),t},N.encode.bytes=0,N.decode=function(e,t){t||(t=0);const r=t,i={};return t+=2,i.mbox=h.decode(e,t,{mail:!0})||".",t+=h.decode.bytes,i.txt=h.decode(e,t)||".",t+=h.decode.bytes,N.decode.bytes=t-r,i},N.decode.bytes=0,N.encodingLength=function(e){return 2+h.encodingLength(e.mbox||".")+h.encodingLength(e.txt||".")};const P={encode:function(e,t,r){t||(t=i.alloc(P.encodingLength(e))),r||(r=0);const o=r;for(var a=[],s=0;s<e.length;s++){var c=n.toType(e[s]);void 0===a[c>>8]&&(a[c>>8]=[]),a[c>>8][c>>3&31]|=1<<7-(7&c)}for(s=0;s<a.length;s++)if(void 0!==a[s]){var u=i.from(a[s]);t.writeUInt8(s,r),r+=1,t.writeUInt8(u.length,r),r+=1,u.copy(t,r),r+=u.length}return P.encode.bytes=r-o,t}};P.encode.bytes=0,P.decode=function(e,t,r){t||(t=0);const i=t;for(var o=[];t-i<r;){var a=e.readUInt8(t);t+=1;var s=e.readUInt8(t);t+=1;for(var c=0;c<s;c++)for(var u=e.readUInt8(t+c),l=0;l<8;l++)if(u&1<<7-l){var h=n.toString(a<<8|c<<3|l);o.push(h)}t+=s}return P.decode.bytes=t-i,o},P.decode.bytes=0,P.encodingLength=function(e){for(var t=[],r=0;r<e.length;r++){var i=n.toType(e[r]);t[i>>8]=Math.max(t[i>>8]||0,255&i)}var o=0;for(r=0;r<t.length;r++)void 0!==t[r]&&(o+=2+Math.ceil((t[r]+1)/8));return o};const B=t.nsec={};B.encode=function(e,t,r){t||(t=i.alloc(B.encodingLength(e))),r||(r=0);const n=r;return r+=2,h.encode(e.nextDomain,t,r),r+=h.encode.bytes,P.encode(e.rrtypes,t,r),r+=P.encode.bytes,B.encode.bytes=r-n,t.writeUInt16BE(B.encode.bytes-2,n),t},B.encode.bytes=0,B.decode=function(e,t){t||(t=0);const r=t;var i={},n=e.readUInt16BE(t);return t+=2,i.nextDomain=h.decode(e,t),t+=h.decode.bytes,i.rrtypes=P.decode(e,t,n-(t-r)),t+=P.decode.bytes,B.decode.bytes=t-r,i},B.decode.bytes=0,B.encodingLength=function(e){return 2+h.encodingLength(e.nextDomain)+P.encodingLength(e.rrtypes)};const L=t.nsec3={};L.encode=function(e,t,r){t||(t=i.alloc(L.encodingLength(e))),r||(r=0);const n=r,o=e.salt;if(!i.isBuffer(o))throw new Error("salt must be a Buffer");const a=e.nextDomain;if(!i.isBuffer(a))throw new Error("nextDomain must be a Buffer");return r+=2,t.writeUInt8(e.algorithm,r),r+=1,t.writeUInt8(e.flags,r),r+=1,t.writeUInt16BE(e.iterations,r),r+=2,t.writeUInt8(o.length,r),r+=1,o.copy(t,r,0,o.length),r+=o.length,t.writeUInt8(a.length,r),r+=1,a.copy(t,r,0,a.length),r+=a.length,P.encode(e.rrtypes,t,r),r+=P.encode.bytes,L.encode.bytes=r-n,t.writeUInt16BE(L.encode.bytes-2,n),t},L.encode.bytes=0,L.decode=function(e,t){t||(t=0);const r=t;var i={},n=e.readUInt16BE(t);t+=2,i.algorithm=e.readUInt8(t),t+=1,i.flags=e.readUInt8(t),t+=1,i.iterations=e.readUInt16BE(t),t+=2;const o=e.readUInt8(t);t+=1,i.salt=e.slice(t,t+o),t+=o;const a=e.readUInt8(t);return t+=1,i.nextDomain=e.slice(t,t+a),t+=a,i.rrtypes=P.decode(e,t,n-(t-r)),t+=P.decode.bytes,L.decode.bytes=t-r,i},L.decode.bytes=0,L.encodingLength=function(e){return 8+e.salt.length+e.nextDomain.length+P.encodingLength(e.rrtypes)};const x=t.ds={};x.encode=function(e,t,r){t||(t=i.alloc(x.encodingLength(e))),r||(r=0);const n=r,o=e.digest;if(!i.isBuffer(o))throw new Error("Digest must be a Buffer");return r+=2,t.writeUInt16BE(e.keyTag,r),r+=2,t.writeUInt8(e.algorithm,r),r+=1,t.writeUInt8(e.digestType,r),r+=1,o.copy(t,r,0,o.length),r+=o.length,x.encode.bytes=r-n,t.writeUInt16BE(x.encode.bytes-2,n),t},x.encode.bytes=0,x.decode=function(e,t){t||(t=0);const r=t;var i={},n=e.readUInt16BE(t);return t+=2,i.keyTag=e.readUInt16BE(t),t+=2,i.algorithm=e.readUInt8(t),t+=1,i.digestType=e.readUInt8(t),t+=1,i.digest=e.slice(t,r+n+2),t+=i.digest.length,x.decode.bytes=t-r,i},x.decode.bytes=0,x.encodingLength=function(e){return 6+i.byteLength(e.digest)};const M=t.sshfp={};M.getFingerprintLengthForHashType=function(e){switch(e){case 1:return 20;case 2:return 32}},M.encode=function(e,t,r){t||(t=i.alloc(M.encodingLength(e))),r||(r=0);const n=r;t[r+=2]=e.algorithm,t[r+=1]=e.hash,r+=1;const o=i.from(e.fingerprint.toUpperCase(),"hex");if(o.length!==M.getFingerprintLengthForHashType(e.hash))throw new Error("Invalid fingerprint length");return o.copy(t,r),r+=o.byteLength,M.encode.bytes=r-n,t.writeUInt16BE(M.encode.bytes-2,n),t},M.encode.bytes=0,M.decode=function(e,t){t||(t=0);const r=t,i={};t+=2,i.algorithm=e[t],t+=1,i.hash=e[t],t+=1;const n=M.getFingerprintLengthForHashType(i.hash);return i.fingerprint=e.slice(t,t+n).toString("hex").toUpperCase(),t+=n,M.decode.bytes=t-r,i},M.decode.bytes=0,M.encodingLength=function(e){return 4+i.from(e.fingerprint,"hex").byteLength};const F=t.naptr={};F.encode=function(e,t,r){t||(t=i.alloc(F.encodingLength(e))),r||(r=0);const n=r;return r+=2,t.writeUInt16BE(e.order||0,r),r+=2,t.writeUInt16BE(e.preference||0,r),r+=2,d.encode(e.flags,t,r),r+=d.encode.bytes,d.encode(e.services,t,r),r+=d.encode.bytes,d.encode(e.regexp,t,r),r+=d.encode.bytes,h.encode(e.replacement,t,r),r+=h.encode.bytes,F.encode.bytes=r-n,t.writeUInt16BE(F.encode.bytes-2,n),t},F.encode.bytes=0,F.decode=function(e,t){t||(t=0);const r=t,i={};return t+=2,i.order=e.readUInt16BE(t),t+=2,i.preference=e.readUInt16BE(t),t+=2,i.flags=d.decode(e,t),t+=d.decode.bytes,i.services=d.decode(e,t),t+=d.decode.bytes,i.regexp=d.decode(e,t),t+=d.decode.bytes,i.replacement=h.decode(e,t),t+=h.decode.bytes,F.decode.bytes=t-r,i},F.decode.bytes=0,F.encodingLength=function(e){return d.encodingLength(e.flags)+d.encodingLength(e.services)+d.encodingLength(e.regexp)+h.encodingLength(e.replacement)+6};const k=t.tlsa={};k.encode=function(e,t,r){t||(t=i.alloc(k.encodingLength(e))),r||(r=0);const n=r,o=e.certificate;if(!i.isBuffer(o))throw new Error("Certificate must be a Buffer");return r+=2,t.writeUInt8(e.usage,r),r+=1,t.writeUInt8(e.selector,r),r+=1,t.writeUInt8(e.matchingType,r),r+=1,o.copy(t,r,0,o.length),r+=o.length,k.encode.bytes=r-n,t.writeUInt16BE(k.encode.bytes-2,n),t},k.encode.bytes=0,k.decode=function(e,t){t||(t=0);const r=t,i={},n=e.readUInt16BE(t);return t+=2,i.usage=e.readUInt8(t),t+=1,i.selector=e.readUInt8(t),t+=1,i.matchingType=e.readUInt8(t),t+=1,i.certificate=e.slice(t,r+n+2),t+=i.certificate.length,k.decode.bytes=t-r,i},k.decode.bytes=0,k.encodingLength=function(e){return 5+i.byteLength(e.certificate)};const V=t.record=function(e){switch(e.toUpperCase()){case"A":return D;case"PTR":return S;case"CNAME":return E;case"DNAME":return _;case"TXT":return v;case"NULL":return y;case"AAAA":return w;case"SRV":return T;case"HINFO":return C;case"CAA":return A;case"NS":return g;case"SOA":return m;case"MX":return I;case"OPT":return U;case"DNSKEY":return R;case"RRSIG":return O;case"RP":return N;case"NSEC":return B;case"NSEC3":return L;case"SSHFP":return M;case"DS":return x;case"NAPTR":return F;case"TLSA":return k}return f},H=t.answer={};H.encode=function(e,t,r){t||(t=i.alloc(H.encodingLength(e))),r||(r=0);const o=r;if(h.encode(e.name,t,r),r+=h.encode.bytes,t.writeUInt16BE(n.toType(e.type),r),"OPT"===e.type.toUpperCase()){if("."!==e.name)throw new Error("OPT name must be root.");t.writeUInt16BE(e.udpPayloadSize||4096,r+2),t.writeUInt8(e.extendedRcode||0,r+4),t.writeUInt8(e.ednsVersion||0,r+5),t.writeUInt16BE(e.flags||0,r+6),r+=8,U.encode(e.options||[],t,r),r+=U.encode.bytes}else{let i=s.toClass(void 0===e.class?"IN":e.class);e.flush&&(i|=l),t.writeUInt16BE(i,r+2),t.writeUInt32BE(e.ttl||0,r+4),r+=8;const n=V(e.type);n.encode(e.data,t,r),r+=n.encode.bytes}return H.encode.bytes=r-o,t},H.encode.bytes=0,H.decode=function(e,t){t||(t=0);const r={},i=t;if(r.name=h.decode(e,t),t+=h.decode.bytes,r.type=n.toString(e.readUInt16BE(t)),"OPT"===r.type)r.udpPayloadSize=e.readUInt16BE(t+2),r.extendedRcode=e.readUInt8(t+4),r.ednsVersion=e.readUInt8(t+5),r.flags=e.readUInt16BE(t+6),r.flag_do=1==(r.flags>>15&1),r.options=U.decode(e,t+8),t+=8+U.decode.bytes;else{const i=e.readUInt16BE(t+2);r.ttl=e.readUInt32BE(t+4),r.class=s.toString(-32769&i),r.flush=!!(i&l);const n=V(r.type);r.data=n.decode(e,t+8),t+=8+n.decode.bytes}return H.decode.bytes=t-i,r},H.decode.bytes=0,H.encodingLength=function(e){const t=null!==e.data&&void 0!==e.data?e.data:e.options;return h.encodingLength(e.name)+8+V(e.type).encodingLength(t)};const j=t.question={};function G(e,t){let r=0;for(let i=0;i<e.length;i++)r+=t.encodingLength(e[i]);return r}function W(e,t,r,i){for(let n=0;n<e.length;n++)t.encode(e[n],r,i),i+=t.encode.bytes;return i}function Y(e,t,r,i){for(let n=0;n<e.length;n++)e[n]=t.decode(r,i),i+=t.decode.bytes;return i}j.encode=function(e,t,r){t||(t=i.alloc(j.encodingLength(e))),r||(r=0);const o=r;return h.encode(e.name,t,r),r+=h.encode.bytes,t.writeUInt16BE(n.toType(e.type),r),r+=2,t.writeUInt16BE(s.toClass(void 0===e.class?"IN":e.class),r),r+=2,j.encode.bytes=r-o,e},j.encode.bytes=0,j.decode=function(e,t){t||(t=0);const r=t,i={};i.name=h.decode(e,t),t+=h.decode.bytes,i.type=n.toString(e.readUInt16BE(t)),t+=2,i.class=s.toString(e.readUInt16BE(t)),t+=2;return!!(32768&i.class)&&(i.class&=-32769),j.decode.bytes=t-r,i},j.decode.bytes=0,j.encodingLength=function(e){return h.encodingLength(e.name)+4},t.AUTHORITATIVE_ANSWER=1024,t.TRUNCATED_RESPONSE=512,t.RECURSION_DESIRED=256,t.RECURSION_AVAILABLE=128,t.AUTHENTIC_DATA=32,t.CHECKING_DISABLED=16,t.DNSSEC_OK=32768,t.encode=function(e,r,n){const o=!r;o&&(r=i.alloc(t.encodingLength(e))),n||(n=0);const a=n;return e.questions||(e.questions=[]),e.answers||(e.answers=[]),e.authorities||(e.authorities=[]),e.additionals||(e.additionals=[]),p.encode(e,r,n),n+=p.encode.bytes,n=W(e.questions,j,r,n),n=W(e.answers,H,r,n),n=W(e.authorities,H,r,n),n=W(e.additionals,H,r,n),t.encode.bytes=n-a,o&&t.encode.bytes!==r.length?r.slice(0,t.encode.bytes):r},t.encode.bytes=0,t.decode=function(e,r){r||(r=0);const i=r,n=p.decode(e,r);return r+=p.decode.bytes,r=Y(n.questions,j,e,r),r=Y(n.answers,H,e,r),r=Y(n.authorities,H,e,r),r=Y(n.additionals,H,e,r),t.decode.bytes=r-i,n},t.decode.bytes=0,t.encodingLength=function(e){return p.encodingLength(e)+G(e.questions||[],j)+G(e.answers||[],H)+G(e.authorities||[],H)+G(e.additionals||[],H)},t.streamEncode=function(e){const r=t.encode(e),n=i.alloc(2);n.writeUInt16BE(r.byteLength);const o=i.concat([n,r]);return t.streamEncode.bytes=o.byteLength,o},t.streamEncode.bytes=0,t.streamDecode=function(e){const r=e.readUInt16BE(0);if(e.byteLength<r+2)return null;const i=t.decode(e.slice(2));return t.streamDecode.bytes=t.decode.bytes,i},t.streamDecode.bytes=0},628:(e,t)=>{"use strict";t.toString=function(e){switch(e){case 0:return"QUERY";case 1:return"IQUERY";case 2:return"STATUS";case 3:return"OPCODE_3";case 4:return"NOTIFY";case 5:return"UPDATE";case 6:return"OPCODE_6";case 7:return"OPCODE_7";case 8:return"OPCODE_8";case 9:return"OPCODE_9";case 10:return"OPCODE_10";case 11:return"OPCODE_11";case 12:return"OPCODE_12";case 13:return"OPCODE_13";case 14:return"OPCODE_14";case 15:return"OPCODE_15"}return"OPCODE_"+e},t.toOpcode=function(e){switch(e.toUpperCase()){case"QUERY":return 0;case"IQUERY":return 1;case"STATUS":return 2;case"OPCODE_3":return 3;case"NOTIFY":return 4;case"UPDATE":return 5;case"OPCODE_6":return 6;case"OPCODE_7":return 7;case"OPCODE_8":return 8;case"OPCODE_9":return 9;case"OPCODE_10":return 10;case"OPCODE_11":return 11;case"OPCODE_12":return 12;case"OPCODE_13":return 13;case"OPCODE_14":return 14;case"OPCODE_15":return 15}return 0}},5874:(e,t)=>{"use strict";t.toString=function(e){switch(e){case 1:return"LLQ";case 2:return"UL";case 3:return"NSID";case 5:return"DAU";case 6:return"DHU";case 7:return"N3U";case 8:return"CLIENT_SUBNET";case 9:return"EXPIRE";case 10:return"COOKIE";case 11:return"TCP_KEEPALIVE";case 12:return"PADDING";case 13:return"CHAIN";case 14:return"KEY_TAG";case 26946:return"DEVICEID"}return e<0?null:`OPTION_${e}`},t.toCode=function(e){if("number"==typeof e)return e;if(!e)return-1;switch(e.toUpperCase()){case"OPTION_0":return 0;case"LLQ":return 1;case"UL":return 2;case"NSID":return 3;case"OPTION_4":return 4;case"DAU":return 5;case"DHU":return 6;case"N3U":return 7;case"CLIENT_SUBNET":return 8;case"EXPIRE":return 9;case"COOKIE":return 10;case"TCP_KEEPALIVE":return 11;case"PADDING":return 12;case"CHAIN":return 13;case"KEY_TAG":return 14;case"DEVICEID":return 26946;case"OPTION_65535":return 65535}const t=e.match(/_(\d+)$/);return t?parseInt(t[1],10):-1}},2111:(e,t)=>{"use strict";t.toString=function(e){switch(e){case 0:return"NOERROR";case 1:return"FORMERR";case 2:return"SERVFAIL";case 3:return"NXDOMAIN";case 4:return"NOTIMP";case 5:return"REFUSED";case 6:return"YXDOMAIN";case 7:return"YXRRSET";case 8:return"NXRRSET";case 9:return"NOTAUTH";case 10:return"NOTZONE";case 11:return"RCODE_11";case 12:return"RCODE_12";case 13:return"RCODE_13";case 14:return"RCODE_14";case 15:return"RCODE_15"}return"RCODE_"+e},t.toRcode=function(e){switch(e.toUpperCase()){case"NOERROR":return 0;case"FORMERR":return 1;case"SERVFAIL":return 2;case"NXDOMAIN":return 3;case"NOTIMP":return 4;case"REFUSED":return 5;case"YXDOMAIN":return 6;case"YXRRSET":return 7;case"NXRRSET":return 8;case"NOTAUTH":return 9;case"NOTZONE":return 10;case"RCODE_11":return 11;case"RCODE_12":return 12;case"RCODE_13":return 13;case"RCODE_14":return 14;case"RCODE_15":return 15}return 0}},834:(e,t)=>{"use strict";t.toString=function(e){switch(e){case 1:return"A";case 10:return"NULL";case 28:return"AAAA";case 18:return"AFSDB";case 42:return"APL";case 257:return"CAA";case 60:return"CDNSKEY";case 59:return"CDS";case 37:return"CERT";case 5:return"CNAME";case 49:return"DHCID";case 32769:return"DLV";case 39:return"DNAME";case 48:return"DNSKEY";case 43:return"DS";case 55:return"HIP";case 13:return"HINFO";case 45:return"IPSECKEY";case 25:return"KEY";case 36:return"KX";case 29:return"LOC";case 15:return"MX";case 35:return"NAPTR";case 2:return"NS";case 47:return"NSEC";case 50:return"NSEC3";case 51:return"NSEC3PARAM";case 12:return"PTR";case 46:return"RRSIG";case 17:return"RP";case 24:return"SIG";case 6:return"SOA";case 99:return"SPF";case 33:return"SRV";case 44:return"SSHFP";case 32768:return"TA";case 249:return"TKEY";case 52:return"TLSA";case 250:return"TSIG";case 16:return"TXT";case 252:return"AXFR";case 251:return"IXFR";case 41:return"OPT";case 255:return"ANY"}return"UNKNOWN_"+e},t.toType=function(e){switch(e.toUpperCase()){case"A":return 1;case"NULL":return 10;case"AAAA":return 28;case"AFSDB":return 18;case"APL":return 42;case"CAA":return 257;case"CDNSKEY":return 60;case"CDS":return 59;case"CERT":return 37;case"CNAME":return 5;case"DHCID":return 49;case"DLV":return 32769;case"DNAME":return 39;case"DNSKEY":return 48;case"DS":return 43;case"HIP":return 55;case"HINFO":return 13;case"IPSECKEY":return 45;case"KEY":return 25;case"KX":return 36;case"LOC":return 29;case"MX":return 15;case"NAPTR":return 35;case"NS":return 2;case"NSEC":return 47;case"NSEC3":return 50;case"NSEC3PARAM":return 51;case"PTR":return 12;case"RRSIG":return 46;case"RP":return 17;case"SIG":return 24;case"SOA":return 6;case"SPF":return 99;case"SRV":return 33;case"SSHFP":return 44;case"TA":return 32768;case"TKEY":return 249;case"TLSA":return 52;case"TSIG":return 250;case"TXT":return 16;case"AXFR":return 252;case"IXFR":return 251;case"OPT":return 41;case"ANY":case"*":return 255}return e.toUpperCase().startsWith("UNKNOWN_")?parseInt(e.slice(8)):0}},4928:(e,t,r)=>{var i=r(2203),n=["write","end","destroy"],o=["resume","pause"],a=["data","close"],s=Array.prototype.slice;function c(e,t){if(e.forEach)return e.forEach(t);for(var r=0;r<e.length;r++)t(e[r],r)}e.exports=function(e,t){var r=new i,u=!1;return c(n,(function(t){function i(){return e[t].apply(e,arguments)}r[t]=i})),c(o,(function(e){function i(){r.emit(e);var i=t[e];if(i)return i.apply(t,arguments);t.emit(e)}r[e]=i})),c(a,(function(e){function i(){var t=s.call(arguments);t.unshift(e),r.emit.apply(r,t)}t.on(e,i)})),t.on("end",(function(){if(u)return;u=!0;var e=s.call(arguments);e.unshift("end"),r.emit.apply(r,e)})),e.on("drain",(function(){r.emit("drain")})),e.on("error",l),t.on("error",l),r.writable=e.writable,r.readable=t.readable,r;function l(e){r.emit("error",e)}}},655:(e,t,r)=>{"use strict";var i=r(453)("%Object.defineProperty%",!0)||!1;if(i)try{i({},"a",{value:1})}catch(e){i=!1}e.exports=i},1237:e=>{"use strict";e.exports=EvalError},9383:e=>{"use strict";e.exports=Error},9290:e=>{"use strict";e.exports=RangeError},9538:e=>{"use strict";e.exports=ReferenceError},8068:e=>{"use strict";e.exports=SyntaxError},9675:e=>{"use strict";e.exports=TypeError},5345:e=>{"use strict";e.exports=URIError},8954:(e,t,r)=>{var i=r(2203).Stream,n=t,o=r(1094),a=r(1813),s=r(4928),c=r(9292),u=r(6736),l=r(175),h=r(8497),d=global.setImmediate||process.nextTick;n.Stream=i,n.through=o,n.from=a,n.duplex=s,n.map=c,n.pause=u,n.split=l,n.pipeline=n.connect=n.pipe=h,n.concat=n.merge=function(){var e=[].slice.call(arguments);1===e.length&&e[0]instanceof Array&&(e=e[0]);var t=new i;t.setMaxListeners(0);var r=0;return t.writable=t.readable=!0,e.length?e.forEach((function(i){i.pipe(t,{end:!1});var n=!1;i.on("end",(function(){n||(n=!0,++r==e.length&&t.emit("end"))}))})):process.nextTick((function(){t.emit("end")})),t.write=function(e){this.emit("data",e)},t.destroy=function(){e.forEach((function(e){e.destroy&&e.destroy()}))},t},n.collect=n.writeArray=function(e){if("function"!=typeof e)throw new Error("function writeArray (done): done must be function");var t=new i,r=[],n=!1;return t.write=function(e){r.push(e)},t.end=function(){n=!0,e(null,r)},t.writable=!0,t.readable=!1,t.destroy=function(){t.writable=t.readable=!1,n||e(new Error("destroyed before end"),r)},t},n.readArray=function(e){var t=new i,r=0,n=!1,o=!1;if(t.readable=!0,t.writable=!1,!Array.isArray(e))throw new Error("event-stream.read expects an array");return t.resume=function(){if(!o){n=!1;for(var i=e.length;r<i&&!n&&!o;)t.emit("data",e[r++]);r!=i||o||(o=!0,t.readable=!1,t.emit("end"))}},process.nextTick(t.resume),t.pause=function(){n=!0},t.destroy=function(){o=!0,t.emit("close")},t},n.readable=function(e,t){var r=new i,n=0,o=!1,a=!1,s=!1;if(r.readable=!0,r.writable=!1,"function"!=typeof e)throw new Error("event-stream.readable expects async function");function c(i,u){i?(r.emit("error",i),t||r.emit("end")):arguments.length>1&&r.emit("data",u),d((function(){if(!(a||o||s))try{s=!0,e.call(r,n++,(function(){s=!1,c.apply(null,arguments)}))}catch(e){r.emit("error",e)}}))}return r.on("end",(function(){a=!0})),r.resume=function(){o=!1,c()},process.nextTick(c),r.pause=function(){o=!0},r.destroy=function(){r.emit("end"),r.emit("close"),a=!0},r},n.mapSync=function(e){return n.through((function(t){var r;try{r=e(t)}catch(e){return this.emit("error",e)}void 0!==r&&this.emit("data",r)}))},n.filterSync=function(e){return n.through((function(t){e(t)&&this.queue(t)}))},n.flatmapSync=function(e){return n.through((function(t){var r=this;t.forEach((function(t){r.queue(e(t))}))}))},n.log=function(e){return n.through((function(t){[].slice.call(arguments);e?console.error(e,t):console.error(t),this.emit("data",t)}))},n.child=function(e){return n.duplex(e.stdin,e.stdout)},n.parse=function(e){var t=!(!e||!e.error);return n.through((function(e){var r;try{e&&(r=JSON.parse(e.toString()))}catch(r){return t?this.emit("error",r):console.error(r,"attempting to parse:",e)}void 0!==r&&this.emit("data",r)}))},n.stringify=function(){var e=r(181).Buffer;return n.mapSync((function(t){return JSON.stringify(e.isBuffer(t)?t.toString():t)+"\n"}))},n.replace=function(e,t){return n.pipeline(n.split(e),n.join(t))},n.join=function(e){if("function"==typeof e)return n.wait(e);var t=!0;return n.through((function(r){return t||this.emit("data",e),t=!1,this.emit("data",r),!0}))},n.wait=function(e){var t=[];return n.through((function(e){t.push(e)}),(function(){var r=Buffer.isBuffer(t[0])?Buffer.concat(t):t.join("");this.emit("data",r),this.emit("end"),e&&e(null,r)}))},n.pipeable=function(){throw new Error("[EVENT-STREAM] es.pipeable is deprecated")}},2017:e=>{"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var i,n,o;if(Array.isArray(t)){if((i=t.length)!=r.length)return!1;for(n=i;0!=n--;)if(!e(t[n],r[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((i=(o=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(n=i;0!=n--;)if(!Object.prototype.hasOwnProperty.call(r,o[n]))return!1;for(n=i;0!=n--;){var a=o[n];if(!e(t[a],r[a]))return!1}return!0}return t!=t&&r!=r}},2986:(e,t,r)=>{var i=r(6982);function n(e,t){null!=e&&("number"==typeof e?this.fromNumber(e,t):Buffer.isBuffer(e)?this.fromBuffer(e):null==t&&"string"!=typeof e?this.fromByteArray(e):this.fromString(e,t))}function o(){return new n(null)}n.prototype.am=function(e,t,r,i,n,o){for(var a=16383&t,s=t>>14;--o>=0;){var c=16383&this[e],u=this[e++]>>14,l=s*c+u*a;n=((c=a*c+((16383&l)<<14)+r[i]+n)>>28)+(l>>14)+s*u,r[i++]=268435455&c}return n},n.prototype.DB=28,n.prototype.DM=268435455,n.prototype.DV=1<<28;n.prototype.FV=Math.pow(2,52),n.prototype.F1=24,n.prototype.F2=4;var a,s,c="0123456789abcdefghijklmnopqrstuvwxyz",u=new Array;for(a="0".charCodeAt(0),s=0;s<=9;++s)u[a++]=s;for(a="a".charCodeAt(0),s=10;s<36;++s)u[a++]=s;for(a="A".charCodeAt(0),s=10;s<36;++s)u[a++]=s;function l(e){return c.charAt(e)}function h(e,t){var r=u[e.charCodeAt(t)];return null==r?-1:r}function d(e){var t=o();return t.fromInt(e),t}function p(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function f(e){this.m=e}function g(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function m(e,t){return e&t}function v(e,t){return e|t}function y(e,t){return e^t}function C(e,t){return e&~t}function S(e){if(0===e)return-1;var t=0;return 65535&e||(e>>=16,t+=16),255&e||(e>>=8,t+=8),15&e||(e>>=4,t+=4),3&e||(e>>=2,t+=2),1&e||++t,t}function E(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function _(){}function T(e){return e}function A(e){this.r2=o(),this.q3=o(),n.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}f.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},f.prototype.revert=function(e){return e},f.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},f.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},f.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},g.prototype.convert=function(e){var t=o();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(n.ZERO)>0&&this.m.subTo(t,t),t},g.prototype.revert=function(e){var t=o();return e.copyTo(t),this.reduce(t),t},g.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e[t],i=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[r=t+this.m.t]+=this.m.am(0,i,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},g.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},g.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},_.prototype.convert=T,_.prototype.revert=T,_.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},_.prototype.sqrTo=function(e,t){e.squareTo(t)},A.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=o();return e.copyTo(t),this.reduce(t),t},A.prototype.revert=function(e){return e},A.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},A.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},A.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var I=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],D=(1<<26)/I[I.length-1];n.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s},n.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+DV:this.t=0},n.prototype.fromString=function(e,t,r){var i;switch(t){case 2:i=1;break;case 4:i=2;break;case 8:i=3;break;case 16:i=4;break;case 32:i=5;break;case 256:i=8;break;default:return void this.fromRadix(e,t)}this.t=0,this.s=0;for(var o=e.length,a=!1,s=0;--o>=0;){var c=8==i?255&e[o]:h(e,o);c<0?"-"==e.charAt(o)&&(a=!0):(a=!1,0===s?this[this.t++]=c:s+i>this.DB?(this[this.t-1]|=(c&(1<<this.DB-s)-1)<<s,this[this.t++]=c>>this.DB-s):this[this.t-1]|=c<<s,(s+=i)>=this.DB&&(s-=this.DB))}!r&&8==i&&128&e[0]&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),a&&n.ZERO.subTo(this,this)},n.prototype.fromByteArray=function(e,t){this.fromString(e,256,t)},n.prototype.fromBuffer=function(e){this.fromString(e,256,!0)},n.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t},n.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e,t.s=this.s},n.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s},n.prototype.lShiftTo=function(e,t){var r,i=e%this.DB,n=this.DB-i,o=(1<<n)-1,a=Math.floor(e/this.DB),s=this.s<<i&this.DM;for(r=this.t-1;r>=0;--r)t[r+a+1]=this[r]>>n|s,s=(this[r]&o)<<i;for(r=a-1;r>=0;--r)t[r]=0;t[a]=s,t.t=this.t+a+1,t.s=this.s,t.clamp()},n.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var i=e%this.DB,n=this.DB-i,o=(1<<i)-1;t[0]=this[r]>>i;for(var a=r+1;a<this.t;++a)t[a-r-1]|=(this[a]&o)<<n,t[a-r]=this[a]>>i;i>0&&(t[this.t-r-1]|=(this.s&o)<<n),t.t=this.t-r,t.clamp()}},n.prototype.subTo=function(e,t){for(var r=0,i=0,n=Math.min(e.t,this.t);r<n;)i+=this[r]-e[r],t[r++]=i&this.DM,i>>=this.DB;if(e.t<this.t){for(i-=e.s;r<this.t;)i+=this[r],t[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<e.t;)i-=e[r],t[r++]=i&this.DM,i>>=this.DB;i-=e.s}t.s=i<0?-1:0,i<-1?t[r++]=this.DV+i:i>0&&(t[r++]=i),t.t=r,t.clamp()},n.prototype.multiplyTo=function(e,t){var r=this.abs(),i=e.abs(),o=r.t;for(t.t=o+i.t;--o>=0;)t[o]=0;for(o=0;o<i.t;++o)t[o+r.t]=r.am(0,i[o],t,o,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&n.ZERO.subTo(t,t)},n.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e[r]=0;for(r=0;r<t.t-1;++r){var i=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,i,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()},n.prototype.divRemTo=function(e,t,r){var i=e.abs();if(!(i.t<=0)){var a=this.abs();if(a.t<i.t)return null!=t&&t.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=o());var s=o(),c=this.s,u=e.s,l=this.DB-p(i[i.t-1]);l>0?(i.lShiftTo(l,s),a.lShiftTo(l,r)):(i.copyTo(s),a.copyTo(r));var h=s.t,d=s[h-1];if(0!==d){var f=d*(1<<this.F1)+(h>1?s[h-2]>>this.F2:0),g=this.FV/f,m=(1<<this.F1)/f,v=1<<this.F2,y=r.t,C=y-h,S=null==t?o():t;for(s.dlShiftTo(C,S),r.compareTo(S)>=0&&(r[r.t++]=1,r.subTo(S,r)),n.ONE.dlShiftTo(h,S),S.subTo(s,s);s.t<h;)s[s.t++]=0;for(;--C>=0;){var E=r[--y]==d?this.DM:Math.floor(r[y]*g+(r[y-1]+v)*m);if((r[y]+=s.am(0,E,r,C,0,h))<E)for(s.dlShiftTo(C,S),r.subTo(S,r);r[y]<--E;)r.subTo(S,r)}null!=t&&(r.drShiftTo(h,t),c!=u&&n.ZERO.subTo(t,t)),r.t=h,r.clamp(),l>0&&r.rShiftTo(l,r),c<0&&n.ZERO.subTo(r,r)}}},n.prototype.invDigit=function(){if(this.t<1)return 0;var e=this[0];if(!(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},n.prototype.isEven=function(){return 0===(this.t>0?1&this[0]:this.s)},n.prototype.exp=function(e,t){if(e>4294967295||e<1)return n.ONE;var r=o(),i=o(),a=t.convert(this),s=p(e)-1;for(a.copyTo(r);--s>=0;)if(t.sqrTo(r,i),(e&1<<s)>0)t.mulTo(i,a,r);else{var c=r;r=i,i=c}return t.revert(r)},n.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},n.prototype.toRadix=function(e){if(null==e&&(e=10),0===this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),i=d(r),n=o(),a=o(),s="";for(this.divRemTo(i,n,a);n.signum()>0;)s=(r+a.intValue()).toString(e).substr(1)+s,n.divRemTo(i,n,a);return a.intValue().toString(e)+s},n.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var r=this.chunkSize(t),i=Math.pow(t,r),o=!1,a=0,s=0,c=0;c<e.length;++c){var u=h(e,c);u<0?"-"==e.charAt(c)&&0===this.signum()&&(o=!0):(s=t*s+u,++a>=r&&(this.dMultiply(i),this.dAddOffset(s,0),a=0,s=0))}a>0&&(this.dMultiply(Math.pow(t,a)),this.dAddOffset(s,0)),o&&n.ZERO.subTo(this,this)},n.prototype.fromNumber=function(e,t){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e),this.testBit(e-1)||this.bitwiseTo(n.ONE.shiftLeft(e-1),v,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(n.ONE.shiftLeft(e-1),this);else{var r=i.randomBytes(1+(e>>3)),o=7&e;o>0?r[0]&=(1<<o)-1:r[0]=0,this.fromByteArray(r)}},n.prototype.bitwiseTo=function(e,t,r){var i,n,o=Math.min(e.t,this.t);for(i=0;i<o;++i)r[i]=t(this[i],e[i]);if(e.t<this.t){for(n=e.s&this.DM,i=o;i<this.t;++i)r[i]=t(this[i],n);r.t=this.t}else{for(n=this.s&this.DM,i=o;i<e.t;++i)r[i]=t(n,e[i]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},n.prototype.changeBit=function(e,t){var r=n.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r},n.prototype.addTo=function(e,t){for(var r=0,i=0,n=Math.min(e.t,this.t);r<n;)i+=this[r]+e[r],t[r++]=i&this.DM,i>>=this.DB;if(e.t<this.t){for(i+=e.s;r<this.t;)i+=this[r],t[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<e.t;)i+=e[r],t[r++]=i&this.DM,i>>=this.DB;i+=e.s}t.s=i<0?-1:0,i>0?t[r++]=i:i<-1&&(t[r++]=this.DV+i),t.t=r,t.clamp()},n.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},n.prototype.dAddOffset=function(e,t){if(0!==e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}},n.prototype.multiplyLowerTo=function(e,t,r){var i,n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r[--n]=0;for(i=r.t-this.t;n<i;++n)r[n+this.t]=this.am(0,e[n],r,n,0,this.t);for(i=Math.min(e.t,t);n<i;++n)this.am(0,e[n],r,n,0,t-n);r.clamp()},n.prototype.multiplyUpperTo=function(e,t,r){--t;var i=r.t=this.t+e.t-t;for(r.s=0;--i>=0;)r[i]=0;for(i=Math.max(t-this.t,0);i<e.t;++i)r[this.t+i-t]=this.am(t-i,e[i],r,0,0,this.t+i-t);r.clamp(),r.drShiftTo(1,r)},n.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0===t)r=this[0]%e;else for(var i=this.t-1;i>=0;--i)r=(t*r+this[i])%e;return r},n.prototype.millerRabin=function(e){var t=this.subtract(n.ONE),r=t.getLowestSetBit();if(r<=0)return!1;var i=t.shiftRight(r);(e=e+1>>1)>I.length&&(e=I.length);for(var a=o(),s=0;s<e;++s){a.fromInt(I[Math.floor(Math.random()*I.length)]);var c=a.modPow(i,this);if(0!=c.compareTo(n.ONE)&&0!=c.compareTo(t)){for(var u=1;u++<r&&0!=c.compareTo(t);)if(0===(c=c.modPowInt(2,this)).compareTo(n.ONE))return!1;if(0!=c.compareTo(t))return!1}}return!0},n.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,i=(1<<t)-1,n=!1,o="",a=this.t,s=this.DB-a*this.DB%t;if(a-- >0)for(s<this.DB&&(r=this[a]>>s)>0&&(n=!0,o=l(r));a>=0;)s<t?(r=(this[a]&(1<<s)-1)<<t-s,r|=this[--a]>>(s+=this.DB-t)):(r=this[a]>>(s-=t)&i,s<=0&&(s+=this.DB,--a)),r>0&&(n=!0),n&&(o+=l(r));
//! Fix to be compatible with node >0.12.7 Buffer.js
return 16==e&&o.length%2!=0&&(o="0"+o),n?o:"0"},n.prototype.negate=function(){var e=o();return n.ZERO.subTo(this,e),e},n.prototype.abs=function(){return this.s<0?this.negate():this},n.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this[r]-e[r]))return t;return 0},n.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+p(this[this.t-1]^this.s&this.DM)},n.prototype.mod=function(e){var t=o();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(n.ZERO)>0&&e.subTo(t,t),t},n.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new f(t):new g(t),this.exp(e,r)},n.prototype.clone=function(){var e=o();return this.copyTo(e),e},n.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0===this.t)return-1}else{if(1==this.t)return this[0];if(0===this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},n.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},n.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},n.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},n.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var r,i=this.DB-e*this.DB%8,n=0;if(e-- >0)for(i<this.DB&&(r=this[e]>>i)!=(this.s&this.DM)>>i&&(t[n++]=r|this.s<<this.DB-i);e>=0;)i<8?(r=(this[e]&(1<<i)-1)<<8-i,r|=this[--e]>>(i+=this.DB-8)):(r=this[e]>>(i-=8)&255,i<=0&&(i+=this.DB,--e)),128&r&&(r|=-256),0===n&&(128&this.s)!=(128&r)&&++n,(n>0||r!=this.s)&&(t[n++]=r);return t},n.prototype.toBuffer=function(e){var t=Buffer.from(this.toByteArray());if(!0===e&&0===t[0])t=t.slice(1);else if("number"==typeof e){if(t.length>e){for(var r=0;r<t.length-e;r++)if(0!==t[r])return null;return t.slice(t.length-e)}if(t.length<e){var i=Buffer.alloc(e);return i.fill(0,0,e-t.length),t.copy(i,e-t.length),i}}return t},n.prototype.equals=function(e){return 0==this.compareTo(e)},n.prototype.eq=function(e){return console.log(this.compareTo(e)),0==this.compareTo(e)},n.prototype.gt=function(e){return this.compareTo(e)>0},n.prototype.gte=function(e){return this.compareTo(e)>=0},n.prototype.lt=function(e){return this.compareTo(e)<0},n.prototype.lte=function(e){return this.compareTo(e)<=0},n.prototype.min=function(e){return this.compareTo(e)<0?this:e},n.prototype.max=function(e){return this.compareTo(e)>0?this:e},n.prototype.and=function(e){var t=o();return this.bitwiseTo(e,m,t),t},n.prototype.or=function(e){var t=o();return this.bitwiseTo(e,v,t),t},n.prototype.xor=function(e){var t=o();return this.bitwiseTo(e,y,t),t},n.prototype.andNot=function(e){var t=o();return this.bitwiseTo(e,C,t),t},n.prototype.not=function(){for(var e=o(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e},n.prototype.shiftLeft=function(e){var t=o();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},n.prototype.shiftRight=function(e){var t=o();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},n.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+S(this[e]);return this.s<0?this.t*this.DB:-1},n.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=E(this[r]^t);return e},n.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:!!(this[t]&1<<e%this.DB)},n.prototype.setBit=function(e){return this.changeBit(e,v)},n.prototype.clearBit=function(e){return this.changeBit(e,C)},n.prototype.flipBit=function(e){return this.changeBit(e,y)},n.prototype.add=function(e){var t=o();return this.addTo(e,t),t},n.prototype.subtract=function(e){var t=o();return this.subTo(e,t),t},n.prototype.multiply=function(e){var t=o();return this.multiplyTo(e,t),t},n.prototype.divide=function(e){var t=o();return this.divRemTo(e,t,null),t},n.prototype.remainder=function(e){var t=o();return this.divRemTo(e,null,t),t},n.prototype.divideAndRemainder=function(e){var t=o(),r=o();return this.divRemTo(e,t,r),new Array(t,r)},n.prototype.modPow=function(e,t){var r,i,n=e.bitLength(),a=d(1);if(n<=0)return a;r=n<18?1:n<48?3:n<144?4:n<768?5:6,i=n<8?new f(t):t.isEven()?new A(t):new g(t);var s=new Array,c=3,u=r-1,l=(1<<r)-1;if(s[1]=i.convert(this),r>1){var h=o();for(i.sqrTo(s[1],h);c<=l;)s[c]=o(),i.mulTo(h,s[c-2],s[c]),c+=2}var m,v,y=e.t-1,C=!0,S=o();for(n=p(e[y])-1;y>=0;){for(n>=u?m=e[y]>>n-u&l:(m=(e[y]&(1<<n+1)-1)<<u-n,y>0&&(m|=e[y-1]>>this.DB+n-u)),c=r;!(1&m);)m>>=1,--c;if((n-=c)<0&&(n+=this.DB,--y),C)s[m].copyTo(a),C=!1;else{for(;c>1;)i.sqrTo(a,S),i.sqrTo(S,a),c-=2;c>0?i.sqrTo(a,S):(v=a,a=S,S=v),i.mulTo(S,s[m],a)}for(;y>=0&&!(e[y]&1<<n);)i.sqrTo(a,S),v=a,a=S,S=v,--n<0&&(n=this.DB-1,--y)}return i.revert(a)},n.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0===e.signum())return n.ZERO;for(var r=e.clone(),i=this.clone(),o=d(1),a=d(0),s=d(0),c=d(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(o.isEven()&&a.isEven()||(o.addTo(this,o),a.subTo(e,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);for(;i.isEven();)i.rShiftTo(1,i),t?(s.isEven()&&c.isEven()||(s.addTo(this,s),c.subTo(e,c)),s.rShiftTo(1,s)):c.isEven()||c.subTo(e,c),c.rShiftTo(1,c);r.compareTo(i)>=0?(r.subTo(i,r),t&&o.subTo(s,o),a.subTo(c,a)):(i.subTo(r,i),t&&s.subTo(o,s),c.subTo(a,c))}return 0!=i.compareTo(n.ONE)?n.ZERO:c.compareTo(e)>=0?c.subtract(e):c.signum()<0?(c.addTo(e,c),c.signum()<0?c.add(e):c):c},n.prototype.pow=function(e){return this.exp(e,new _)},n.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var i=t;t=r,r=i}var n=t.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return t;for(n<o&&(o=n),o>0&&(t.rShiftTo(o,t),r.rShiftTo(o,r));t.signum()>0;)(n=t.getLowestSetBit())>0&&t.rShiftTo(n,t),(n=r.getLowestSetBit())>0&&r.rShiftTo(n,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r},n.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r[0]<=I[I.length-1]){for(t=0;t<I.length;++t)if(r[0]==I[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<I.length;){for(var i=I[t],n=t+1;n<I.length&&i<D;)i*=I[n++];for(i=r.modInt(i);t<n;)if(i%I[t++]==0)return!1}return r.millerRabin(e)},n.int2char=l,n.ZERO=d(0),n.ONE=d(1),n.prototype.square=function(){var e=o();return this.squareTo(e),e},e.exports=n},1799:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.params=t.hex=void 0;const i=r(2986);function n(e){return new i(e.split(/\s|\n/).join(""),16)}t.hex=n,t.params={1024:{N_length_bits:1024,N:n("\n      EEAF0AB9 ADB38DD6 9C33F80A FA8FC5E8 60726187 75FF3C0B 9EA2314C\n      9C256576 D674DF74 96EA81D3 383B4813 D692C6E0 E0D5D8E2 50B98BE4\n      8E495C1D 6089DAD1 5DC7D7B4 6154D6B6 CE8EF4AD 69B15D49 82559B29\n      7BCF1885 C529F566 660E57EC 68EDBC3C 05726CC0 2FD4CBF4 976EAA9A\n      FD5138FE 8376435B 9FC61D2F C0EB06E3\n    "),g:n("02"),hash:"sha1"},1536:{N_length_bits:1536,N:n("\n      9DEF3CAF B939277A B1F12A86 17A47BBB DBA51DF4 99AC4C80 BEEEA961\n      4B19CC4D 5F4F5F55 6E27CBDE 51C6A94B E4607A29 1558903B A0D0F843\n      80B655BB 9A22E8DC DF028A7C EC67F0D0 8134B1C8 B9798914 9B609E0B\n      E3BAB63D 47548381 DBC5B1FC 764E3F4B 53DD9DA1 158BFD3E 2B9C8CF5\n      6EDF0195 39349627 DB2FD53D 24B7C486 65772E43 7D6C7F8C E442734A\n      F7CCB7AE 837C264A E3A9BEB8 7F8A2FE9 B8B5292E 5A021FFF 5E91479E\n      8CE7A28C 2442C6F3 15180F93 499A234D CF76E3FE D135F9BB\n    "),g:n("02"),hash:"sha1"},2048:{N_length_bits:2048,N:n("\n      AC6BDB41 324A9A9B F166DE5E 1389582F AF72B665 1987EE07 FC319294\n      3DB56050 A37329CB B4A099ED 8193E075 7767A13D D52312AB 4B03310D\n      CD7F48A9 DA04FD50 E8083969 EDB767B0 CF609517 9A163AB3 661A05FB\n      D5FAAAE8 2918A996 2F0B93B8 55F97993 EC975EEA A80D740A DBF4FF74\n      7359D041 D5C33EA7 1D281E44 6B14773B CA97B43A 23FB8016 76BD207A\n      436C6481 F1D2B907 8717461A 5B9D32E6 88F87748 544523B5 24B0D57D\n      5EA77A27 75D2ECFA 032CFBDB F52FB378 61602790 04E57AE6 AF874E73\n      03CE5329 9CCC041C 7BC308D8 2A5698F3 A8D0C382 71AE35F8 E9DBFBB6\n      94B5C803 D89F7AE4 35DE236D 525F5475 9B65E372 FCD68EF2 0FA7111F\n      9E4AFF73\n    "),g:n("02"),hash:"sha256"},3072:{N_length_bits:3072,N:n("\n      FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 29024E08\n      8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD EF9519B3 CD3A431B\n      302B0A6D F25F1437 4FE1356D 6D51C245 E485B576 625E7EC6 F44C42E9\n      A637ED6B 0BFF5CB6 F406B7ED EE386BFB 5A899FA5 AE9F2411 7C4B1FE6\n      49286651 ECE45B3D C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8\n      FD24CF5F 83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D\n      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B E39E772C\n      180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9 DE2BCBF6 95581718\n      3995497C EA956AE5 15D22618 98FA0510 15728E5A 8AAAC42D AD33170D\n      04507A33 A85521AB DF1CBA64 ECFB8504 58DBEF0A 8AEA7157 5D060C7D\n      B3970F85 A6E1E4C7 ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226\n      1AD2EE6B F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C\n      BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31 43DB5BFC\n      E0FD108E 4B82D120 A93AD2CA FFFFFFFF FFFFFFFF\n    "),g:n("05"),hash:"sha256"},hap:{N_length_bits:3072,N:n("\n      FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 29024E08\n      8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD EF9519B3 CD3A431B\n      302B0A6D F25F1437 4FE1356D 6D51C245 E485B576 625E7EC6 F44C42E9\n      A637ED6B 0BFF5CB6 F406B7ED EE386BFB 5A899FA5 AE9F2411 7C4B1FE6\n      49286651 ECE45B3D C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8\n      FD24CF5F 83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D\n      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B E39E772C\n      180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9 DE2BCBF6 95581718\n      3995497C EA956AE5 15D22618 98FA0510 15728E5A 8AAAC42D AD33170D\n      04507A33 A85521AB DF1CBA64 ECFB8504 58DBEF0A 8AEA7157 5D060C7D\n      B3970F85 A6E1E4C7 ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226\n      1AD2EE6B F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C\n      BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31 43DB5BFC\n      E0FD108E 4B82D120 A93AD2CA FFFFFFFF FFFFFFFF\n    "),g:n("05"),hash:"sha512"},4096:{N_length_bits:4096,N:n("\n      FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 29024E08\n      8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD EF9519B3 CD3A431B\n      302B0A6D F25F1437 4FE1356D 6D51C245 E485B576 625E7EC6 F44C42E9\n      A637ED6B 0BFF5CB6 F406B7ED EE386BFB 5A899FA5 AE9F2411 7C4B1FE6\n      49286651 ECE45B3D C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8\n      FD24CF5F 83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D\n      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B E39E772C\n      180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9 DE2BCBF6 95581718\n      3995497C EA956AE5 15D22618 98FA0510 15728E5A 8AAAC42D AD33170D\n      04507A33 A85521AB DF1CBA64 ECFB8504 58DBEF0A 8AEA7157 5D060C7D\n      B3970F85 A6E1E4C7 ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226\n      1AD2EE6B F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C\n      BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31 43DB5BFC\n      E0FD108E 4B82D120 A9210801 1A723C12 A787E6D7 88719A10 BDBA5B26\n      99C32718 6AF4E23C 1A946834 B6150BDA 2583E9CA 2AD44CE8 DBBBC2DB\n      04DE8EF9 2E8EFC14 1FBECAA6 287C5947 4E6BC05D 99B2964F A090C3A2\n      233BA186 515BE7ED 1F612970 CEE2D7AF B81BDD76 2170481C D0069127\n      D5B05AA9 93B4EA98 8D8FDDC1 86FFB7DC 90A6C08F 4DF435C9 34063199\n      FFFFFFFF FFFFFFFF\n    "),g:n("05"),hash:"sha256"},6244:{N_length_bits:6244,N:n("\n      FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 29024E08\n      8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD EF9519B3 CD3A431B\n      302B0A6D F25F1437 4FE1356D 6D51C245 E485B576 625E7EC6 F44C42E9\n      A637ED6B 0BFF5CB6 F406B7ED EE386BFB 5A899FA5 AE9F2411 7C4B1FE6\n      49286651 ECE45B3D C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8\n      FD24CF5F 83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D\n      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B E39E772C\n      180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9 DE2BCBF6 95581718\n      3995497C EA956AE5 15D22618 98FA0510 15728E5A 8AAAC42D AD33170D\n      04507A33 A85521AB DF1CBA64 ECFB8504 58DBEF0A 8AEA7157 5D060C7D\n      B3970F85 A6E1E4C7 ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226\n      1AD2EE6B F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C\n      BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31 43DB5BFC\n      E0FD108E 4B82D120 A9210801 1A723C12 A787E6D7 88719A10 BDBA5B26\n      99C32718 6AF4E23C 1A946834 B6150BDA 2583E9CA 2AD44CE8 DBBBC2DB\n      04DE8EF9 2E8EFC14 1FBECAA6 287C5947 4E6BC05D 99B2964F A090C3A2\n      233BA186 515BE7ED 1F612970 CEE2D7AF B81BDD76 2170481C D0069127\n      D5B05AA9 93B4EA98 8D8FDDC1 86FFB7DC 90A6C08F 4DF435C9 34028492\n      36C3FAB4 D27C7026 C1D4DCB2 602646DE C9751E76 3DBA37BD F8FF9406\n      AD9E530E E5DB382F 413001AE B06A53ED 9027D831 179727B0 865A8918\n      DA3EDBEB CF9B14ED 44CE6CBA CED4BB1B DB7F1447 E6CC254B 33205151\n      2BD7AF42 6FB8F401 378CD2BF 5983CA01 C64B92EC F032EA15 D1721D03\n      F482D7CE 6E74FEF6 D55E702F 46980C82 B5A84031 900B1C9E 59E7C97F\n      BEC7E8F3 23A97A7E 36CC88BE 0F1D45B7 FF585AC5 4BD407B2 2B4154AA\n      CC8F6D7E BF48E1D8 14CC5ED2 0F8037E0 A79715EE F29BE328 06A1D58B\n      B7C5DA76 F550AA3D 8A1FBFF0 EB19CCB1 A313D55C DA56C9EC 2EF29632\n      387FE8D7 6E3C0468 043E8F66 3F4860EE 12BF2D5B 0B7474D6 E694F91E\n      6DCC4024 FFFFFFFF FFFFFFFF\n    "),g:n("05"),hash:"sha256"},8192:{N_length_bits:8192,N:n("\n      FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 29024E08\n      8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD EF9519B3 CD3A431B\n      302B0A6D F25F1437 4FE1356D 6D51C245 E485B576 625E7EC6 F44C42E9\n      A637ED6B 0BFF5CB6 F406B7ED EE386BFB 5A899FA5 AE9F2411 7C4B1FE6\n      49286651 ECE45B3D C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8\n      FD24CF5F 83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D\n      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B E39E772C\n      180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9 DE2BCBF6 95581718\n      3995497C EA956AE5 15D22618 98FA0510 15728E5A 8AAAC42D AD33170D\n      04507A33 A85521AB DF1CBA64 ECFB8504 58DBEF0A 8AEA7157 5D060C7D\n      B3970F85 A6E1E4C7 ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226\n      1AD2EE6B F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C\n      BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31 43DB5BFC\n      E0FD108E 4B82D120 A9210801 1A723C12 A787E6D7 88719A10 BDBA5B26\n      99C32718 6AF4E23C 1A946834 B6150BDA 2583E9CA 2AD44CE8 DBBBC2DB\n      04DE8EF9 2E8EFC14 1FBECAA6 287C5947 4E6BC05D 99B2964F A090C3A2\n      233BA186 515BE7ED 1F612970 CEE2D7AF B81BDD76 2170481C D0069127\n      D5B05AA9 93B4EA98 8D8FDDC1 86FFB7DC 90A6C08F 4DF435C9 34028492\n      36C3FAB4 D27C7026 C1D4DCB2 602646DE C9751E76 3DBA37BD F8FF9406\n      AD9E530E E5DB382F 413001AE B06A53ED 9027D831 179727B0 865A8918\n      DA3EDBEB CF9B14ED 44CE6CBA CED4BB1B DB7F1447 E6CC254B 33205151\n      2BD7AF42 6FB8F401 378CD2BF 5983CA01 C64B92EC F032EA15 D1721D03\n      F482D7CE 6E74FEF6 D55E702F 46980C82 B5A84031 900B1C9E 59E7C97F\n      BEC7E8F3 23A97A7E 36CC88BE 0F1D45B7 FF585AC5 4BD407B2 2B4154AA\n      CC8F6D7E BF48E1D8 14CC5ED2 0F8037E0 A79715EE F29BE328 06A1D58B\n      B7C5DA76 F550AA3D 8A1FBFF0 EB19CCB1 A313D55C DA56C9EC 2EF29632\n      387FE8D7 6E3C0468 043E8F66 3F4860EE 12BF2D5B 0B7474D6 E694F91E\n      6DBE1159 74A3926F 12FEE5E4 38777CB6 A932DF8C D8BEC4D0 73B931BA\n      3BC832B6 8D9DD300 741FA7BF 8AFC47ED 2576F693 6BA42466 3AAB639C\n      5AE4F568 3423B474 2BF1C978 238F16CB E39D652D E3FDB8BE FC848AD9\n      22222E04 A4037C07 13EB57A8 1A23F0C7 3473FC64 6CEA306B 4BCBC886\n      2F8385DD FA9D4B7F A2C087E8 79683303 ED5BDD3A 062B3CF5 B3A278A6\n      6D2A13F8 3F44F82D DF310EE0 74AB6A36 4597E899 A0255DC1 64F31CC5\n      0846851D F9AB4819 5DED7EA1 B1D510BD 7EE74D73 FAF36BC3 1ECFA268\n      359046F4 EB879F92 4009438B 481C6CD7 889A002E D5EE382B C9190DA6\n      FC026E47 9558E447 5677E9AA 9E3050E2 765694DF C81F56E8 80B96E71\n      60C980DD 98EDD3DF FFFFFFFF FFFFFFFF\n    "),g:n("13"),hash:"sha256"}},t.default=t.params},4618:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SrpServer=t.SrpClient=t.SRP=void 0;const n=i(r(6982)),o=i(r(2613)),a=r(2986),s=r(1799),c=new a(0,10);function u(e,t){if(!e)throw new Error(t||"assertion")}function l(e,t="arg"){u(Buffer.isBuffer(e),`Type error: ${t} must be a buffer`)}function h(e,t="arg"){u(e instanceof a,`Type error: ${t} must be a BigInteger`)}function d(e,t){l(e,"n");const r=t-e.length;u(r>-1,"Negative padding.  Very uncomfortable.");const i=Buffer.alloc(t);return i.fill(0,0,r),e.copy(i,r),o.default.strictEqual(i.length,t),i}function p(e,t){h(e);const r=e.toString(16).length%2!=0?"0"+e.toString(16):e.toString(16);return d(Buffer.from(r,"hex"),t.N_length_bits/8)}function f(e,t,r,i){l(t,"salt (salt)"),l(r,"identity (I)"),l(i,"password (P)");const o=n.default.createHash(e.hash).update(Buffer.concat([r,Buffer.from(":"),i])).digest(),s=n.default.createHash(e.hash).update(t).update(o).digest();return new a(s)}class g{static computeVerifier(e,t,r,i){l(t,"salt (salt)"),l(r,"identity (I)"),l(i,"password (P)");return e.g.modPow(f(e,t,r,i),e.N).toBuffer(e.N_length_bits/8)}static genKey(e=32,t){if("number"!=typeof e&&(t=e,e=32),!t)return new Promise(((t,r)=>g.genKey(e,((e,i)=>e?r(e):t(i)))));n.default.randomBytes(e,((e,r)=>e?t(e,null):t(null,r)))}}function m(e){const t=n.default.createHash(e.hash).update(p(e.N,e)).update(p(e.g,e)).digest();return new a(t)}function v(e,t,r){l(t,"A"),l(r,"B");const i=n.default.createHash(e.hash).update(d(t,e.N_length_bits/8)).update(d(r,e.N_length_bits/8)).digest();return new a(i)}function y(e,t){return l(t,"S"),"sha1"===e.hash?Buffer.concat([n.default.createHash(e.hash).update(t).update(Buffer.from([0,0,0,0])).digest(),n.default.createHash(e.hash).update(t).update(Buffer.from([0,0,0,1])).digest()]):n.default.createHash(e.hash).update(t).digest()}function C(e,t,r,i,o,a){if(arguments.length>4){l(t,"identity (I)"),l(r,"salt (s)"),l(i,"client public key (A)"),l(o,"server public key (B)"),l(a,"session key (K)");const s=n.default.createHash(e.hash).update(e.N.toBuffer(!0)).digest(),c=n.default.createHash(e.hash).update(e.g.toBuffer(!0)).digest();for(let e=0;e<s.length;e++)s[e]^=c[e];const u=n.default.createHash(e.hash).update(t).digest();return n.default.createHash(e.hash).update(s).update(u).update(r).update(i).update(o).update(a).digest()}return[i,o,r]=[t,r,i],l(i,"A"),l(o,"B"),l(r,"S"),n.default.createHash(e.hash).update(i).update(o).update(r).digest()}function S(e,t,r,i){return l(t,"A"),l(r,"M1"),l(i,"K"),n.default.createHash(e.hash).update(t).update(r).update(i).digest()}function E(e,t){return e.toString("hex")===t.toString("hex")}t.SRP=g,g.params=s.params;t.SrpClient=class{constructor(e,t,r,i,n,o=!0){l(t,"salt (s)"),l(r,"identity (I)"),l(i,"password (P)"),l(n,"secret1"),this._params=e,this._k=m(e),this._x=f(e,t,r,i),this._a=new a(n),o&&(this._I=r,this._s=t),this._A=function(e,t){return h(t),Math.ceil(t.toString(16).length/2)<32&&console.warn("getA: client key length %d is less than the recommended 256 bits",t.bitLength()),e.g.modPow(t,e.N).toBuffer(e.N_length_bits/8)}(e,this._a)}computeA(){return this._A}setB(e){const t=v(this._params,this._A,e),r=function(e,t,r,i,n,o){if(h(t),h(r),h(i),h(n),h(o),c.compareTo(n)>=0||e.N.compareTo(n)<=0)throw new Error('invalid server-supplied "B", must be 1..N-1');return n.subtract(t.multiply(e.g.modPow(r,e.N))).modPow(i.add(o.multiply(r)),e.N).mod(e.N).toBuffer(e.N_length_bits/8)}(this._params,this._k,this._x,this._a,new a(e),t);this._K=y(this._params,r),this._u=t,this._S=r,this._B=e,this._I&&this._s?this._M1=C(this._params,this._I,this._s,this._A,this._B,this._K):this._M1=C(this._params,this._A,this._B,this._S),this._M2=S(this._params,this._A,this._M1,this._K)}computeM1(){if(void 0===this._M1)throw new Error("incomplete protocol");return this._M1}checkM2(e){if(!E(this._M2,e))throw new Error("server is not authentic")}computeK(){if(void 0===this._K)throw new Error("incomplete protocol");return this._K}};t.SrpServer=class{constructor(e,t,r,i,n){if(this._params=e,this._k=m(e),arguments.length>3)l(t,"salt (salt)"),l(r,"identity (I)"),l(i,"password (P)"),l(n,"secret2"),this._b=new a(n),this._v=new a(g.computeVerifier(e,t,r,i)),this._I=r,this._s=t;else if(t instanceof Buffer){const e=t;[n,t,r,i]=[r,void 0,void 0,void 0],l(e,"verifier (v)"),l(n,"secret2"),this._b=new a(n),this._v=new a(e)}else{const s=t;[n,t,r,i]=[r,void 0,void 0,void 0],(0,o.default)(s.username instanceof Buffer||"string"==typeof s.username,"identity.username (I) must be a string or Buffer"),l(s.salt,"identity.salt (s)"),(0,o.default)("password"in s||"verifier"in s,"identity requires a password or verifier"),"verifier"in s?l(s.verifier,"identity.verifier (v)"):(0,o.default)(s.password instanceof Buffer||"string"==typeof s.password,"identity.password (p) must be a string or Buffer"),l(n,"secret2");const c="string"==typeof s.username?Buffer.from(s.username):s.username;this._b=new a(n),this._v=new a("verifier"in s?s.verifier:g.computeVerifier(e,s.salt,c,"string"==typeof s.password?Buffer.from(s.password):s.password)),this._I=c,this._s=s.salt}this._B=function(e,t,r,i){return h(r),h(t),h(i),t.multiply(r).add(e.g.modPow(i,e.N)).mod(e.N).toBuffer(e.N_length_bits/8)}(e,this._k,this._v,this._b)}computeB(){return this._B}setA(e){const t=v(this._params,e,this._B),r=function(e,t,r,i,n){if(h(t),h(r),h(i),h(n),c.compareTo(r)>=0||e.N.compareTo(r)<=0)throw new Error('invalid client-supplied "A", must be 1..N-1');return r.multiply(t.modPow(n,e.N)).modPow(i,e.N).mod(e.N).toBuffer(e.N_length_bits/8)}(this._params,this._v,new a(e),this._b,t);this._K=y(this._params,r),this._u=t,this._S=r,this._I&&this._s?this._M1=C(this._params,this._I,this._s,e,this._B,this._K):this._M1=C(this._params,e,this._B,this._S),this._M2=S(this._params,e,this._M1,this._K)}checkM1(e){if(void 0===this._M1)throw new Error("incomplete protocol");if(!E(this._M1,e))throw new Error("client did not use the same password")}computeK(){if(void 0===this._K)throw new Error("incomplete protocol");return this._K}computeM2(){if(void 0===this._M2)throw new Error("incomplete protocol");return this._M2}}},2682:(e,t,r)=>{"use strict";var i=r(9600),n=Object.prototype.toString,o=Object.prototype.hasOwnProperty;e.exports=function(e,t,r){if(!i(t))throw new TypeError("iterator must be a function");var a;arguments.length>=3&&(a=r),"[object Array]"===n.call(e)?function(e,t,r){for(var i=0,n=e.length;i<n;i++)o.call(e,i)&&(null==r?t(e[i],i,e):t.call(r,e[i],i,e))}(e,t,a):"string"==typeof e?function(e,t,r){for(var i=0,n=e.length;i<n;i++)null==r?t(e.charAt(i),i,e):t.call(r,e.charAt(i),i,e)}(e,t,a):function(e,t,r){for(var i in e)o.call(e,i)&&(null==r?t(e[i],i,e):t.call(r,e[i],i,e))}(e,t,a)}},1813:(e,t,r)=>{"use strict";var i=r(2203);e.exports=function e(t){if(Array.isArray(t)){var r=0,n=t.length;return e((function(e){return r<n?this.emit("data",t[r++]):this.emit("end"),!0}))}var o=new i,a=0;function s(){if(o.started=!0,!o.ended)for(;!o.ended&&!o.paused&&t.call(o,a++,(function(){o.ended||o.paused||process.nextTick(s)})););}return o.ended=!1,o.started=!1,o.readable=!0,o.writable=!1,o.paused=!1,o.ended=!1,o.pause=function(){o.started=!0,o.paused=!0},o.resume=function(){o.started=!0,o.paused=!1,s()},o.on("end",(function(){o.ended=!0,o.readable=!1,process.nextTick(o.destroy)})),o.destroy=function(){o.ended=!0,o.emit("close")},process.nextTick((function(){o.started||o.resume()})),o}},9353:e=>{"use strict";var t=Object.prototype.toString,r=Math.max,i=function(e,t){for(var r=[],i=0;i<e.length;i+=1)r[i]=e[i];for(var n=0;n<t.length;n+=1)r[n+e.length]=t[n];return r};e.exports=function(e){var n=this;if("function"!=typeof n||"[object Function]"!==t.apply(n))throw new TypeError("Function.prototype.bind called on incompatible "+n);for(var o,a=function(e,t){for(var r=[],i=t||0,n=0;i<e.length;i+=1,n+=1)r[n]=e[i];return r}(arguments,1),s=r(0,n.length-a.length),c=[],u=0;u<s;u++)c[u]="$"+u;if(o=Function("binder","return function ("+function(e,t){for(var r="",i=0;i<e.length;i+=1)r+=e[i],i+1<e.length&&(r+=t);return r}(c,",")+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof o){var t=n.apply(this,i(a,arguments));return Object(t)===t?t:this}return n.apply(e,i(a,arguments))})),n.prototype){var l=function(){};l.prototype=n.prototype,o.prototype=new l,l.prototype=null}return o}},6743:(e,t,r)=>{"use strict";var i=r(9353);e.exports=Function.prototype.bind||i},4462:e=>{"use strict";var t=function(){return"string"==typeof function(){}.name},r=Object.getOwnPropertyDescriptor;if(r)try{r([],"length")}catch(e){r=null}t.functionsHaveConfigurableNames=function(){if(!t()||!r)return!1;var e=r((function(){}),"name");return!!e&&!!e.configurable};var i=Function.prototype.bind;t.boundFunctionsHaveNames=function(){return t()&&"function"==typeof i&&""!==function(){}.bind().name},e.exports=t},6871:(e,t,r)=>{"use strict";const{Buffer:i}=r(181),{createHash:n,createHmac:o}=r(6982),a={},s=e=>{switch(e){case"sha256":case"sha3-256":case"blake2s256":return 32;case"sha512":case"sha3-512":case"blake2b512":return 64;case"sha224":case"sha3-224":return 28;case"sha384":case"sha3-384":return 48;case"sha1":return 20;case"md5":return 16;default:{let t=a[e];return void 0===t&&(t=n(e).digest().length,a[e]=t),t}}},c=(e,t,r,n)=>{const a=i.isBuffer(r)?r:i.from(r),s=n&&n.length?i.from(n):i.alloc(t,0);return o(e,s).update(a).digest()},u=(e,t,r,n,a)=>{const s=i.isBuffer(a)?a:i.from(a||""),c=s.length,u=Math.ceil(n/t);if(u>255)throw new Error(`OKM length ${n} is too long for ${e} hash`);const l=i.alloc(t*u+c+1);for(let i=1,n=0,a=0;i<=u;++i)s.copy(l,a),l[a+c]=i,o(e,r).update(l.slice(n,a+c+1)).digest().copy(l,a),n=a,a+=t;return l.slice(0,n)};function l(e,t,{salt:r="",info:i="",hash:n="SHA-256"}={}){n=n.toLowerCase().replace("-","");const o=s(n),a=c(n,o,e,r);return u(n,o,a,t,i)}Object.defineProperties(l,{hash_length:{configurable:!1,enumerable:!1,writable:!1,value:s},extract:{configurable:!1,enumerable:!1,writable:!1,value:c},expand:{configurable:!1,enumerable:!1,writable:!1,value:u}}),e.exports=l},453:(e,t,r)=>{"use strict";var i,n=r(9383),o=r(1237),a=r(9290),s=r(9538),c=r(8068),u=r(9675),l=r(5345),h=Function,d=function(e){try{return h('"use strict"; return ('+e+").constructor;")()}catch(e){}},p=Object.getOwnPropertyDescriptor;if(p)try{p({},"")}catch(e){p=null}var f=function(){throw new u},g=p?function(){try{return f}catch(e){try{return p(arguments,"callee").get}catch(e){return f}}}():f,m=r(4039)(),v=r(24)(),y=Object.getPrototypeOf||(v?function(e){return e.__proto__}:null),C={},S="undefined"!=typeof Uint8Array&&y?y(Uint8Array):i,E={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?i:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?i:ArrayBuffer,"%ArrayIteratorPrototype%":m&&y?y([][Symbol.iterator]()):i,"%AsyncFromSyncIteratorPrototype%":i,"%AsyncFunction%":C,"%AsyncGenerator%":C,"%AsyncGeneratorFunction%":C,"%AsyncIteratorPrototype%":C,"%Atomics%":"undefined"==typeof Atomics?i:Atomics,"%BigInt%":"undefined"==typeof BigInt?i:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?i:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?i:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?i:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":n,"%eval%":eval,"%EvalError%":o,"%Float32Array%":"undefined"==typeof Float32Array?i:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?i:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?i:FinalizationRegistry,"%Function%":h,"%GeneratorFunction%":C,"%Int8Array%":"undefined"==typeof Int8Array?i:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?i:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?i:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":m&&y?y(y([][Symbol.iterator]())):i,"%JSON%":"object"==typeof JSON?JSON:i,"%Map%":"undefined"==typeof Map?i:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&m&&y?y((new Map)[Symbol.iterator]()):i,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?i:Promise,"%Proxy%":"undefined"==typeof Proxy?i:Proxy,"%RangeError%":a,"%ReferenceError%":s,"%Reflect%":"undefined"==typeof Reflect?i:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?i:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&m&&y?y((new Set)[Symbol.iterator]()):i,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?i:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":m&&y?y(""[Symbol.iterator]()):i,"%Symbol%":m?Symbol:i,"%SyntaxError%":c,"%ThrowTypeError%":g,"%TypedArray%":S,"%TypeError%":u,"%Uint8Array%":"undefined"==typeof Uint8Array?i:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?i:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?i:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?i:Uint32Array,"%URIError%":l,"%WeakMap%":"undefined"==typeof WeakMap?i:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?i:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?i:WeakSet};if(y)try{null.error}catch(e){var _=y(y(e));E["%Error.prototype%"]=_}var T=function e(t){var r;if("%AsyncFunction%"===t)r=d("async function () {}");else if("%GeneratorFunction%"===t)r=d("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=d("async function* () {}");else if("%AsyncGenerator%"===t){var i=e("%AsyncGeneratorFunction%");i&&(r=i.prototype)}else if("%AsyncIteratorPrototype%"===t){var n=e("%AsyncGenerator%");n&&y&&(r=y(n.prototype))}return E[t]=r,r},A={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},I=r(6743),D=r(9957),w=I.call(Function.call,Array.prototype.concat),b=I.call(Function.apply,Array.prototype.splice),U=I.call(Function.call,String.prototype.replace),R=I.call(Function.call,String.prototype.slice),O=I.call(Function.call,RegExp.prototype.exec),N=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,P=/\\(\\)?/g,B=function(e,t){var r,i=e;if(D(A,i)&&(i="%"+(r=A[i])[0]+"%"),D(E,i)){var n=E[i];if(n===C&&(n=T(i)),void 0===n&&!t)throw new u("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:i,value:n}}throw new c("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new u("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new u('"allowMissing" argument must be a boolean');if(null===O(/^%?[^%]*%?$/,e))throw new c("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=function(e){var t=R(e,0,1),r=R(e,-1);if("%"===t&&"%"!==r)throw new c("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new c("invalid intrinsic syntax, expected opening `%`");var i=[];return U(e,N,(function(e,t,r,n){i[i.length]=r?U(n,P,"$1"):t||e})),i}(e),i=r.length>0?r[0]:"",n=B("%"+i+"%",t),o=n.name,a=n.value,s=!1,l=n.alias;l&&(i=l[0],b(r,w([0,1],l)));for(var h=1,d=!0;h<r.length;h+=1){var f=r[h],g=R(f,0,1),m=R(f,-1);if(('"'===g||"'"===g||"`"===g||'"'===m||"'"===m||"`"===m)&&g!==m)throw new c("property names with quotes must have matching quotes");if("constructor"!==f&&d||(s=!0),D(E,o="%"+(i+="."+f)+"%"))a=E[o];else if(null!=a){if(!(f in a)){if(!t)throw new u("base intrinsic for "+e+" exists, but the property is not available.");return}if(p&&h+1>=r.length){var v=p(a,f);a=(d=!!v)&&"get"in v&&!("originalValue"in v.get)?v.get:a[f]}else d=D(a,f),a=a[f];d&&!s&&(E[o]=a)}}return a}},5795:(e,t,r)=>{"use strict";var i=r(453)("%Object.getOwnPropertyDescriptor%",!0);if(i)try{i([],"length")}catch(e){i=null}e.exports=i},135:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MANUFACTURER_CTYPE=t.LOGS_CTYPE=t.LOCK_MECHANISM_LAST_KNOWN_ACTION_CTYPE=t.LOCK_MANAGEMENT_CONTROL_POINT_CTYPE=t.LOCK_MANAGEMENT_AUTO_SECURE_TIMEOUT_CTYPE=t.IDENTIFY_CTYPE=t.HUE_CTYPE=t.HEATING_THRESHOLD_CTYPE=t.CURRENT_TEMPERATURE_CTYPE=t.CURRENT_RELATIVE_HUMIDITY_CTYPE=t.CURRENT_LOCK_MECHANISM_STATE_CTYPE=t.CURRENT_DOOR_STATE_CTYPE=t.CONTACT_SENSOR_STATE_CTYPE=t.COOLING_THRESHOLD_CTYPE=t.BATTERY_LEVEL_CTYPE=t.BRIGHTNESS_CTYPE=t.AUDIO_FEEDBACK_CTYPE=t.ADMIN_ONLY_ACCESS_CTYPE=t.ALARM_TARGET_STATE_CTYPE=t.ALARM_CURRENT_STATE_CTYPE=t.TEMPERATURE_SENSOR_STYPE=t.HUMIDITY_SENSOR_STYPE=t.MOTION_SENSOR_STYPE=t.CONTACT_SENSOR_STYPE=t.OCCUPANCY_SENSOR_STYPE=t.WINDOW_COVERING_STYPE=t.ALARM_STYPE=t.LOCK_MANAGEMENT_STYPE=t.LOCK_MECHANISM_STYPE=t.OUTLET_STYPE=t.FAN_STYPE=t.ACCESSORY_INFORMATION_STYPE=t.GARAGE_DOOR_OPENER_STYPE=t.THERMOSTAT_STYPE=t.SWITCH_STYPE=t.LIGHTBULB_STYPE=t.PROGRAMMABLE_SWITCH_TCTYPE=t.WINDOW_COVERING_TCTYPE=t.WINDOW_TCTYPE=t.DOOR_TCTYPE=t.ALARM_SYSTEM_TCTYPE=t.SENSOR_TCTYPE=t.THERMOSTAT_TCTYPE=t.SWITCH_TCTYPE=t.OUTLET_TCTYPE=t.DOOR_LOCK_TCTYPE=t.LIGHTBULB_TCTYPE=t.GARAGE_DOOR_OPENER_TCTYPE=t.FAN_TCTYPE=t.OTHER_TCTYPE=void 0,t.TARGETHEATINGCOOLING_CTYPE=t.CURRENTHEATINGCOOLING_CTYPE=t.WINDOW_COVERING_OPERATION_STATE_CTYPE=t.WINDOW_COVERING_CURRENT_POSITION_CTYPE=t.WINDOW_COVERING_TARGET_POSITION_CTYPE=t.VERSION_CTYPE=t.TEMPERATURE_UNITS_CTYPE=t.TARGET_TEMPERATURE_CTYPE=t.TARGET_RELATIVE_HUMIDITY_CTYPE=t.TARGET_LOCK_MECHANISM_STATE_CTYPE=t.TARGET_DOORSTATE_CTYPE=t.STATUS_FAULT_CTYPE=t.STATUS_LOW_BATTERY_CTYPE=t.FIRMWARE_REVISION_CTYPE=t.SERIAL_NUMBER_CTYPE=t.SATURATION_CTYPE=t.ROTATION_SPEED_CTYPE=t.ROTATION_DIRECTION_CTYPE=t.PROGRAMMABLE_SWITCH_OUTPUT_STATE_CTYPE=t.PROGRAMMABLE_SWITCH_SWITCH_EVENT_CTYPE=t.POWER_STATE_CTYPE=t.OCCUPANCY_DETECTED_CTYPE=t.OUTLET_IN_USE_CTYPE=t.OBSTRUCTION_DETECTED_CTYPE=t.NAME_CTYPE=t.MOTION_DETECTED_CTYPE=t.MODEL_CTYPE=void 0;var r="000000",i="-0000-1000-8000-0026BB765291";t.OTHER_TCTYPE=1,t.FAN_TCTYPE=3,t.GARAGE_DOOR_OPENER_TCTYPE=4,t.LIGHTBULB_TCTYPE=5,t.DOOR_LOCK_TCTYPE=6,t.OUTLET_TCTYPE=7,t.SWITCH_TCTYPE=8,t.THERMOSTAT_TCTYPE=9,t.SENSOR_TCTYPE=10,t.ALARM_SYSTEM_TCTYPE=11,t.DOOR_TCTYPE=12,t.WINDOW_TCTYPE=13,t.WINDOW_COVERING_TCTYPE=14,t.PROGRAMMABLE_SWITCH_TCTYPE=15,t.LIGHTBULB_STYPE=r+"43"+i,t.SWITCH_STYPE=r+"49"+i,t.THERMOSTAT_STYPE=r+"4A"+i,t.GARAGE_DOOR_OPENER_STYPE=r+"41"+i,t.ACCESSORY_INFORMATION_STYPE=r+"3E"+i,t.FAN_STYPE=r+"40"+i,t.OUTLET_STYPE=r+"47"+i,t.LOCK_MECHANISM_STYPE=r+"45"+i,t.LOCK_MANAGEMENT_STYPE=r+"44"+i,t.ALARM_STYPE=r+"7E"+i,t.WINDOW_COVERING_STYPE=r+"8C"+i,t.OCCUPANCY_SENSOR_STYPE=r+"86"+i,t.CONTACT_SENSOR_STYPE=r+"80"+i,t.MOTION_SENSOR_STYPE=r+"85"+i,t.HUMIDITY_SENSOR_STYPE=r+"82"+i,t.TEMPERATURE_SENSOR_STYPE=r+"8A"+i,t.ALARM_CURRENT_STATE_CTYPE=r+"66"+i,t.ALARM_TARGET_STATE_CTYPE=r+"67"+i,t.ADMIN_ONLY_ACCESS_CTYPE=r+"01"+i,t.AUDIO_FEEDBACK_CTYPE=r+"05"+i,t.BRIGHTNESS_CTYPE=r+"08"+i,t.BATTERY_LEVEL_CTYPE=r+"68"+i,t.COOLING_THRESHOLD_CTYPE=r+"0D"+i,t.CONTACT_SENSOR_STATE_CTYPE=r+"6A"+i,t.CURRENT_DOOR_STATE_CTYPE=r+"0E"+i,t.CURRENT_LOCK_MECHANISM_STATE_CTYPE=r+"1D"+i,t.CURRENT_RELATIVE_HUMIDITY_CTYPE=r+"10"+i,t.CURRENT_TEMPERATURE_CTYPE=r+"11"+i,t.HEATING_THRESHOLD_CTYPE=r+"12"+i,t.HUE_CTYPE=r+"13"+i,t.IDENTIFY_CTYPE=r+"14"+i,t.LOCK_MANAGEMENT_AUTO_SECURE_TIMEOUT_CTYPE=r+"1A"+i,t.LOCK_MANAGEMENT_CONTROL_POINT_CTYPE=r+"19"+i,t.LOCK_MECHANISM_LAST_KNOWN_ACTION_CTYPE=r+"1C"+i,t.LOGS_CTYPE=r+"1F"+i,t.MANUFACTURER_CTYPE=r+"20"+i,t.MODEL_CTYPE=r+"21"+i,t.MOTION_DETECTED_CTYPE=r+"22"+i,t.NAME_CTYPE=r+"23"+i,t.OBSTRUCTION_DETECTED_CTYPE=r+"24"+i,t.OUTLET_IN_USE_CTYPE=r+"26"+i,t.OCCUPANCY_DETECTED_CTYPE=r+"71"+i,t.POWER_STATE_CTYPE=r+"25"+i,t.PROGRAMMABLE_SWITCH_SWITCH_EVENT_CTYPE=r+"73"+i,t.PROGRAMMABLE_SWITCH_OUTPUT_STATE_CTYPE=r+"74"+i,t.ROTATION_DIRECTION_CTYPE=r+"28"+i,t.ROTATION_SPEED_CTYPE=r+"29"+i,t.SATURATION_CTYPE=r+"2F"+i,t.SERIAL_NUMBER_CTYPE=r+"30"+i,t.FIRMWARE_REVISION_CTYPE=r+"52"+i,t.STATUS_LOW_BATTERY_CTYPE=r+"79"+i,t.STATUS_FAULT_CTYPE=r+"77"+i,t.TARGET_DOORSTATE_CTYPE=r+"32"+i,t.TARGET_LOCK_MECHANISM_STATE_CTYPE=r+"1E"+i,t.TARGET_RELATIVE_HUMIDITY_CTYPE=r+"34"+i,t.TARGET_TEMPERATURE_CTYPE=r+"35"+i,t.TEMPERATURE_UNITS_CTYPE=r+"36"+i,t.VERSION_CTYPE=r+"37"+i,t.WINDOW_COVERING_TARGET_POSITION_CTYPE=r+"7C"+i,t.WINDOW_COVERING_CURRENT_POSITION_CTYPE=r+"6D"+i,t.WINDOW_COVERING_OPERATION_STATE_CTYPE=r+"72"+i,t.CURRENTHEATINGCOOLING_CTYPE=r+"0F"+i,t.TARGETHEATINGCOOLING_CTYPE=r+"33"+i},3103:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=t.HAPLibraryVersion=t.LegacyTypes=t.uuid=t.AccessoryLoader=void 0;var i=r(1635);r(3476),r(8086);var n=i.__importDefault(r(5753)),o=r(4299);t.AccessoryLoader=i.__importStar(r(1370)),t.uuid=i.__importStar(r(2997)),i.__exportStar(r(4299),t),i.__exportStar(r(5745),t),i.__exportStar(r(3186),t),i.__exportStar(r(5876),t),i.__exportStar(r(9826),t),i.__exportStar(r(1370),t),i.__exportStar(r(8591),t),i.__exportStar(r(4910),t),i.__exportStar(r(589),t),i.__exportStar(r(9948),t),i.__exportStar(r(1068),t),i.__exportStar(r(5579),t),i.__exportStar(r(9621),t),i.__exportStar(r(7739),t),i.__exportStar(r(3314),t),i.__exportStar(r(8073),t),i.__exportStar(r(2175),t),i.__exportStar(r(1579),t),i.__exportStar(r(9593),t),i.__exportStar(r(4310),t),t.LegacyTypes=i.__importStar(r(135));var a=(0,n.default)("HAP-NodeJS:Advertiser");function s(){return r(8389).version}t.HAPLibraryVersion=s,a("Initializing HAP-NodeJS v%s ...",s()),t.init=function(e){console.log("DEPRECATED: The need to manually initialize HAP (by calling the init method) was removed. If you want to set a custom storage path location, please ust HAPStorage.setCustomStoragePath directly. This method will be removed in the next major update!"),e&&o.HAPStorage.setCustomStoragePath(e)};i.__importStar(r(1647)),i.__importStar(r(651))},8602:(e,t)=>{"use strict";var r,i,n,o;Object.defineProperty(t,"__esModule",{value:!0}),t.HAPMimeTypes=t.PairingStates=t.PairMethods=t.TLVValues=t.consideredTrue=void 0,t.consideredTrue=function(e){return!!e&&("true"===e||"1"===e)},function(e){e[e.REQUEST_TYPE=0]="REQUEST_TYPE",e[e.METHOD=0]="METHOD",e[e.USERNAME=1]="USERNAME",e[e.IDENTIFIER=1]="IDENTIFIER",e[e.SALT=2]="SALT",e[e.PUBLIC_KEY=3]="PUBLIC_KEY",e[e.PASSWORD_PROOF=4]="PASSWORD_PROOF",e[e.ENCRYPTED_DATA=5]="ENCRYPTED_DATA",e[e.SEQUENCE_NUM=6]="SEQUENCE_NUM",e[e.STATE=6]="STATE",e[e.ERROR_CODE=7]="ERROR_CODE",e[e.RETRY_DELAY=8]="RETRY_DELAY",e[e.CERTIFICATE=9]="CERTIFICATE",e[e.PROOF=10]="PROOF",e[e.SIGNATURE=10]="SIGNATURE",e[e.PERMISSIONS=11]="PERMISSIONS",e[e.FRAGMENT_DATA=12]="FRAGMENT_DATA",e[e.FRAGMENT_LAST=13]="FRAGMENT_LAST",e[e.SEPARATOR=255]="SEPARATOR"}(r||(t.TLVValues=r={})),function(e){e[e.PAIR_SETUP=0]="PAIR_SETUP",e[e.PAIR_SETUP_WITH_AUTH=1]="PAIR_SETUP_WITH_AUTH",e[e.PAIR_VERIFY=2]="PAIR_VERIFY",e[e.ADD_PAIRING=3]="ADD_PAIRING",e[e.REMOVE_PAIRING=4]="REMOVE_PAIRING",e[e.LIST_PAIRINGS=5]="LIST_PAIRINGS"}(i||(t.PairMethods=i={})),function(e){e[e.M1=1]="M1",e[e.M2=2]="M2",e[e.M3=3]="M3",e[e.M4=4]="M4",e[e.M5=5]="M5",e[e.M6=6]="M6"}(n||(t.PairingStates=n={})),function(e){e.PAIRING_TLV8="application/pairing+tlv8",e.HAP_JSON="application/hap+json",e.IMAGE_JPEG="image/jpeg"}(o||(t.HAPMimeTypes=o={}))},5745:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Accessory=t.AccessoryEventTypes=t.MDNSAdvertiser=t.CharacteristicWarningType=t.Categories=void 0;var i,n,o,a,s,c=r(1635),u=c.__importDefault(r(2613)),l=c.__importDefault(r(6982)),h=c.__importDefault(r(5753)),d=r(4434),p=c.__importDefault(r(9278)),f=r(310),g=r(8591),m=r(9826),v=r(1068),y=r(589),C=r(5579),S=r(292),E=r(2738),_=r(5876),T=r(9621),A=r(8066),I=c.__importStar(r(2997)),D=r(2997),w=(0,h.default)("HAP-NodeJS:Accessory");!function(e){e[e.OTHER=1]="OTHER",e[e.BRIDGE=2]="BRIDGE",e[e.FAN=3]="FAN",e[e.GARAGE_DOOR_OPENER=4]="GARAGE_DOOR_OPENER",e[e.LIGHTBULB=5]="LIGHTBULB",e[e.DOOR_LOCK=6]="DOOR_LOCK",e[e.OUTLET=7]="OUTLET",e[e.SWITCH=8]="SWITCH",e[e.THERMOSTAT=9]="THERMOSTAT",e[e.SENSOR=10]="SENSOR",e[e.ALARM_SYSTEM=11]="ALARM_SYSTEM",e[e.SECURITY_SYSTEM=11]="SECURITY_SYSTEM",e[e.DOOR=12]="DOOR",e[e.WINDOW=13]="WINDOW",e[e.WINDOW_COVERING=14]="WINDOW_COVERING",e[e.PROGRAMMABLE_SWITCH=15]="PROGRAMMABLE_SWITCH",e[e.RANGE_EXTENDER=16]="RANGE_EXTENDER",e[e.CAMERA=17]="CAMERA",e[e.IP_CAMERA=17]="IP_CAMERA",e[e.VIDEO_DOORBELL=18]="VIDEO_DOORBELL",e[e.AIR_PURIFIER=19]="AIR_PURIFIER",e[e.AIR_HEATER=20]="AIR_HEATER",e[e.AIR_CONDITIONER=21]="AIR_CONDITIONER",e[e.AIR_HUMIDIFIER=22]="AIR_HUMIDIFIER",e[e.AIR_DEHUMIDIFIER=23]="AIR_DEHUMIDIFIER",e[e.APPLE_TV=24]="APPLE_TV",e[e.HOMEPOD=25]="HOMEPOD",e[e.SPEAKER=26]="SPEAKER",e[e.AIRPORT=27]="AIRPORT",e[e.SPRINKLER=28]="SPRINKLER",e[e.FAUCET=29]="FAUCET",e[e.SHOWER_HEAD=30]="SHOWER_HEAD",e[e.TELEVISION=31]="TELEVISION",e[e.TARGET_CONTROLLER=32]="TARGET_CONTROLLER",e[e.ROUTER=33]="ROUTER",e[e.AUDIO_RECEIVER=34]="AUDIO_RECEIVER",e[e.TV_SET_TOP_BOX=35]="TV_SET_TOP_BOX",e[e.TV_STREAMING_STICK=36]="TV_STREAMING_STICK"}(i||(t.Categories=i={})),function(e){e.SLOW_WRITE="slow-write",e.TIMEOUT_WRITE="timeout-write",e.SLOW_READ="slow-read",e.TIMEOUT_READ="timeout-read",e.WARN_MESSAGE="warn-message",e.ERROR_MESSAGE="error-message",e.DEBUG_MESSAGE="debug-message"}(n||(t.CharacteristicWarningType=n={})),function(e){e.CIAO="ciao",e.BONJOUR="bonjour-hap",e.AVAHI="avahi",e.RESOLVED="resolved"}(o||(t.MDNSAdvertiser=o={})),function(e){e[e.REGULAR_REQUEST=0]="REGULAR_REQUEST",e[e.TIMED_WRITE_AUTHENTICATED=1]="TIMED_WRITE_AUTHENTICATED",e[e.TIMED_WRITE_REJECTED=2]="TIMED_WRITE_REJECTED"}(a||(a={})),function(e){e.IDENTIFY="identify",e.LISTENING="listening",e.ADVERTISED="advertised",e.SERVICE_CONFIGURATION_CHANGE="service-configurationChange",e.SERVICE_CHARACTERISTIC_CHANGE="service-characteristic-change",e.PAIRED="paired",e.UNPAIRED="unpaired",e.CHARACTERISTIC_WARNING="characteristic-warning"}(s||(t.AccessoryEventTypes=s={}));var b=function(e){function t(t,r){var i=e.call(this)||this;return i.displayName=t,i.UUID=r,i.aid=null,i._isBridge=!1,i.bridged=!1,i.bridgedAccessories=[],i.reachable=!0,i.category=1,i.services=[],i.shouldPurgeUnusedIDs=!0,i.initialized=!1,i.controllers={},i._setupID=null,i.controllerStorage=new S.ControllerStorage(i),i.lastAccessoriesRequest=0,i.getPrimaryAccessory=function(){return i.bridged?i.bridge:i},(0,u.default)(t,"Accessories must be created with a non-empty displayName."),(0,u.default)(r,"Accessories must be created with a valid UUID."),(0,u.default)(I.isValid(r),"UUID '"+r+"' is not a valid UUID. Try using the provided 'generateUUID' function to create a valid UUID from any arbitrary string, like a serial number."),i.addService(_.Service.AccessoryInformation).setCharacteristic(m.Characteristic.Name,t),i.getService(_.Service.AccessoryInformation).getCharacteristic(m.Characteristic.Identify).on("set",(function(e,t){if(e){i.identificationRequest(!0,t)}})),i}return c.__extends(t,e),t.prototype.identificationRequest=function(e,t){w("[%s] Identification request",this.displayName),this.listeners("identify").length>0?this.emit("identify",e,t):(w("[%s] Identification request ignored; no listeners to 'identify' event",this.displayName),t())},t.prototype.addService=function(e){for(var t,r,i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var o="function"==typeof e?new e(i[0],i[1],i[2]):e;try{for(var a=c.__values(this.services),s=a.next();!s.done;s=a.next()){var u=s.value;if(u.UUID===o.UUID){if(!o.subtype)throw new Error("Cannot add a Service with the same UUID '"+u.UUID+"' as another Service in this Accessory without also defining a unique 'subtype' property.");if(o.subtype===u.subtype)throw new Error("Cannot add a Service with the same UUID '"+u.UUID+"' and subtype '"+u.subtype+"' as another Service in this Accessory.")}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}if(this.services.length>=100)throw new Error("Cannot add more than 100 services to a single accessory!");return this.services.push(o),o.isPrimaryService&&(void 0!==this.primaryService&&(this.primaryService.isPrimaryService=!1),this.primaryService=o),this.bridged?this.emit("service-configurationChange",{service:o}):this.enqueueConfigurationUpdate(),this.setupServiceEventHandlers(o),o},t.prototype.setPrimaryService=function(e){e.setPrimaryService()},t.prototype.removeService=function(e){var t=this.services.indexOf(e);t>=0&&(this.services.splice(t,1),this.primaryService===e&&(this.primaryService=void 0),this.removeLinkedService(e),this.bridged?this.emit("service-configurationChange",{service:e}):this.enqueueConfigurationUpdate(),e.removeAllListeners())},t.prototype.removeLinkedService=function(e){var t,r;try{for(var i=c.__values(this.services),n=i.next();!n.done;n=i.next()){n.value.removeLinkedService(e)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}},t.prototype.getService=function(e){var t,r;try{for(var i=c.__values(this.services),n=i.next();!n.done;n=i.next()){var o=n.value;if("string"==typeof e&&(o.displayName===e||o.name===e||o.subtype===e))return o;if("function"==typeof e&&(o instanceof e||e.UUID===o.UUID))return o}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}},t.prototype.getServiceById=function(e,t){var r,i;try{for(var n=c.__values(this.services),o=n.next();!o.done;o=n.next()){var a=o.value;if("string"==typeof e&&(a.displayName===e||a.name===e)&&a.subtype===t)return a;if("function"==typeof e&&(a instanceof e||e.UUID===a.UUID)&&a.subtype===t)return a}}catch(e){r={error:e}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(r)throw r.error}}},t.prototype.updateReachability=function(e){if(!this.bridged)throw new Error("Cannot update reachability on non-bridged accessory!");this.reachable=e,w("Reachability update is no longer being supported.")},t.prototype.addBridgedAccessory=function(e,t){var r=this;if(void 0===t&&(t=!1),e._isBridge||e===this)throw new Error("Illegal state: either trying to bridge a bridge or trying to bridge itself!");if(e.initialized)throw new Error("Tried to bridge an accessory which was already published once!");if(null!=e.bridge)throw new Error("Tried to bridge "+e.displayName+" while it was already bridged by "+e.bridge.displayName);if(this.bridgedAccessories.length>=149)throw new Error("Cannot Bridge more than 149 Accessories");return e.on("service-characteristic-change",(function(t){return r.handleCharacteristicChangeEvent(e,t.service,t)})),e.on("service-configurationChange",this.enqueueConfigurationUpdate.bind(this)),e.on("characteristic-warning",this.handleCharacteristicWarning.bind(this)),e.bridged=!0,e.bridge=this,this.bridgedAccessories.push(e),this.controllerStorage.linkAccessory(e),t||this.enqueueConfigurationUpdate(),e},t.prototype.addBridgedAccessories=function(e){var t,r;try{for(var i=c.__values(e),n=i.next();!n.done;n=i.next()){var o=n.value;this.addBridgedAccessory(o,!0)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}this.enqueueConfigurationUpdate()},t.prototype.removeBridgedAccessory=function(e,t){void 0===t&&(t=!1);var r=this.bridgedAccessories.indexOf(e);if(-1===r)throw new Error("Cannot find the bridged Accessory to remove.");this.bridgedAccessories.splice(r,1),e.bridged=!1,e.bridge=void 0,e.removeAllListeners(),t||this.enqueueConfigurationUpdate()},t.prototype.removeBridgedAccessories=function(e){var t,r;try{for(var i=c.__values(e),n=i.next();!n.done;n=i.next()){var o=n.value;this.removeBridgedAccessory(o,!0)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}this.enqueueConfigurationUpdate()},t.prototype.removeAllBridgedAccessories=function(){for(var e=this.bridgedAccessories.length-1;e>=0;e--)this.removeBridgedAccessory(this.bridgedAccessories[e],!0);this.enqueueConfigurationUpdate()},t.prototype.getCharacteristicByIID=function(e){var t,r;try{for(var i=c.__values(this.services),n=i.next();!n.done;n=i.next()){var o=n.value.getCharacteristicByIID(e);if(o)return o}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}},t.prototype.getAccessoryByAID=function(e){return this.aid===e?this:this.bridgedAccessories.find((function(t){return t.aid===e}))},t.prototype.findCharacteristic=function(e,t){var r=this.getAccessoryByAID(e);return r&&r.getCharacteristicByIID(t)},t.prototype.configureCameraSource=function(e){var t=this;if(0===e.streamControllers.length)throw new Error("Malformed legacy CameraSource. Did not expose any StreamControllers!");var r=e.streamControllers[0].options,i={cameraStreamCount:e.streamControllers.length,streamingOptions:r,delegate:new g.LegacyCameraSourceAdapter(e)},n=new v.CameraController(i,!0);return this.configureController(n),e.services.forEach((function(e){e.UUID!==_.Service.CameraRTPStreamManagement.UUID&&e.UUID!==_.Service.CameraOperatingMode.UUID&&e.UUID!==_.Service.CameraRecordingManagement.UUID&&t.addService(e)})),e.streamControllers=n.streamManagements,n},t.prototype.configureController=function(e){var t=this,r="function"==typeof e?new e:e,i=r.controllerId();if(this.controllers[i])throw new Error("A Controller with the type/id '".concat(i,"' was already added to the accessory ").concat(this.displayName));var n,o=this.serializedControllers&&this.serializedControllers[i];if(o){var a=(0,T.clone)(o),s=r.initWithServices(o);n=s||o,s&&this.handleUpdatedControllerServiceMap(a,s),r.configureServices(),delete this.serializedControllers[i],0===Object.entries(this.serializedControllers).length&&(this.serializedControllers=void 0)}else n=r.constructServices(),r.configureServices(),Object.values(n).forEach((function(e){e&&!t.services.includes(e)&&t.addService(e)}));var c={controller:r,serviceMap:n};(0,v.isSerializableController)(r)&&this.controllerStorage.trackController(r),this.controllers[i]=c,r instanceof v.CameraController&&(this.activeCameraController=r)},t.prototype.removeController=function(e){var t=this,r=e.controllerId(),i=this.controllers[r];if(i){if(i.controller!==e)throw new Error("["+this.displayName+"] tried removing a controller with the id/type '"+r+"' though provided controller isn't the same instance that is registered!");(0,v.isSerializableController)(e)&&this.controllerStorage.untrackController(e),e.handleFactoryReset&&e.handleFactoryReset(),e.handleControllerRemoved(),delete this.controllers[r],this.activeCameraController===e&&(this.activeCameraController=void 0),Object.values(i.serviceMap).forEach((function(e){e&&t.removeService(e)}))}this.serializedControllers&&delete this.serializedControllers[r]},t.prototype.handleAccessoryUnpairedForControllers=function(){var e,t;try{for(var r=c.__values(Object.values(this.controllers)),i=r.next();!i.done;i=r.next()){var n=i.value.controller;n.handleFactoryReset&&n.handleFactoryReset(),(0,v.isSerializableController)(n)&&this.controllerStorage.purgeControllerData(n)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},t.prototype.handleUpdatedControllerServiceMap=function(e,t){var r=this;t=(0,T.clone)(t),Object.keys(e).forEach((function(i){var n=e[i],o=t[i];n&&o&&(delete e[i],delete t[i],n!==o&&(r.removeService(n),r.addService(o)))})),Object.values(e).forEach((function(e){e&&r.removeService(e)})),Object.values(t).forEach((function(e){e&&r.addService(e)}))},t.prototype.setupURI=function(){if(this._setupURI)return this._setupURI;(0,u.default)(!!this._accessoryInfo,"Cannot generate setupURI on an accessory that isn't published yet!");var e=Buffer.alloc(8),t=parseInt(this._accessoryInfo.pincode.replace(/-/g,""),10),r=this._accessoryInfo.category>>1;t|=1<<28,e.writeUInt32BE(t,4),1&this._accessoryInfo.category&&(e[4]=128|e[4]),e.writeUInt32BE(r,0);var i=(e.readUInt32BE(4)+4294967296*e.readUInt32BE(0)).toString(36).toUpperCase();if(9!==i.length)for(var n=0;n<=9-i.length;n++)i="0"+i;return this._setupURI="X-HM://"+i+this._setupID,this._setupURI},t.prototype.validateAccessory=function(e){var t=this,r=this.getService(_.Service.AccessoryInformation);if(r){var i=function(e,r){r||console.log("HAP-NodeJS WARNING: The accessory '"+t.displayName+"' is getting published with the characteristic '"+e+"' (of the AccessoryInformation service) not having a value set. This might prevent the accessory from being added to the Home App or leading to the accessory being unresponsive!")},n=r.getCharacteristic(m.Characteristic.Model).value,o=r.getCharacteristic(m.Characteristic.SerialNumber).value,a=r.getCharacteristic(m.Characteristic.FirmwareRevision).value,s=r.getCharacteristic(m.Characteristic.Name).value;i("Model",n),i("SerialNumber",o),i("FirmwareRevision",a),i("Name",s)}else console.log("HAP-NodeJS WARNING: The accessory '"+this.displayName+"' is getting published without a AccessoryInformation service. This might prevent the accessory from being added to the Home app or leading to the accessory being unresponsive!");e&&(0,u.default)(Buffer.from(this.displayName,"utf8").length<=63,"Accessory displayName cannot be longer than 63 bytes!"),this.bridged&&this.bridgedAccessories.forEach((function(e){return e.validateAccessory()}))},t.prototype._assignIDs=function(e){var t,r,i,n;this._identifierCache&&this.shouldPurgeUnusedIDs&&this._identifierCache.startTrackingUsage(),this.bridged?this.aid=e.getAID(this.UUID):this.aid=1;try{for(var o=c.__values(this.services),a=o.next();!a.done;a=o.next()){var s=a.value;this._isBridge?s._assignIDs(e,this.UUID,2e9):s._assignIDs(e,this.UUID)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}try{for(var u=c.__values(this.bridgedAccessories),l=u.next();!l.done;l=u.next()){l.value._assignIDs(e)}}catch(e){i={error:e}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(i)throw i.error}}this._identifierCache&&(this.shouldPurgeUnusedIDs&&this._identifierCache.stopTrackingUsageAndExpireUnused(),this._identifierCache.save())},t.prototype.disableUnusedIDPurge=function(){this.shouldPurgeUnusedIDs=!1},t.prototype.enableUnusedIDPurge=function(){this.shouldPurgeUnusedIDs=!0},t.prototype.purgeUnusedIDs=function(){var e=this.shouldPurgeUnusedIDs;this.shouldPurgeUnusedIDs=!0,this._assignIDs(this._identifierCache),this.shouldPurgeUnusedIDs=e},t.prototype.toHAP=function(e){return c.__awaiter(this,arguments,void 0,(function(e,t){var r,i,n,o,a,s;return void 0===t&&(t=!0),c.__generator(this,(function(l){switch(l.label){case 0:return(0,u.default)(this.aid,"aid cannot be undefined for accessory '"+this.displayName+"'"),(0,u.default)(this.services.length,"accessory '"+this.displayName+"' does not have any services!"),s={aid:this.aid},[4,Promise.all(this.services.map((function(r){return r.toHAP(e,t)})))];case 1:return s.services=l.sent(),r=[s],this.bridged?[3,3]:(n=(i=r.push).apply,o=[r],a=[[]],[4,Promise.all(this.bridgedAccessories.map((function(r){return r.toHAP(e,t).then((function(e){return e[0]}))})))]);case 2:n.apply(i,o.concat([c.__spreadArray.apply(void 0,a.concat([c.__read.apply(void 0,[l.sent()]),!1]))])),l.label=3;case 3:return[2,r]}}))}))},t.prototype.internalHAPRepresentation=function(e){var t,r;void 0===e&&(e=!0),e&&this._assignIDs(this._identifierCache),(0,u.default)(this.aid,"aid cannot be undefined for accessory '"+this.displayName+"'"),(0,u.default)(this.services.length,"accessory '"+this.displayName+"' does not have any services!");var i=[{aid:this.aid,services:this.services.map((function(e){return e.internalHAPRepresentation()}))}];if(!this.bridged)try{for(var n=c.__values(this.bridgedAccessories),o=n.next();!o.done;o=n.next()){var a=o.value;i.push(a.internalHAPRepresentation(!1)[0])}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return i},t.prototype.publish=function(e,r){return c.__awaiter(this,void 0,void 0,(function(){var i,n,o,a,s,u,h,d,p,g,v=this;return c.__generator(this,(function(c){switch(c.label){case 0:if(this.bridged)throw new Error("Can't publish in accessory which is bridged by another accessory. Bridged by "+(null===(d=this.bridge)||void 0===d?void 0:d.displayName));return e.advertiser||null==e.useLegacyAdvertiser||(e.advertiser=e.useLegacyAdvertiser?"bonjour-hap":"ciao",console.warn('DEPRECATED The PublishInfo.useLegacyAdvertiser option has been removed. Please use the PublishInfo.advertiser property to enable "ciao" (useLegacyAdvertiser=false) or "bonjour-hap" (useLegacyAdvertiser=true) mdns advertiser libraries!')),e.mdns&&"bonjour-hap"!==e.advertiser&&console.log("DEPRECATED user supplied a custom 'mdns' option. This option is deprecated and ignored. Please move to the new 'bind' option."),(i=this.getService(_.Service.ProtocolInformation))||(i=this.addService(_.Service.ProtocolInformation)),i.setCharacteristic(m.Characteristic.Version,f.CiaoAdvertiser.protocolVersionService),this.lastKnownUsername&&this.lastKnownUsername!==e.username&&t.cleanupAccessoryData(this.lastKnownUsername),this.initialized||null!==(p=e.addIdentifyingMaterial)&&void 0!==p&&!p||(this.displayName=this.displayName+" "+l.default.createHash("sha512").update(e.username,"utf8").digest("hex").slice(0,4).toUpperCase(),this.getService(_.Service.AccessoryInformation).updateCharacteristic(m.Characteristic.Name,this.displayName)),this._accessoryInfo=C.AccessoryInfo.load(e.username),this._accessoryInfo||(w("[%s] Creating new AccessoryInfo for our HAP server",this.displayName),this._accessoryInfo=C.AccessoryInfo.create(e.username)),e.setupID?this._setupID=e.setupID:void 0===this._accessoryInfo.setupID||""===this._accessoryInfo.setupID?this._setupID=t._generateSetupID():this._setupID=this._accessoryInfo.setupID,this._accessoryInfo.setupID=this._setupID,this._accessoryInfo.displayName=this.displayName,this._accessoryInfo.model=this.getService(_.Service.AccessoryInformation).getCharacteristic(m.Characteristic.Model).value,this._accessoryInfo.category=e.category||1,this._accessoryInfo.pincode=e.pincode,this._accessoryInfo.save(),this._identifierCache=E.IdentifierCache.load(e.username),this._identifierCache||(w("[%s] Creating new IdentifierCache",this.displayName),this._identifierCache=new E.IdentifierCache(e.username)),this._isBridge&&0===this.bridgedAccessories.length&&(this.disableUnusedIDPurge(),this.controllerStorage.purgeUnidentifiedAccessoryData=!1),this.initialized||this.controllerStorage.load(e.username),this._assignIDs(this._identifierCache),n=this.internalHAPRepresentation(!1),this._accessoryInfo.checkForCurrentConfigurationNumberIncrement(n,!0),this.validateAccessory(!0),o=t.parseBindOption(e),a=null!==(g=e.advertiser)&&void 0!==g?g:"bonjour-hap",(u="avahi"===e.advertiser)?[4,f.AvahiAdvertiser.isAvailable()]:[3,2];case 1:u=!c.sent(),c.label=2;case 2:return(s=u)?[3,5]:(h="resolved"===e.advertiser)?[4,f.ResolvedAdvertiser.isAvailable()]:[3,4];case 3:h=!c.sent(),c.label=4;case 4:s=h,c.label=5;case 5:switch(s&&(console.error("[".concat(this.displayName,'] The selected advertiser, "').concat(e.advertiser,"\", isn't available on this platform. ")+'Reverting to "'.concat("bonjour-hap",'"')),a="bonjour-hap"),a){case"ciao":this._advertiser=new f.CiaoAdvertiser(this._accessoryInfo,{interface:o.advertiserAddress},{restrictedAddresses:o.serviceRestrictedAddress,disabledIpv6:o.serviceDisableIpv6});break;case"bonjour-hap":this._advertiser=new f.BonjourHAPAdvertiser(this._accessoryInfo,e.mdns,{restrictedAddresses:o.serviceRestrictedAddress,disabledIpv6:o.serviceDisableIpv6});break;case"avahi":this._advertiser=new f.AvahiAdvertiser(this._accessoryInfo);break;case"resolved":this._advertiser=new f.ResolvedAdvertiser(this._accessoryInfo);break;default:throw new Error("Unsupported advertiser setting: '"+e.advertiser+"'")}return this._advertiser.on("updated-name",(function(e){v.displayName=e,v._accessoryInfo&&(v._accessoryInfo.displayName=e,v._accessoryInfo.save()),v.getService(_.Service.AccessoryInformation).updateCharacteristic(m.Characteristic.Name,e)})),this._server=new y.HAPServer(this._accessoryInfo),this._server.allowInsecureRequest=!!r,this._server.on("listening",this.onListening.bind(this)),this._server.on("identify",this.identificationRequest.bind(this,!1)),this._server.on("pair",this.handleInitialPairSetupFinished.bind(this)),this._server.on("add-pairing",this.handleAddPairing.bind(this)),this._server.on("remove-pairing",this.handleRemovePairing.bind(this)),this._server.on("list-pairings",this.handleListPairings.bind(this)),this._server.on("accessories",this.handleAccessories.bind(this)),this._server.on("get-characteristics",this.handleGetCharacteristics.bind(this)),this._server.on("set-characteristics",this.handleSetCharacteristics.bind(this)),this._server.on("connection-closed",this.handleHAPConnectionClosed.bind(this)),this._server.on("request-resource",this.handleResource.bind(this)),this._server.listen(e.port,o.serverAddress),this.initialized=!0,[2]}}))}))},t.prototype.destroy=function(){var e=this.unpublish();return this._accessoryInfo&&(t.cleanupAccessoryData(this._accessoryInfo.username),this._accessoryInfo=void 0,this._identifierCache=void 0,this.controllerStorage=new S.ControllerStorage(this)),this.removeAllListeners(),e},t.prototype.unpublish=function(){return c.__awaiter(this,void 0,void 0,(function(){return c.__generator(this,(function(e){switch(e.label){case 0:return this._server&&(this._server.destroy(),this._server=void 0),this._advertiser?[4,this._advertiser.destroy()]:[3,2];case 1:e.sent(),this._advertiser=void 0,e.label=2;case 2:return[2]}}))}))},t.prototype.enqueueConfigurationUpdate=function(){var e=this;this.configurationChangeDebounceTimeout||(this.configurationChangeDebounceTimeout=setTimeout((function(){var t;if(e.configurationChangeDebounceTimeout=void 0,e._advertiser&&e._advertiser){var r=e.internalHAPRepresentation();(null===(t=e._accessoryInfo)||void 0===t?void 0:t.checkForCurrentConfigurationNumberIncrement(r))&&e._advertiser.updateAdvertisement()}}),1e3),this.configurationChangeDebounceTimeout.unref())},t.prototype.onListening=function(e,t){var r=this;(0,u.default)(this._advertiser,"Advertiser wasn't created at onListening!"),this._advertiser.initPort(e),this._advertiser.startAdvertising().then((function(){return r.emit("advertised")})).catch((function(e){console.error("Could not create mDNS advertisement. The HAP-Server won't be discoverable: "+e),e.stack&&w("Detailed error: "+e.stack)})),this.emit("listening",e,t)},t.prototype.handleInitialPairSetupFinished=function(e,t,r){w("[%s] Paired with client %s",this.displayName,e),this._accessoryInfo&&this._accessoryInfo.addPairedClient(e,t,1),this._accessoryInfo&&this._accessoryInfo.save(),this._advertiser&&this._advertiser.updateAdvertisement(),r(),this.emit("paired")},t.prototype.handleAddPairing=function(e,t,r,i,n){if(this._accessoryInfo)if(this._accessoryInfo.hasAdminPermissions(e.username)){var o=this._accessoryInfo.getClientPublicKey(t);if(o){if(o.toString()!==r.toString())return void n(1);this._accessoryInfo.updatePermission(t,i)}else this._accessoryInfo.addPairedClient(t,r,i);this._accessoryInfo.save(),n(0)}else n(2);else n(6)},t.prototype.handleRemovePairing=function(e,t,r){var i,n;if(this._accessoryInfo)if(this._accessoryInfo.hasAdminPermissions(e.username)){if(this._accessoryInfo.removePairedClient(e,t),this._accessoryInfo.save(),r(0),!this._accessoryInfo.paired()){this._advertiser&&this._advertiser.updateAdvertisement(),this.emit("unpaired"),this.handleAccessoryUnpairedForControllers();try{for(var o=c.__values(this.bridgedAccessories),a=o.next();!a.done;a=o.next()){a.value.handleAccessoryUnpairedForControllers()}}catch(e){i={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}}}else r(2);else r(6)},t.prototype.handleListPairings=function(e,t){this._accessoryInfo?this._accessoryInfo.hasAdminPermissions(e.username)?t(0,this._accessoryInfo.listPairings()):t(2):t(6)},t.prototype.handleAccessories=function(e,t){var r=this;this._assignIDs(this._identifierCache);var i=Date.now(),n=i-this.lastAccessoriesRequest>5e3;this.lastAccessoriesRequest=i,this.toHAP(e,n).then((function(e){t(void 0,{accessories:e})}),(function(e){console.error("["+r.displayName+"] /accessories request error with: "+e.stack),t({httpCode:500,status:-70402})}))},t.prototype.handleGetCharacteristics=function(e,r,i){var n,o,a=this,s=[],u={characteristics:s},l=new Set(r.ids.map((function(e){return e.aid+"."+e.iid})));if(l.size===r.ids.length){var h=setTimeout((function(){var e,r;try{for(var n=c.__values(l),o=n.next();!o.done;o=n.next()){var d=o.value.split("."),p=parseInt(d[0],10),f=parseInt(d[1],10),g=a.getAccessoryByAID(p),m=g.getCharacteristicByIID(f);a.sendCharacteristicWarning(m,"slow-read","The read handler for the characteristic '"+m.displayName+"' on the accessory '"+g.displayName+"' was slow to respond!")}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}h=setTimeout((function(){var e,t;h=void 0;try{for(var r=c.__values(l),n=r.next();!n.done;n=r.next()){var o=n.value.split("."),d=parseInt(o[0],10),p=parseInt(o[1],10),f=a.getAccessoryByAID(d),g=f.getCharacteristicByIID(p);a.sendCharacteristicWarning(g,"timeout-read","The read handler for the characteristic '"+g.displayName+"' on the accessory '"+f.displayName+"' didn't respond at all!. Please check that you properly call the callback!"),s.push({aid:d,iid:p,status:-70408})}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}l.clear(),i(void 0,u)}),t.TIMEOUT_AFTER_WARNING),h.unref()}),t.TIMEOUT_WARNING);h.unref();var d=function(t){var n=t.aid+"."+t.iid;p.handleCharacteristicRead(e,t,r).then((function(e){return c.__assign({aid:t.aid,iid:t.iid},e)}),(function(e){return console.error("[".concat(a.displayName,"] Read request for characteristic ").concat(n," encountered an error: ").concat(e.stack)),{aid:t.aid,iid:t.iid,status:-70402}})).then((function(e){h&&(l.delete(n),s.push(e),0===l.size&&(h&&(clearTimeout(h),h=void 0),i(void 0,u)))}))},p=this;try{for(var f=c.__values(r.ids),g=f.next();!g.done;g=f.next()){d(g.value)}}catch(e){n={error:e}}finally{try{g&&!g.done&&(o=f.return)&&o.call(f)}finally{if(n)throw n.error}}}else i({httpCode:422,status:-70410})},t.prototype.handleCharacteristicRead=function(e,t,r){return c.__awaiter(this,void 0,void 0,(function(){var i,n,o=this;return c.__generator(this,(function(a){return(i=this.findCharacteristic(t.aid,t.iid))?i.props.perms.includes("pr")?i.props.adminOnlyAccess&&i.props.adminOnlyAccess.includes(0)&&((n=this._accessoryInfo&&e.username)||w("[%s] Could not verify admin permissions for Characteristic which requires admin permissions for reading (aid of %s and iid of %s)",this.displayName,t.aid,t.iid),!n||!this._accessoryInfo.hasAdminPermissions(e.username))?[2,{status:-70401}]:[2,i.handleGetRequest(e).then((function(n){n=(0,A.formatOutgoingCharacteristicValue)(n,i.props),w('[%s] Got Characteristic "%s" value: "%s"',o.displayName,i.displayName,n);var a={value:null==n?null:n};return r.includeMeta&&(a.format=i.props.format,a.unit=i.props.unit,a.minValue=i.props.minValue,a.maxValue=i.props.maxValue,a.minStep=i.props.minStep,a.maxLen=i.props.maxLen||i.props.maxDataLen),r.includePerms&&(a.perms=i.props.perms),r.includeType&&(a.type=(0,D.toShortForm)(i.UUID)),r.includeEvent&&(a.ev=e.hasEventNotifications(t.aid,t.iid)),a}),(function(e){return w('[%s] Error getting value for characteristic "%s": %s',o.displayName,i.displayName,y.HAPStatus[e]),{status:e}}))]:(w("[%s] Tried reading from characteristic which does not allow reading (aid of %s and iid of %s)",this.displayName,t.aid,t.iid),[2,{status:-70405}]):(w("[%s] Could not find a Characteristic with aid of %s and iid of %s",this.displayName,t.aid,t.iid),[2,{status:-70410}])}))}))},t.prototype.handleSetCharacteristics=function(e,r,i){var n,o,a=this;w("[%s] Processing characteristic set: %s",this.displayName,JSON.stringify(r));var s=0;void 0!==r.pid&&(e.timedWritePid===r.pid?(s=1,clearTimeout(e.timedWriteTimeout),e.timedWritePid=void 0,e.timedWriteTimeout=void 0,w("[%s] Timed write request got acknowledged for pid %d",this.displayName,r.pid)):(s=2,w("[%s] TTL for timed write request has probably expired for pid %d",this.displayName,r.pid)));var u=[],l={characteristics:u},h=new Set(r.characteristics.map((function(e){return e.aid+"."+e.iid})));if(h.size===r.characteristics.length){var d=setTimeout((function(){var e,r;try{for(var n=c.__values(h),o=n.next();!o.done;o=n.next()){var s=o.value.split("."),p=parseInt(s[0],10),f=parseInt(s[1],10),g=a.getAccessoryByAID(p),m=g.getCharacteristicByIID(f);a.sendCharacteristicWarning(m,"slow-write","The write handler for the characteristic '"+m.displayName+"' on the accessory '"+g.displayName+"' was slow to respond!")}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}d=setTimeout((function(){var e,t;d=void 0;try{for(var r=c.__values(h),n=r.next();!n.done;n=r.next()){var o=n.value.split("."),s=parseInt(o[0],10),p=parseInt(o[1],10),f=a.getAccessoryByAID(s),g=f.getCharacteristicByIID(p);a.sendCharacteristicWarning(g,"timeout-write","The write handler for the characteristic '"+g.displayName+"' on the accessory '"+f.displayName+"' didn't respond at all!. Please check that you properly call the callback!"),u.push({aid:s,iid:p,status:-70408})}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}h.clear(),i(void 0,l)}),t.TIMEOUT_AFTER_WARNING),d.unref()}),t.TIMEOUT_WARNING);d.unref();var p=function(t){var r=t.aid+"."+t.iid;f.handleCharacteristicWrite(e,t,s).then((function(e){return c.__assign({aid:t.aid,iid:t.iid},e)}),(function(e){return console.error("[".concat(a.displayName,"] Write request for characteristic ").concat(r," encountered an error: ").concat(e.stack)),{aid:t.aid,iid:t.iid,status:-70402}})).then((function(e){d&&(h.delete(r),u.push(e),0===h.size&&(d&&(clearTimeout(d),d=void 0),i(void 0,l)))}))},f=this;try{for(var g=c.__values(r.characteristics),m=g.next();!m.done;m=g.next()){p(m.value)}}catch(e){n={error:e}}finally{try{m&&!m.done&&(o=g.return)&&o.call(g)}finally{if(n)throw n.error}}}else i({httpCode:422,status:-70410})},t.prototype.handleCharacteristicWrite=function(e,t,r){return c.__awaiter(this,void 0,void 0,(function(){var i,n,o,a,s=this;return c.__generator(this,(function(c){if(!(i=this.findCharacteristic(t.aid,t.iid)))return w("[%s] Could not find a Characteristic with aid of %s and iid of %s",this.displayName,t.aid,t.iid),[2,{status:-70410}];if(2===r)return[2,{status:-70410}];if(null==t.ev&&null==t.value)return[2,{status:-70410}];if(null!=t.ev){if(!i.props.perms.includes("ev"))return w("[%s] Tried %s notifications for Characteristic which does not allow notify (aid of %s and iid of %s)",this.displayName,t.ev?"enabling":"disabling",t.aid,t.iid),[2,{status:-70406}];if(i.props.adminOnlyAccess&&i.props.adminOnlyAccess.includes(2)&&((o=e.username&&this._accessoryInfo)||w("[%s] Could not verify admin permissions for Characteristic which requires admin permissions for notify (aid of %s and iid of %s)",this.displayName,t.aid,t.iid),!o||!this._accessoryInfo.hasAdminPermissions(e.username)))return[2,{status:-70401}];n=e.hasEventNotifications(t.aid,t.iid),t.ev&&!n?(e.enableEventNotifications(t.aid,t.iid),i.subscribe(),w('[%s] Registered Characteristic "%s" on "%s" for events',e.remoteAddress,i.displayName,this.displayName)):!t.ev&&n&&(i.unsubscribe(),e.disableEventNotifications(t.aid,t.iid),w('[%s] Unregistered Characteristic "%s" on "%s" for events',e.remoteAddress,i.displayName,this.displayName))}if(null!=t.value){if(!i.props.perms.includes("pw"))return w("[%s] Tried writing to Characteristic which does not allow writing (aid of %s and iid of %s)",this.displayName,t.aid,t.iid),[2,{status:-70404}];if(i.props.adminOnlyAccess&&i.props.adminOnlyAccess.includes(1)&&((o=e.username&&this._accessoryInfo)||w("[%s] Could not verify admin permissions for Characteristic which requires admin permissions for write (aid of %s and iid of %s)",this.displayName,t.aid,t.iid),!o||!this._accessoryInfo.hasAdminPermissions(e.username)))return[2,{status:-70401}];if(i.props.perms.includes("aa")&&i.additionalAuthorizationHandler){a=void 0;try{a=i.additionalAuthorizationHandler(t.authData)}catch(e){console.warn("["+this.displayName+"] Additional authorization handler has thrown an error when checking authData: "+e.stack),a=!1}if(!a)return[2,{status:-70411}]}return i.props.perms.includes("tw")&&1!==r?(w("[%s] Tried writing to a timed write only Characteristic without properly preparing (iid of %s and aid of %s)",this.displayName,t.aid,t.iid),[2,{status:-70410}]):[2,i.handleSetRequest(t.value,e).then((function(e){return w('[%s] Setting Characteristic "%s" to value %s',s.displayName,i.displayName,t.value),{value:t.r&&e?(0,A.formatOutgoingCharacteristicValue)(e,i.props):void 0,status:0}}),(function(e){return w('[%s] Error setting Characteristic "%s" to value %s: ',s.displayName,i.displayName,t.value,y.HAPStatus[e]),{status:e}}))]}return[2,{status:0}]}))}))},t.prototype.handleResource=function(e,t){var r;if("image"===e["resource-type"]){var i=e.aid,n=void 0,o=void 0;return i?(n=this.getAccessoryByAID(i))&&n.activeCameraController&&(o=n.activeCameraController):this.activeCameraController&&(n=this,o=this.activeCameraController),o?void o.handleSnapshotRequest(e["image-height"],e["image-width"],null==n?void 0:n.displayName,e.reason).then((function(e){t(void 0,e)}),(function(e){t({httpCode:207,status:e})})):(w("[%s] received snapshot request though no camera controller was associated!"),void t({httpCode:404,status:-70409}))}w("[%s] received request for unsupported image type: "+e["resource-type"],null===(r=this._accessoryInfo)||void 0===r?void 0:r.username),t({httpCode:404,status:-70409})},t.prototype.handleHAPConnectionClosed=function(e){var t,r;this.activeCameraController&&this.activeCameraController.handleCloseConnection(e.sessionID);try{for(var i=c.__values(e.getRegisteredEvents()),n=i.next();!n.done;n=i.next()){var o=n.value.split("."),a=parseInt(o[0],10),s=parseInt(o[1],10),u=this.findCharacteristic(a,s);u&&u.unsubscribe()}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}e.clearRegisteredEvents()},t.prototype.handleServiceConfigurationChangeEvent=function(e){e.isPrimaryService||e!==this.primaryService?e.isPrimaryService&&e!==this.primaryService&&(void 0!==this.primaryService&&(this.primaryService.isPrimaryService=!1),this.primaryService=e):this.primaryService=void 0,this.bridged?this.emit("service-configurationChange",{service:e}):this.enqueueConfigurationUpdate()},t.prototype.handleCharacteristicChangeEvent=function(e,t,r){if(this.bridged)this.emit("service-characteristic-change",c.__assign(c.__assign({},r),{service:t}));else{if(!this._server)return;if(null==e.aid||null==r.characteristic.iid)return void w("[%s] Muting event notification for %s as ids aren't yet assigned!",e.displayName,r.characteristic.displayName);if(null!=r.context&&"object"==typeof r.context&&r.context.omitEventUpdate)return void w("[%s] Omitting event updates for %s as specified in the context object!",e.displayName,r.characteristic.displayName);if("event"!==r.reason&&r.oldValue===r.newValue&&r.characteristic.UUID!==m.Characteristic.ProgrammableSwitchEvent.UUID&&r.characteristic.UUID!==m.Characteristic.ButtonEvent.UUID)return;var i=r.characteristic.UUID,n=i===m.Characteristic.ButtonEvent.UUID||i===m.Characteristic.ProgrammableSwitchEvent.UUID||i===m.Characteristic.MotionDetected.UUID||i===m.Characteristic.ContactSensorState.UUID,o=(0,A.formatOutgoingCharacteristicValue)(r.newValue,r.characteristic.props);this._server.sendEventNotifications(e.aid,r.characteristic.iid,o,r.originator,n)}},t.prototype.sendCharacteristicWarning=function(e,t,r){this.handleCharacteristicWarning({characteristic:e,type:t,message:r,originatorChain:[e.displayName],stack:(new Error).stack})},t.prototype.handleCharacteristicWarning=function(e){var t;if(e.originatorChain=c.__spreadArray([this.displayName],c.__read(e.originatorChain),!1),!this.emit("characteristic-warning",e)){var r="[".concat(e.originatorChain.join("@"),"] ").concat(e.message);"error-message"===e.type||"timeout-read"===e.type||"timeout-write"===e.type?console.error(r):console.warn(r),w("[%s] Above characteristic warning was thrown at: %s",this.displayName,null!==(t=e.stack)&&void 0!==t?t:"unknown")}},t.prototype.setupServiceEventHandlers=function(e){e.on("service-configurationChange",this.handleServiceConfigurationChangeEvent.bind(this,e)),e.on("characteristic-change",this.handleCharacteristicChangeEvent.bind(this,this,e)),e.on("characteristic-warning",this.handleCharacteristicWarning.bind(this))},t.prototype._sideloadServices=function(e){var t,r,i=this;try{for(var n=c.__values(e),o=n.next();!o.done;o=n.next()){var a=o.value;this.setupServiceEventHandlers(a)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}this.services=e.slice(),this.getService(_.Service.AccessoryInformation).getCharacteristic(m.Characteristic.Identify).on("set",(function(e,t){if(e){i.identificationRequest(!0,t)}}))},t._generateSetupID=function(){for(var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",t="",r=0;r<4;r++){var i=Math.floor(36*Math.random());t+=e.charAt(i)}return t},t.serialize=function(e){var r={displayName:e.displayName,UUID:e.UUID,lastKnownUsername:e._accessoryInfo?e._accessoryInfo.username:void 0,category:e.category,services:[]},i={},n=!1;e.services.forEach((function(e){r.services.push(_.Service.serialize(e));var t=[];e.linkedServices.forEach((function(e){t.push(e.getServiceId())})),t.length>0&&(i[e.getServiceId()]=t,n=!0)})),n&&(r.linkedServices=i);var o=[];return Object.values(e.controllers).forEach((function(e){o.push({type:e.controller.controllerId(),services:t.serializeServiceMap(e.serviceMap)})})),e.serializedControllers&&Object.entries(e.serializedControllers).forEach((function(e){var r=c.__read(e,2),i=r[0],n=r[1];o.push({type:i,services:t.serializeServiceMap(n)})})),o.length>0&&(r.controllers=o),r},t.deserialize=function(e){var r,i,n=new t(e.displayName,e.UUID);n.lastKnownUsername=e.lastKnownUsername,n.category=e.category;var o=[],a={};if(e.services.forEach((function(e){var t=_.Service.deserialize(e);o.push(t),a[t.getServiceId()]=t})),e.linkedServices){var s=function(e,t){var r=a[e];if(!r)return"continue";t.forEach((function(e){var t=a[e];t&&r.addLinkedService(t)}))};try{for(var u=c.__values(Object.entries(e.linkedServices)),l=u.next();!l.done;l=u.next()){var h=c.__read(l.value,2);s(h[0],h[1])}}catch(e){r={error:e}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}}return e.controllers&&(n.serializedControllers={},e.controllers.forEach((function(e){n.serializedControllers[e.type]=t.deserializeServiceMap(e.services,a)}))),n._sideloadServices(o),n},t.cleanupAccessoryData=function(e){E.IdentifierCache.remove(e),C.AccessoryInfo.remove(e),S.ControllerStorage.remove(e)},t.serializeServiceMap=function(e){var t={};return Object.entries(e).forEach((function(e){var r=c.__read(e,2),i=r[0],n=r[1];n&&(t[i]=n.getServiceId())})),t},t.deserializeServiceMap=function(e,t){var r={};return Object.entries(e).forEach((function(e){var i=c.__read(e,2),n=i[0],o=i[1],a=t[o];a&&(r[n]=a)})),r},t.parseBindOption=function(e){var t,r,i=void 0,n=void 0,o=void 0;if(e.bind){var a=new Set(Array.isArray(e.bind)?e.bind:[e.bind]);if(a.has("::"))o="::",a.delete("::"),a.size&&(i=Array.from(a));else if(a.has("0.0.0.0"))n=!0,o="0.0.0.0",a.delete("0.0.0.0"),a.size&&(i=Array.from(a));else if(1===a.size){i=Array.from(a);var s=a.values().next().value;o=(d=p.default.isIP(s))&&4===d?"0.0.0.0":"::"}else if(a.size>1){i=Array.from(a);var u=!1;try{for(var l=c.__values(a),h=l.next();!h.done;h=l.next()){var d;s=h.value;if(0===(d=p.default.isIP(s))||6===d){u=!0;break}}}catch(e){t={error:e}}finally{try{h&&!h.done&&(r=l.return)&&r.call(l)}finally{if(t)throw t.error}}o=u?"::":"0.0.0.0"}}return{advertiserAddress:i,serviceRestrictedAddress:i,serviceDisableIpv6:n,serverAddress:o}},t.Categories=i,t.TIMEOUT_WARNING=3e3,t.TIMEOUT_AFTER_WARNING=6e3,t}(d.EventEmitter);t.Accessory=b},1370:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadDirectory=t.parseAccessoryJSON=t.parseServiceJSON=t.parseCharacteristicJSON=void 0;var i=r(1635),n=i.__importDefault(r(5753)),o=i.__importDefault(r(9896)),a=i.__importDefault(r(6928)),s=r(5745),c=r(9826),u=r(5876),l=i.__importStar(r(2997)),h=(0,n.default)("HAP-NodeJS:AccessoryLoader");function d(e){var t=e.cType,r=new c.Characteristic(e.manfDescription||t,t,{format:e.format,minValue:e.designedMinValue,maxValue:e.designedMaxValue,minStep:e.designedMinStep,unit:e.unit,perms:e.perms});r.value=e.initialValue,r.locals=e.locals;var i=e.onUpdate,n=e.onRead,o=e.onRegister;return i&&r.on("set",(function(e,t){i(e),t&&t()})),n&&r.on("get",(function(e){n((function(t){e(null,t)}))})),o&&o(r),r}function p(e){var t=e.sType,r=[];e.characteristics.forEach((function(e){var t=d(e);r.push(t)}));var i=null;r.forEach((function(e){"00000023-0000-1000-8000-0026BB765291"===e.UUID&&(i=e.value)}));var n=new u.Service(i||t,t,"".concat(i));return r.forEach((function(e){"00000023-0000-1000-8000-0026BB765291"!==e.UUID&&n.addCharacteristic(e)})),n}function f(e){var t=[];e.services.forEach((function(e){var r=p(e);t.push(r)}));var r=e.displayName;t.forEach((function(e){"0000003E-0000-1000-8000-0026BB765291"===e.UUID&&e.characteristics.forEach((function(e){"00000023-0000-1000-8000-0026BB765291"===e.UUID&&(r=e.value)}))}));var i=new s.Accessory(r,l.generate(r));return i.username=e.username,i.pincode=e.pincode,i.services.length=0,t.forEach((function(e){i.addService(e)})),i}t.parseCharacteristicJSON=d,t.parseServiceJSON=p,t.parseAccessoryJSON=f,t.loadDirectory=function(e){var t=[];return o.default.readdirSync(e).forEach((function(i){var n=i.split("_").pop();if("accessory.js"===n||"accessory.ts"===n){h("Parsing accessory: %s",i);var o=r(7506)(a.default.join(e,i)).accessory;t.push(o)}else if("accfactory.js"===n||"accfactory.ts"===n){h("Parsing accessory factory: %s",i);var s=r(7506)(a.default.join(e,i));t=t.concat(s)}})),t.map((function(e){return null==e?(console.log("Invalid accessory!"),!1):e instanceof s.Accessory?e:f(e)})).filter((function(e){return!!e}))}},310:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResolvedAdvertiser=t.AvahiAdvertiser=t.DBusInvokeError=t.BonjourHAPAdvertiser=t.CiaoAdvertiser=t.AdvertiserEvent=t.PairingFeatureFlag=t.StatusFlag=void 0;var i,n,o,a=r(1635),s=a.__importDefault(r(8318)),c=a.__importDefault(r(9640)),u=a.__importDefault(r(2613)),l=a.__importDefault(r(8404)),h=a.__importDefault(r(6982)),d=a.__importDefault(r(5753)),p=r(4434),f=r(4009),g=(0,d.default)("HAP-NodeJS:Advertiser");!function(e){e[e.NOT_PAIRED=1]="NOT_PAIRED",e[e.NOT_JOINED_WIFI=2]="NOT_JOINED_WIFI",e[e.PROBLEM_DETECTED=4]="PROBLEM_DETECTED"}(i||(t.StatusFlag=i={})),function(e){e[e.SUPPORTS_HARDWARE_AUTHENTICATION=1]="SUPPORTS_HARDWARE_AUTHENTICATION",e[e.SUPPORTS_SOFTWARE_AUTHENTICATION=2]="SUPPORTS_SOFTWARE_AUTHENTICATION"}(n||(t.PairingFeatureFlag=n={})),function(e){e.UPDATED_NAME="updated-name"}(o||(t.AdvertiserEvent=o={}));var m=function(e){function t(r,i,n){var o=e.call(this)||this;return o.accessoryInfo=r,o.setupHash=t.computeSetupHash(r),o.responder=s.default.getResponder(a.__assign({},i)),o.advertisedService=o.responder.createService(a.__assign({name:o.accessoryInfo.displayName,type:"hap",txt:t.createTxt(r,o.setupHash)},n)),o.advertisedService.on("name-change",o.emit.bind(o,"updated-name")),g("Preparing Advertiser for '".concat(o.accessoryInfo.displayName,"' using ciao backend!")),o}return a.__extends(t,e),t.prototype.initPort=function(e){this.advertisedService.updatePort(e)},t.prototype.startAdvertising=function(){return g("Starting to advertise '".concat(this.accessoryInfo.displayName,"' using ciao backend!")),this.advertisedService.advertise()},t.prototype.updateAdvertisement=function(e){var r=t.createTxt(this.accessoryInfo,this.setupHash);g("Updating txt record (txt: %o, silent: %d)",r,e),this.advertisedService.updateTxt(r,e)},t.prototype.destroy=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:return[4,this.responder.shutdown()];case 1:return e.sent(),this.removeAllListeners(),[2]}}))}))},t.createTxt=function(e,r){var i=[];return e.paired()||i.push(1),{"c#":e.getConfigVersion(),ff:t.ff(),id:e.username,md:e.model,pv:t.protocolVersion,"s#":1,sf:t.sf.apply(t,a.__spreadArray([],a.__read(i),!1)),ci:e.category,sh:r}},t.computeSetupHash=function(e){var t=h.default.createHash("sha512");return t.update(e.setupID+e.username.toUpperCase()),t.digest().slice(0,4).toString("base64")},t.ff=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=0;return e.forEach((function(e){return r|=e})),r},t.sf=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=0;return e.forEach((function(e){return r|=e})),r},t.protocolVersion="1.1",t.protocolVersionService="1.1.0",t}(p.EventEmitter);t.CiaoAdvertiser=m;var v=function(e){function t(t,r,i){var n=e.call(this)||this;return n.destroyed=!1,n.accessoryInfo=t,n.setupHash=m.computeSetupHash(t),n.serviceOptions=i,n.bonjour=(0,l.default)(r),g("Preparing Advertiser for '".concat(n.accessoryInfo.displayName,"' using bonjour-hap backend!")),n}return a.__extends(t,e),t.prototype.initPort=function(e){this.port=e},t.prototype.startAdvertising=function(){if((0,u.default)(!this.destroyed,"Can't advertise on a destroyed bonjour instance!"),null==this.port)throw new Error("Tried starting bonjour-hap advertisement without initializing port!");g("Starting to advertise '".concat(this.accessoryInfo.displayName,"' using bonjour-hap backend!")),this.advertisement&&this.destroy();var e=this.accessoryInfo.username.replace(/:/gi,"_")+".local";return this.advertisement=this.bonjour.publish(a.__assign({name:this.accessoryInfo.displayName,type:"hap",port:this.port,txt:m.createTxt(this.accessoryInfo,this.setupHash),host:e,addUnsafeServiceEnumerationRecord:!0},this.serviceOptions)),(0,f.PromiseTimeout)(1)},t.prototype.updateAdvertisement=function(e){var t=m.createTxt(this.accessoryInfo,this.setupHash);g("Updating txt record (txt: %o, silent: %d)",t,e),this.advertisement&&this.advertisement.updateTxt(t,e)},t.prototype.destroy=function(){var e=this;this.advertisement?this.advertisement.stop((function(){e.advertisement.destroy(),e.advertisement=void 0,e.bonjour.destroy()})):this.bonjour.destroy()},t}(p.EventEmitter);function y(e){return new Promise((function(t,r){var i=function(t){e.connection.removeListener("connect",n),r(t)},n=function(){e.connection.removeListener("error",i),t()};e.connection.once("connect",n),e.connection.once("error",i)}))}t.BonjourHAPAdvertiser=v;var C,S=function(e){function t(r){var i=e.call(this)||this;return Object.setPrototypeOf(i,t.prototype),i.name="DBusInvokeError",i.errorName=r.name,Array.isArray(r.message)&&1===r.message.length?i.message=r.message[0]:i.message=r.message.toString(),i}return a.__extends(t,e),t}(Error);function E(e,t,r,i,n,o){return new Promise((function(s,c){var u=a.__assign({destination:t,path:r,interface:i,member:n},o||{});e.invoke(u,(function(e,t){e?c(new S(e)):s(t)}))}))}t.DBusInvokeError=S,function(e){e[e.INVALID=0]="INVALID",e[e.REGISTERING=1]="REGISTERING",e[e.RUNNING=2]="RUNNING",e[e.COLLISION=3]="COLLISION",e[e.FAILURE=4]="FAILURE"}(C||(C={}));var _=function(e){function t(t){var r=e.call(this)||this;return r.accessoryInfo=t,r.setupHash=m.computeSetupHash(t),g("Preparing Advertiser for '".concat(r.accessoryInfo.displayName,"' using Avahi backend!")),r.bus=c.default.systemBus(),r.stateChangeHandler=r.handleStateChangedEvent.bind(r),r}return a.__extends(t,e),t.prototype.createTxt=function(){return Object.entries(m.createTxt(this.accessoryInfo,this.setupHash)).map((function(e){return Buffer.from(e[0]+"="+e[1])}))},t.prototype.initPort=function(e){this.port=e},t.prototype.startAdvertising=function(){return a.__awaiter(this,void 0,void 0,(function(){var e,r,i;return a.__generator(this,(function(n){switch(n.label){case 0:if(null==this.port)throw new Error("Tried starting Avahi advertisement without initializing port!");if(!this.bus)throw new Error("Tried to start Avahi advertisement on a destroyed advertiser!");return g("Starting to advertise '".concat(this.accessoryInfo.displayName,"' using Avahi backend!")),e=this,[4,t.avahiInvoke(this.bus,"/","Server","EntryGroupNew")];case 1:return e.path=n.sent(),[4,t.avahiInvoke(this.bus,this.path,"EntryGroup","AddService",{body:[-1,-1,0,this.accessoryInfo.displayName,"_hap._tcp","","",this.port,this.createTxt()],signature:"iiussssqaay"})];case 2:return n.sent(),[4,t.avahiInvoke(this.bus,this.path,"EntryGroup","Commit")];case 3:n.sent(),n.label=4;case 4:return n.trys.push([4,7,,8]),this.avahiServerInterface?[3,6]:(r=this,[4,t.avahiInterface(this.bus,"Server")]);case 5:r.avahiServerInterface=n.sent(),this.avahiServerInterface.on("StateChanged",this.stateChangeHandler),n.label=6;case 6:return[3,8];case 7:return i=n.sent(),console.warn("Failed to create listener for avahi-daemon server state. The system will not be notified about restarts of avahi-daemon and will therefore stay undiscoverable in those instances. Error message: "+i),i.stack&&g("Detailed error: "+i.stack),[3,8];case 8:return[2]}}))}))},t.prototype.handleStateChangedEvent=function(e){2===e&&this.path&&(g("Found Avahi daemon to have restarted!"),this.startAdvertising().catch((function(e){return console.error("Could not (re-)create mDNS advertisement. The HAP-Server won't be discoverable: "+e)})))},t.prototype.updateAdvertisement=function(e){return a.__awaiter(this,void 0,void 0,(function(){var r;return a.__generator(this,(function(i){switch(i.label){case 0:if(!this.bus)throw new Error("Tried to update Avahi advertisement on a destroyed advertiser!");if(!this.path)return g("Tried to update advertisement without a valid `path`!"),[2];g("Updating txt record (txt: %o, silent: %d)",m.createTxt(this.accessoryInfo,this.setupHash),e),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,t.avahiInvoke(this.bus,this.path,"EntryGroup","UpdateServiceTxt",{body:[-1,-1,0,this.accessoryInfo.displayName,"_hap._tcp","",this.createTxt()],signature:"iiusssaay"})];case 2:return i.sent(),[3,4];case 3:return r=i.sent(),console.error("Failed to update avahi advertisement: "+r),[3,4];case 4:return[2]}}))}))},t.prototype.destroy=function(){return a.__awaiter(this,void 0,void 0,(function(){var e;return a.__generator(this,(function(r){switch(r.label){case 0:if(!this.bus)throw new Error("Tried to destroy Avahi advertisement on a destroyed advertiser!");if(!this.path)return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t.avahiInvoke(this.bus,this.path,"EntryGroup","Free")];case 2:return r.sent(),[3,4];case 3:return e=r.sent(),g("Destroying Avahi advertisement failed: "+e),[3,4];case 4:this.path=void 0,r.label=5;case 5:return this.avahiServerInterface&&(this.avahiServerInterface.removeListener("StateChanged",this.stateChangeHandler),this.avahiServerInterface=void 0),this.bus.connection.stream.destroy(),this.bus=void 0,[2]}}))}))},t.isAvailable=function(){return a.__awaiter(this,void 0,void 0,(function(){var e,t;return a.__generator(this,(function(r){switch(r.label){case 0:e=c.default.systemBus(),r.label=1;case 1:r.trys.push([1,,9,10]),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,y(e)];case 3:return r.sent(),[3,5];case 4:return r.sent(),g("Avahi/DBus classified unavailable due to missing dbus interface!"),[2,!1];case 5:return r.trys.push([5,7,,8]),[4,this.avahiInvoke(e,"/","Server","GetVersionString")];case 6:return t=r.sent(),g("Detected Avahi over DBus interface running version '%s'.",t),[3,8];case 7:return r.sent(),g("Avahi/DBus classified unavailable due to missing avahi interface!"),[2,!1];case 8:return[2,!0];case 9:return e.connection.stream.destroy(),[7];case 10:return[2]}}))}))},t.avahiInvoke=function(e,t,r,i,n){return E(e,"org.freedesktop.Avahi",t,"org.freedesktop.Avahi.".concat(r),i,n)},t.avahiInterface=function(e,t){return new Promise((function(r,i){e.getService("org.freedesktop.Avahi").getInterface("/","org.freedesktop.Avahi."+t,(function(e,t){e||!t?i(null!=e?e:new Error("Interface not present!")):r(t)}))}))},t}(p.EventEmitter);t.AvahiAdvertiser=_;var T=["org.freedesktop.DBus.Error.AccessDenied","org.freedesktop.DBus.Error.AuthFailed","org.freedesktop.DBus.Error.InteractiveAuthorizationRequired"],A=function(e){function t(t){var r=e.call(this)||this;return r.accessoryInfo=t,r.setupHash=m.computeSetupHash(t),r.bus=c.default.systemBus(),g("Preparing Advertiser for '".concat(r.accessoryInfo.displayName,"' using systemd-resolved backend!")),r}return a.__extends(t,e),t.prototype.createTxt=function(){return Object.entries(m.createTxt(this.accessoryInfo,this.setupHash)).map((function(e){return[e[0].toString(),Buffer.from(e[1].toString())]}))},t.prototype.initPort=function(e){this.port=e},t.prototype.startAdvertising=function(){return a.__awaiter(this,void 0,void 0,(function(){var e,r;return a.__generator(this,(function(i){switch(i.label){case 0:if(null==this.port)throw new Error("Tried starting systemd-resolved advertisement without initializing port!");if(!this.bus)throw new Error("Tried to start systemd-resolved advertisement on a destroyed advertiser!");g("Starting to advertise '".concat(this.accessoryInfo.displayName,"' using systemd-resolved backend!")),i.label=1;case 1:return i.trys.push([1,3,,4]),e=this,[4,t.managerInvoke(this.bus,"RegisterService",{body:[this.accessoryInfo.displayName,this.accessoryInfo.displayName,"_hap._tcp",this.port,0,0,[this.createTxt()]],signature:"sssqqqaa{say}"})];case 2:return e.path=i.sent(),[3,4];case 3:throw(r=i.sent())instanceof S&&T.includes(r.errorName)&&(r.message="Permissions issue. See https://homebridge.io/w/mDNS-Options for more info. ".concat(r.message)),r;case 4:return[2]}}))}))},t.prototype.updateAdvertisement=function(e){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:if(!this.bus)throw new Error("Tried to update systemd-resolved advertisement on a destroyed advertiser!");return g("Updating txt record (txt: %o, silent: %d)",m.createTxt(this.accessoryInfo,this.setupHash),e),[4,this.stopAdvertising()];case 1:return t.sent(),[4,this.startAdvertising()];case 2:return t.sent(),[2]}}))}))},t.prototype.stopAdvertising=function(){return a.__awaiter(this,void 0,void 0,(function(){var e;return a.__generator(this,(function(r){switch(r.label){case 0:if(!this.bus)throw new Error("Tried to destroy systemd-resolved advertisement on a destroyed advertiser!");if(!this.path)return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t.managerInvoke(this.bus,"UnregisterService",{body:[this.path],signature:"o"})];case 2:return r.sent(),[3,4];case 3:return e=r.sent(),g("Destroying systemd-resolved advertisement failed: "+e),[3,4];case 4:this.path=void 0,r.label=5;case 5:return[2]}}))}))},t.prototype.destroy=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){switch(e.label){case 0:if(!this.bus)throw new Error("Tried to destroy systemd-resolved advertisement on a destroyed advertiser!");return[4,this.stopAdvertising()];case 1:return e.sent(),this.bus.connection.stream.destroy(),this.bus=void 0,[2]}}))}))},t.isAvailable=function(){return a.__awaiter(this,void 0,void 0,(function(){var e,t,r;return a.__generator(this,(function(i){switch(i.label){case 0:e=c.default.systemBus(),i.label=1;case 1:i.trys.push([1,,12,13]),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,y(e)];case 3:return i.sent(),[3,5];case 4:return i.sent(),g("systemd-resolved/DBus classified unavailable due to missing dbus interface!"),[2,!1];case 5:return i.trys.push([5,7,,8]),[4,this.managerInvoke(e,"ResolveHostname",{body:[0,"127.0.0.1",0,0],signature:"isit"})];case 6:return i.sent(),g("Detected systemd-resolved over DBus interface running version."),[3,8];case 7:return i.sent(),g("systemd-resolved/DBus classified unavailable due to missing systemd-resolved interface!"),[2,!1];case 8:return i.trys.push([8,10,,11]),[4,this.resolvedInvoke(e,"org.freedesktop.DBus.Properties","Get",{body:["org.freedesktop.resolve1.Manager","MulticastDNS"],signature:"ss"})];case 9:if("s"!==(t=i.sent())[0][0].type)throw new Error("Invalid type for MulticastDNS");return"yes"!==t[1][0]?(g("systemd-resolved/DBus classified unavailable because MulticastDNS is not enabled!"),[2,!1]):[3,11];case 10:return r=i.sent(),g("systemd-resolved/DBus classified unavailable due to failure checking system status: "+r),[2,!1];case 11:return[2,!0];case 12:return e.connection.stream.destroy(),[7];case 13:return[2]}}))}))},t.resolvedInvoke=function(e,t,r,i){return E(e,"org.freedesktop.resolve1","/org/freedesktop/resolve1",t,r,i)},t.managerInvoke=function(e,t,r){return this.resolvedInvoke(e,"org.freedesktop.resolve1.Manager",t,r)},t}(p.EventEmitter);t.ResolvedAdvertiser=A},3186:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Bridge=void 0;var i=r(1635),n=function(e){function t(t,r){var i=e.call(this,t,r)||this;return i._isBridge=!0,i}return i.__extends(t,e),t}(r(5745).Accessory);t.Bridge=n},9826:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Characteristic=t.CharacteristicEventTypes=t.ChangeReason=t.Access=t.Perms=t.Units=t.Formats=void 0;var i,n,o,a,s,c,u=r(1635),l=u.__importDefault(r(2613)),h=u.__importDefault(r(5753)),d=r(4434),p=r(589),f=r(9621),g=r(8073),m=r(7739),v=r(8066),y=r(2997),C=(0,h.default)("HAP-NodeJS:Characteristic");!function(e){e.BOOL="bool",e.INT="int",e.FLOAT="float",e.STRING="string",e.UINT8="uint8",e.UINT16="uint16",e.UINT32="uint32",e.UINT64="uint64",e.DATA="data",e.TLV8="tlv8",e.ARRAY="array",e.DICTIONARY="dict"}(i||(t.Formats=i={})),function(e){e.CELSIUS="celsius",e.PERCENTAGE="percentage",e.ARC_DEGREE="arcdegrees",e.LUX="lux",e.SECONDS="seconds"}(n||(t.Units=n={})),function(e){e.READ="pr",e.WRITE="pw",e.PAIRED_READ="pr",e.PAIRED_WRITE="pw",e.NOTIFY="ev",e.EVENTS="ev",e.ADDITIONAL_AUTHORIZATION="aa",e.TIMED_WRITE="tw",e.HIDDEN="hd",e.WRITE_RESPONSE="wr"}(o||(t.Perms=o={})),function(e){e[e.READ=0]="READ",e[e.WRITE=1]="WRITE",e[e.NOTIFY=2]="NOTIFY"}(a||(t.Access=a={})),function(e){e.WRITE="write",e.UPDATE="update",e.READ="read",e.EVENT="event"}(s||(t.ChangeReason=s={})),function(e){e.GET="get",e.SET="set",e.CHANGE="change",e.SUBSCRIBE="subscribe",e.UNSUBSCRIBE="unsubscribe",e.CHARACTERISTIC_WARNING="characteristic-warning"}(c||(t.CharacteristicEventTypes=c={}));var S=function(){function e(e){(0,l.default)((0,v.isNumericFormat)(e.format),"Cannot instantiate valid values iterable when format is not numeric. Found "+e.format),this.props=e}return e.prototype[Symbol.iterator]=function(){var e,t,r,i,n,o,a,s,c;return u.__generator(this,(function(l){switch(l.label){case 0:if(!this.props.validValues)return[3,9];l.label=1;case 1:l.trys.push([1,6,7,8]),e=u.__values(this.props.validValues),t=e.next(),l.label=2;case 2:return t.done?[3,5]:[4,t.value];case 3:l.sent(),l.label=4;case 4:return t=e.next(),[3,2];case 5:return[3,8];case 6:return r=l.sent(),s={error:r},[3,8];case 7:try{t&&!t.done&&(c=e.return)&&c.call(e)}finally{if(s)throw s.error}return[7];case 8:return[3,13];case 9:if(i=0,n=void 0,o=1,this.props.validValueRanges)i=this.props.validValueRanges[0],n=this.props.validValueRanges[1];else if(null!=this.props.minValue&&null!=this.props.maxValue)i=this.props.minValue,n=this.props.maxValue,null!=this.props.minStep&&(o=this.props.minStep);else{if(!(0,v.isUnsignedNumericFormat)(this.props.format))throw new Error("Could not find valid iterator strategy for props: "+JSON.stringify(this.props));n=(0,v.numericUpperBound)(this.props.format)}a=i,l.label=10;case 10:return a<=n?[4,a]:[3,13];case 11:l.sent(),l.label=12;case 12:return a+=o,[3,10];case 13:return[2]}}))},e}(),E=/^-?\d+$/;function _(e){var t=-70402;if(E.test(e.message)){var r=parseInt(e.message,10);(0,p.IsKnownHAPStatusError)(r)&&(t=r)}return t}function T(e,t){return null==e?t:null==t?e:Math.max(e,t)}function A(e,t){return null==e?t:null==t?e:Math.min(e,t)}var I=function(e){function t(t,r,i){var n=e.call(this)||this;return n.iid=null,n.value=null,n.status=null,n.statusCode=0,n.subscriptions=0,n.displayName=t,n.UUID=r,n.props={format:"int",perms:["ev"]},n.setProps(i||{}),n}return u.__extends(t,e),t.prototype.onGet=function(e){return"function"!=typeof e?(this.characteristicWarning(".onGet handler must be a function"),this):(this.getHandler=e,this)},t.prototype.removeOnGet=function(){return this.getHandler=void 0,this},t.prototype.onSet=function(e){return"function"!=typeof e?(this.characteristicWarning(".onSet handler must be a function"),this):(this.setHandler=e,this)},t.prototype.removeOnSet=function(){return this.setHandler=void 0,this},t.prototype.setProps=function(e){(0,l.default)(e,"props cannot be undefined when setting props");var r=!1;if(e.format&&(r=this.props.format!==e.format,this.props.format=e.format),e.perms&&((0,l.default)(e.perms.length>0,"characteristic prop perms cannot be empty array"),this.props.perms=e.perms),void 0!==e.unit&&(this.props.unit=null!=e.unit?e.unit:void 0),void 0!==e.description&&(this.props.description=null!=e.description?e.description:void 0),void 0!==e.minValue&&(null===e.minValue?e.minValue=void 0:(0,v.isNumericFormat)(this.props.format)?"number"==typeof e.minValue&&Number.isFinite(e.minValue)?e.minValue<(0,v.numericLowerBound)(this.props.format)?(this.characteristicWarning("Characteristic Property 'minValue' was set to "+e.minValue+", but for numeric format "+this.props.format+" minimum possible is "+(0,v.numericLowerBound)(this.props.format),"error-message"),e.minValue=(0,v.numericLowerBound)(this.props.format)):e.minValue>(0,v.numericUpperBound)(this.props.format)&&(this.characteristicWarning("Characteristic Property 'minValue' was set to "+e.minValue+", but for numeric format "+this.props.format+" maximum possible is "+(0,v.numericUpperBound)(this.props.format),"error-message"),e.minValue=(0,v.numericLowerBound)(this.props.format)):(this.characteristicWarning("Characteristic Property 'minValue' must be a finite number, received \"".concat(e.minValue,'" (').concat(typeof e.minValue,")"),"error-message"),e.minValue=void 0):(this.characteristicWarning("Characteristic Property 'minValue' can only be set for characteristics with numeric format, but not for "+this.props.format,"error-message"),e.minValue=void 0),this.props.minValue=e.minValue),void 0!==e.maxValue&&(null===e.maxValue?e.maxValue=void 0:(0,v.isNumericFormat)(this.props.format)?"number"==typeof e.maxValue&&Number.isFinite(e.maxValue)?e.maxValue>(0,v.numericUpperBound)(this.props.format)?(this.characteristicWarning("Characteristic Property 'maxValue' was set to "+e.maxValue+", but for numeric format "+this.props.format+" maximum possible is "+(0,v.numericUpperBound)(this.props.format),"error-message"),e.maxValue=(0,v.numericUpperBound)(this.props.format)):e.maxValue<(0,v.numericLowerBound)(this.props.format)&&(this.characteristicWarning("Characteristic Property 'maxValue' was set to "+e.maxValue+", but for numeric format "+this.props.format+" minimum possible is "+(0,v.numericLowerBound)(this.props.format),"error-message"),e.maxValue=(0,v.numericUpperBound)(this.props.format)):(this.characteristicWarning("Characteristic Property 'maxValue' must be a finite number, received \"".concat(e.maxValue,'" (').concat(typeof e.maxValue,")"),"error-message"),e.maxValue=void 0):(this.characteristicWarning("Characteristic Property 'maxValue' can only be set for characteristics with numeric format, but not for "+this.props.format,"error-message"),e.maxValue=void 0),this.props.maxValue=e.maxValue),void 0!==e.minStep&&(null===e.minStep?this.props.minStep=void 0:(0,v.isNumericFormat)(this.props.format)?(e.minStep<1&&(0,v.isIntegerNumericFormat)(this.props.format)&&this.characteristicWarning("Characteristic Property `minStep` was set to a value lower than 1, this will have no effect on format `"+this.props.format),this.props.minStep=e.minStep):this.characteristicWarning("Characteristic Property `minStep` can only be set for characteristics with numeric format, but not for "+this.props.format,"error-message")),void 0!==e.maxLen&&(null===e.maxLen?this.props.maxLen=void 0:"string"!==this.props.format?this.characteristicWarning("Characteristic Property `maxLen` can only be set for characteristics with format `STRING`, but not for "+this.props.format,"error-message"):(e.maxLen>256&&(this.characteristicWarning("Characteristic Property string `maxLen` cannot be bigger than 256"),e.maxLen=256),this.props.maxLen=e.maxLen)),void 0!==e.maxDataLen&&(null===e.maxDataLen?this.props.maxDataLen=void 0:"data"!==this.props.format?this.characteristicWarning("Characteristic Property `maxDataLen` can only be set for characteristics with format `DATA`, but not for "+this.props.format,"error-message"):this.props.maxDataLen=e.maxDataLen),void 0!==e.validValues&&(null===e.validValues?this.props.validValues=void 0:(0,v.isNumericFormat)(this.props.format)?((0,l.default)(e.validValues.length,"characteristic prop validValues cannot be empty array"),this.props.validValues=e.validValues):this.characteristicWarning("Characteristic Property `validValues` was supplied for non numeric format "+this.props.format)),void 0!==e.validValueRanges&&(null===e.validValueRanges?this.props.validValueRanges=void 0:(0,v.isNumericFormat)(this.props.format)?((0,l.default)(2===e.validValueRanges.length,"characteristic prop validValueRanges must have a length of 2"),this.props.validValueRanges=e.validValueRanges):this.characteristicWarning("Characteristic Property `validValueRanges` was supplied for non numeric format "+this.props.format)),void 0!==e.adminOnlyAccess&&(this.props.adminOnlyAccess=null!=e.adminOnlyAccess?e.adminOnlyAccess:void 0),null!=this.props.minValue&&null!=this.props.maxValue&&this.props.minValue>this.props.maxValue)throw this.props.minValue=void 0,this.props.maxValue=void 0,new Error("Error setting CharacteristicsProps for '"+this.displayName+"': 'minValue' cannot be greater or equal the 'maxValue'!");if(((0,v.isNumericFormat)(this.props.format)||"string"===this.props.format)&&null!=this.value&&!r&&0===this.statusCode&&this.UUID!==t.ProgrammableSwitchEvent.UUID){var i=this.validateUserInput(this.value,"debug-message");i!==this.value&&this.updateValue(i)}return this},t.prototype.validValuesIterator=function(){return new S(this.props)},t.prototype.setupAdditionalAuthorization=function(e){this.props.perms.includes("aa")||this.props.perms.push("aa"),this.additionalAuthorizationHandler=e},t.prototype.getValue=function(e,t){this.handleGetRequest(void 0,t).then((function(t){e&&e(null,t)}),(function(t){e&&e(t)}))},t.prototype.setValue=function(e,t,r){if(e instanceof Error)return this.statusCode=e instanceof g.HapStatusError?e.hapStatus:_(e),this.status=e,t&&t(),this;t&&!r&&"function"!=typeof t&&(r=t,t=void 0);try{e=this.validateUserInput(e)}catch(e){return this.characteristicWarning((null==e?void 0:e.message)+"","error-message",null==e?void 0:e.stack),t&&t(e),this}return this.handleSetRequest(e,void 0,r).then((function(e){t&&(e?t(null,e):t(null))}),(function(e){t&&t(e)})),this},t.prototype.updateValue=function(e,t,r){if(e instanceof Error)return this.statusCode=e instanceof g.HapStatusError?e.hapStatus:_(e),this.status=e,t&&t(),this;t&&!r&&"function"!=typeof t&&(r=t,t=void 0);try{e=this.validateUserInput(e)}catch(e){return this.characteristicWarning((null==e?void 0:e.message)+"","error-message",null==e?void 0:e.stack),t&&t(),this}this.statusCode=0,this.status=null;var i=this.value;return this.value=e,t&&t(),this.emit("change",{originator:void 0,oldValue:i,newValue:e,reason:"update",context:r}),this},t.prototype.sendEventNotification=function(e,t){this.statusCode=0,this.status=null,e=this.validateUserInput(e);var r=this.value;return this.value=e,this.emit("change",{originator:void 0,oldValue:r,newValue:e,reason:"event",context:t}),this},t.prototype.handleGetRequest=function(e,r){return u.__awaiter(this,void 0,void 0,(function(){var i,n,o,a,s=this;return u.__generator(this,(function(c){switch(c.label){case 0:if(!this.props.perms.includes("pr"))throw-70405;if(this.UUID===t.ProgrammableSwitchEvent.UUID)return[2,null];if(!this.getHandler)return[3,4];this.listeners("get").length>0&&this.characteristicWarning("Ignoring on('get') handler as onGet handler was defined instead"),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,this.getHandler(r,e)];case 2:i=c.sent(),this.statusCode=0,this.status=null;try{i=this.validateUserInput(i)}catch(e){return this.characteristicWarning("An illegal value was supplied by the read handler for characteristic: ".concat(null==e?void 0:e.message),"warn-message",null==e?void 0:e.stack),this.statusCode=-70402,this.status=e,[2,Promise.reject(-70402)]}return n=this.value,this.value=i,n!==i&&this.emit("change",{originator:e,oldValue:n,newValue:i,reason:"read",context:r}),[2,i];case 3:throw"number"==typeof(o=c.sent())?(a=new g.HapStatusError(o),this.statusCode=a.hapStatus,this.status=a):o instanceof g.HapStatusError?(this.statusCode=o.hapStatus,this.status=o):(this.characteristicWarning("Unhandled error thrown inside read handler for characteristic: ".concat(null==o?void 0:o.message),"error-message",null==o?void 0:o.stack),this.statusCode=-70402,this.status=o),this.statusCode;case 4:if(0===this.listeners("get").length){if(this.statusCode)throw this.statusCode;try{return[2,this.validateUserInput(this.value)]}catch(e){return this.characteristicWarning("An illegal value was supplied by setting `value` for characteristic: ".concat(null==e?void 0:e.message),"warn-message",null==e?void 0:e.stack),[2,Promise.reject(-70402)]}}return[2,new Promise((function(t,i){try{s.emit("get",(0,m.once)((function(n,o){if(n){if("number"==typeof n){var a=new g.HapStatusError(n);s.statusCode=a.hapStatus,s.status=a}else n instanceof g.HapStatusError?(s.statusCode=n.hapStatus,s.status=n):(C("[%s] Received error from get handler %s",s.displayName,n.stack),s.statusCode=_(n),s.status=n);i(s.statusCode)}else{s.statusCode=0,s.status=null,o=s.validateUserInput(o);var c=s.value;s.value=o,t(o),c!==o&&s.emit("change",{originator:e,oldValue:c,newValue:o,reason:"read",context:r})}})),r,e)}catch(e){s.characteristicWarning("Unhandled error thrown inside read handler for characteristic: ".concat(null==e?void 0:e.message),"error-message",null==e?void 0:e.stack),s.statusCode=-70402,s.status=e,i(-70402)}}))]}}))}))},t.prototype.handleSetRequest=function(e,t,r){return u.__awaiter(this,void 0,void 0,(function(){var i,n,o,a,s=this;return u.__generator(this,(function(c){switch(c.label){case 0:if(this.statusCode=0,this.status=null,void 0!==t)try{e=this.validateClientSuppliedValue(e)}catch(e){return C("[".concat(this.displayName,"]"),e.message),[2,Promise.reject(-70410)]}if(i=this.value,!this.setHandler)return[3,4];this.listeners("set").length>0&&this.characteristicWarning("Ignoring on('set') handler as onSet handler was defined instead"),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,this.setHandler(e,r,t)];case 2:return n=c.sent(),this.statusCode=0,this.status=null,null!=n&&this.props.perms.includes("wr")?(this.value=this.validateUserInput(n),[2,this.value]):(null!=n&&this.characteristicWarning("SET handler returned write response value, though the characteristic doesn't support write response","debug-message"),this.value=e,this.emit("change",{originator:t,oldValue:i,newValue:e,reason:"write",context:r}),[2]);case 3:throw"number"==typeof(o=c.sent())?(a=new g.HapStatusError(o),this.statusCode=a.hapStatus,this.status=a):o instanceof g.HapStatusError?(this.statusCode=o.hapStatus,this.status=o):(this.characteristicWarning("Unhandled error thrown inside write handler for characteristic: ".concat(null==o?void 0:o.message),"error-message",null==o?void 0:o.stack),this.statusCode=-70402,this.status=o),this.statusCode;case 4:return 0===this.listeners("set").length?(this.value=e,this.emit("change",{originator:t,oldValue:i,newValue:e,reason:"write",context:r}),[2,Promise.resolve()]):[2,new Promise((function(n,o){try{s.emit("set",e,(0,m.once)((function(a,c){if(a){if("number"==typeof a){var u=new g.HapStatusError(a);s.statusCode=u.hapStatus,s.status=u}else a instanceof g.HapStatusError?(s.statusCode=a.hapStatus,s.status=a):(C("[%s] Received error from set handler %s",s.displayName,a.stack),s.statusCode=_(a),s.status=a);o(s.statusCode)}else s.statusCode=0,s.status=null,null!=c&&s.props.perms.includes("wr")?(s.value=s.validateUserInput(c),n(s.value)):(null!=c&&s.characteristicWarning("SET handler returned write response value, though the characteristic doesn't support write response","debug-message"),s.value=e,n(),s.emit("change",{originator:t,oldValue:i,newValue:e,reason:"write",context:r}))})),r,t)}catch(e){s.characteristicWarning("Unhandled error thrown inside write handler for characteristic: ".concat(null==e?void 0:e.message),"error-message",null==e?void 0:e.stack),s.statusCode=-70402,s.status=e,o(-70402)}}))]}}))}))},t.prototype.subscribe=function(){0===this.subscriptions&&this.emit("subscribe"),this.subscriptions++},t.prototype.unsubscribe=function(){var e=1===this.subscriptions;this.subscriptions--,this.subscriptions=Math.max(this.subscriptions,0),e&&this.emit("unsubscribe")},t.prototype.getDefaultValue=function(){var e;switch(this.props.format){case"bool":return!1;case"string":switch(this.UUID){case t.Manufacturer.UUID:return"Default-Manufacturer";case t.Model.UUID:return"Default-Model";case t.SerialNumber.UUID:return"Default-SerialNumber";case t.FirmwareRevision.UUID:return"0.0.0";default:return""}case"data":case"tlv8":return"";case"dict":return{};case"array":return[];case"int":case"float":case"uint8":case"uint16":case"uint32":case"uint64":return this.UUID===t.CurrentTemperature.UUID?0:(null===(e=this.props.validValues)||void 0===e?void 0:e.length)&&"number"==typeof this.props.validValues[0]?this.props.validValues[0]:"number"==typeof this.props.minValue&&Number.isFinite(this.props.minValue)?this.props.minValue:0;default:return 0}},t.prototype.validateClientSuppliedValue=function(e){if(null==e)throw new Error("Client supplied invalid value for ".concat(this.props.format,": ").concat(e));switch(this.props.format){case"bool":if("boolean"==typeof e)return e;if("number"==typeof e&&(1===e||0===e))return Boolean(e);throw new Error("Client supplied invalid type for ".concat(this.props.format,': "').concat(e,'" (').concat(typeof e,")"));case"int":case"float":case"uint8":case"uint16":case"uint32":case"uint64":if("boolean"==typeof e&&(e=e?1:0),"number"!=typeof e||!Number.isFinite(e))throw new Error("Client supplied invalid type for ".concat(this.props.format,': "').concat(e,'" (').concat(typeof e,")"));var t=T(this.props.minValue,(0,v.numericLowerBound)(this.props.format)),r=A(this.props.maxValue,(0,v.numericUpperBound)(this.props.format));if("number"==typeof t&&e<t)throw new Error("Client supplied value of ".concat(e," is less than the minimum allowed value of ").concat(t));if("number"==typeof r&&e>r)throw new Error("Client supplied value of ".concat(e," is greater than the maximum allowed value of ").concat(r));if(this.props.validValues&&!this.props.validValues.includes(e))throw new Error("Client supplied value of ".concat(e," is not in ").concat(this.props.validValues.toString()));if(this.props.validValueRanges&&2===this.props.validValueRanges.length){if(e<this.props.validValueRanges[0])throw new Error("Client supplied value of ".concat(e," is less than the minimum allowed value of ").concat(this.props.validValueRanges[0]));if(e>this.props.validValueRanges[1])throw new Error("Client supplied value of ".concat(e," is greater than the maximum allowed value of ").concat(this.props.validValueRanges[1]))}return e;case"string":if("string"!=typeof e)throw new Error("Client supplied invalid type for ".concat(this.props.format,': "').concat(e,'" (').concat(typeof e,")"));var i=null!=this.props.maxLen?this.props.maxLen:64;if(e.length>i)throw new Error("Client supplied value length of ".concat(e.length," exceeds maximum length allowed of ").concat(i));return e;case"data":if("string"!=typeof e)throw new Error("Client supplied invalid type for ".concat(this.props.format,': "').concat(e,'" (').concat(typeof e,")"));i=null!=this.props.maxDataLen?this.props.maxDataLen:2097152;if(e.length>i)throw new Error("Client supplied value length of ".concat(e.length," exceeds maximum length allowed of ").concat(i));return e;case"tlv8":if("string"!=typeof e)throw new Error("Client supplied invalid type for ".concat(this.props.format,': "').concat(e,'" (').concat(typeof e,")"));return e}return e},t.prototype.validateUserInput=function(e,r){var i;if(void 0===r&&(r="warn-message"),null===e){if(this.UUID===t.Model.UUID||this.UUID===t.SerialNumber.UUID)return this.characteristicWarning("characteristic must have a non null value otherwise HomeKit will reject this accessory, ignoring new value","error-message"),this.value;if("data"===this.props.format||"tlv8"===this.props.format)return e;if(!this.UUID.endsWith(y.BASE_UUID))return e;if(this.UUID===t.ProgrammableSwitchEvent.UUID)return e;if(this.characteristicWarning("characteristic was supplied illegal value: null! Home App will reject null for Apple defined characteristics",r),null!==this.value)return this.value}switch(this.props.format){case"bool":return"boolean"==typeof e?e:"number"==typeof e?1===e:"string"==typeof e?"1"===e||"true"===e:(this.characteristicWarning("characteristic value expected boolean and received "+typeof e,r),!1);case"int":case"float":case"uint8":case"uint16":case"uint32":case"uint64":"boolean"==typeof e&&(e=e?1:0),"string"==typeof e&&(e="float"===this.props.format?parseFloat(e):parseInt(e,10)),"number"==typeof e&&Number.isFinite(e)||(this.characteristicWarning('characteristic value expected valid finite number and received "'.concat(e,'" (').concat(typeof e,")"),r),e="number"==typeof this.value?this.value:this.props.minValue||0);var n=T(this.props.minValue,(0,v.numericLowerBound)(this.props.format)),o=A(this.props.maxValue,(0,v.numericUpperBound)(this.props.format)),a=void 0;if(null!=(a="float"===this.props.format?this.props.minStep:T(this.props.minStep,1))&&a>0){var s=null!=this.props.minValue?this.props.minValue:0;e=a*Math.round((e-s)/a)+s}return null!=n&&e<n&&(this.characteristicWarning("characteristic was supplied illegal value: number ".concat(e," exceeded minimum of ").concat(n),r),e=n),null!=o&&e>o&&(this.characteristicWarning("characteristic was supplied illegal value: number ".concat(e," exceeded maximum of ").concat(o),r),e=o),this.props.validValues&&!this.props.validValues.includes(e)?(this.characteristicWarning("characteristic value ".concat(e," is not contained in valid values array"),r),this.props.validValues.includes(this.value)?this.value:this.props.validValues[0]||0):(this.props.validValueRanges&&2===this.props.validValueRanges.length&&(e<this.props.validValueRanges[0]?(this.characteristicWarning("characteristic was supplied illegal value: number ".concat(e," not contained in valid value range of           ").concat(this.props.validValueRanges,", supplying illegal values will throw errors in the future"),r),e=this.props.validValueRanges[0]):e>this.props.validValueRanges[1]&&(this.characteristicWarning("characteristic was supplied illegal value: number ".concat(e," not contained in valid value range of           ").concat(this.props.validValueRanges,", supplying illegal values will throw errors in the future"),r),e=this.props.validValueRanges[1])),e);case"string":if("number"==typeof e&&(this.characteristicWarning("characteristic was supplied illegal value: number instead of string, supplying illegal values will throw errors in the future",r),e=String(e)),"string"!=typeof e&&(this.characteristicWarning("characteristic value expected string and received "+typeof e,r),e="string"==typeof this.value?this.value:e+""),e.length<=1&&(this.UUID===t.Model.UUID||this.UUID===t.SerialNumber.UUID))return this.characteristicWarning("[".concat(this.displayName,"] characteristic must have a length of more than 1 character otherwise         HomeKit will reject this accessory, ignoring new value"),r),this.value;var c=null!==(i=this.props.maxLen)&&void 0!==i?i:64;return e.length>c&&(this.characteristicWarning("characteristic was supplied illegal value: string '".concat(e,"' exceeded max length of ").concat(c),r),e=e.substring(0,c)),e;case"data":if("string"!=typeof e)throw new Error("characteristic with DATA format must have string value");if(null!=this.props.maxDataLen&&e.length>this.props.maxDataLen)throw new Error("characteristic with DATA format exceeds specified maxDataLen");return e;case"tlv8":return void 0===e?(this.characteristicWarning("characteristic was supplied illegal value: undefined",r),this.value):e}return void 0===e?(this.characteristicWarning("characteristic was supplied illegal value: undefined","error-message"),this.value):e},t.prototype._assignID=function(e,t,r,i){this.iid=e.getIID(t,r,i,this.UUID)},t.prototype.characteristicWarning=function(e,t,r){void 0===t&&(t="warn-message"),void 0===r&&(r=(new Error).stack),this.emit("characteristic-warning",t,e,r)},t.prototype.removeAllListeners=function(t){return t||(this.removeOnGet(),this.removeOnSet()),e.prototype.removeAllListeners.call(this,t)},t.prototype.replaceBy=function(e){var t=this;this.props=e.props,this.updateValue(e.value);var r=e.listeners("get");r.length&&(this.removeAllListeners("get"),r.forEach((function(e){return t.addListener("get",e)}))),this.removeOnGet(),e.getHandler&&this.onGet(e.getHandler);var i=e.listeners("set");i.length&&(this.removeAllListeners("set"),i.forEach((function(e){return t.addListener("set",e)}))),this.removeOnSet(),e.setHandler&&this.onSet(e.setHandler)},t.prototype.toHAP=function(e){return u.__awaiter(this,arguments,void 0,(function(e,r){var i,n,o,a=this;return void 0===r&&(r=!0),u.__generator(this,(function(s){switch(s.label){case 0:return i=this.internalHAPRepresentation(),this.props.perms.includes("pr")?[3,1]:(i.value=void 0,[3,6]);case 1:return this.UUID!==t.ProgrammableSwitchEvent.UUID?[3,2]:(i.value=null,[3,6]);case 2:return r?[4,this.handleGetRequest(e).catch((function(){var e=a.getDefaultValue();return C("[%s] Error getting value for characteristic on /accessories request. Returning default value instead: %s",a.displayName,"".concat(e)),e}))]:[3,4];case 3:return o=s.sent(),[3,5];case 4:o=this.value,s.label=5;case 5:n=o,i.value=(0,v.formatOutgoingCharacteristicValue)(n,this.props),s.label=6;case 6:return[2,i]}}))}))},t.prototype.internalHAPRepresentation=function(){return(0,l.default)(this.iid,"iid cannot be undefined for characteristic '"+this.displayName+"'"),{type:(0,y.toShortForm)(this.UUID),iid:this.iid,value:null,perms:this.props.perms,description:this.props.description||this.displayName,format:this.props.format,unit:this.props.unit,minValue:this.props.minValue,maxValue:this.props.maxValue,minStep:this.props.minStep,maxLen:this.props.maxLen,maxDataLen:this.props.maxDataLen,"valid-values":this.props.validValues,"valid-values-range":this.props.validValueRanges}},t.serialize=function(e){var r;return"Characteristic"!==e.constructor.name&&(r=e.constructor.name),{displayName:e.displayName,UUID:e.UUID,eventOnlyCharacteristic:e.UUID===t.ProgrammableSwitchEvent.UUID,constructorName:r,value:e.value,props:(0,f.clone)({},e.props)}},t.deserialize=function(e){var r;e.constructorName&&e.constructorName.charAt(0).toUpperCase()===e.constructorName.charAt(0)&&t[e.constructorName]?((r=new(0,t[e.constructorName])).displayName=e.displayName,r.setProps(e.props)):r=new t(e.displayName,e.UUID,e.props);return r.value=e.value,r},t.Formats=i,t.Units=n,t.Perms=o,t}(d.EventEmitter);t.Characteristic=I,r(651)},589:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HAPServer=t.HAPServerEventTypes=t.HAPPairingHTTPCode=t.HAPHTTPCode=t.Status=t.Codes=t.IsKnownHAPStatusError=t.HAPStatus=t.TLVErrorCode=void 0;var i,n,o,a,s,c=r(1635),u=c.__importDefault(r(6982)),l=c.__importDefault(r(5753)),h=r(4434),d=r(4618),p=c.__importDefault(r(8947)),f=r(7016),g=r(8602),m=r(9593),v=c.__importStar(r(8)),y=r(7739),C=c.__importStar(r(3314)),S=(0,l.default)("HAP-NodeJS:HAPServer");!function(e){e[e.UNKNOWN=1]="UNKNOWN",e[e.INVALID_REQUEST=2]="INVALID_REQUEST",e[e.AUTHENTICATION=2]="AUTHENTICATION",e[e.BACKOFF=3]="BACKOFF",e[e.MAX_PEERS=4]="MAX_PEERS",e[e.MAX_TRIES=5]="MAX_TRIES",e[e.UNAVAILABLE=6]="UNAVAILABLE",e[e.BUSY=7]="BUSY"}(i||(t.TLVErrorCode=i={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.INSUFFICIENT_PRIVILEGES=-70401]="INSUFFICIENT_PRIVILEGES",e[e.SERVICE_COMMUNICATION_FAILURE=-70402]="SERVICE_COMMUNICATION_FAILURE",e[e.RESOURCE_BUSY=-70403]="RESOURCE_BUSY",e[e.READ_ONLY_CHARACTERISTIC=-70404]="READ_ONLY_CHARACTERISTIC",e[e.WRITE_ONLY_CHARACTERISTIC=-70405]="WRITE_ONLY_CHARACTERISTIC",e[e.NOTIFICATION_NOT_SUPPORTED=-70406]="NOTIFICATION_NOT_SUPPORTED",e[e.OUT_OF_RESOURCE=-70407]="OUT_OF_RESOURCE",e[e.OPERATION_TIMED_OUT=-70408]="OPERATION_TIMED_OUT",e[e.RESOURCE_DOES_NOT_EXIST=-70409]="RESOURCE_DOES_NOT_EXIST",e[e.INVALID_VALUE_IN_REQUEST=-70410]="INVALID_VALUE_IN_REQUEST",e[e.INSUFFICIENT_AUTHORIZATION=-70411]="INSUFFICIENT_AUTHORIZATION",e[e.NOT_ALLOWED_IN_CURRENT_STATE=-70412]="NOT_ALLOWED_IN_CURRENT_STATE"}(n||(t.HAPStatus=n={})),t.IsKnownHAPStatusError=function(e){return e>=-70412&&e<=-70401},t.Codes=i,t.Status=n,function(e){e[e.OK=200]="OK",e[e.NO_CONTENT=204]="NO_CONTENT",e[e.MULTI_STATUS=207]="MULTI_STATUS",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",e[e.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",e[e.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE"}(o||(t.HAPHTTPCode=o={})),function(e){e[e.OK=200]="OK",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.METHOD_NOT_ALLOWED=405]="METHOD_NOT_ALLOWED",e[e.TOO_MANY_REQUESTS=429]="TOO_MANY_REQUESTS",e[e.CONNECTION_AUTHORIZATION_REQUIRED=470]="CONNECTION_AUTHORIZATION_REQUIRED",e[e.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR"}(a||(t.HAPPairingHTTPCode=a={})),function(e){e.LISTENING="listening",e.IDENTIFY="identify",e.ADD_PAIRING="add-pairing",e.REMOVE_PAIRING="remove-pairing",e.LIST_PAIRINGS="list-pairings",e.PAIR="pair",e.ACCESSORIES="accessories",e.GET_CHARACTERISTICS="get-characteristics",e.SET_CHARACTERISTICS="set-characteristics",e.REQUEST_RESOURCE="request-resource",e.CONNECTION_CLOSED="connection-closed"}(s||(t.HAPServerEventTypes=s={}));var E=function(e){function t(t){var r=e.call(this)||this;return r.unsuccessfulPairAttempts=0,r.accessoryInfo=t,r.allowInsecureRequest=!1,r.httpServer=new m.EventedHTTPServer,r.httpServer.on("listening",r.onListening.bind(r)),r.httpServer.on("request",r.handleRequestOnHAPConnection.bind(r)),r.httpServer.on("connection-closed",r.handleConnectionClosed.bind(r)),r}return c.__extends(t,e),t.prototype.listen=function(e,t){void 0===e&&(e=0),"::"===t&&(t=void 0),this.httpServer.listen(e,t)},t.prototype.stop=function(){this.httpServer.stop()},t.prototype.destroy=function(){this.stop(),this.removeAllListeners()},t.prototype.sendEventNotifications=function(e,t,r,i,n){try{this.httpServer.broadcastEvent(e,t,r,i,n)}catch(e){console.warn("["+this.accessoryInfo.username+"] Error when sending event notifications: "+e.message)}},t.prototype.onListening=function(e,t){this.emit("listening",e,t)},t.prototype.handleRequestOnHAPConnection=function(e,t,r){var i=this;S("[%s] HAP Request: %s %s",this.accessoryInfo.username,t.method,t.url);var n=[];t.on("data",(function(e){return n.push(e)})),t.on("end",(function(){var o=new f.URL(t.url,"http://hap-nodejs.local"),a=i.getHandler(o);if(a){var s=Buffer.concat(n);try{a(e,o,t,s,r)}catch(e){S("[%s] Error executing route handler: %s",i.accessoryInfo.username,e.stack),r.writeHead(500,{"Content-Type":"application/hap+json"}),r.end(JSON.stringify({status:-70403}))}}else S("[%s] WARNING: Handler for %s not implemented",i.accessoryInfo.username,t.url),r.writeHead(404,{"Content-Type":"application/hap+json"}),r.end(JSON.stringify({status:-70409}))}))},t.prototype.handleConnectionClosed=function(e){this.emit("connection-closed",e)},t.prototype.getHandler=function(e){switch(e.pathname.toLowerCase()){case"/identify":return this.handleIdentifyRequest.bind(this);case"/pair-setup":return this.handlePairSetup.bind(this);case"/pair-verify":return this.handlePairVerify.bind(this);case"/pairings":return this.handlePairings.bind(this);case"/accessories":return this.handleAccessories.bind(this);case"/characteristics":return this.handleCharacteristics.bind(this);case"/prepare":return this.handlePrepareWrite.bind(this);case"/resource":return this.handleResource.bind(this);default:return}},t.prototype.handleIdentifyRequest=function(e,t,r,i,n){var o=this;if(this.accessoryInfo.paired()&&!this.allowInsecureRequest)return n.writeHead(400,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:-70401}));this.emit("identify",(0,y.once)((function(e){e?(S("[%s] Identification error: %s",o.accessoryInfo.username,e.message),n.writeHead(500,{"Content-Type":"application/hap+json"}),n.end(JSON.stringify({status:-70403}))):(S("[%s] Identification success",o.accessoryInfo.username),n.writeHead(204),n.end())})))},t.prototype.handlePairSetup=function(e,t,r,i,n){if(!this.allowInsecureRequest&&this.accessoryInfo.paired())return n.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),void n.end(C.encode(6,2,7,6));if(this.unsuccessfulPairAttempts>100)return S("[%s] Reached maximum amount of unsuccessful pair attempts!",this.accessoryInfo.username),n.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),void n.end(C.encode(6,2,7,5));var o=C.decode(i),a=o[6][0];if(1===a)this.handlePairSetupM1(e,r,n);else if(3===a&&2===e._pairSetupState)this.handlePairSetupM3(e,r,n,o);else{if(5!==a||4!==e._pairSetupState)return n.writeHead(400,{"Content-Type":"application/pairing+tlv8"}),void n.end(C.encode(6,a+1,7,1));this.handlePairSetupM5(e,r,n,o)}},t.prototype.handlePairSetupM1=function(e,t,r){var i=this;S("[%s] Pair step 1/5",this.accessoryInfo.username);var n=u.default.randomBytes(16),o=d.SRP.params.hap;d.SRP.genKey(32).then((function(t){var a=new d.SrpServer(o,n,Buffer.from("Pair-Setup"),Buffer.from(i.accessoryInfo.pincode),t),s=a.computeB();e.srpServer=a,r.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),r.end(C.encode(6,2,2,n,3,s)),e._pairSetupState=2})).catch((function(e){S("[%s] Error occurred when generating srp key: %s",i.accessoryInfo.username,e.message),r.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),r.end(C.encode(6,2,7,1))}))},t.prototype.handlePairSetupM3=function(e,t,r,i){S("[%s] Pair step 2/5",this.accessoryInfo.username);var n=i[3],o=i[4],a=e.srpServer;a.setA(n);try{a.checkM1(o)}catch(t){return this.unsuccessfulPairAttempts++,S("[%s] Error while checking pincode: %s",this.accessoryInfo.username,t.message),r.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),r.end(C.encode(6,4,7,2)),void(e._pairSetupState=void 0)}var s=a.computeM2();r.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),r.end(C.encode(6,4,4,s)),e._pairSetupState=4},t.prototype.handlePairSetupM5=function(e,t,r,i){S("[%s] Pair step 3/5",this.accessoryInfo.username);var n=e.srpServer,o=i[5],a=Buffer.alloc(o.length-16),s=Buffer.alloc(16);o.copy(a,0,0,o.length-16),o.copy(s,0,o.length-16,o.length);var c,u=n.computeK(),l=Buffer.from("Pair-Setup-Encrypt-Salt"),h=Buffer.from("Pair-Setup-Encrypt-Info"),d=v.HKDF("sha512",l,u,h,32);try{c=v.chacha20_poly1305_decryptAndVerify(d,Buffer.from("PS-Msg05"),null,a,s)}catch(t){return S("[%s] Error while decrypting and verifying M5 subTlv: %s",this.accessoryInfo.username),r.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),r.end(C.encode(6,4,7,2)),void(e._pairSetupState=void 0)}var p=C.decode(c),f=p[1],g=p[3],m=p[10];this.handlePairSetupM5_2(e,t,r,f,g,m,d)},t.prototype.handlePairSetupM5_2=function(e,t,r,i,n,o,a){S("[%s] Pair step 4/5",this.accessoryInfo.username);var s=e.srpServer.computeK(),c=Buffer.from("Pair-Setup-Controller-Sign-Salt"),u=Buffer.from("Pair-Setup-Controller-Sign-Info"),l=v.HKDF("sha512",c,s,u,32),h=Buffer.concat([l,i,n]);if(!p.default.sign.detached.verify(h,o,n))return S("[%s] Invalid signature",this.accessoryInfo.username),r.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),r.end(C.encode(6,6,7,2)),void(e._pairSetupState=void 0);this.handlePairSetupM5_3(e,t,r,i,n,a)},t.prototype.handlePairSetupM5_3=function(e,t,r,i,n,o){var a=this;S("[%s] Pair step 5/5",this.accessoryInfo.username);var s=e.srpServer.computeK(),c=Buffer.from("Pair-Setup-Accessory-Sign-Salt"),u=Buffer.from("Pair-Setup-Accessory-Sign-Info"),l=v.HKDF("sha512",c,s,u,32),h=this.accessoryInfo.signPk,d=Buffer.from(this.accessoryInfo.username),f=Buffer.concat([l,d,h]),g=Buffer.from(this.accessoryInfo.signSk),m=p.default.sign.detached(f,g),E=C.encode(1,d,3,h,10,m),_=v.chacha20_poly1305_encryptAndSeal(o,Buffer.from("PS-Msg06"),null,E);this.emit("pair",i.toString(),n,(0,y.once)((function(t){if(t)return S("[%s] Error adding pairing info: %s",a.accessoryInfo.username,t.message),r.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),r.end(C.encode(6,6,7,1)),void(e._pairSetupState=void 0);r.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),r.end(C.encode(6,6,5,Buffer.concat([_.ciphertext,_.authTag]))),e._pairSetupState=void 0})))},t.prototype.handlePairVerify=function(e,t,r,i,n){var o=C.decode(i),a=o[6][0];if(1===a)this.handlePairVerifyM1(e,r,n,o);else{if(3!==a||2!==e._pairVerifyState)return n.writeHead(400,{"Content-Type":"application/pairing+tlv8"}),void n.end(C.encode(6,a+1,7,1));this.handlePairVerifyM3(e,r,n,o)}},t.prototype.handlePairVerifyM1=function(e,t,r,i){S("[%s] Pair verify step 1/2",this.accessoryInfo.username);var n=i[3],o=v.generateCurve25519KeyPair(),a=Buffer.from(o.secretKey),s=Buffer.from(o.publicKey),c=Buffer.from(v.generateCurve25519SharedSecKey(a,n)),u=Buffer.from(this.accessoryInfo.username),l=Buffer.concat([s,u,n]),h=Buffer.from(this.accessoryInfo.signSk),d=p.default.sign.detached(l,h),f=Buffer.from("Pair-Verify-Encrypt-Salt"),g=Buffer.from("Pair-Verify-Encrypt-Info"),y=v.HKDF("sha512",f,c,g,32).slice(0,32);e.encryption=new m.HAPEncryption(n,a,s,c,y);var E=C.encode(1,u,10,d),_=v.chacha20_poly1305_encryptAndSeal(y,Buffer.from("PV-Msg02"),null,E);r.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),r.end(C.encode(6,2,5,Buffer.concat([_.ciphertext,_.authTag]),3,s)),e._pairVerifyState=2},t.prototype.handlePairVerifyM3=function(e,t,r,i){S("[%s] Pair verify step 2/2",this.accessoryInfo.username);var n=i[5],o=Buffer.alloc(n.length-16),a=Buffer.alloc(16);n.copy(o,0,0,n.length-16),n.copy(a,0,n.length-16,n.length);var s,c=e.encryption;try{s=v.chacha20_poly1305_decryptAndVerify(c.hkdfPairEncryptionKey,Buffer.from("PV-Msg03"),null,o,a)}catch(t){return S("[%s] M3: Failed to decrypt and/or verify",this.accessoryInfo.username),r.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),r.end(C.encode(6,4,7,2)),void(e._pairVerifyState=void 0)}var u=C.decode(s),l=u[1],h=u[10],d=Buffer.concat([c.clientPublicKey,l,c.publicKey]),f=this.accessoryInfo.getClientPublicKey(l.toString());if(!f)return S("[%s] Client %s attempting to verify, but we are not paired; rejecting client",this.accessoryInfo.username,l),r.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),r.end(C.encode(6,4,7,2)),void(e._pairVerifyState=void 0);if(!p.default.sign.detached.verify(d,h,f))return S("[%s] Client %s provided an invalid signature",this.accessoryInfo.username,l),r.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),r.end(C.encode(6,4,7,2)),void(e._pairVerifyState=void 0);S("[%s] Client %s verification complete",this.accessoryInfo.username,l),r.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),r.end(C.encode(6,4));var g=Buffer.from("Control-Salt"),m=Buffer.from("Control-Read-Encryption-Key"),y=Buffer.from("Control-Write-Encryption-Key");c.accessoryToControllerKey=v.HKDF("sha512",g,c.sharedSecret,m,32),c.controllerToAccessoryKey=v.HKDF("sha512",g,c.sharedSecret,y,32),e.connectionAuthenticated(l.toString()),e._pairVerifyState=void 0},t.prototype.handlePairings=function(e,t,r,i,n){var o=this;if(!this.allowInsecureRequest&&!e.isAuthenticated())return n.writeHead(470,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:-70401}));var a=C.decode(i),s=a[0][0];if(1===a[6][0])if(3===s){var u=a[1].toString(),l=a[3],h=a[11][0];this.emit("add-pairing",e,u,l,h,(0,y.once)((function(e){if(e>0)return S("[%s] Pairings: failed ADD_PAIRING with code %d",o.accessoryInfo.username,e),n.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),void n.end(C.encode(6,2,7,e));n.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),n.end(C.encode(6,2)),S("[%s] Pairings: successfully executed ADD_PAIRING",o.accessoryInfo.username)})))}else if(4===s){u=a[1].toString();this.emit("remove-pairing",e,u,(0,y.once)((function(e){if(e>0)return S("[%s] Pairings: failed REMOVE_PAIRING with code %d",o.accessoryInfo.username,e),n.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),void n.end(C.encode(6,2,7,e));n.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),n.end(C.encode(6,2)),S("[%s] Pairings: successfully executed REMOVE_PAIRING",o.accessoryInfo.username)})))}else 5===s&&this.emit("list-pairings",e,(0,y.once)((function(e,t){if(e>0)return S("[%s] Pairings: failed LIST_PAIRINGS with code %d",o.accessoryInfo.username,e),n.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),void n.end(C.encode(6,2,7,e));var r=[];t.forEach((function(e,t){t>0&&r.push(255,Buffer.alloc(0)),r.push(1,e.username,3,e.publicKey,11,e.permission)}));var i=C.encode.apply(C,c.__spreadArray([6,2],c.__read(r),!1));n.writeHead(200,{"Content-Type":"application/pairing+tlv8"}),n.end(i),S("[%s] Pairings: successfully executed LIST_PAIRINGS",o.accessoryInfo.username)})))},t.prototype.handleAccessories=function(e,t,r,i,n){if(!this.allowInsecureRequest&&!e.isAuthenticated())return n.writeHead(470,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:-70401}));this.emit("accessories",e,(0,y.once)((function(e,t){e?(n.writeHead(e.httpCode,{"Content-Type":"application/hap+json"}),n.end(JSON.stringify({status:e.status}))):(n.writeHead(200,{"Content-Type":"application/hap+json"}),n.end(JSON.stringify(t)))})))},t.prototype.handleCharacteristics=function(e,t,r,i,n){var o,a;if(!this.allowInsecureRequest&&!e.isAuthenticated())return n.writeHead(470,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:-70401}));if("GET"===r.method){var s=t.searchParams,u=s.get("id");if(!u)return n.writeHead(400,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:-70410}));var l=[];try{for(var h=c.__values(u.split(",")),d=h.next();!d.done;d=h.next()){var p=d.value.split(".");l.push({aid:parseInt(p[0],10),iid:parseInt(p[1],10)})}}catch(e){o={error:e}}finally{try{d&&!d.done&&(a=h.return)&&a.call(h)}finally{if(o)throw o.error}}var f={ids:l,includeMeta:(0,g.consideredTrue)(s.get("meta")),includePerms:(0,g.consideredTrue)(s.get("perms")),includeType:(0,g.consideredTrue)(s.get("type")),includeEvent:(0,g.consideredTrue)(s.get("ev"))};this.emit("get-characteristics",e,f,(0,y.once)((function(e,t){var r,i,o,a;if(e)return n.writeHead(e.httpCode,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:e.status}));var s=t.characteristics,u=!1;try{for(var l=c.__values(s),h=l.next();!h.done;h=l.next()){if(h.value.status){u=!0;break}}}catch(e){r={error:e}}finally{try{h&&!h.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}if(u)try{for(var d=c.__values(s),p=d.next();!p.done;p=d.next()){var f=p.value;f.status||(f.status=0)}}catch(e){o={error:e}}finally{try{p&&!p.done&&(a=d.return)&&a.call(d)}finally{if(o)throw o.error}}n.writeHead(u?207:200,{"Content-Type":"application/hap+json"}),n.end(JSON.stringify({characteristics:s}))})))}else if("PUT"===r.method){if(!e.isAuthenticated()&&(!r.headers||r.headers&&r.headers.authorization!==this.accessoryInfo.pincode))return n.writeHead(470,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:-70401}));if(0===i.length)return n.writeHead(400,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:-70410}));var m=JSON.parse(i.toString("utf8"));this.emit("set-characteristics",e,m,(0,y.once)((function(e,t){var r,i;if(e)return n.writeHead(e.httpCode,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:e.status}));var o=t.characteristics,a=!1;try{for(var s=c.__values(o),u=s.next();!u.done;u=s.next()){var l=u.value;if(l.status||void 0!==l.value){a=!0;break}}}catch(e){r={error:e}}finally{try{u&&!u.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}a?(n.writeHead(207,{"Content-Type":"application/hap+json"}),n.end(JSON.stringify({characteristics:o}))):(n.writeHead(204),n.end())})))}else n.writeHead(400,{"Content-Type":"application/hap+json"}),n.end(JSON.stringify({status:-70410}))},t.prototype.handlePrepareWrite=function(e,t,r,i,n){var o=this;if(!this.allowInsecureRequest&&!e.isAuthenticated())return n.writeHead(470,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:-70401}));if("PUT"===r.method){if(0===i.length)return n.writeHead(400,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:-70410}));var a=JSON.parse(i.toString());if(a.pid&&a.ttl)return S("[%s] Received prepare write request with pid %d and ttl %d",this.accessoryInfo.username,a.pid,a.ttl),e.timedWriteTimeout&&clearTimeout(e.timedWriteTimeout),e.timedWritePid=a.pid,e.timedWriteTimeout=setTimeout((function(){S("[%s] Timed write request timed out for pid %d",o.accessoryInfo.username,a.pid),e.timedWritePid=void 0,e.timedWriteTimeout=void 0}),a.ttl),n.writeHead(200,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:0}));n.writeHead(400,{"Content-Type":"application/hap+json"}),n.end(JSON.stringify({status:-70410}))}else n.writeHead(400,{"Content-Type":"application/hap+json"}),n.end(JSON.stringify({status:-70410}))},t.prototype.handleResource=function(e,t,r,i,n){if(!(e.isAuthenticated()||this.allowInsecureRequest&&r.headers&&r.headers.authorization===this.accessoryInfo.pincode))return n.writeHead(470,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:-70401}));if("POST"===r.method){if(0===i.length)return n.writeHead(400,{"Content-Type":"application/hap+json"}),void n.end(JSON.stringify({status:-70410}));var o=JSON.parse(i.toString());this.emit("request-resource",o,(0,y.once)((function(e,t){e?(n.writeHead(e.httpCode,{"Content-Type":"application/hap+json"}),n.end(JSON.stringify({status:e.status}))):(n.writeHead(200,{"Content-Type":"image/jpeg"}),n.end(t))})))}else n.writeHead(400,{"Content-Type":"application/hap+json"}),n.end(JSON.stringify({status:-70410}))},t}(h.EventEmitter);t.HAPServer=E},5876:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Service=t.ServiceEventTypes=void 0;var i,n=r(1635),o=n.__importDefault(r(2613)),a=n.__importDefault(r(5753)),s=r(4434),c=r(9826),u=r(2997),l=(0,a.default)("HAP-NodeJS:Service");!function(e){e.CHARACTERISTIC_CHANGE="characteristic-change",e.SERVICE_CONFIGURATION_CHANGE="service-configurationChange",e.CHARACTERISTIC_WARNING="characteristic-warning"}(i||(t.ServiceEventTypes=i={}));var h=function(e){function t(t,r,i){void 0===t&&(t="");var n=e.call(this)||this;(n.iid=null,n.name=null,n.characteristics=[],n.optionalCharacteristics=[],n.isHiddenService=!1,n.isPrimaryService=!1,n.linkedServices=[],(0,o.default)(r,"Services must be created with a valid UUID."),n.displayName=t,n.UUID=r,n.subtype=i,t)&&(n.getCharacteristic(c.Characteristic.Name)||n.addCharacteristic(c.Characteristic.Name)).updateValue(t);return n}return n.__extends(t,e),t.prototype.getServiceId=function(){return this.UUID+(this.subtype||"")},t.prototype.addCharacteristic=function(e){for(var t,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];var a="function"==typeof e?new(e.bind.apply(e,n.__spreadArray([void 0],n.__read(i),!1))):e;try{for(var s=n.__values(this.characteristics),c=s.next();!c.done;c=s.next()){var u=c.value;if(u.UUID===a.UUID){if("00000052-0000-1000-8000-0026BB765291"===a.UUID)return u;throw new Error("Cannot add a Characteristic with the same UUID as another Characteristic in this Service: "+u.UUID)}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}if(this.characteristics.length>=100)throw new Error("Cannot add more than 100 characteristics to a single service!");return this.setupCharacteristicEventHandlers(a),this.characteristics.push(a),this.emit("service-configurationChange"),a},t.prototype.setPrimaryService=function(e){void 0===e&&(e=!0),this.isPrimaryService=e,this.emit("service-configurationChange")},t.prototype.setHiddenService=function(e){void 0===e&&(e=!0),this.isHiddenService=e,this.emit("service-configurationChange")},t.prototype.addLinkedService=function(e){this.linkedServices.includes(e)||this.linkedServices.push(e),this.emit("service-configurationChange")},t.prototype.removeLinkedService=function(e){var t=this.linkedServices.indexOf(e);-1!==t&&this.linkedServices.splice(t,1),this.emit("service-configurationChange")},t.prototype.removeCharacteristic=function(e){var t=this.characteristics.indexOf(e);-1!==t&&(this.characteristics.splice(t,1),e.removeAllListeners(),this.emit("service-configurationChange"))},t.prototype.getCharacteristic=function(e){var t,r,i,o;try{for(var a=n.__values(this.characteristics),s=a.next();!s.done;s=a.next()){var u=s.value;if("string"==typeof e&&u.displayName===e)return u;if("function"==typeof e&&(u instanceof e||e.UUID===u.UUID))return u}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}if("function"==typeof e){try{for(var l=n.__values(this.optionalCharacteristics),h=l.next();!h.done;h=l.next()){if((u=h.value)instanceof e||e.UUID===u.UUID)return this.addCharacteristic(e)}}catch(e){i={error:e}}finally{try{h&&!h.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}var d=this.addCharacteristic(e);return e.UUID!==c.Characteristic.Name.UUID&&this.emitCharacteristicWarningEvent(d,"warn-message","Characteristic not in required or optional characteristic section for service "+this.constructor.name+". Adding anyway."),d}},t.prototype.testCharacteristic=function(e){var t,r;try{for(var i=n.__values(this.characteristics),o=i.next();!o.done;o=i.next()){var a=o.value;if("string"==typeof e&&a.displayName===e)return!0;if("function"==typeof e&&(a instanceof e||e.UUID===a.UUID))return!0}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return!1},t.prototype.setCharacteristic=function(e,t){return this.getCharacteristic(e).setValue(t),this},t.prototype.updateCharacteristic=function(e,t){return this.getCharacteristic(e).updateValue(t),this},t.prototype.addOptionalCharacteristic=function(e){"function"==typeof e&&(e=new e),this.optionalCharacteristics.push(e)},t.prototype.replaceCharacteristicsFromService=function(e){var t=this;if(this.UUID!==e.UUID)throw new Error("Incompatible services. Tried replacing characteristics of ".concat(this.UUID," with characteristics from ").concat(e.UUID));var r={};e.characteristics.forEach((function(e){return r[e.UUID]=e})),this.characteristics.forEach((function(e){var t=r[e.UUID];if(t){if(delete r[e.UUID],!t.value&&0!==t.value&&!1!==t.value)return;e.replaceBy(t)}})),Object.values(r).forEach((function(e){return t.addCharacteristic(e)}))},t.prototype.getCharacteristicByIID=function(e){var t,r;try{for(var i=n.__values(this.characteristics),o=i.next();!o.done;o=i.next()){var a=o.value;if(a.iid===e)return a}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}},t.prototype._assignIDs=function(e,t,r){var i,o;void 0===r&&(r=0),"0000003E-0000-1000-8000-0026BB765291"===this.UUID?this.iid=1:this.iid=r+e.getIID(t,this.UUID,this.subtype);try{for(var a=n.__values(this.characteristics),s=a.next();!s.done;s=a.next()){s.value._assignID(e,t,this.UUID,this.subtype)}}catch(e){i={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}},t.prototype.toHAP=function(e,t){var r=this;return void 0===t&&(t=!0),new Promise((function(i){var a,s,c,h;(0,o.default)(r.iid,"iid cannot be undefined for service '"+r.displayName+"'"),(0,o.default)(r.characteristics.length,"service '"+r.displayName+"' does not have any characteristics!");var d={type:(0,u.toShortForm)(r.UUID),iid:r.iid,characteristics:[],hidden:!!r.isHiddenService||void 0,primary:!!r.isPrimaryService||void 0};if(r.linkedServices.length){d.linked=[];try{for(var p=n.__values(r.linkedServices),f=p.next();!f.done;f=p.next()){var g=f.value;g.iid?d.linked.push(g.iid):l("iid of linked service '".concat(g.displayName,"' ").concat(g.UUID," is undefined on service '").concat(r.displayName,"'"))}}catch(e){a={error:e}}finally{try{f&&!f.done&&(s=p.return)&&s.call(p)}finally{if(a)throw a.error}}}var m=new Set,v=setTimeout((function(){var e,t;try{for(var o=n.__values(m),a=o.next();!a.done;a=o.next()){var s=a.value;r.emitCharacteristicWarningEvent(s,"slow-read","The read handler for the characteristic '".concat(s.displayName,"' was slow to respond!"))}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}v=setTimeout((function(){var e,t;v=void 0;try{for(var o=n.__values(m),a=o.next();!a.done;a=o.next()){var s=a.value;r.emitCharacteristicWarningEvent(s,"timeout-read","The read handler for the characteristic '"+(null==s?void 0:s.displayName)+"' didn't respond at all!. Please check that you properly call the callback!"),d.characteristics.push(s.internalHAPRepresentation())}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}m.clear(),i(d)}),6e3)}),3e3),y=function(r){m.add(r),r.toHAP(e,t).then((function(e){v&&(m.delete(r),d.characteristics.push(e),0===m.size&&(v&&(clearTimeout(v),v=void 0),i(d)))}))};try{for(var C=n.__values(r.characteristics),S=C.next();!S.done;S=C.next()){y(S.value)}}catch(e){c={error:e}}finally{try{S&&!S.done&&(h=C.return)&&h.call(C)}finally{if(c)throw c.error}}}))},t.prototype.internalHAPRepresentation=function(){var e,t;(0,o.default)(this.iid,"iid cannot be undefined for service '"+this.displayName+"'"),(0,o.default)(this.characteristics.length,"service '"+this.displayName+"' does not have any characteristics!");var r={type:(0,u.toShortForm)(this.UUID),iid:this.iid,characteristics:this.characteristics.map((function(e){return e.internalHAPRepresentation()})),hidden:!!this.isHiddenService||void 0,primary:!!this.isPrimaryService||void 0};if(this.linkedServices.length){r.linked=[];try{for(var i=n.__values(this.linkedServices),a=i.next();!a.done;a=i.next()){var s=a.value;s.iid?r.linked.push(s.iid):l("iid of linked service '".concat(s.displayName,"' ").concat(s.UUID," is undefined on service '").concat(this.displayName,"'"))}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}}return r},t.prototype.setupCharacteristicEventHandlers=function(e){var t=this;e.on("change",(function(r){t.emit("characteristic-change",n.__assign(n.__assign({},r),{characteristic:e}))})),e.on("characteristic-warning",this.emitCharacteristicWarningEvent.bind(this,e))},t.prototype.emitCharacteristicWarningEvent=function(e,t,r,i){this.emit("characteristic-warning",{characteristic:e,type:t,message:r,originatorChain:[this.displayName,e.displayName],stack:i})},t.prototype._sideloadCharacteristics=function(e){var t,r;try{for(var i=n.__values(e),o=i.next();!o.done;o=i.next()){var a=o.value;this.setupCharacteristicEventHandlers(a)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}this.characteristics=e.slice()},t.serialize=function(e){var t;return"Service"!==e.constructor.name&&(t=e.constructor.name),{displayName:e.displayName,UUID:e.UUID,subtype:e.subtype,constructorName:t,hiddenService:e.isHiddenService,primaryService:e.isPrimaryService,characteristics:e.characteristics.map((function(e){return c.Characteristic.serialize(e)})),optionalCharacteristics:e.optionalCharacteristics.map((function(e){return c.Characteristic.serialize(e)}))}},t.deserialize=function(e){var r;e.constructorName&&e.constructorName.charAt(0).toUpperCase()===e.constructorName.charAt(0)&&t[e.constructorName]?r=new(0,t[e.constructorName])(e.displayName,e.subtype):r=new t(e.displayName,e.UUID,e.subtype);r.isHiddenService=!!e.hiddenService,r.isPrimaryService=!!e.primaryService;var i=e.characteristics.map((function(e){return c.Characteristic.deserialize(e)}));return r._sideloadCharacteristics(i),e.optionalCharacteristics&&(r.optionalCharacteristics=e.optionalCharacteristics.map((function(e){return c.Characteristic.deserialize(e)}))),r},t}(s.EventEmitter);t.Service=h,r(1647)},9672:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyCameraSourceAdapter=void 0;var r=function(){function e(e){this.cameraSource=e}return e.prototype.handleSnapshotRequest=function(e,t){this.cameraSource.handleSnapshotRequest(e,(function(e,r){t(e||void 0,r)}))},e.prototype.prepareStream=function(e,t){this.cameraSource.prepareStream(e,(function(e){t(void 0,e)}))},e.prototype.handleStreamRequest=function(e,t){this.cameraSource.handleStreamRequest(e),t()},e.prototype.forwardCloseConnection=function(e){this.cameraSource.handleCloseConnection(e)},e}();t.LegacyCameraSourceAdapter=r},5989:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(1635).__importDefault(r(7194)),n=function(){function e(e){this.options=e,this.startingPort=1e4,this.type=e.isIPV6?"udp6":"udp4",this.startingPort=1e4,this.outgoingAddress=e.outgoingAddress,this.outgoingPort=e.outgoingPort,this.incomingPayloadType=0,this.outgoingSSRC=e.outgoingSSRC,this.disabled=e.disabled,this.incomingSSRC=null,this.outgoingPayloadType=null}return e.prototype.setup=function(){var e=this;return this.createSocketPair(this.type).then((function(t){return e.incomingRTPSocket=t[0],e.incomingRTCPSocket=t[1],e.createSocket(e.type)})).then((function(t){e.outgoingSocket=t,e.onBound()}))},e.prototype.destroy=function(){this.incomingRTPSocket&&this.incomingRTPSocket.close(),this.incomingRTCPSocket&&this.incomingRTCPSocket.close(),this.outgoingSocket&&this.outgoingSocket.close()},e.prototype.incomingRTPPort=function(){var e=this.incomingRTPSocket.address();if("string"!=typeof e)return e.port;throw new Error("Unsupported socket!")},e.prototype.incomingRTCPPort=function(){var e=this.incomingRTCPSocket.address();if("string"!=typeof e)return e.port;throw new Error("Unsupported socket!")},e.prototype.outgoingLocalPort=function(){var e=this.outgoingSocket.address();if("string"!=typeof e)return e.port;throw new Error("Unsupported socket!")},e.prototype.setServerAddress=function(e){this.serverAddress=e},e.prototype.setServerRTPPort=function(e){this.serverRTPPort=e},e.prototype.setServerRTCPPort=function(e){this.serverRTCPPort=e},e.prototype.setIncomingPayloadType=function(e){this.incomingPayloadType=e},e.prototype.setOutgoingPayloadType=function(e){this.outgoingPayloadType=e},e.prototype.sendOut=function(e){this.outgoingAddress&&this.outgoingPort&&this.outgoingSocket.send(e,this.outgoingPort,this.outgoingAddress)},e.prototype.sendBack=function(e){this.serverAddress&&this.serverRTCPPort&&this.outgoingSocket.send(e,this.serverRTCPPort,this.serverAddress)},e.prototype.onBound=function(){var e=this;this.disabled||(this.incomingRTPSocket.on("message",(function(t){e.rtpMessage(t)})),this.incomingRTCPSocket.on("message",(function(t){e.rtcpMessage(t)})),this.outgoingSocket.on("message",(function(t){e.rtcpReply(t)})))},e.prototype.rtpMessage=function(e){if(e.length<12)this.sendOut(e);else{var t=e.readUInt8(1);(127&t)===this.incomingPayloadType&&(t=128&t|this.outgoingPayloadType,e.writeUInt8(t,1)),null===this.incomingSSRC&&(this.incomingSSRC=e.readUInt32BE(4)),e.writeUInt32BE(this.outgoingSSRC,8),this.sendOut(e)}},e.prototype.processRTCPMessage=function(e,t){for(var r=[],i=0;i+4<=e.length;){var n=e.readUInt8(i+1),o=4*e.readUInt16BE(i+2);if(i+4+o>e.length)break;var a=e.slice(i,i+4+o);(a=t(n,a))&&r.push(a),i+=4+o}return r.length>0?Buffer.concat(r):null},e.prototype.rtcpMessage=function(e){var t=this,r=this.processRTCPMessage(e,(function(e,r){return 200!==e||r.length<8||(null===t.incomingSSRC&&(t.incomingSSRC=r.readUInt32BE(4)),r.writeUInt32BE(t.outgoingSSRC,4)),r}));r&&this.sendOut(r)},e.prototype.rtcpReply=function(e){var t=this,r=this.processRTCPMessage(e,(function(e,r){return 201!==e||r.length<12||r.writeUInt32BE(t.incomingSSRC,8),r}));r&&this.sendOut(r)},e.prototype.createSocket=function(e){var t=this;return new Promise((function(r){var n=function(){var o=i.default.createSocket(e);o.once("error",(function(){65535===t.startingPort?t.startingPort=1e4:++t.startingPort,o.close(),n()})),o.on("listening",(function(){r(o)})),o.bind(t.startingPort)};n()}))},e.prototype.createSocketPair=function(e){var t=this;return new Promise((function(r){var n=function(){var o=i.default.createSocket(e),a=i.default.createSocket(e),s={socket1:0,socket2:0},c=function(){0!==s.socket1&&0!==s.socket2&&(2!==s.socket1||2!==s.socket2?(65534===t.startingPort?t.startingPort=1e4:++t.startingPort,o.close(),a.close(),n()):r([o,a]))};o.once("error",(function(){s.socket1=1,c()})),a.once("error",(function(){s.socket2=1,c()})),o.once("listening",(function(){s.socket1=2,c()})),a.once("listening",(function(){s.socket2=2,c()})),o.bind(t.startingPort),a.bind(t.startingPort+1)};n()}))},e}();t.default=n},8598:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamController=t.RTPStreamManagement=t.StreamRequestTypes=t.AudioStreamingSamplerate=t.AudioStreamingCodecType=t.SRTPCryptoSuites=t.AudioSamplerate=t.AudioBitrate=t.VideoCodecPacketizationMode=t.H264Level=t.H264Profile=t.VideoCodecType=void 0;var i,n,o,a,s,c,u,l,h,d,p,f,g,m,v,y,C,S,E,_,T,A,I,D,w,b,U,R,O,N,P,B,L,x,M,F=r(1635),k=F.__importDefault(r(2613)),V=F.__importDefault(r(6982)),H=F.__importDefault(r(5753)),j=F.__importDefault(r(9278)),G=r(9826),W=r(1068),Y=r(5876),q=r(8073),K=r(7739),$=F.__importStar(r(3314)),z=F.__importStar(r(2997)),Q=r(9672),X=F.__importDefault(r(5989)),J=(0,H.default)("HAP-NodeJS:Camera:RTPStreamManagement");!function(e){e[e.STATUS=1]="STATUS"}(i||(i={})),function(e){e[e.AVAILABLE=0]="AVAILABLE",e[e.IN_USE=1]="IN_USE",e[e.UNAVAILABLE=2]="UNAVAILABLE"}(n||(n={})),function(e){e[e.VIDEO_CODEC_CONFIGURATION=1]="VIDEO_CODEC_CONFIGURATION"}(o||(o={})),function(e){e[e.CODEC_TYPE=1]="CODEC_TYPE",e[e.CODEC_PARAMETERS=2]="CODEC_PARAMETERS",e[e.ATTRIBUTES=3]="ATTRIBUTES"}(a||(a={})),function(e){e[e.PROFILE_ID=1]="PROFILE_ID",e[e.LEVEL=2]="LEVEL",e[e.PACKETIZATION_MODE=3]="PACKETIZATION_MODE",e[e.CVO_ENABLED=4]="CVO_ENABLED",e[e.CVO_ID=5]="CVO_ID"}(s||(s={})),function(e){e[e.IMAGE_WIDTH=1]="IMAGE_WIDTH",e[e.IMAGE_HEIGHT=2]="IMAGE_HEIGHT",e[e.FRAME_RATE=3]="FRAME_RATE"}(c||(c={})),function(e){e[e.H264=0]="H264"}(u||(t.VideoCodecType=u={})),function(e){e[e.BASELINE=0]="BASELINE",e[e.MAIN=1]="MAIN",e[e.HIGH=2]="HIGH"}(l||(t.H264Profile=l={})),function(e){e[e.LEVEL3_1=0]="LEVEL3_1",e[e.LEVEL3_2=1]="LEVEL3_2",e[e.LEVEL4_0=2]="LEVEL4_0"}(h||(t.H264Level=h={})),function(e){e[e.NON_INTERLEAVED=0]="NON_INTERLEAVED"}(d||(t.VideoCodecPacketizationMode=d={})),function(e){e[e.UNSUPPORTED=0]="UNSUPPORTED",e[e.SUPPORTED=1]="SUPPORTED"}(p||(p={})),function(e){e[e.AUDIO_CODEC_CONFIGURATION=1]="AUDIO_CODEC_CONFIGURATION",e[e.COMFORT_NOISE_SUPPORT=2]="COMFORT_NOISE_SUPPORT"}(f||(f={})),function(e){e[e.CODEC_TYPE=1]="CODEC_TYPE",e[e.CODEC_PARAMETERS=2]="CODEC_PARAMETERS"}(g||(g={})),function(e){e[e.PCMU=0]="PCMU",e[e.PCMA=1]="PCMA",e[e.AAC_ELD=2]="AAC_ELD",e[e.OPUS=3]="OPUS",e[e.MSBC=4]="MSBC",e[e.AMR=5]="AMR",e[e.AMR_WB=6]="AMR_WB"}(m||(m={})),function(e){e[e.CHANNEL=1]="CHANNEL",e[e.BIT_RATE=2]="BIT_RATE",e[e.SAMPLE_RATE=3]="SAMPLE_RATE",e[e.PACKET_TIME=4]="PACKET_TIME"}(v||(v={})),function(e){e[e.VARIABLE=0]="VARIABLE",e[e.CONSTANT=1]="CONSTANT"}(y||(t.AudioBitrate=y={})),function(e){e[e.KHZ_8=0]="KHZ_8",e[e.KHZ_16=1]="KHZ_16",e[e.KHZ_24=2]="KHZ_24"}(C||(t.AudioSamplerate=C={})),function(e){e[e.SRTP_CRYPTO_SUITE=2]="SRTP_CRYPTO_SUITE"}(S||(S={})),function(e){e[e.AES_CM_128_HMAC_SHA1_80=0]="AES_CM_128_HMAC_SHA1_80",e[e.AES_CM_256_HMAC_SHA1_80=1]="AES_CM_256_HMAC_SHA1_80",e[e.NONE=2]="NONE"}(E||(t.SRTPCryptoSuites=E={})),function(e){e[e.SESSION_ID=1]="SESSION_ID",e[e.CONTROLLER_ADDRESS=3]="CONTROLLER_ADDRESS",e[e.VIDEO_SRTP_PARAMETERS=4]="VIDEO_SRTP_PARAMETERS",e[e.AUDIO_SRTP_PARAMETERS=5]="AUDIO_SRTP_PARAMETERS"}(_||(_={})),function(e){e[e.ADDRESS_VERSION=1]="ADDRESS_VERSION",e[e.ADDRESS=2]="ADDRESS",e[e.VIDEO_RTP_PORT=3]="VIDEO_RTP_PORT",e[e.AUDIO_RTP_PORT=4]="AUDIO_RTP_PORT"}(T||(T={})),function(e){e[e.IPV4=0]="IPV4",e[e.IPV6=1]="IPV6"}(A||(A={})),function(e){e[e.SRTP_CRYPTO_SUITE=1]="SRTP_CRYPTO_SUITE",e[e.MASTER_KEY=2]="MASTER_KEY",e[e.MASTER_SALT=3]="MASTER_SALT"}(I||(I={})),function(e){e[e.SESSION_ID=1]="SESSION_ID",e[e.STATUS=2]="STATUS",e[e.ACCESSORY_ADDRESS=3]="ACCESSORY_ADDRESS",e[e.VIDEO_SRTP_PARAMETERS=4]="VIDEO_SRTP_PARAMETERS",e[e.AUDIO_SRTP_PARAMETERS=5]="AUDIO_SRTP_PARAMETERS",e[e.VIDEO_SSRC=6]="VIDEO_SSRC",e[e.AUDIO_SSRC=7]="AUDIO_SSRC"}(D||(D={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.BUSY=1]="BUSY",e[e.ERROR=2]="ERROR"}(w||(w={})),function(e){e[e.SESSION_CONTROL=1]="SESSION_CONTROL",e[e.SELECTED_VIDEO_PARAMETERS=2]="SELECTED_VIDEO_PARAMETERS",e[e.SELECTED_AUDIO_PARAMETERS=3]="SELECTED_AUDIO_PARAMETERS"}(b||(b={})),function(e){e[e.SESSION_IDENTIFIER=1]="SESSION_IDENTIFIER",e[e.COMMAND=2]="COMMAND"}(U||(U={})),function(e){e[e.END_SESSION=0]="END_SESSION",e[e.START_SESSION=1]="START_SESSION",e[e.SUSPEND_SESSION=2]="SUSPEND_SESSION",e[e.RESUME_SESSION=3]="RESUME_SESSION",e[e.RECONFIGURE_SESSION=4]="RECONFIGURE_SESSION"}(R||(R={})),function(e){e[e.CODEC_TYPE=1]="CODEC_TYPE",e[e.CODEC_PARAMETERS=2]="CODEC_PARAMETERS",e[e.ATTRIBUTES=3]="ATTRIBUTES",e[e.RTP_PARAMETERS=4]="RTP_PARAMETERS"}(O||(O={})),function(e){e[e.PAYLOAD_TYPE=1]="PAYLOAD_TYPE",e[e.SYNCHRONIZATION_SOURCE=2]="SYNCHRONIZATION_SOURCE",e[e.MAX_BIT_RATE=3]="MAX_BIT_RATE",e[e.MIN_RTCP_INTERVAL=4]="MIN_RTCP_INTERVAL",e[e.MAX_MTU=5]="MAX_MTU"}(N||(N={})),function(e){e[e.CODEC_TYPE=1]="CODEC_TYPE",e[e.CODEC_PARAMETERS=2]="CODEC_PARAMETERS",e[e.RTP_PARAMETERS=3]="RTP_PARAMETERS",e[e.COMFORT_NOISE=4]="COMFORT_NOISE"}(P||(P={})),function(e){e[e.PAYLOAD_TYPE=1]="PAYLOAD_TYPE",e[e.SYNCHRONIZATION_SOURCE=2]="SYNCHRONIZATION_SOURCE",e[e.MAX_BIT_RATE=3]="MAX_BIT_RATE",e[e.MIN_RTCP_INTERVAL=4]="MIN_RTCP_INTERVAL",e[e.COMFORT_NOISE_PAYLOAD_TYPE=6]="COMFORT_NOISE_PAYLOAD_TYPE"}(B||(B={})),function(e){e.PCMU="PCMU",e.PCMA="PCMA",e.AAC_ELD="AAC-eld",e.OPUS="OPUS",e.MSBC="mSBC",e.AMR="AMR",e.AMR_WB="AMR-WB"}(L||(t.AudioStreamingCodecType=L={})),function(e){e[e.KHZ_8=8]="KHZ_8",e[e.KHZ_16=16]="KHZ_16",e[e.KHZ_24=24]="KHZ_24"}(x||(t.AudioStreamingSamplerate=x={})),function(e){e.RECONFIGURE="reconfigure",e.START="start",e.STOP="stop"}(M||(t.StreamRequestTypes=M={}));var Z=function(){function e(t,r,i,n,o){if(this.videoOnly=!1,this.sessionIdentifier=void 0,this.streamStatus=0,this.selectedConfiguration="",this.setupEndpointsResponse="",this.id=t,this.delegate=i,this.requireProxy=r.proxy||!1,this.disableAudioProxy=r.disable_audio_proxy||!1,!function(e){return"srtp"in e}(r)?this.supportedCryptoSuites=r.supportedCryptoSuites:this.supportedCryptoSuites=[r.srtp?0:2],0===this.supportedCryptoSuites.length&&this.supportedCryptoSuites.push(2),!r.video)throw new Error("Video parameters cannot be undefined in options");this.supportedRTPConfiguration=e._supportedRTPConfiguration(this.supportedCryptoSuites),this.supportedVideoStreamConfiguration=e._supportedVideoStreamConfiguration(r.video),this.supportedAudioStreamConfiguration=this._supportedAudioStreamConfiguration(r.audio),this.activeConnectionClosedListener=this._handleStopStream.bind(this),this.service=n||this.constructService(t),this.setupServiceHandlers(),this.resetSetupEndpointsResponse(),this.resetSelectedStreamConfiguration(),this.disabledThroughOperatingMode=o}return e.prototype.forceStop=function(){this.handleSessionClosed()},e.prototype.getService=function(){return this.service},e.prototype.handleCloseConnection=function(e){},e.prototype.handleFactoryReset=function(){this.resetSelectedStreamConfiguration(),this.resetSetupEndpointsResponse(),this.service.updateCharacteristic(G.Characteristic.Active,!0)},e.prototype.destroy=function(){this.activeConnection&&this._handleStopStream()},e.prototype.constructService=function(e){var t=new Y.Service.CameraRTPStreamManagement("",e.toString());return t.setCharacteristic(G.Characteristic.Active,!0),t},e.prototype.setupServiceHandlers=function(){var e=this;this.service.testCharacteristic(G.Characteristic.Active)||this.service.setCharacteristic(G.Characteristic.Active,!0),this.service.getCharacteristic(G.Characteristic.Active).on("change",(function(){var t;return null===(t=e.stateChangeDelegate)||void 0===t?void 0:t.call(e)})).setProps({adminOnlyAccess:[1]}),this.service.setCharacteristic(G.Characteristic.SupportedRTPConfiguration,this.supportedRTPConfiguration),this.service.setCharacteristic(G.Characteristic.SupportedVideoStreamConfiguration,this.supportedVideoStreamConfiguration),this.service.setCharacteristic(G.Characteristic.SupportedAudioStreamConfiguration,this.supportedAudioStreamConfiguration),this._updateStreamStatus(0),this.service.setCharacteristic(G.Characteristic.SetupEndpoints,this.setupEndpointsResponse),this.service.getCharacteristic(G.Characteristic.SelectedRTPStreamConfiguration).on("get",(function(t){e.streamingIsDisabled()?t(null,$.encode(1,$.encode(2,R.SUSPEND_SESSION)).toString("base64")):t(null,e.selectedConfiguration)})).on("set",this._handleSelectedStreamConfigurationWrite.bind(this)),this.service.getCharacteristic(G.Characteristic.SetupEndpoints).on("get",(function(t){e.streamingIsDisabled()?t(null,$.encode(2,2).toString("base64")):t(null,e.setupEndpointsResponse)})).on("set",(function(t,r,i,n){if(!n)return J("Set event handler for SetupEndpoints cannot be called from plugin. Connection undefined!"),void r(-70410);e.handleSetupEndpoints(t,r,n)}))},e.prototype.handleSessionClosed=function(){this.resetSelectedStreamConfiguration(),this.resetSetupEndpointsResponse(),this.activeConnection&&(this.activeConnection.removeListener("closed",this.activeConnectionClosedListener),this.activeConnection=void 0),this._updateStreamStatus(0),this.sessionIdentifier=void 0,this.connectionID=void 0,this.ipVersion=void 0,this.videoProxy&&(this.videoProxy.destroy(),this.videoProxy=void 0),this.audioProxy&&(this.audioProxy.destroy(),this.audioProxy=void 0)},e.prototype.streamingIsDisabled=function(e){var t;return this.service.getCharacteristic(G.Characteristic.Active).value?!!(null===(t=this.disabledThroughOperatingMode)||void 0===t?void 0:t.call(this))&&(e&&e(new q.HapStatusError(-70412)),!0):(e&&e(new q.HapStatusError(-70412)),!0)},e.prototype._handleSelectedStreamConfigurationWrite=function(e,t){var r=this;if(!this.streamingIsDisabled(t)){var i=Buffer.from(e,"base64"),n=$.decode(i),o=$.decode(n[1]),a=z.unparse(o[1]),s=o[2][0];if(a!==this.sessionIdentifier)return J("Received unknown session Identifier with request to ".concat(R[s])),void t(-70410);this.selectedConfiguration=e;var c=function(e,i){t(e,i),e&&r.handleSessionClosed()};switch(s){case R.START_SESSION:var u=$.decode(n[2]),l=$.decode(n[3]);this._handleStartStream(u,l,c);break;case R.RECONFIGURE_SESSION:var h=$.decode(n[2]);this.handleReconfigureStream(h,c);break;case R.END_SESSION:this._handleStopStream(c);break;case R.RESUME_SESSION:case R.SUSPEND_SESSION:default:return J("Unhandled request type ".concat(R[s])),void t(-70410)}}},e.prototype._handleStartStream=function(e,t,r){var i=e[1],n=e[2],o=e[3],a=e[4],s=$.decode(n),c=s[1][0],u=s[2][0],l=s[3][0],h=s[4],d=void 0;h&&1===h[0]&&(d=s[5].readUInt8(0));var p=$.decode(o),f=p[1].readUInt16LE(0),g=p[2].readUInt16LE(0),m=p[3].readUInt8(0),v=$.decode(a),y=v[1].readUInt8(0),C=v[2].readUInt32LE(0),S=v[3].readUInt16LE(0),E=v[4].readFloatLE(0),_="ipv6"===this.ipVersion?1228:1378;v[5]&&(_=v[5].readUInt16LE(0));var T=t[1][0],A=t[2],I=t[3],D=!!t[4].readUInt8(0),w=$.decode(A),b=w[1][0],U=w[2][0],R=w[3][0],O=w[4].readUInt8(0),N=$.decode(I),P=N[1].readUInt8(0),B=N[2].readUInt32LE(0),L=N[3].readUInt16LE(0),x=N[4].readFloatLE(0),M=N[6].readUInt8(0);this.requireProxy&&(this.videoProxy.setOutgoingPayloadType(y),this.disableAudioProxy||this.audioProxy.setOutgoingPayloadType(P));var F,k,V={codec:i.readUInt8(0),profile:c,level:u,packetizationMode:l,cvoId:d,width:f,height:g,fps:m,pt:y,ssrc:C,max_bit_rate:S,rtcp_interval:E,mtu:_};switch(T){case 0:F="PCMU";break;case 1:F="PCMA";break;case 2:F="AAC-eld";break;case 3:F="OPUS";break;case 4:F="mSBC";break;case 5:F="AMR";break;case 6:F="AMR-WB";break;default:throw new Error("Encountered unknown selected audio codec ".concat(T))}switch(R){case 0:k=8;break;case 1:k=16;break;case 2:k=24;break;default:throw new Error("Encountered unknown selected audio samplerate ".concat(R))}var H={codec:F,channel:b,bit_rate:U,sample_rate:k,packet_time:O,pt:P,ssrc:B,max_bit_rate:L,rtcp_interval:x,comfort_pt:M,comfortNoiseEnabled:D},j={sessionID:this.sessionIdentifier,type:"start",video:V,audio:H};this.delegate.handleStreamRequest(j,(function(e){return r(e)}))},e.prototype.handleReconfigureStream=function(e,t){var r=e[3],i=e[4],n=$.decode(r),o=n[1].readUInt16LE(0),a=n[2].readUInt16LE(0),s=n[3].readUInt8(0),c=$.decode(i),u={width:o,height:a,fps:s,max_bit_rate:c[3].readUInt16LE(0),rtcp_interval:c[4].readFloatLE(0)||.5},l={sessionID:this.sessionIdentifier,type:"reconfigure",video:u};this.delegate.handleStreamRequest(l,(function(e){return t(e)}))},e.prototype._handleStopStream=function(e){var t={sessionID:this.sessionIdentifier,type:"stop"};this.handleSessionClosed(),this.delegate.handleStreamRequest(t,(function(t){return e?e(t):void 0}))},e.prototype.handleSetupEndpoints=function(e,t,r){var i=this;if(!this.streamingIsDisabled(t)){var n=Buffer.from(e,"base64"),o=$.decode(n),a=z.unparse(o[1]);if(0!==this.streamStatus)return this.setupEndpointsResponse=$.encode(1,z.write(a),2,1).toString("base64"),void t();(0,k.default)(null==this.activeConnection,"Found non-nil `activeConnection` when trying to setup streaming endpoints, even though streamStatus is reported to be AVAILABLE!"),this.activeConnection=r,this.activeConnection.on("closed",this.activeConnectionClosedListener),this.connectionID=r.sessionID,this.sessionIdentifier=a,this._updateStreamStatus(1);var s=o[3],c=$.decode(s),u=c[1][0],l=c[2].toString("utf8"),h=c[3].readUInt16LE(0),d=c[4].readUInt16LE(0),p=o[4],f=$.decode(p),g=f[1][0],m=f[2],v=f[3],y=o[5],C=$.decode(y),S=C[1][0],E=C[2],_=C[3];J("Session: ",a,"\nControllerAddress: ",l,"\nVideoPort: ",h,"\nAudioPort: ",d,"\nVideo Crypto: ",g,"\nVideo Master Key: ",m,"\nVideo Master Salt: ",v,"\nAudio Crypto: ",S,"\nAudio Master Key: ",E,"\nAudio Master Salt: ",_);var T={sessionID:a,sourceAddress:r.localAddress,targetAddress:l,addressVersion:1===u?"ipv6":"ipv4",video:{port:h,srtpCryptoSuite:g,srtp_key:m,srtp_salt:v},audio:{port:d,srtpCryptoSuite:S,srtp_key:E,srtp_salt:_}},A=[];this.requireProxy&&(T.targetAddress=r.getLocalAddress(1===u?"ipv6":"ipv4"),this.videoProxy=new X.default({outgoingAddress:l,outgoingPort:h,outgoingSSRC:V.default.randomBytes(4).readUInt32LE(0),disabled:!1}),A.push(this.videoProxy.setup().then((function(){T.video.proxy_rtp=i.videoProxy.incomingRTPPort(),T.video.proxy_rtcp=i.videoProxy.incomingRTCPPort()}))),this.disableAudioProxy||(this.audioProxy=new X.default({outgoingAddress:l,outgoingPort:d,outgoingSSRC:V.default.randomBytes(4).readUInt32LE(0),disabled:this.videoOnly}),A.push(this.audioProxy.setup().then((function(){T.audio.proxy_rtp=i.audioProxy.incomingRTPPort(),T.audio.proxy_rtcp=i.audioProxy.incomingRTCPPort()}))))),Promise.all(A).then((function(){i.delegate.prepareStream(T,(0,K.once)((function(e,n){e||!n?(J("PrepareStream request encountered an error: ".concat(e?e.message:void 0)),i.setupEndpointsResponse=$.encode(1,z.write(a),2,2).toString("base64"),i.handleSessionClosed(),t(e)):i.generateSetupEndpointResponse(r,a,T,n,t)})))}))}},e.prototype.generateSetupEndpointResponse=function(e,t,r,i,n){var o,a,s,c,u,l,h,d,p,f,g,m=r.addressVersion;if(!this.videoOnly&&!i.audio)throw new Error("Audio was enabled but not supplied in PrepareStreamResponse!");var v=i.audio||{port:r.audio.port,ssrc:W.CameraController.generateSynchronisationSource(),srtp_key:r.audio.srtp_key,srtp_salt:r.audio.srtp_salt};if(this.requireProxy){C=i.video;if(o=e.getLocalAddress(r.addressVersion),c=2,u=Buffer.alloc(0),l=Buffer.alloc(0),h=2,d=Buffer.alloc(0),p=Buffer.alloc(0),this.videoProxy.setIncomingPayloadType(C.proxy_pt),this.videoProxy.setServerAddress(C.proxy_server_address),this.videoProxy.setServerRTPPort(C.proxy_server_rtp),this.videoProxy.setServerRTCPPort(C.proxy_server_rtcp),a=this.videoProxy.outgoingLocalPort(),f=this.videoProxy.outgoingSSRC,this.disableAudioProxy){s=(y=i.audio).port,g=y.ssrc}else{var y=i.audio;this.audioProxy.setIncomingPayloadType(y.proxy_pt),this.audioProxy.setServerAddress(y.proxy_server_address),this.audioProxy.setServerRTPPort(y.proxy_server_rtp),this.audioProxy.setServerRTCPPort(y.proxy_server_rtcp),s=this.audioProxy.outgoingLocalPort(),g=this.audioProxy.outgoingSSRC}}else{var C=i.video,y=v;if(i.addressOverride?(m=j.default.isIPv4(i.addressOverride)?"ipv4":"ipv6",o=i.addressOverride):o=e.getLocalAddress(m),r.addressVersion!==m)throw new Error("Incoming and outgoing ip address versions must match! Expected ".concat(r.addressVersion," but got ").concat(m));if(a=C.port,s=y.port,2!==r.video.srtpCryptoSuite&&(void 0===C.srtp_key||void 0===C.srtp_salt))throw new Error("SRTP was selected for the prepared video stream, but no 'srtp_key' or 'srtp_salt' was specified!");if(2!==r.audio.srtpCryptoSuite&&(void 0===y.srtp_key||void 0===y.srtp_salt))throw new Error("SRTP was selected for the prepared audio stream, but no 'srtp_key' or 'srtp_salt' was specified!");c=r.video.srtpCryptoSuite,u=C.srtp_key||Buffer.alloc(0),l=C.srtp_salt||Buffer.alloc(0),h=r.audio.srtpCryptoSuite,d=y.srtp_key||Buffer.alloc(0),p=y.srtp_salt||Buffer.alloc(0),f=C.ssrc,g=y.ssrc}this.ipVersion=m;var S=$.encode(1,"ipv4"===m?0:1,2,o,3,$.writeUInt16(a),4,$.writeUInt16(s)),E=$.encode(1,c,2,u,3,l),_=$.encode(1,h,2,d,3,p);this.setupEndpointsResponse=$.encode(1,z.write(t),2,0,3,S,4,E,5,_,6,$.writeUInt32(f),7,$.writeUInt32(g)).toString("base64"),n()},e.prototype._updateStreamStatus=function(e){this.streamStatus=e,this.service.updateCharacteristic(G.Characteristic.StreamingStatus,$.encode(1,this.streamStatus).toString("base64"))},e._supportedRTPConfiguration=function(e){return 1===e.length&&2===e[0]&&J("Client claims it doesn't support SRTP. The stream may stops working with future iOS releases."),$.encode(2,e).toString("base64")},e._supportedVideoStreamConfiguration=function(e){if(!e.codec)throw new Error("Video codec cannot be undefined");if(!e.resolutions)throw new Error("Video resolutions cannot be undefined");var t=$.encode(1,e.codec.profiles,2,e.codec.levels,3,0);null!=e.cvoId&&(t=Buffer.concat([t,$.encode(4,1,5,e.cvoId)]));var r=$.encode(1,0,2,t,3,e.resolutions.map((function(e){if(3!==e.length)throw new Error("Unexpected video resolution");var t=Buffer.alloc(2),r=Buffer.alloc(2),i=Buffer.alloc(1);return t.writeUInt16LE(e[0],0),r.writeUInt16LE(e[1],0),i.writeUInt8(e[2],0),$.encode(1,t,2,r,3,i)})));return $.encode(1,r).toString("base64")},e.prototype.checkForLegacyAudioCodecRepresentation=function(e){var t={};e.slice().forEach((function(r){var i=t[r.type];if(i){"number"==typeof i.samplerate&&(i.samplerate=[i.samplerate]),i.samplerate=i.samplerate.concat(r.samplerate);var n=e.indexOf(r);n>=0&&e.splice(n,1)}else t[r.type]=r}))},e.prototype._supportedAudioStreamConfiguration=function(e){var t=e&&!!e.comfort_noise,r=e&&e.codecs||[];this.checkForLegacyAudioCodecRepresentation(r),0===r.length&&(J("Client doesn't support any audio codec that HomeKit supports."),this.videoOnly=!0,r.push({type:"OPUS",samplerate:[16,24]}));var i=r.map((function(e){var t;switch(e.type){case"OPUS":t=3;break;case"AAC-eld":t=2;break;case"PCMA":t=1;break;case"PCMU":t=0;break;case"mSBC":t=4;break;case"AMR":t=5;break;case"AMR-WB":t=6;break;default:throw new Error("Unsupported codec: "+e.type)}var r=("number"==typeof e.samplerate?[e.samplerate]:e.samplerate).map((function(t){var r;switch(t){case 8:r=0;break;case 16:r=1;break;case 24:r=2;break;default:console.log("Unsupported sample rate: ",e.samplerate),r=-1}return r})).filter((function(e){return-1!==e}));if(0===r.length)throw new Error("Audio samplerate cannot be empty!");var i=$.encode(1,Math.max(1,e.audioChannels||1),2,e.bitrate||0,3,r);return $.encode(1,t,2,i)}));return $.encode(1,i,2,t?1:0).toString("base64")},e.prototype.resetSetupEndpointsResponse=function(){this.setupEndpointsResponse=$.encode(2,2).toString("base64"),this.service.updateCharacteristic(G.Characteristic.SetupEndpoints,this.setupEndpointsResponse)},e.prototype.resetSelectedStreamConfiguration=function(){this.selectedConfiguration=$.encode(1,$.encode(2,R.SUSPEND_SESSION)).toString("base64"),this.service.updateCharacteristic(G.Characteristic.SelectedRTPStreamConfiguration,this.selectedConfiguration)},e.prototype.serialize=function(){var e=this.service.getCharacteristic(G.Characteristic.Active).value;if(!0!==e)return{id:this.id,active:!!e}},e.prototype.deserialize=function(e){(0,k.default)(e.id===this.id,"Tried to initialize RTPStreamManagement ".concat(this.id," with data from management with id ").concat(e.id,"!")),this.service.updateCharacteristic(G.Characteristic.Active,e.active)},e.prototype.setupStateChangeDelegate=function(e){this.stateChangeDelegate=e},e.SRTPCryptoSuites=E,e.VideoCodecParamProfileIDTypes=l,e.VideoCodecParamLevelTypes=Object.freeze({TYPE3_1:0,TYPE3_2:1,TYPE4_0:2}),e}();t.RTPStreamManagement=Z;var ee=function(e){function t(t,r,i,n){var o=e.call(this,t,r,new Q.LegacyCameraSourceAdapter(i),n)||this;return o.options=r,o}return F.__extends(t,e),t}(Z);t.StreamController=ee},6859:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecordingManagement=t.PacketDataType=t.AudioRecordingSamplerate=t.AudioRecordingCodecType=t.MediaContainerType=t.EventTriggerOption=void 0;var i,n,o,a,s,c,u,l,h,d,p,f,g,m,v,y,C=r(1635),S=C.__importDefault(r(6982)),E=C.__importDefault(r(5753)),_=r(4434),T=r(9826),A=r(9948),I=r(5876),D=r(8073),w=C.__importStar(r(3314)),b=(0,E.default)("HAP-NodeJS:Camera:RecordingManagement");!function(e){e[e.MOTION=1]="MOTION",e[e.DOORBELL=2]="DOORBELL"}(i||(t.EventTriggerOption=i={})),function(e){e[e.FRAGMENTED_MP4=0]="FRAGMENTED_MP4"}(n||(t.MediaContainerType=n={})),function(e){e[e.CODEC_TYPE=1]="CODEC_TYPE",e[e.CODEC_PARAMETERS=2]="CODEC_PARAMETERS",e[e.ATTRIBUTES=3]="ATTRIBUTES"}(o||(o={})),function(e){e[e.PROFILE_ID=1]="PROFILE_ID",e[e.LEVEL=2]="LEVEL",e[e.BITRATE=3]="BITRATE",e[e.IFRAME_INTERVAL=4]="IFRAME_INTERVAL"}(a||(a={})),function(e){e[e.IMAGE_WIDTH=1]="IMAGE_WIDTH",e[e.IMAGE_HEIGHT=2]="IMAGE_HEIGHT",e[e.FRAME_RATE=3]="FRAME_RATE"}(s||(s={})),function(e){e[e.SELECTED_RECORDING_CONFIGURATION=1]="SELECTED_RECORDING_CONFIGURATION",e[e.SELECTED_VIDEO_CONFIGURATION=2]="SELECTED_VIDEO_CONFIGURATION",e[e.SELECTED_AUDIO_CONFIGURATION=3]="SELECTED_AUDIO_CONFIGURATION"}(c||(c={})),function(e){e[e.AAC_LC=0]="AAC_LC",e[e.AAC_ELD=1]="AAC_ELD"}(u||(t.AudioRecordingCodecType=u={})),function(e){e[e.KHZ_8=0]="KHZ_8",e[e.KHZ_16=1]="KHZ_16",e[e.KHZ_24=2]="KHZ_24",e[e.KHZ_32=3]="KHZ_32",e[e.KHZ_44_1=4]="KHZ_44_1",e[e.KHZ_48=5]="KHZ_48"}(l||(t.AudioRecordingSamplerate=l={})),function(e){e[e.VIDEO_CODEC_CONFIGURATION=1]="VIDEO_CODEC_CONFIGURATION"}(h||(h={})),function(e){e[e.PREBUFFER_LENGTH=1]="PREBUFFER_LENGTH",e[e.EVENT_TRIGGER_OPTIONS=2]="EVENT_TRIGGER_OPTIONS",e[e.MEDIA_CONTAINER_CONFIGURATIONS=3]="MEDIA_CONTAINER_CONFIGURATIONS"}(d||(d={})),function(e){e[e.MEDIA_CONTAINER_TYPE=1]="MEDIA_CONTAINER_TYPE",e[e.MEDIA_CONTAINER_PARAMETERS=2]="MEDIA_CONTAINER_PARAMETERS"}(p||(p={})),function(e){e[e.FRAGMENT_LENGTH=1]="FRAGMENT_LENGTH"}(f||(f={})),function(e){e[e.CHANNEL=1]="CHANNEL",e[e.BIT_RATE=2]="BIT_RATE",e[e.SAMPLE_RATE=3]="SAMPLE_RATE",e[e.MAX_AUDIO_BITRATE=4]="MAX_AUDIO_BITRATE"}(g||(g={})),function(e){e[e.CODEC_TYPE=1]="CODEC_TYPE",e[e.CODEC_PARAMETERS=2]="CODEC_PARAMETERS"}(m||(m={})),function(e){e[e.AUDIO_CODEC_CONFIGURATION=1]="AUDIO_CODEC_CONFIGURATION"}(v||(v={})),function(e){e.MEDIA_INITIALIZATION="mediaInitialization",e.MEDIA_FRAGMENT="mediaFragment"}(y||(t.PacketDataType=y={}));var U,R=function(){function e(e,t,r,i){var n,o;this.sensorServices=[],this.recordingActive=!1,this.options=e,this.delegate=t;var a=i||this.constructService();this.recordingManagementService=a.recordingManagement,this.operatingModeService=a.operatingMode,this.dataStreamManagement=a.dataStreamManagement,this.eventTriggerOptions=0;try{for(var s=C.__values(r),c=s.next();!c.done;c=s.next()){var u=c.value;this.eventTriggerOptions|=u}}catch(e){n={error:e}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}this.supportedCameraRecordingConfiguration=this._supportedCameraRecordingConfiguration(e),this.supportedVideoRecordingConfiguration=this._supportedVideoRecordingConfiguration(e.video),this.supportedAudioRecordingConfiguration=this._supportedAudioStreamConfiguration(e.audio),this.setupServiceHandlers()}return e.prototype.constructService=function(){var e=new I.Service.CameraRecordingManagement("","");e.setCharacteristic(T.Characteristic.Active,!1),e.setCharacteristic(T.Characteristic.RecordingAudioActive,!1);var t=new I.Service.CameraOperatingMode("","");t.setCharacteristic(T.Characteristic.EventSnapshotsActive,!0),t.setCharacteristic(T.Characteristic.HomeKitCameraActive,!0),t.setCharacteristic(T.Characteristic.PeriodicSnapshotsActive,!0);var r=new A.DataStreamManagement;return e.addLinkedService(r.getService()),{recordingManagement:e,operatingMode:t,dataStreamManagement:r}},e.prototype.setupServiceHandlers=function(){var e=this;this.recordingManagementService.setCharacteristic(T.Characteristic.SupportedCameraRecordingConfiguration,this.supportedCameraRecordingConfiguration),this.recordingManagementService.setCharacteristic(T.Characteristic.SupportedVideoRecordingConfiguration,this.supportedVideoRecordingConfiguration),this.recordingManagementService.setCharacteristic(T.Characteristic.SupportedAudioRecordingConfiguration,this.supportedAudioRecordingConfiguration),this.recordingManagementService.getCharacteristic(T.Characteristic.SelectedCameraRecordingConfiguration).onGet(this.handleSelectedCameraRecordingConfigurationRead.bind(this)).onSet(this.handleSelectedCameraRecordingConfigurationWrite.bind(this)).setProps({adminOnlyAccess:[1]}),this.recordingManagementService.getCharacteristic(T.Characteristic.Active).onSet((function(t){!!t!==e.recordingActive&&(e.recordingActive=!!t,e.delegate.updateRecordingActive(e.recordingActive))})).on("change",(function(){var t;return null===(t=e.stateChangeDelegate)||void 0===t?void 0:t.call(e)})).setProps({adminOnlyAccess:[1]}),this.recordingManagementService.getCharacteristic(T.Characteristic.RecordingAudioActive).on("change",(function(){var t;return null===(t=e.stateChangeDelegate)||void 0===t?void 0:t.call(e)})),this.operatingModeService.getCharacteristic(T.Characteristic.HomeKitCameraActive).on("change",(function(t){var r,i,n;try{for(var o=C.__values(e.sensorServices),a=o.next();!a.done;a=o.next()){a.value.setCharacteristic(T.Characteristic.StatusActive,!!t.newValue)}}catch(e){r={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}!t.newValue&&e.recordingStream&&e.recordingStream.close(1),null===(n=e.stateChangeDelegate)||void 0===n||n.call(e)})).setProps({adminOnlyAccess:[1]}),this.operatingModeService.getCharacteristic(T.Characteristic.EventSnapshotsActive).on("change",(function(){var t;return null===(t=e.stateChangeDelegate)||void 0===t?void 0:t.call(e)})).setProps({adminOnlyAccess:[1]}),this.operatingModeService.getCharacteristic(T.Characteristic.PeriodicSnapshotsActive).on("change",(function(){var t;return null===(t=e.stateChangeDelegate)||void 0===t?void 0:t.call(e)})).setProps({adminOnlyAccess:[1]}),this.dataStreamManagement.onRequestMessage("dataSend","open",this.handleDataSendOpen.bind(this))},e.prototype.handleDataSendOpen=function(e,t,r){var i=this,n=r.streamId,o=r.type,a=r.target,s=r.reason;if("controller"!==a||"ipcamera.recording"!==o)return b("[HDS %s] Received data send with unexpected target: %s or type: %d. Rejecting...",e.remoteAddress,a,o),void e.sendResponse("dataSend","open",t,A.HDSStatus.PROTOCOL_SPECIFIC_ERROR,{status:5});if(this.recordingActive){if(this.operatingModeService.getCharacteristic(T.Characteristic.HomeKitCameraActive).value)return this.recordingStream?(b("[HDS %s] Rejecting DATA_SEND OPEN as another stream (%s) is already recording with streamId %d!",e.remoteAddress,this.recordingStream.connection.remoteAddress,this.recordingStream.streamId),void e.sendResponse("dataSend","open",t,A.HDSStatus.PROTOCOL_SPECIFIC_ERROR,{status:2})):void(this.selectedConfiguration?(b("[HDS %s] HDS DATA_SEND Open with reason '%s'.",e.remoteAddress,s),this.recordingStream=new O(e,this.delegate,t,n),this.recordingStream.on("closed",(function(){b("[HDS %s] Removing active recoding session from recording management!"),i.recordingStream=void 0})),this.recordingStream.startStreaming()):e.sendResponse("dataSend","open",t,A.HDSStatus.PROTOCOL_SPECIFIC_ERROR,{status:9}));e.sendResponse("dataSend","open",t,A.HDSStatus.PROTOCOL_SPECIFIC_ERROR,{status:1})}else e.sendResponse("dataSend","open",t,A.HDSStatus.PROTOCOL_SPECIFIC_ERROR,{status:1})},e.prototype.handleSelectedCameraRecordingConfigurationRead=function(){if(!this.selectedConfiguration)throw new D.HapStatusError(-70402);return this.selectedConfiguration.base64},e.prototype.handleSelectedCameraRecordingConfigurationWrite=function(e){var t,r,i=this.parseSelectedConfiguration(e),n=(null===(t=this.selectedConfiguration)||void 0===t?void 0:t.base64)!==e;this.selectedConfiguration={parsed:i,base64:e},n&&(this.delegate.updateRecordingConfiguration(this.selectedConfiguration.parsed),null===(r=this.stateChangeDelegate)||void 0===r||r.call(this))},e.prototype.parseSelectedConfiguration=function(e){for(var t=w.decode(Buffer.from(e,"base64")),r=w.decode(t[1]),i=w.decode(t[2]),n=w.decode(t[3]),o=r[1].readInt32LE(0),a=r[2].readInt32LE(0),s=w.decode(r[3]),c=s[1][0],u=w.decode(s[2])[1].readInt32LE(0),l=i[1][0],h=w.decode(i[2]),d=w.decode(i[3]),p=h[1][0],f=h[2][0],g=h[3].readInt32LE(0),m=h[4].readInt32LE(0),v=d[1].readInt16LE(0),y=d[2].readInt16LE(0),C=d[3][0],S=n[1][0],E=w.decode(n[2]),_=E[1][0],T=E[3][0],A=E[2][0],I=E[4].readUInt32LE(0),D=[],b=0;a>0;)1&a&&D.push(1<<b),a>>=1,b+=1;return{prebufferLength:o,eventTriggerTypes:D,mediaContainerConfiguration:{type:c,fragmentLength:u},videoCodec:{type:l,parameters:{profile:p,level:f,bitRate:g,iFrameInterval:m},resolution:[v,y,C]},audioCodec:{audioChannels:_,type:S,samplerate:T,bitrateMode:A,bitrate:I}}},e.prototype._supportedCameraRecordingConfiguration=function(e){var t=Array.isArray(e.mediaContainerConfiguration)?e.mediaContainerConfiguration:[e.mediaContainerConfiguration],r=Buffer.alloc(4),i=Buffer.alloc(8);return r.writeInt32LE(e.prebufferLength,0),i.writeInt32LE(this.eventTriggerOptions,0),w.encode(1,r,2,i,3,t.map((function(e){var t=Buffer.alloc(4);return t.writeInt32LE(e.fragmentLength,0),w.encode(1,e.type,2,w.encode(1,t))}))).toString("base64")},e.prototype._supportedVideoRecordingConfiguration=function(e){if(!e.parameters)throw new Error("Video parameters cannot be undefined");if(!e.resolutions)throw new Error("Video resolutions cannot be undefined");var t=w.encode(1,e.parameters.profiles,2,e.parameters.levels),r=w.encode(1,e.type,2,t,3,e.resolutions.map((function(e){if(3!==e.length)throw new Error("Unexpected video resolution");var t=Buffer.alloc(2),r=Buffer.alloc(2),i=Buffer.alloc(1);return t.writeUInt16LE(e[0],0),r.writeUInt16LE(e[1],0),i.writeUInt8(e[2],0),w.encode(1,t,2,r,3,i)})));return w.encode(1,r).toString("base64")},e.prototype._supportedAudioStreamConfiguration=function(e){var t=Array.isArray(e.codecs)?e.codecs:[e.codecs];if(0===t.length)throw Error("CameraRecordingOptions.audio: At least one audio codec configuration must be specified!");var r=t.map((function(e){var t=Array.isArray(e.samplerate)?e.samplerate:[e.samplerate];if(0===t.length)throw new Error("CameraRecordingOptions.audio.codecs: Audio samplerate cannot be empty!");var r=w.encode(1,Math.max(1,e.audioChannels||1),2,e.bitrateMode||0,3,t);return w.encode(1,e.type,2,r)}));return w.encode(1,r).toString("base64")},e.prototype.computeConfigurationHash=function(e){void 0===e&&(e="sha256");var t=S.default.createHash(e);return t.update(this.supportedCameraRecordingConfiguration),t.update(this.supportedVideoRecordingConfiguration),t.update(this.supportedAudioRecordingConfiguration),t.digest().toString("hex")},e.prototype.serialize=function(){var e;return{configurationHash:{algorithm:"sha256",hash:this.computeConfigurationHash("sha256")},selectedConfiguration:null===(e=this.selectedConfiguration)||void 0===e?void 0:e.base64,recordingActive:this.recordingActive,recordingAudioActive:!!this.recordingManagementService.getCharacteristic(T.Characteristic.RecordingAudioActive).value,eventSnapshotsActive:!!this.operatingModeService.getCharacteristic(T.Characteristic.EventSnapshotsActive).value,homeKitCameraActive:!!this.operatingModeService.getCharacteristic(T.Characteristic.HomeKitCameraActive).value,periodicSnapshotsActive:!!this.operatingModeService.getCharacteristic(T.Characteristic.PeriodicSnapshotsActive).value}},e.prototype.deserialize=function(e){var t,r,i,n=!1,o=this.computeConfigurationHash(e.configurationHash.algorithm);e.selectedConfiguration&&(o===e.configurationHash.hash?this.selectedConfiguration={base64:e.selectedConfiguration,parsed:this.parseSelectedConfiguration(e.selectedConfiguration)}:n=!0),this.recordingActive=e.recordingActive,this.recordingManagementService.updateCharacteristic(T.Characteristic.Active,e.recordingActive),this.recordingManagementService.updateCharacteristic(T.Characteristic.RecordingAudioActive,e.recordingAudioActive),this.operatingModeService.updateCharacteristic(T.Characteristic.EventSnapshotsActive,e.eventSnapshotsActive),this.operatingModeService.updateCharacteristic(T.Characteristic.PeriodicSnapshotsActive,e.periodicSnapshotsActive),this.operatingModeService.updateCharacteristic(T.Characteristic.HomeKitCameraActive,e.homeKitCameraActive);try{for(var a=C.__values(this.sensorServices),s=a.next();!s.done;s=a.next()){s.value.setCharacteristic(T.Characteristic.StatusActive,e.homeKitCameraActive)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}try{this.selectedConfiguration&&this.delegate.updateRecordingConfiguration(this.selectedConfiguration.parsed),e.recordingActive&&this.delegate.updateRecordingActive(e.recordingActive)}catch(e){console.error("Failed to properly initialize CameraRecordingDelegate from persistent storage: "+e.stack)}n&&(null===(i=this.stateChangeDelegate)||void 0===i||i.call(this))},e.prototype.setupStateChangeDelegate=function(e){this.stateChangeDelegate=e},e.prototype.destroy=function(){this.dataStreamManagement.destroy()},e.prototype.handleFactoryReset=function(){var e,t;this.selectedConfiguration=void 0,this.recordingManagementService.updateCharacteristic(T.Characteristic.Active,!1),this.recordingManagementService.updateCharacteristic(T.Characteristic.RecordingAudioActive,!1),this.operatingModeService.updateCharacteristic(T.Characteristic.EventSnapshotsActive,!0),this.operatingModeService.updateCharacteristic(T.Characteristic.PeriodicSnapshotsActive,!0),this.operatingModeService.updateCharacteristic(T.Characteristic.HomeKitCameraActive,!0);try{for(var r=C.__values(this.sensorServices),i=r.next();!i.done;i=r.next()){i.value.setCharacteristic(T.Characteristic.StatusActive,!0)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}try{this.delegate.updateRecordingActive(!1),this.delegate.updateRecordingConfiguration(void 0)}catch(e){console.error("CameraRecordingDelegate failed to update state after handleFactoryReset: "+e.stack)}},e}();t.RecordingManagement=R,function(e){e.CLOSED="closed"}(U||(U={}));var O=function(e){function t(t,r,i,n){var o,a=e.call(this)||this;return a.closed=!1,a.eventHandler=((o={}).close=a.handleDataSendClose.bind(a),o.ack=a.handleDataSendAck.bind(a),o),a.requestHandler=void 0,a.connection=t,a.delegate=r,a.hdsRequestId=i,a.streamId=n,a.connection.on("closed",a.closeListener=a.handleDataStreamConnectionClosed.bind(a)),a.connection.addProtocolHandler("dataSend",a),a}return C.__extends(t,e),t.prototype.startStreaming=function(){this._startStreaming()},t.prototype._startStreaming=function(){return C.__awaiter(this,void 0,void 0,(function(){var e,t,r,i,n,o,a,s,c,u,l,h,d,p,f,g,m,v,y,S;return C.__generator(this,(function(E){switch(E.label){case 0:b("[HDS %s] Sending DATA_SEND OPEN response for streamId %d",this.connection.remoteAddress,this.streamId),this.connection.sendResponse("dataSend","open",this.hdsRequestId,A.HDSStatus.SUCCESS,{status:A.HDSStatus.SUCCESS}),e=262144,t=!0,r=1,i=!1,E.label=1;case 1:E.trys.push([1,14,15,16]),this.generator=this.delegate.handleRecordingStreamRequest(this.streamId),E.label=2;case 2:E.trys.push([2,7,8,13]),n=!0,o=C.__asyncValues(this.generator),E.label=3;case 3:return[4,o.next()];case 4:if(a=E.sent(),m=a.done)return[3,6];if(S=a.value,n=!1,s=S,this.closed)return console.error("[HDS ".concat(this.connection.remoteAddress,"] Delegate yielded fragment after stream ").concat(this.streamId," was already closed!")),[3,6];if(i)return console.error("[HDS ".concat(this.connection.remoteAddress,"] Delegate yielded fragment for stream ").concat(this.streamId," after already signaling end of stream!")),[3,6];for(c=s.data,u=0,l=1;u<c.length;)h=c.slice(u,u+e),u+=h.length,d={streamId:this.streamId,packets:[{data:h,metadata:{dataType:t?"mediaInitialization":"mediaFragment",dataSequenceNumber:r,dataChunkSequenceNumber:l,isLastDataChunk:u>=c.length,dataTotalSize:1===l?c.length:void 0}}],endOfStream:u>=c.length?Boolean(s.isLast).valueOf():void 0},b("[HDS %s] Sending DATA_SEND DATA for stream %d with metadata: %o and length %d; EoS: %s",this.connection.remoteAddress,this.streamId,d.packets[0].metadata,h.length,d.endOfStream),this.connection.sendEvent("dataSend","data",d),l++,t=!1;if(i=s.isLast,s.isLast)return[3,6];r++,E.label=5;case 5:return n=!0,[3,3];case 6:return[3,13];case 7:return p=E.sent(),v={error:p},[3,13];case 8:return E.trys.push([8,,11,12]),n||m||!(y=o.return)?[3,10]:[4,y.call(o)];case 9:E.sent(),E.label=10;case 10:return[3,12];case 11:if(v)throw v.error;return[7];case 12:return[7];case 13:return i||this.closed||console.warn("[HDS ".concat(this.connection.remoteAddress,"] Delegate finished streaming for ").concat(this.streamId," without setting RecordingPacket.isLast.         Can't notify Controller about endOfStream!")),[3,16];case 14:if(f=E.sent(),this.closed)console.warn("[HDS ".concat(this.connection.remoteAddress,"] Encountered unexpected error on already closed recording stream ").concat(this.streamId,": ").concat(f.stack));else{if(g=5,f instanceof A.HDSProtocolError)g=f.reason,b("[HDS %s] Delegate signaled to close the recording stream %d.",this.connection.remoteAddress,this.streamId);else{if(f instanceof A.HDSConnectionError&&2===f.type)return b("[HDS %s] Exited recording stream due to closed HDS socket: stream id %d.",this.connection.remoteAddress,this.streamId),[2];console.error("[HDS ".concat(this.connection.remoteAddress,"] Encountered unexpected error for recording stream ").concat(this.streamId,": ").concat(f.stack))}this.close(g)}return[2];case 15:return this.generator=void 0,this.generatorTimeout&&clearTimeout(this.generatorTimeout),this.closed||this.kickOffCloseTimeout(),[7];case 16:return t&&console.warn("[HDS ".concat(this.connection.remoteAddress,"] Delegate finished recording stream ").concat(this.streamId," without sending anything out.       Controller will CANCEL.")),b("[HDS %s] Finished DATA_SEND transmission for stream %d!",this.connection.remoteAddress,this.streamId),[2]}}))}))},t.prototype.handleDataSendAck=function(e){var t=this,r=e.streamId,i=e.endOfStream;b("[HDS %s] Received DATA_SEND ACK packet for streamId %s. Acknowledged %s.",this.connection.remoteAddress,r,i),this.handleClosed((function(){var e,r;return null===(r=(e=t.delegate).acknowledgeStream)||void 0===r?void 0:r.call(e,t.streamId)}))},t.prototype.handleDataSendClose=function(e){var t=this,r=e.streamId,i=e.reason;r===this.streamId&&(b("[HDS %s] Received DATA_SEND CLOSE for streamId %d with reason %s",this.connection.remoteAddress,r,A.HDSProtocolSpecificErrorReason[i]),this.handleClosed((function(){return t.delegate.closeRecordingStream(r,i)})))},t.prototype.handleDataStreamConnectionClosed=function(){var e=this;b("[HDS %s] The HDS connection of the stream %d closed.",this.connection.remoteAddress,this.streamId),this.handleClosed((function(){return e.delegate.closeRecordingStream(e.streamId,void 0)}))},t.prototype.handleClosed=function(e){var t=this;this.closed=!0,this.closingTimeout&&(clearTimeout(this.closingTimeout),this.closingTimeout=void 0),this.connection.removeProtocolHandler("dataSend",this),this.connection.removeListener("closed",this.closeListener),this.generator&&(this.generatorTimeout=setTimeout((function(){console.error("[HDS %s] Recording download stream %d is still awaiting generator although stream was closed 10s ago! This is a programming mistake by the camera implementation which prevents freeing up resources.",t.connection.remoteAddress,t.streamId)}),1e4));try{e()}catch(e){console.error("[HDS ".concat(this.connection.remoteAddress,"] CameraRecordingDelegated failed to handle closing the stream ").concat(this.streamId,": ").concat(e.stack))}this.emit("closed")},t.prototype.close=function(e){var t=this;this.closed||(b("[HDS %s] Recording stream %d was closed manually with reason %s.",this.connection.remoteAddress,this.streamId,e?A.HDSProtocolSpecificErrorReason[e]:"CLOSED"),this.connection.isConsideredClosed()||this.connection.sendEvent("dataSend","close",{streamId:this.streamId,reason:e}),this.handleClosed((function(){return t.delegate.closeRecordingStream(t.streamId,e)})))},t.prototype.kickOffCloseTimeout=function(){var e=this;this.closingTimeout&&clearTimeout(this.closingTimeout),this.closingTimeout=setTimeout((function(){e.closed||(b("[HDS %s] Recording stream %d took longer than expected to fully close. Force closing now!",e.connection.remoteAddress,e.streamId),e.close(3))}),12e3)},t}(_.EventEmitter)},8591:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(1635);i.__exportStar(r(9672),t),i.__exportStar(r(5989),t),i.__exportStar(r(8598),t),i.__exportStar(r(6859),t)},6864:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdaptiveLightingController=t.AdaptiveLightingControllerEvents=t.AdaptiveLightingControllerMode=void 0;var i,n,o,a,s,c,u,l,h,d,p,f,g,m,v,y=r(1635),C=y.__importDefault(r(2613)),S=r(2175),E=r(8073),_=r(1579),T=y.__importStar(r(2997)),A=y.__importDefault(r(5753)),I=r(4434),D=r(9826),w=y.__importStar(r(3314)),b=(0,A.default)("HAP-NodeJS:Controller:TransitionControl");!function(e){e[e.SUPPORTED_TRANSITION_CONFIGURATION=1]="SUPPORTED_TRANSITION_CONFIGURATION"}(i||(i={})),function(e){e[e.CHARACTERISTIC_IID=1]="CHARACTERISTIC_IID",e[e.TRANSITION_TYPE=2]="TRANSITION_TYPE"}(n||(n={})),function(e){e[e.BRIGHTNESS=1]="BRIGHTNESS",e[e.COLOR_TEMPERATURE=2]="COLOR_TEMPERATURE"}(o||(o={})),function(e){e[e.READ_CURRENT_VALUE_TRANSITION_CONFIGURATION=1]="READ_CURRENT_VALUE_TRANSITION_CONFIGURATION",e[e.UPDATE_VALUE_TRANSITION_CONFIGURATION=2]="UPDATE_VALUE_TRANSITION_CONFIGURATION"}(a||(a={})),function(e){e[e.CHARACTERISTIC_IID=1]="CHARACTERISTIC_IID"}(s||(s={})),function(e){e[e.VALUE_TRANSITION_CONFIGURATION=1]="VALUE_TRANSITION_CONFIGURATION"}(c||(c={})),function(e){e[e.CHARACTERISTIC_IID=1]="CHARACTERISTIC_IID",e[e.TRANSITION_PARAMETERS=2]="TRANSITION_PARAMETERS",e[e.UNKNOWN_3=3]="UNKNOWN_3",e[e.UNKNOWN_4=4]="UNKNOWN_4",e[e.TRANSITION_CURVE_CONFIGURATION=5]="TRANSITION_CURVE_CONFIGURATION",e[e.UPDATE_INTERVAL=6]="UPDATE_INTERVAL",e[e.UNKNOWN_7=7]="UNKNOWN_7",e[e.NOTIFY_INTERVAL_THRESHOLD=8]="NOTIFY_INTERVAL_THRESHOLD"}(u||(u={})),function(e){e[e.TRANSITION_ID=1]="TRANSITION_ID",e[e.START_TIME=2]="START_TIME",e[e.UNKNOWN_3=3]="UNKNOWN_3"}(l||(l={})),function(e){e[e.TRANSITION_ENTRY=1]="TRANSITION_ENTRY",e[e.ADJUSTMENT_CHARACTERISTIC_IID=2]="ADJUSTMENT_CHARACTERISTIC_IID",e[e.ADJUSTMENT_MULTIPLIER_RANGE=3]="ADJUSTMENT_MULTIPLIER_RANGE"}(h||(h={})),function(e){e[e.ADJUSTMENT_FACTOR=1]="ADJUSTMENT_FACTOR",e[e.VALUE=2]="VALUE",e[e.TRANSITION_OFFSET=3]="TRANSITION_OFFSET",e[e.DURATION=4]="DURATION"}(d||(d={})),function(e){e[e.MINIMUM_ADJUSTMENT_MULTIPLIER=1]="MINIMUM_ADJUSTMENT_MULTIPLIER",e[e.MAXIMUM_ADJUSTMENT_MULTIPLIER=2]="MAXIMUM_ADJUSTMENT_MULTIPLIER"}(p||(p={})),function(e){e[e.VALUE_CONFIGURATION_STATUS=1]="VALUE_CONFIGURATION_STATUS"}(f||(f={})),function(e){e[e.CHARACTERISTIC_IID=1]="CHARACTERISTIC_IID",e[e.TRANSITION_PARAMETERS=2]="TRANSITION_PARAMETERS",e[e.TIME_SINCE_START=3]="TIME_SINCE_START"}(g||(g={})),function(e){e[e.AUTOMATIC=1]="AUTOMATIC",e[e.MANUAL=2]="MANUAL"}(m||(t.AdaptiveLightingControllerMode=m={})),function(e){e.UPDATE="update",e.DISABLED="disable"}(v||(t.AdaptiveLightingControllerEvents=v={}));var U=function(e){function t(t,r){var i,n,o=e.call(this)||this;return o.didRunFirstInitializationStep=!1,o.lastEventNotificationSent=0,o.lastNotifiedTemperatureValue=0,o.lastNotifiedSaturationValue=0,o.lastNotifiedHueValue=0,o.lightbulb=t,o.mode=null!==(i=null==r?void 0:r.controllerMode)&&void 0!==i?i:1,o.customTemperatureAdjustment=null!==(n=null==r?void 0:r.customTemperatureAdjustment)&&void 0!==n?n:0,(0,C.default)(o.lightbulb.testCharacteristic(D.Characteristic.ColorTemperature),"Lightbulb must have the ColorTemperature characteristic added!"),(0,C.default)(o.lightbulb.testCharacteristic(D.Characteristic.Brightness),"Lightbulb must have the Brightness characteristic added!"),o.adjustmentFactorChangedListener=o.handleAdjustmentFactorChanged.bind(o),o.characteristicManualWrittenChangeListener=o.handleCharacteristicManualWritten.bind(o),o}return y.__extends(t,e),t.prototype.controllerId=function(){return"characteristic-transition-"+this.lightbulb.getServiceId()},t.prototype.isAdaptiveLightingActive=function(){return!!this.activeTransition},t.prototype.disableAdaptiveLighting=function(){var e;this.updateTimeout&&(clearTimeout(this.updateTimeout),this.updateTimeout=void 0),this.activeTransition&&(this.colorTemperatureCharacteristic.removeListener("change",this.characteristicManualWrittenChangeListener),this.brightnessCharacteristic.removeListener("change",this.adjustmentFactorChangedListener),this.hueCharacteristic&&this.hueCharacteristic.removeListener("change",this.characteristicManualWrittenChangeListener),this.saturationCharacteristic&&this.saturationCharacteristic.removeListener("change",this.characteristicManualWrittenChangeListener),this.activeTransition=void 0,null===(e=this.stateChangeDelegate)||void 0===e||e.call(this)),this.colorTemperatureCharacteristic=void 0,this.brightnessCharacteristic=void 0,this.hueCharacteristic=void 0,this.saturationCharacteristic=void 0,this.lastTransitionPointInfo=void 0,this.lastEventNotificationSent=0,this.lastNotifiedTemperatureValue=0,this.lastNotifiedSaturationValue=0,this.lastNotifiedHueValue=0,this.didRunFirstInitializationStep=!1,this.activeTransitionCount.sendEventNotification(0),b("[%s] Disabling adaptive lighting",this.lightbulb.displayName)},t.prototype.getAdaptiveLightingStartTimeOfTransition=function(){if(!this.activeTransition)throw new Error("There is no active transition!");return this.activeTransition.transitionStartMillis},t.prototype.getAdaptiveLightingTimeOffset=function(){if(!this.activeTransition)throw new Error("There is no active transition!");return this.activeTransition.timeMillisOffset},t.prototype.getAdaptiveLightingTransitionCurve=function(){if(!this.activeTransition)throw new Error("There is no active transition!");return this.activeTransition.transitionCurve},t.prototype.getAdaptiveLightingBrightnessMultiplierRange=function(){if(!this.activeTransition)throw new Error("There is no active transition!");return this.activeTransition.brightnessAdjustmentRange},t.prototype.getAdaptiveLightingUpdateInterval=function(){if(!this.activeTransition)throw new Error("There is no active transition!");return this.activeTransition.updateInterval},t.prototype.getAdaptiveLightingNotifyIntervalThreshold=function(){if(!this.activeTransition)throw new Error("There is no active transition!");return this.activeTransition.notifyIntervalThreshold},t.prototype.handleActiveTransitionUpdated=function(e){var t;if(void 0===e&&(e=!1),e?this.activeTransitionCount.value=1:this.activeTransitionCount.sendEventNotification(1),1===this.mode)this.scheduleNextUpdate();else{if(2!==this.mode)throw new Error("Unsupported adaptive lighting controller mode: "+this.mode);this.emit("update")}e||null===(t=this.stateChangeDelegate)||void 0===t||t.call(this)},t.prototype.handleAdaptiveLightingEnabled=function(){if(!this.activeTransition)throw new Error("There is no active transition!");this.colorTemperatureCharacteristic=this.lightbulb.getCharacteristic(D.Characteristic.ColorTemperature),this.brightnessCharacteristic=this.lightbulb.getCharacteristic(D.Characteristic.Brightness),this.colorTemperatureCharacteristic.on("change",this.characteristicManualWrittenChangeListener),this.brightnessCharacteristic.on("change",this.adjustmentFactorChangedListener),this.lightbulb.testCharacteristic(D.Characteristic.Hue)&&(this.hueCharacteristic=this.lightbulb.getCharacteristic(D.Characteristic.Hue).on("change",this.characteristicManualWrittenChangeListener)),this.lightbulb.testCharacteristic(D.Characteristic.Saturation)&&(this.saturationCharacteristic=this.lightbulb.getCharacteristic(D.Characteristic.Saturation).on("change",this.characteristicManualWrittenChangeListener))},t.prototype.handleAdaptiveLightingDisabled=function(){2===this.mode&&this.activeTransition&&this.emit("disable"),this.disableAdaptiveLighting()},t.prototype.handleAdjustmentFactorChanged=function(e){var t=this;e.newValue!==e.oldValue&&("read"===e.reason?setTimeout((function(){t.activeTransition&&t.scheduleNextUpdate(!0)}),1e3).unref():this.scheduleNextUpdate(!0))},t.prototype.handleCharacteristicManualWritten=function(e){var t;"write"!==e.reason||(t=e.context)&&"controller"in t&&e.context.controller===this||(b("[%s] Received a manual write to an characteristic (newValue: %d, oldValue: %d, reason: %s). Thus disabling adaptive lighting!",this.lightbulb.displayName,e.newValue,e.oldValue,e.reason),this.disableAdaptiveLighting())},t.prototype.getCurrentAdaptiveLightingTransitionPoint=function(){var e,t,r,i,n;if(!this.activeTransition)throw new Error("Cannot calculate current transition point if no transition is active!");for(var o=Date.now()-this.activeTransition.timeMillisOffset-this.activeTransition.transitionStartMillis,a=null!==(t=null===(e=this.lastTransitionPointInfo)||void 0===e?void 0:e.curveIndex)&&void 0!==t?t:0,s=null!==(i=null===(r=this.lastTransitionPointInfo)||void 0===r?void 0:r.lowerBoundTimeOffset)&&void 0!==i?i:0,c=void 0,u=void 0;a+1<this.activeTransition.transitionCurve.length;a++){var l=this.activeTransition.transitionCurve[a],h=this.activeTransition.transitionCurve[a+1],d=null!==(n=l.duration)&&void 0!==n?n:0;if(o>=(s+=l.transitionTime)){if(o<=s+d+h.transitionTime){c=l,u=h;break}}else if(this.lastTransitionPointInfo)return this.lastTransitionPointInfo=void 0,this.getCurrentAdaptiveLightingTransitionPoint();s+=d}if(c&&u)return this.lastTransitionPointInfo={curveIndex:a,lowerBoundTimeOffset:s-c.transitionTime},{lowerBoundTimeOffset:s,transitionOffset:o-s,lowerBound:c,upperBound:u};this.lastTransitionPointInfo=void 0},t.prototype.scheduleNextUpdate=function(e){var t,r,i,n,o,a=this;if(void 0===e&&(e=!1),!this.activeTransition)throw new Error("tried scheduling transition when no transition was active!");e||(this.updateTimeout=void 0),this.didRunFirstInitializationStep||(this.didRunFirstInitializationStep=!0,this.handleAdaptiveLightingEnabled());var s=this.getCurrentAdaptiveLightingTransitionPoint();if(!s)return b("[%s] Reached end of transition curve!",this.lightbulb.displayName),void(e||this.disableAdaptiveLighting());var c,u,l=s.lowerBound,h=s.upperBound;if(l.duration&&s.transitionOffset<=l.duration)c=l.temperature,u=l.brightnessAdjustmentFactor;else{var d=(s.transitionOffset-(null!==(t=l.duration)&&void 0!==t?t:0))/h.transitionTime;c=l.temperature+(h.temperature-l.temperature)*d,u=l.brightnessAdjustmentFactor+(h.brightnessAdjustmentFactor-l.brightnessAdjustmentFactor)*d}var p=Math.max(this.activeTransition.brightnessAdjustmentRange.minBrightnessValue,Math.min(this.activeTransition.brightnessAdjustmentRange.maxBrightnessValue,this.brightnessCharacteristic.value)),f=Math.round(c+u*p);f+=this.customTemperatureAdjustment;var g=null!==(i=null===(r=this.colorTemperatureCharacteristic)||void 0===r?void 0:r.props.minValue)&&void 0!==i?i:140,m=null!==(o=null===(n=this.colorTemperatureCharacteristic)||void 0===n?void 0:n.props.maxValue)&&void 0!==o?o:500;f=Math.max(g,Math.min(m,f));var v=S.ColorUtils.colorTemperatureToHueAndSaturation(f);b("[%s] Next temperature value is %d (for brightness %d adj: %s)",this.lightbulb.displayName,f,p,this.customTemperatureAdjustment);var y={controller:this,omitEventUpdate:!0};if(this.saturationCharacteristic&&(this.saturationCharacteristic.value=v.saturation),this.hueCharacteristic&&(this.hueCharacteristic.value=v.hue),this.colorTemperatureCharacteristic.handleSetRequest(f,void 0,y).catch((function(e){b("[%s] Failed to next adaptive lighting transition point: %d",a.lightbulb.displayName,e)})),this.activeTransition){var C=Date.now();if(!e&&C-this.lastEventNotificationSent>=this.activeTransition.notifyIntervalThreshold){b("[%s] Sending event notifications for current transition!",this.lightbulb.displayName),this.lastEventNotificationSent=C;var E={controller:this};this.lastNotifiedTemperatureValue!==f&&(this.colorTemperatureCharacteristic.sendEventNotification(f,E),this.lastNotifiedTemperatureValue=f),this.saturationCharacteristic&&this.lastNotifiedSaturationValue!==v.saturation&&(this.saturationCharacteristic.sendEventNotification(v.saturation,E),this.lastNotifiedSaturationValue=v.saturation),this.hueCharacteristic&&this.lastNotifiedHueValue!==v.hue&&(this.hueCharacteristic.sendEventNotification(v.hue,E),this.lastNotifiedHueValue=v.hue)}e||(this.updateTimeout=setTimeout(this.scheduleNextUpdate.bind(this),this.activeTransition.updateInterval))}else console.warn("["+this.lightbulb.displayName+"] Adaptive Lighting was probably disable my mistake by some call in the SET handler of the ColorTemperature characteristic! Please check that you don't call setValue/setCharacteristic on the Hue, Saturation or ColorTemperature characteristic!")},t.prototype.constructServices=function(){return{}},t.prototype.initWithServices=function(e){},t.prototype.configureServices=function(){var e=this;this.supportedTransitionConfiguration=this.lightbulb.getCharacteristic(D.Characteristic.SupportedCharacteristicValueTransitionConfiguration),this.transitionControl=this.lightbulb.getCharacteristic(D.Characteristic.CharacteristicValueTransitionControl).updateValue(""),this.activeTransitionCount=this.lightbulb.getCharacteristic(D.Characteristic.CharacteristicValueActiveTransitionCount).updateValue(0),this.supportedTransitionConfiguration.onGet(this.handleSupportedTransitionConfigurationRead.bind(this)),this.transitionControl.onGet((function(){return e.buildTransitionControlResponseBuffer().toString("base64")})).onSet((function(t){try{return e.handleTransitionControlWrite(t)}catch(r){throw console.warn("[%s] DEBUG: '".concat(t,"'")),console.warn("[%s] Encountered error on CharacteristicValueTransitionControl characteristic: "+r.stack),e.disableAdaptiveLighting(),new E.HapStatusError(-70402)}}))},t.prototype.handleControllerRemoved=function(){this.lightbulb.removeCharacteristic(this.supportedTransitionConfiguration),this.lightbulb.removeCharacteristic(this.transitionControl),this.lightbulb.removeCharacteristic(this.activeTransitionCount),this.supportedTransitionConfiguration=void 0,this.transitionControl=void 0,this.activeTransitionCount=void 0,this.removeAllListeners()},t.prototype.handleFactoryReset=function(){this.handleAdaptiveLightingDisabled()},t.prototype.serialize=function(){if(this.activeTransition)return{activeTransition:this.activeTransition}},t.prototype.deserialize=function(e){this.activeTransition=e.activeTransition,this.activeTransition.transitionId||(this.activeTransition.transitionId=this.activeTransition.id1,delete this.activeTransition.id1),this.activeTransition.timeMillisOffset||(this.activeTransition.timeMillisOffset=0),this.handleActiveTransitionUpdated(!0)},t.prototype.setupStateChangeDelegate=function(e){this.stateChangeDelegate=e},t.prototype.handleSupportedTransitionConfigurationRead=function(){var e=this.lightbulb.getCharacteristic(D.Characteristic.Brightness).iid,t=this.lightbulb.getCharacteristic(D.Characteristic.ColorTemperature).iid;return(0,C.default)(e,"iid for brightness characteristic is undefined"),(0,C.default)(t,"iid for temperature characteristic is undefined"),w.encode(1,[w.encode(1,w.writeVariableUIntLE(e),2,1),w.encode(1,w.writeVariableUIntLE(t),2,2)]).toString("base64")},t.prototype.buildTransitionControlResponseBuffer=function(e){if(!this.activeTransition)return Buffer.alloc(0);var t=this.activeTransition,r=null!=e?e:Date.now()-t.timeMillisOffset-t.transitionStartMillis,i=w.writeVariableUIntLE(r),n=w.encode(1,T.write(t.transitionId),2,Buffer.from(t.transitionStartBuffer,"hex"));t.id3&&(n=Buffer.concat([n,w.encode(3,Buffer.from(t.id3,"hex"))]));var o=w.encode(1,w.writeVariableUIntLE(t.iid),2,n,3,i);return w.encode(1,o)},t.prototype.handleTransitionControlWrite=function(e){if("string"!=typeof e)throw new E.HapStatusError(-70410);var t=w.decode(Buffer.from(e,"base64")),r=[],i=t[1];if(i){var n=this.handleTransitionControlReadTransition(i);n&&r.push(n)}var o=t[2];if(o){var a=this.handleTransitionControlUpdateTransition(o);a&&r.push(a)}return Buffer.concat(r).toString("base64")},t.prototype.handleTransitionControlReadTransition=function(e){var t=w.decode(e),r=w.readVariableUIntLE(t[1]);if(this.activeTransition){if(this.activeTransition.iid!==r)throw console.warn("["+this.lightbulb.displayName+"] iid of current adaptive lighting transition ("+this.activeTransition.iid+") doesn't match the requested one "+r),new E.HapStatusError(-70410);var i=w.encode(1,T.write(this.activeTransition.transitionId),2,Buffer.from(this.activeTransition.transitionStartBuffer,"hex"));return this.activeTransition.id3&&(i=Buffer.concat([i,w.encode(3,Buffer.from(this.activeTransition.id3,"hex"))])),w.encode(1,w.encode(1,w.writeVariableUIntLE(this.activeTransition.iid),2,i,3,1,5,w.encode(1,this.activeTransition.transitionCurve.map((function(e,t,r){var i,n,o=null!==(n=null===(i=r[t-1])||void 0===i?void 0:i.duration)&&void 0!==n?n:0;return w.encode(1,w.writeFloat32LE(e.brightnessAdjustmentFactor),2,w.writeFloat32LE(e.temperature),3,w.writeVariableUIntLE(e.transitionTime),4,w.writeVariableUIntLE(o))})),2,w.writeVariableUIntLE(this.activeTransition.brightnessCharacteristicIID),3,w.encode(1,w.writeUInt32(this.activeTransition.brightnessAdjustmentRange.minBrightnessValue),2,w.writeUInt32(this.activeTransition.brightnessAdjustmentRange.maxBrightnessValue))),6,w.writeVariableUIntLE(this.activeTransition.updateInterval),8,w.writeVariableUIntLE(this.activeTransition.notifyIntervalThreshold)))}},t.prototype.handleTransitionControlUpdateTransition=function(e){var t,r,i,n,o=w.decode(e),a=w.decode(o[1]),s=w.readVariableUIntLE(a[1]);if(!this.lightbulb.getCharacteristicByIID(s))throw new E.HapStatusError(-70410);if(!(null===(i=a[3])||void 0===i?void 0:i.readUInt8(0)))return this.handleAdaptiveLightingDisabled(),w.encode(2,Buffer.alloc(0));var c=w.decode(a[2]),u=w.decodeWithLists(a[5]),l=null===(n=a[6])||void 0===n?void 0:n.readUInt16LE(0),h=a[8].readUInt32LE(0),d=c[1],p=c[2],f=c[3],g=(0,_.epochMillisFromMillisSince2001_01_01Buffer)(p),m=Date.now()-g,v=[],C=void 0,S=u[1];try{for(var A=y.__values(S),I=A.next();!I.done;I=A.next()){var D=I.value,U=w.decode(D),R=U[1].readFloatLE(0),O=U[2].readFloatLE(0),N=w.readVariableUIntLE(U[3]),P=U[4]?w.readVariableUIntLE(U[4]):void 0;C&&(C.duration=P),C={temperature:O,brightnessAdjustmentFactor:R,transitionTime:N},v.push(C)}}catch(e){t={error:e}}finally{try{I&&!I.done&&(r=A.return)&&r.call(A)}finally{if(t)throw t.error}}var B=w.readVariableUIntLE(u[2]),L=w.decode(u[3]),x=L[1].readUInt32LE(0),M=L[2].readUInt32LE(0);return this.activeTransition={iid:s,transitionStartMillis:g,timeMillisOffset:m,transitionId:T.unparse(d),transitionStartBuffer:p.toString("hex"),id3:null==f?void 0:f.toString("hex"),brightnessCharacteristicIID:B,brightnessAdjustmentRange:{minBrightnessValue:x,maxBrightnessValue:M},transitionCurve:v,updateInterval:null!=l?l:6e4,notifyIntervalThreshold:h},this.updateTimeout?(clearTimeout(this.updateTimeout),this.updateTimeout=void 0,b("[%s] Adaptive lighting was renewed.",this.lightbulb.displayName)):b("[%s] Adaptive lighting was enabled.",this.lightbulb.displayName),this.handleActiveTransitionUpdated(),w.encode(2,this.buildTransitionControlResponseBuffer(0))},t}(I.EventEmitter);t.AdaptiveLightingController=U},2405:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CameraController=t.CameraControllerEvents=t.ResourceRequestReason=void 0;var i,n,o=r(1635),a=o.__importDefault(r(6982)),s=o.__importDefault(r(5753)),c=r(4434),u=r(8591),l=r(9826),h=r(9948),d=r(5876),p=r(8073),f=(0,s.default)("HAP-NodeJS:Camera:Controller");!function(e){e[e.PERIODIC=0]="PERIODIC",e[e.EVENT=1]="EVENT"}(i||(t.ResourceRequestReason=i={})),function(e){e.MICROPHONE_PROPERTIES_CHANGED="microphone-change",e.SPEAKER_PROPERTIES_CHANGED="speaker-change"}(n||(t.CameraControllerEvents=n={}));var g=function(e){function t(t,r){void 0===r&&(r=!1);var i=e.call(this)||this;return i.legacyMode=!1,i.streamManagements=[],i.microphoneMuted=!1,i.microphoneVolume=100,i.speakerMuted=!1,i.speakerVolume=100,i.motionServiceExternallySupplied=!1,i.occupancyServiceExternallySupplied=!1,i.streamCount=Math.max(1,t.cameraStreamCount||1),i.delegate=t.delegate,i.streamingOptions=t.streamingOptions,i.recording=t.recording,i.sensorOptions=t.sensors,i.legacyMode=r,i}return o.__extends(t,e),t.prototype.controllerId=function(){return"camera"},t.prototype.forceStopStreamingSession=function(e){this.streamManagements.forEach((function(t){t.sessionIdentifier===e&&t.forceStop()}))},t.generateSynchronisationSource=function(){var e=a.default.randomBytes(4);return e[0]=0,e.readInt32BE(0)},t.prototype.setMicrophoneMuted=function(e){void 0===e&&(e=!0),this.microphoneService&&(this.microphoneMuted=e,this.microphoneService.updateCharacteristic(l.Characteristic.Mute,e))},t.prototype.setMicrophoneVolume=function(e){this.microphoneService&&(this.microphoneVolume=e,this.microphoneService.updateCharacteristic(l.Characteristic.Volume,e))},t.prototype.setSpeakerMuted=function(e){void 0===e&&(e=!0),this.speakerService&&(this.speakerMuted=e,this.speakerService.updateCharacteristic(l.Characteristic.Mute,e))},t.prototype.setSpeakerVolume=function(e){this.speakerService&&(this.speakerVolume=e,this.speakerService.updateCharacteristic(l.Characteristic.Volume,e))},t.prototype.emitMicrophoneChange=function(){this.emit("microphone-change",this.microphoneMuted,this.microphoneVolume)},t.prototype.emitSpeakerChange=function(){this.emit("speaker-change",this.speakerMuted,this.speakerVolume)},t.prototype.constructServices=function(){for(var e,r,i,n,o=0;o<this.streamCount;o++){var a=new u.RTPStreamManagement(o,this.streamingOptions,this.delegate,void 0,this.rtpStreamManagementDisabledThroughOperatingMode.bind(this));this.streamManagements.push(a)}!this.legacyMode&&this.streamingOptions.audio&&(this.microphoneService=new d.Service.Microphone("",""),this.microphoneService.setCharacteristic(l.Characteristic.Volume,this.microphoneVolume),this.streamingOptions.audio.twoWayAudio&&(this.speakerService=new d.Service.Speaker("",""),this.speakerService.setCharacteristic(l.Characteristic.Volume,this.speakerVolume))),this.recording&&(this.recordingManagement=new u.RecordingManagement(this.recording.options,this.recording.delegate,this.retrieveEventTriggerOptions())),(null===(e=this.sensorOptions)||void 0===e?void 0:e.motion)&&("boolean"==typeof this.sensorOptions.motion?this.motionService=new d.Service.MotionSensor("",""):(this.motionService=this.sensorOptions.motion,this.motionServiceExternallySupplied=!0),this.motionService.setCharacteristic(l.Characteristic.StatusActive,!0),null===(r=this.recordingManagement)||void 0===r||r.recordingManagementService.addLinkedService(this.motionService)),(null===(i=this.sensorOptions)||void 0===i?void 0:i.occupancy)&&("boolean"==typeof this.sensorOptions.occupancy?this.occupancyService=new d.Service.OccupancySensor("",""):(this.occupancyService=this.sensorOptions.occupancy,this.occupancyServiceExternallySupplied=!0),this.occupancyService.setCharacteristic(l.Characteristic.StatusActive,!0),null===(n=this.recordingManagement)||void 0===n||n.recordingManagementService.addLinkedService(this.occupancyService));var s={microphone:this.microphoneService,speaker:this.speakerService,motionService:this.motionServiceExternallySupplied?void 0:this.motionService,occupancyService:this.occupancyServiceExternallySupplied?void 0:this.occupancyService};return this.recordingManagement&&(s.cameraEventRecordingManagement=this.recordingManagement.recordingManagementService,s.cameraOperatingMode=this.recordingManagement.operatingModeService,s.dataStreamTransportManagement=this.recordingManagement.dataStreamManagement.getService()),this.streamManagements.forEach((function(e,r){s[t.STREAM_MANAGEMENT+r]=e.getService()})),this.recording=void 0,this.sensorOptions=void 0,s},t.prototype.initWithServices=function(e){var t=this._initWithServices(e);if(t.updated)return t.serviceMap},t.prototype._initWithServices=function(e){for(var r,i,n,o,a,s,c,p,f,g=!1,m=0;;m++){var v=e[t.STREAM_MANAGEMENT+m];if(m<this.streamCount){var y=this.rtpStreamManagementDisabledThroughOperatingMode.bind(this);if(v)this.streamManagements.push(new u.RTPStreamManagement(m,this.streamingOptions,this.delegate,v,y));else{var C=new u.RTPStreamManagement(m,this.streamingOptions,this.delegate,void 0,y);this.streamManagements.push(C),e[t.STREAM_MANAGEMENT+m]=C.getService(),g=!0}}else{if(!v)break;delete e[t.STREAM_MANAGEMENT+m],g=!0}}if(!this.legacyMode&&this.streamingOptions.audio?e.microphone?this.microphoneService=e.microphone:(this.microphoneService=new d.Service.Microphone("",""),this.microphoneService.setCharacteristic(l.Characteristic.Volume,this.microphoneVolume),e.microphone=this.microphoneService,g=!0):e.microphone&&(delete e.microphone,g=!0),!this.legacyMode&&(null===(r=this.streamingOptions.audio)||void 0===r?void 0:r.twoWayAudio)?e.speaker?this.speakerService=e.speaker:(this.speakerService=new d.Service.Speaker("",""),this.speakerService.setCharacteristic(l.Characteristic.Volume,this.speakerVolume),e.speaker=this.speakerService,g=!0):e.speaker&&(delete e.speaker,g=!0),this.recording){var S=this.retrieveEventTriggerOptions();e.cameraEventRecordingManagement&&e.cameraOperatingMode&&e.dataStreamTransportManagement?this.recordingManagement=new u.RecordingManagement(this.recording.options,this.recording.delegate,S,{recordingManagement:e.cameraEventRecordingManagement,operatingMode:e.cameraOperatingMode,dataStreamManagement:new h.DataStreamManagement(e.dataStreamTransportManagement)}):(this.recordingManagement=new u.RecordingManagement(this.recording.options,this.recording.delegate,S),e.cameraEventRecordingManagement=this.recordingManagement.recordingManagementService,e.cameraOperatingMode=this.recordingManagement.operatingModeService,e.dataStreamTransportManagement=this.recordingManagement.dataStreamManagement.getService(),g=!0)}else e.cameraEventRecordingManagement&&(delete e.cameraEventRecordingManagement,g=!0),e.cameraOperatingMode&&(delete e.cameraOperatingMode,g=!0),e.dataStreamTransportManagement&&(delete e.dataStreamTransportManagement,g=!0);return(null===(i=this.sensorOptions)||void 0===i?void 0:i.motion)?("boolean"==typeof this.sensorOptions.motion?e.motionService?this.motionService=e.motionService:this.motionService=new d.Service.MotionSensor("",""):(this.motionService=this.sensorOptions.motion,this.motionServiceExternallySupplied=!0,e.motionService&&(null===(n=this.recordingManagement)||void 0===n||n.recordingManagementService.removeLinkedService(e.motionService),delete e.motionService,g=!0)),this.motionService.setCharacteristic(l.Characteristic.StatusActive,!0),null===(o=this.recordingManagement)||void 0===o||o.recordingManagementService.addLinkedService(this.motionService)):e.motionService&&(null===(a=this.recordingManagement)||void 0===a||a.recordingManagementService.removeLinkedService(e.motionService),delete e.motionService,g=!0),(null===(s=this.sensorOptions)||void 0===s?void 0:s.occupancy)?("boolean"==typeof this.sensorOptions.occupancy?e.occupancyService?this.occupancyService=e.occupancyService:this.occupancyService=new d.Service.OccupancySensor("",""):(this.occupancyService=this.sensorOptions.occupancy,this.occupancyServiceExternallySupplied=!0,e.occupancyService&&(null===(c=this.recordingManagement)||void 0===c||c.recordingManagementService.removeLinkedService(e.occupancyService),delete e.occupancyService,g=!0)),this.occupancyService.setCharacteristic(l.Characteristic.StatusActive,!0),null===(p=this.recordingManagement)||void 0===p||p.recordingManagementService.addLinkedService(this.occupancyService)):e.occupancyService&&(null===(f=this.recordingManagement)||void 0===f||f.recordingManagementService.removeLinkedService(e.occupancyService),delete e.occupancyService,g=!0),this.migrateFromDoorbell(e)&&(g=!0),this.recording=void 0,this.sensorOptions=void 0,{serviceMap:e,updated:g}},t.prototype.migrateFromDoorbell=function(e){return!!e.doorbell&&(delete e.doorbell,!0)},t.prototype.retrieveEventTriggerOptions=function(){var e,t,r;if(!this.recording)return new Set;var i=new Set;if(this.recording.options.overrideEventTriggerOptions)try{for(var n=o.__values(this.recording.options.overrideEventTriggerOptions),a=n.next();!a.done;a=n.next()){var s=a.value;i.add(s)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return(null===(r=this.sensorOptions)||void 0===r?void 0:r.motion)&&i.add(1),i},t.prototype.configureServices=function(){var e,t,r=this;this.microphoneService&&(this.microphoneService.getCharacteristic(l.Characteristic.Mute).on("get",(function(e){e(void 0,r.microphoneMuted)})).on("set",(function(e,t){r.microphoneMuted=e,t(),r.emitMicrophoneChange()})),this.microphoneService.getCharacteristic(l.Characteristic.Volume).on("get",(function(e){e(void 0,r.microphoneVolume)})).on("set",(function(e,t){r.microphoneVolume=e,t(),r.emitMicrophoneChange()}))),this.speakerService&&(this.speakerService.getCharacteristic(l.Characteristic.Mute).on("get",(function(e){e(void 0,r.speakerMuted)})).on("set",(function(e,t){r.speakerMuted=e,t(),r.emitSpeakerChange()})),this.speakerService.getCharacteristic(l.Characteristic.Volume).on("get",(function(e){e(void 0,r.speakerVolume)})).on("set",(function(e,t){r.speakerVolume=e,t(),r.emitSpeakerChange()}))),this.motionService&&(null===(e=this.recordingManagement)||void 0===e||e.sensorServices.push(this.motionService)),this.occupancyService&&(null===(t=this.recordingManagement)||void 0===t||t.sensorServices.push(this.occupancyService))},t.prototype.rtpStreamManagementDisabledThroughOperatingMode=function(){return!!this.recordingManagement&&!this.recordingManagement.operatingModeService.getCharacteristic(l.Characteristic.HomeKitCameraActive).value},t.prototype.handleControllerRemoved=function(){var e,t,r;this.handleFactoryReset();try{for(var i=o.__values(this.streamManagements),n=i.next();!n.done;n=i.next()){n.value.destroy()}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}this.streamManagements.splice(0,this.streamManagements.length),this.microphoneService=void 0,this.speakerService=void 0,null===(r=this.recordingManagement)||void 0===r||r.destroy(),this.recordingManagement=void 0,this.removeAllListeners()},t.prototype.handleFactoryReset=function(){var e;this.streamManagements.forEach((function(e){return e.handleFactoryReset()})),null===(e=this.recordingManagement)||void 0===e||e.handleFactoryReset(),this.microphoneMuted=!1,this.microphoneVolume=100,this.speakerMuted=!1,this.speakerVolume=100},t.prototype.serialize=function(){var e,t,r,i=[];try{for(var n=o.__values(this.streamManagements),a=n.next();!a.done;a=n.next()){var s=a.value.serialize();s&&i.push(s)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return{streamManagements:i,recordingManagement:null===(r=this.recordingManagement)||void 0===r?void 0:r.serialize()}},t.prototype.deserialize=function(e){var t,r,i,n,a;try{for(var s=o.__values(e.streamManagements),c=s.next();!c.done;c=s.next()){var u=c.value;(p=this.streamManagements[u.id])&&p.deserialize(u)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}if(e.recordingManagement)if(this.recordingManagement)this.recordingManagement.deserialize(e.recordingManagement);else{try{for(var h=o.__values(this.streamManagements),d=h.next();!d.done;d=h.next()){var p;(p=d.value).service.updateCharacteristic(l.Characteristic.Active,!0)}}catch(e){i={error:e}}finally{try{d&&!d.done&&(n=h.return)&&n.call(h)}finally{if(i)throw i.error}}null===(a=this.stateChangeDelegate)||void 0===a||a.call(this)}},t.prototype.setupStateChangeDelegate=function(e){var t,r,i;this.stateChangeDelegate=e;try{for(var n=o.__values(this.streamManagements),a=n.next();!a.done;a=n.next()){a.value.setupStateChangeDelegate(e)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}null===(i=this.recordingManagement)||void 0===i||i.setupStateChangeDelegate(e)},t.prototype.handleSnapshotRequest=function(e,t,r,i){var n=this;if(this.streamManagements.map((function(e){return!e.getService().getCharacteristic(l.Characteristic.Active).value})).reduce((function(e,t){return e&&t})))return f("[%s] Rejecting snapshot as streaming is disabled.",r),Promise.reject(-70412);if(this.recordingManagement){var o=this.recordingManagement.operatingModeService;if(!o.getCharacteristic(l.Characteristic.HomeKitCameraActive).value)return f("[%s] Rejecting snapshot as HomeKit camera is disabled.",r),Promise.reject(-70412);if(!o.getCharacteristic(l.Characteristic.EventSnapshotsActive).value){if(null==i)return f("[%s] Rejecting snapshot as reason is required due to disabled event snapshots.",r),Promise.reject(-70401);if(1===i)return f("[%s] Rejecting snapshot as even snapshots are disabled.",r),Promise.reject(-70412)}if(!o.getCharacteristic(l.Characteristic.PeriodicSnapshotsActive).value){if(null==i)return f("[%s] Rejecting snapshot as reason is required due to disabled periodic snapshots.",r),Promise.reject(-70401);if(0===i)return f("[%s] Rejecting snapshot as periodic snapshots are disabled.",r),Promise.reject(-70412)}}return new Promise((function(o,a){var s=setTimeout((function(){console.warn("[".concat(r,"] The image snapshot handler for the given accessory is slow to respond! See https://homebridge.io/w/JtMGR for more info.")),(s=setTimeout((function(){s=void 0,console.warn("[".concat(r,"] The image snapshot handler for the given accessory didn't respond at all! See https://homebridge.io/w/JtMGR for more info.")),a(-70408)}),17e3)).unref()}),5e3);s.unref();try{n.delegate.handleSnapshotRequest({height:e,width:t,reason:i},(function(e,t){s&&(clearTimeout(s),s=void 0,e?"number"==typeof e?a(e):(f("[%s] Error getting snapshot: %s",r,e.stack),a(-70402)):t&&0!==t.length?o(t):(console.warn("[".concat(r,"] Snapshot request handler provided empty image buffer!")),a(-70402)))}))}catch(e){if(!s)return;clearTimeout(s),s=void 0,console.warn("[".concat(r,"] Unhandled error thrown inside snapshot request handler: ").concat(e.stack)),a(e instanceof p.HapStatusError?e.hapStatus:-70402)}}))},t.prototype.handleCloseConnection=function(e){this.delegate instanceof u.LegacyCameraSourceAdapter&&this.delegate.forwardCloseConnection(e)},t.STREAM_MANAGEMENT="streamManagement",t}(c.EventEmitter);t.CameraController=g},9414:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.isSerializableController=t.DefaultControllerType=void 0,function(e){e.CAMERA="camera",e.REMOTE="remote",e.TV="tv",e.ROUTER="router",e.LOCK="lock",e.CHARACTERISTIC_TRANSITION="characteristic-transition"}(r||(t.DefaultControllerType=r={})),t.isSerializableController=function(e){return"serialize"in e&&"deserialize"in e&&"setupStateChangeDelegate"in e}},7959:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DoorbellController=void 0;var i=r(1635),n=r(9826),o=r(5876),a=function(e){function t(t){var r=e.call(this,t)||this;return r.doorbellServiceExternallySupplied=!1,r.doorbellOptions={name:t.name,externalDoorbellService:t.externalDoorbellService},r}return i.__extends(t,e),t.prototype.ringDoorbell=function(){this.doorbellService.updateCharacteristic(n.Characteristic.ProgrammableSwitchEvent,n.Characteristic.ProgrammableSwitchEvent.SINGLE_PRESS)},t.prototype.constructServices=function(){var t,r,i;(null===(t=this.doorbellOptions)||void 0===t?void 0:t.externalDoorbellService)?(this.doorbellService=this.doorbellOptions.externalDoorbellService,this.doorbellServiceExternallySupplied=!0):this.doorbellService=new o.Service.Doorbell(null!==(i=null===(r=this.doorbellOptions)||void 0===r?void 0:r.name)&&void 0!==i?i:"",""),this.doorbellService.setPrimaryService();var n=e.prototype.constructServices.call(this);return this.doorbellServiceExternallySupplied||(n.doorbell=this.doorbellService),n},t.prototype.initWithServices=function(t){var r,i,n,a=e.prototype._initWithServices.call(this,t);if((null===(r=this.doorbellOptions)||void 0===r?void 0:r.externalDoorbellService)?(this.doorbellService=this.doorbellOptions.externalDoorbellService,this.doorbellServiceExternallySupplied=!0,a.serviceMap.doorbell&&(delete a.serviceMap.doorbell,a.updated=!0)):(this.doorbellService=a.serviceMap.doorbell,this.doorbellService||(this.doorbellService=new o.Service.Doorbell(null!==(n=null===(i=this.doorbellOptions)||void 0===i?void 0:i.name)&&void 0!==n?n:"",""),a.serviceMap.doorbell=this.doorbellService,a.updated=!0)),this.doorbellService.setPrimaryService(),a.updated)return a.serviceMap},t.prototype.migrateFromDoorbell=function(e){return!1},t.prototype.retrieveEventTriggerOptions=function(){var t=e.prototype.retrieveEventTriggerOptions.call(this);return t.add(2),t},t.prototype.handleControllerRemoved=function(){e.prototype.handleControllerRemoved.call(this),this.doorbellService=void 0},t.prototype.configureServices=function(){e.prototype.configureServices.call(this),this.doorbellService.getCharacteristic(n.Characteristic.ProgrammableSwitchEvent).onGet((function(){return null})),this.doorbellOptions=void 0},t}(r(2405).CameraController);t.DoorbellController=a},9352:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SiriAudioSession=t.SiriAudioSessionEvents=t.HomeKitRemoteController=t.RemoteController=t.RemoteControllerEvents=t.TargetUpdates=t.AudioCodecTypes=t.ButtonState=t.TargetCategory=t.ButtonType=void 0;var i,n,o,a,s,c,u,l,h,d,p,f,g,m,v,y,C,S,E=r(1635),_=E.__importDefault(r(2613)),T=E.__importDefault(r(5753)),A=r(4434),I=r(9826),D=r(9948),w=r(5876),b=E.__importStar(r(3314)),U=(0,T.default)("HAP-NodeJS:Remote:Controller");!function(e){e[e.MAXIMUM_TARGETS=1]="MAXIMUM_TARGETS",e[e.TICKS_PER_SECOND=2]="TICKS_PER_SECOND",e[e.SUPPORTED_BUTTON_CONFIGURATION=3]="SUPPORTED_BUTTON_CONFIGURATION",e[e.TYPE=4]="TYPE"}(i||(i={})),function(e){e[e.BUTTON_ID=1]="BUTTON_ID",e[e.BUTTON_TYPE=2]="BUTTON_TYPE"}(n||(n={})),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.MENU=1]="MENU",e[e.PLAY_PAUSE=2]="PLAY_PAUSE",e[e.TV_HOME=3]="TV_HOME",e[e.SELECT=4]="SELECT",e[e.ARROW_UP=5]="ARROW_UP",e[e.ARROW_RIGHT=6]="ARROW_RIGHT",e[e.ARROW_DOWN=7]="ARROW_DOWN",e[e.ARROW_LEFT=8]="ARROW_LEFT",e[e.VOLUME_UP=9]="VOLUME_UP",e[e.VOLUME_DOWN=10]="VOLUME_DOWN",e[e.SIRI=11]="SIRI",e[e.POWER=12]="POWER",e[e.GENERIC=13]="GENERIC"}(o||(t.ButtonType=o={})),function(e){e[e.OPERATION=1]="OPERATION",e[e.TARGET_CONFIGURATION=2]="TARGET_CONFIGURATION"}(a||(a={})),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.LIST=1]="LIST",e[e.ADD=2]="ADD",e[e.REMOVE=3]="REMOVE",e[e.RESET=4]="RESET",e[e.UPDATE=5]="UPDATE"}(s||(s={})),function(e){e[e.TARGET_IDENTIFIER=1]="TARGET_IDENTIFIER",e[e.TARGET_NAME=2]="TARGET_NAME",e[e.TARGET_CATEGORY=3]="TARGET_CATEGORY",e[e.BUTTON_CONFIGURATION=4]="BUTTON_CONFIGURATION"}(c||(c={})),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.APPLE_TV=24]="APPLE_TV"}(u||(t.TargetCategory=u={})),function(e){e[e.BUTTON_ID=1]="BUTTON_ID",e[e.BUTTON_TYPE=2]="BUTTON_TYPE",e[e.BUTTON_NAME=3]="BUTTON_NAME"}(l||(l={})),function(e){e[e.BUTTON_ID=1]="BUTTON_ID",e[e.BUTTON_STATE=2]="BUTTON_STATE",e[e.TIMESTAMP=3]="TIMESTAMP",e[e.ACTIVE_IDENTIFIER=4]="ACTIVE_IDENTIFIER"}(h||(h={})),function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN"}(d||(t.ButtonState=d={})),function(e){e[e.SELECTED_AUDIO_INPUT_STREAM_CONFIGURATION=1]="SELECTED_AUDIO_INPUT_STREAM_CONFIGURATION"}(p||(p={})),function(e){e[e.AUDIO_CODEC_CONFIGURATION=1]="AUDIO_CODEC_CONFIGURATION",e[e.COMFORT_NOISE_SUPPORT=2]="COMFORT_NOISE_SUPPORT"}(f||(f={})),function(e){e[e.CODEC_TYPE=1]="CODEC_TYPE",e[e.CODEC_PARAMETERS=2]="CODEC_PARAMETERS"}(g||(g={})),function(e){e[e.PCMU=0]="PCMU",e[e.PCMA=1]="PCMA",e[e.AAC_ELD=2]="AAC_ELD",e[e.OPUS=3]="OPUS",e[e.MSBC=4]="MSBC",e[e.AMR=5]="AMR",e[e.AMR_WB=6]="AMR_WB"}(m||(t.AudioCodecTypes=m={})),function(e){e[e.CHANNEL=1]="CHANNEL",e[e.BIT_RATE=2]="BIT_RATE",e[e.SAMPLE_RATE=3]="SAMPLE_RATE",e[e.PACKET_TIME=4]="PACKET_TIME"}(v||(v={})),function(e){e[e.STARTING=0]="STARTING",e[e.SENDING=1]="SENDING",e[e.CLOSING=2]="CLOSING",e[e.CLOSED=3]="CLOSED"}(y||(y={})),function(e){e[e.NAME=0]="NAME",e[e.CATEGORY=1]="CATEGORY",e[e.UPDATED_BUTTONS=2]="UPDATED_BUTTONS",e[e.REMOVED_BUTTONS=3]="REMOVED_BUTTONS"}(C||(t.TargetUpdates=C={})),function(e){e.ACTIVE_CHANGE="active-change",e.ACTIVE_IDENTIFIER_CHANGE="active-identifier-change",e.TARGET_ADDED="target-add",e.TARGET_UPDATED="target-update",e.TARGET_REMOVED="target-remove",e.TARGETS_RESET="targets-reset"}(S||(t.RemoteControllerEvents=S={}));var R=function(e){function t(r,i){var n=e.call(this)||this;n.buttons={},n.targetConfigurations=new Map,n.targetConfigurationsString="",n.lastButtonEvent="",n.activeIdentifier=0,n.dataStreamConnections=new Map,n.audioSupported=void 0!==r,n.audioProducerConstructor=r,n.audioProducerOptions=i;var o=n.constructSupportedConfiguration();n.supportedConfiguration=n.buildTargetControlSupportedConfigurationTLV(o);var a=n.constructSupportedAudioConfiguration();return n.supportedAudioConfiguration=t.buildSupportedAudioConfigurationTLV(a),n.selectedAudioConfiguration={codecType:3,parameters:{channels:1,bitrate:0,samplerate:1,rtpTime:20}},n.selectedAudioConfigurationString=t.buildSelectedAudioConfigurationTLV({audioCodecConfiguration:n.selectedAudioConfiguration}),n}return E.__extends(t,e),t.prototype.controllerId=function(){return"remote"},t.prototype.setActiveIdentifier=function(e){var t=this;if(e!==this.activeIdentifier){if(0!==e&&!this.targetConfigurations.has(e))throw Error("Tried setting unconfigured targetIdentifier to active");U("%d is now the active target",e),this.activeIdentifier=e,this.targetControlService.getCharacteristic(I.Characteristic.ActiveIdentifier).updateValue(e),this.activeAudioSession&&this.handleSiriAudioStop(),setTimeout((function(){return t.emit("active-identifier-change",e)}),0),this.setInactive()}},t.prototype.isActive=function(){return!!this.activeConnection},t.prototype.isConfigured=function(e){return this.targetConfigurations.has(e)},t.prototype.getTargetIdentifierByName=function(e){var t,r;try{for(var i=E.__values(Object.entries(this.targetConfigurations)),n=i.next();!n.done;n=i.next()){var o=E.__read(n.value,2),a=o[0];if(o[1].targetName===e)return parseInt(a,10)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}},t.prototype.pushButton=function(e){this.sendButtonEvent(e,1)},t.prototype.releaseButton=function(e){this.sendButtonEvent(e,0)},t.prototype.pushAndReleaseButton=function(e,t){var r=this;void 0===t&&(t=200),this.pushButton(e),setTimeout((function(){return r.releaseButton(e)}),t)},t.prototype.addServicesToAccessory=function(e){e.configureController(this)},t.prototype.constructSupportedConfiguration=function(){var e=this,t={maximumTargets:10,ticksPerSecond:1e3,supportedButtonConfiguration:[],hardwareImplemented:this.audioSupported},r=[1,2,3,4,5,6,7,8,9,10,12,13];return this.audioSupported&&r.push(11),r.forEach((function(r){var i={buttonID:100+r,buttonType:r};t.supportedButtonConfiguration.push(i),e.buttons[r]=i.buttonID})),t},t.prototype.constructSupportedAudioConfiguration=function(){return{audioCodecConfiguration:{codecType:3,parameters:{channels:1,bitrate:0,samplerate:1}}}},t.prototype.handleTargetControlWrite=function(e,t){var r,i=Buffer.from(e,"base64"),n=b.decode(i),o=n[1][0],a=void 0;switch(n[2]&&(a=this.parseTargetConfigurationTLV(n[2])),U("Received TargetControl write operation %s",s[o]),o){case s.ADD:r=this.handleAddTarget.bind(this);break;case s.UPDATE:r=this.handleUpdateTarget.bind(this);break;case s.REMOVE:r=this.handleRemoveTarget.bind(this);break;case s.RESET:r=this.handleResetTargets.bind(this);break;case s.LIST:r=this.handleListTargets.bind(this);break;default:return void t(-70410,void 0)}var c=r(a);0===c?(t(void 0,this.targetConfigurationsString),o===s.ADD&&0===this.activeIdentifier&&this.setActiveIdentifier(a.targetIdentifier)):t(new Error(c+""))},t.prototype.handleAddTarget=function(e){var t=this;return e?(this.targetConfigurations.set(e.targetIdentifier,e),U("Configured new target '"+e.targetName+"' with targetIdentifier '"+e.targetIdentifier+"'"),setTimeout((function(){return t.emit("target-add",e)}),0),this.updatedTargetConfiguration(),0):-70410},t.prototype.handleUpdateTarget=function(e){var t,r,i=this;if(!e)return-70410;var n=[],o=this.targetConfigurations.get(e.targetIdentifier);if(!o)return-70410;if(e.targetName&&(U("Target name was updated '%s' => '%s' (%d)",o.targetName,e.targetName,o.targetIdentifier),o.targetName=e.targetName,n.push(0)),e.targetCategory&&(U("Target category was updated '%d' => '%d' for target '%s' (%d)",o.targetCategory,e.targetCategory,o.targetName,o.targetIdentifier),o.targetCategory=e.targetCategory,n.push(1)),e.buttonConfiguration){U("%d button configurations were updated for target '%s' (%d)",Object.keys(e.buttonConfiguration).length,o.targetName,o.targetIdentifier);try{for(var a=E.__values(Object.values(e.buttonConfiguration)),s=a.next();!s.done;s=a.next()){var c=s.value,u=o.buttonConfiguration[c.buttonID];u.buttonType=c.buttonType,u.buttonName=c.buttonName}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}n.push(2)}return setTimeout((function(){return i.emit("target-update",e,n)}),0),this.updatedTargetConfiguration(),0},t.prototype.handleRemoveTarget=function(e){var t=this;if(!e)return-70410;var r=this.targetConfigurations.get(e.targetIdentifier);if(!r)return-70410;if(e.buttonConfiguration){for(var i in e.buttonConfiguration)Object.prototype.hasOwnProperty.call(e.buttonConfiguration,i)&&delete r.buttonConfiguration[i];U("Removed %d button configurations of target '%s' (%d)",Object.keys(e.buttonConfiguration).length,r.targetName,r.targetIdentifier),setTimeout((function(){return t.emit("target-update",r,[3])}),0)}else{this.targetConfigurations.delete(e.targetIdentifier),U("Target '%s' (%d) was removed",r.targetName,r.targetIdentifier),setTimeout((function(){return t.emit("target-remove",e.targetIdentifier)}),0);var n=Object.keys(this.targetConfigurations);this.setActiveIdentifier(0===n.length?0:parseInt(n[0],10))}return this.updatedTargetConfiguration(),0},t.prototype.handleResetTargets=function(e){var t=this;return e?-70410:(U("Resetting all target configurations"),this.targetConfigurations=new Map,this.updatedTargetConfiguration(),setTimeout((function(){return t.emit("targets-reset")}),0),this.setActiveIdentifier(0),0)},t.prototype.handleListTargets=function(e){return e?-70410:(U("Returning "+Object.keys(this.targetConfigurations).length+" target configurations"),0)},t.prototype.handleActiveWrite=function(e,t,r){if(0===this.activeIdentifier)return U("Tried to change active state. There is no active target set though"),void t(-70410);this.activeConnection&&(this.activeConnection.removeListener("closed",this.activeConnectionDisconnectListener),this.activeConnection=void 0,this.activeConnectionDisconnectListener=void 0),this.activeConnection=e?r:void 0,this.activeConnection&&(this.activeConnectionDisconnectListener=this.handleActiveSessionDisconnected.bind(this,this.activeConnection),this.activeConnection.on("closed",this.activeConnectionDisconnectListener));var i=this.targetConfigurations.get(this.activeIdentifier);i?(U("Remote with activeTarget '%s' (%d) was set to %s",i.targetName,this.activeIdentifier,e?"ACTIVE":"INACTIVE"),t(),this.emit("active-change",e)):t(-70410)},t.prototype.setInactive=function(){var e=this;void 0!==this.activeConnection&&(this.activeConnection.removeListener("closed",this.activeConnectionDisconnectListener),this.activeConnection=void 0,this.activeConnectionDisconnectListener=void 0,this.targetControlService.getCharacteristic(I.Characteristic.Active).updateValue(!1),U("Remote was set to INACTIVE"),setTimeout((function(){return e.emit("active-change",!1)}),0))},t.prototype.handleActiveSessionDisconnected=function(e){e===this.activeConnection&&(U("Active hap session disconnected!"),this.setInactive())},t.prototype.sendButtonEvent=function(e,t){var r=this.buttons[e];if(void 0===r||0===r)throw new Error("Tried sending button event for unsupported button ("+e+")");if(0===this.activeIdentifier)throw new Error("Tried sending button event although no target was selected");if(!this.isActive())throw new Error("Tried sending button event although target was not marked as active");if(11===e&&this.audioSupported)1===t?this.handleSiriAudioStart():0===t&&this.handleSiriAudioStop();else{var i=b.encode(1,r),n=b.encode(2,t),o=b.encode(3,b.writeVariableUIntLE((new Date).getTime())),a=b.encode(4,b.writeUInt32(this.activeIdentifier));this.lastButtonEvent=Buffer.concat([i,n,o,a]).toString("base64"),this.targetControlService.getCharacteristic(I.Characteristic.ButtonEvent).sendEventNotification(this.lastButtonEvent)}},t.prototype.parseTargetConfigurationTLV=function(e){var t=b.decode(e),r=b.readUInt32(t[1]),i=void 0;t[2]&&(i=t[2].toString());var n=void 0;t[3]&&(n=b.readUInt16(t[3]));var a={};t[4]&&b.decodeList(t[4],1).forEach((function(e){var t,r=e[1][0],i=b.readUInt16(e[2]);t=e[3]?e[3].toString():o[i],a[r]={buttonID:r,buttonType:i,buttonName:t}}));return{targetIdentifier:r,targetName:i,targetCategory:n,buttonConfiguration:a}},t.prototype.updatedTargetConfiguration=function(){var e,t,r,i,n,o=[];try{for(var a=E.__values(Object.values(this.targetConfigurations)),s=a.next();!s.done;s=a.next()){var c=s.value,u=b.encode(1,b.writeUInt32(c.targetIdentifier)),l=b.encode(2,c.targetName),h=b.encode(3,b.writeUInt16(c.targetCategory)),d=[];try{for(var p=(r=void 0,E.__values(c.buttonConfiguration.values())),f=p.next();!f.done;f=p.next()){var g=f.value,m=b.encode(1,g.buttonID,2,b.writeUInt16(g.buttonType));g.buttonName&&(m=Buffer.concat([m,b.encode(3,g.buttonName)])),d.push(m)}}catch(e){r={error:e}}finally{try{f&&!f.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}var v=b.encode(4,Buffer.concat(d)),y=Buffer.concat([u,l,h,v]);o.push(b.encode(2,y))}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}this.targetConfigurationsString=Buffer.concat(o).toString("base64"),null===(n=this.stateChangeDelegate)||void 0===n||n.call(this)},t.prototype.buildTargetControlSupportedConfigurationTLV=function(e){var t=b.encode(1,e.maximumTargets),r=b.encode(2,b.writeVariableUIntLE(e.ticksPerSecond)),i=[];e.supportedButtonConfiguration.forEach((function(e){var t=b.encode(1,e.buttonID,2,b.writeUInt16(e.buttonType));i.push(t)}));var n=b.encode(3,Buffer.concat(i)),o=b.encode(4,e.hardwareImplemented?1:0);return Buffer.concat([t,r,n,o]).toString("base64")},t.prototype.handleTargetControlWhoAmI=function(e,t){var r=t.identifier;this.dataStreamConnections.set(r,e),U("Discovered HDS connection for targetIdentifier %s",r),e.addProtocolHandler("dataSend",this)},t.prototype.handleSiriAudioStart=function(){if(!this.audioSupported)throw new Error("Cannot start siri stream on remote where siri is not supported");if(this.isActive())if(!this.activeAudioSession||this.activeAudioSession.isClosing()&&!this.nextAudioSession){var e=this.dataStreamConnections.get(this.activeIdentifier);if(void 0!==e){var t=new P(e,this.selectedAudioConfiguration,this.audioProducerConstructor,this.audioProducerOptions);this.activeAudioSession?this.nextAudioSession=t:this.activeAudioSession=t,t.on("close",this.handleSiriAudioSessionClosed.bind(this,t)),t.start()}else U("Tried opening Siri audio stream however target is not connected via HDS")}else U("Tried opening Siri audio stream, however there is already one in progress");else U("Tried opening Siri audio stream, however no controller is connected!")},t.prototype.handleSiriAudioStop=function(){if(this.activeAudioSession){if(!this.activeAudioSession.isClosing())return void this.activeAudioSession.stop();if(this.nextAudioSession&&!this.nextAudioSession.isClosing())return void this.nextAudioSession.stop()}U("handleSiriAudioStop called although no audio session was started")},t.prototype.handleDataSendAckEvent=function(e){var t=e.streamId,r=e.endOfStream;this.activeAudioSession&&this.activeAudioSession.streamId===t?this.activeAudioSession.handleDataSendAckEvent(r):this.nextAudioSession&&this.nextAudioSession.streamId===t?this.nextAudioSession.handleDataSendAckEvent(r):U("Received dataSend acknowledgment event for unknown streamId '%s'",t)},t.prototype.handleDataSendCloseEvent=function(e){var t=e.streamId,r=e.reason;this.activeAudioSession&&this.activeAudioSession.streamId===t?this.activeAudioSession.handleDataSendCloseEvent(r):this.nextAudioSession&&this.nextAudioSession.streamId===t?this.nextAudioSession.handleDataSendCloseEvent(r):U("Received dataSend close event for unknown streamId '%s'",t)},t.prototype.handleSiriAudioSessionClosed=function(e){e===this.activeAudioSession?(this.activeAudioSession=this.nextAudioSession,this.nextAudioSession=void 0):e===this.nextAudioSession&&(this.nextAudioSession=void 0)},t.prototype.handleDataStreamConnectionClosed=function(e){var t,r;try{for(var i=E.__values(this.dataStreamConnections),n=i.next();!n.done;n=i.next()){var o=E.__read(n.value,2),a=o[0];if(e===o[1]){U("HDS connection disconnected for targetIdentifier %s",a),this.dataStreamConnections.delete(a);break}}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}},t.prototype.handleSelectedAudioConfigurationWrite=function(e,r){var i=Buffer.from(e,"base64"),n=b.decode(i),o=b.decode(n[1]),a=o[1][0],s=b.decode(o[2]),c=s[1][0],u=s[2][0],l=s[3][0];this.selectedAudioConfiguration={codecType:a,parameters:{channels:c,bitrate:u,samplerate:l,rtpTime:20}},this.selectedAudioConfigurationString=t.buildSelectedAudioConfigurationTLV({audioCodecConfiguration:this.selectedAudioConfiguration}),r()},t.buildSupportedAudioConfigurationTLV=function(e){var r=t.buildCodecConfigurationTLV(e.audioCodecConfiguration);return b.encode(1,r).toString("base64")},t.buildSelectedAudioConfigurationTLV=function(e){var r=t.buildCodecConfigurationTLV(e.audioCodecConfiguration);return b.encode(1,r).toString("base64")},t.buildCodecConfigurationTLV=function(e){var t=e.parameters,r=b.encode(1,t.channels,2,t.bitrate,3,t.samplerate);return t.rtpTime&&(r=Buffer.concat([r,b.encode(4,t.rtpTime)])),b.encode(1,e.codecType,2,r)},t.prototype.constructServices=function(){var e;return this.targetControlManagementService=new w.Service.TargetControlManagement("",""),this.targetControlManagementService.setCharacteristic(I.Characteristic.TargetControlSupportedConfiguration,this.supportedConfiguration),this.targetControlManagementService.setCharacteristic(I.Characteristic.TargetControlList,this.targetConfigurationsString),this.targetControlManagementService.setPrimaryService(),this.targetControlService=new w.Service.TargetControl("",""),this.targetControlService.setCharacteristic(I.Characteristic.ActiveIdentifier,0),this.targetControlService.setCharacteristic(I.Characteristic.Active,!1),this.targetControlService.setCharacteristic(I.Characteristic.ButtonEvent,this.lastButtonEvent),this.audioSupported&&(this.siriService=new w.Service.Siri("",""),this.siriService.setCharacteristic(I.Characteristic.SiriInputType,I.Characteristic.SiriInputType.PUSH_BUTTON_TRIGGERED_APPLE_TV),this.audioStreamManagementService=new w.Service.AudioStreamManagement("",""),this.audioStreamManagementService.setCharacteristic(I.Characteristic.SupportedAudioStreamConfiguration,this.supportedAudioConfiguration),this.audioStreamManagementService.setCharacteristic(I.Characteristic.SelectedAudioStreamConfiguration,this.selectedAudioConfigurationString),this.dataStreamManagement=new D.DataStreamManagement,this.siriService.addLinkedService(this.dataStreamManagement.getService()),this.siriService.addLinkedService(this.audioStreamManagementService)),{targetControlManagement:this.targetControlManagementService,targetControl:this.targetControlService,siri:this.siriService,audioStreamManagement:this.audioStreamManagementService,dataStreamTransportManagement:null===(e=this.dataStreamManagement)||void 0===e?void 0:e.getService()}},t.prototype.initWithServices=function(e){this.targetControlManagementService=e.targetControlManagement,this.targetControlService=e.targetControl,this.siriService=e.siri,this.audioStreamManagementService=e.audioStreamManagement,this.dataStreamManagement=new D.DataStreamManagement(e.dataStreamTransportManagement)},t.prototype.configureServices=function(){var e,t=this;if(!this.targetControlManagementService||!this.targetControlService)throw new Error("Unexpected state: Services not configured!");this.targetControlManagementService.getCharacteristic(I.Characteristic.TargetControlList).on("get",(function(e){e(null,t.targetConfigurationsString)})).on("set",this.handleTargetControlWrite.bind(this)),this.targetControlService.getCharacteristic(I.Characteristic.ActiveIdentifier).on("get",(function(e){e(void 0,t.activeIdentifier)})),this.targetControlService.getCharacteristic(I.Characteristic.Active).on("get",(function(e){e(void 0,t.isActive())})).on("set",(function(e,r,i,n){if(!n)return U("Set event handler for Remote.Active cannot be called from plugin. Connection undefined!"),void r(-70410);t.handleActiveWrite(e,r,n)})),this.targetControlService.getCharacteristic(I.Characteristic.ButtonEvent).on("get",(function(e){e(void 0,t.lastButtonEvent)})),this.audioSupported&&(this.audioStreamManagementService.getCharacteristic(I.Characteristic.SelectedAudioStreamConfiguration).on("get",(function(e){e(null,t.selectedAudioConfigurationString)})).on("set",this.handleSelectedAudioConfigurationWrite.bind(this)).updateValue(this.selectedAudioConfigurationString),this.dataStreamManagement.onEventMessage("targetControl","whoami",this.handleTargetControlWhoAmI.bind(this)).onServerEvent("connection-closed",this.handleDataStreamConnectionClosed.bind(this)),this.eventHandler=((e={}).ack=this.handleDataSendAckEvent.bind(this),e.close=this.handleDataSendCloseEvent.bind(this),e))},t.prototype.handleControllerRemoved=function(){var e;this.targetControlManagementService=void 0,this.targetControlService=void 0,this.siriService=void 0,this.audioStreamManagementService=void 0,this.eventHandler=void 0,this.requestHandler=void 0,null===(e=this.dataStreamManagement)||void 0===e||e.destroy(),this.dataStreamManagement=void 0},t.prototype.handleFactoryReset=function(){U("Running factory reset. Resetting targets..."),this.handleResetTargets(void 0),this.lastButtonEvent=""},t.prototype.serialize=function(){if(this.activeIdentifier||0!==Object.keys(this.targetConfigurations).length)return{activeIdentifier:this.activeIdentifier,targetConfigurations:E.__spreadArray([],E.__read(this.targetConfigurations),!1).reduce((function(e,t){var r=E.__read(t,2),i=r[0],n=r[1];return e[i]=n,e}),{})}},t.prototype.deserialize=function(e){this.activeIdentifier=e.activeIdentifier,this.targetConfigurations=Object.entries(e.targetConfigurations).reduce((function(e,t){var r=E.__read(t,2),i=r[0],n=r[1],o=parseInt(i,10);return e.set(o,n),e}),new Map),this.updatedTargetConfiguration()},t.prototype.setupStateChangeDelegate=function(e){this.stateChangeDelegate=e},t}(A.EventEmitter);t.RemoteController=R;var O,N=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return E.__extends(t,e),t}(R);t.HomeKitRemoteController=N,function(e){e.CLOSE="close"}(O||(t.SiriAudioSessionEvents=O={}));var P=function(e){function t(t,r,i,n){var o=e.call(this)||this;return o.producerRunning=!1,o.state=0,o.endOfStream=!1,o.audioFrameQueue=[],o.maxQueueSize=1024,o.sequenceNumber=0,o.connection=t,o.selectedAudioConfiguration=r,o.producer=new i(o.handleSiriAudioFrame.bind(o),o.handleProducerError.bind(o),n),o.connection.on("closed",o.closeListener=o.handleDataStreamConnectionClosed.bind(o)),o}return E.__extends(t,e),t.prototype.start=function(){var e=this;U("Sending request to start siri audio stream"),this.connection.sendRequest("dataSend","open",{target:"controller",type:"audio.siri"},(function(t,r,i){3!==e.state?(_.default.strictEqual(e.state,0),e.state=1,t||r?(t?U("Error occurred trying to start siri audio stream: %s",t.message):r&&U("Controller responded with non-zero status code: %s",D.HDSStatus[r]),e.closed()):(e.streamId=i.streamId,e.producerRunning?U("Successfully setup siri audio stream with streamId %d",e.streamId):e.sendDataSendCloseEvent(3))):U("Ignoring dataSend open response as the session is already closed")})),this.startAudioProducer()},t.prototype.isClosing=function(){return this.state>=2},t.prototype.stop=function(){(0,_.default)(this.state<=1,"state was higher than SENDING"),U("Stopping siri audio stream with streamId %d",this.streamId),this.endOfStream=!0,this.stopAudioProducer(),1===this.state?(this.handleSiriAudioFrame(void 0),this.state=2):this.closed()},t.prototype.startAudioProducer=function(){var e=this;this.producer.startAudioProduction(this.selectedAudioConfiguration),this.producerRunning=!0,this.producerTimer=setTimeout((function(){U("Didn't receive any frames from audio producer for stream with streamId %s. Canceling the stream now.",e.streamId),e.producerTimer=void 0,e.handleProducerError(3)}),3e3),this.producerTimer.unref()},t.prototype.stopAudioProducer=function(){this.producer.stopAudioProduction(),this.producerRunning=!1,this.producerTimer&&(clearTimeout(this.producerTimer),this.producerTimer=void 0)},t.prototype.handleSiriAudioFrame=function(e){var t=this;if(!(this.state>=2)&&(this.producerTimer&&(clearTimeout(this.producerTimer),this.producerTimer=void 0),e&&this.audioFrameQueue.length<this.maxQueueSize&&this.audioFrameQueue.push(e),1===this.state))for(var r,i=function(){var e=[];r.forEach((function(r){var i={data:r.data,metadata:{rms:new D.Float32(r.rms),sequenceNumber:new D.Int64(t.sequenceNumber++)}};e.push(i)}));var i={packets:e,streamId:new D.Int64(n.streamId),endOfStream:n.endOfStream};try{n.connection.sendEvent("dataSend","data",i)}catch(e){U("Error occurred when trying to send audio frame of hds connection: %s",e.message),n.stopAudioProducer(),n.closed()}if(n.endOfStream)return"break"},n=this;null!==(r=this.popSome());){if("break"===i())break}},t.prototype.handleProducerError=function(e){this.state>=2||(this.stopAudioProducer(),1===this.state&&this.sendDataSendCloseEvent(e))},t.prototype.handleDataSendAckEvent=function(e){_.default.strictEqual(e,!0),U("Received acknowledgment for siri audio stream with streamId %s, closing it now",this.streamId),this.sendDataSendCloseEvent(0)},t.prototype.handleDataSendCloseEvent=function(e){U("Received close event from controller with reason %s for stream with streamId %s",D.HDSProtocolSpecificErrorReason[e],this.streamId),this.state<=1&&this.stopAudioProducer(),this.closed()},t.prototype.sendDataSendCloseEvent=function(e){(0,_.default)(this.state>=1,"state was less than SENDING"),(0,_.default)(this.state<=2,"state was higher than CLOSING"),this.connection.sendEvent("dataSend","close",{streamId:new D.Int64(this.streamId),reason:new D.Int64(e)}),this.closed()},t.prototype.handleDataStreamConnectionClosed=function(){U("Closing audio session with streamId %d",this.streamId),this.state<=1&&this.stopAudioProducer(),this.closed()},t.prototype.closed=function(){var e=this.state;this.state=3,3!==e&&(this.emit("close"),this.connection.removeListener("closed",this.closeListener)),this.removeAllListeners()},t.prototype.popSome=function(){if(this.audioFrameQueue.length<5&&!this.endOfStream)return null;for(var e=Math.min(this.audioFrameQueue.length,5),t=[],r=0;r<e;r++){var i=this.audioFrameQueue.shift();t.push(i)}return t},t}(A.EventEmitter);t.SiriAudioSession=P},1068:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(1635);i.__exportStar(r(9414),t),i.__exportStar(r(6864),t),i.__exportStar(r(9352),t),i.__exportStar(r(2405),t),i.__exportStar(r(7959),t)},733:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataStreamManagement=t.DataStreamStatus=void 0;var i,n,o,a,s,c,u,l,h=r(1635),d=h.__importDefault(r(5753)),p=r(9826),f=r(5876),g=h.__importStar(r(3314)),m=r(4097),v=(0,d.default)("HAP-NodeJS:DataStream:Management");!function(e){e[e.TRANSFER_TRANSPORT_CONFIGURATION=1]="TRANSFER_TRANSPORT_CONFIGURATION"}(i||(i={})),function(e){e[e.TRANSPORT_TYPE=1]="TRANSPORT_TYPE"}(n||(n={})),function(e){e[e.SESSION_COMMAND_TYPE=1]="SESSION_COMMAND_TYPE",e[e.TRANSPORT_TYPE=2]="TRANSPORT_TYPE",e[e.CONTROLLER_KEY_SALT=3]="CONTROLLER_KEY_SALT"}(o||(o={})),function(e){e[e.STATUS=1]="STATUS",e[e.TRANSPORT_TYPE_SESSION_PARAMETERS=2]="TRANSPORT_TYPE_SESSION_PARAMETERS",e[e.ACCESSORY_KEY_SALT=3]="ACCESSORY_KEY_SALT"}(a||(a={})),function(e){e[e.TCP_LISTENING_PORT=1]="TCP_LISTENING_PORT"}(s||(s={})),function(e){e[e.HOMEKIT_DATA_STREAM=0]="HOMEKIT_DATA_STREAM"}(c||(c={})),function(e){e[e.START_SESSION=0]="START_SESSION"}(u||(u={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.GENERIC_ERROR=1]="GENERIC_ERROR",e[e.BUSY=2]="BUSY"}(l||(t.DataStreamStatus=l={}));var y=function(){function e(e){this.dataStreamServer=new m.DataStreamServer,this.lastSetupDataStreamTransportResponse="";var t=[c.HOMEKIT_DATA_STREAM];this.supportedDataStreamTransportConfiguration=this.buildSupportedDataStreamTransportConfigurationTLV(t),this.dataStreamTransportManagementService=e||this.constructService(),this.setupServiceHandlers()}return e.prototype.destroy=function(){this.dataStreamServer.destroy(),this.dataStreamTransportManagementService.getCharacteristic(p.Characteristic.SetupDataStreamTransport).removeOnGet().removeAllListeners("set"),this.lastSetupDataStreamTransportResponse=""},e.prototype.getService=function(){return this.dataStreamTransportManagementService},e.prototype.onEventMessage=function(e,t,r){return this.dataStreamServer.onEventMessage(e,t,r),this},e.prototype.removeEventHandler=function(e,t,r){return this.dataStreamServer.removeEventHandler(e,t,r),this},e.prototype.onRequestMessage=function(e,t,r){return this.dataStreamServer.onRequestMessage(e,t,r),this},e.prototype.removeRequestHandler=function(e,t,r){return this.dataStreamServer.removeRequestHandler(e,t,r),this},e.prototype.onServerEvent=function(e,t){return this.dataStreamServer.on(e,t),this},e.prototype.handleSetupDataStreamTransportWrite=function(e,t,r){var i=this,n=Buffer.from(e,"base64"),o=g.decode(n),a=o[1][0],s=o[2][0],l=o[3];v("Received setup write with command %s and transport type %s",u[a],c[s]),a===u.START_SESSION&&s===c.HOMEKIT_DATA_STREAM&&32===l.length?this.dataStreamServer.prepareSession(r,l,(function(e,r){if(!e&&r){var n=g.encode(1,g.writeUInt16(r.port)),o=Buffer.concat([g.encode(1,0),g.encode(2,n)]);i.lastSetupDataStreamTransportResponse=o.toString("base64"),o=Buffer.concat([o,g.encode(3,r.accessoryKeySalt)]),t(null,o.toString("base64"))}else t(null!=e?e:new Error("PreparedSession was undefined!"))})):t(-70410)},e.prototype.buildSupportedDataStreamTransportConfigurationTLV=function(e){var t=[];return e.forEach((function(e){var r=g.encode(1,e),i=g.encode(1,r);t.push(i)})),Buffer.concat(t).toString("base64")},e.prototype.constructService=function(){var e=new f.Service.DataStreamTransportManagement("","");return e.setCharacteristic(p.Characteristic.SupportedDataStreamTransportConfiguration,this.supportedDataStreamTransportConfiguration),e.setCharacteristic(p.Characteristic.Version,m.DataStreamServer.version),e},e.prototype.setupServiceHandlers=function(){var e=this;this.dataStreamTransportManagementService.getCharacteristic(p.Characteristic.SetupDataStreamTransport).onGet((function(){return e.lastSetupDataStreamTransportResponse})).on("set",(function(t,r,i,n){if(!n)return v("Set event handler for SetupDataStreamTransport cannot be called from plugin! Connection undefined!"),void r(-70410);e.handleSetupDataStreamTransportWrite(t,r,n)})).updateValue(this.lastSetupDataStreamTransportResponse)},e}();t.DataStreamManagement=y},7881:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataStreamWriter=t.DataStreamReader=t.DataStreamParser=t.DataFormatTags=t.UUID=t.SecondsSince2001=t.Float64=t.Float32=t.Int64=t.Int32=t.Int16=t.Int8=t.ValueWrapper=void 0;var i=r(1635),n=i.__importStar(r(2997)),o=i.__importStar(r(8)),a=i.__importDefault(r(2613)),s=(0,i.__importDefault(r(5753)).default)("HAP-NodeJS:DataStream:Parser"),c=function(){function e(){}return e.TERMINATOR={type:"terminator"},e}(),u=function(){function e(e){this.value=e}return e.prototype.equals=function(e){return this.constructor.name===e.constructor.name&&e.value===this.value},e}();t.ValueWrapper=u;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t}(u);t.Int8=l;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t}(u);t.Int16=h;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t}(u);t.Int32=d;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t}(u);t.Int64=p;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t}(u);t.Float32=f;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t}(u);t.Float64=g;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t}(u);t.SecondsSince2001=m;var v,y=function(e){function t(t){return(0,a.default)(n.isValid(t),"invalid uuid format"),e.call(this,t)||this}return i.__extends(t,e),t}(u);t.UUID=y,function(e){e[e.INVALID=0]="INVALID",e[e.TRUE=1]="TRUE",e[e.FALSE=2]="FALSE",e[e.TERMINATOR=3]="TERMINATOR",e[e.NULL=4]="NULL",e[e.UUID=5]="UUID",e[e.DATE=6]="DATE",e[e.INTEGER_MINUS_ONE=7]="INTEGER_MINUS_ONE",e[e.INTEGER_RANGE_START_0=8]="INTEGER_RANGE_START_0",e[e.INTEGER_RANGE_STOP_39=46]="INTEGER_RANGE_STOP_39",e[e.INT8=48]="INT8",e[e.INT16LE=49]="INT16LE",e[e.INT32LE=50]="INT32LE",e[e.INT64LE=51]="INT64LE",e[e.FLOAT32LE=53]="FLOAT32LE",e[e.FLOAT64LE=54]="FLOAT64LE",e[e.UTF8_LENGTH_START=64]="UTF8_LENGTH_START",e[e.UTF8_LENGTH_STOP=96]="UTF8_LENGTH_STOP",e[e.UTF8_LENGTH8=97]="UTF8_LENGTH8",e[e.UTF8_LENGTH16LE=98]="UTF8_LENGTH16LE",e[e.UTF8_LENGTH32LE=99]="UTF8_LENGTH32LE",e[e.UTF8_LENGTH64LE=100]="UTF8_LENGTH64LE",e[e.UTF8_NULL_TERMINATED=111]="UTF8_NULL_TERMINATED",e[e.DATA_LENGTH_START=112]="DATA_LENGTH_START",e[e.DATA_LENGTH_STOP=144]="DATA_LENGTH_STOP",e[e.DATA_LENGTH8=145]="DATA_LENGTH8",e[e.DATA_LENGTH16LE=146]="DATA_LENGTH16LE",e[e.DATA_LENGTH32LE=147]="DATA_LENGTH32LE",e[e.DATA_LENGTH64LE=148]="DATA_LENGTH64LE",e[e.DATA_TERMINATED=159]="DATA_TERMINATED",e[e.COMPRESSION_START=160]="COMPRESSION_START",e[e.COMPRESSION_STOP=207]="COMPRESSION_STOP",e[e.ARRAY_LENGTH_START=208]="ARRAY_LENGTH_START",e[e.ARRAY_LENGTH_STOP=222]="ARRAY_LENGTH_STOP",e[e.ARRAY_TERMINATED=223]="ARRAY_TERMINATED",e[e.DICTIONARY_LENGTH_START=224]="DICTIONARY_LENGTH_START",e[e.DICTIONARY_LENGTH_STOP=238]="DICTIONARY_LENGTH_STOP",e[e.DICTIONARY_TERMINATED=239]="DICTIONARY_TERMINATED"}(v||(t.DataFormatTags=v={}));var C=function(){function e(){}return e.decode=function(e){var t=e.readTag();if(0===t)throw new Error("HDSDecoder: zero tag detected on index "+e.readerIndex);if(1===t)return e.readTrue();if(2===t)return e.readFalse();if(3===t)return c.TERMINATOR;if(4===t)return null;if(5===t)return e.readUUID();if(6===t)return e.readSecondsSince2001_01_01();if(7===t)return e.readNegOne();if(t>=8&&t<=46)return e.readIntRange(t);if(48===t)return e.readInt8();if(49===t)return e.readInt16LE();if(50===t)return e.readInt32LE();if(51===t)return e.readInt64LE();if(53===t)return e.readFloat32LE();if(54===t)return e.readFloat64LE();if(t>=64&&t<=96){var r=t-64;return e.readUTF8(r)}if(97===t)return e.readUTF8_Length8();if(98===t)return e.readUTF8_Length16LE();if(99===t)return e.readUTF8_Length32LE();if(100===t)return e.readUTF8_Length64LE();if(111===t)return e.readUTF8_NULL_terminated();if(!(t>=112&&t<=144)){if(145===t)return e.readData_Length8();if(146===t)return e.readData_Length16LE();if(147===t)return e.readData_Length32LE();if(148===t)return e.readData_Length64LE();if(159===t)return e.readData_terminated();if(t>=160&&t<=207){var i=t-160;return e.decompressData(i)}if(t>=208&&t<=222){r=t-208;for(var n=[],o=0;o<r;o++)n.push(this.decode(e));return n}if(223===t){n=[];for(var a=void 0;(a=this.decode(e))!==c.TERMINATOR;)n.push(a);return n}if(t>=224&&t<=238){r=t-224;var s={};for(o=0;o<r;o++){s[u=this.decode(e)]=this.decode(e)}return s}if(239===t){s={};for(var u=void 0;(u=this.decode(e))!==c.TERMINATOR;)s[u]=this.decode(e);return s}throw new Error("HDSDecoder: encountered unknown tag on index "+e.readerIndex+": "+t.toString(16))}var r=t-112;e.readData(r)},e.encode=function(e,t){var r=this;if(void 0===e)throw new Error("HDSEncoder: cannot encode undefined");if(null!==e)switch(typeof e){case"boolean":e?t.writeTrue():t.writeFalse();break;case"number":Number.isInteger(e)?t.writeNumber(e):t.writeFloat64LE(new g(e));break;case"string":t.writeUTF8(e);break;case"object":if(Array.isArray(e)){var i=e.length;i<=12?t.writeTag(208+i):t.writeTag(223),e.forEach((function(e){r.encode(e,t)})),i>12&&t.writeTag(3)}else if(e instanceof u)if(e instanceof l)t.writeInt8(e);else if(e instanceof h)t.writeInt16LE(e);else if(e instanceof d)t.writeInt32LE(e);else if(e instanceof p)t.writeInt64LE(e);else if(e instanceof f)t.writeFloat32LE(e);else if(e instanceof g)t.writeFloat64LE(e);else if(e instanceof m)t.writeSecondsSince2001_01_01(e);else{if(!(e instanceof y))throw new Error("Unknown wrapped object 'ValueWrapper' of class "+e.constructor.name);t.writeUUID(e.value)}else if(e instanceof Buffer)t.writeData(e);else{var n=Object.entries(e).filter((function(e){return void 0!==e[1]}));n.length<=14?t.writeTag(224+n.length):t.writeTag(239),n.forEach((function(e){r.encode(e[0],t),r.encode(e[1],t)})),n.length>14&&t.writeTag(3)}break;default:throw new Error("HDSEncoder: no idea how to encode value of type '"+typeof e+"': "+e)}else t.writeTag(4)},e}();t.DataStreamParser=C;var S=function(){function e(e){this.trackedCompressedData=[],this.data=e,this.readerIndex=0}return e.prototype.finished=function(){if(this.readerIndex<this.data.length){var e=this.data.slice(this.readerIndex,this.data.length).toString("hex");s("WARNING Finished reading HDS stream, but there are still %d bytes remaining () %s",this.data.length-this.readerIndex,e)}},e.prototype.decompressData=function(e){if(e>=this.trackedCompressedData.length)throw new Error("HDSDecoder: Tried decompression of data for an index out of range (index "+e+" and got "+this.trackedCompressedData.length+" elements)");return this.trackedCompressedData[e]},e.prototype.trackData=function(e){return this.trackedCompressedData.push(e),e},e.prototype.ensureLength=function(e){if(this.readerIndex+e>this.data.length){var t=this.data.length-this.readerIndex;throw new Error("HDSDecoder: End of data stream. Tried reading "+e+" bytes however got only "+t+" remaining!")}},e.prototype.readTag=function(){return this.ensureLength(1),this.data.readUInt8(this.readerIndex++)},e.prototype.readTrue=function(){return this.trackData(!0)},e.prototype.readFalse=function(){return this.trackData(!1)},e.prototype.readNegOne=function(){return this.trackData(-1)},e.prototype.readIntRange=function(e){return this.trackData(e-8)},e.prototype.readInt8=function(){return this.ensureLength(1),this.trackData(this.data.readInt8(this.readerIndex++))},e.prototype.readInt16LE=function(){this.ensureLength(2);var e=this.data.readInt16LE(this.readerIndex);return this.readerIndex+=2,this.trackData(e)},e.prototype.readInt32LE=function(){this.ensureLength(4);var e=this.data.readInt32LE(this.readerIndex);return this.readerIndex+=4,this.trackData(e)},e.prototype.readInt64LE=function(){this.ensureLength(8);var e=this.data.readInt32LE(this.readerIndex),t=4294967296*this.data.readInt32LE(this.readerIndex+4)+e;return e<0&&(t+=4294967296),this.readerIndex+=8,this.trackData(t)},e.prototype.readFloat32LE=function(){this.ensureLength(4);var e=this.data.readFloatLE(this.readerIndex);return this.readerIndex+=4,this.trackData(e)},e.prototype.readFloat64LE=function(){this.ensureLength(8);var e=this.data.readDoubleLE(this.readerIndex);return this.trackData(e)},e.prototype.readLength8=function(){return this.ensureLength(1),this.data.readUInt8(this.readerIndex++)},e.prototype.readLength16LE=function(){this.ensureLength(2);var e=this.data.readUInt16LE(this.readerIndex);return this.readerIndex+=2,e},e.prototype.readLength32LE=function(){this.ensureLength(4);var e=this.data.readUInt32LE(this.readerIndex);return this.readerIndex+=4,e},e.prototype.readLength64LE=function(){this.ensureLength(8);var e=this.data.readUInt32LE(this.readerIndex),t=4294967296*this.data.readUInt32LE(this.readerIndex+4)+e;return this.readerIndex+=8,t},e.prototype.readUTF8=function(e){this.ensureLength(e);var t=this.data.toString("utf8",this.readerIndex,this.readerIndex+e);return this.readerIndex+=e,this.trackData(t)},e.prototype.readUTF8_Length8=function(){var e=this.readLength8();return this.readUTF8(e)},e.prototype.readUTF8_Length16LE=function(){var e=this.readLength16LE();return this.readUTF8(e)},e.prototype.readUTF8_Length32LE=function(){var e=this.readLength32LE();return this.readUTF8(e)},e.prototype.readUTF8_Length64LE=function(){var e=this.readLength64LE();return this.readUTF8(e)},e.prototype.readUTF8_NULL_terminated=function(){for(var e,t=this.readerIndex;;){if(void 0===(e=this.data[t]))throw new Error("HDSDecoder: Reached end of data stream while reading NUL terminated string!");if(0===e)break;t++}var r=this.data.toString("utf8",this.readerIndex,t);return this.readerIndex=t+1,this.trackData(r)},e.prototype.readData=function(e){this.ensureLength(e);var t=this.data.slice(this.readerIndex,this.readerIndex+e);return this.readerIndex+=e,this.trackData(t)},e.prototype.readData_Length8=function(){var e=this.readLength8();return this.readData(e)},e.prototype.readData_Length16LE=function(){var e=this.readLength16LE();return this.readData(e)},e.prototype.readData_Length32LE=function(){var e=this.readLength32LE();return this.readData(e)},e.prototype.readData_Length64LE=function(){var e=this.readLength64LE();return this.readData(e)},e.prototype.readData_terminated=function(){for(var e,t=this.readerIndex;;){if(void 0===(e=this.data[t]))throw new Error("HDSDecoder: Reached end of data stream while reading terminated data!");if(3===e)break;t++}var r=this.data.slice(this.readerIndex,t);return this.readerIndex=t+1,this.trackData(r)},e.prototype.readSecondsSince2001_01_01=function(){return this.readFloat64LE()},e.prototype.readUUID=function(){this.ensureLength(16);var e=n.unparse(this.data,this.readerIndex);return this.readerIndex+=16,this.trackData(e)},e}();t.DataStreamReader=S;var E=function(){function e(){this.writtenData=[]}return e.prototype.push=function(e){this.writtenData.push(e)},e.prototype.indexOf=function(e){for(var t=0;t<this.writtenData.length;t++){var r=this.writtenData[t];if(e===r)return t;if(e instanceof u&&r instanceof u&&e.equals(r))return t}return-1},e}(),_=function(){function e(){this.writtenData=new E,this.data=Buffer.alloc(e.chunkSize),this.writerIndex=0}return e.prototype.length=function(){return this.writerIndex},e.prototype.getData=function(){return this.data.slice(0,this.writerIndex)},e.prototype.ensureLength=function(t){var r=this.writerIndex+t-this.data.length;if(r>0){var i=Math.ceil(r/e.chunkSize);this.data=Buffer.concat([this.data,Buffer.alloc(i*e.chunkSize)])}},e.prototype.compressDataIfPossible=function(e){var t=this.writtenData.indexOf(e);return t<0?(this.writtenData.push(e),!1):t<=47&&(this.writeTag(160+t),!0)},e.prototype.writeTag=function(e){this.ensureLength(1),this.data.writeUInt8(e,this.writerIndex++)},e.prototype.writeTrue=function(){this.writeTag(1)},e.prototype.writeFalse=function(){this.writeTag(2)},e.prototype.writeNumber=function(e){if(-1===e)this.writeTag(7);else if(e>=0&&e<=39)this.writeTag(8+e);else if(e>=-128&&e<=127)this.writeInt8(new l(e));else if(e>=-32768&&e<=32767)this.writeInt16LE(new h(e));else if(e>=-2147483648&&e<=-2147483648)this.writeInt32LE(new d(e));else{if(!(e>=Number.MIN_SAFE_INTEGER&&e<=Number.MAX_SAFE_INTEGER))throw new Error("Tried writing unrepresentable number ("+e+")");this.writeInt64LE(new p(e))}},e.prototype.writeInt8=function(e){this.compressDataIfPossible(e)||(this.ensureLength(2),this.writeTag(48),this.data.writeInt8(e.value,this.writerIndex++))},e.prototype.writeInt16LE=function(e){this.compressDataIfPossible(e)||(this.ensureLength(3),this.writeTag(49),this.data.writeInt16LE(e.value,this.writerIndex),this.writerIndex+=2)},e.prototype.writeInt32LE=function(e){this.compressDataIfPossible(e)||(this.ensureLength(5),this.writeTag(50),this.data.writeInt32LE(e.value,this.writerIndex),this.writerIndex+=4)},e.prototype.writeInt64LE=function(e){this.compressDataIfPossible(e)||(this.ensureLength(9),this.writeTag(51),this.data.writeUInt32LE(e.value,this.writerIndex),this.data.writeUInt32LE(0,this.writerIndex+4),this.writerIndex+=8)},e.prototype.writeFloat32LE=function(e){this.compressDataIfPossible(e)||(this.ensureLength(5),this.writeTag(53),this.data.writeFloatLE(e.value,this.writerIndex),this.writerIndex+=4)},e.prototype.writeFloat64LE=function(e){this.compressDataIfPossible(e)||(this.ensureLength(9),this.writeTag(54),this.data.writeDoubleLE(e.value,this.writerIndex),this.writerIndex+=8)},e.prototype.writeLength8=function(e){this.ensureLength(1),this.data.writeUInt8(e,this.writerIndex++)},e.prototype.writeLength16LE=function(e){this.ensureLength(2),this.data.writeUInt16LE(e,this.writerIndex),this.writerIndex+=2},e.prototype.writeLength32LE=function(e){this.ensureLength(4),this.data.writeUInt32LE(e,this.writerIndex),this.writerIndex+=4},e.prototype.writeLength64LE=function(e){this.ensureLength(8),o.writeUInt64LE(e,this.data,this.writerIndex),this.writerIndex+=8},e.prototype.writeUTF8=function(e){if(!this.compressDataIfPossible(e)){var t=Buffer.byteLength(e);t<=32?(this.ensureLength(1+t),this.writeTag(64+e.length),this._writeUTF8(e)):t<=255?this.writeUTF8_Length8(e):t<=65535?this.writeUTF8_Length16LE(e):t<=4294967295?this.writeUTF8_Length32LE(e):t<=Number.MAX_SAFE_INTEGER?this.writeUTF8_Length64LE(e):this.writeUTF8_NULL_terminated(e)}},e.prototype._writeUTF8=function(e){var t=Buffer.byteLength(e);this.ensureLength(t),this.data.write(e,this.writerIndex,t,"utf8"),this.writerIndex+=t},e.prototype.writeUTF8_Length8=function(e){var t=Buffer.byteLength(e);this.ensureLength(2+t),this.writeTag(97),this.writeLength8(t),this._writeUTF8(e)},e.prototype.writeUTF8_Length16LE=function(e){var t=Buffer.byteLength(e);this.ensureLength(3+t),this.writeTag(98),this.writeLength16LE(t),this._writeUTF8(e)},e.prototype.writeUTF8_Length32LE=function(e){var t=Buffer.byteLength(e);this.ensureLength(5+t),this.writeTag(99),this.writeLength32LE(t),this._writeUTF8(e)},e.prototype.writeUTF8_Length64LE=function(e){var t=Buffer.byteLength(e);this.ensureLength(9+t),this.writeTag(100),this.writeLength64LE(t),this._writeUTF8(e)},e.prototype.writeUTF8_NULL_terminated=function(e){this.ensureLength(1+Buffer.byteLength(e)+1),this.writeTag(111),this._writeUTF8(e),this.data.writeUInt8(0,this.writerIndex++)},e.prototype.writeData=function(e){this.compressDataIfPossible(e)||(e.length<=32?(this.writeTag(112+e.length),this._writeData(e)):e.length<=255?this.writeData_Length8(e):e.length<=65535?this.writeData_Length16LE(e):e.length<=4294967295?this.writeData_Length32LE(e):e.length<=Number.MAX_SAFE_INTEGER?this.writeData_Length64LE(e):this.writeData_terminated(e))},e.prototype._writeData=function(e){this.ensureLength(e.length);for(var t=0;t<e.length;t++)this.data[this.writerIndex++]=e[t]},e.prototype.writeData_Length8=function(e){this.ensureLength(2+e.length),this.writeTag(145),this.writeLength8(e.length),this._writeData(e)},e.prototype.writeData_Length16LE=function(e){this.ensureLength(3+e.length),this.writeTag(146),this.writeLength16LE(e.length),this._writeData(e)},e.prototype.writeData_Length32LE=function(e){this.ensureLength(5+e.length),this.writeTag(147),this.writeLength32LE(e.length),this._writeData(e)},e.prototype.writeData_Length64LE=function(e){this.ensureLength(9+e.length),this.writeTag(148),this.writeLength64LE(e.length),this._writeData(e)},e.prototype.writeData_terminated=function(e){this.ensureLength(1+e.length+1),this.writeTag(159),this._writeData(e),this.writeTag(3)},e.prototype.writeSecondsSince2001_01_01=function(e){this.compressDataIfPossible(e)||(this.ensureLength(9),this.writeTag(6),this.data.writeDoubleLE(e.value,this.writerIndex),this.writerIndex+=8)},e.prototype.writeUUID=function(e){(0,a.default)(n.isValid(e),"supplied uuid is invalid"),this.compressDataIfPossible(new y(e))||(this.ensureLength(17),this.writeTag(5),n.write(e,this.data,this.writerIndex),this.writerIndex+=16)},e.chunkSize=128,e}();t.DataStreamWriter=_},4097:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataStreamConnection=t.HDSConnectionError=t.HDSConnectionErrorType=t.DataStreamConnectionEvent=t.DataStreamServer=t.DataStreamServerEvent=t.MessageType=t.HDSProtocolError=t.HDSProtocolSpecificErrorReason=t.HDSStatus=t.Topics=t.Protocols=void 0;var i,n,o,a,s=r(1635),c=s.__importDefault(r(2613)),u=s.__importDefault(r(6982)),l=s.__importDefault(r(5753)),h=r(4434),d=s.__importDefault(r(9278)),p=s.__importStar(r(8)),f=r(7881),g=(0,l.default)("HAP-NodeJS:DataStream:Server");!function(e){e.CONTROL="control",e.TARGET_CONTROL="targetControl",e.DATA_SEND="dataSend"}(i||(t.Protocols=i={})),function(e){e.HELLO="hello",e.WHOAMI="whoami",e.OPEN="open",e.DATA="data",e.ACK="ack",e.CLOSE="close"}(n||(t.Topics=n={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.OUT_OF_MEMORY=1]="OUT_OF_MEMORY",e[e.TIMEOUT=2]="TIMEOUT",e[e.HEADER_ERROR=3]="HEADER_ERROR",e[e.PAYLOAD_ERROR=4]="PAYLOAD_ERROR",e[e.MISSING_PROTOCOL=5]="MISSING_PROTOCOL",e[e.PROTOCOL_SPECIFIC_ERROR=6]="PROTOCOL_SPECIFIC_ERROR"}(o||(t.HDSStatus=o={})),function(e){e[e.NORMAL=0]="NORMAL",e[e.NOT_ALLOWED=1]="NOT_ALLOWED",e[e.BUSY=2]="BUSY",e[e.CANCELLED=3]="CANCELLED",e[e.UNSUPPORTED=4]="UNSUPPORTED",e[e.UNEXPECTED_FAILURE=5]="UNEXPECTED_FAILURE",e[e.TIMEOUT=6]="TIMEOUT",e[e.BAD_DATA=7]="BAD_DATA",e[e.PROTOCOL_ERROR=8]="PROTOCOL_ERROR",e[e.INVALID_CONFIGURATION=9]="INVALID_CONFIGURATION"}(a||(t.HDSProtocolSpecificErrorReason=a={}));var m,v,y,C,S=function(e){function t(t){var r=e.call(this,"HDSProtocolError: "+t)||this;return(0,c.default)(0!==t,"Cannot initialize a HDSProtocolError with NORMAL!"),r.reason=t,r}return s.__extends(t,e),t}(Error);t.HDSProtocolError=S,function(e){e[e.UNINITIALIZED=0]="UNINITIALIZED",e[e.BINDING=1]="BINDING",e[e.LISTENING=2]="LISTENING",e[e.CLOSING=3]="CLOSING"}(m||(m={})),function(e){e[e.UNIDENTIFIED=0]="UNIDENTIFIED",e[e.EXPECTING_HELLO=1]="EXPECTING_HELLO",e[e.READY=2]="READY",e[e.CLOSING=3]="CLOSING",e[e.CLOSED=4]="CLOSED"}(v||(v={})),function(e){e[e.EVENT=1]="EVENT",e[e.REQUEST=2]="REQUEST",e[e.RESPONSE=3]="RESPONSE"}(y||(t.MessageType=y={})),function(e){e.CONNECTION_OPENED="connection-opened",e.CONNECTION_CLOSED="connection-closed"}(C||(t.DataStreamServerEvent=C={}));var E,_,T=function(e){function t(){var t=e.call(this)||this;return t.state=0,t.preparedSessions=[],t.connections=[],t.removeListenersOnceClosed=!1,t.internalEventEmitter=new h.EventEmitter,t}return s.__extends(t,e),t.prototype.onEventMessage=function(e,t,r){return this.internalEventEmitter.on(e+"-e-"+t,r),this},t.prototype.removeEventHandler=function(e,t,r){return this.internalEventEmitter.removeListener(e+"-e-"+t,r),this},t.prototype.onRequestMessage=function(e,t,r){return this.internalEventEmitter.on(e+"-r-"+t,r),this},t.prototype.removeRequestHandler=function(e,t,r){return this.internalEventEmitter.removeListener(e+"-r-"+t,r),this},t.prototype.prepareSession=function(e,r,i){var n=this;g("Preparing for incoming HDS connection from %s",e.sessionID);var o=u.default.randomBytes(32),a=Buffer.concat([r,o]),s={connection:e,accessoryToControllerEncryptionKey:p.HKDF("sha512",a,e.encryption.sharedSecret,t.accessoryToControllerInfo,32),controllerToAccessoryEncryptionKey:p.HKDF("sha512",a,e.encryption.sharedSecret,t.controllerToAccessoryInfo,32),accessoryKeySalt:o,connectTimeout:setTimeout((function(){return n.timeoutPreparedSession(s)}),1e4)};s.connectTimeout.unref(),this.preparedSessions.push(s),this.checkTCPServerEstablished(s,(function(e){e?i(e):i(void 0,s)}))},t.prototype.timeoutPreparedSession=function(e){g("Prepared HDS session timed out out since no connection was opened for 10 seconds (%s)",e.connection.sessionID);var t=this.preparedSessions.indexOf(e);t>=0&&this.preparedSessions.splice(t,1),this.checkCloseable()},t.prototype.checkTCPServerEstablished=function(e,t){var r=this;switch(this.state){case 0:g("Starting up TCP server."),this.tcpServer=d.default.createServer(),this.tcpServer.once("listening",this.listening.bind(this,e,t)),this.tcpServer.on("connection",this.onConnection.bind(this)),this.tcpServer.on("close",this.closed.bind(this)),this.tcpServer.listen(),this.state=1;break;case 1:g("TCP server already running. Waiting for it to bind."),this.tcpServer.once("listening",this.listening.bind(this,e,t));break;case 2:g("Instructing client to connect to already running TCP server"),e.port=this.tcpPort,t();break;case 3:g("TCP socket is currently closing. Trying again when server is fully closed and opening a new one then."),this.tcpServer.once("close",(function(){return setTimeout((function(){return r.checkTCPServerEstablished(e,t)}),10)}))}},t.prototype.listening=function(e,t){this.state=2;var r=this.tcpServer.address();r&&"string"!=typeof r&&(this.tcpPort=r.port,e.port=r.port,g("TCP server is now listening for new data stream connections on port %s",r.port),t())},t.prototype.onConnection=function(e){g("[%s] New DataStream connection was established",e.remoteAddress);var t=new I(e);t.on("identification",this.handleSessionIdentification.bind(this,t)),t.on("handle-message-globally",this.handleMessageGlobally.bind(this,t)),t.on("closed",this.connectionClosed.bind(this,t)),this.connections.push(t),this.emit("connection-opened",t)},t.prototype.handleSessionIdentification=function(e,t,r){for(var i=void 0,n=0;n<this.preparedSessions.length;n++){var o=this.preparedSessions[n];if(e.decryptHDSFrame(t,o.controllerToAccessoryEncryptionKey)){i=o;break}}if(r(i),i){g("[%s] Connection was successfully identified (linked with sessionId: %s)",e.remoteAddress,i.connection.sessionID);var a=this.preparedSessions.indexOf(i);a>=0&&this.preparedSessions.splice(a,1),clearTimeout(i.connectTimeout),i.connectTimeout=void 0}else g("[%s] Could not identify connection. Terminating.",e.remoteAddress),e.close()},t.prototype.handleMessageGlobally=function(e,t){var r;c.default.notStrictEqual(t.type,3);var i,n="",o=[];1===t.type?n="-e-":2===t.type&&(n="-r-",o.push(t.id)),o.push(t.message);try{i=(r=this.internalEventEmitter).emit.apply(r,s.__spreadArray([t.protocol+n+t.topic,e],s.__read(o),!1))}catch(r){i=!0,g("[%s] Error occurred while dispatching handler for HDS message: %o",e.remoteAddress,t),g(r.stack)}i||g("[%s] WARNING no handler was found for message: %o",e.remoteAddress,t)},t.prototype.connectionClosed=function(e){g("[%s] DataStream connection closed",e.remoteAddress),this.connections.splice(this.connections.indexOf(e),1),this.emit("connection-closed",e),this.checkCloseable(),3===this.state&&this.removeListenersOnceClosed&&0===this.connections.length&&this.removeAllListeners()},t.prototype.checkCloseable=function(){0===this.connections.length&&0===this.preparedSessions.length&&this.state<3&&(g("Last connection disconnected. Closing the server now."),this.state=3,this.tcpServer.close())},t.prototype.destroy=function(){var e,t;if(this.state>0&&this.state<3){this.tcpServer.close();try{for(var r=s.__values(this.connections),i=r.next();!i.done;i=r.next()){i.value.close()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}}this.state=3,this.removeListenersOnceClosed=!0,this.internalEventEmitter.removeAllListeners()},t.prototype.closed=function(){this.tcpServer=void 0,this.tcpPort=void 0,this.state=0},t.version="1.0",t.accessoryToControllerInfo=Buffer.from("HDS-Read-Encryption-Key"),t.controllerToAccessoryInfo=Buffer.from("HDS-Write-Encryption-Key"),t}(h.EventEmitter);t.DataStreamServer=T,function(e){e.IDENTIFICATION="identification",e.HANDLE_MESSAGE_GLOBALLY="handle-message-globally",e.CLOSED="closed"}(E||(t.DataStreamConnectionEvent=E={})),function(e){e[e.ILLEGAL_STATE=1]="ILLEGAL_STATE",e[e.CLOSED_SOCKET=2]="CLOSED_SOCKET",e[e.MAX_PAYLOAD_LENGTH=3]="MAX_PAYLOAD_LENGTH"}(_||(t.HDSConnectionErrorType=_={}));var A=function(e){function t(t,r){var i=e.call(this,t)||this;return i.type=r,i}return s.__extends(t,e),t}(Error);t.HDSConnectionError=A;var I=function(e){function t(t){var r,i=e.call(this)||this;return i.state=0,i.protocolHandlers={},i.responseHandlers={},i.responseTimers={},i.socket=t,i.remoteAddress=t.remoteAddress,i.socket.setNoDelay(!0),i.socket.setKeepAlive(!0),i.accessoryToControllerNonce=0,i.accessoryToControllerNonceBuffer=Buffer.alloc(8),i.controllerToAccessoryNonce=0,i.controllerToAccessoryNonceBuffer=Buffer.alloc(8),i.hapConnectionClosedListener=i.onHAPSessionClosed.bind(i),i.addProtocolHandler("control",{requestHandler:(r={},r.hello=i.handleHello.bind(i),r)}),i.helloTimer=setTimeout((function(){g("[%s] Hello message did not arrive in time. Killing the connection",i.remoteAddress),i.close()}),1e4),i.socket.on("data",i.onSocketData.bind(i)),i.socket.on("error",i.onSocketError.bind(i)),i.socket.on("close",i.onSocketClose.bind(i)),i.setMaxListeners(100),i}return s.__extends(t,e),t.prototype.handleHello=function(e,t){g("[%s] Received hello message from client: %o",this.remoteAddress,t),clearTimeout(this.helloTimer),this.helloTimer=void 0,this.state=2,this.sendResponse("control","hello",e)},t.prototype.addProtocolHandler=function(e,t){return void 0===this.protocolHandlers[e]&&(this.protocolHandlers[e]=t,!0)},t.prototype.removeProtocolHandler=function(e,t){this.protocolHandlers[e]===t&&delete this.protocolHandlers[e]},t.prototype.sendEvent=function(e,t,r){void 0===r&&(r={});var i={};i.protocol=e,i.event=t,this.sendHDSFrame(i,r)},t.prototype.sendRequest=function(e,t,r,i){var n,o=this;void 0===r&&(r={});do{n=Math.floor(4294967295*Math.random())}while(void 0!==this.responseHandlers[n]);this.responseHandlers[n]=i,this.responseTimers[n]=setTimeout((function(){o.close();var e=o.responseHandlers[n];delete o.responseHandlers[n],delete o.responseTimers[n],e(new Error("timeout"),void 0,{})}),1e4);var a={};a.protocol=e,a.request=t,a.id=new f.Int64(n),this.sendHDSFrame(a,r)},t.prototype.sendResponse=function(e,t,r,i,n){void 0===i&&(i=o.SUCCESS),void 0===n&&(n={});var a={};a.protocol=e,a.response=t,a.id=new f.Int64(r),a.status=new f.Int64(i),this.sendHDSFrame(a,n)},t.prototype.onSocketData=function(e){var t=this;if(!(this.state>=3)){var r=0,i=this.decodeHDSFrames(e);if(0!==i.length){if(0===this.state){var n=i[r++];if(this.emit("identification",n,(function(e){e&&(t.connection=e.connection,t.accessoryToControllerEncryptionKey=e.accessoryToControllerEncryptionKey,t.controllerToAccessoryEncryptionKey=e.controllerToAccessoryEncryptionKey,t.state=1,t.connection.setMaxListeners(t.connection.getMaxListeners()+1),t.connection.on("closed",t.hapConnectionClosedListener),g("[%s] Registering CLOSED handler to HAP connection. Connection currently has %d close handlers!",t.remoteAddress,t.connection.listeners("closed").length))})),0===this.state)return}for(;r<i.length;r++)if(!this.decryptHDSFrame(i[r]))return g("[%s] HDS frame decryption or authentication failed. Connection will be terminated!",this.remoteAddress),void this.close();var o=this.decodePayloads(i);if(1===this.state){var a=o[0];if("control"!==a.protocol||2!==a.type||"hello"!==a.topic)return g("[%s] First message received was not the expected hello message. Instead got: %o",this.remoteAddress,a),void this.close()}o.forEach((function(e){if(3===e.type){var r=t.responseHandlers[e.id],i=t.responseTimers[e.id];if(i&&(clearTimeout(i),delete t.responseTimers[e.id]),!r)return void g("WARNING we received a response to a request we have not sent: %o",e);try{r(void 0,e.status,e.message)}catch(r){g("[%s] Error occurred while dispatching response handler for HDS message: %o",t.remoteAddress,e),g(r.stack)}delete t.responseHandlers[e.id]}else{var n=t.protocolHandlers[e.protocol];if(void 0===n)return void t.emit("handle-message-globally",e);if(1===e.type){var o=void 0;if(!n.eventHandler||!(o=n.eventHandler[e.topic]))return void g("[%s] WARNING no event handler was found for message: %o",t.remoteAddress,e);try{o(e.message)}catch(r){g("[%s] Error occurred while dispatching event handler for HDS message: %o",t.remoteAddress,e),g(r.stack)}}else if(2===e.type){var a=void 0;if(!n.requestHandler||!(a=n.requestHandler[e.topic]))return void g("[%s] WARNING no request handler was found for message: %o",t.remoteAddress,e);try{a(e.id,e.message)}catch(r){g("[%s] Error occurred while dispatching request handler for HDS message: %o",t.remoteAddress,e),g(r.stack)}}else g("[%s] Encountered unknown message type with id %d",t.remoteAddress,e.type)}}))}}},t.prototype.decodeHDSFrames=function(e){void 0!==this.frameBuffer&&(e=Buffer.concat([this.frameBuffer,e]),this.frameBuffer=void 0);for(var r=e.length,i=[],n=0;n<r;){if(n+4>r){this.frameBuffer=e.slice(n);break}var o=e.readUInt8(n),a=e.readUIntBE(n+1,3);if(a>t.MAX_PAYLOAD_LENGTH)return g("[%s] Connection send payload with size bigger than the maximum allow for data stream",this.remoteAddress),this.close(),[];if(a+16>r-n-4){this.frameBuffer=e.slice(n);break}var s=n+4,c=s+a,u=e.slice(n,s),l=e.slice(s,c),h=Buffer.alloc(a),d=e.slice(c,c+16);if(n=c+16,1===o){var p={header:u,cipheredPayload:l,authTag:d};i.push(p)}else g("[%s] Encountered unknown payload type %d for payload: %s",this.remoteAddress,h.toString("hex"))}return i},t.prototype.decryptHDSFrame=function(e,t){p.writeUInt64LE(this.controllerToAccessoryNonce,this.controllerToAccessoryNonceBuffer,0);var r=t||this.controllerToAccessoryEncryptionKey;try{return e.plaintextPayload=p.chacha20_poly1305_decryptAndVerify(r,this.controllerToAccessoryNonceBuffer,e.header,e.cipheredPayload,e.authTag),this.controllerToAccessoryNonce++,!0}catch(e){return!1}},t.prototype.decodePayloads=function(e){var t=this,r=[];return e.forEach((function(e){var i=e.plaintextPayload;if(!i)throw new A("Reached illegal state. Encountered HDSFrame with wasn't decrypted yet!",1);var n,o,a,s=i.readUInt8(0),c=i.length-s-1,u=1+s,l=new f.DataStreamReader(i.slice(1,1+s)),h=new f.DataStreamReader(i.slice(u,u+c));try{n=f.DataStreamParser.decode(l),l.finished()}catch(e){return void g("[%s] Failed to decode header payload: %s",t.remoteAddress,e.message)}try{o=f.DataStreamParser.decode(h),h.finished()}catch(e){return void g("[%s] Failed to decode message payload: %s (header: %o)",t.remoteAddress,e.message,n)}var d,p=n.protocol,m=void 0,v=void 0;if(void 0!==n.event)a=1,d=n.event;else if(void 0!==n.request)a=2,d=n.request,m=n.id;else{if(void 0===n.response)return void g("[%s] Encountered unknown payload header format: %o (message: %o)",t.remoteAddress,n,o);a=3,d=n.response,m=n.id,v=n.status}var y={type:a,protocol:p,topic:d,id:m,status:v,message:o};r.push(y)})),r},t.prototype.sendHDSFrame=function(e,r){if(this.state>=3)throw new A("Cannot send message on closing/closed socket!",2);var i=new f.DataStreamWriter,n=new f.DataStreamWriter;f.DataStreamParser.encode(e,i),f.DataStreamParser.encode(r,n);var o=Buffer.alloc(1);o.writeUInt8(i.length(),0);var a=Buffer.concat([o,i.getData(),n.getData()]);if(a.length>t.MAX_PAYLOAD_LENGTH)throw new A("Tried sending payload with length larger than the maximum allowed for data stream",3);var s=Buffer.alloc(1);s.writeUInt8(1,0);var c=Buffer.alloc(4);c.writeUInt32BE(a.length,0),c=c.slice(1,4);var u=Buffer.concat([s,c]);p.writeUInt64LE(this.accessoryToControllerNonce++,this.accessoryToControllerNonceBuffer);var l=p.chacha20_poly1305_encryptAndSeal(this.accessoryToControllerEncryptionKey,this.accessoryToControllerNonceBuffer,u,a);this.socket.write(Buffer.concat([u,l.ciphertext,l.authTag]))},t.prototype.close=function(){this.state>=3||(this.state=3,this.socket.end())},t.prototype.isConsideredClosed=function(){return this.state>=3},t.prototype.onHAPSessionClosed=function(){g("[%s] HAP connection disconnected. Also closing DataStream connection now.",this.remoteAddress),this.close()},t.prototype.onSocketError=function(e){g("[%s] Encountered socket error: %s",this.remoteAddress,e.message)},t.prototype.onSocketClose=function(){var e,t;this.state=4,this.emit("closed"),null===(e=this.connection)||void 0===e||e.removeListener("closed",this.hapConnectionClosedListener),null===(t=this.connection)||void 0===t||t.setMaxListeners(this.connection.getMaxListeners()-1),this.removeAllListeners()},t.MAX_PAYLOAD_LENGTH=1048575,t}(h.EventEmitter);t.DataStreamConnection=I},9948:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(1635);i.__exportStar(r(733),t),i.__exportStar(r(4097),t),i.__exportStar(r(7881),t)},651:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CurrentMediaState=t.CurrentHumidifierDehumidifierState=t.CurrentHorizontalTiltAngle=t.CurrentHeatingCoolingState=t.CurrentHeaterCoolerState=t.CurrentFanState=t.CurrentDoorState=t.CurrentAmbientLightLevel=t.CurrentAirPurifierState=t.CryptoHash=t.CoolingThresholdTemperature=t.ContactSensorState=t.ConfiguredName=t.ConfigureBridgedAccessoryStatus=t.ConfigureBridgedAccessory=t.ConfigurationState=t.ColorTemperature=t.ClosedCaptions=t.ChargingState=t.CharacteristicValueTransitionControl=t.CharacteristicValueActiveTransitionCount=t.CCASignalDetectThreshold=t.CCAEnergyDetectThreshold=t.Category=t.CarbonMonoxidePeakLevel=t.CarbonMonoxideLevel=t.CarbonMonoxideDetected=t.CarbonDioxidePeakLevel=t.CarbonDioxideLevel=t.CarbonDioxideDetected=t.CameraOperatingModeIndicator=t.ButtonEvent=t.Brightness=t.BatteryLevel=t.AudioFeedback=t.AssetUpdateReadiness=t.AppMatchingIdentifier=t.AirQuality=t.AirPlayEnable=t.AirParticulateSize=t.AirParticulateDensity=t.AdministratorOnlyAccess=t.ActivityInterval=t.ActiveIdentifier=t.Active=t.AccessoryIdentifier=t.AccessoryFlags=t.AccessControlLevel=t.AccessCodeSupportedConfiguration=t.AccessCodeControlPoint=void 0,t.Logs=t.LockTargetState=t.LockPhysicalControls=t.LockManagementAutoSecurityTimeout=t.LockLastKnownAction=t.LockCurrentState=t.LockControlPoint=t.ListPairings=t.LinkQuality=t.LeakDetected=t.IsConfigured=t.InUse=t.InputSourceType=t.InputDeviceType=t.ImageRotation=t.ImageMirroring=t.Identify=t.Identifier=t.Hue=t.HomeKitCameraActive=t.HoldPosition=t.HeatingThresholdTemperature=t.HeartBeat=t.HardwareRevision=t.HardwareFinish=t.FirmwareUpdateStatus=t.FirmwareUpdateReadiness=t.FirmwareRevision=t.FilterLifeLevel=t.FilterChangeIndication=t.EventTransmissionCounters=t.EventSnapshotsActive=t.EventRetransmissionMaximum=t.DisplayOrder=t.DiscoveredBridgedAccessories=t.DiscoverBridgedAccessories=t.DigitalZoom=t.DiagonalFieldOfView=t.DayoftheWeek=t.DataStreamHAPTransportInterrupt=t.DataStreamHAPTransport=t.CurrentVisibilityState=t.CurrentVerticalTiltAngle=t.CurrentTransport=t.CurrentTime=t.CurrentTiltAngle=t.CurrentTemperature=t.CurrentSlatState=t.CurrentRelativeHumidity=t.CurrentPosition=void 0,t.RelayState=t.RelayEnabled=t.RelayControlPoint=t.RelativeHumidityHumidifierThreshold=t.RelativeHumidityDehumidifierThreshold=t.RecordingAudioActive=t.ReceiverSensitivity=t.ReceivedSignalStrengthIndication=t.Reachable=t.ProgramMode=t.ProgrammableSwitchOutputState=t.ProgrammableSwitchEvent=t.ProductData=t.PowerModeSelection=t.PositionState=t.PM2_5Density=t.PM10Density=t.Ping=t.PictureMode=t.PeriodicSnapshotsActive=t.PasswordSetting=t.PairVerify=t.PairSetup=t.PairingFeatures=t.OzoneDensity=t.OutletInUse=t.OpticalZoom=t.OperatingStateResponse=t.On=t.OccupancyDetected=t.ObstructionDetected=t.NitrogenDioxideDensity=t.NightVision=t.NFCAccessSupportedConfiguration=t.NFCAccessControlPoint=t.NetworkClientStatusControl=t.NetworkClientProfileControl=t.NetworkAccessViolationControl=t.Name=t.Mute=t.MultifunctionButton=t.MotionDetected=t.Model=t.MetricsBufferFullState=t.MaximumTransmitPower=t.Manufacturer=t.ManuallyDisabled=t.ManagedNetworkEnable=t.MACTransmissionCounters=t.MACRetransmissionMaximum=void 0,t.SupportedDiagnosticsModes=t.SupportedDataStreamTransportConfiguration=t.SupportedCharacteristicValueTransitionConfiguration=t.SupportedCameraRecordingConfiguration=t.SupportedAudioStreamConfiguration=t.SupportedAudioRecordingConfiguration=t.SupportedAssetTypes=t.SulphurDioxideDensity=t.StreamingStatus=t.StatusTampered=t.StatusLowBattery=t.StatusJammed=t.StatusFault=t.StatusActive=t.StagedFirmwareVersion=t.SoftwareRevision=t.SmokeDetected=t.SleepInterval=t.SleepDiscoveryMode=t.SlatType=t.SiriTouchToUse=t.SiriListening=t.SiriLightOnUse=t.SiriInputType=t.SiriEngineVersion=t.SiriEndpointSessionStatus=t.SiriEnable=t.SignalToNoiseRatio=t.SetupTransferTransport=t.SetupEndpoints=t.SetupDataStreamTransport=t.SetDuration=t.ServiceLabelNamespace=t.ServiceLabelIndex=t.SerialNumber=t.SelectedSleepConfiguration=t.SelectedRTPStreamConfiguration=t.SelectedDiagnosticsModes=t.SelectedCameraRecordingConfiguration=t.SelectedAudioStreamConfiguration=t.SecuritySystemTargetState=t.SecuritySystemCurrentState=t.SecuritySystemAlarmType=t.Saturation=t.RouterStatus=t.RotationSpeed=t.RotationDirection=t.ResetFilterIndication=t.RemoteKey=t.RemainingDuration=void 0,t.WakeConfiguration=t.VolumeSelector=t.VolumeControlType=t.Volume=t.VOCDensity=t.VideoAnalysisActive=t.Version=t.ValveType=t.TunneledAccessoryStateNumber=t.TunneledAccessoryConnected=t.TunneledAccessoryAdvertising=t.TunnelConnectionTimeout=t.TransmitPower=t.Token=t.TimeUpdate=t.ThreadStatus=t.ThreadOpenThreadVersion=t.ThreadNodeCapabilities=t.ThreadControlPoint=t.ThirdPartyCameraActive=t.TemperatureDisplayUnits=t.TargetVisibilityState=t.TargetVerticalTiltAngle=t.TargetTiltAngle=t.TargetTemperature=t.TargetSlatState=t.TargetRelativeHumidity=t.TargetPosition=t.TargetMediaState=t.TargetHumidifierDehumidifierState=t.TargetHorizontalTiltAngle=t.TargetHeatingCoolingState=t.TargetHeaterCoolerState=t.TargetFanState=t.TargetDoorState=t.TargetControlSupportedConfiguration=t.TargetControlList=t.TargetAirQuality=t.TargetAirPurifierState=t.TapType=t.SwingMode=t.SupportedVideoStreamConfiguration=t.SupportedVideoRecordingConfiguration=t.SupportedTransferTransportConfiguration=t.SupportedSleepConfiguration=t.SupportedRTPConfiguration=t.SupportedRouterConfiguration=t.SupportedMetrics=t.SupportedFirmwareUpdateConfiguration=t.SupportedDiagnosticsSnapshot=void 0,t.WiFiSatelliteStatus=t.WiFiConfigurationControl=t.WiFiCapabilities=t.WaterLevel=t.WANStatusList=t.WANConfigurationList=void 0;var i=r(1635),n=r(9826),o=function(e){function t(){var r=e.call(this,"Access Code Control Point",t.UUID,{format:"tlv8",perms:["pr","pw","wr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000262-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.AccessCodeControlPoint=o,n.Characteristic.AccessCodeControlPoint=o;var a=function(e){function t(){var r=e.call(this,"Access Code Supported Configuration",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000261-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.AccessCodeSupportedConfiguration=a,n.Characteristic.AccessCodeSupportedConfiguration=a;var s=function(e){function t(){var r=e.call(this,"Access Control Level",t.UUID,{format:"uint16",perms:["ev","pr","pw"],minValue:0,maxValue:2,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000E5-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.AccessControlLevel=s,n.Characteristic.AccessControlLevel=s;var c=function(e){function t(){var r=e.call(this,"Accessory Flags",t.UUID,{format:"uint32",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000A6-0000-1000-8000-0026BB765291",t.REQUIRES_ADDITIONAL_SETUP_BIT_MASK=1,t}(n.Characteristic);t.AccessoryFlags=c,n.Characteristic.AccessoryFlags=c;var u=function(e){function t(){var r=e.call(this,"Accessory Identifier",t.UUID,{format:"string",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000057-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.AccessoryIdentifier=u,n.Characteristic.AccessoryIdentifier=u;var l=function(e){function t(){var r=e.call(this,"Active",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000B0-0000-1000-8000-0026BB765291",t.INACTIVE=0,t.ACTIVE=1,t}(n.Characteristic);t.Active=l,n.Characteristic.Active=l;var h=function(e){function t(){var r=e.call(this,"Active Identifier",t.UUID,{format:"uint32",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000E7-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ActiveIdentifier=h,n.Characteristic.ActiveIdentifier=h;var d=function(e){function t(){var r=e.call(this,"Activity Interval",t.UUID,{format:"uint32",perms:["ev","pr"],minValue:0,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000023B-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ActivityInterval=d,n.Characteristic.ActivityInterval=d;var p=function(e){function t(){var r=e.call(this,"Administrator Only Access",t.UUID,{format:"bool",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000001-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.AdministratorOnlyAccess=p,n.Characteristic.AdministratorOnlyAccess=p;var f=function(e){function t(){var r=e.call(this,"Air Particulate Density",t.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e3})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000064-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.AirParticulateDensity=f,n.Characteristic.AirParticulateDensity=f;var g=function(e){function t(){var r=e.call(this,"Air Particulate Size",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000065-0000-1000-8000-0026BB765291",t._2_5_M=0,t._10_M=1,t}(n.Characteristic);t.AirParticulateSize=g,n.Characteristic.AirParticulateSize=g;var m=function(e){function t(){var r=e.call(this,"AirPlay Enable",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000025B-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.AirPlayEnable=m,n.Characteristic.AirPlayEnable=m;var v=function(e){function t(){var r=e.call(this,"Air Quality",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:5,minStep:1,validValues:[0,1,2,3,4,5]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000095-0000-1000-8000-0026BB765291",t.UNKNOWN=0,t.EXCELLENT=1,t.GOOD=2,t.FAIR=3,t.INFERIOR=4,t.POOR=5,t}(n.Characteristic);t.AirQuality=v,n.Characteristic.AirQuality=v;var y=function(e){function t(){var r=e.call(this,"App Matching Identifier",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000A4-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.AppMatchingIdentifier=y,n.Characteristic.AppMatchingIdentifier=y;var C=function(e){function t(){var r=e.call(this,"Asset Update Readiness",t.UUID,{format:"uint32",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000269-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.AssetUpdateReadiness=C,n.Characteristic.AssetUpdateReadiness=C;var S=function(e){function t(){var r=e.call(this,"Audio Feedback",t.UUID,{format:"bool",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000005-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.AudioFeedback=S,n.Characteristic.AudioFeedback=S;var E=function(e){function t(){var r=e.call(this,"Battery Level",t.UUID,{format:"uint8",perms:["ev","pr"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000068-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.BatteryLevel=E,n.Characteristic.BatteryLevel=E;var _=function(e){function t(){var r=e.call(this,"Brightness",t.UUID,{format:"int",perms:["ev","pr","pw"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000008-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Brightness=_,n.Characteristic.Brightness=_;var T=function(e){function t(){var r=e.call(this,"Button Event",t.UUID,{format:"tlv8",perms:["ev","pr"],adminOnlyAccess:[2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000126-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ButtonEvent=T,n.Characteristic.ButtonEvent=T;var A=function(e){function t(){var r=e.call(this,"Camera Operating Mode Indicator",t.UUID,{format:"bool",perms:["ev","pr","pw","tw"],validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000021D-0000-1000-8000-0026BB765291",t.DISABLE=0,t.ENABLE=1,t}(n.Characteristic);t.CameraOperatingModeIndicator=A,n.Characteristic.CameraOperatingModeIndicator=A;var I=function(e){function t(){var r=e.call(this,"Carbon Dioxide Detected",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000092-0000-1000-8000-0026BB765291",t.CO2_LEVELS_NORMAL=0,t.CO2_LEVELS_ABNORMAL=1,t}(n.Characteristic);t.CarbonDioxideDetected=I,n.Characteristic.CarbonDioxideDetected=I;var D=function(e){function t(){var r=e.call(this,"Carbon Dioxide Level",t.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e5,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000093-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CarbonDioxideLevel=D,n.Characteristic.CarbonDioxideLevel=D;var w=function(e){function t(){var r=e.call(this,"Carbon Dioxide Peak Level",t.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e5,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000094-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CarbonDioxidePeakLevel=w,n.Characteristic.CarbonDioxidePeakLevel=w;var b=function(e){function t(){var r=e.call(this,"Carbon Monoxide Detected",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000069-0000-1000-8000-0026BB765291",t.CO_LEVELS_NORMAL=0,t.CO_LEVELS_ABNORMAL=1,t}(n.Characteristic);t.CarbonMonoxideDetected=b,n.Characteristic.CarbonMonoxideDetected=b;var U=function(e){function t(){var r=e.call(this,"Carbon Monoxide Level",t.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000090-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CarbonMonoxideLevel=U,n.Characteristic.CarbonMonoxideLevel=U;var R=function(e){function t(){var r=e.call(this,"Carbon Monoxide Peak Level",t.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000091-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CarbonMonoxidePeakLevel=R,n.Characteristic.CarbonMonoxidePeakLevel=R;var O=function(e){function t(){var r=e.call(this,"Category",t.UUID,{format:"uint16",perms:["ev","pr"],minValue:1,maxValue:16})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000A3-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Category=O,n.Characteristic.Category=O;var N=function(e){function t(){var r=e.call(this,"CCA Energy Detect Threshold",t.UUID,{format:"int",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000246-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CCAEnergyDetectThreshold=N,n.Characteristic.CCAEnergyDetectThreshold=N;var P=function(e){function t(){var r=e.call(this,"CCA Signal Detect Threshold",t.UUID,{format:"int",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000245-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CCASignalDetectThreshold=P,n.Characteristic.CCASignalDetectThreshold=P;var B=function(e){function t(){var r=e.call(this,"Characteristic Value Active Transition Count",t.UUID,{format:"uint8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000024B-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CharacteristicValueActiveTransitionCount=B,n.Characteristic.CharacteristicValueActiveTransitionCount=B;var L=function(e){function t(){var r=e.call(this,"Characteristic Value Transition Control",t.UUID,{format:"tlv8",perms:["pr","pw","wr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000143-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CharacteristicValueTransitionControl=L,n.Characteristic.CharacteristicValueTransitionControl=L;var x=function(e){function t(){var r=e.call(this,"Charging State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000008F-0000-1000-8000-0026BB765291",t.NOT_CHARGING=0,t.CHARGING=1,t.NOT_CHARGEABLE=2,t}(n.Characteristic);t.ChargingState=x,n.Characteristic.ChargingState=x;var M=function(e){function t(){var r=e.call(this,"Closed Captions",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000DD-0000-1000-8000-0026BB765291",t.DISABLED=0,t.ENABLED=1,t}(n.Characteristic);t.ClosedCaptions=M,n.Characteristic.ClosedCaptions=M;var F=function(e){function t(){var r=e.call(this,"Color Temperature",t.UUID,{format:"int",perms:["ev","pr","pw"],minValue:140,maxValue:500,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000CE-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ColorTemperature=F,n.Characteristic.ColorTemperature=F;var k=function(e){function t(){var r=e.call(this,"Configuration State",t.UUID,{format:"uint16",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000263-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ConfigurationState=k,n.Characteristic.ConfigurationState=k;var V=function(e){function t(){var r=e.call(this,"Configure Bridged Accessory",t.UUID,{format:"tlv8",perms:["pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000A0-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ConfigureBridgedAccessory=V,n.Characteristic.ConfigureBridgedAccessory=V;var H=function(e){function t(){var r=e.call(this,"Configure Bridged Accessory Status",t.UUID,{format:"tlv8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000009D-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ConfigureBridgedAccessoryStatus=H,n.Characteristic.ConfigureBridgedAccessoryStatus=H;var j=function(e){function t(){var r=e.call(this,"Configured Name",t.UUID,{format:"string",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000E3-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ConfiguredName=j,n.Characteristic.ConfiguredName=j;var G=function(e){function t(){var r=e.call(this,"Contact Sensor State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000006A-0000-1000-8000-0026BB765291",t.CONTACT_DETECTED=0,t.CONTACT_NOT_DETECTED=1,t}(n.Characteristic);t.ContactSensorState=G,n.Characteristic.ContactSensorState=G;var W=function(e){function t(){var r=e.call(this,"Cooling Threshold Temperature",t.UUID,{format:"float",perms:["ev","pr","pw"],unit:"celsius",minValue:10,maxValue:35,minStep:.1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000000D-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CoolingThresholdTemperature=W,n.Characteristic.CoolingThresholdTemperature=W;var Y=function(e){function t(){var r=e.call(this,"Crypto Hash",t.UUID,{format:"tlv8",perms:["pw","wr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000250-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CryptoHash=Y,n.Characteristic.CryptoHash=Y;var q=function(e){function t(){var r=e.call(this,"Current Air Purifier State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000A9-0000-1000-8000-0026BB765291",t.INACTIVE=0,t.IDLE=1,t.PURIFYING_AIR=2,t}(n.Characteristic);t.CurrentAirPurifierState=q,n.Characteristic.CurrentAirPurifierState=q;var K=function(e){function t(){var r=e.call(this,"Current Ambient Light Level",t.UUID,{format:"float",perms:["ev","pr"],unit:"lux",minValue:1e-4,maxValue:1e5})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000006B-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CurrentAmbientLightLevel=K,n.Characteristic.CurrentAmbientLightLevel=K;var $=function(e){function t(){var r=e.call(this,"Current Door State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:4,minStep:1,validValues:[0,1,2,3,4]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000000E-0000-1000-8000-0026BB765291",t.OPEN=0,t.CLOSED=1,t.OPENING=2,t.CLOSING=3,t.STOPPED=4,t}(n.Characteristic);t.CurrentDoorState=$,n.Characteristic.CurrentDoorState=$;var z=function(e){function t(){var r=e.call(this,"Current Fan State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000AF-0000-1000-8000-0026BB765291",t.INACTIVE=0,t.IDLE=1,t.BLOWING_AIR=2,t}(n.Characteristic);t.CurrentFanState=z,n.Characteristic.CurrentFanState=z;var Q=function(e){function t(){var r=e.call(this,"Current Heater-Cooler State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000B1-0000-1000-8000-0026BB765291",t.INACTIVE=0,t.IDLE=1,t.HEATING=2,t.COOLING=3,t}(n.Characteristic);t.CurrentHeaterCoolerState=Q,n.Characteristic.CurrentHeaterCoolerState=Q;var X=function(e){function t(){var r=e.call(this,"Current Heating Cooling State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000000F-0000-1000-8000-0026BB765291",t.OFF=0,t.HEAT=1,t.COOL=2,t}(n.Characteristic);t.CurrentHeatingCoolingState=X,n.Characteristic.CurrentHeatingCoolingState=X;var J=function(e){function t(){var r=e.call(this,"Current Horizontal Tilt Angle",t.UUID,{format:"int",perms:["ev","pr"],unit:"arcdegrees",minValue:-90,maxValue:90,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000006C-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CurrentHorizontalTiltAngle=J,n.Characteristic.CurrentHorizontalTiltAngle=J;var Z=function(e){function t(){var r=e.call(this,"Current Humidifier-Dehumidifier State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000B3-0000-1000-8000-0026BB765291",t.INACTIVE=0,t.IDLE=1,t.HUMIDIFYING=2,t.DEHUMIDIFYING=3,t}(n.Characteristic);t.CurrentHumidifierDehumidifierState=Z,n.Characteristic.CurrentHumidifierDehumidifierState=Z;var ee=function(e){function t(){var r=e.call(this,"Current Media State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:5,minStep:1,validValues:[0,1,2,4,5]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000E0-0000-1000-8000-0026BB765291",t.PLAY=0,t.PAUSE=1,t.STOP=2,t.LOADING=4,t.INTERRUPTED=5,t}(n.Characteristic);t.CurrentMediaState=ee,n.Characteristic.CurrentMediaState=ee;var te=function(e){function t(){var r=e.call(this,"Current Position",t.UUID,{format:"uint8",perms:["ev","pr"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000006D-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CurrentPosition=te,n.Characteristic.CurrentPosition=te;var re=function(e){function t(){var r=e.call(this,"Current Relative Humidity",t.UUID,{format:"float",perms:["ev","pr"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000010-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CurrentRelativeHumidity=re,n.Characteristic.CurrentRelativeHumidity=re;var ie=function(e){function t(){var r=e.call(this,"Current Slat State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000AA-0000-1000-8000-0026BB765291",t.FIXED=0,t.JAMMED=1,t.SWINGING=2,t}(n.Characteristic);t.CurrentSlatState=ie,n.Characteristic.CurrentSlatState=ie;var ne=function(e){function t(){var r=e.call(this,"Current Temperature",t.UUID,{format:"float",perms:["ev","pr"],unit:"celsius",minValue:-270,maxValue:100,minStep:.1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000011-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CurrentTemperature=ne,n.Characteristic.CurrentTemperature=ne;var oe=function(e){function t(){var r=e.call(this,"Current Tilt Angle",t.UUID,{format:"int",perms:["ev","pr"],unit:"arcdegrees",minValue:-90,maxValue:90,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000C1-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CurrentTiltAngle=oe,n.Characteristic.CurrentTiltAngle=oe;var ae=function(e){function t(){var r=e.call(this,"Current Time",t.UUID,{format:"string",perms:["pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000009B-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CurrentTime=ae,n.Characteristic.CurrentTime=ae;var se=function(e){function t(){var r=e.call(this,"Current Transport",t.UUID,{format:"bool",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000022B-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CurrentTransport=se,n.Characteristic.CurrentTransport=se;var ce=function(e){function t(){var r=e.call(this,"Current Vertical Tilt Angle",t.UUID,{format:"int",perms:["ev","pr"],unit:"arcdegrees",minValue:-90,maxValue:90,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000006E-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.CurrentVerticalTiltAngle=ce,n.Characteristic.CurrentVerticalTiltAngle=ce;var ue=function(e){function t(){var r=e.call(this,"Current Visibility State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000135-0000-1000-8000-0026BB765291",t.SHOWN=0,t.HIDDEN=1,t}(n.Characteristic);t.CurrentVisibilityState=ue,n.Characteristic.CurrentVisibilityState=ue;var le=function(e){function t(){var r=e.call(this,"Data Stream HAP Transport",t.UUID,{format:"tlv8",perms:["pr","pw","wr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000138-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.DataStreamHAPTransport=le,n.Characteristic.DataStreamHAPTransport=le;var he=function(e){function t(){var r=e.call(this,"Data Stream HAP Transport Interrupt",t.UUID,{format:"tlv8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000139-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.DataStreamHAPTransportInterrupt=he,n.Characteristic.DataStreamHAPTransportInterrupt=he;var de=function(e){function t(){var r=e.call(this,"Day of the Week",t.UUID,{format:"uint8",perms:["pr","pw"],minValue:1,maxValue:7})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000098-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.DayoftheWeek=de,n.Characteristic.DayoftheWeek=de;var pe=function(e){function t(){var r=e.call(this,"Diagonal Field Of View",t.UUID,{format:"float",perms:["ev","pr"],unit:"arcdegrees",minValue:0,maxValue:360})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000224-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.DiagonalFieldOfView=pe,n.Characteristic.DiagonalFieldOfView=pe;var fe=function(e){function t(){var r=e.call(this,"Digital Zoom",t.UUID,{format:"float",perms:["ev","pr","pw"],minStep:.1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000011D-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.DigitalZoom=fe,n.Characteristic.DigitalZoom=fe;var ge=function(e){function t(){var r=e.call(this,"Discover Bridged Accessories",t.UUID,{format:"uint8",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000009E-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.DiscoverBridgedAccessories=ge,n.Characteristic.DiscoverBridgedAccessories=ge;var me=function(e){function t(){var r=e.call(this,"Discovered Bridged Accessories",t.UUID,{format:"uint16",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000009F-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.DiscoveredBridgedAccessories=me,n.Characteristic.DiscoveredBridgedAccessories=me;var ve=function(e){function t(){var r=e.call(this,"Display Order",t.UUID,{format:"tlv8",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000136-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.DisplayOrder=ve,n.Characteristic.DisplayOrder=ve;var ye=function(e){function t(){var r=e.call(this,"Event Retransmission Maximum",t.UUID,{format:"uint8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000023D-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.EventRetransmissionMaximum=ye,n.Characteristic.EventRetransmissionMaximum=ye;var Ce=function(e){function t(){var r=e.call(this,"Event Snapshots Active",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000223-0000-1000-8000-0026BB765291",t.DISABLE=0,t.ENABLE=1,t}(n.Characteristic);t.EventSnapshotsActive=Ce,n.Characteristic.EventSnapshotsActive=Ce;var Se=function(e){function t(){var r=e.call(this,"Event Transmission Counters",t.UUID,{format:"uint32",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000023E-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.EventTransmissionCounters=Se,n.Characteristic.EventTransmissionCounters=Se;var Ee=function(e){function t(){var r=e.call(this,"Filter Change Indication",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000AC-0000-1000-8000-0026BB765291",t.FILTER_OK=0,t.CHANGE_FILTER=1,t}(n.Characteristic);t.FilterChangeIndication=Ee,n.Characteristic.FilterChangeIndication=Ee;var _e=function(e){function t(){var r=e.call(this,"Filter Life Level",t.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000AB-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.FilterLifeLevel=_e,n.Characteristic.FilterLifeLevel=_e;var Te=function(e){function t(){var r=e.call(this,"Firmware Revision",t.UUID,{format:"string",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000052-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.FirmwareRevision=Te,n.Characteristic.FirmwareRevision=Te;var Ae=function(e){function t(){var r=e.call(this,"Firmware Update Readiness",t.UUID,{format:"tlv8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000234-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.FirmwareUpdateReadiness=Ae,n.Characteristic.FirmwareUpdateReadiness=Ae;var Ie=function(e){function t(){var r=e.call(this,"Firmware Update Status",t.UUID,{format:"tlv8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000235-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.FirmwareUpdateStatus=Ie,n.Characteristic.FirmwareUpdateStatus=Ie;var De=function(e){function t(){var r=e.call(this,"Hardware Finish",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000026C-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.HardwareFinish=De,n.Characteristic.HardwareFinish=De;var we=function(e){function t(){var r=e.call(this,"Hardware Revision",t.UUID,{format:"string",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000053-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.HardwareRevision=we,n.Characteristic.HardwareRevision=we;var be=function(e){function t(){var r=e.call(this,"Heart Beat",t.UUID,{format:"uint32",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000024A-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.HeartBeat=be,n.Characteristic.HeartBeat=be;var Ue=function(e){function t(){var r=e.call(this,"Heating Threshold Temperature",t.UUID,{format:"float",perms:["ev","pr","pw"],unit:"celsius",minValue:0,maxValue:25,minStep:.1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000012-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.HeatingThresholdTemperature=Ue,n.Characteristic.HeatingThresholdTemperature=Ue;var Re=function(e){function t(){var r=e.call(this,"Hold Position",t.UUID,{format:"bool",perms:["pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000006F-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.HoldPosition=Re,n.Characteristic.HoldPosition=Re;var Oe=function(e){function t(){var r=e.call(this,"HomeKit Camera Active",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000021B-0000-1000-8000-0026BB765291",t.OFF=0,t.ON=1,t}(n.Characteristic);t.HomeKitCameraActive=Oe,n.Characteristic.HomeKitCameraActive=Oe;var Ne=function(e){function t(){var r=e.call(this,"Hue",t.UUID,{format:"float",perms:["ev","pr","pw"],unit:"arcdegrees",minValue:0,maxValue:360,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000013-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Hue=Ne,n.Characteristic.Hue=Ne;var Pe=function(e){function t(){var r=e.call(this,"Identifier",t.UUID,{format:"uint32",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000E6-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Identifier=Pe,n.Characteristic.Identifier=Pe;var Be=function(e){function t(){var r=e.call(this,"Identify",t.UUID,{format:"bool",perms:["pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000014-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Identify=Be,n.Characteristic.Identify=Be;var Le=function(e){function t(){var r=e.call(this,"Image Mirroring",t.UUID,{format:"bool",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000011F-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ImageMirroring=Le,n.Characteristic.ImageMirroring=Le;var xe=function(e){function t(){var r=e.call(this,"Image Rotation",t.UUID,{format:"int",perms:["ev","pr","pw"],unit:"arcdegrees",minValue:0,maxValue:360,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000011E-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ImageRotation=xe,n.Characteristic.ImageRotation=xe;var Me=function(e){function t(){var r=e.call(this,"Input Device Type",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:6,minStep:1,validValues:[0,1,2,3,4,5,6]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000DC-0000-1000-8000-0026BB765291",t.OTHER=0,t.TV=1,t.RECORDING=2,t.TUNER=3,t.PLAYBACK=4,t.AUDIO_SYSTEM=5,t}(n.Characteristic);t.InputDeviceType=Me,n.Characteristic.InputDeviceType=Me;var Fe=function(e){function t(){var r=e.call(this,"Input Source Type",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:10,minStep:1,validValues:[0,1,2,3,4,5,6,7,8,9,10]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000DB-0000-1000-8000-0026BB765291",t.OTHER=0,t.HOME_SCREEN=1,t.TUNER=2,t.HDMI=3,t.COMPOSITE_VIDEO=4,t.S_VIDEO=5,t.COMPONENT_VIDEO=6,t.DVI=7,t.AIRPLAY=8,t.USB=9,t.APPLICATION=10,t}(n.Characteristic);t.InputSourceType=Fe,n.Characteristic.InputSourceType=Fe;var ke=function(e){function t(){var r=e.call(this,"In Use",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000D2-0000-1000-8000-0026BB765291",t.NOT_IN_USE=0,t.IN_USE=1,t}(n.Characteristic);t.InUse=ke,n.Characteristic.InUse=ke;var Ve=function(e){function t(){var r=e.call(this,"Is Configured",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000D6-0000-1000-8000-0026BB765291",t.NOT_CONFIGURED=0,t.CONFIGURED=1,t}(n.Characteristic);t.IsConfigured=Ve,n.Characteristic.IsConfigured=Ve;var He=function(e){function t(){var r=e.call(this,"Leak Detected",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000070-0000-1000-8000-0026BB765291",t.LEAK_NOT_DETECTED=0,t.LEAK_DETECTED=1,t}(n.Characteristic);t.LeakDetected=He,n.Characteristic.LeakDetected=He;var je=function(e){function t(){var r=e.call(this,"Link Quality",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:1,maxValue:4})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000009C-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.LinkQuality=je,n.Characteristic.LinkQuality=je;var Ge=function(e){function t(){var r=e.call(this,"List Pairings",t.UUID,{format:"tlv8",perms:["pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000050-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ListPairings=Ge,n.Characteristic.ListPairings=Ge;var We=function(e){function t(){var r=e.call(this,"Lock Control Point",t.UUID,{format:"tlv8",perms:["pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000019-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.LockControlPoint=We,n.Characteristic.LockControlPoint=We;var Ye=function(e){function t(){var r=e.call(this,"Lock Current State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000001D-0000-1000-8000-0026BB765291",t.UNSECURED=0,t.SECURED=1,t.JAMMED=2,t.UNKNOWN=3,t}(n.Characteristic);t.LockCurrentState=Ye,n.Characteristic.LockCurrentState=Ye;var qe=function(e){function t(){var r=e.call(this,"Lock Last Known Action",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:10,minStep:1,validValues:[0,1,2,3,4,5,6,7,8,9,10]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000001C-0000-1000-8000-0026BB765291",t.SECURED_PHYSICALLY_INTERIOR=0,t.UNSECURED_PHYSICALLY_INTERIOR=1,t.SECURED_PHYSICALLY_EXTERIOR=2,t.UNSECURED_PHYSICALLY_EXTERIOR=3,t.SECURED_BY_KEYPAD=4,t.UNSECURED_BY_KEYPAD=5,t.SECURED_REMOTELY=6,t.UNSECURED_REMOTELY=7,t.SECURED_BY_AUTO_SECURE_TIMEOUT=8,t.SECURED_PHYSICALLY=9,t.UNSECURED_PHYSICALLY=10,t}(n.Characteristic);t.LockLastKnownAction=qe,n.Characteristic.LockLastKnownAction=qe;var Ke=function(e){function t(){var r=e.call(this,"Lock Management Auto Security Timeout",t.UUID,{format:"uint32",perms:["ev","pr","pw"],unit:"seconds"})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000001A-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.LockManagementAutoSecurityTimeout=Ke,n.Characteristic.LockManagementAutoSecurityTimeout=Ke;var $e=function(e){function t(){var r=e.call(this,"Lock Physical Controls",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000A7-0000-1000-8000-0026BB765291",t.CONTROL_LOCK_DISABLED=0,t.CONTROL_LOCK_ENABLED=1,t}(n.Characteristic);t.LockPhysicalControls=$e,n.Characteristic.LockPhysicalControls=$e;var ze=function(e){function t(){var r=e.call(this,"Lock Target State",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000001E-0000-1000-8000-0026BB765291",t.UNSECURED=0,t.SECURED=1,t}(n.Characteristic);t.LockTargetState=ze,n.Characteristic.LockTargetState=ze;var Qe=function(e){function t(){var r=e.call(this,"Logs",t.UUID,{format:"tlv8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000001F-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Logs=Qe,n.Characteristic.Logs=Qe;var Xe=function(e){function t(){var r=e.call(this,"MAC Retransmission Maximum",t.UUID,{format:"uint8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000247-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.MACRetransmissionMaximum=Xe,n.Characteristic.MACRetransmissionMaximum=Xe;var Je=function(e){function t(){var r=e.call(this,"MAC Transmission Counters",t.UUID,{format:"data",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000248-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.MACTransmissionCounters=Je,n.Characteristic.MACTransmissionCounters=Je;var Ze=function(e){function t(){var r=e.call(this,"Managed Network Enable",t.UUID,{format:"uint8",perms:["ev","pr","pw","tw"],minValue:0,maxValue:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000215-0000-1000-8000-0026BB765291",t.DISABLED=0,t.ENABLED=1,t}(n.Characteristic);t.ManagedNetworkEnable=Ze,n.Characteristic.ManagedNetworkEnable=Ze;var et=function(e){function t(){var r=e.call(this,"Manually Disabled",t.UUID,{format:"bool",perms:["ev","pr"],validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000227-0000-1000-8000-0026BB765291",t.ENABLED=0,t.DISABLED=1,t}(n.Characteristic);t.ManuallyDisabled=et,n.Characteristic.ManuallyDisabled=et;var tt=function(e){function t(){var r=e.call(this,"Manufacturer",t.UUID,{format:"string",perms:["pr"],maxLen:64})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000020-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Manufacturer=tt,n.Characteristic.Manufacturer=tt;var rt=function(e){function t(){var r=e.call(this,"Maximum Transmit Power",t.UUID,{format:"int",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000243-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.MaximumTransmitPower=rt,n.Characteristic.MaximumTransmitPower=rt;var it=function(e){function t(){var r=e.call(this,"Metrics Buffer Full State",t.UUID,{format:"bool",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000272-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.MetricsBufferFullState=it,n.Characteristic.MetricsBufferFullState=it;var nt=function(e){function t(){var r=e.call(this,"Model",t.UUID,{format:"string",perms:["pr"],maxLen:64})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000021-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Model=nt,n.Characteristic.Model=nt;var ot=function(e){function t(){var r=e.call(this,"Motion Detected",t.UUID,{format:"bool",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000022-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.MotionDetected=ot,n.Characteristic.MotionDetected=ot;var at=function(e){function t(){var r=e.call(this,"Multifunction Button",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000026B-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.MultifunctionButton=at,n.Characteristic.MultifunctionButton=at;var st=function(e){function t(){var r=e.call(this,"Mute",t.UUID,{format:"bool",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000011A-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Mute=st,n.Characteristic.Mute=st;var ct=function(e){function t(){var r=e.call(this,"Name",t.UUID,{format:"string",perms:["pr"],maxLen:64})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000023-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Name=ct,n.Characteristic.Name=ct;var ut=function(e){function t(){var r=e.call(this,"Network Access Violation Control",t.UUID,{format:"tlv8",perms:["ev","pr","pw","tw","wr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000021F-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.NetworkAccessViolationControl=ut,n.Characteristic.NetworkAccessViolationControl=ut;var lt=function(e){function t(){var r=e.call(this,"Network Client Profile Control",t.UUID,{format:"tlv8",perms:["ev","pr","pw","tw","wr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000020C-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.NetworkClientProfileControl=lt,n.Characteristic.NetworkClientProfileControl=lt;var ht=function(e){function t(){var r=e.call(this,"Network Client Status Control",t.UUID,{format:"tlv8",perms:["pr","pw","wr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000020D-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.NetworkClientStatusControl=ht,n.Characteristic.NetworkClientStatusControl=ht;var dt=function(e){function t(){var r=e.call(this,"NFC Access Control Point",t.UUID,{format:"tlv8",perms:["pr","pw","wr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000264-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.NFCAccessControlPoint=dt,n.Characteristic.NFCAccessControlPoint=dt;var pt=function(e){function t(){var r=e.call(this,"NFC Access Supported Configuration",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000265-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.NFCAccessSupportedConfiguration=pt,n.Characteristic.NFCAccessSupportedConfiguration=pt;var ft=function(e){function t(){var r=e.call(this,"Night Vision",t.UUID,{format:"bool",perms:["ev","pr","pw","tw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000011B-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.NightVision=ft,n.Characteristic.NightVision=ft;var gt=function(e){function t(){var r=e.call(this,"Nitrogen Dioxide Density",t.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e3,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000C4-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.NitrogenDioxideDensity=gt,n.Characteristic.NitrogenDioxideDensity=gt;var mt=function(e){function t(){var r=e.call(this,"Obstruction Detected",t.UUID,{format:"bool",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000024-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ObstructionDetected=mt,n.Characteristic.ObstructionDetected=mt;var vt=function(e){function t(){var r=e.call(this,"Occupancy Detected",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000071-0000-1000-8000-0026BB765291",t.OCCUPANCY_NOT_DETECTED=0,t.OCCUPANCY_DETECTED=1,t}(n.Characteristic);t.OccupancyDetected=vt,n.Characteristic.OccupancyDetected=vt;var yt=function(e){function t(){var r=e.call(this,"On",t.UUID,{format:"bool",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000025-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.On=yt,n.Characteristic.On=yt;var Ct=function(e){function t(){var r=e.call(this,"Operating State Response",t.UUID,{format:"tlv8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000232-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.OperatingStateResponse=Ct,n.Characteristic.OperatingStateResponse=Ct;var St=function(e){function t(){var r=e.call(this,"Optical Zoom",t.UUID,{format:"float",perms:["ev","pr","pw"],minStep:.1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000011C-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.OpticalZoom=St,n.Characteristic.OpticalZoom=St;var Et=function(e){function t(){var r=e.call(this,"Outlet In Use",t.UUID,{format:"bool",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000026-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.OutletInUse=Et,n.Characteristic.OutletInUse=Et;var _t=function(e){function t(){var r=e.call(this,"Ozone Density",t.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e3,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000C3-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.OzoneDensity=_t,n.Characteristic.OzoneDensity=_t;var Tt=function(e){function t(){var r=e.call(this,"Pairing Features",t.UUID,{format:"uint8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000004F-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.PairingFeatures=Tt,n.Characteristic.PairingFeatures=Tt;var At=function(e){function t(){var r=e.call(this,"Pair Setup",t.UUID,{format:"tlv8",perms:["pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000004C-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.PairSetup=At,n.Characteristic.PairSetup=At;var It=function(e){function t(){var r=e.call(this,"Pair Verify",t.UUID,{format:"tlv8",perms:["pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000004E-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.PairVerify=It,n.Characteristic.PairVerify=It;var Dt=function(e){function t(){var r=e.call(this,"Password Setting",t.UUID,{format:"tlv8",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000E4-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.PasswordSetting=Dt,n.Characteristic.PasswordSetting=Dt;var wt=function(e){function t(){var r=e.call(this,"Periodic Snapshots Active",t.UUID,{format:"uint8",perms:["ev","pr","pw"],validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000225-0000-1000-8000-0026BB765291",t.DISABLE=0,t.ENABLE=1,t}(n.Characteristic);t.PeriodicSnapshotsActive=wt,n.Characteristic.PeriodicSnapshotsActive=wt;var bt=function(e){function t(){var r=e.call(this,"Picture Mode",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:13,minStep:1,validValues:[0,1,2,3,4,5,6,7,8,9,10,11,12,13]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000E2-0000-1000-8000-0026BB765291",t.OTHER=0,t.STANDARD=1,t.CALIBRATED=2,t.CALIBRATED_DARK=3,t.VIVID=4,t.GAME=5,t.COMPUTER=6,t.CUSTOM=7,t}(n.Characteristic);t.PictureMode=bt,n.Characteristic.PictureMode=bt;var Ut=function(e){function t(){var r=e.call(this,"Ping",t.UUID,{format:"data",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000023C-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Ping=Ut,n.Characteristic.Ping=Ut;var Rt=function(e){function t(){var r=e.call(this,"PM10 Density",t.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e3,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000C7-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.PM10Density=Rt,n.Characteristic.PM10Density=Rt;var Ot=function(e){function t(){var r=e.call(this,"PM2.5 Density",t.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e3,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000C6-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.PM2_5Density=Ot,n.Characteristic.PM2_5Density=Ot;var Nt=function(e){function t(){var r=e.call(this,"Position State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000072-0000-1000-8000-0026BB765291",t.DECREASING=0,t.INCREASING=1,t.STOPPED=2,t}(n.Characteristic);t.PositionState=Nt,n.Characteristic.PositionState=Nt;var Pt=function(e){function t(){var r=e.call(this,"Power Mode Selection",t.UUID,{format:"uint8",perms:["pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000DF-0000-1000-8000-0026BB765291",t.SHOW=0,t.HIDE=1,t}(n.Characteristic);t.PowerModeSelection=Pt,n.Characteristic.PowerModeSelection=Pt;var Bt=function(e){function t(){var r=e.call(this,"Product Data",t.UUID,{format:"data",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000220-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ProductData=Bt,n.Characteristic.ProductData=Bt;var Lt=function(e){function t(){var r=e.call(this,"Programmable Switch Event",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000073-0000-1000-8000-0026BB765291",t.SINGLE_PRESS=0,t.DOUBLE_PRESS=1,t.LONG_PRESS=2,t}(n.Characteristic);t.ProgrammableSwitchEvent=Lt,n.Characteristic.ProgrammableSwitchEvent=Lt;var xt=function(e){function t(){var r=e.call(this,"Programmable Switch Output State",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000074-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ProgrammableSwitchOutputState=xt,n.Characteristic.ProgrammableSwitchOutputState=xt;var Mt=function(e){function t(){var r=e.call(this,"Program Mode",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000D1-0000-1000-8000-0026BB765291",t.NO_PROGRAM_SCHEDULED=0,t.PROGRAM_SCHEDULED=1,t.PROGRAM_SCHEDULED_MANUAL_MODE_=2,t}(n.Characteristic);t.ProgramMode=Mt,n.Characteristic.ProgramMode=Mt;var Ft=function(e){function t(){var r=e.call(this,"Reachable",t.UUID,{format:"bool",perms:["pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000063-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Reachable=Ft,n.Characteristic.Reachable=Ft;var kt=function(e){function t(){var r=e.call(this,"Received Signal Strength Indication",t.UUID,{format:"int",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000023F-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ReceivedSignalStrengthIndication=kt,n.Characteristic.ReceivedSignalStrengthIndication=kt;var Vt=function(e){function t(){var r=e.call(this,"Receiver Sensitivity",t.UUID,{format:"int",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000244-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ReceiverSensitivity=Vt,n.Characteristic.ReceiverSensitivity=Vt;var Ht=function(e){function t(){var r=e.call(this,"Recording Audio Active",t.UUID,{format:"uint8",perms:["ev","pr","pw","tw"],validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000226-0000-1000-8000-0026BB765291",t.DISABLE=0,t.ENABLE=1,t}(n.Characteristic);t.RecordingAudioActive=Ht,n.Characteristic.RecordingAudioActive=Ht;var jt=function(e){function t(){var r=e.call(this,"Relative Humidity Dehumidifier Threshold",t.UUID,{format:"float",perms:["ev","pr","pw"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000C9-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.RelativeHumidityDehumidifierThreshold=jt,n.Characteristic.RelativeHumidityDehumidifierThreshold=jt;var Gt=function(e){function t(){var r=e.call(this,"Relative Humidity Humidifier Threshold",t.UUID,{format:"float",perms:["ev","pr","pw"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000CA-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.RelativeHumidityHumidifierThreshold=Gt,n.Characteristic.RelativeHumidityHumidifierThreshold=Gt;var Wt=function(e){function t(){var r=e.call(this,"Relay Control Point",t.UUID,{format:"tlv8",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000005E-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.RelayControlPoint=Wt,n.Characteristic.RelayControlPoint=Wt;var Yt=function(e){function t(){var r=e.call(this,"Relay Enabled",t.UUID,{format:"bool",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000005B-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.RelayEnabled=Yt,n.Characteristic.RelayEnabled=Yt;var qt=function(e){function t(){var r=e.call(this,"Relay State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:5,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000005C-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.RelayState=qt,n.Characteristic.RelayState=qt;var Kt=function(e){function t(){var r=e.call(this,"Remaining Duration",t.UUID,{format:"uint32",perms:["ev","pr"],unit:"seconds",minValue:0,maxValue:3600,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000D4-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.RemainingDuration=Kt,n.Characteristic.RemainingDuration=Kt;var $t=function(e){function t(){var r=e.call(this,"Remote Key",t.UUID,{format:"uint8",perms:["pw"],minValue:0,maxValue:16,minStep:1,validValues:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000E1-0000-1000-8000-0026BB765291",t.REWIND=0,t.FAST_FORWARD=1,t.NEXT_TRACK=2,t.PREVIOUS_TRACK=3,t.ARROW_UP=4,t.ARROW_DOWN=5,t.ARROW_LEFT=6,t.ARROW_RIGHT=7,t.SELECT=8,t.BACK=9,t.EXIT=10,t.PLAY_PAUSE=11,t.INFORMATION=15,t}(n.Characteristic);t.RemoteKey=$t,n.Characteristic.RemoteKey=$t;var zt=function(e){function t(){var r=e.call(this,"Reset Filter Indication",t.UUID,{format:"uint8",perms:["pw"],minValue:1,maxValue:1,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000AD-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ResetFilterIndication=zt,n.Characteristic.ResetFilterIndication=zt;var Qt=function(e){function t(){var r=e.call(this,"Rotation Direction",t.UUID,{format:"int",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000028-0000-1000-8000-0026BB765291",t.CLOCKWISE=0,t.COUNTER_CLOCKWISE=1,t}(n.Characteristic);t.RotationDirection=Qt,n.Characteristic.RotationDirection=Qt;var Xt=function(e){function t(){var r=e.call(this,"Rotation Speed",t.UUID,{format:"float",perms:["ev","pr","pw"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000029-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.RotationSpeed=Xt,n.Characteristic.RotationSpeed=Xt;var Jt=function(e){function t(){var r=e.call(this,"Router Status",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000020E-0000-1000-8000-0026BB765291",t.READY=0,t.NOT_READY=1,t}(n.Characteristic);t.RouterStatus=Jt,n.Characteristic.RouterStatus=Jt;var Zt=function(e){function t(){var r=e.call(this,"Saturation",t.UUID,{format:"float",perms:["ev","pr","pw"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000002F-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Saturation=Zt,n.Characteristic.Saturation=Zt;var er=function(e){function t(){var r=e.call(this,"Security System Alarm Type",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000008E-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SecuritySystemAlarmType=er,n.Characteristic.SecuritySystemAlarmType=er;var tr=function(e){function t(){var r=e.call(this,"Security System Current State",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:4,minStep:1,validValues:[0,1,2,3,4]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000066-0000-1000-8000-0026BB765291",t.STAY_ARM=0,t.AWAY_ARM=1,t.NIGHT_ARM=2,t.DISARMED=3,t.ALARM_TRIGGERED=4,t}(n.Characteristic);t.SecuritySystemCurrentState=tr,n.Characteristic.SecuritySystemCurrentState=tr;var rr=function(e){function t(){var r=e.call(this,"Security System Target State",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000067-0000-1000-8000-0026BB765291",t.STAY_ARM=0,t.AWAY_ARM=1,t.NIGHT_ARM=2,t.DISARM=3,t}(n.Characteristic);t.SecuritySystemTargetState=rr,n.Characteristic.SecuritySystemTargetState=rr;var ir=function(e){function t(){var r=e.call(this,"Selected Audio Stream Configuration",t.UUID,{format:"tlv8",perms:["pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000128-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SelectedAudioStreamConfiguration=ir,n.Characteristic.SelectedAudioStreamConfiguration=ir;var nr=function(e){function t(){var r=e.call(this,"Selected Camera Recording Configuration",t.UUID,{format:"tlv8",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000209-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SelectedCameraRecordingConfiguration=nr,n.Characteristic.SelectedCameraRecordingConfiguration=nr;var or=function(e){function t(){var r=e.call(this,"Selected Diagnostics Modes",t.UUID,{format:"uint32",perms:["pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000024D-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SelectedDiagnosticsModes=or,n.Characteristic.SelectedDiagnosticsModes=or;var ar=function(e){function t(){var r=e.call(this,"Selected RTP Stream Configuration",t.UUID,{format:"tlv8",perms:["pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000117-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SelectedRTPStreamConfiguration=ar,n.Characteristic.SelectedRTPStreamConfiguration=ar;var sr=function(e){function t(){var r=e.call(this,"Selected Sleep Configuration",t.UUID,{format:"tlv8",perms:["ev","pr","pw","wr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000252-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SelectedSleepConfiguration=sr,n.Characteristic.SelectedSleepConfiguration=sr;var cr=function(e){function t(){var r=e.call(this,"Serial Number",t.UUID,{format:"string",perms:["pr"],maxLen:64})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000030-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SerialNumber=cr,n.Characteristic.SerialNumber=cr;var ur=function(e){function t(){var r=e.call(this,"Service Label Index",t.UUID,{format:"uint8",perms:["pr"],minValue:1,maxValue:255,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000CB-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ServiceLabelIndex=ur,n.Characteristic.ServiceLabelIndex=ur;var lr=function(e){function t(){var r=e.call(this,"Service Label Namespace",t.UUID,{format:"uint8",perms:["pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000CD-0000-1000-8000-0026BB765291",t.DOTS=0,t.ARABIC_NUMERALS=1,t}(n.Characteristic);t.ServiceLabelNamespace=lr,n.Characteristic.ServiceLabelNamespace=lr;var hr=function(e){function t(){var r=e.call(this,"Set Duration",t.UUID,{format:"uint32",perms:["ev","pr","pw"],unit:"seconds",minValue:0,maxValue:3600,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000D3-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SetDuration=hr,n.Characteristic.SetDuration=hr;var dr=function(e){function t(){var r=e.call(this,"Setup Data Stream Transport",t.UUID,{format:"tlv8",perms:["pr","pw","wr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000131-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SetupDataStreamTransport=dr,n.Characteristic.SetupDataStreamTransport=dr;var pr=function(e){function t(){var r=e.call(this,"Setup Endpoints",t.UUID,{format:"tlv8",perms:["pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000118-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SetupEndpoints=pr,n.Characteristic.SetupEndpoints=pr;var fr=function(e){function t(){var r=e.call(this,"Setup Transfer Transport",t.UUID,{format:"tlv8",perms:["pw","wr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000201-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SetupTransferTransport=fr,n.Characteristic.SetupTransferTransport=fr;var gr=function(e){function t(){var r=e.call(this,"Signal To Noise Ratio",t.UUID,{format:"int",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000241-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SignalToNoiseRatio=gr,n.Characteristic.SignalToNoiseRatio=gr;var mr=function(e){function t(){var r=e.call(this,"Siri Enable",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000255-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SiriEnable=mr,n.Characteristic.SiriEnable=mr;var vr=function(e){function t(){var r=e.call(this,"Siri Endpoint Session Status",t.UUID,{format:"tlv8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000254-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SiriEndpointSessionStatus=vr,n.Characteristic.SiriEndpointSessionStatus=vr;var yr=function(e){function t(){var r=e.call(this,"Siri Engine Version",t.UUID,{format:"string",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000025A-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SiriEngineVersion=yr,n.Characteristic.SiriEngineVersion=yr;var Cr=function(e){function t(){var r=e.call(this,"Siri Input Type",t.UUID,{format:"uint8",perms:["pr"],minValue:0,maxValue:0,validValues:[0]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000132-0000-1000-8000-0026BB765291",t.PUSH_BUTTON_TRIGGERED_APPLE_TV=0,t}(n.Characteristic);t.SiriInputType=Cr,n.Characteristic.SiriInputType=Cr;var Sr=function(e){function t(){var r=e.call(this,"Siri Light On Use",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000258-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SiriLightOnUse=Sr,n.Characteristic.SiriLightOnUse=Sr;var Er=function(e){function t(){var r=e.call(this,"Siri Listening",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000256-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SiriListening=Er,n.Characteristic.SiriListening=Er;var _r=function(e){function t(){var r=e.call(this,"Siri Touch To Use",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000257-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SiriTouchToUse=_r,n.Characteristic.SiriTouchToUse=_r;var Tr=function(e){function t(){var r=e.call(this,"Slat Type",t.UUID,{format:"uint8",perms:["pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000C0-0000-1000-8000-0026BB765291",t.HORIZONTAL=0,t.VERTICAL=1,t}(n.Characteristic);t.SlatType=Tr,n.Characteristic.SlatType=Tr;var Ar=function(e){function t(){var r=e.call(this,"Sleep Discovery Mode",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000E8-0000-1000-8000-0026BB765291",t.NOT_DISCOVERABLE=0,t.ALWAYS_DISCOVERABLE=1,t}(n.Characteristic);t.SleepDiscoveryMode=Ar,n.Characteristic.SleepDiscoveryMode=Ar;var Ir=function(e){function t(){var r=e.call(this,"Sleep Interval",t.UUID,{format:"uint32",perms:["ev","pr"],minValue:0,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000023A-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SleepInterval=Ir,n.Characteristic.SleepInterval=Ir;var Dr=function(e){function t(){var r=e.call(this,"Smoke Detected",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000076-0000-1000-8000-0026BB765291",t.SMOKE_NOT_DETECTED=0,t.SMOKE_DETECTED=1,t}(n.Characteristic);t.SmokeDetected=Dr,n.Characteristic.SmokeDetected=Dr;var wr=function(e){function t(){var r=e.call(this,"Software Revision",t.UUID,{format:"string",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000054-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SoftwareRevision=wr,n.Characteristic.SoftwareRevision=wr;var br=function(e){function t(){var r=e.call(this,"Staged Firmware Version",t.UUID,{format:"string",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000249-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.StagedFirmwareVersion=br,n.Characteristic.StagedFirmwareVersion=br;var Ur=function(e){function t(){var r=e.call(this,"Status Active",t.UUID,{format:"bool",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000075-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.StatusActive=Ur,n.Characteristic.StatusActive=Ur;var Rr=function(e){function t(){var r=e.call(this,"Status Fault",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000077-0000-1000-8000-0026BB765291",t.NO_FAULT=0,t.GENERAL_FAULT=1,t}(n.Characteristic);t.StatusFault=Rr,n.Characteristic.StatusFault=Rr;var Or=function(e){function t(){var r=e.call(this,"Status Jammed",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000078-0000-1000-8000-0026BB765291",t.NOT_JAMMED=0,t.JAMMED=1,t}(n.Characteristic);t.StatusJammed=Or,n.Characteristic.StatusJammed=Or;var Nr=function(e){function t(){var r=e.call(this,"Status Low Battery",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000079-0000-1000-8000-0026BB765291",t.BATTERY_LEVEL_NORMAL=0,t.BATTERY_LEVEL_LOW=1,t}(n.Characteristic);t.StatusLowBattery=Nr,n.Characteristic.StatusLowBattery=Nr;var Pr=function(e){function t(){var r=e.call(this,"Status Tampered",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000007A-0000-1000-8000-0026BB765291",t.NOT_TAMPERED=0,t.TAMPERED=1,t}(n.Characteristic);t.StatusTampered=Pr,n.Characteristic.StatusTampered=Pr;var Br=function(e){function t(){var r=e.call(this,"Streaming Status",t.UUID,{format:"tlv8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000120-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.StreamingStatus=Br,n.Characteristic.StreamingStatus=Br;var Lr=function(e){function t(){var r=e.call(this,"Sulphur Dioxide Density",t.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e3,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000C5-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SulphurDioxideDensity=Lr,n.Characteristic.SulphurDioxideDensity=Lr;var xr=function(e){function t(){var r=e.call(this,"Supported Asset Types",t.UUID,{format:"uint32",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000268-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedAssetTypes=xr,n.Characteristic.SupportedAssetTypes=xr;var Mr=function(e){function t(){var r=e.call(this,"Supported Audio Recording Configuration",t.UUID,{format:"tlv8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000207-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedAudioRecordingConfiguration=Mr,n.Characteristic.SupportedAudioRecordingConfiguration=Mr;var Fr=function(e){function t(){var r=e.call(this,"Supported Audio Stream Configuration",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000115-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedAudioStreamConfiguration=Fr,n.Characteristic.SupportedAudioStreamConfiguration=Fr;var kr=function(e){function t(){var r=e.call(this,"Supported Camera Recording Configuration",t.UUID,{format:"tlv8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000205-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedCameraRecordingConfiguration=kr,n.Characteristic.SupportedCameraRecordingConfiguration=kr;var Vr=function(e){function t(){var r=e.call(this,"Supported Characteristic Value Transition Configuration",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000144-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedCharacteristicValueTransitionConfiguration=Vr,n.Characteristic.SupportedCharacteristicValueTransitionConfiguration=Vr;var Hr=function(e){function t(){var r=e.call(this,"Supported Data Stream Transport Configuration",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000130-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedDataStreamTransportConfiguration=Hr,n.Characteristic.SupportedDataStreamTransportConfiguration=Hr;var jr=function(e){function t(){var r=e.call(this,"Supported Diagnostics Modes",t.UUID,{format:"uint32",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000024C-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedDiagnosticsModes=jr,n.Characteristic.SupportedDiagnosticsModes=jr;var Gr=function(e){function t(){var r=e.call(this,"Supported Diagnostics Snapshot",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000238-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedDiagnosticsSnapshot=Gr,n.Characteristic.SupportedDiagnosticsSnapshot=Gr;var Wr=function(e){function t(){var r=e.call(this,"Supported Firmware Update Configuration",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000233-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedFirmwareUpdateConfiguration=Wr,n.Characteristic.SupportedFirmwareUpdateConfiguration=Wr;var Yr=function(e){function t(){var r=e.call(this,"Supported Metrics",t.UUID,{format:"tlv8",perms:["pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000271-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedMetrics=Yr,n.Characteristic.SupportedMetrics=Yr;var qr=function(e){function t(){var r=e.call(this,"Supported Router Configuration",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000210-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedRouterConfiguration=qr,n.Characteristic.SupportedRouterConfiguration=qr;var Kr=function(e){function t(){var r=e.call(this,"Supported RTP Configuration",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000116-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedRTPConfiguration=Kr,n.Characteristic.SupportedRTPConfiguration=Kr;var $r=function(e){function t(){var r=e.call(this,"Supported Sleep Configuration",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000251-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedSleepConfiguration=$r,n.Characteristic.SupportedSleepConfiguration=$r;var zr=function(e){function t(){var r=e.call(this,"Supported Transfer Transport Configuration",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000202-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedTransferTransportConfiguration=zr,n.Characteristic.SupportedTransferTransportConfiguration=zr;var Qr=function(e){function t(){var r=e.call(this,"Supported Video Recording Configuration",t.UUID,{format:"tlv8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000206-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedVideoRecordingConfiguration=Qr,n.Characteristic.SupportedVideoRecordingConfiguration=Qr;var Xr=function(e){function t(){var r=e.call(this,"Supported Video Stream Configuration",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000114-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.SupportedVideoStreamConfiguration=Xr,n.Characteristic.SupportedVideoStreamConfiguration=Xr;var Jr=function(e){function t(){var r=e.call(this,"Swing Mode",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000B6-0000-1000-8000-0026BB765291",t.SWING_DISABLED=0,t.SWING_ENABLED=1,t}(n.Characteristic);t.SwingMode=Jr,n.Characteristic.SwingMode=Jr;var Zr=function(e){function t(){var r=e.call(this,"Tap Type",t.UUID,{format:"uint16",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000022F-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TapType=Zr,n.Characteristic.TapType=Zr;var ei=function(e){function t(){var r=e.call(this,"Target Air Purifier State",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000A8-0000-1000-8000-0026BB765291",t.MANUAL=0,t.AUTO=1,t}(n.Characteristic);t.TargetAirPurifierState=ei,n.Characteristic.TargetAirPurifierState=ei;var ti=function(e){function t(){var r=e.call(this,"Target Air Quality",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:2,validValues:[0,1,2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000AE-0000-1000-8000-0026BB765291",t.EXCELLENT=0,t.GOOD=1,t.FAIR=2,t}(n.Characteristic);t.TargetAirQuality=ti,n.Characteristic.TargetAirQuality=ti;var ri=function(e){function t(){var r=e.call(this,"Target Control List",t.UUID,{format:"tlv8",perms:["pr","pw","wr"],adminOnlyAccess:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000124-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TargetControlList=ri,n.Characteristic.TargetControlList=ri;var ii=function(e){function t(){var r=e.call(this,"Target Control Supported Configuration",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000123-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TargetControlSupportedConfiguration=ii,n.Characteristic.TargetControlSupportedConfiguration=ii;var ni=function(e){function t(){var r=e.call(this,"Target Door State",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000032-0000-1000-8000-0026BB765291",t.OPEN=0,t.CLOSED=1,t}(n.Characteristic);t.TargetDoorState=ni,n.Characteristic.TargetDoorState=ni;var oi=function(e){function t(){var r=e.call(this,"Target Fan State",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000BF-0000-1000-8000-0026BB765291",t.MANUAL=0,t.AUTO=1,t}(n.Characteristic);t.TargetFanState=oi,n.Characteristic.TargetFanState=oi;var ai=function(e){function t(){var r=e.call(this,"Target Heater-Cooler State",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000B2-0000-1000-8000-0026BB765291",t.AUTO=0,t.HEAT=1,t.COOL=2,t}(n.Characteristic);t.TargetHeaterCoolerState=ai,n.Characteristic.TargetHeaterCoolerState=ai;var si=function(e){function t(){var r=e.call(this,"Target Heating Cooling State",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000033-0000-1000-8000-0026BB765291",t.OFF=0,t.HEAT=1,t.COOL=2,t.AUTO=3,t}(n.Characteristic);t.TargetHeatingCoolingState=si,n.Characteristic.TargetHeatingCoolingState=si;var ci=function(e){function t(){var r=e.call(this,"Target Horizontal Tilt Angle",t.UUID,{format:"int",perms:["ev","pr","pw"],unit:"arcdegrees",minValue:-90,maxValue:90,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000007B-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TargetHorizontalTiltAngle=ci,n.Characteristic.TargetHorizontalTiltAngle=ci;var ui=function(e){function t(){var r=e.call(this,"Target Humidifier-Dehumidifier State",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000B4-0000-1000-8000-0026BB765291",t.AUTO=0,t.HUMIDIFIER_OR_DEHUMIDIFIER=0,t.HUMIDIFIER=1,t.DEHUMIDIFIER=2,t}(n.Characteristic);t.TargetHumidifierDehumidifierState=ui,n.Characteristic.TargetHumidifierDehumidifierState=ui;var li=function(e){function t(){var r=e.call(this,"Target Media State",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000137-0000-1000-8000-0026BB765291",t.PLAY=0,t.PAUSE=1,t.STOP=2,t}(n.Characteristic);t.TargetMediaState=li,n.Characteristic.TargetMediaState=li;var hi=function(e){function t(){var r=e.call(this,"Target Position",t.UUID,{format:"uint8",perms:["ev","pr","pw"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000007C-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TargetPosition=hi,n.Characteristic.TargetPosition=hi;var di=function(e){function t(){var r=e.call(this,"Target Relative Humidity",t.UUID,{format:"float",perms:["ev","pr","pw"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000034-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TargetRelativeHumidity=di,n.Characteristic.TargetRelativeHumidity=di;var pi=function(e){function t(){var r=e.call(this,"Target Slat State",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000BE-0000-1000-8000-0026BB765291",t.MANUAL=0,t.AUTO=1,t}(n.Characteristic);t.TargetSlatState=pi,n.Characteristic.TargetSlatState=pi;var fi=function(e){function t(){var r=e.call(this,"Target Temperature",t.UUID,{format:"float",perms:["ev","pr","pw"],unit:"celsius",minValue:10,maxValue:38,minStep:.1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000035-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TargetTemperature=fi,n.Characteristic.TargetTemperature=fi;var gi=function(e){function t(){var r=e.call(this,"Target Tilt Angle",t.UUID,{format:"int",perms:["ev","pr","pw"],unit:"arcdegrees",minValue:-90,maxValue:90,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000C2-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TargetTiltAngle=gi,n.Characteristic.TargetTiltAngle=gi;var mi=function(e){function t(){var r=e.call(this,"Target Vertical Tilt Angle",t.UUID,{format:"int",perms:["ev","pr","pw"],unit:"arcdegrees",minValue:-90,maxValue:90,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000007D-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TargetVerticalTiltAngle=mi,n.Characteristic.TargetVerticalTiltAngle=mi;var vi=function(e){function t(){var r=e.call(this,"Target Visibility State",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000134-0000-1000-8000-0026BB765291",t.SHOWN=0,t.HIDDEN=1,t}(n.Characteristic);t.TargetVisibilityState=vi,n.Characteristic.TargetVisibilityState=vi;var yi=function(e){function t(){var r=e.call(this,"Temperature Display Units",t.UUID,{format:"uint8",perms:["ev","pr","pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000036-0000-1000-8000-0026BB765291",t.CELSIUS=0,t.FAHRENHEIT=1,t}(n.Characteristic);t.TemperatureDisplayUnits=yi,n.Characteristic.TemperatureDisplayUnits=yi;var Ci=function(e){function t(){var r=e.call(this,"Third Party Camera Active",t.UUID,{format:"uint8",perms:["ev","pr"],validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000021C-0000-1000-8000-0026BB765291",t.OFF=0,t.ON=1,t}(n.Characteristic);t.ThirdPartyCameraActive=Ci,n.Characteristic.ThirdPartyCameraActive=Ci;var Si=function(e){function t(){var r=e.call(this,"Thread Control Point",t.UUID,{format:"tlv8",perms:["pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000704-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ThreadControlPoint=Si,n.Characteristic.ThreadControlPoint=Si;var Ei=function(e){function t(){var r=e.call(this,"Thread Node Capabilities",t.UUID,{format:"uint16",perms:["pr"],minValue:0,maxValue:31,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000702-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ThreadNodeCapabilities=Ei,n.Characteristic.ThreadNodeCapabilities=Ei;var _i=function(e){function t(){var r=e.call(this,"Thread OpenThread Version",t.UUID,{format:"string",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000706-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ThreadOpenThreadVersion=_i,n.Characteristic.ThreadOpenThreadVersion=_i;var Ti=function(e){function t(){var r=e.call(this,"Thread Status",t.UUID,{format:"uint16",perms:["ev","pr"],minValue:0,maxValue:6,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000703-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.ThreadStatus=Ti,n.Characteristic.ThreadStatus=Ti;var Ai=function(e){function t(){var r=e.call(this,"Time Update",t.UUID,{format:"bool",perms:["pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000009A-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TimeUpdate=Ai,n.Characteristic.TimeUpdate=Ai;var Ii=function(e){function t(){var r=e.call(this,"Token",t.UUID,{format:"data",perms:["pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000231-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Token=Ii,n.Characteristic.Token=Ii;var Di=function(e){function t(){var r=e.call(this,"Transmit Power",t.UUID,{format:"int",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000242-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TransmitPower=Di,n.Characteristic.TransmitPower=Di;var wi=function(e){function t(){var r=e.call(this,"Tunnel Connection Timeout",t.UUID,{format:"int",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000061-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TunnelConnectionTimeout=wi,n.Characteristic.TunnelConnectionTimeout=wi;var bi=function(e){function t(){var r=e.call(this,"Tunneled Accessory Advertising",t.UUID,{format:"bool",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000060-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TunneledAccessoryAdvertising=bi,n.Characteristic.TunneledAccessoryAdvertising=bi;var Ui=function(e){function t(){var r=e.call(this,"Tunneled Accessory Connected",t.UUID,{format:"bool",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000059-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TunneledAccessoryConnected=Ui,n.Characteristic.TunneledAccessoryConnected=Ui;var Ri=function(e){function t(){var r=e.call(this,"Tunneled Accessory State Number",t.UUID,{format:"int",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000058-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.TunneledAccessoryStateNumber=Ri,n.Characteristic.TunneledAccessoryStateNumber=Ri;var Oi=function(e){function t(){var r=e.call(this,"Valve Type",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000D5-0000-1000-8000-0026BB765291",t.GENERIC_VALVE=0,t.IRRIGATION=1,t.SHOWER_HEAD=2,t.WATER_FAUCET=3,t}(n.Characteristic);t.ValveType=Oi,n.Characteristic.ValveType=Oi;var Ni=function(e){function t(){var r=e.call(this,"Version",t.UUID,{format:"string",perms:["pr"],maxLen:64})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000037-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Version=Ni,n.Characteristic.Version=Ni;var Pi=function(e){function t(){var r=e.call(this,"Video Analysis Active",t.UUID,{format:"uint8",perms:["ev","pr","pw"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000229-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.VideoAnalysisActive=Pi,n.Characteristic.VideoAnalysisActive=Pi;var Bi=function(e){function t(){var r=e.call(this,"VOC Density",t.UUID,{format:"float",perms:["ev","pr"],minValue:0,maxValue:1e3,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000C8-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.VOCDensity=Bi,n.Characteristic.VOCDensity=Bi;var Li=function(e){function t(){var r=e.call(this,"Volume",t.UUID,{format:"uint8",perms:["ev","pr","pw"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000119-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.Volume=Li,n.Characteristic.Volume=Li;var xi=function(e){function t(){var r=e.call(this,"Volume Control Type",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000E9-0000-1000-8000-0026BB765291",t.NONE=0,t.RELATIVE=1,t.RELATIVE_WITH_CURRENT=2,t.ABSOLUTE=3,t}(n.Characteristic);t.VolumeControlType=xi,n.Characteristic.VolumeControlType=xi;var Mi=function(e){function t(){var r=e.call(this,"Volume Selector",t.UUID,{format:"uint8",perms:["pw"],minValue:0,maxValue:1,minStep:1,validValues:[0,1]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000EA-0000-1000-8000-0026BB765291",t.INCREMENT=0,t.DECREMENT=1,t}(n.Characteristic);t.VolumeSelector=Mi,n.Characteristic.VolumeSelector=Mi;var Fi=function(e){function t(){var r=e.call(this,"Wake Configuration",t.UUID,{format:"tlv8",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000222-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.WakeConfiguration=Fi,n.Characteristic.WakeConfiguration=Fi;var ki=function(e){function t(){var r=e.call(this,"WAN Configuration List",t.UUID,{format:"tlv8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000211-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.WANConfigurationList=ki,n.Characteristic.WANConfigurationList=ki;var Vi=function(e){function t(){var r=e.call(this,"WAN Status List",t.UUID,{format:"tlv8",perms:["ev","pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="00000212-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.WANStatusList=Vi,n.Characteristic.WANStatusList=Vi;var Hi=function(e){function t(){var r=e.call(this,"Water Level",t.UUID,{format:"float",perms:["ev","pr"],unit:"percentage",minValue:0,maxValue:100,minStep:1})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="000000B5-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.WaterLevel=Hi,n.Characteristic.WaterLevel=Hi;var ji=function(e){function t(){var r=e.call(this,"Wi-Fi Capabilities",t.UUID,{format:"uint32",perms:["pr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000022C-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.WiFiCapabilities=ji,n.Characteristic.WiFiCapabilities=ji;var Gi=function(e){function t(){var r=e.call(this,"Wi-Fi Configuration Control",t.UUID,{format:"tlv8",perms:["ev","pr","pw","tw","wr"]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000022D-0000-1000-8000-0026BB765291",t}(n.Characteristic);t.WiFiConfigurationControl=Gi,n.Characteristic.WiFiConfigurationControl=Gi;var Wi=function(e){function t(){var r=e.call(this,"Wi-Fi Satellite Status",t.UUID,{format:"uint8",perms:["ev","pr"],minValue:0,maxValue:2,validValues:[0,1,2]})||this;return r.value=r.getDefaultValue(),r}return i.__extends(t,e),t.UUID="0000021E-0000-1000-8000-0026BB765291",t.UNKNOWN=0,t.CONNECTED=1,t.NOT_CONNECTED=2,t}(n.Characteristic);t.WiFiSatelliteStatus=Wi,n.Characteristic.WiFiSatelliteStatus=Wi},1647:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SecuritySystem=t.ProtocolInformation=t.PowerManagement=t.Pairing=t.Outlet=t.OccupancySensor=t.NFCAccess=t.MotionSensor=t.Microphone=t.LockMechanism=t.LockManagement=t.LightSensor=t.Lightbulb=t.LeakSensor=t.IrrigationSystem=t.InputSource=t.HumiditySensor=t.HumidifierDehumidifier=t.HeaterCooler=t.GarageDoorOpener=t.FirmwareUpdate=t.FilterMaintenance=t.Faucet=t.Fanv2=t.Fan=t.Doorbell=t.Door=t.Diagnostics=t.DataStreamTransportManagement=t.ContactSensor=t.CloudRelay=t.CarbonMonoxideSensor=t.CarbonDioxideSensor=t.CameraRTPStreamManagement=t.CameraRecordingManagement=t.CameraOperatingMode=t.CameraControl=t.BridgingState=t.BridgeConfiguration=t.Battery=t.AudioStreamManagement=t.Assistant=t.AssetUpdate=t.AirQualitySensor=t.AirPurifier=t.AccessoryRuntimeInformation=t.AccessoryMetrics=t.AccessoryInformation=t.AccessControl=t.AccessCode=void 0,t.WindowCovering=t.Window=t.WiFiTransport=t.WiFiSatellite=t.WiFiRouter=t.Valve=t.Tunnel=t.TransferTransportManagement=t.TimeInformation=t.ThreadTransport=t.Thermostat=t.TemperatureSensor=t.TelevisionSpeaker=t.Television=t.TargetControlManagement=t.TargetControl=t.TapManagement=t.Switch=t.StatelessProgrammableSwitch=t.StatefulProgrammableSwitch=t.Speaker=t.SmokeSensor=t.SmartSpeaker=t.Slats=t.SiriEndpoint=t.Siri=t.ServiceLabel=void 0;var i=r(1635),n=r(9826),o=r(5876),a=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.AccessCodeControlPoint),o.addCharacteristic(n.Characteristic.AccessCodeSupportedConfiguration),o.addCharacteristic(n.Characteristic.ConfigurationState),o}return i.__extends(t,e),t.UUID="00000260-0000-1000-8000-0026BB765291",t}(o.Service);t.AccessCode=a,o.Service.AccessCode=a;var s=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.AccessControlLevel),o.addOptionalCharacteristic(n.Characteristic.PasswordSetting),o}return i.__extends(t,e),t.UUID="000000DA-0000-1000-8000-0026BB765291",t}(o.Service);t.AccessControl=s,o.Service.AccessControl=s;var c=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.Identify),o.addCharacteristic(n.Characteristic.Manufacturer),o.addCharacteristic(n.Characteristic.Model),o.testCharacteristic(n.Characteristic.Name)||o.addCharacteristic(n.Characteristic.Name).updateValue("Unnamed Service"),o.addCharacteristic(n.Characteristic.SerialNumber),o.addCharacteristic(n.Characteristic.FirmwareRevision),o.addOptionalCharacteristic(n.Characteristic.AccessoryFlags),o.addOptionalCharacteristic(n.Characteristic.AppMatchingIdentifier),o.addOptionalCharacteristic(n.Characteristic.ConfiguredName),o.addOptionalCharacteristic(n.Characteristic.HardwareFinish),o.addOptionalCharacteristic(n.Characteristic.HardwareRevision),o.addOptionalCharacteristic(n.Characteristic.ProductData),o.addOptionalCharacteristic(n.Characteristic.SoftwareRevision),o}return i.__extends(t,e),t.UUID="0000003E-0000-1000-8000-0026BB765291",t}(o.Service);t.AccessoryInformation=c,o.Service.AccessoryInformation=c;var u=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.Active),o.addCharacteristic(n.Characteristic.MetricsBufferFullState),o.addCharacteristic(n.Characteristic.SupportedMetrics),o}return i.__extends(t,e),t.UUID="00000270-0000-1000-8000-0026BB765291",t}(o.Service);t.AccessoryMetrics=u,o.Service.AccessoryMetrics=u;var l=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.Ping),o.addOptionalCharacteristic(n.Characteristic.ActivityInterval),o.addOptionalCharacteristic(n.Characteristic.HeartBeat),o.addOptionalCharacteristic(n.Characteristic.SleepInterval),o}return i.__extends(t,e),t.UUID="00000239-0000-1000-8000-0026BB765291",t}(o.Service);t.AccessoryRuntimeInformation=l,o.Service.AccessoryRuntimeInformation=l;var h=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.Active),o.addCharacteristic(n.Characteristic.CurrentAirPurifierState),o.addCharacteristic(n.Characteristic.TargetAirPurifierState),o.addOptionalCharacteristic(n.Characteristic.LockPhysicalControls),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.RotationSpeed),o.addOptionalCharacteristic(n.Characteristic.SwingMode),o}return i.__extends(t,e),t.UUID="000000BB-0000-1000-8000-0026BB765291",t}(o.Service);t.AirPurifier=h,o.Service.AirPurifier=h;var d=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.AirQuality),o.addOptionalCharacteristic(n.Characteristic.NitrogenDioxideDensity),o.addOptionalCharacteristic(n.Characteristic.OzoneDensity),o.addOptionalCharacteristic(n.Characteristic.PM10Density),o.addOptionalCharacteristic(n.Characteristic.PM2_5Density),o.addOptionalCharacteristic(n.Characteristic.SulphurDioxideDensity),o.addOptionalCharacteristic(n.Characteristic.VOCDensity),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.StatusActive),o.addOptionalCharacteristic(n.Characteristic.StatusFault),o.addOptionalCharacteristic(n.Characteristic.StatusLowBattery),o.addOptionalCharacteristic(n.Characteristic.StatusTampered),o}return i.__extends(t,e),t.UUID="0000008D-0000-1000-8000-0026BB765291",t}(o.Service);t.AirQualitySensor=d,o.Service.AirQualitySensor=d;var p=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.AssetUpdateReadiness),o.addCharacteristic(n.Characteristic.SupportedAssetTypes),o}return i.__extends(t,e),t.UUID="00000267-0000-1000-8000-0026BB765291",t}(o.Service);t.AssetUpdate=p,o.Service.AssetUpdate=p;var f=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.Active),o.addCharacteristic(n.Characteristic.Identifier),o.testCharacteristic(n.Characteristic.Name)||o.addCharacteristic(n.Characteristic.Name).updateValue("Unnamed Service"),o}return i.__extends(t,e),t.UUID="0000026A-0000-1000-8000-0026BB765291",t}(o.Service);t.Assistant=f,o.Service.Assistant=f;var g=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.SupportedAudioStreamConfiguration),o.addCharacteristic(n.Characteristic.SelectedAudioStreamConfiguration),o}return i.__extends(t,e),t.UUID="00000127-0000-1000-8000-0026BB765291",t}(o.Service);t.AudioStreamManagement=g,o.Service.AudioStreamManagement=g;var m=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.StatusLowBattery),o.addOptionalCharacteristic(n.Characteristic.BatteryLevel),o.addOptionalCharacteristic(n.Characteristic.ChargingState),o.addOptionalCharacteristic(n.Characteristic.Name),o}return i.__extends(t,e),t.UUID="00000096-0000-1000-8000-0026BB765291",t}(o.Service);t.Battery=m,o.Service.BatteryService=m,o.Service.Battery=m;var v=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.ConfigureBridgedAccessoryStatus),o.addCharacteristic(n.Characteristic.DiscoverBridgedAccessories),o.addCharacteristic(n.Characteristic.DiscoveredBridgedAccessories),o.addCharacteristic(n.Characteristic.ConfigureBridgedAccessory),o.addOptionalCharacteristic(n.Characteristic.Name),o}return i.__extends(t,e),t.UUID="000000A1-0000-1000-8000-0026BB765291",t}(o.Service);t.BridgeConfiguration=v,o.Service.BridgeConfiguration=v;var y=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.Reachable),o.addCharacteristic(n.Characteristic.LinkQuality),o.addCharacteristic(n.Characteristic.AccessoryIdentifier),o.addCharacteristic(n.Characteristic.Category),o.addOptionalCharacteristic(n.Characteristic.Name),o}return i.__extends(t,e),t.UUID="00000062-0000-1000-8000-0026BB765291",t}(o.Service);t.BridgingState=y,o.Service.BridgingState=y;var C=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.On),o.addOptionalCharacteristic(n.Characteristic.CurrentHorizontalTiltAngle),o.addOptionalCharacteristic(n.Characteristic.CurrentVerticalTiltAngle),o.addOptionalCharacteristic(n.Characteristic.TargetHorizontalTiltAngle),o.addOptionalCharacteristic(n.Characteristic.TargetVerticalTiltAngle),o.addOptionalCharacteristic(n.Characteristic.NightVision),o.addOptionalCharacteristic(n.Characteristic.OpticalZoom),o.addOptionalCharacteristic(n.Characteristic.DigitalZoom),o.addOptionalCharacteristic(n.Characteristic.ImageRotation),o.addOptionalCharacteristic(n.Characteristic.ImageMirroring),o.addOptionalCharacteristic(n.Characteristic.Name),o}return i.__extends(t,e),t.UUID="00000111-0000-1000-8000-0026BB765291",t}(o.Service);t.CameraControl=C,o.Service.CameraControl=C;var S=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.EventSnapshotsActive),o.addCharacteristic(n.Characteristic.HomeKitCameraActive),o.addOptionalCharacteristic(n.Characteristic.CameraOperatingModeIndicator),o.addOptionalCharacteristic(n.Characteristic.ManuallyDisabled),o.addOptionalCharacteristic(n.Characteristic.NightVision),o.addOptionalCharacteristic(n.Characteristic.PeriodicSnapshotsActive),o.addOptionalCharacteristic(n.Characteristic.ThirdPartyCameraActive),o.addOptionalCharacteristic(n.Characteristic.DiagonalFieldOfView),o}return i.__extends(t,e),t.UUID="0000021A-0000-1000-8000-0026BB765291",t}(o.Service);t.CameraOperatingMode=S,o.Service.CameraOperatingMode=S;var E=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.Active),o.addCharacteristic(n.Characteristic.SelectedCameraRecordingConfiguration),o.addCharacteristic(n.Characteristic.SupportedAudioRecordingConfiguration),o.addCharacteristic(n.Characteristic.SupportedCameraRecordingConfiguration),o.addCharacteristic(n.Characteristic.SupportedVideoRecordingConfiguration),o.addOptionalCharacteristic(n.Characteristic.RecordingAudioActive),o}return i.__extends(t,e),t.UUID="00000204-0000-1000-8000-0026BB765291",t}(o.Service);t.CameraRecordingManagement=E,o.Service.CameraEventRecordingManagement=E,o.Service.CameraRecordingManagement=E;var _=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.SelectedRTPStreamConfiguration),o.addCharacteristic(n.Characteristic.SetupEndpoints),o.addCharacteristic(n.Characteristic.StreamingStatus),o.addCharacteristic(n.Characteristic.SupportedAudioStreamConfiguration),o.addCharacteristic(n.Characteristic.SupportedRTPConfiguration),o.addCharacteristic(n.Characteristic.SupportedVideoStreamConfiguration),o.addOptionalCharacteristic(n.Characteristic.Active),o}return i.__extends(t,e),t.UUID="00000110-0000-1000-8000-0026BB765291",t}(o.Service);t.CameraRTPStreamManagement=_,o.Service.CameraRTPStreamManagement=_;var T=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.CarbonDioxideDetected),o.addOptionalCharacteristic(n.Characteristic.CarbonDioxideLevel),o.addOptionalCharacteristic(n.Characteristic.CarbonDioxidePeakLevel),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.StatusActive),o.addOptionalCharacteristic(n.Characteristic.StatusFault),o.addOptionalCharacteristic(n.Characteristic.StatusLowBattery),o.addOptionalCharacteristic(n.Characteristic.StatusTampered),o}return i.__extends(t,e),t.UUID="00000097-0000-1000-8000-0026BB765291",t}(o.Service);t.CarbonDioxideSensor=T,o.Service.CarbonDioxideSensor=T;var A=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.CarbonMonoxideDetected),o.addOptionalCharacteristic(n.Characteristic.CarbonMonoxideLevel),o.addOptionalCharacteristic(n.Characteristic.CarbonMonoxidePeakLevel),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.StatusActive),o.addOptionalCharacteristic(n.Characteristic.StatusFault),o.addOptionalCharacteristic(n.Characteristic.StatusLowBattery),o.addOptionalCharacteristic(n.Characteristic.StatusTampered),o}return i.__extends(t,e),t.UUID="0000007F-0000-1000-8000-0026BB765291",t}(o.Service);t.CarbonMonoxideSensor=A,o.Service.CarbonMonoxideSensor=A;var I=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.RelayControlPoint),o.addCharacteristic(n.Characteristic.RelayState),o.addCharacteristic(n.Characteristic.RelayEnabled),o}return i.__extends(t,e),t.UUID="0000005A-0000-1000-8000-0026BB765291",t}(o.Service);t.CloudRelay=I,o.Service.Relay=I,o.Service.CloudRelay=I;var D=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.ContactSensorState),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.StatusActive),o.addOptionalCharacteristic(n.Characteristic.StatusFault),o.addOptionalCharacteristic(n.Characteristic.StatusLowBattery),o.addOptionalCharacteristic(n.Characteristic.StatusTampered),o}return i.__extends(t,e),t.UUID="00000080-0000-1000-8000-0026BB765291",t}(o.Service);t.ContactSensor=D,o.Service.ContactSensor=D;var w=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.SetupDataStreamTransport),o.addCharacteristic(n.Characteristic.SupportedDataStreamTransportConfiguration),o.addCharacteristic(n.Characteristic.Version),o}return i.__extends(t,e),t.UUID="00000129-0000-1000-8000-0026BB765291",t}(o.Service);t.DataStreamTransportManagement=w,o.Service.DataStreamTransportManagement=w;var b=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.SupportedDiagnosticsSnapshot),o.addOptionalCharacteristic(n.Characteristic.SelectedDiagnosticsModes),o.addOptionalCharacteristic(n.Characteristic.SupportedDiagnosticsModes),o}return i.__extends(t,e),t.UUID="00000237-0000-1000-8000-0026BB765291",t}(o.Service);t.Diagnostics=b,o.Service.Diagnostics=b;var U=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.CurrentPosition),o.addCharacteristic(n.Characteristic.PositionState),o.addCharacteristic(n.Characteristic.TargetPosition),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.ObstructionDetected),o.addOptionalCharacteristic(n.Characteristic.HoldPosition),o}return i.__extends(t,e),t.UUID="00000081-0000-1000-8000-0026BB765291",t}(o.Service);t.Door=U,o.Service.Door=U;var R=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.ProgrammableSwitchEvent),o.addOptionalCharacteristic(n.Characteristic.Brightness),o.addOptionalCharacteristic(n.Characteristic.Mute),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.OperatingStateResponse),o.addOptionalCharacteristic(n.Characteristic.Volume),o}return i.__extends(t,e),t.UUID="00000121-0000-1000-8000-0026BB765291",t}(o.Service);t.Doorbell=R,o.Service.Doorbell=R;var O=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.On),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.RotationDirection),o.addOptionalCharacteristic(n.Characteristic.RotationSpeed),o}return i.__extends(t,e),t.UUID="00000040-0000-1000-8000-0026BB765291",t}(o.Service);t.Fan=O,o.Service.Fan=O;var N=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.Active),o.addOptionalCharacteristic(n.Characteristic.CurrentFanState),o.addOptionalCharacteristic(n.Characteristic.TargetFanState),o.addOptionalCharacteristic(n.Characteristic.LockPhysicalControls),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.RotationDirection),o.addOptionalCharacteristic(n.Characteristic.RotationSpeed),o.addOptionalCharacteristic(n.Characteristic.SwingMode),o}return i.__extends(t,e),t.UUID="000000B7-0000-1000-8000-0026BB765291",t}(o.Service);t.Fanv2=N,o.Service.Fanv2=N;var P=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.Active),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.StatusFault),o}return i.__extends(t,e),t.UUID="000000D7-0000-1000-8000-0026BB765291",t}(o.Service);t.Faucet=P,o.Service.Faucet=P;var B=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.FilterChangeIndication),o.addOptionalCharacteristic(n.Characteristic.FilterLifeLevel),o.addOptionalCharacteristic(n.Characteristic.ResetFilterIndication),o.addOptionalCharacteristic(n.Characteristic.Name),o}return i.__extends(t,e),t.UUID="000000BA-0000-1000-8000-0026BB765291",t}(o.Service);t.FilterMaintenance=B,o.Service.FilterMaintenance=B;var L=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.FirmwareUpdateReadiness),o.addCharacteristic(n.Characteristic.FirmwareUpdateStatus),o.addOptionalCharacteristic(n.Characteristic.StagedFirmwareVersion),o.addOptionalCharacteristic(n.Characteristic.SupportedFirmwareUpdateConfiguration),o}return i.__extends(t,e),t.UUID="00000236-0000-1000-8000-0026BB765291",t}(o.Service);t.FirmwareUpdate=L,o.Service.FirmwareUpdate=L;var x=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.CurrentDoorState),o.addCharacteristic(n.Characteristic.TargetDoorState),o.addCharacteristic(n.Characteristic.ObstructionDetected),o.addOptionalCharacteristic(n.Characteristic.LockCurrentState),o.addOptionalCharacteristic(n.Characteristic.LockTargetState),o.addOptionalCharacteristic(n.Characteristic.Name),o}return i.__extends(t,e),t.UUID="00000041-0000-1000-8000-0026BB765291",t}(o.Service);t.GarageDoorOpener=x,o.Service.GarageDoorOpener=x;var M=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.Active),o.addCharacteristic(n.Characteristic.CurrentHeaterCoolerState),o.addCharacteristic(n.Characteristic.TargetHeaterCoolerState),o.addCharacteristic(n.Characteristic.CurrentTemperature),o.addOptionalCharacteristic(n.Characteristic.LockPhysicalControls),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.RotationSpeed),o.addOptionalCharacteristic(n.Characteristic.SwingMode),o.addOptionalCharacteristic(n.Characteristic.CoolingThresholdTemperature),o.addOptionalCharacteristic(n.Characteristic.HeatingThresholdTemperature),o.addOptionalCharacteristic(n.Characteristic.TemperatureDisplayUnits),o}return i.__extends(t,e),t.UUID="000000BC-0000-1000-8000-0026BB765291",t}(o.Service);t.HeaterCooler=M,o.Service.HeaterCooler=M;var F=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.Active),o.addCharacteristic(n.Characteristic.CurrentHumidifierDehumidifierState),o.addCharacteristic(n.Characteristic.TargetHumidifierDehumidifierState),o.addCharacteristic(n.Characteristic.CurrentRelativeHumidity),o.addOptionalCharacteristic(n.Characteristic.LockPhysicalControls),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.RelativeHumidityDehumidifierThreshold),o.addOptionalCharacteristic(n.Characteristic.RelativeHumidityHumidifierThreshold),o.addOptionalCharacteristic(n.Characteristic.RotationSpeed),o.addOptionalCharacteristic(n.Characteristic.SwingMode),o.addOptionalCharacteristic(n.Characteristic.WaterLevel),o}return i.__extends(t,e),t.UUID="000000BD-0000-1000-8000-0026BB765291",t}(o.Service);t.HumidifierDehumidifier=F,o.Service.HumidifierDehumidifier=F;var k=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.CurrentRelativeHumidity),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.StatusActive),o.addOptionalCharacteristic(n.Characteristic.StatusFault),o.addOptionalCharacteristic(n.Characteristic.StatusLowBattery),o.addOptionalCharacteristic(n.Characteristic.StatusTampered),o}return i.__extends(t,e),t.UUID="00000082-0000-1000-8000-0026BB765291",t}(o.Service);t.HumiditySensor=k,o.Service.HumiditySensor=k;var V=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.ConfiguredName),o.addCharacteristic(n.Characteristic.InputSourceType),o.addCharacteristic(n.Characteristic.IsConfigured),o.testCharacteristic(n.Characteristic.Name)||o.addCharacteristic(n.Characteristic.Name).updateValue("Unnamed Service"),o.addCharacteristic(n.Characteristic.CurrentVisibilityState),o.addOptionalCharacteristic(n.Characteristic.Identifier),o.addOptionalCharacteristic(n.Characteristic.InputDeviceType),o.addOptionalCharacteristic(n.Characteristic.TargetVisibilityState),o}return i.__extends(t,e),t.UUID="000000D9-0000-1000-8000-0026BB765291",t}(o.Service);t.InputSource=V,o.Service.InputSource=V;var H=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.Active),o.addCharacteristic(n.Characteristic.ProgramMode),o.addCharacteristic(n.Characteristic.InUse),o.addOptionalCharacteristic(n.Characteristic.RemainingDuration),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.StatusFault),o}return i.__extends(t,e),t.UUID="000000CF-0000-1000-8000-0026BB765291",t}(o.Service);t.IrrigationSystem=H,o.Service.IrrigationSystem=H;var j=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.LeakDetected),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.StatusActive),o.addOptionalCharacteristic(n.Characteristic.StatusFault),o.addOptionalCharacteristic(n.Characteristic.StatusLowBattery),o.addOptionalCharacteristic(n.Characteristic.StatusTampered),o}return i.__extends(t,e),t.UUID="00000083-0000-1000-8000-0026BB765291",t}(o.Service);t.LeakSensor=j,o.Service.LeakSensor=j;var G=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.On),o.addOptionalCharacteristic(n.Characteristic.Brightness),o.addOptionalCharacteristic(n.Characteristic.CharacteristicValueActiveTransitionCount),o.addOptionalCharacteristic(n.Characteristic.CharacteristicValueTransitionControl),o.addOptionalCharacteristic(n.Characteristic.ColorTemperature),o.addOptionalCharacteristic(n.Characteristic.Hue),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.Saturation),o.addOptionalCharacteristic(n.Characteristic.SupportedCharacteristicValueTransitionConfiguration),o}return i.__extends(t,e),t.UUID="00000043-0000-1000-8000-0026BB765291",t}(o.Service);t.Lightbulb=G,o.Service.Lightbulb=G;var W=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.CurrentAmbientLightLevel),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.StatusActive),o.addOptionalCharacteristic(n.Characteristic.StatusFault),o.addOptionalCharacteristic(n.Characteristic.StatusLowBattery),o.addOptionalCharacteristic(n.Characteristic.StatusTampered),o}return i.__extends(t,e),t.UUID="00000084-0000-1000-8000-0026BB765291",t}(o.Service);t.LightSensor=W,o.Service.LightSensor=W;var Y=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.LockControlPoint),o.addCharacteristic(n.Characteristic.Version),o.addOptionalCharacteristic(n.Characteristic.AdministratorOnlyAccess),o.addOptionalCharacteristic(n.Characteristic.AudioFeedback),o.addOptionalCharacteristic(n.Characteristic.CurrentDoorState),o.addOptionalCharacteristic(n.Characteristic.LockManagementAutoSecurityTimeout),o.addOptionalCharacteristic(n.Characteristic.LockLastKnownAction),o.addOptionalCharacteristic(n.Characteristic.Logs),o.addOptionalCharacteristic(n.Characteristic.MotionDetected),o}return i.__extends(t,e),t.UUID="00000044-0000-1000-8000-0026BB765291",t}(o.Service);t.LockManagement=Y,o.Service.LockManagement=Y;var q=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.LockCurrentState),o.addCharacteristic(n.Characteristic.LockTargetState),o.addOptionalCharacteristic(n.Characteristic.Name),o}return i.__extends(t,e),t.UUID="00000045-0000-1000-8000-0026BB765291",t}(o.Service);t.LockMechanism=q,o.Service.LockMechanism=q;var K=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.Mute),o.addOptionalCharacteristic(n.Characteristic.Volume),o}return i.__extends(t,e),t.UUID="00000112-0000-1000-8000-0026BB765291",t}(o.Service);t.Microphone=K,o.Service.Microphone=K;var $=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.MotionDetected),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.StatusActive),o.addOptionalCharacteristic(n.Characteristic.StatusFault),o.addOptionalCharacteristic(n.Characteristic.StatusLowBattery),o.addOptionalCharacteristic(n.Characteristic.StatusTampered),o}return i.__extends(t,e),t.UUID="00000085-0000-1000-8000-0026BB765291",t}(o.Service);t.MotionSensor=$,o.Service.MotionSensor=$;var z=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.ConfigurationState),o.addCharacteristic(n.Characteristic.NFCAccessControlPoint),o.addCharacteristic(n.Characteristic.NFCAccessSupportedConfiguration),o}return i.__extends(t,e),t.UUID="00000266-0000-1000-8000-0026BB765291",t}(o.Service);t.NFCAccess=z,o.Service.NFCAccess=z;var Q=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.OccupancyDetected),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.StatusActive),o.addOptionalCharacteristic(n.Characteristic.StatusFault),o.addOptionalCharacteristic(n.Characteristic.StatusLowBattery),o.addOptionalCharacteristic(n.Characteristic.StatusTampered),o}return i.__extends(t,e),t.UUID="00000086-0000-1000-8000-0026BB765291",t}(o.Service);t.OccupancySensor=Q,o.Service.OccupancySensor=Q;var X=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.On),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.OutletInUse),o}return i.__extends(t,e),t.UUID="00000047-0000-1000-8000-0026BB765291",t}(o.Service);t.Outlet=X,o.Service.Outlet=X;var J=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.ListPairings),o.addCharacteristic(n.Characteristic.PairSetup),o.addCharacteristic(n.Characteristic.PairVerify),o.addCharacteristic(n.Characteristic.PairingFeatures),o}return i.__extends(t,e),t.UUID="00000055-0000-1000-8000-0026BB765291",t}(o.Service);t.Pairing=J,o.Service.Pairing=J;var Z=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.WakeConfiguration),o.addOptionalCharacteristic(n.Characteristic.SelectedSleepConfiguration),o.addOptionalCharacteristic(n.Characteristic.SupportedSleepConfiguration),o}return i.__extends(t,e),t.UUID="00000221-0000-1000-8000-0026BB765291",t}(o.Service);t.PowerManagement=Z,o.Service.PowerManagement=Z;var ee=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.Version),o}return i.__extends(t,e),t.UUID="000000A2-0000-1000-8000-0026BB765291",t}(o.Service);t.ProtocolInformation=ee,o.Service.ProtocolInformation=ee;var te=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.SecuritySystemCurrentState),o.addCharacteristic(n.Characteristic.SecuritySystemTargetState),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.SecuritySystemAlarmType),o.addOptionalCharacteristic(n.Characteristic.StatusFault),o.addOptionalCharacteristic(n.Characteristic.StatusTampered),o}return i.__extends(t,e),t.UUID="0000007E-0000-1000-8000-0026BB765291",t}(o.Service);t.SecuritySystem=te,o.Service.SecuritySystem=te;var re=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.ServiceLabelNamespace),o}return i.__extends(t,e),t.UUID="000000CC-0000-1000-8000-0026BB765291",t}(o.Service);t.ServiceLabel=re,o.Service.ServiceLabel=re;var ie=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.SiriInputType),o.addOptionalCharacteristic(n.Characteristic.MultifunctionButton),o.addOptionalCharacteristic(n.Characteristic.SiriEnable),o.addOptionalCharacteristic(n.Characteristic.SiriEngineVersion),o.addOptionalCharacteristic(n.Characteristic.SiriLightOnUse),o.addOptionalCharacteristic(n.Characteristic.SiriListening),o.addOptionalCharacteristic(n.Characteristic.SiriTouchToUse),o}return i.__extends(t,e),t.UUID="00000133-0000-1000-8000-0026BB765291",t}(o.Service);t.Siri=ie,o.Service.Siri=ie;var ne=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.SiriEndpointSessionStatus),o.addCharacteristic(n.Characteristic.Version),o.addOptionalCharacteristic(n.Characteristic.ActiveIdentifier),o.addOptionalCharacteristic(n.Characteristic.ManuallyDisabled),o}return i.__extends(t,e),t.UUID="00000253-0000-1000-8000-0026BB765291",t}(o.Service);t.SiriEndpoint=ne,o.Service.SiriEndpoint=ne;var oe=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.CurrentSlatState),o.addCharacteristic(n.Characteristic.SlatType),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.SwingMode),o.addOptionalCharacteristic(n.Characteristic.CurrentTiltAngle),o.addOptionalCharacteristic(n.Characteristic.TargetTiltAngle),o}return i.__extends(t,e),t.UUID="000000B9-0000-1000-8000-0026BB765291",t}(o.Service);t.Slats=oe,o.Service.Slat=oe,o.Service.Slats=oe;var ae=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.CurrentMediaState),o.addCharacteristic(n.Characteristic.TargetMediaState),o.addOptionalCharacteristic(n.Characteristic.AirPlayEnable),o.addOptionalCharacteristic(n.Characteristic.ConfiguredName),o.addOptionalCharacteristic(n.Characteristic.Mute),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.Volume),o}return i.__extends(t,e),t.UUID="00000228-0000-1000-8000-0026BB765291",t}(o.Service);t.SmartSpeaker=ae,o.Service.SmartSpeaker=ae;var se=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.SmokeDetected),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.StatusActive),o.addOptionalCharacteristic(n.Characteristic.StatusFault),o.addOptionalCharacteristic(n.Characteristic.StatusLowBattery),o.addOptionalCharacteristic(n.Characteristic.StatusTampered),o}return i.__extends(t,e),t.UUID="00000087-0000-1000-8000-0026BB765291",t}(o.Service);t.SmokeSensor=se,o.Service.SmokeSensor=se;var ce=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.Mute),o.addOptionalCharacteristic(n.Characteristic.Active),o.addOptionalCharacteristic(n.Characteristic.Volume),o}return i.__extends(t,e),t.UUID="00000113-0000-1000-8000-0026BB765291",t}(o.Service);t.Speaker=ce,o.Service.Speaker=ce;var ue=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.ProgrammableSwitchEvent),o.addCharacteristic(n.Characteristic.ProgrammableSwitchOutputState),o.addOptionalCharacteristic(n.Characteristic.Name),o}return i.__extends(t,e),t.UUID="00000088-0000-1000-8000-0026BB765291",t}(o.Service);t.StatefulProgrammableSwitch=ue,o.Service.StatefulProgrammableSwitch=ue;var le=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.ProgrammableSwitchEvent),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.ServiceLabelIndex),o}return i.__extends(t,e),t.UUID="00000089-0000-1000-8000-0026BB765291",t}(o.Service);t.StatelessProgrammableSwitch=le,o.Service.StatelessProgrammableSwitch=le;var he=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.On),o.addOptionalCharacteristic(n.Characteristic.Name),o}return i.__extends(t,e),t.UUID="00000049-0000-1000-8000-0026BB765291",t}(o.Service);t.Switch=he,o.Service.Switch=he;var de=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.Active),o.addCharacteristic(n.Characteristic.CryptoHash),o.addCharacteristic(n.Characteristic.TapType),o.addCharacteristic(n.Characteristic.Token),o}return i.__extends(t,e),t.UUID="0000022E-0000-1000-8000-0026BB765291",t}(o.Service);t.TapManagement=de,o.Service.TapManagement=de;var pe=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.Active),o.addCharacteristic(n.Characteristic.ActiveIdentifier),o.addCharacteristic(n.Characteristic.ButtonEvent),o.addOptionalCharacteristic(n.Characteristic.Name),o}return i.__extends(t,e),t.UUID="00000125-0000-1000-8000-0026BB765291",t}(o.Service);t.TargetControl=pe,o.Service.TargetControl=pe;var fe=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.TargetControlSupportedConfiguration),o.addCharacteristic(n.Characteristic.TargetControlList),o}return i.__extends(t,e),t.UUID="00000122-0000-1000-8000-0026BB765291",t}(o.Service);t.TargetControlManagement=fe,o.Service.TargetControlManagement=fe;var ge=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.Active),o.addCharacteristic(n.Characteristic.ActiveIdentifier),o.addCharacteristic(n.Characteristic.ConfiguredName),o.addCharacteristic(n.Characteristic.RemoteKey),o.addCharacteristic(n.Characteristic.SleepDiscoveryMode),o.addOptionalCharacteristic(n.Characteristic.Brightness),o.addOptionalCharacteristic(n.Characteristic.ClosedCaptions),o.addOptionalCharacteristic(n.Characteristic.DisplayOrder),o.addOptionalCharacteristic(n.Characteristic.CurrentMediaState),o.addOptionalCharacteristic(n.Characteristic.TargetMediaState),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.PictureMode),o.addOptionalCharacteristic(n.Characteristic.PowerModeSelection),o}return i.__extends(t,e),t.UUID="000000D8-0000-1000-8000-0026BB765291",t}(o.Service);t.Television=ge,o.Service.Television=ge;var me=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.Mute),o.addOptionalCharacteristic(n.Characteristic.Active),o.addOptionalCharacteristic(n.Characteristic.Volume),o.addOptionalCharacteristic(n.Characteristic.VolumeControlType),o.addOptionalCharacteristic(n.Characteristic.VolumeSelector),o}return i.__extends(t,e),t.UUID="00000113-0000-1000-8000-0026BB765291",t}(o.Service);t.TelevisionSpeaker=me,o.Service.TelevisionSpeaker=me;var ve=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.CurrentTemperature),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.StatusActive),o.addOptionalCharacteristic(n.Characteristic.StatusFault),o.addOptionalCharacteristic(n.Characteristic.StatusLowBattery),o.addOptionalCharacteristic(n.Characteristic.StatusTampered),o}return i.__extends(t,e),t.UUID="0000008A-0000-1000-8000-0026BB765291",t}(o.Service);t.TemperatureSensor=ve,o.Service.TemperatureSensor=ve;var ye=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.CurrentHeatingCoolingState),o.addCharacteristic(n.Characteristic.TargetHeatingCoolingState),o.addCharacteristic(n.Characteristic.CurrentTemperature),o.addCharacteristic(n.Characteristic.TargetTemperature),o.addCharacteristic(n.Characteristic.TemperatureDisplayUnits),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.CurrentRelativeHumidity),o.addOptionalCharacteristic(n.Characteristic.TargetRelativeHumidity),o.addOptionalCharacteristic(n.Characteristic.CoolingThresholdTemperature),o.addOptionalCharacteristic(n.Characteristic.HeatingThresholdTemperature),o}return i.__extends(t,e),t.UUID="0000004A-0000-1000-8000-0026BB765291",t}(o.Service);t.Thermostat=ye,o.Service.Thermostat=ye;var Ce=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.CurrentTransport),o.addCharacteristic(n.Characteristic.ThreadControlPoint),o.addCharacteristic(n.Characteristic.ThreadNodeCapabilities),o.addCharacteristic(n.Characteristic.ThreadStatus),o.addOptionalCharacteristic(n.Characteristic.CCAEnergyDetectThreshold),o.addOptionalCharacteristic(n.Characteristic.CCASignalDetectThreshold),o.addOptionalCharacteristic(n.Characteristic.EventRetransmissionMaximum),o.addOptionalCharacteristic(n.Characteristic.EventTransmissionCounters),o.addOptionalCharacteristic(n.Characteristic.MACRetransmissionMaximum),o.addOptionalCharacteristic(n.Characteristic.MACTransmissionCounters),o.addOptionalCharacteristic(n.Characteristic.ReceiverSensitivity),o.addOptionalCharacteristic(n.Characteristic.ReceivedSignalStrengthIndication),o.addOptionalCharacteristic(n.Characteristic.SignalToNoiseRatio),o.addOptionalCharacteristic(n.Characteristic.ThreadOpenThreadVersion),o.addOptionalCharacteristic(n.Characteristic.TransmitPower),o.addOptionalCharacteristic(n.Characteristic.MaximumTransmitPower),o}return i.__extends(t,e),t.UUID="00000701-0000-1000-8000-0026BB765291",t}(o.Service);t.ThreadTransport=Ce,o.Service.ThreadTransport=Ce;var Se=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.CurrentTime),o.addCharacteristic(n.Characteristic.DayoftheWeek),o.addCharacteristic(n.Characteristic.TimeUpdate),o.addOptionalCharacteristic(n.Characteristic.Name),o}return i.__extends(t,e),t.UUID="00000099-0000-1000-8000-0026BB765291",t}(o.Service);t.TimeInformation=Se,o.Service.TimeInformation=Se;var Ee=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.SupportedTransferTransportConfiguration),o.addCharacteristic(n.Characteristic.SetupTransferTransport),o}return i.__extends(t,e),t.UUID="00000203-0000-1000-8000-0026BB765291",t}(o.Service);t.TransferTransportManagement=Ee,o.Service.TransferTransportManagement=Ee;var _e=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.AccessoryIdentifier),o.addCharacteristic(n.Characteristic.TunnelConnectionTimeout),o.addCharacteristic(n.Characteristic.TunneledAccessoryAdvertising),o.addCharacteristic(n.Characteristic.TunneledAccessoryConnected),o.addCharacteristic(n.Characteristic.TunneledAccessoryStateNumber),o}return i.__extends(t,e),t.UUID="00000056-0000-1000-8000-0026BB765291",t}(o.Service);t.Tunnel=_e,o.Service.TunneledBTLEAccessoryService=_e,o.Service.Tunnel=_e;var Te=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.Active),o.addCharacteristic(n.Characteristic.InUse),o.addCharacteristic(n.Characteristic.ValveType),o.addOptionalCharacteristic(n.Characteristic.IsConfigured),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.RemainingDuration),o.addOptionalCharacteristic(n.Characteristic.ServiceLabelIndex),o.addOptionalCharacteristic(n.Characteristic.SetDuration),o.addOptionalCharacteristic(n.Characteristic.StatusFault),o}return i.__extends(t,e),t.UUID="000000D0-0000-1000-8000-0026BB765291",t}(o.Service);t.Valve=Te,o.Service.Valve=Te;var Ae=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.ConfiguredName),o.addCharacteristic(n.Characteristic.ManagedNetworkEnable),o.addCharacteristic(n.Characteristic.NetworkAccessViolationControl),o.addCharacteristic(n.Characteristic.NetworkClientProfileControl),o.addCharacteristic(n.Characteristic.NetworkClientStatusControl),o.addCharacteristic(n.Characteristic.RouterStatus),o.addCharacteristic(n.Characteristic.SupportedRouterConfiguration),o.addCharacteristic(n.Characteristic.WANConfigurationList),o.addCharacteristic(n.Characteristic.WANStatusList),o}return i.__extends(t,e),t.UUID="0000020A-0000-1000-8000-0026BB765291",t}(o.Service);t.WiFiRouter=Ae,o.Service.WiFiRouter=Ae;var Ie=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.WiFiSatelliteStatus),o}return i.__extends(t,e),t.UUID="0000020F-0000-1000-8000-0026BB765291",t}(o.Service);t.WiFiSatellite=Ie,o.Service.WiFiSatellite=Ie;var De=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.CurrentTransport),o.addCharacteristic(n.Characteristic.WiFiCapabilities),o.addOptionalCharacteristic(n.Characteristic.WiFiConfigurationControl),o}return i.__extends(t,e),t.UUID="0000022A-0000-1000-8000-0026BB765291",t}(o.Service);t.WiFiTransport=De,o.Service.WiFiTransport=De;var we=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.CurrentPosition),o.addCharacteristic(n.Characteristic.PositionState),o.addCharacteristic(n.Characteristic.TargetPosition),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.ObstructionDetected),o.addOptionalCharacteristic(n.Characteristic.HoldPosition),o}return i.__extends(t,e),t.UUID="0000008B-0000-1000-8000-0026BB765291",t}(o.Service);t.Window=we,o.Service.Window=we;var be=function(e){function t(r,i){var o=e.call(this,r,t.UUID,i)||this;return o.addCharacteristic(n.Characteristic.CurrentPosition),o.addCharacteristic(n.Characteristic.PositionState),o.addCharacteristic(n.Characteristic.TargetPosition),o.addOptionalCharacteristic(n.Characteristic.CurrentHorizontalTiltAngle),o.addOptionalCharacteristic(n.Characteristic.TargetHorizontalTiltAngle),o.addOptionalCharacteristic(n.Characteristic.Name),o.addOptionalCharacteristic(n.Characteristic.ObstructionDetected),o.addOptionalCharacteristic(n.Characteristic.HoldPosition),o.addOptionalCharacteristic(n.Characteristic.CurrentVerticalTiltAngle),o.addOptionalCharacteristic(n.Characteristic.TargetVerticalTiltAngle),o}return i.__extends(t,e),t.UUID="0000008C-0000-1000-8000-0026BB765291",t}(o.Service);t.WindowCovering=be,o.Service.WindowCovering=be},8086:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(1635);i.__exportStar(r(651),t),i.__exportStar(r(1647),t)},5579:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AccessoryInfo=t.PermissionTypes=void 0;var i,n=r(1635),o=n.__importDefault(r(2613)),a=n.__importDefault(r(6982)),s=n.__importDefault(r(8947)),c=n.__importDefault(r(9023)),u=r(9593),l=r(4299);function h(){return r(8389).version}!function(e){e[e.USER=0]="USER",e[e.ADMIN=1]="ADMIN"}(i||(t.PermissionTypes=i={}));var d=function(){function e(e){var t=this;this.configVersion=1,this.lastFirmwareVersion="",this.paired=function(){return Object.keys(t.pairedClients).length>0},this.username=e,this.displayName="",this.model="",this.category=1,this.pincode="",this.signSk=Buffer.alloc(0),this.signPk=Buffer.alloc(0),this.pairedClients={},this.pairedAdminClients=0,this.configHash="",this.setupID=""}return e.prototype.addPairedClient=function(e,t,r){this.pairedClients[e]={username:e,publicKey:t,permission:r},1===r&&this.pairedAdminClients++},e.prototype.updatePermission=function(e,t){var r=this.pairedClients[e];if(r){var i=r.permission;r.permission=t,1===i&&1!==t?this.pairedAdminClients--:1!==i&&1===t&&this.pairedAdminClients++}},e.prototype.listPairings=function(){var e,t,r=[];try{for(var i=n.__values(Object.values(this.pairedClients)),o=i.next();!o.done;o=i.next()){var a=o.value;r.push(a)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return r},e.prototype.removePairedClient=function(e,t){var r,i;if(this._removePairedClient0(e,t),0===this.pairedAdminClients)try{for(var o=n.__values(Object.keys(this.pairedClients)),a=o.next();!a.done;a=o.next()){var s=a.value;this._removePairedClient0(e,s)}}catch(e){r={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}},e.prototype._removePairedClient0=function(e,t){this.pairedClients[t]&&1===this.pairedClients[t].permission&&this.pairedAdminClients--,delete this.pairedClients[t],u.EventedHTTPServer.destroyExistingConnectionsAfterUnpair(e,t)},e.prototype.isPaired=function(e){return!!this.pairedClients[e]},e.prototype.hasAdminPermissions=function(e){if(!e)return!1;var t=this.pairedClients[e];return!!t&&1===t.permission},e.prototype.getClientPublicKey=function(e){var t=this.pairedClients[e];return t?t.publicKey:void 0},e.prototype.checkForCurrentConfigurationNumberIncrement=function(e,t){var r=a.default.createHash("sha1");r.update(JSON.stringify(e));var i=r.digest("hex"),n=!1;if(i!==this.configHash&&(this.configVersion++,this.configHash=i,this.ensureConfigVersionBounds(),n=!0),t){var o=h();this.lastFirmwareVersion!==o&&(this.lastFirmwareVersion=o,n=!0)}return n&&this.save(),n},e.prototype.getConfigVersion=function(){return this.configVersion},e.prototype.ensureConfigVersionBounds=function(){this.configVersion=this.configVersion%65536,0===this.configVersion&&(this.configVersion=1)},e.prototype.save=function(){var t,r,i={displayName:this.displayName,category:this.category,pincode:this.pincode,signSk:this.signSk.toString("hex"),signPk:this.signPk.toString("hex"),pairedClients:{},pairedClientsPermission:{},configVersion:this.configVersion,configHash:this.configHash,setupID:this.setupID,lastFirmwareVersion:this.lastFirmwareVersion};try{for(var o=n.__values(Object.entries(this.pairedClients)),a=o.next();!a.done;a=o.next()){var s=n.__read(a.value,2),c=s[0],u=s[1];i.pairedClients[c]=u.publicKey.toString("hex"),i.pairedClientsPermission[c]=u.permission}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}var h=e.persistKey(this.username);l.HAPStorage.storage().setItemSync(h,i)},e.persistKey=function(e){return c.default.format("AccessoryInfo.%s.json",e.replace(/:/g,"").toUpperCase())},e.create=function(t){e.assertValidUsername(t);var r=new e(t);r.lastFirmwareVersion=h();var i=s.default.sign.keyPair();return r.signSk=Buffer.from(i.secretKey),r.signPk=Buffer.from(i.publicKey),r},e.load=function(t){var r,i;e.assertValidUsername(t);var o=e.persistKey(t),a=l.HAPStorage.storage().getItem(o);if(a){var s=new e(t);s.displayName=a.displayName||"",s.category=a.category||"",s.pincode=a.pincode||"",s.signSk=Buffer.from(a.signSk||"","hex"),s.signPk=Buffer.from(a.signPk||"","hex"),s.pairedClients={};try{for(var c=n.__values(Object.keys(a.pairedClients||{})),u=c.next();!u.done;u=c.next()){var d=u.value,p=a.pairedClients[d],f=a.pairedClientsPermission?a.pairedClientsPermission[d]:void 0;void 0===f&&(f=1),s.pairedClients[d]={username:d,publicKey:Buffer.from(p,"hex"),permission:f},1===f&&s.pairedAdminClients++}}catch(e){r={error:e}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}return s.configVersion=a.configVersion||1,s.configHash=a.configHash||"",s.setupID=a.setupID||"",s.lastFirmwareVersion=a.lastFirmwareVersion||h(),s.ensureConfigVersionBounds(),s}return null},e.remove=function(t){var r=e.persistKey(t);l.HAPStorage.storage().removeItemSync(r)},e.assertValidUsername=function(t){o.default.ok(e.deviceIdPattern.test(t),"The supplied username ("+t+") is not valid (expected a format like 'XX:XX:XX:XX:XX:XX' with XX being a valid hexadecimal string). Note that, if you had this accessory already paired with the invalid username, you will need to repair the accessory and reconfigure your services in the Home app. Using an invalid username will lead to unexpected behaviour.")},e.deviceIdPattern=/^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$/,e}();t.AccessoryInfo=d},292:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ControllerStorage=void 0;var i=r(1635),n=i.__importDefault(r(9023)),o=i.__importDefault(r(5753)),a=r(4299),s=(0,o.default)("HAP-NodeJS:ControllerStorage"),c=function(){function e(e){this.initialized=!1,this.fileCreated=!1,this.purgeUnidentifiedAccessoryData=!0,this.trackedControllers=[],this.controllerData={},this.accessoryUUID=e.UUID}return e.prototype.enqueueSaveRequest=function(e){var t,r=this;if(void 0===e&&(e=0),this.parent)this.parent.enqueueSaveRequest(e);else{var i=Date.now()+e;if(this.queuedSaveTimeout){if(i<=(null!==(t=this.queuedSaveTime)&&void 0!==t?t:0))return;clearTimeout(this.queuedSaveTimeout)}this.queuedSaveTimeout=setTimeout((function(){r.queuedSaveTimeout=r.queuedSaveTime=void 0,r.save()}),e).unref(),this.queuedSaveTime=Date.now()+e}},e.prototype.linkAccessory=function(e){this.linkedAccessories||(this.linkedAccessories=[]);var t=e.controllerStorage;this.linkedAccessories.push(t),t.parent=this;var r=this.restoredAccessories&&this.restoredAccessories[e.UUID];this.initialized&&t.init(r)},e.prototype.trackController=function(e){e.setupStateChangeDelegate(this.handleStateChange.bind(this,e)),this.initialized?this.restoreController(e):this.trackedControllers.push(e)},e.prototype.untrackController=function(e){var t=this.trackedControllers.indexOf(e);-1!==t&&this.trackedControllers.splice(t,1),e.setupStateChangeDelegate(void 0),this.purgeControllerData(e)},e.prototype.purgeControllerData=function(e){delete this.controllerData[e.controllerId()],this.initialized&&this.enqueueSaveRequest(100)},e.prototype.handleStateChange=function(e){var t=e.controllerId(),r=e.serialize();if(r){var i=this.controllerData[t];i?i.data=r:this.controllerData[t]={data:r}}else delete this.controllerData[t];this.initialized&&this.enqueueSaveRequest(100)},e.prototype.restoreController=function(e){if(!this.initialized)throw new Error("Illegal state. Controller data wasn't loaded yet!");var t=this.controllerData[e.controllerId()];if(t){try{e.deserialize(t.data)}catch(t){console.warn("Could not initialize controller of type '".concat(e.controllerId(),"' from data stored on disk. Resetting to default: ").concat(t.stack)),e.handleFactoryReset()}t.purgeOnNextLoad=void 0}},e.prototype.init=function(e){var t=this;if(this.initialized)throw new Error("ControllerStorage for accessory ".concat(this.accessoryUUID," was already initialized!"));this.initialized=!0,e&&e.forEach((function(e){return t.controllerData[e.type]=e.controllerData}));var r=[];this.trackedControllers.forEach((function(e){t.restoreController(e),r.push(e.controllerId())})),this.trackedControllers.splice(0,this.trackedControllers.length);var n=!1;Object.entries(this.controllerData).forEach((function(e){var o=i.__read(e,2),a=o[0],s=o[1];if(s.purgeOnNextLoad)return delete t.controllerData[a],void(n=!0);r.includes(a)||(s.purgeOnNextLoad=!0)})),n&&this.enqueueSaveRequest(500)},e.prototype.load=function(t){if(this.username)throw new Error("ControllerStorage was already loaded!");this.username=t;var r,i=e.persistKey(t),n=a.HAPStorage.storage().getItem(i);n&&(this.fileCreated=!0,r=n.accessories[this.accessoryUUID],delete n.accessories[this.accessoryUUID]),this.init(r),this.linkedAccessories&&this.linkedAccessories.forEach((function(e){var t=n&&n.accessories[e.accessoryUUID];e.init(t),n&&delete n.accessories[e.accessoryUUID]})),n&&Object.keys(n.accessories).length>0&&(this.purgeUnidentifiedAccessoryData?s("Purging unidentified controller data for bridge %s",t):this.restoredAccessories=n.accessories)},e.prototype.save=function(){var t;if(this.parent)this.parent.save();else{if(!this.initialized)throw new Error("ControllerStorage has not yet been loaded!");if(!this.username)throw new Error("Cannot save controllerData for a storage without a username!");var r=((t={})[this.accessoryUUID]=this.controllerData,t);this.linkedAccessories&&this.linkedAccessories.forEach((function(e){return r[e.accessoryUUID]=e.controllerData}));var n=this.restoredAccessories||{};Object.entries(r).forEach((function(e){var t=i.__read(e,2),r=t[0],o=t[1],a=Object.entries(o);a.length>0&&(n[r]=a.map((function(e){var t=i.__read(e,2);return{type:t[0],controllerData:t[1]}})))}));var o=e.persistKey(this.username);if(Object.keys(n).length>0){var s={accessories:n};this.fileCreated=!0,a.HAPStorage.storage().setItemSync(o,s)}else this.fileCreated&&(this.fileCreated=!1,a.HAPStorage.storage().removeItemSync(o))}},e.persistKey=function(e){return n.default.format("ControllerStorage.%s.json",e.replace(/:/g,"").toUpperCase())},e.remove=function(t){var r=e.persistKey(t);a.HAPStorage.storage().removeItemSync(r)},e}();t.ControllerStorage=c},4299:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HAPStorage=void 0;var i=r(1635).__importDefault(r(3396)),n=function(){function e(){}return e.storage=function(){return this.INSTANCE.storage()},e.setCustomStoragePath=function(e){this.INSTANCE.setCustomStoragePath(e)},e.prototype.storage=function(){return this.localStore||(this.localStore=i.default.create(),this.customStoragePath?this.localStore.initSync({dir:this.customStoragePath}):this.localStore.initSync()),this.localStore},e.prototype.setCustomStoragePath=function(e){if(this.localStore)throw new Error("Cannot change storage path after it has already been initialized!");this.customStoragePath=e},e.INSTANCE=new e,e}();t.HAPStorage=n},2738:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdentifierCache=void 0;var i=r(1635),n=i.__importDefault(r(6982)),o=i.__importDefault(r(9023)),a=r(4299),s=function(){function e(e){this.username=e,this._cache={},this._usedCache=null,this._savedCacheHash=""}return e.prototype.startTrackingUsage=function(){this._usedCache={}},e.prototype.stopTrackingUsageAndExpireUnused=function(){this._cache=this._usedCache||this._cache,this._usedCache=null},e.prototype.getCache=function(e){var t=this._cache[e];return this._usedCache&&void 0!==t&&(this._usedCache[e]=t),t},e.prototype.setCache=function(e,t){return this._cache[e]=t,this._usedCache&&(this._usedCache[e]=t),t},e.prototype.getAID=function(e){var t=e;return this.getCache("|nextAID"),this.getCache(t)||this.setCache(t,this.getNextAID())},e.prototype.getIID=function(e,t,r,i){var n=e+"|"+t+(r?"|"+r:"")+(i?"|"+i:"");return this.getCache(e+"|nextIID"),this.getCache(n)||this.setCache(n,this.getNextIID(e))},e.prototype.getNextAID=function(){var e="|nextAID",t=this.getCache(e)||2;return this.setCache(e,t+1),t},e.prototype.getNextIID=function(e){var t=e+"|nextIID",r=this.getCache(t)||2;return this.setCache(t,r+1),r},e.prototype.save=function(){var t=n.default.createHash("sha1").update(JSON.stringify(this._cache)).digest("hex");if(t!==this._savedCacheHash){var r={cache:this._cache},i=e.persistKey(this.username);a.HAPStorage.storage().setItemSync(i,r),this._savedCacheHash=t}},e.persistKey=function(e){return o.default.format("IdentifierCache.%s.json",e.replace(/:/g,"").toUpperCase())},e.load=function(t){var r=e.persistKey(t),i=a.HAPStorage.storage().getItem(r);if(i){var o=new e(t);return o._cache=i.cache,o._savedCacheHash=n.default.createHash("sha1").update(JSON.stringify(o._cache)).digest("hex"),o}return null},e.remove=function(e){var t=this.persistKey(e);a.HAPStorage.storage().removeItemSync(t)},e}();t.IdentifierCache=s},4910:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AccessControlManagement=t.AccessControlEvent=t.AccessLevel=void 0;var i,n,o,a=r(1635),s=r(4434),c=r(9826),u=r(5876),l=a.__importStar(r(3314));!function(e){e[e.PASSWORD=1]="PASSWORD",e[e.PASSWORD_REQUIRED=2]="PASSWORD_REQUIRED"}(i||(i={})),function(e){e[e.ANYONE=0]="ANYONE",e[e.HOME_MEMBERS_ONLY=1]="HOME_MEMBERS_ONLY"}(n||(t.AccessLevel=n={})),function(e){e.ACCESS_LEVEL_UPDATED="update-control-level",e.PASSWORD_SETTING_UPDATED="update-password"}(o||(t.AccessControlEvent=o={}));var h=function(e){function t(t,r){var i=e.call(this)||this;return i.accessLevel=0,i.passwordRequired=!1,i.accessControlService=r||new u.Service.AccessControl,i.setupServiceHandlers(t),i}return a.__extends(t,e),t.prototype.getService=function(){return this.accessControlService},t.prototype.getAccessLevel=function(){return this.accessLevel},t.prototype.getPassword=function(){return this.passwordRequired?this.password:void 0},t.prototype.destroy=function(){this.removeAllListeners(),this.accessControlService.getCharacteristic(c.Characteristic.AccessControlLevel).removeOnSet(),this.accessControlService.testCharacteristic(c.Characteristic.PasswordSetting)&&this.accessControlService.getCharacteristic(c.Characteristic.PasswordSetting).removeOnSet()},t.prototype.handleAccessLevelChange=function(e){var t=this;this.accessLevel=e,setTimeout((function(){t.emit("update-control-level",t.accessLevel)}),0).unref()},t.prototype.handlePasswordChange=function(e){var t=this,r=Buffer.from(e,"base64"),i=l.decode(r);i[1]?this.password=i[1].toString("utf8"):this.password=void 0,this.passwordRequired=!!i[2][0],setTimeout((function(){t.emit("update-password",t.password,t.passwordRequired)}),0).unref()},t.prototype.setupServiceHandlers=function(e){var t=this;this.accessControlService.getCharacteristic(c.Characteristic.AccessControlLevel).onSet((function(e){return t.handleAccessLevelChange(e)})).updateValue(0),e&&this.accessControlService.getCharacteristic(c.Characteristic.PasswordSetting).onSet((function(e){return t.handlePasswordChange(e)})).updateValue("")},t}(s.EventEmitter);t.AccessControlManagement=h},9621:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clone=void 0;var i=r(1635);t.clone=function(e,t){var r,n,o,a,s={};try{for(var c=i.__values(Object.entries(e)),u=c.next();!u.done;u=c.next()){var l=i.__read(u.value,2),h=l[0],d=l[1];s[h]=d}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}if(t)try{for(var p=i.__values(Object.entries(t)),f=p.next();!f.done;f=p.next()){var g=i.__read(f.value,2);h=g[0],d=g[1];s[h]=d}}catch(e){o={error:e}}finally{try{f&&!f.done&&(a=p.return)&&a.call(p)}finally{if(o)throw o.error}}return s}},2175:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorUtils=void 0;var i=r(1635).__importDefault(r(2613)),n=new Map([[100,[19,222.1]],[101,[18.7,222.2]],[102,[18.4,222.3]],[103,[18.2,222.3]],[104,[17.9,222.4]],[105,[17.6,222.5]],[106,[17.3,222.7]],[107,[17,222.8]],[108,[16.7,222.9]],[109,[16.4,223]],[110,[16.1,223.2]],[111,[15.8,223.3]],[112,[15.4,223.4]],[113,[15.2,223.6]],[114,[14.9,223.8]],[115,[14.7,223.9]],[116,[14.3,224.1]],[117,[14.1,224.2]],[118,[13.8,224.4]],[119,[13.5,224.6]],[120,[13.2,224.8]],[121,[12.9,225]],[122,[12.5,225.3]],[123,[12.2,225.6]],[124,[11.8,225.9]],[125,[11.4,226.3]],[126,[11.1,226.7]],[127,[10.7,227.1]],[128,[10.3,227.6]],[129,[9.9,228]],[130,[9.6,228.5]],[131,[9.3,229.1]],[132,[8.9,229.6]],[133,[8.5,230.2]],[134,[8.2,230.9]],[135,[7.8,231.6]],[136,[7.5,232.5]],[137,[7.1,233.5]],[138,[6.7,234.6]],[139,[6.3,235.8]],[140,[6,237.1]],[141,[5.6,238.9]],[142,[5.2,240.9]],[143,[5,242.9]],[144,[4.8,244.9]],[145,[4.6,246.9]],[146,[4.4,249.3]],[147,[4.3,251.9]],[148,[4.1,254.9]],[149,[3.9,258]],[150,[3.7,261.8]],[151,[3.4,265.9]],[152,[3.2,271]],[153,[3,276.4]],[154,[2.8,283.6]],[155,[2.6,290.4]],[156,[2.3,295.3]],[157,[2.1,300]],[158,[1.9,300]],[159,[1.6,300]],[160,[1.4,195.8]],[161,[1.2,84.3]],[162,[1.3,58.2]],[163,[1.5,55.9]],[164,[1.7,53.2]],[165,[1.9,50.2]],[166,[2.1,47.1]],[167,[2.4,44.5]],[168,[2.6,42.6]],[169,[2.9,40.9]],[170,[3.1,39.5]],[171,[3.4,38.3]],[172,[3.7,37.3]],[173,[3.9,36.5]],[174,[4.2,35.7]],[175,[4.4,35.1]],[176,[4.6,34.5]],[177,[4.9,34]],[178,[5.1,33.5]],[179,[5.3,33]],[180,[5.6,32.7]],[181,[5.8,32.3]],[182,[6,32]],[183,[6.3,31.7]],[184,[6.5,31.4]],[185,[6.7,31.2]],[186,[7,30.9]],[187,[7.2,30.7]],[188,[7.4,30.5]],[189,[7.6,30.3]],[190,[7.9,30.1]],[191,[8.1,29.9]],[192,[8.4,29.7]],[193,[8.6,29.6]],[194,[8.9,29.5]],[195,[9.1,29.3]],[196,[9.4,29.2]],[197,[9.6,29.1]],[198,[9.8,29]],[199,[10,28.9]],[200,[10.2,28.7]],[201,[10.5,28.7]],[202,[10.7,28.6]],[203,[11,28.5]],[204,[11.2,28.4]],[205,[11.4,28.3]],[206,[11.6,28.3]],[207,[11.8,28.2]],[208,[12.1,28.1]],[209,[12.3,28.1]],[210,[12.5,28]],[211,[12.7,28]],[212,[12.9,27.9]],[213,[13.2,27.8]],[214,[13.4,27.8]],[215,[13.6,27.7]],[216,[13.8,27.7]],[217,[14,27.7]],[218,[14.3,27.6]],[219,[14.5,27.6]],[220,[14.7,27.5]],[221,[14.9,27.5]],[222,[15.1,27.5]],[223,[15.3,27.4]],[224,[15.5,27.4]],[225,[15.8,27.4]],[226,[16,27.3]],[227,[16.2,27.3]],[228,[16.4,27.3]],[229,[16.6,27.3]],[230,[16.8,27.2]],[231,[17,27.2]],[232,[17.2,27.2]],[233,[17.4,27.2]],[234,[17.6,27.2]],[235,[17.8,27.1]],[236,[18,27.1]],[237,[18.2,27.1]],[238,[18.4,27.1]],[239,[18.7,27.1]],[240,[18.8,27]],[241,[19,27]],[242,[19.2,27]],[243,[19.4,27]],[244,[19.6,27]],[245,[19.8,27]],[246,[20,27]],[247,[20.3,26.9]],[248,[20.5,26.9]],[249,[20.6,26.9]],[250,[20.8,26.9]],[251,[21,26.9]],[252,[21.3,26.9]],[253,[21.5,26.9]],[254,[21.6,26.9]],[255,[21.8,26.8]],[256,[22,26.8]],[257,[22.2,26.8]],[258,[22.4,26.8]],[259,[22.6,26.8]],[260,[22.8,26.8]],[261,[23,26.8]],[262,[23.2,26.8]],[263,[23.4,26.8]],[264,[23.6,26.8]],[265,[23.8,26.8]],[266,[24,26.8]],[267,[24.1,26.8]],[268,[24.3,26.8]],[269,[24.5,26.8]],[270,[24.7,26.8]],[271,[24.8,26.8]],[272,[25.1,26.7]],[273,[25.3,26.7]],[274,[25.4,26.7]],[275,[25.6,26.7]],[276,[25.8,26.7]],[277,[26,26.7]],[278,[26.1,26.7]],[279,[26.3,26.7]],[280,[26.5,26.7]],[281,[26.7,26.7]],[282,[26.9,26.7]],[283,[27.1,26.7]],[284,[27.3,26.7]],[285,[27.5,26.7]],[286,[27.7,26.7]],[287,[27.8,26.7]],[288,[28,26.7]],[289,[28.2,26.7]],[290,[28.4,26.7]],[291,[28.6,26.7]],[292,[28.8,26.7]],[293,[28.9,26.7]],[294,[29.1,26.7]],[295,[29.3,26.7]],[296,[29.5,26.7]],[297,[29.6,26.7]],[298,[29.8,26.7]],[299,[30,26.7]],[300,[30.2,26.7]],[301,[30.4,26.7]],[302,[30.5,26.7]],[303,[30.7,26.7]],[304,[30.9,26.7]],[305,[31.1,26.7]],[306,[31.2,26.7]],[307,[31.4,26.7]],[308,[31.6,26.7]],[309,[31.8,26.8]],[310,[31.9,26.8]],[311,[32.1,26.8]],[312,[32.3,26.8]],[313,[32.5,26.8]],[314,[32.6,26.8]],[315,[32.8,26.8]],[316,[33,26.8]],[317,[33.2,26.8]],[318,[33.3,26.8]],[319,[33.5,26.8]],[320,[33.7,26.8]],[321,[33.8,26.8]],[322,[34,26.8]],[323,[34.2,26.8]],[324,[34.4,26.8]],[325,[34.5,26.8]],[326,[34.7,26.8]],[327,[34.9,26.8]],[328,[35.1,26.8]],[329,[35.2,26.8]],[330,[35.4,26.8]],[331,[35.5,26.8]],[332,[35.7,26.8]],[333,[35.9,26.8]],[334,[36.1,26.8]],[335,[36.3,26.9]],[336,[36.5,26.9]],[337,[36.7,26.9]],[338,[36.9,26.9]],[339,[37.1,26.9]],[340,[37.2,26.9]],[341,[37.4,26.9]],[342,[37.5,26.9]],[343,[37.7,26.9]],[344,[37.9,26.9]],[345,[38.1,26.9]],[346,[38.3,26.9]],[347,[38.5,26.9]],[348,[38.7,26.9]],[349,[38.9,26.9]],[350,[39,26.9]],[351,[39.2,26.9]],[352,[39.3,27]],[353,[39.5,27]],[354,[39.7,27]],[355,[39.9,27]],[356,[40.1,27]],[357,[40.2,27]],[358,[40.4,27]],[359,[40.6,27]],[360,[40.8,27]],[361,[40.9,27]],[362,[41.1,27]],[363,[41.2,27]],[364,[41.4,27]],[365,[41.6,27]],[366,[41.8,27]],[367,[42,27]],[368,[42.1,27.1]],[369,[42.3,27.1]],[370,[42.4,27.1]],[371,[42.6,27.1]],[372,[42.8,27.1]],[373,[43,27.1]],[374,[43.1,27.1]],[375,[43.2,27.1]],[376,[43.4,27.1]],[377,[43.6,27.1]],[378,[43.8,27.1]],[379,[43.9,27.1]],[380,[44.1,27.1]],[381,[44.3,27.2]],[382,[44.4,27.2]],[383,[44.6,27.2]],[384,[44.7,27.2]],[385,[44.9,27.2]],[386,[45.1,27.2]],[387,[45.3,27.2]],[388,[45.5,27.2]],[389,[45.6,27.2]],[390,[45.8,27.2]],[391,[46,27.2]],[392,[46.2,27.2]],[393,[46.4,27.3]],[394,[46.5,27.3]],[395,[46.7,27.3]],[396,[46.9,27.3]],[397,[47.1,27.3]],[398,[47.2,27.3]],[399,[47.4,27.3]],[400,[47.6,27.3]],[401,[47.7,27.3]],[402,[47.9,27.3]],[403,[48.1,27.3]],[404,[48.3,27.3]],[405,[48.5,27.4]],[406,[48.7,27.4]],[407,[48.8,27.4]],[408,[49,27.4]],[409,[49.2,27.4]],[410,[49.4,27.4]],[411,[49.6,27.4]],[412,[49.7,27.4]],[413,[49.9,27.4]],[414,[50.1,27.4]],[415,[50.2,27.4]],[416,[50.4,27.4]],[417,[50.6,27.5]],[418,[50.7,27.5]],[419,[50.9,27.5]],[420,[51.1,27.5]],[421,[51.2,27.5]],[422,[51.4,27.5]],[423,[51.6,27.5]],[424,[51.7,27.5]],[425,[51.9,27.5]],[426,[52.1,27.5]],[427,[51.2,27.6]],[428,[52.4,27.6]],[429,[52.5,27.6]],[430,[52.7,27.6]],[431,[52.9,27.6]],[432,[53.1,27.6]],[433,[53.2,27.6]],[434,[53.4,27.6]],[435,[53.6,27.6]],[436,[53.7,27.6]],[437,[53.9,27.6]],[438,[54.1,27.7]],[439,[54.2,27.7]],[440,[54.3,27.7]],[441,[54.5,27.7]],[442,[54.7,27.7]],[443,[54.8,27.7]],[444,[55,27.7]],[445,[55.2,27.7]],[446,[55.3,27.7]],[447,[55.5,27.7]],[448,[55.7,27.7]],[449,[55.8,27.8]],[450,[56,27.8]],[451,[56.2,27.8]],[452,[56.3,27.8]],[453,[56.5,27.8]],[454,[56.7,27.8]],[455,[56.8,27.8]],[456,[57,27.8]],[457,[57.2,27.8]],[458,[57.3,27.9]],[459,[57.4,27.9]],[460,[57.6,27.9]],[461,[57.8,27.9]],[462,[57.9,27.9]],[463,[58.1,27.9]],[464,[58.3,27.9]],[465,[58.4,27.9]],[466,[58.6,27.9]],[467,[58.8,27.9]],[468,[59,28]],[469,[59.1,28]],[470,[59.2,28]],[471,[59.4,28]],[472,[59.6,28]],[473,[59.7,28]],[474,[60,28]],[475,[60.1,28]],[476,[60.2,28]],[477,[60.4,28]],[478,[60.6,28.1]],[479,[60.7,28.1]],[480,[60.9,28.1]],[481,[60.1,28.1]],[482,[60.3,28.1]],[483,[61.4,28.1]],[484,[61.5,28.1]],[485,[61.7,28.1]],[486,[61.9,28.1]],[487,[62,28.2]],[488,[62.2,28.2]],[489,[62.3,28.2]],[490,[62.5,28.2]],[491,[62.7,28.2]],[492,[62.8,28.2]],[493,[63,28.2]],[494,[63.2,28.2]],[495,[63.3,28.2]],[496,[63.4,28.2]],[497,[63.6,28.2]],[498,[63.8,28.3]],[499,[63.9,28.3]],[500,[64.1,28.3]]]),o=function(){function e(){}return e.colorTemperatureToHueAndSaturation=function(e,t){void 0===t&&(t=!0),e>500?e=500:e<100&&(e=100),e=Math.round(e);var r=n.get(e);return(0,i.default)(null!=e,"lookup for temperature "+e+" did not yield any results"),t&&(r[0]=Math.round(r[0]),r[1]=Math.round(r[1])),{saturation:r[0],hue:r[1]}},e}();t.ColorUtils=o},9593:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HAPConnection=t.HAPConnectionEvent=t.HAPConnectionState=t.EventedHTTPServer=t.EventedHTTPServerEvent=t.HAPEncryption=void 0;var i,n=r(1635),o=r(9152),a=n.__importDefault(r(2613)),s=n.__importDefault(r(5753)),c=r(4434),u=n.__importDefault(r(8611)),l=n.__importDefault(r(9278)),h=n.__importDefault(r(857)),d=n.__importStar(r(8)),p=r(47),f=n.__importStar(r(2997)),g=(0,s.default)("HAP-NodeJS:EventedHTTPServer"),m=(0,s.default)("HAP-NodeJS:EventedHTTPServer:Connection"),v=(0,s.default)("HAP-NodeJS:EventEmitter"),y=function(e,t,r,i,n){this.accessoryToControllerCount=0,this.controllerToAccessoryCount=0,this.clientPublicKey=e,this.secretKey=t,this.publicKey=r,this.sharedSecret=i,this.hkdfPairEncryptionKey=n,this.accessoryToControllerKey=Buffer.alloc(0),this.controllerToAccessoryKey=Buffer.alloc(0)};t.HAPEncryption=y,function(e){e.LISTENING="listening",e.CONNECTION_OPENED="connection-opened",e.REQUEST="request",e.CONNECTION_CLOSED="connection-closed"}(i||(t.EventedHTTPServerEvent=i={}));var C,S,E=function(e){function t(){var t=e.call(this)||this;return t.connections=new Set,t.connectionsByUsername=new Map,t.tcpServer=l.default.createServer(),t}return n.__extends(t,e),t.prototype.scheduleNextConnectionIdleTimeout=function(){var e,r;if(this.connectionIdleTimeout=void 0,this.tcpServer.listening){g("Running idle timeout timer...");var i=(new Date).getTime(),o=-1;try{for(var a=n.__values(this.connections),s=a.next();!s.done;s=a.next()){var c=s.value,u=i-c.lastSocketOperation;u>=t.MAX_CONNECTION_IDLE_TIME?(g("[%s] Closing connection as it was inactive for "+u+"ms"),c.close()):o=Math.max(o,t.MAX_CONNECTION_IDLE_TIME-u)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}this.connections.size>=t.CONNECTION_TIMEOUT_LIMIT&&(this.connectionIdleTimeout=setTimeout(this.scheduleNextConnectionIdleTimeout.bind(this),o))}},t.prototype.address=function(){return this.tcpServer.address()},t.prototype.listen=function(e,t){var r=this;this.tcpServer.listen(e,t,(function(){var e=r.tcpServer.address();g("Server listening on %s:%s","IPv6"===e.family?"[".concat(e.address,"]"):e.address,e.port),r.connectionLoggingInterval=setInterval((function(){var e=n.__spreadArray([],n.__read(r.connections),!1).map((function(e){return"".concat(e.remoteAddress,":").concat(e.remotePort)})).join(", ");g("Currently %d hap connections open: %s",r.connections.size,e)}),6e4),r.connectionLoggingInterval.unref(),r.emit("listening",e.port,e.address)})),this.tcpServer.on("connection",this.onConnection.bind(this))},t.prototype.stop=function(){var e,t;null!=this.connectionLoggingInterval&&(clearInterval(this.connectionLoggingInterval),this.connectionLoggingInterval=void 0),null!=this.connectionIdleTimeout&&(clearTimeout(this.connectionIdleTimeout),this.connectionIdleTimeout=void 0),this.tcpServer.close();try{for(var r=n.__values(this.connections),i=r.next();!i.done;i=r.next()){i.value.close()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},t.prototype.destroy=function(){this.stop(),this.removeAllListeners()},t.prototype.broadcastEvent=function(e,t,r,i,o){var a,s;try{for(var c=n.__values(this.connections),u=c.next();!u.done;u=c.next()){var l=u.value;l!==i?l.sendEvent(e,t,r,o):g("[%s] Muting event '%s' notification for this connection since it originated here.",l.remoteAddress,e+"."+t)}}catch(e){a={error:e}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(a)throw a.error}}},t.prototype.onConnection=function(e){var r=this,i=new _(this,e);i.on("request",(function(e,t){r.emit("request",i,e,t)})),i.on("authenticated",this.handleConnectionAuthenticated.bind(this,i)),i.on("closed",this.handleConnectionClose.bind(this,i)),this.connections.add(i),g("[%s] New connection from client on interface %s (%s)",i.remoteAddress,i.networkInterface,i.localAddress),this.emit("connection-opened",i),this.connections.size>=t.CONNECTION_TIMEOUT_LIMIT&&!this.connectionIdleTimeout&&this.scheduleNextConnectionIdleTimeout()},t.prototype.handleConnectionAuthenticated=function(e,t){var r=this.connectionsByUsername.get(t);r?r.includes(e)||r.push(e):this.connectionsByUsername.set(t,[e])},t.prototype.handleConnectionClose=function(e){if(this.emit("connection-closed",e),this.connections.delete(e),e.username){var t=this.connectionsByUsername.get(e.username);if(t){var r=t.indexOf(e);-1!==r&&t.splice(r,1),0===t.length&&this.connectionsByUsername.delete(e.username)}}},t.destroyExistingConnectionsAfterUnpair=function(e,t){var r,i,o=e.server.connectionsByUsername.get(t);if(o)try{for(var a=n.__values(o),s=a.next();!s.done;s=a.next()){s.value.closeConnectionAsOfUnpair(e)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}},t.CONNECTION_TIMEOUT_LIMIT=16,t.MAX_CONNECTION_IDLE_TIME=36e5,t}(c.EventEmitter);t.EventedHTTPServer=E,function(e){e[e.CONNECTING=0]="CONNECTING",e[e.FULLY_SET_UP=1]="FULLY_SET_UP",e[e.AUTHENTICATED=2]="AUTHENTICATED",e[e.TO_BE_TEARED_DOWN=3]="TO_BE_TEARED_DOWN",e[e.CLOSING=4]="CLOSING",e[e.CLOSED=5]="CLOSED"}(C||(t.HAPConnectionState=C={})),function(e){e.REQUEST="request",e.AUTHENTICATED="authenticated",e.CLOSED="closed"}(S||(t.HAPConnectionEvent=S={}));var _=function(e){function t(r,i){var n=e.call(this)||this;return n.state=0,n.lastSocketOperation=(new Date).getTime(),n.pendingClientSocketData=Buffer.alloc(0),n.handlingRequest=!1,n.registeredEvents=new Set,n.queuedEvents=[],n.eventsQueuedForImmediateDelivery=!1,n.server=r,n.sessionID=f.generate(i.remoteAddress+":"+i.remotePort),n.localAddress=i.localAddress,n.remoteAddress=i.remoteAddress,n.remotePort=i.remotePort,n.networkInterface=t.getLocalNetworkInterface(i),n.tcpSocket=i,n.tcpSocket.on("data",n.onTCPSocketData.bind(n)),n.tcpSocket.on("close",n.onTCPSocketClose.bind(n)),n.tcpSocket.on("error",n.onTCPSocketError.bind(n)),n.tcpSocket.setNoDelay(!0),n.internalHttpServer=u.default.createServer(),n.internalHttpServer.timeout=0,n.internalHttpServer.keepAliveTimeout=0,n.internalHttpServer.on("listening",n.onHttpServerListening.bind(n)),n.internalHttpServer.on("request",n.handleHttpServerRequest.bind(n)),n.internalHttpServer.on("error",n.onHttpServerError.bind(n)),n.internalHttpServer.listen(0,n.internalHttpServerAddress=(0,p.getOSLoopbackAddressIfAvailable)()),n}return n.__extends(t,e),t.prototype.debugListenerRegistration=function(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=-1);var i=(new Error).stack.split("\n")[3],n=this.listeners(e).length,o="authenticated"===e?"\t":"\t\t",a=t?"\t\t":"\t";v("[".concat(this.remoteAddress,"] ").concat(t?"Registered":"Unregistered"," event '").concat(String(e).toUpperCase(),"' ").concat(o,"(total: ").concat(n).concat(t?"":" Before: "+r,") ").concat(a).concat(i))},t.prototype.on=function(t,r){var i=e.prototype.on.call(this,t,r);return this.debugListenerRegistration(t),i},t.prototype.addListener=function(t,r){var i=e.prototype.addListener.call(this,t,r);return this.debugListenerRegistration(t),i},t.prototype.removeListener=function(t,r){var i=this.listeners(t).length,n=e.prototype.removeListener.call(this,t,r);return this.debugListenerRegistration(t,!1,i),n},t.prototype.off=function(t,r){var i=e.prototype.off.call(this,t,r),n=this.listeners(t).length;return this.debugListenerRegistration(t,!1,n),i},t.prototype.connectionAuthenticated=function(e){this.state=2,this.username=e,this.emit("authenticated",e)},t.prototype.isAuthenticated=function(){return 2===this.state},t.prototype.close=function(){this.state>=4||(this.state=4,this.tcpSocket.destroy())},t.prototype.closeConnectionAsOfUnpair=function(e){this===e?this.state=3:this.close()},t.prototype.sendEvent=function(e,t,r,i){(0,a.default)(null!=e,"HAPConnection.sendEvent: aid must be defined!"),(0,a.default)(null!=t,"HAPConnection.sendEvent: iid must be defined!");var n=e+"."+t;if(this.registeredEvents.has(n)){var o={aid:e,iid:t,value:r};if(i)return this.queuedEvents.push(o),this.eventsQueuedForImmediateDelivery=!0,this.eventsTimer&&(clearTimeout(this.eventsTimer),this.eventsTimer=void 0),void this.handleEventsTimeout();for(var s=this.queuedEvents.length-1;s>=0;s--){var c=this.queuedEvents[s];if(c.aid===e&&c.iid===t){if(c.value===r)return;break}}this.queuedEvents.push(o),this.eventsTimer||(this.eventsTimer=setTimeout(this.handleEventsTimeout.bind(this),250),this.eventsTimer.unref())}},t.prototype.handleEventsTimeout=function(){this.eventsTimer=void 0,this.state>2||this.writeQueuedEventNotifications()},t.prototype.writeQueuedEventNotifications=function(){var e,t;if(0!==this.queuedEvents.length&&!this.handlingRequest){this.eventsTimer&&(clearTimeout(this.eventsTimer),this.eventsTimer=void 0);var r={characteristics:[]};try{for(var i=n.__values(this.queuedEvents),o=i.next();!o.done;o=i.next()){var a=o.value;this.registeredEvents.has(a.aid+"."+a.iid)&&r.characteristics.push(a)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}this.queuedEvents.splice(0,this.queuedEvents.length),this.eventsQueuedForImmediateDelivery=!1,this.writeEventNotification(r)}},t.prototype.writeEventNotification=function(e){m("[%s] Sending HAP event notifications %o",this.remoteAddress,e.characteristics),(0,a.default)(!this.handlingRequest,"Can't write event notifications while handling a request!"),e.characteristics.reverse();var t=Buffer.from(JSON.stringify(e),"utf8"),r=Buffer.from("EVENT/1.0 200 OK\r\nContent-Type: application/hap+json\r\nContent-Length: "+t.length+"\r\n\r\n","utf8"),i=Buffer.concat([r,t]);this.tcpSocket.write(this.encrypt(i),this.handleTCPSocketWriteFulfilled.bind(this))},t.prototype.enableEventNotifications=function(e,t){this.registeredEvents.add(e+"."+t)},t.prototype.disableEventNotifications=function(e,t){this.registeredEvents.delete(e+"."+t)},t.prototype.hasEventNotifications=function(e,t){return this.registeredEvents.has(e+"."+t)},t.prototype.getRegisteredEvents=function(){return this.registeredEvents},t.prototype.clearRegisteredEvents=function(){this.registeredEvents.clear()},t.prototype.encrypt=function(e){return this.encryption&&this.encryption.accessoryToControllerKey.length>0&&this.encryption.controllerToAccessoryCount>0?d.layerEncrypt(e,this.encryption):e},t.prototype.decrypt=function(e){return this.encryption&&this.encryption.controllerToAccessoryKey.length>0?d.layerDecrypt(e,this.encryption):e},t.prototype.onHttpServerListening=function(){var e=this,t=this.internalHttpServer.address(),r="IPv6"===t.family?"[".concat(t.address,"]"):t.address;this.internalHttpServerPort=t.port,m("[%s] Internal HTTP server listening on %s:%s",this.remoteAddress,r,t.port),this.internalHttpServer.on("close",this.onHttpServerClose.bind(this)),this.httpSocket=l.default.createConnection(this.internalHttpServerPort,this.internalHttpServerAddress),this.httpSocket.setNoDelay(!0),this.httpSocket.on("data",this.handleHttpServerResponse.bind(this)),this.httpSocket.on("error",this.onHttpSocketError.bind(this)),this.httpSocket.on("close",this.onHttpSocketClose.bind(this)),this.httpSocket.on("connect",(function(){e.state=1,m("[%s] Internal HTTP socket connected. HAPConnection now fully set up!",e.remoteAddress),e.pendingClientSocketData&&e.pendingClientSocketData.length>0&&e.httpSocket.write(e.pendingClientSocketData),e.pendingClientSocketData=void 0}))},t.prototype.onTCPSocketData=function(e){if(!(this.state>2)){this.handlingRequest=!0,this.lastSocketOperation=(new Date).getTime();try{e=this.decrypt(e)}catch(e){return m("[%s] Error occurred trying to decrypt incoming packet: %s",this.remoteAddress,e.message),void this.close()}this.state<1?this.pendingClientSocketData=Buffer.concat([this.pendingClientSocketData,e]):this.httpSocket.write(e)}},t.prototype.handleHttpServerRequest=function(e,t){this.state>2||(m("[%s] HTTP request: %s",this.remoteAddress,e.url),e.socket.setNoDelay(!0),this.emit("request",e,t))},t.prototype.handleHttpServerResponse=function(e){var t=this;e=this.encrypt(e),this.tcpSocket.write(e,this.handleTCPSocketWriteFulfilled.bind(this)),m("[%s] HTTP Response is finished",this.remoteAddress),this.handlingRequest=!1,3===this.state?setTimeout((function(){return t.close()}),10):this.state<3&&(this.eventsTimer&&!this.eventsQueuedForImmediateDelivery||this.writeQueuedEventNotifications())},t.prototype.handleTCPSocketWriteFulfilled=function(){this.lastSocketOperation=(new Date).getTime()},t.prototype.onTCPSocketError=function(e){m("[%s] Client connection error: %s",this.remoteAddress,e.message)},t.prototype.onTCPSocketClose=function(){this.state=5,m("[%s] Client connection closed",this.remoteAddress),this.httpSocket&&this.httpSocket.destroy(),this.internalHttpServer.close(),this.emit("closed"),this.removeAllListeners()},t.prototype.onHttpServerError=function(e){m("[%s] HTTP server error: %s",this.remoteAddress,e.message),"EADDRINUSE"===e.code&&(this.internalHttpServerPort=void 0,this.internalHttpServer.close(),this.internalHttpServer.listen(0,this.internalHttpServerAddress=(0,p.getOSLoopbackAddressIfAvailable)()))},t.prototype.onHttpServerClose=function(){m("[%s] HTTP server was closed",this.remoteAddress),this.close()},t.prototype.onHttpSocketError=function(e){m("[%s] HTTP connection error: ",this.remoteAddress,e.message)},t.prototype.onHttpSocketClose=function(){m("[%s] HTTP connection was closed",this.remoteAddress),this.internalHttpServer.close()},t.prototype.getLocalAddress=function(e){var t,r,i,o,a=h.default.networkInterfaces()[this.networkInterface];if("ipv4"===e){if(a)try{for(var s=n.__values(a),c=s.next();!c.done;c=s.next()){if("IPv4"===(p=c.value).family||4===p.family)return p.address}}catch(e){t={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}throw new Error("Could not find "+e+" address for interface "+this.networkInterface)}var u=void 0;if(a)try{for(var l=n.__values(a),d=l.next();!d.done;d=l.next()){var p;if("IPv6"===(p=d.value).family||6===p.family){if(!p.scopeid)return p.address;u||(u=p.address)}}}catch(e){i={error:e}}finally{try{d&&!d.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}if(!u)throw new Error("Could not find "+e+" address for interface "+this.networkInterface);return u},t.getLocalNetworkInterface=function(e){var t,r,i,a,s,c,u,d,p=e.localAddress;if(p.startsWith("::ffff:"))p=p.substring(7);else{var f=p.indexOf("%");-1!==f&&(p=p.substring(0,f))}var g=h.default.networkInterfaces();try{for(var m=n.__values(Object.entries(g)),v=m.next();!v.done;v=m.next()){var y=n.__read(v.value,2),C=y[0];if(I=y[1])try{for(var S=(i=void 0,n.__values(I)),E=S.next();!E.done;E=S.next()){if((U=E.value).address===p)return C}}catch(e){i={error:e}}finally{try{E&&!E.done&&(a=S.return)&&a.call(S)}finally{if(i)throw i.error}}}}catch(e){t={error:e}}finally{try{v&&!v.done&&(r=m.return)&&r.call(m)}finally{if(t)throw t.error}}var _=l.default.isIPv4(p)?"IPv4":"IPv6";try{for(var T=n.__values(Object.entries(g)),A=T.next();!A.done;A=T.next()){var I,D=n.__read(A.value,2);C=D[0];if(I=D[1])try{for(var w=(u=void 0,n.__values(I)),b=w.next();!b.done;b=w.next()){var U;if((U=b.value).family===_&&(0,o.getNetAddress)(p,U.netmask)===(0,o.getNetAddress)(U.address,U.netmask))return C}}catch(e){u={error:e}}finally{try{b&&!b.done&&(d=w.return)&&d.call(w)}finally{if(u)throw u.error}}}}catch(e){s={error:e}}finally{try{A&&!A.done&&(c=T.return)&&c.call(T)}finally{if(s)throw s.error}}return console.log("WARNING couldn't map socket coming from remote address ".concat(e.remoteAddress,":").concat(e.remotePort,"     at local address ").concat(e.localAddress," to a interface!")),Object.keys(g)[1]},t}(c.EventEmitter);t.HAPConnection=_},8:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.layerDecrypt=t.layerEncrypt=t.chacha20_poly1305_encryptAndSeal=t.chacha20_poly1305_decryptAndVerify=t.writeUInt64LE=t.HKDF=t.generateCurve25519SharedSecKey=t.generateCurve25519KeyPair=void 0;var i=r(1635),n=i.__importDefault(r(2613)),o=i.__importDefault(r(6982)),a=i.__importDefault(r(6871)),s=i.__importDefault(r(8947));o.default.getCiphers().includes("chacha20-poly1305")||n.default.fail("The cipher 'chacha20-poly1305' is not supported with your current running nodejs version v"+process.version+". At least a nodejs version of v10.17.0 (excluding v11.0 and v11.1) is required!"),t.generateCurve25519KeyPair=function(){return s.default.box.keyPair()},t.generateCurve25519SharedSecKey=function(e,t){return s.default.scalarMult(e,t)},t.HKDF=function(e,t,r,i,n){return(0,a.default)(r,n,{hash:e,salt:t,info:i})};var c=4294967295,u=9007199254740991;function l(e,t,r){void 0===r&&(r=0);var i=function(e){(0,n.default)(e>-1&&e<=u,"number out of range"),(0,n.default)(Math.floor(e)===e,"number must be an integer");var t=0,r=4294967295&e,i=r<0?2147483648+(2147483647&e):r;return e>c&&(t=(e-i)/(c+1)),[t,i]}(e);t.writeUInt32LE(i[1],r),t.writeUInt32LE(i[0],r+4)}function h(e,t,r,i,n){t.length<12&&(t=Buffer.concat([Buffer.alloc(12-t.length,0),t]));var a=o.default.createDecipheriv("chacha20-poly1305",e,t,{authTagLength:16});r&&a.setAAD(r,{plaintextLength:i.length}),a.setAuthTag(n);var s=a.update(i);return a.final(),s}function d(e,t,r,i){t.length<12&&(t=Buffer.concat([Buffer.alloc(12-t.length,0),t]));var n=o.default.createCipheriv("chacha20-poly1305",e,t,{authTagLength:16});r&&n.setAAD(r,{plaintextLength:i.length});var a=n.update(i);return n.final(),{ciphertext:a,authTag:n.getAuthTag()}}t.writeUInt64LE=l,t.chacha20_poly1305_decryptAndVerify=h,t.chacha20_poly1305_encryptAndSeal=d,t.layerEncrypt=function(e,t){for(var r=Buffer.alloc(0),i=e.length,n=0;n<i;){var o=Math.min(i-n,1024),a=Buffer.alloc(2);a.writeUInt16LE(o,0);var s=Buffer.alloc(8);l(t.accessoryToControllerCount++,s,0);var c=d(t.accessoryToControllerKey,s,a,e.slice(n,n+o));n+=o,r=Buffer.concat([r,a,c.ciphertext,c.authTag])}return r},t.layerDecrypt=function(e,t){t.incompleteFrame&&(e=Buffer.concat([t.incompleteFrame,e]),t.incompleteFrame=void 0);for(var r=Buffer.alloc(0),i=e.length,n=0;n<i;){var o=e.slice(n,n+2).readUInt16LE(0);if(o>i-n-2-16){t.incompleteFrame=e.slice(n);break}var a=Buffer.alloc(8);l(t.controllerToAccessoryCount++,a,0);var s=h(t.controllerToAccessoryKey,a,e.slice(n,n+2),e.slice(n+2,n+2+o),e.slice(n+2+o,n+2+o+16));r=Buffer.concat([r,s]),n+=18+o}return r}},8073:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HapStatusError=void 0;var i=r(1635),n=r(589),o=function(e){function t(r){var i=e.call(this,"HAP Status Error: "+r)||this;return Object.setPrototypeOf(i,t.prototype),(0,n.IsKnownHAPStatusError)(r)?i.hapStatus=r:i.hapStatus=-70402,i}return i.__extends(t,e),t}(Error);t.HapStatusError=o},47:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOSLoopbackAddressIfAvailable=t.getOSLoopbackAddress=t.findLoopbackAddress=void 0;var i=r(1635),n=i.__importDefault(r(857));function o(){var e,t,r,o,a=void 0,s=void 0,c=void 0;try{for(var u=i.__values(Object.entries(n.default.networkInterfaces())),l=u.next();!l.done;l=u.next()){var h=i.__read(l.value,2),d=h[0],p=h[1],f=!1;if(p)try{for(var g=(r=void 0,i.__values(p)),m=g.next();!m.done;m=g.next()){var v=m.value;v.internal&&(f=!0,"IPv4"===v.family||4===v.family?c||(c=v.address):"IPv6"!==v.family&&6!==v.family||(v.scopeid?s||(s=v.address+"%"+d):a||(a=v.address)))}}catch(e){r={error:e}}finally{try{m&&!m.done&&(o=g.return)&&o.call(g)}finally{if(r)throw r.error}}if(f)break}}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}var y=c||a||s;if(!y)throw new Error("Could not find a valid loopback address on the platform!");return y}t.findLoopbackAddress=o;var a=void 0;t.getOSLoopbackAddress=function(){return null!=a?a:a=o()},t.getOSLoopbackAddressIfAvailable=function(){try{return null!=a?a:a=o()}catch(e){return void console.log(e.stack)}}},7739:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.once=void 0;var i=r(1635);t.once=function(e){var t=!1;return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];if(t)throw new Error("This callback function has already been called by someone else; it can only be called one time.");return t=!0,e.apply(void 0,i.__spreadArray([],i.__read(r),!1))}}},4009:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.awaitEventOnce=t.PromiseTimeout=void 0,t.PromiseTimeout=function(e){return new Promise((function(t){setTimeout((function(){return t()}),e)}))},t.awaitEventOnce=function(e,t,r){return void 0===r&&(r=5e3),new Promise((function(i,n){var o,a=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];clearTimeout(o),i(e.length?1===e.length?e[0]:e:void 0)};o=setTimeout((function(){e.removeListener(t,a),n(new Error("awaitEvent for event ".concat(t," timed out!")))}),r),e.once(t,a)}))}},8066:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.numericUpperBound=t.numericLowerBound=t.isIntegerNumericFormat=t.isUnsignedNumericFormat=t.isNumericFormat=t.formatOutgoingCharacteristicValue=void 0,t.formatOutgoingCharacteristicValue=function(e,t){var r;if("boolean"==typeof e)return e?1:0;if("number"==typeof e){if(!t.minStep||t.minStep>=1)return e;var i=null!==(r=t.minValue)&&void 0!==r?r:0,n=1/t.minStep;return Math.round(1e4*(Math.round((e-i)*n)/n+i))/1e4}return e},t.isNumericFormat=function(e){switch(e){case"int":case"float":case"uint8":case"uint16":case"uint32":case"uint64":return!0;default:return!1}},t.isUnsignedNumericFormat=function(e){switch(e){case"uint8":case"uint16":case"uint32":case"uint64":return!0;default:return!1}},t.isIntegerNumericFormat=function(e){switch(e){case"int":case"uint8":case"uint16":case"uint32":case"uint64":return!0;default:return!1}},t.numericLowerBound=function(e){switch(e){case"int":return-2147483648;case"float":return-Number.MAX_VALUE;case"uint8":case"uint16":case"uint32":case"uint64":return 0;default:throw new Error("Unable to determine numeric lower bound for "+e)}},t.numericUpperBound=function(e){switch(e){case"int":return 2147483647;case"float":return Number.MAX_VALUE;case"uint8":return 255;case"uint16":return 65535;case"uint32":return 4294967295;case"uint64":return 0x10000000000000000;default:throw new Error("Unable to determine numeric lower bound for "+e)}}},1579:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.epochMillisFromMillisSince2001_01_01Buffer=t.epochMillisFromMillisSince2001_01_01=void 0;var i=r(1635).__importDefault(r(2613)),n=r(3314),o=Date.UTC(2001,0,1,0,0,0,0);function a(e){return o+e}t.epochMillisFromMillisSince2001_01_01=a,t.epochMillisFromMillisSince2001_01_01Buffer=function(e){return(0,i.default)(8===e.length,"can only parse 64 bit buffers!"),a((0,n.readUInt64LE)(e))}},3314:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.writeVariableUIntLE=t.readVariableUIntLE=t.readUInt16=t.writeUInt16=t.writeFloat32LE=t.readUInt32=t.writeUInt32=t.readUInt64BE=t.readUInt64LE=t.readUInt64=t.writeUInt64=t.decodeList=t.decodeWithLists=t.decode=t.encode=void 0;var i=r(1635),n=i.__importDefault(r(2613)),o=i.__importStar(r(8));function a(e,t){void 0===t&&(t=0);var r=e.readUInt32LE(t);return 4294967296*e.readUInt32LE(t+4)+r}function s(e){var t=Buffer.alloc(4);return t.writeUInt32LE(e,0),t}function c(e){var t=Buffer.alloc(2);return t.writeUInt16LE(e,0),t}t.encode=function e(t,r){for(var n,o,a=[],s=2;s<arguments.length;s++)a[s-2]=arguments[s];var c=[];if("number"==typeof r?r=Buffer.from([r]):"string"==typeof r&&(r=Buffer.from(r)),Array.isArray(r)){var u=!0;try{for(var l=i.__values(r),h=l.next();!h.done;h=l.next()){var d=h.value;u||c.push(Buffer.from([0,0])),u=!1,c.push(e(t,d))}}catch(e){n={error:e}}finally{try{h&&!h.done&&(o=l.return)&&o.call(l)}finally{if(n)throw n.error}}u&&c.push(Buffer.from([t,0]))}else if(r.length<=255)c.push(Buffer.concat([Buffer.from([t,r.length]),r]));else for(var p=r.length,f=0;p>0;)p>=255?(c.push(Buffer.concat([Buffer.from([t,255]),r.slice(f,f+255)])),p-=255,f+=255):(c.push(Buffer.concat([Buffer.from([t,p]),r.slice(f)])),p-=p);if(a.length>=2){var g=i.__read(a),m=g[0],v=g[1],y=g.slice(2),C=e.apply(void 0,i.__spreadArray([m,v],i.__read(y),!1));c.push(C)}return Buffer.concat(c)},t.decode=function(e){(0,n.default)(e instanceof Buffer,"Illegal argument. tlv.decode() expects Buffer type!");for(var t={},r=e.length,i=0;r>0;){var o=e[i],a=e[i+1];i+=2,r-=2;var s=e.slice(i,i+a);t[o]?t[o]=Buffer.concat([t[o],s]):t[o]=s,i+=a,r-=a}return t},t.decodeWithLists=function(e){for(var t={},r=e.length,i=0,n=-1,o=-1,a=!1;r>0;){var s=e.readUInt8(i++),c=e.readUInt8(i++);r-=2;var u=e.slice(i,i+c);if(i+=c,r-=c,0!==s||0!==c){var l=t[s];if(l)if(a&&n===s)Array.isArray(l)?l.push(u):t[s]=[l,u];else{if(n!==s||255!==o)throw new Error("Found duplicated tlv entry with type ".concat(s," and length ").concat(c,"         (lastItemWasDelimiter: ").concat(a,", lastType: ").concat(n,", lastLength: ").concat(o,")"));if(Array.isArray(l)){var h=l[l.length-1];l[l.length-1]=Buffer.concat([h,u])}else t[s]=Buffer.concat([l,u])}else t[s]=u;n=s,o=c,a=!1}else a=!0}return t},t.decodeList=function(e,t){for(var r=[],i=e.length,n=0,o=void 0;i>0;){var a=e[n],s=e[n+1],c=e.slice(n+2,n+2+s);if(a===t&&(void 0!==o&&r.push(o),o={}),void 0===o)throw new Error("Error parsing tlv list: Encountered uninitialized storage object");o[a]?o[a]=Buffer.concat([o[a],c]):o[a]=c,n+=2+s,i-=2+s}return void 0!==o&&r.push(o),r},t.writeUInt64=function(e){var t=new Float64Array(1);t[0]=e;for(var r=Buffer.alloc(t.buffer.byteLength),i=new Uint8Array(t.buffer),n=0;n<r.length;n++)r[n]=i[n];return r},t.readUInt64=function(e){return new Float64Array(e)[0]},t.readUInt64LE=a,t.readUInt64BE=function(e,t){return void 0===t&&(t=0),a(e,t)},t.writeUInt32=s,t.readUInt32=function(e){return e.readUInt32LE(0)},t.writeFloat32LE=function(e){var t=Buffer.alloc(4);return t.writeFloatLE(e,0),t},t.writeUInt16=c,t.readUInt16=function(e){return e.readUInt16LE(0)},t.readVariableUIntLE=function(e,t){switch(void 0===t&&(t=0),(0,n.default)(0===t,"Can't define a offset different than 0!"),e.length){case 1:return e.readUInt8(t);case 2:return e.readUInt16LE(t);case 4:return e.readUInt32LE(t);case 8:return a(e,t);default:throw new Error("Can't read uint LE with length "+e.length)}},t.writeVariableUIntLE=function(e,t){if(void 0===t&&(t=0),(0,n.default)(e>=0,"Can't encode a negative integer as unsigned integer"),(0,n.default)(0===t,"Can't define a offset different than 0!"),e<=255)return(r=Buffer.alloc(1)).writeUInt8(e,t),r;if(e<=65535)return c(e);if(e<=4294967295)return s(e);var r=Buffer.alloc(8);return o.writeUInt64LE(e,r,t),r}},2997:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toLongForm=t.toShortForm=t.write=t.unparse=t.isValid=t.generate=t.BASE_UUID=void 0;var i=r(1635).__importDefault(r(6982));t.BASE_UUID="-0000-1000-8000-0026BB765291",t.generate=function(e){var t=i.default.createHash("sha1");t.update(e);var r=t.digest("hex"),n=-1;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){return n+=1,"y"===e?(3&parseInt("0x"+r[n],16)|8).toString(16):r[n]}))};var n=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function o(e){return n.test(e)}t.isValid=o,t.unparse=function(e,t){if(void 0===t&&(t=0),"string"==typeof e&&o(e))return e;var r=t;return e.toString("hex",r,r+=4)+"-"+e.toString("hex",r,r+=2)+"-"+e.toString("hex",r,r+=2)+"-"+e.toString("hex",r,r+=2)+"-"+e.toString("hex",r,r+6)},t.write=function(e,t,r){void 0===r&&(r=0);var i=Buffer.from(e.replace(/-/g,""),"hex");return t?(i.copy(t,r),t):i};var a=/^0*([0-9a-f]{1,8})-([0-9a-f]{4}-){3}[0-9a-f]{12}$/i;t.toShortForm=function(e,r){if(void 0===r&&(r=t.BASE_UUID),!o(e))throw new TypeError("uuid was not a valid UUID or short form UUID");if(r&&!o("00000000"+r))throw new TypeError("base was not a valid base UUID");return r&&!e.endsWith(r)?e.toUpperCase():e.replace(a,"$1").toUpperCase()};var s=/^[0-9a-f]{1,8}$/i;t.toLongForm=function(e,r){if(void 0===r&&(r=t.BASE_UUID),o(e))return e.toUpperCase();if(!s.test(e))throw new TypeError("uuid was not a valid UUID or short form UUID");if(!o("00000000"+r))throw new TypeError("base was not a valid base UUID");return(("00000000"+e).substr(-8)+r).toUpperCase()}},7506:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=7506,e.exports=t},4310:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ResourceRequestType=void 0,function(e){e.IMAGE="image"}(r||(t.ResourceRequestType=r={}))},9790:e=>{"use strict";var t="undefined"!=typeof BigInt&&BigInt;e.exports=function(){return"function"==typeof t&&"function"==typeof BigInt&&"bigint"==typeof t(42)&&"bigint"==typeof BigInt(42)}},5884:e=>{"use strict";e.exports=(e,t=process.argv)=>{const r=e.startsWith("-")?"":1===e.length?"-":"--",i=t.indexOf(r+e),n=t.indexOf("--");return-1!==i&&(-1===n||i<n)}},592:(e,t,r)=>{"use strict";var i=r(655),n=function(){return!!i};n.hasArrayLengthDefineBug=function(){if(!i)return null;try{return 1!==i([],"length",{value:1}).length}catch(e){return!0}},e.exports=n},24:e=>{"use strict";var t={__proto__:null,foo:{}},r=Object;e.exports=function(){return{__proto__:t}.foo===t.foo&&!(t instanceof r)}},4039:(e,t,r)=>{"use strict";var i="undefined"!=typeof Symbol&&Symbol,n=r(1333);e.exports=function(){return"function"==typeof i&&("function"==typeof Symbol&&("symbol"==typeof i("foo")&&("symbol"==typeof Symbol("bar")&&n())))}},1333:e=>{"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var i=Object.getOwnPropertySymbols(e);if(1!==i.length||i[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var n=Object.getOwnPropertyDescriptor(e,t);if(42!==n.value||!0!==n.enumerable)return!1}return!0}},9092:(e,t,r)=>{"use strict";var i=r(1333);e.exports=function(){return i()&&!!Symbol.toStringTag}},9957:(e,t,r)=>{"use strict";var i=Function.prototype.call,n=Object.prototype.hasOwnProperty,o=r(6743);e.exports=o.call(i,n)},7244:(e,t,r)=>{"use strict";var i=r(9092)(),n=r(8075)("Object.prototype.toString"),o=function(e){return!(i&&e&&"object"==typeof e&&Symbol.toStringTag in e)&&"[object Arguments]"===n(e)},a=function(e){return!!o(e)||null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==n(e)&&"[object Function]"===n(e.callee)},s=function(){return o(arguments)}();o.isLegacyArguments=a,e.exports=s?o:a},4670:(e,t,r)=>{"use strict";var i=r(487),n=r(8075),o=r(453)("%ArrayBuffer%",!0),a=n("ArrayBuffer.prototype.byteLength",!0),s=n("Object.prototype.toString"),c=!!o&&!a&&new o(0).slice,u=!!c&&i(c);e.exports=a||u?function(e){if(!e||"object"!=typeof e)return!1;try{return a?a(e):u(e,0),!0}catch(e){return!1}}:o?function(e){return"[object ArrayBuffer]"===s(e)}:function(e){return!1}},9803:(e,t,r)=>{"use strict";if(r(9790)()){var i=BigInt.prototype.valueOf;e.exports=function(e){return null!=e&&"boolean"!=typeof e&&"string"!=typeof e&&"number"!=typeof e&&"symbol"!=typeof e&&"function"!=typeof e&&("bigint"==typeof e||function(e){try{return i.call(e),!0}catch(e){}return!1}(e))}}else e.exports=function(e){return!1}},5128:(e,t,r)=>{"use strict";var i=r(8075),n=i("Boolean.prototype.toString"),o=i("Object.prototype.toString"),a=r(9092)();e.exports=function(e){return"boolean"==typeof e||null!==e&&"object"==typeof e&&(a&&Symbol.toStringTag in e?function(e){try{return n(e),!0}catch(e){return!1}}(e):"[object Boolean]"===o(e))}},9600:e=>{"use strict";var t,r,i=Function.prototype.toString,n="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof n&&"function"==typeof Object.defineProperty)try{t=Object.defineProperty({},"length",{get:function(){throw r}}),r={},n((function(){throw 42}),null,t)}catch(e){e!==r&&(n=null)}else n=null;var o=/^\s*class\b/,a=function(e){try{var t=i.call(e);return o.test(t)}catch(e){return!1}},s=function(e){try{return!a(e)&&(i.call(e),!0)}catch(e){return!1}},c=Object.prototype.toString,u="function"==typeof Symbol&&!!Symbol.toStringTag,l=!(0 in[,]),h=function(){return!1};if("object"==typeof document){var d=document.all;c.call(d)===c.call(document.all)&&(h=function(e){if((l||!e)&&(void 0===e||"object"==typeof e))try{var t=c.call(e);return("[object HTMLAllCollection]"===t||"[object HTML document.all class]"===t||"[object HTMLCollection]"===t||"[object Object]"===t)&&null==e("")}catch(e){}return!1})}e.exports=n?function(e){if(h(e))return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;try{n(e,null,t)}catch(e){if(e!==r)return!1}return!a(e)&&s(e)}:function(e){if(h(e))return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if(u)return s(e);if(a(e))return!1;var t=c.call(e);return!("[object Function]"!==t&&"[object GeneratorFunction]"!==t&&!/^\[object HTML/.test(t))&&s(e)}},2120:(e,t,r)=>{"use strict";var i=Date.prototype.getDay,n=Object.prototype.toString,o=r(9092)();e.exports=function(e){return"object"==typeof e&&null!==e&&(o?function(e){try{return i.call(e),!0}catch(e){return!1}}(e):"[object Date]"===n.call(e))}},3802:e=>{"use strict";var t,r="function"==typeof Map&&Map.prototype?Map:null,i="function"==typeof Set&&Set.prototype?Set:null;r||(t=function(e){return!1});var n=r?Map.prototype.has:null,o=i?Set.prototype.has:null;t||n||(t=function(e){return!1}),e.exports=t||function(e){if(!e||"object"!=typeof e)return!1;try{if(n.call(e),o)try{o.call(e)}catch(e){return!0}return e instanceof r}catch(e){}return!1}},1703:(e,t,r)=>{"use strict";var i=Number.prototype.toString,n=Object.prototype.toString,o=r(9092)();e.exports=function(e){return"number"==typeof e||"object"==typeof e&&(o?function(e){try{return i.call(e),!0}catch(e){return!1}}(e):"[object Number]"===n.call(e))}},4035:(e,t,r)=>{"use strict";var i,n,o,a,s=r(8075),c=r(9092)();if(c){i=s("Object.prototype.hasOwnProperty"),n=s("RegExp.prototype.exec"),o={};var u=function(){throw o};a={toString:u,valueOf:u},"symbol"==typeof Symbol.toPrimitive&&(a[Symbol.toPrimitive]=u)}var l=s("Object.prototype.toString"),h=Object.getOwnPropertyDescriptor;e.exports=c?function(e){if(!e||"object"!=typeof e)return!1;var t=h(e,"lastIndex");if(!(t&&i(t,"value")))return!1;try{n(e,a)}catch(e){return e===o}}:function(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&"[object RegExp]"===l(e)}},256:e=>{"use strict";var t,r="function"==typeof Map&&Map.prototype?Map:null,i="function"==typeof Set&&Set.prototype?Set:null;i||(t=function(e){return!1});var n=r?Map.prototype.has:null,o=i?Set.prototype.has:null;t||o||(t=function(e){return!1}),e.exports=t||function(e){if(!e||"object"!=typeof e)return!1;try{if(o.call(e),n)try{n.call(e)}catch(e){return!0}return e instanceof i}catch(e){}return!1}},7070:(e,t,r)=>{"use strict";var i=r(8075)("SharedArrayBuffer.prototype.byteLength",!0);e.exports=i?function(e){if(!e||"object"!=typeof e)return!1;try{return i(e),!0}catch(e){return!1}}:function(e){return!1}},4761:(e,t,r)=>{"use strict";var i=String.prototype.valueOf,n=Object.prototype.toString,o=r(9092)();e.exports=function(e){return"string"==typeof e||"object"==typeof e&&(o?function(e){try{return i.call(e),!0}catch(e){return!1}}(e):"[object String]"===n.call(e))}},3612:(e,t,r)=>{"use strict";var i=Object.prototype.toString;if(r(4039)()){var n=Symbol.prototype.toString,o=/^Symbol\(.*\)$/;e.exports=function(e){if("symbol"==typeof e)return!0;if("[object Symbol]"!==i.call(e))return!1;try{return function(e){return"symbol"==typeof e.valueOf()&&o.test(n.call(e))}(e)}catch(e){return!1}}}else e.exports=function(e){return!1}},7842:e=>{"use strict";var t,r="function"==typeof WeakMap&&WeakMap.prototype?WeakMap:null,i="function"==typeof WeakSet&&WeakSet.prototype?WeakSet:null;r||(t=function(e){return!1});var n=r?r.prototype.has:null,o=i?i.prototype.has:null;t||n||(t=function(e){return!1}),e.exports=t||function(e){if(!e||"object"!=typeof e)return!1;try{if(n.call(e,n),o)try{o.call(e,o)}catch(e){return!0}return e instanceof r}catch(e){}return!1}},2648:(e,t,r)=>{"use strict";var i=r(453),n=r(8075),o=i("%WeakSet%",!0),a=n("WeakSet.prototype.has",!0);if(a){var s=n("WeakMap.prototype.has",!0);e.exports=function(e){if(!e||"object"!=typeof e)return!1;try{if(a(e,a),s)try{s(e,s)}catch(e){return!0}return e instanceof o}catch(e){}return!1}}else e.exports=function(e){return!1}},4634:e=>{var t={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==t.call(e)}},9292:(e,t,r)=>{var i=r(2203).Stream;e.exports=function(e,t){var r=new i,n=0,o=0,a=!1,s=!1,c=!1,u=0,l=!1,h=(t=t||{}).failures?"failure":"error",d={};function p(e,t){var i=u+1;if(t===i?(void 0!==e&&r.emit.apply(r,["data",e]),u++,i++):d[t]=e,d.hasOwnProperty(i)){var c=d[i];return delete d[i],p(c,i)}o++,n===o&&(s&&(s=!1,r.emit("drain")),a&&g())}function f(e,i,n){c||(l=!0,e&&!t.failures||p(i,n),e&&r.emit.apply(r,[h,e]),l=!1)}function g(e){if(a=!0,r.writable=!1,void 0!==e)return p(e,n);n==o&&(r.readable=!1,r.emit("end"),r.destroy())}return r.writable=!0,r.readable=!0,r.write=function(t){if(a)throw new Error("map stream is not writable");l=!1,n++;try{var r=(i=t,o=n,c=f,e.call(null,i,(function(e,t){c(e,t,o)})));return!(s=!1===r)}catch(e){if(l)throw e;return f(e),!s}var i,o,c},r.end=function(e){a||g(e)},r.destroy=function(){a=c=!0,r.writable=r.readable=s=!1,process.nextTick((function(){r.emit("close")}))},r.pause=function(){s=!0},r.resume=function(){s=!1},r}},3480:(e,t,r)=>{var i=r(6928),n=r(9896),o=parseInt("0777",8);function a(e,t,r,s){"function"==typeof t?(r=t,t={}):t&&"object"==typeof t||(t={mode:t});var c=t.mode,u=t.fs||n;void 0===c&&(c=o),s||(s=null);var l=r||function(){};e=i.resolve(e),u.mkdir(e,c,(function(r){if(!r)return l(null,s=s||e);if("ENOENT"===r.code){if(i.dirname(e)===e)return l(r);a(i.dirname(e),t,(function(r,i){r?l(r,i):a(e,t,l,i)}))}else u.stat(e,(function(e,t){e||!t.isDirectory()?l(r,s):l(null,s)}))}))}e.exports=a.mkdirp=a.mkdirP=a,a.sync=function e(t,r,a){r&&"object"==typeof r||(r={mode:r});var s=r.mode,c=r.fs||n;void 0===s&&(s=o),a||(a=null),t=i.resolve(t);try{c.mkdirSync(t,s),a=a||t}catch(n){if("ENOENT"===n.code)a=e(i.dirname(t),r,a),e(t,r,a);else{var u;try{u=c.statSync(t)}catch(e){throw n}if(!u.isDirectory())throw n}}return a}},6585:e=>{var t=1e3,r=60*t,i=60*r,n=24*i,o=7*n,a=365.25*n;function s(e,t,r,i){var n=t>=1.5*r;return Math.round(e/r)+" "+i+(n?"s":"")}e.exports=function(e,c){c=c||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var s=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!s)return;var c=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*a;case"weeks":case"week":case"w":return c*o;case"days":case"day":case"d":return c*n;case"hours":case"hour":case"hrs":case"hr":case"h":return c*i;case"minutes":case"minute":case"mins":case"min":case"m":return c*r;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===u&&isFinite(e))return c.long?function(e){var o=Math.abs(e);if(o>=n)return s(e,o,n,"day");if(o>=i)return s(e,o,i,"hour");if(o>=r)return s(e,o,r,"minute");if(o>=t)return s(e,o,t,"second");return e+" ms"}(e):function(e){var o=Math.abs(e);if(o>=n)return Math.round(e/n)+"d";if(o>=i)return Math.round(e/i)+"h";if(o>=r)return Math.round(e/r)+"m";if(o>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},2781:(e,t)=>{var r=function(e){return"_"+e},i=function(e){return e};t.stringify=function(e){return"object"==typeof e&&e&&e.name?t.stringify(e.name,e.protocol,e.subtypes):Array.prototype.concat.apply([],arguments).filter(i).map(r).join(".")},t.parse=function(e){for(var t=e.split("."),r=0;r<t.length;r++)"_"===t[r][0]&&(t[r]=t[r].slice(1));return{name:t.shift(),protocol:t.shift()||null,subtypes:t}},t.tcp=function(e){return t.stringify(e,"tcp",Array.prototype.concat.apply([],Array.prototype.slice.call(arguments,1)))},t.udp=function(e){return t.stringify(e,"udp",Array.prototype.concat.apply([],Array.prototype.slice.call(arguments,1)))}},2567:(e,t,r)=>{var i=r(3843),n=r(7194),o=r(294),a=r(4434),s=r(857),c=function(){};function u(e){return 4===e||"IPv4"===e}e.exports=function(e){e||(e={});var t=new a.EventEmitter,r="number"==typeof e.port?e.port:5353,l=e.type||"udp4",h=e.ip||e.host||("udp4"===l?"224.0.0.251":null),d={address:h,port:r},p={},f=!1,g=null;if(!("udp6"!==l||h&&e.interface))throw new Error("For IPv6 multicast you must specify `ip` and `interface`");var m=e.socket||n.createSocket({type:l,reuseAddr:!1!==e.reuseAddr,toString:function(){return l}});m.on("error",(function(e){"EACCES"===e.code||"EADDRINUSE"===e.code?t.emit("error",e):t.emit("warning",e)})),m.on("message",(function(e,r){try{e=i.decode(e)}catch(e){return void t.emit("warning",e)}t.emit("packet",e,r),"query"===e.type&&t.emit("query",e,r),"response"===e.type&&t.emit("response",e,r)})),m.on("listening",(function(){r||(r=d.port=m.address().port),!1!==e.multicast&&(t.update(),g=setInterval(t.update,5e3),m.setMulticastTTL(e.ttl||255),m.setMulticastLoopback(!1!==e.loopback))}));var v=o((function(t){if(!r||!1===e.bind)return t(null);m.once("error",t),m.bind(r,e.bind||e.interface,(function(){m.removeListener("error",t),t(null)}))}));return v((function(e){if(e)return t.emit("error",e);t.emit("ready")})),t.send=function(e,r,n){if("function"==typeof r)return t.send(e,null,r);n||(n=c),r?r.host||r.address||(r.address=d.address):r=d,v((function(t){if(f)return n();if(t)return n(t);var o=i.encode(e);m.send(o,0,o.length,r.port,r.address||r.host,n)}))},t.response=t.respond=function(e,r,n){Array.isArray(e)&&(e={answers:e}),e.type="response",e.flags=(e.flags||0)|i.AUTHORITATIVE_ANSWER,t.send(e,r,n)},t.query=function(e,r,i,n){return"function"==typeof r?t.query(e,null,null,r):"object"==typeof r&&r&&r.port?t.query(e,null,r,i):"function"==typeof i?t.query(e,r,null,i):(n||(n=c),"string"==typeof e&&(e=[{name:e,type:r||"ANY"}]),Array.isArray(e)&&(e={type:"query",questions:e}),e.type="query",void t.send(e,i,n))},t.destroy=function(e){if(e||(e=c),f)return process.nextTick(e);for(var t in f=!0,clearInterval(g),p)try{m.dropMembership(h,t)}catch(e){}p={},m.close(e)},t.update=function(){for(var r=e.interface?[].concat(e.interface):function(){for(var e=s.networkInterfaces(),t=Object.keys(e),r=[],i=0;i<t.length;i++)for(var n=e[t[i]],o=0;o<n.length;o++){var a=n[o];if(u(a.family)){r.push(a.address);break}}return r}(),i=!1,n=0;n<r.length;n++){var o=r[n];if(!p[o])try{m.addMembership(h,o),p[o]=!0,i=!0}catch(e){t.emit("warning",e)}}if(i){if(m.setMulticastInterface)try{m.setMulticastInterface(e.interface||function(){for(var e=s.networkInterfaces(),t=Object.keys(e),r=0;r<t.length;r++)for(var i=e[t[r]],n=0;n<i.length;n++){var o=i[n];if(u(o.family)&&!o.internal)return"darwin"===s.platform()&&"en0"===t[r]?o.address:"0.0.0.0"}return"127.0.0.1"}())}catch(e){t.emit("warning",e)}t.emit("networkInterface")}},t}},1566:(e,t,r)=>{var i=r(9896),n=r(6928),o=r(3480),a=r(3231),s={dir:"persist",stringify:JSON.stringify,parse:JSON.parse,encoding:"utf8",logging:!1,continuous:!0,interval:!1,ttl:!1},c=function(e){return"function"==typeof e},u=function(e){if(e)throw e},l=function(){},h=function(e){if(!(this instanceof h))return new h(e);this.data={},this.ttls={},this.changes={},this.setOptions(e)};h.prototype={setOptions:function(e){var t,r={};if(e){for(var i in s)e.hasOwnProperty(i)?r[i]=e[i]:r[i]=s[i];r.dir=this.resolveDir(r.dir),r.ttlDir=r.dir+"-ttl",r.ttl=!!r.ttl&&(t=r.ttl,!isNaN(parseFloat(t))&&isFinite(t)&&r.ttl>0?r.ttl:864e5)}else r=s;c(r.logging)&&(this.log=r.logging,r.logging=!0),this.options=r},init:function(e,t){c(e)&&(t=e,e=null),e&&this.setOptions(e),t=c(t)?t:u;var r=a.defer(),i=[],n=this.options,o={dir:n.dir};return i.push(this.parseDataDir()),n.ttl&&(o.ttlDir=n.ttlDir,i.push(this.parseTTLDir())),n.interval&&n.interval>0&&(this._persistInterval=setInterval(this.persist.bind(this),n.interval)),a.all(i).then((function(){r.resolve(o),t(null,o)}),(function(e){r.reject(e),t(e)})),r.promise},initSync:function(e){e&&this.setOptions(e);var t=this.options;t.logging&&(this.log("options:"),this.log(t.stringify(t))),this.parseDataDirSync(),t.ttl&&this.parseTTLDirSync(),t.interval&&t.interval>0&&(this._persistInterval=setInterval(this.persistSync.bind(this),t.interval))},key:function(e){var t=this.keys();return t.length<=e?null:t[e]},keys:function(){return Object.keys(this.data)},length:function(){return this.keys().length},forEach:function(e){return this.keys().forEach(function(t){e(t,this.data[t])}.bind(this))},values:function(e){e=c(e)?e:l;var t=this.keys().map(function(e){return this.data[e]}.bind(this));return e(t),t},valuesWithKeyMatch:function(e,t){t=c(t)?t:l;var r=(e=e||/.*/)instanceof RegExp?function(t){return e.test(t)}:function(t){return-1!==t.indexOf(e)},i=[];return this.keys().forEach(function(e){r(e)&&i.push(this.data[e])}.bind(this)),t(i),i},setItem:function(e,t,r){r=c(r)?r:u;var i,n=this.options,o="set ("+e+": "+n.stringify(t)+")",s=a.defer(),l=[];this.data[e]=t,n.ttl&&(this.ttls[e]=(new Date).getTime()+n.ttl),i={key:e,value:t,queued:!!n.interval,manual:!n.interval&&!n.continuous};return this.log(o),n.interval||!n.continuous?this.changes[e]={onSuccess:function(){r(null,i),s.resolve(i)},onError:function(e){r(e),s.reject(e)}}:(l.push(this.persistKey(e)),a.all(l).then(function(e){s.resolve(e),r(null,e)}.bind(this),(function(e){s.reject(e),r(e)}))),s.promise},setItemSync:function(e,t){this.data[e]=t,this.options.ttl&&(this.ttls[e]=(new Date).getTime()+this.options.ttl),this.persistKeySync(e),this.log("set ("+e+": "+this.options.stringify(t)+")")},getItem:function(e,t){if(t=c(t)?t:u,!this.isExpired(e))return t(null,this.data[e]),this.data[e];this.log(e+" has expired"),!this.options.interval&&this.options.continuous?this.removeItem(e,(function(){t(null,null)})):t(null,null)},getItemSync:function(e){if(!this.isExpired(e))return this.data[e];this.removeItemSync(e)},removeItem:function(e,t){t=c(t)?t:u;var r=a.defer(),i=[];return i.push(this.removePersistedKey(e)),a.all(i).then(function(){delete this.data[e],delete this.ttls[e],this.log("removed: "+e),t(null,this.data),r.resolve(this.data)}.bind(this),(function(e){t(e),r.reject(e)})),r.promise},removeItemSync:function(e){this.removePersistedKeySync(e),delete this.data[e],delete this.ttls[e],this.log("removed: "+e)},clear:function(e){e=c(e)?e:u;for(var t=a.defer(),r=[],i=this.keys(),n=0;n<i.length;n++)r.push(this.removePersistedKey(i[n]));return a.all(r).then(function(r){this.data={},this.ttls={},this.changes={},t.resolve(r),e(null,r)}.bind(this),(function(r){t.reject(r),e(r)})),t.promise},clearSync:function(){for(var e=this.keys(!0),t=0;t<e.length;t++)this.removePersistedKeySync(e[t]);this.data={},this.ttls={},this.changes={}},persist:function(e){e=c(e)?e:u;var t=a.defer(),r=[];for(var i in this.data)this.changes[i]&&r.push(this.persistKey(i));return a.all(r).then(function(r){t.resolve(r),e(null,r),this.log("persist done")}.bind(this),(function(r){t.reject(undefined),e(r)})),t.promise},persistSync:function(){for(var e in this.data)this.changes[e]&&this.persistKeySync(e);this.log("persistSync done")},persistKey:function(e,t){t=c(t)?t:u;var r,s,l=this,h=this.options,d=h.stringify(this.data[e]),p=n.join(h.dir,e),f=a.defer(),g=function(r){return l.changes[e]&&l.changes[e].onError&&l.changes[e].onError(r),f.reject(r),t(r)},m=function(){l.changes[e]&&l.changes[e].onSuccess&&l.changes[e].onSuccess(),delete l.changes[e],l.log("wrote: "+e),s={key:e,data:d,file:p},f.resolve(s),t(null,s)};return o(n.dirname(p),(function(t){t&&g(t),i.writeFile(p,d,h.encoding,function(t){t&&g(t),h.ttl?(r=n.join(h.ttlDir,e),o(n.dirname(r),(function(t){i.writeFile(r,h.stringify(l.ttls[e]),h.encoding,(function(){t?g(t):m()}))}))):m()}.bind(this))})),f.promise},persistKeySync:function(e){var t,r=this.options,a=n.join(r.dir,e);try{o.sync(n.dirname(a)),i.writeFileSync(a,r.stringify(this.data[e])),this.changes[e]&&this.changes[e].onSuccess&&this.changes[e].onSuccess()}catch(t){throw this.changes[e]&&this.changes[e].onError&&this.changes[e].onError(t),t}r.ttl&&(t=n.join(r.ttlDir,e),o.sync(n.dirname(t)),i.writeFileSync(t,r.stringify(this.ttls[e]))),delete this.changes[e],this.log("wrote: "+e)},removePersistedKey:function(e,t){t=c(t)?t:u;var r,o=this.options,s=a.defer(),l=n.join(o.dir,e);return i.exists(l,(function(a){a?i.unlink(l,(function(a){r={key:e,removed:!a,exists:!0};var c=function(e){s.reject(e),t(e)},u=function(){s.resolve(r),t(null,r)};if(a)return c(a);if(o.ttl){var l=n.join(o.ttlDir,e);i.exists(l,(function(e){e?i.unlink(l,(function(e){e&&c(e),u()})):u()}))}else u()})):(r={key:e,removed:!1,exists:!1},s.resolve(r),t(null,r))})),s.promise},parseString:function(e){try{return this.options.parse(e)}catch(e){return void this.log("parse error: ",this.options.stringify(e))}},parseTTLDir:function(e){return this.parseDir(this.options.ttlDir,this.parseTTLFile.bind(this),e)},parseTTLDirSync:function(){return this.parseDirSync(this.options.ttlDir,this.ttls)},parseDataDir:function(e){return this.parseDir(this.options.dir,this.parseDataFile.bind(this),e)},parseDataDirSync:function(){return this.parseDirSync(this.options.dir,this.data)},parseDir:function(e,t,r){r=c(r)?r:u;var n=a.defer(),s=[],l={dir:e};return i.exists(e,function(c){c?i.readdir(e,function(e,i){for(var o in e&&(n.reject(e),r(e)),i){var c=i[o];"."!==c[0]&&s.push(t(c))}a.all(s).then((function(){n.resolve(l),r(null,l)}),(function(e){n.reject(e),r(e)}))}.bind(this)):o(e,function(t){t?(console.error(t),n.reject(t),r(t)):(this.log("created "+e),n.resolve(l),r(null,l))}.bind(this))}.bind(this)),n.promise},parseDirSync:function(e,t){if(i.existsSync(e))for(var r=i.readdirSync(e),a=0;a<r.length;a++){var s=r[a];if(r[a]&&"."!==s[0]){var c=i.readFileSync(n.join(e,s),this.options.encoding);t[s]=this.parseString(c)}}else o.sync(e)},parseDataFile:function(e,t){return this.parseFile(e,this.options.dir,this.data,t)},parseDataFileSync:function(e){return this.parseFileSync(e,this.options.dir,this.data)},parseTTLFile:function(e,t){return this.parseFile(e,this.options.ttlDir,this.ttls,t)},parseTTLFileSync:function(e){return this.parseFileSync(e,this.options.ttlDir,this.ttls)},parseFile:function(e,t,r,o){o=c(o)?o:u;var s,l=a.defer(),h=n.join(t,e),d=this.options;return i.readFile(h,d.encoding,function(i,n){if(i)return l.reject(i),o(i);var a=this.parseString(n);r[e]=a,this.log("loaded: "+t+"/"+e),s={key:e,value:a,file:h},l.resolve(s),o(null,s)}.bind(this)),l.promise},parseFileSync:function(e,t,r){var o=n.join(t,e);return r[e]=i.readFileSync(o,this.options.encoding),this.log("loaded: "+t+"/"+e),r[e]},isExpired:function(e){return!!this.options.ttl&&this.ttls[e]<(new Date).getTime()},removePersistedKeySync:function(e){var t=this.options,r=n.join(t.dir,e);if(i.existsSync(r)&&i.unlinkSync(r),t.ttl){var o=n.join(t.ttlDir,e);i.existsSync(o)&&i.unlinkSync(o)}},resolveDir:function(e){return(e=n.normalize(e))!==n.resolve(e)&&(e=n.join(__dirname,"storage",e||""),this.log("Made dir absolute: "+e)),e},stopInterval:function(){clearInterval(this._persistInterval)},log:function(){this.options&&this.options.logging&&console.log.apply(console,arguments)}},e.exports=h},3396:(e,t,r)=>{var i=r(1566);!function(e){var t;e.create=function(e){return i(e)},e.init=function(r,i){return(t=e.create(r)).init(i)},e.initSync=function(r){return(t=e.create(r)).initSync()},e.key=function(e){return t.key(e)},e.keys=function(){return t.keys()},e.length=function(){return t.length()},e.forEach=function(e){return t.forEach(e)},e.values=function(e){return t.values(e)},e.valuesWithKeyMatch=function(e,r){return t.valuesWithKeyMatch(e,r)},e.setItem=function(e,r,i){return t.setItem(e,r,i)},e.setItemSync=function(e,r){return t.setItemSync(e,r)},e.getItem=function(e,r){return t.getItem(e,r)},e.getItemSync=function(e){return t.getItemSync(e)},e.removeItem=function(e,r){return t.removeItem(e,r)},e.removeItemSync=function(e){return t.removeItemSync(e)},e.clear=function(e){return t.clear(e)},e.clearSync=function(){return t.clearSync()},e.persist=function(e){return t.persist(e)},e.persistSync=function(){return t.persistSync()},e.persistKey=function(e,r){return t.persistKey(e,r)},e.persistKeySync=function(e){return t.persistKeySync(e)}}(e.exports)},8859:(e,t,r)=>{var i="function"==typeof Map&&Map.prototype,n=Object.getOwnPropertyDescriptor&&i?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,o=i&&n&&"function"==typeof n.get?n.get:null,a=i&&Map.prototype.forEach,s="function"==typeof Set&&Set.prototype,c=Object.getOwnPropertyDescriptor&&s?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,u=s&&c&&"function"==typeof c.get?c.get:null,l=s&&Set.prototype.forEach,h="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,d="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,p="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,f=Boolean.prototype.valueOf,g=Object.prototype.toString,m=Function.prototype.toString,v=String.prototype.match,y=String.prototype.slice,C=String.prototype.replace,S=String.prototype.toUpperCase,E=String.prototype.toLowerCase,_=RegExp.prototype.test,T=Array.prototype.concat,A=Array.prototype.join,I=Array.prototype.slice,D=Math.floor,w="function"==typeof BigInt?BigInt.prototype.valueOf:null,b=Object.getOwnPropertySymbols,U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,R="function"==typeof Symbol&&"object"==typeof Symbol.iterator,O="function"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===R||"symbol")?Symbol.toStringTag:null,N=Object.prototype.propertyIsEnumerable,P=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function B(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||_.call(/e/,t))return t;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof e){var i=e<0?-D(-e):D(e);if(i!==e){var n=String(i),o=y.call(t,n.length+1);return C.call(n,r,"$&_")+"."+C.call(C.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return C.call(t,r,"$&_")}var L=r(8093),x=L.custom,M=j(x)?x:null;function F(e,t,r){var i="double"===(r.quoteStyle||t)?'"':"'";return i+e+i}function k(e){return C.call(String(e),/"/g,"&quot;")}function V(e){return!("[object Array]"!==Y(e)||O&&"object"==typeof e&&O in e)}function H(e){return!("[object RegExp]"!==Y(e)||O&&"object"==typeof e&&O in e)}function j(e){if(R)return e&&"object"==typeof e&&e instanceof Symbol;if("symbol"==typeof e)return!0;if(!e||"object"!=typeof e||!U)return!1;try{return U.call(e),!0}catch(e){}return!1}e.exports=function e(t,r,i,n){var s=r||{};if(W(s,"quoteStyle")&&"single"!==s.quoteStyle&&"double"!==s.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(W(s,"maxStringLength")&&("number"==typeof s.maxStringLength?s.maxStringLength<0&&s.maxStringLength!==1/0:null!==s.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var c=!W(s,"customInspect")||s.customInspect;if("boolean"!=typeof c&&"symbol"!==c)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(W(s,"indent")&&null!==s.indent&&"\t"!==s.indent&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(W(s,"numericSeparator")&&"boolean"!=typeof s.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var g=s.numericSeparator;if(void 0===t)return"undefined";if(null===t)return"null";if("boolean"==typeof t)return t?"true":"false";if("string"==typeof t)return K(t,s);if("number"==typeof t){if(0===t)return 1/0/t>0?"0":"-0";var S=String(t);return g?B(t,S):S}if("bigint"==typeof t){var _=String(t)+"n";return g?B(t,_):_}var D=void 0===s.depth?5:s.depth;if(void 0===i&&(i=0),i>=D&&D>0&&"object"==typeof t)return V(t)?"[Array]":"[Object]";var b=function(e,t){var r;if("\t"===e.indent)r="\t";else{if(!("number"==typeof e.indent&&e.indent>0))return null;r=A.call(Array(e.indent+1)," ")}return{base:r,prev:A.call(Array(t+1),r)}}(s,i);if(void 0===n)n=[];else if(q(n,t)>=0)return"[Circular]";function x(t,r,o){if(r&&(n=I.call(n)).push(r),o){var a={depth:s.depth};return W(s,"quoteStyle")&&(a.quoteStyle=s.quoteStyle),e(t,a,i+1,n)}return e(t,s,i+1,n)}if("function"==typeof t&&!H(t)){var G=function(e){if(e.name)return e.name;var t=v.call(m.call(e),/^function\s*([\w$]+)/);if(t)return t[1];return null}(t),$=Z(t,x);return"[Function"+(G?": "+G:" (anonymous)")+"]"+($.length>0?" { "+A.call($,", ")+" }":"")}if(j(t)){var ee=R?C.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):U.call(t);return"object"!=typeof t||R?ee:z(ee)}if(function(e){if(!e||"object"!=typeof e)return!1;if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return"string"==typeof e.nodeName&&"function"==typeof e.getAttribute}(t)){for(var te="<"+E.call(String(t.nodeName)),re=t.attributes||[],ie=0;ie<re.length;ie++)te+=" "+re[ie].name+"="+F(k(re[ie].value),"double",s);return te+=">",t.childNodes&&t.childNodes.length&&(te+="..."),te+="</"+E.call(String(t.nodeName))+">"}if(V(t)){if(0===t.length)return"[]";var ne=Z(t,x);return b&&!function(e){for(var t=0;t<e.length;t++)if(q(e[t],"\n")>=0)return!1;return!0}(ne)?"["+J(ne,b)+"]":"[ "+A.call(ne,", ")+" ]"}if(function(e){return!("[object Error]"!==Y(e)||O&&"object"==typeof e&&O in e)}(t)){var oe=Z(t,x);return"cause"in Error.prototype||!("cause"in t)||N.call(t,"cause")?0===oe.length?"["+String(t)+"]":"{ ["+String(t)+"] "+A.call(oe,", ")+" }":"{ ["+String(t)+"] "+A.call(T.call("[cause]: "+x(t.cause),oe),", ")+" }"}if("object"==typeof t&&c){if(M&&"function"==typeof t[M]&&L)return L(t,{depth:D-i});if("symbol"!==c&&"function"==typeof t.inspect)return t.inspect()}if(function(e){if(!o||!e||"object"!=typeof e)return!1;try{o.call(e);try{u.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var ae=[];return a&&a.call(t,(function(e,r){ae.push(x(r,t,!0)+" => "+x(e,t))})),X("Map",o.call(t),ae,b)}if(function(e){if(!u||!e||"object"!=typeof e)return!1;try{u.call(e);try{o.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var se=[];return l&&l.call(t,(function(e){se.push(x(e,t))})),X("Set",u.call(t),se,b)}if(function(e){if(!h||!e||"object"!=typeof e)return!1;try{h.call(e,h);try{d.call(e,d)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return Q("WeakMap");if(function(e){if(!d||!e||"object"!=typeof e)return!1;try{d.call(e,d);try{h.call(e,h)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return Q("WeakSet");if(function(e){if(!p||!e||"object"!=typeof e)return!1;try{return p.call(e),!0}catch(e){}return!1}(t))return Q("WeakRef");if(function(e){return!("[object Number]"!==Y(e)||O&&"object"==typeof e&&O in e)}(t))return z(x(Number(t)));if(function(e){if(!e||"object"!=typeof e||!w)return!1;try{return w.call(e),!0}catch(e){}return!1}(t))return z(x(w.call(t)));if(function(e){return!("[object Boolean]"!==Y(e)||O&&"object"==typeof e&&O in e)}(t))return z(f.call(t));if(function(e){return!("[object String]"!==Y(e)||O&&"object"==typeof e&&O in e)}(t))return z(x(String(t)));if("undefined"!=typeof window&&t===window)return"{ [object Window] }";if("undefined"!=typeof globalThis&&t===globalThis||"undefined"!=typeof global&&t===global)return"{ [object globalThis] }";if(!function(e){return!("[object Date]"!==Y(e)||O&&"object"==typeof e&&O in e)}(t)&&!H(t)){var ce=Z(t,x),ue=P?P(t)===Object.prototype:t instanceof Object||t.constructor===Object,le=t instanceof Object?"":"null prototype",he=!ue&&O&&Object(t)===t&&O in t?y.call(Y(t),8,-1):le?"Object":"",de=(ue||"function"!=typeof t.constructor?"":t.constructor.name?t.constructor.name+" ":"")+(he||le?"["+A.call(T.call([],he||[],le||[]),": ")+"] ":"");return 0===ce.length?de+"{}":b?de+"{"+J(ce,b)+"}":de+"{ "+A.call(ce,", ")+" }"}return String(t)};var G=Object.prototype.hasOwnProperty||function(e){return e in this};function W(e,t){return G.call(e,t)}function Y(e){return g.call(e)}function q(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1}function K(e,t){if(e.length>t.maxStringLength){var r=e.length-t.maxStringLength,i="... "+r+" more character"+(r>1?"s":"");return K(y.call(e,0,t.maxStringLength),t)+i}return F(C.call(C.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,$),"single",t)}function $(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+S.call(t.toString(16))}function z(e){return"Object("+e+")"}function Q(e){return e+" { ? }"}function X(e,t,r,i){return e+" ("+t+") {"+(i?J(r,i):A.call(r,", "))+"}"}function J(e,t){if(0===e.length)return"";var r="\n"+t.prev+t.base;return r+A.call(e,","+r)+"\n"+t.prev}function Z(e,t){var r=V(e),i=[];if(r){i.length=e.length;for(var n=0;n<e.length;n++)i[n]=W(e,n)?t(e[n],e):""}var o,a="function"==typeof b?b(e):[];if(R){o={};for(var s=0;s<a.length;s++)o["$"+a[s]]=a[s]}for(var c in e)W(e,c)&&(r&&String(Number(c))===c&&c<e.length||R&&o["$"+c]instanceof Symbol||(_.call(/[^\w$]/,c)?i.push(t(c,e)+": "+t(e[c],e)):i.push(c+": "+t(e[c],e))));if("function"==typeof b)for(var u=0;u<a.length;u++)N.call(e,a[u])&&i.push("["+t(a[u])+"]: "+t(e[a[u]],e));return i}},8093:(e,t,r)=>{e.exports=r(9023).inspect},9211:e=>{"use strict";var t=function(e){return e!=e};e.exports=function(e,r){return 0===e&&0===r?1/e==1/r:e===r||!(!t(e)||!t(r))}},7653:(e,t,r)=>{"use strict";var i=r(8452),n=r(487),o=r(9211),a=r(9394),s=r(6576),c=n(a(),Object);i(c,{getPolyfill:a,implementation:o,shim:s}),e.exports=c},9394:(e,t,r)=>{"use strict";var i=r(9211);e.exports=function(){return"function"==typeof Object.is?Object.is:i}},6576:(e,t,r)=>{"use strict";var i=r(9394),n=r(8452);e.exports=function(){var e=i();return n(Object,{is:e},{is:function(){return Object.is!==e}}),e}},8875:(e,t,r)=>{"use strict";var i;if(!Object.keys){var n=Object.prototype.hasOwnProperty,o=Object.prototype.toString,a=r(1093),s=Object.prototype.propertyIsEnumerable,c=!s.call({toString:null},"toString"),u=s.call((function(){}),"prototype"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],h=function(e){var t=e.constructor;return t&&t.prototype===e},d={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},p=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!d["$"+e]&&n.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{h(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();i=function(e){var t=null!==e&&"object"==typeof e,r="[object Function]"===o.call(e),i=a(e),s=t&&"[object String]"===o.call(e),d=[];if(!t&&!r&&!i)throw new TypeError("Object.keys called on a non-object");var f=u&&r;if(s&&e.length>0&&!n.call(e,0))for(var g=0;g<e.length;++g)d.push(String(g));if(i&&e.length>0)for(var m=0;m<e.length;++m)d.push(String(m));else for(var v in e)f&&"prototype"===v||!n.call(e,v)||d.push(String(v));if(c)for(var y=function(e){if("undefined"==typeof window||!p)return h(e);try{return h(e)}catch(e){return!1}}(e),C=0;C<l.length;++C)y&&"constructor"===l[C]||!n.call(e,l[C])||d.push(l[C]);return d}}e.exports=i},1189:(e,t,r)=>{"use strict";var i=Array.prototype.slice,n=r(1093),o=Object.keys,a=o?function(e){return o(e)}:r(8875),s=Object.keys;a.shim=function(){if(Object.keys){var e=function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2);e||(Object.keys=function(e){return n(e)?s(i.call(e)):s(e)})}else Object.keys=a;return Object.keys||a},e.exports=a},1093:e=>{"use strict";var t=Object.prototype.toString;e.exports=function(e){var r=t.call(e),i="[object Arguments]"===r;return i||(i="[object Array]"!==r&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===t.call(e.callee)),i}},8403:(e,t,r)=>{"use strict";var i=r(1189),n=r(1333)(),o=r(8075),a=Object,s=o("Array.prototype.push"),c=o("Object.prototype.propertyIsEnumerable"),u=n?Object.getOwnPropertySymbols:null;e.exports=function(e,t){if(null==e)throw new TypeError("target must be an object");var r=a(e);if(1===arguments.length)return r;for(var o=1;o<arguments.length;++o){var l=a(arguments[o]),h=i(l),d=n&&(Object.getOwnPropertySymbols||u);if(d)for(var p=d(l),f=0;f<p.length;++f){var g=p[f];c(l,g)&&s(h,g)}for(var m=0;m<h.length;++m){var v=h[m];if(c(l,v)){var y=l[v];r[v]=y}}}return r}},6525:(e,t,r)=>{"use strict";var i=r(8452),n=r(487),o=r(8403),a=r(1514),s=r(984),c=n.apply(a()),u=function(e,t){return c(Object,arguments)};i(u,{getPolyfill:a,implementation:o,shim:s}),e.exports=u},1514:(e,t,r)=>{"use strict";var i=r(8403);e.exports=function(){return Object.assign?function(){if(!Object.assign)return!1;for(var e="abcdefghijklmnopqrst",t=e.split(""),r={},i=0;i<t.length;++i)r[t[i]]=t[i];var n=Object.assign({},r),o="";for(var a in n)o+=a;return e!==o}()||function(){if(!Object.assign||!Object.preventExtensions)return!1;var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(t){return"y"===e[1]}return!1}()?i:Object.assign:i}},984:(e,t,r)=>{"use strict";var i=r(8452),n=r(1514);e.exports=function(){var e=n();return i(Object,{assign:e},{assign:function(){return Object.assign!==e}}),e}},6736:(e,t,r)=>{e.exports=r(1094)},4280:(e,t,r)=>{const i=r(9278),n=r(5753)("pick-port"),o=r(5753)("pick-port:WARN"),a=r(67),s=r(9615);n.log=console.debug.bind(console),o.log=console.warn.bind(console);const c=new Set;function u({type:e,ip:t,port:r,reserveTimeout:i}){const n=`${e}:${t}:${r}`;c.add(n),setTimeout((()=>c.delete(n)),1e3*i)}function l({type:e,ip:t,port:r}){const i=`${e}:${t}:${r}`;return c.has(i)}e.exports=async function({type:e="udp",ip:t="0.0.0.0",minPort:r=1e4,maxPort:c=2e4,reserveTimeout:h=5}={}){n("called with [type:%s, ip:%s, minPort:%d, maxPort:%d, reserveTimeout:%d]",e,t,r,c,h),e=e.toLowerCase();const d=i.isIP(t);if("udp"!==e&&"tcp"!==e)throw new TypeError("invalid type parameter");if(4!==d&&6!==d)throw new TypeError("invalid ip parameter");if("number"!=typeof r||"number"!=typeof c||r>c)throw new TypeError("invalid minPort/maxPort parameter");if("number"!=typeof h)throw new TypeError("invalid reserveTimeout parameter");const p="udp"===e?s:a;let f=Math.floor(Math.random()*(c+1-r))+r,g=c-r+1;for(;--g>=0;)if(++f>c&&(f=r),!l({type:e,ip:t,port:f}))try{return await p({ip:t,port:f,family:d}),u({type:e,ip:t,port:f,reserveTimeout:h}),n("got an available port [type:%s, ip:%s, port:%d]",e,t,f),f}catch(r){if("EADDRINUSE"===r.code){n("port in use [type:%s, ip:%s, port:%d]",e,t,f);continue}throw o("could not get any available port [type:%s, ip:%s, port:%d]: %s",e,t,f,r.toString()),r}throw new Error("no port available")}},67:(e,t,r)=>{const i=r(9278);e.exports=async function({ip:e,port:t}){const r=i.createServer();return new Promise(((i,n)=>{r.unref(),r.on("error",n),r.listen({port:t,exclusive:!0},e,(()=>r.close(i)))}))}},9615:(e,t,r)=>{const i=r(7194);e.exports=async function({ip:e,port:t,family:r}){const n=i.createSocket(4===r?"udp4":"udp6");return new Promise(((r,i)=>{n.unref(),n.on("error",i),n.bind({port:t,exclusive:!0},e,(()=>n.close(r)))}))}},6578:e=>{"use strict";e.exports=["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]},3231:e=>{
/*!
 *
 * Copyright 2009-2012 Kris Kowal under the terms of the MIT
 * license found at http://github.com/kriskowal/q/raw/master/LICENSE
 *
 * With parts by Tyler Close
 * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found
 * at http://www.opensource.org/licenses/mit-license.html
 * Forked at ref_send.js version: 2009-05-11
 *
 * With parts by Mark Miller
 * Copyright (C) 2011 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */
!function(t){"use strict";"function"==typeof bootstrap?bootstrap("promise",t):e.exports=t()}((function(){"use strict";var e=!1;try{throw new Error}catch(t){e=!!t.stack}var t,r=E(),i=function(){},n=function(){var e={task:void 0,next:null},t=e,r=!1,i=void 0,o=!1;function a(){for(;e.next;){var t=(e=e.next).task;e.task=void 0;var i=e.domain;i&&(e.domain=void 0,i.enter());try{t()}catch(e){if(o)throw i&&i.exit(),setTimeout(a,0),i&&i.enter(),e;setTimeout((function(){throw e}),0)}i&&i.exit()}r=!1}if(n=function(e){t=t.next={task:e,domain:o&&process.domain,next:null},r||(r=!0,i())},"undefined"!=typeof process&&process.nextTick)o=!0,i=function(){process.nextTick(a)};else if("function"==typeof setImmediate)i="undefined"!=typeof window?setImmediate.bind(window,a):function(){setImmediate(a)};else if("undefined"!=typeof MessageChannel){var s=new MessageChannel;s.port1.onmessage=function(){i=c,s.port1.onmessage=a,a()};var c=function(){s.port2.postMessage(0)};i=function(){setTimeout(a,0),c()}}else i=function(){setTimeout(a,0)};return n}(),o=Function.call;function a(e){return function(){return o.apply(e,arguments)}}var s,c=a(Array.prototype.slice),u=a(Array.prototype.reduce||function(e,t){var r=0,i=this.length;if(1===arguments.length)for(;;){if(r in this){t=this[r++];break}if(++r>=i)throw new TypeError}for(;r<i;r++)r in this&&(t=e(t,this[r],r));return t}),l=a(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),h=a(Array.prototype.map||function(e,t){var r=this,i=[];return u(r,(function(n,o,a){i.push(e.call(t,o,a,r))}),void 0),i}),d=Object.create||function(e){function t(){}return t.prototype=e,new t},p=a(Object.prototype.hasOwnProperty),f=Object.keys||function(e){var t=[];for(var r in e)p(e,r)&&t.push(r);return t},g=a(Object.prototype.toString);s="undefined"!=typeof ReturnValue?ReturnValue:function(e){this.value=e};var m="From previous event:";function v(t,r){if(e&&r.stack&&"object"==typeof t&&null!==t&&t.stack&&-1===t.stack.indexOf(m)){for(var i=[],n=r;n;n=n.source)n.stack&&i.unshift(n.stack);i.unshift(t.stack);var o=i.join("\n"+m+"\n");t.stack=function(e){for(var t=e.split("\n"),r=[],i=0;i<t.length;++i){var n=t[i];S(n)||y(n)||!n||r.push(n)}return r.join("\n")}(o)}}function y(e){return-1!==e.indexOf("(module.js:")||-1!==e.indexOf("(node.js:")}function C(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t)return[t[1],Number(t[2])];var r=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(r)return[r[1],Number(r[2])];var i=/.*@(.+):(\d+)$/.exec(e);return i?[i[1],Number(i[2])]:void 0}function S(e){var i=C(e);if(!i)return!1;var n=i[0],o=i[1];return n===t&&o>=r&&o<=W}function E(){if(e)try{throw new Error}catch(e){var r=e.stack.split("\n"),i=C(r[0].indexOf("@")>0?r[1]:r[2]);if(!i)return;return t=i[0],i[1]}}function _(e){return e instanceof D?e:R(e)?function(e){var t=T();return _.nextTick((function(){try{e.then(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}})),t.promise}(e):k(e)}function T(){var t,r=[],i=[],n=d(T.prototype),o=d(D.prototype);if(o.promiseDispatch=function(e,n,o){var a=c(arguments);r?(r.push(a),"when"===n&&o[1]&&i.push(o[1])):_.nextTick((function(){t.promiseDispatch.apply(t,a)}))},o.valueOf=function(){if(r)return o;var e=b(t);return U(e)&&(t=e),e},o.inspect=function(){return t?t.inspect():{state:"pending"}},_.longStackSupport&&e)try{throw new Error}catch(e){o.stack=e.stack.substring(e.stack.indexOf("\n")+1)}function a(e){t=e,o.source=e,u(r,(function(t,r){_.nextTick((function(){e.promiseDispatch.apply(e,r)}))}),void 0),r=void 0,i=void 0}return n.promise=o,n.resolve=function(e){t||a(_(e))},n.fulfill=function(e){t||a(k(e))},n.reject=function(e){t||a(F(e))},n.notify=function(e){t||u(i,(function(t,r){_.nextTick((function(){r(e)}))}),void 0)},n}function A(e){if("function"!=typeof e)throw new TypeError("resolver must be a function.");var t=T();try{e(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}return t.promise}function I(e){return A((function(t,r){for(var i=0,n=e.length;i<n;i++)_(e[i]).then(t,r)}))}function D(e,t,r){void 0===t&&(t=function(e){return F(new Error("Promise does not support operation: "+e))}),void 0===r&&(r=function(){return{state:"unknown"}});var i=d(D.prototype);if(i.promiseDispatch=function(r,n,o){var a;try{a=e[n]?e[n].apply(i,o):t.call(i,n,o)}catch(e){a=F(e)}r&&r(a)},i.inspect=r,r){var n=r();"rejected"===n.state&&(i.exception=n.reason),i.valueOf=function(){var e=r();return"pending"===e.state||"rejected"===e.state?i:e.value}}return i}function w(e,t,r,i){return _(e).then(t,r,i)}function b(e){if(U(e)){var t=e.inspect();if("fulfilled"===t.state)return t.value}return e}function U(e){return e instanceof D}function R(e){return(t=e)===Object(t)&&"function"==typeof e.then;var t}_.resolve=_,_.nextTick=n,_.longStackSupport=!1,"object"==typeof process&&process&&process.env&&process.env.Q_DEBUG&&(_.longStackSupport=!0),_.defer=T,T.prototype.makeNodeResolver=function(){var e=this;return function(t,r){t?e.reject(t):arguments.length>2?e.resolve(c(arguments,1)):e.resolve(r)}},_.Promise=A,_.promise=A,A.race=I,A.all=j,A.reject=F,A.resolve=_,_.passByCopy=function(e){return e},D.prototype.passByCopy=function(){return this},_.join=function(e,t){return _(e).join(t)},D.prototype.join=function(e){return _([this,e]).spread((function(e,t){if(e===t)return e;throw new Error("Can't join: not the same: "+e+" "+t)}))},_.race=I,D.prototype.race=function(){return this.then(_.race)},_.makePromise=D,D.prototype.toString=function(){return"[object Promise]"},D.prototype.then=function(e,t,r){var i=this,n=T(),o=!1;return _.nextTick((function(){i.promiseDispatch((function(t){o||(o=!0,n.resolve(function(t){try{return"function"==typeof e?e(t):t}catch(e){return F(e)}}(t)))}),"when",[function(e){o||(o=!0,n.resolve(function(e){if("function"==typeof t){v(e,i);try{return t(e)}catch(e){return F(e)}}return F(e)}(e)))}])})),i.promiseDispatch(void 0,"when",[void 0,function(e){var t,i=!1;try{t=function(e){return"function"==typeof r?r(e):e}(e)}catch(e){if(i=!0,!_.onerror)throw e;_.onerror(e)}i||n.notify(t)}]),n.promise},_.tap=function(e,t){return _(e).tap(t)},D.prototype.tap=function(e){return e=_(e),this.then((function(t){return e.fcall(t).thenResolve(t)}))},_.when=w,D.prototype.thenResolve=function(e){return this.then((function(){return e}))},_.thenResolve=function(e,t){return _(e).thenResolve(t)},D.prototype.thenReject=function(e){return this.then((function(){throw e}))},_.thenReject=function(e,t){return _(e).thenReject(t)},_.nearer=b,_.isPromise=U,_.isPromiseAlike=R,_.isPending=function(e){return U(e)&&"pending"===e.inspect().state},D.prototype.isPending=function(){return"pending"===this.inspect().state},_.isFulfilled=function(e){return!U(e)||"fulfilled"===e.inspect().state},D.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},_.isRejected=function(e){return U(e)&&"rejected"===e.inspect().state},D.prototype.isRejected=function(){return"rejected"===this.inspect().state};var O,N,P,B=[],L=[],x=!0;function M(){B.length=0,L.length=0,x||(x=!0)}function F(e){var t=D({when:function(t){return t&&function(e){if(x){var t=l(L,e);-1!==t&&(L.splice(t,1),B.splice(t,1))}}(this),t?t(e):this}},(function(){return this}),(function(){return{state:"rejected",reason:e}}));return function(e,t){x&&(L.push(e),t&&void 0!==t.stack?B.push(t.stack):B.push("(no stack) "+t))}(t,e),t}function k(e){return D({when:function(){return e},get:function(t){return e[t]},set:function(t,r){e[t]=r},delete:function(t){delete e[t]},post:function(t,r){return null==t?e.apply(void 0,r):e[t].apply(e,r)},apply:function(t,r){return e.apply(t,r)},keys:function(){return f(e)}},void 0,(function(){return{state:"fulfilled",value:e}}))}function V(e,t,r){return _(e).spread(t,r)}function H(e,t,r){return _(e).dispatch(t,r)}function j(e){return w(e,(function(e){var t=0,r=T();return u(e,(function(i,n,o){var a;U(n)&&"fulfilled"===(a=n.inspect()).state?e[o]=a.value:(++t,w(n,(function(i){e[o]=i,0==--t&&r.resolve(e)}),r.reject,(function(e){r.notify({index:o,value:e})})))}),void 0),0===t&&r.resolve(e),r.promise}))}function G(e){return w(e,(function(e){return e=h(e,_),w(j(h(e,(function(e){return w(e,i,i)}))),(function(){return e}))}))}_.resetUnhandledRejections=M,_.getUnhandledReasons=function(){return B.slice()},_.stopUnhandledRejectionTracking=function(){M(),x=!1},M(),_.reject=F,_.fulfill=k,_.master=function(e){return D({isDef:function(){}},(function(t,r){return H(e,t,r)}),(function(){return _(e).inspect()}))},_.spread=V,D.prototype.spread=function(e,t){return this.all().then((function(t){return e.apply(void 0,t)}),t)},_.async=function(e){return function(){function t(e,t){var o;if("undefined"==typeof StopIteration){try{o=r[e](t)}catch(e){return F(e)}return o.done?_(o.value):w(o.value,i,n)}try{o=r[e](t)}catch(e){return function(e){return"[object StopIteration]"===g(e)||e instanceof s}(e)?_(e.value):F(e)}return w(o,i,n)}var r=e.apply(this,arguments),i=t.bind(t,"next"),n=t.bind(t,"throw");return i()}},_.spawn=function(e){_.done(_.async(e)())},_.return=function(e){throw new s(e)},_.promised=function(e){return function(){return V([this,j(arguments)],(function(t,r){return e.apply(t,r)}))}},_.dispatch=H,D.prototype.dispatch=function(e,t){var r=this,i=T();return _.nextTick((function(){r.promiseDispatch(i.resolve,e,t)})),i.promise},_.get=function(e,t){return _(e).dispatch("get",[t])},D.prototype.get=function(e){return this.dispatch("get",[e])},_.set=function(e,t,r){return _(e).dispatch("set",[t,r])},D.prototype.set=function(e,t){return this.dispatch("set",[e,t])},_.del=_.delete=function(e,t){return _(e).dispatch("delete",[t])},D.prototype.del=D.prototype.delete=function(e){return this.dispatch("delete",[e])},_.mapply=_.post=function(e,t,r){return _(e).dispatch("post",[t,r])},D.prototype.mapply=D.prototype.post=function(e,t){return this.dispatch("post",[e,t])},_.send=_.mcall=_.invoke=function(e,t){return _(e).dispatch("post",[t,c(arguments,2)])},D.prototype.send=D.prototype.mcall=D.prototype.invoke=function(e){return this.dispatch("post",[e,c(arguments,1)])},_.fapply=function(e,t){return _(e).dispatch("apply",[void 0,t])},D.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])},_.try=_.fcall=function(e){return _(e).dispatch("apply",[void 0,c(arguments,1)])},D.prototype.fcall=function(){return this.dispatch("apply",[void 0,c(arguments)])},_.fbind=function(e){var t=_(e),r=c(arguments,1);return function(){return t.dispatch("apply",[this,r.concat(c(arguments))])}},D.prototype.fbind=function(){var e=this,t=c(arguments);return function(){return e.dispatch("apply",[this,t.concat(c(arguments))])}},_.keys=function(e){return _(e).dispatch("keys",[])},D.prototype.keys=function(){return this.dispatch("keys",[])},_.all=j,D.prototype.all=function(){return j(this)},_.allResolved=(O=G,N="allResolved",P="allSettled",function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(N+" is deprecated, use "+P+" instead.",new Error("").stack),O.apply(O,arguments)}),D.prototype.allResolved=function(){return G(this)},_.allSettled=function(e){return _(e).allSettled()},D.prototype.allSettled=function(){return this.then((function(e){return j(h(e,(function(e){function t(){return e.inspect()}return(e=_(e)).then(t,t)})))}))},_.fail=_.catch=function(e,t){return _(e).then(void 0,t)},D.prototype.fail=D.prototype.catch=function(e){return this.then(void 0,e)},_.progress=function(e,t){return _(e).then(void 0,void 0,t)},D.prototype.progress=function(e){return this.then(void 0,void 0,e)},_.fin=_.finally=function(e,t){return _(e).finally(t)},D.prototype.fin=D.prototype.finally=function(e){return e=_(e),this.then((function(t){return e.fcall().then((function(){return t}))}),(function(t){return e.fcall().then((function(){throw t}))}))},_.done=function(e,t,r,i){return _(e).done(t,r,i)},D.prototype.done=function(e,t,r){var i=function(e){_.nextTick((function(){if(v(e,n),!_.onerror)throw e;_.onerror(e)}))},n=e||t||r?this.then(e,t,r):this;"object"==typeof process&&process&&process.domain&&(i=process.domain.bind(i)),n.then(void 0,i)},_.timeout=function(e,t,r){return _(e).timeout(t,r)},D.prototype.timeout=function(e,t){var r=T(),i=setTimeout((function(){t&&"string"!=typeof t||((t=new Error(t||"Timed out after "+e+" ms")).code="ETIMEDOUT"),r.reject(t)}),e);return this.then((function(e){clearTimeout(i),r.resolve(e)}),(function(e){clearTimeout(i),r.reject(e)}),r.notify),r.promise},_.delay=function(e,t){return void 0===t&&(t=e,e=void 0),_(e).delay(t)},D.prototype.delay=function(e){return this.then((function(t){var r=T();return setTimeout((function(){r.resolve(t)}),e),r.promise}))},_.nfapply=function(e,t){return _(e).nfapply(t)},D.prototype.nfapply=function(e){var t=T(),r=c(e);return r.push(t.makeNodeResolver()),this.fapply(r).fail(t.reject),t.promise},_.nfcall=function(e){var t=c(arguments,1);return _(e).nfapply(t)},D.prototype.nfcall=function(){var e=c(arguments),t=T();return e.push(t.makeNodeResolver()),this.fapply(e).fail(t.reject),t.promise},_.nfbind=_.denodeify=function(e){var t=c(arguments,1);return function(){var r=t.concat(c(arguments)),i=T();return r.push(i.makeNodeResolver()),_(e).fapply(r).fail(i.reject),i.promise}},D.prototype.nfbind=D.prototype.denodeify=function(){var e=c(arguments);return e.unshift(this),_.denodeify.apply(void 0,e)},_.nbind=function(e,t){var r=c(arguments,2);return function(){var i=r.concat(c(arguments)),n=T();return i.push(n.makeNodeResolver()),_((function(){return e.apply(t,arguments)})).fapply(i).fail(n.reject),n.promise}},D.prototype.nbind=function(){var e=c(arguments,0);return e.unshift(this),_.nbind.apply(void 0,e)},_.nmapply=_.npost=function(e,t,r){return _(e).npost(t,r)},D.prototype.nmapply=D.prototype.npost=function(e,t){var r=c(t||[]),i=T();return r.push(i.makeNodeResolver()),this.dispatch("post",[e,r]).fail(i.reject),i.promise},_.nsend=_.nmcall=_.ninvoke=function(e,t){var r=c(arguments,2),i=T();return r.push(i.makeNodeResolver()),_(e).dispatch("post",[t,r]).fail(i.reject),i.promise},D.prototype.nsend=D.prototype.nmcall=D.prototype.ninvoke=function(e){var t=c(arguments,1),r=T();return t.push(r.makeNodeResolver()),this.dispatch("post",[e,t]).fail(r.reject),r.promise},_.nodeify=function(e,t){return _(e).nodeify(t)},D.prototype.nodeify=function(e){if(!e)return this;this.then((function(t){_.nextTick((function(){e(null,t)}))}),(function(t){_.nextTick((function(){e(t)}))}))};var W=E();return _}))},7675:(e,t,r)=>{"use strict";var i=r(3206),n=r(9675),o=Object;e.exports=i((function(){if(null==this||this!==o(this))throw new n("RegExp.prototype.flags getter called on non-object");var e="";return this.hasIndices&&(e+="d"),this.global&&(e+="g"),this.ignoreCase&&(e+="i"),this.multiline&&(e+="m"),this.dotAll&&(e+="s"),this.unicode&&(e+="u"),this.unicodeSets&&(e+="v"),this.sticky&&(e+="y"),e}),"get flags",!0)},1589:(e,t,r)=>{"use strict";var i=r(8452),n=r(487),o=r(7675),a=r(5330),s=r(3984),c=n(a());i(c,{getPolyfill:a,implementation:o,shim:s}),e.exports=c},5330:(e,t,r)=>{"use strict";var i=r(7675),n=r(8452).supportsDescriptors,o=Object.getOwnPropertyDescriptor;e.exports=function(){if(n&&"gim"===/a/gim.flags){var e=o(RegExp.prototype,"flags");if(e&&"function"==typeof e.get&&"boolean"==typeof RegExp.prototype.dotAll&&"boolean"==typeof RegExp.prototype.hasIndices){var t="",r={};if(Object.defineProperty(r,"hasIndices",{get:function(){t+="d"}}),Object.defineProperty(r,"sticky",{get:function(){t+="y"}}),"dy"===t)return e.get}}return i}},3984:(e,t,r)=>{"use strict";var i=r(8452).supportsDescriptors,n=r(5330),o=Object.getOwnPropertyDescriptor,a=Object.defineProperty,s=TypeError,c=Object.getPrototypeOf,u=/a/;e.exports=function(){if(!i||!c)throw new s("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var e=n(),t=c(u),r=o(t,"flags");return r&&r.get===e||a(t,"flags",{configurable:!0,enumerable:!1,get:e}),e}},2861:(e,t,r)=>{var i=r(181),n=i.Buffer;function o(e,t){for(var r in e)t[r]=e[r]}function a(e,t,r){return n(e,t,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=i:(o(i,t),t.Buffer=a),o(n,a),a.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return n(e,t,r)},a.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=n(e);return void 0!==t?"string"==typeof r?i.fill(t,r):i.fill(t):i.fill(0),i},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i.SlowBuffer(e)}},4043:(e,t,r)=>{!function(e){e.parser=function(e,t){return new n(e,t)},e.SAXParser=n,e.SAXStream=a,e.createStream=function(e,t){return new a(e,t)},e.MAX_BUFFER_LENGTH=65536;var t,i=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function n(t,r){if(!(this instanceof n))return new n(t,r);var o=this;!function(e){for(var t=0,r=i.length;t<r;t++)e[i[t]]=""}(o),o.q=o.c="",o.bufferCheckPosition=e.MAX_BUFFER_LENGTH,o.opt=r||{},o.opt.lowercase=o.opt.lowercase||o.opt.lowercasetags,o.looseCase=o.opt.lowercase?"toLowerCase":"toUpperCase",o.tags=[],o.closed=o.closedRoot=o.sawRoot=!1,o.tag=o.error=null,o.strict=!!t,o.noscript=!(!t&&!o.opt.noscript),o.state=A.BEGIN,o.strictEntities=o.opt.strictEntities,o.ENTITIES=o.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),o.attribList=[],o.opt.xmlns&&(o.ns=Object.create(h)),void 0===o.opt.unquotedAttributeValues&&(o.opt.unquotedAttributeValues=!t),o.trackPosition=!1!==o.opt.position,o.trackPosition&&(o.position=o.line=o.column=0),D(o,"onready")}e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t}),n.prototype={end:function(){O(this)},write:function(t){var r=this;if(this.error)throw this.error;if(r.closed)return R(r,"Cannot write after close. Assign an onready handler.");if(null===t)return O(r);"object"==typeof t&&(t=t.toString());var n=0,o="";for(;o=V(t,n++),r.c=o,o;)switch(r.trackPosition&&(r.position++,"\n"===o?(r.line++,r.column=0):r.column++),r.state){case A.BEGIN:if(r.state=A.BEGIN_WHITESPACE,"\ufeff"===o)continue;k(r,o);continue;case A.BEGIN_WHITESPACE:k(r,o);continue;case A.TEXT:if(r.sawRoot&&!r.closedRoot){for(var a=n-1;o&&"<"!==o&&"&"!==o;)(o=V(t,n++))&&r.trackPosition&&(r.position++,"\n"===o?(r.line++,r.column=0):r.column++);r.textNode+=t.substring(a,n-1)}"<"!==o||r.sawRoot&&r.closedRoot&&!r.strict?(m(o)||r.sawRoot&&!r.closedRoot||N(r,"Text data outside of root node."),"&"===o?r.state=A.TEXT_ENTITY:r.textNode+=o):(r.state=A.OPEN_WAKA,r.startTagPosition=r.position);continue;case A.SCRIPT:"<"===o?r.state=A.SCRIPT_ENDING:r.script+=o;continue;case A.SCRIPT_ENDING:"/"===o?r.state=A.CLOSE_TAG:(r.script+="<"+o,r.state=A.SCRIPT);continue;case A.OPEN_WAKA:if("!"===o)r.state=A.SGML_DECL,r.sgmlDecl="";else if(m(o));else if(C(d,o))r.state=A.OPEN_TAG,r.tagName=o;else if("/"===o)r.state=A.CLOSE_TAG,r.tagName="";else if("?"===o)r.state=A.PROC_INST,r.procInstName=r.procInstBody="";else{if(N(r,"Unencoded <"),r.startTagPosition+1<r.position){var u=r.position-r.startTagPosition;o=new Array(u).join(" ")+o}r.textNode+="<"+o,r.state=A.TEXT}continue;case A.SGML_DECL:if(r.sgmlDecl+o==="--"){r.state=A.COMMENT,r.comment="",r.sgmlDecl="";continue}r.doctype&&!0!==r.doctype&&r.sgmlDecl?(r.state=A.DOCTYPE_DTD,r.doctype+="<!"+r.sgmlDecl+o,r.sgmlDecl=""):(r.sgmlDecl+o).toUpperCase()===s?(w(r,"onopencdata"),r.state=A.CDATA,r.sgmlDecl="",r.cdata=""):(r.sgmlDecl+o).toUpperCase()===c?(r.state=A.DOCTYPE,(r.doctype||r.sawRoot)&&N(r,"Inappropriately located doctype declaration"),r.doctype="",r.sgmlDecl=""):">"===o?(w(r,"onsgmldeclaration",r.sgmlDecl),r.sgmlDecl="",r.state=A.TEXT):v(o)?(r.state=A.SGML_DECL_QUOTED,r.sgmlDecl+=o):r.sgmlDecl+=o;continue;case A.SGML_DECL_QUOTED:o===r.q&&(r.state=A.SGML_DECL,r.q=""),r.sgmlDecl+=o;continue;case A.DOCTYPE:">"===o?(r.state=A.TEXT,w(r,"ondoctype",r.doctype),r.doctype=!0):(r.doctype+=o,"["===o?r.state=A.DOCTYPE_DTD:v(o)&&(r.state=A.DOCTYPE_QUOTED,r.q=o));continue;case A.DOCTYPE_QUOTED:r.doctype+=o,o===r.q&&(r.q="",r.state=A.DOCTYPE);continue;case A.DOCTYPE_DTD:"]"===o?(r.doctype+=o,r.state=A.DOCTYPE):"<"===o?(r.state=A.OPEN_WAKA,r.startTagPosition=r.position):v(o)?(r.doctype+=o,r.state=A.DOCTYPE_DTD_QUOTED,r.q=o):r.doctype+=o;continue;case A.DOCTYPE_DTD_QUOTED:r.doctype+=o,o===r.q&&(r.state=A.DOCTYPE_DTD,r.q="");continue;case A.COMMENT:"-"===o?r.state=A.COMMENT_ENDING:r.comment+=o;continue;case A.COMMENT_ENDING:"-"===o?(r.state=A.COMMENT_ENDED,r.comment=U(r.opt,r.comment),r.comment&&w(r,"oncomment",r.comment),r.comment=""):(r.comment+="-"+o,r.state=A.COMMENT);continue;case A.COMMENT_ENDED:">"!==o?(N(r,"Malformed comment"),r.comment+="--"+o,r.state=A.COMMENT):r.doctype&&!0!==r.doctype?r.state=A.DOCTYPE_DTD:r.state=A.TEXT;continue;case A.CDATA:"]"===o?r.state=A.CDATA_ENDING:r.cdata+=o;continue;case A.CDATA_ENDING:"]"===o?r.state=A.CDATA_ENDING_2:(r.cdata+="]"+o,r.state=A.CDATA);continue;case A.CDATA_ENDING_2:">"===o?(r.cdata&&w(r,"oncdata",r.cdata),w(r,"onclosecdata"),r.cdata="",r.state=A.TEXT):"]"===o?r.cdata+="]":(r.cdata+="]]"+o,r.state=A.CDATA);continue;case A.PROC_INST:"?"===o?r.state=A.PROC_INST_ENDING:m(o)?r.state=A.PROC_INST_BODY:r.procInstName+=o;continue;case A.PROC_INST_BODY:if(!r.procInstBody&&m(o))continue;"?"===o?r.state=A.PROC_INST_ENDING:r.procInstBody+=o;continue;case A.PROC_INST_ENDING:">"===o?(w(r,"onprocessinginstruction",{name:r.procInstName,body:r.procInstBody}),r.procInstName=r.procInstBody="",r.state=A.TEXT):(r.procInstBody+="?"+o,r.state=A.PROC_INST_BODY);continue;case A.OPEN_TAG:C(p,o)?r.tagName+=o:(P(r),">"===o?x(r):"/"===o?r.state=A.OPEN_TAG_SLASH:(m(o)||N(r,"Invalid character in tag name"),r.state=A.ATTRIB));continue;case A.OPEN_TAG_SLASH:">"===o?(x(r,!0),M(r)):(N(r,"Forward-slash in opening tag not followed by >"),r.state=A.ATTRIB);continue;case A.ATTRIB:if(m(o))continue;">"===o?x(r):"/"===o?r.state=A.OPEN_TAG_SLASH:C(d,o)?(r.attribName=o,r.attribValue="",r.state=A.ATTRIB_NAME):N(r,"Invalid attribute name");continue;case A.ATTRIB_NAME:"="===o?r.state=A.ATTRIB_VALUE:">"===o?(N(r,"Attribute without value"),r.attribValue=r.attribName,L(r),x(r)):m(o)?r.state=A.ATTRIB_NAME_SAW_WHITE:C(p,o)?r.attribName+=o:N(r,"Invalid attribute name");continue;case A.ATTRIB_NAME_SAW_WHITE:if("="===o)r.state=A.ATTRIB_VALUE;else{if(m(o))continue;N(r,"Attribute without value"),r.tag.attributes[r.attribName]="",r.attribValue="",w(r,"onattribute",{name:r.attribName,value:""}),r.attribName="",">"===o?x(r):C(d,o)?(r.attribName=o,r.state=A.ATTRIB_NAME):(N(r,"Invalid attribute name"),r.state=A.ATTRIB)}continue;case A.ATTRIB_VALUE:if(m(o))continue;v(o)?(r.q=o,r.state=A.ATTRIB_VALUE_QUOTED):(r.opt.unquotedAttributeValues||R(r,"Unquoted attribute value"),r.state=A.ATTRIB_VALUE_UNQUOTED,r.attribValue=o);continue;case A.ATTRIB_VALUE_QUOTED:if(o!==r.q){"&"===o?r.state=A.ATTRIB_VALUE_ENTITY_Q:r.attribValue+=o;continue}L(r),r.q="",r.state=A.ATTRIB_VALUE_CLOSED;continue;case A.ATTRIB_VALUE_CLOSED:m(o)?r.state=A.ATTRIB:">"===o?x(r):"/"===o?r.state=A.OPEN_TAG_SLASH:C(d,o)?(N(r,"No whitespace between attributes"),r.attribName=o,r.attribValue="",r.state=A.ATTRIB_NAME):N(r,"Invalid attribute name");continue;case A.ATTRIB_VALUE_UNQUOTED:if(!y(o)){"&"===o?r.state=A.ATTRIB_VALUE_ENTITY_U:r.attribValue+=o;continue}L(r),">"===o?x(r):r.state=A.ATTRIB;continue;case A.CLOSE_TAG:if(r.tagName)">"===o?M(r):C(p,o)?r.tagName+=o:r.script?(r.script+="</"+r.tagName,r.tagName="",r.state=A.SCRIPT):(m(o)||N(r,"Invalid tagname in closing tag"),r.state=A.CLOSE_TAG_SAW_WHITE);else{if(m(o))continue;S(d,o)?r.script?(r.script+="</"+o,r.state=A.SCRIPT):N(r,"Invalid tagname in closing tag."):r.tagName=o}continue;case A.CLOSE_TAG_SAW_WHITE:if(m(o))continue;">"===o?M(r):N(r,"Invalid characters in closing tag");continue;case A.TEXT_ENTITY:case A.ATTRIB_VALUE_ENTITY_Q:case A.ATTRIB_VALUE_ENTITY_U:var l,h;switch(r.state){case A.TEXT_ENTITY:l=A.TEXT,h="textNode";break;case A.ATTRIB_VALUE_ENTITY_Q:l=A.ATTRIB_VALUE_QUOTED,h="attribValue";break;case A.ATTRIB_VALUE_ENTITY_U:l=A.ATTRIB_VALUE_UNQUOTED,h="attribValue"}if(";"===o){var E=F(r);r.opt.unparsedEntities&&!Object.values(e.XML_ENTITIES).includes(E)?(r.entity="",r.state=l,r.write(E)):(r[h]+=E,r.entity="",r.state=l)}else C(r.entity.length?g:f,o)?r.entity+=o:(N(r,"Invalid character in entity name"),r[h]+="&"+r.entity+o,r.entity="",r.state=l);continue;default:throw new Error(r,"Unknown state: "+r.state)}r.position>=r.bufferCheckPosition&&function(t){for(var r=Math.max(e.MAX_BUFFER_LENGTH,10),n=0,o=0,a=i.length;o<a;o++){var s=t[i[o]].length;if(s>r)switch(i[o]){case"textNode":b(t);break;case"cdata":w(t,"oncdata",t.cdata),t.cdata="";break;case"script":w(t,"onscript",t.script),t.script="";break;default:R(t,"Max buffer length exceeded: "+i[o])}n=Math.max(n,s)}var c=e.MAX_BUFFER_LENGTH-n;t.bufferCheckPosition=c+t.position}(r);return r}
/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var e;b(e=this),""!==e.cdata&&(w(e,"oncdata",e.cdata),e.cdata=""),""!==e.script&&(w(e,"onscript",e.script),e.script="")}};try{t=r(2203).Stream}catch(e){t=function(){}}t||(t=function(){});var o=e.EVENTS.filter((function(e){return"error"!==e&&"end"!==e}));function a(e,r){if(!(this instanceof a))return new a(e,r);t.apply(this),this._parser=new n(e,r),this.writable=!0,this.readable=!0;var i=this;this._parser.onend=function(){i.emit("end")},this._parser.onerror=function(e){i.emit("error",e),i._parser.error=null},this._decoder=null,o.forEach((function(e){Object.defineProperty(i,"on"+e,{get:function(){return i._parser["on"+e]},set:function(t){if(!t)return i.removeAllListeners(e),i._parser["on"+e]=t,t;i.on(e,t)},enumerable:!0,configurable:!1})}))}a.prototype=Object.create(t.prototype,{constructor:{value:a}}),a.prototype.write=function(e){if("function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(e)){if(!this._decoder){var t=r(3193).StringDecoder;this._decoder=new t("utf8")}e=this._decoder.write(e)}return this._parser.write(e.toString()),this.emit("data",e),!0},a.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},a.prototype.on=function(e,r){var i=this;return i._parser["on"+e]||-1===o.indexOf(e)||(i._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),i.emit.apply(i,t)}),t.prototype.on.call(i,e,r)};var s="[CDATA[",c="DOCTYPE",u="http://www.w3.org/XML/1998/namespace",l="http://www.w3.org/2000/xmlns/",h={xml:u,xmlns:l},d=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,p=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,f=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,g=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function m(e){return" "===e||"\n"===e||"\r"===e||"\t"===e}function v(e){return'"'===e||"'"===e}function y(e){return">"===e||m(e)}function C(e,t){return e.test(t)}function S(e,t){return!C(e,t)}var E,_,T,A=0;for(var I in e.STATE={BEGIN:A++,BEGIN_WHITESPACE:A++,TEXT:A++,TEXT_ENTITY:A++,OPEN_WAKA:A++,SGML_DECL:A++,SGML_DECL_QUOTED:A++,DOCTYPE:A++,DOCTYPE_QUOTED:A++,DOCTYPE_DTD:A++,DOCTYPE_DTD_QUOTED:A++,COMMENT_STARTING:A++,COMMENT:A++,COMMENT_ENDING:A++,COMMENT_ENDED:A++,CDATA:A++,CDATA_ENDING:A++,CDATA_ENDING_2:A++,PROC_INST:A++,PROC_INST_BODY:A++,PROC_INST_ENDING:A++,OPEN_TAG:A++,OPEN_TAG_SLASH:A++,ATTRIB:A++,ATTRIB_NAME:A++,ATTRIB_NAME_SAW_WHITE:A++,ATTRIB_VALUE:A++,ATTRIB_VALUE_QUOTED:A++,ATTRIB_VALUE_CLOSED:A++,ATTRIB_VALUE_UNQUOTED:A++,ATTRIB_VALUE_ENTITY_Q:A++,ATTRIB_VALUE_ENTITY_U:A++,CLOSE_TAG:A++,CLOSE_TAG_SAW_WHITE:A++,SCRIPT:A++,SCRIPT_ENDING:A++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach((function(t){var r=e.ENTITIES[t],i="number"==typeof r?String.fromCharCode(r):r;e.ENTITIES[t]=i})),e.STATE)e.STATE[e.STATE[I]]=I;function D(e,t,r){e[t]&&e[t](r)}function w(e,t,r){e.textNode&&b(e),D(e,t,r)}function b(e){e.textNode=U(e.opt,e.textNode),e.textNode&&D(e,"ontext",e.textNode),e.textNode=""}function U(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function R(e,t){return b(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=new Error(t),e.error=t,D(e,"onerror",t),e}function O(e){return e.sawRoot&&!e.closedRoot&&N(e,"Unclosed root tag"),e.state!==A.BEGIN&&e.state!==A.BEGIN_WHITESPACE&&e.state!==A.TEXT&&R(e,"Unexpected end"),b(e),e.c="",e.closed=!0,D(e,"onend"),n.call(e,e.strict,e.opt),e}function N(e,t){if("object"!=typeof e||!(e instanceof n))throw new Error("bad call to strictFail");e.strict&&R(e,t)}function P(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,r=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(r.ns=t.ns),e.attribList.length=0,w(e,"onopentagstart",r)}function B(e,t){var r=e.indexOf(":")<0?["",e]:e.split(":"),i=r[0],n=r[1];return t&&"xmlns"===e&&(i="xmlns",n=""),{prefix:i,local:n}}function L(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName))e.attribName=e.attribValue="";else{if(e.opt.xmlns){var t=B(e.attribName,!0),r=t.prefix,i=t.local;if("xmlns"===r)if("xml"===i&&e.attribValue!==u)N(e,"xml: prefix must be bound to "+u+"\nActual: "+e.attribValue);else if("xmlns"===i&&e.attribValue!==l)N(e,"xmlns: prefix must be bound to "+l+"\nActual: "+e.attribValue);else{var n=e.tag,o=e.tags[e.tags.length-1]||e;n.ns===o.ns&&(n.ns=Object.create(o.ns)),n.ns[i]=e.attribValue}e.attribList.push([e.attribName,e.attribValue])}else e.tag.attributes[e.attribName]=e.attribValue,w(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue=""}}function x(e,t){if(e.opt.xmlns){var r=e.tag,i=B(e.tagName);r.prefix=i.prefix,r.local=i.local,r.uri=r.ns[i.prefix]||"",r.prefix&&!r.uri&&(N(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),r.uri=i.prefix);var n=e.tags[e.tags.length-1]||e;r.ns&&n.ns!==r.ns&&Object.keys(r.ns).forEach((function(t){w(e,"onopennamespace",{prefix:t,uri:r.ns[t]})}));for(var o=0,a=e.attribList.length;o<a;o++){var s=e.attribList[o],c=s[0],u=s[1],l=B(c,!0),h=l.prefix,d=l.local,p=""===h?"":r.ns[h]||"",f={name:c,value:u,prefix:h,local:d,uri:p};h&&"xmlns"!==h&&!p&&(N(e,"Unbound namespace prefix: "+JSON.stringify(h)),f.uri=h),e.tag.attributes[c]=f,w(e,"onattribute",f)}e.attribList.length=0}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),w(e,"onopentag",e.tag),t||(e.noscript||"script"!==e.tagName.toLowerCase()?e.state=A.TEXT:e.state=A.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0}function M(e){if(!e.tagName)return N(e,"Weird empty close tag."),e.textNode+="</>",void(e.state=A.TEXT);if(e.script){if("script"!==e.tagName)return e.script+="</"+e.tagName+">",e.tagName="",void(e.state=A.SCRIPT);w(e,"onscript",e.script),e.script=""}var t=e.tags.length,r=e.tagName;e.strict||(r=r[e.looseCase]());for(var i=r;t--;){if(e.tags[t].name===i)break;N(e,"Unexpected close tag")}if(t<0)return N(e,"Unmatched closing tag: "+e.tagName),e.textNode+="</"+e.tagName+">",void(e.state=A.TEXT);e.tagName=r;for(var n=e.tags.length;n-- >t;){var o=e.tag=e.tags.pop();e.tagName=e.tag.name,w(e,"onclosetag",e.tagName);var a={};for(var s in o.ns)a[s]=o.ns[s];var c=e.tags[e.tags.length-1]||e;e.opt.xmlns&&o.ns!==c.ns&&Object.keys(o.ns).forEach((function(t){var r=o.ns[t];w(e,"onclosenamespace",{prefix:t,uri:r})}))}0===t&&(e.closedRoot=!0),e.tagName=e.attribValue=e.attribName="",e.attribList.length=0,e.state=A.TEXT}function F(e){var t,r=e.entity,i=r.toLowerCase(),n="";return e.ENTITIES[r]?e.ENTITIES[r]:e.ENTITIES[i]?e.ENTITIES[i]:("#"===(r=i).charAt(0)&&("x"===r.charAt(1)?(r=r.slice(2),n=(t=parseInt(r,16)).toString(16)):(r=r.slice(1),n=(t=parseInt(r,10)).toString(10))),r=r.replace(/^0+/,""),isNaN(t)||n.toLowerCase()!==r?(N(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t))}function k(e,t){"<"===t?(e.state=A.OPEN_WAKA,e.startTagPosition=e.position):m(t)||(N(e,"Non-whitespace before first tag."),e.textNode=t,e.state=A.TEXT)}function V(e,t){var r="";return t<e.length&&(r=e.charAt(t)),r}A=e.STATE,String.fromCodePoint||(E=String.fromCharCode,_=Math.floor,T=function(){var e,t,r=[],i=-1,n=arguments.length;if(!n)return"";for(var o="";++i<n;){var a=Number(arguments[i]);if(!isFinite(a)||a<0||a>1114111||_(a)!==a)throw RangeError("Invalid code point: "+a);a<=65535?r.push(a):(e=55296+((a-=65536)>>10),t=a%1024+56320,r.push(e,t)),(i+1===n||r.length>16384)&&(o+=E.apply(null,r),r.length=0)}return o},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:T,configurable:!0,writable:!0}):String.fromCodePoint=T)}(t)},6897:(e,t,r)=>{"use strict";var i=r(453),n=r(41),o=r(592)(),a=r(5795),s=r(9675),c=i("%Math.floor%");e.exports=function(e,t){if("function"!=typeof e)throw new s("`fn` is not a function");if("number"!=typeof t||t<0||t>4294967295||c(t)!==t)throw new s("`length` must be a positive 32-bit integer");var r=arguments.length>2&&!!arguments[2],i=!0,u=!0;if("length"in e&&a){var l=a(e,"length");l&&!l.configurable&&(i=!1),l&&!l.writable&&(u=!1)}return(i||u||!r)&&(o?n(e,"length",t,!0,!0):n(e,"length",t)),e}},3206:(e,t,r)=>{"use strict";var i=r(41),n=r(592)(),o=r(4462).functionsHaveConfigurableNames(),a=r(9675);e.exports=function(e,t){if("function"!=typeof e)throw new a("`fn` is not a function");return arguments.length>2&&!!arguments[2]&&!o||(n?i(e,"name",t,!0,!0):i(e,"name",t)),e}},920:(e,t,r)=>{"use strict";var i=r(453),n=r(8075),o=r(8859),a=r(9675),s=i("%WeakMap%",!0),c=i("%Map%",!0),u=n("WeakMap.prototype.get",!0),l=n("WeakMap.prototype.set",!0),h=n("WeakMap.prototype.has",!0),d=n("Map.prototype.get",!0),p=n("Map.prototype.set",!0),f=n("Map.prototype.has",!0),g=function(e,t){for(var r,i=e;null!==(r=i.next);i=r)if(r.key===t)return i.next=r.next,r.next=e.next,e.next=r,r};e.exports=function(){var e,t,r,i={assert:function(e){if(!i.has(e))throw new a("Side channel does not contain "+o(e))},get:function(i){if(s&&i&&("object"==typeof i||"function"==typeof i)){if(e)return u(e,i)}else if(c){if(t)return d(t,i)}else if(r)return function(e,t){var r=g(e,t);return r&&r.value}(r,i)},has:function(i){if(s&&i&&("object"==typeof i||"function"==typeof i)){if(e)return h(e,i)}else if(c){if(t)return f(t,i)}else if(r)return function(e,t){return!!g(e,t)}(r,i);return!1},set:function(i,n){s&&i&&("object"==typeof i||"function"==typeof i)?(e||(e=new s),l(e,i,n)):c?(t||(t=new c),p(t,i,n)):(r||(r={key:{},next:null}),function(e,t,r){var i=g(e,t);i?i.value=r:e.next={key:t,next:e.next,value:r}}(r,i,n))}};return i}},3476:(e,t,r)=>{r(2345).install()},2345:(e,t,r)=>{e=r.nmd(e);var i,n=r(9665).SourceMapConsumer,o=r(6928);try{(i=r(9896)).existsSync&&i.readFileSync||(i=null)}catch(e){}var a=r(2746);function s(e,t){return e.require(t)}var c=!1,u=!1,l=!1,h="auto",d={},p={},f=/^data:application\/json[^,]+base64,/,g=[],m=[];function v(){return"browser"===h||"node"!==h&&("undefined"!=typeof window&&"function"==typeof XMLHttpRequest&&!(window.require&&window.module&&window.process&&"renderer"===window.process.type))}function y(e){return function(t){for(var r=0;r<e.length;r++){var i=e[r](t);if(i)return i}return null}}var C=y(g);function S(e,t){if(!e)return t;var r=o.dirname(e),i=/^\w+:\/\/[^\/]*/.exec(r),n=i?i[0]:"",a=r.slice(n.length);return n&&/^\/\w\:/.test(a)?(n+="/")+o.resolve(r.slice(n.length),t).replace(/\\/g,"/"):n+o.resolve(r.slice(n.length),t)}g.push((function(e){if(e=e.trim(),/^file:/.test(e)&&(e=e.replace(/file:\/\/\/(\w:)?/,(function(e,t){return t?"":"/"}))),e in d)return d[e];var t="";try{if(i)i.existsSync(e)&&(t=i.readFileSync(e,"utf8"));else{var r=new XMLHttpRequest;r.open("GET",e,!1),r.send(null),4===r.readyState&&200===r.status&&(t=r.responseText)}}catch(e){}return d[e]=t}));var E=y(m);function _(e){var t=p[e.source];if(!t){var r=E(e.source);r?(t=p[e.source]={url:r.url,map:new n(r.map)}).map.sourcesContent&&t.map.sources.forEach((function(e,r){var i=t.map.sourcesContent[r];if(i){var n=S(t.url,e);d[n]=i}})):t=p[e.source]={url:null,map:null}}if(t&&t.map&&"function"==typeof t.map.originalPositionFor){var i=t.map.originalPositionFor(e);if(null!==i.source)return i.source=S(t.url,i.source),i}return e}function T(e){var t=/^eval at ([^(]+) \((.+):(\d+):(\d+)\)$/.exec(e);if(t){var r=_({source:t[2],line:+t[3],column:t[4]-1});return"eval at "+t[1]+" ("+r.source+":"+r.line+":"+(r.column+1)+")"}return(t=/^eval at ([^(]+) \((.+)\)$/.exec(e))?"eval at "+t[1]+" ("+T(t[2])+")":e}function A(){var e,t="";if(this.isNative())t="native";else{!(e=this.getScriptNameOrSourceURL())&&this.isEval()&&(t=this.getEvalOrigin(),t+=", "),t+=e||"<anonymous>";var r=this.getLineNumber();if(null!=r){t+=":"+r;var i=this.getColumnNumber();i&&(t+=":"+i)}}var n="",o=this.getFunctionName(),a=!0,s=this.isConstructor();if(!(this.isToplevel()||s)){var c=this.getTypeName();"[object Object]"===c&&(c="null");var u=this.getMethodName();o?(c&&0!=o.indexOf(c)&&(n+=c+"."),n+=o,u&&o.indexOf("."+u)!=o.length-u.length-1&&(n+=" [as "+u+"]")):n+=c+"."+(u||"<anonymous>")}else s?n+="new "+(o||"<anonymous>"):o?n+=o:(n+=t,a=!1);return a&&(n+=" ("+t+")"),n}function I(e){var t={};return Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach((function(r){t[r]=/^(?:is|get)/.test(r)?function(){return e[r].call(e)}:e[r]})),t.toString=A,t}function D(e,t){if(void 0===t&&(t={nextPosition:null,curPosition:null}),e.isNative())return t.curPosition=null,e;var r=e.getFileName()||e.getScriptNameOrSourceURL();if(r){var i=e.getLineNumber(),n=e.getColumnNumber()-1,o=/^v(10\.1[6-9]|10\.[2-9][0-9]|10\.[0-9]{3,}|1[2-9]\d*|[2-9]\d|\d{3,}|11\.11)/.test("object"==typeof process&&null!==process?process.version:"")?0:62;1===i&&n>o&&!v()&&!e.isEval()&&(n-=o);var a=_({source:r,line:i,column:n});t.curPosition=a;var s=(e=I(e)).getFunctionName;return e.getFunctionName=function(){return null==t.nextPosition?s():t.nextPosition.name||s()},e.getFileName=function(){return a.source},e.getLineNumber=function(){return a.line},e.getColumnNumber=function(){return a.column+1},e.getScriptNameOrSourceURL=function(){return a.source},e}var c=e.isEval()&&e.getEvalOrigin();return c?(c=T(c),(e=I(e)).getEvalOrigin=function(){return c},e):e}function w(e,t){l&&(d={},p={});for(var r=(e.name||"Error")+": "+(e.message||""),i={nextPosition:null,curPosition:null},n=[],o=t.length-1;o>=0;o--)n.push("\n    at "+D(t[o],i)),i.nextPosition=i.curPosition;return i.curPosition=i.nextPosition=null,r+n.reverse().join("")}function b(e){var t=/\n    at [^(]+ \((.*):(\d+):(\d+)\)/.exec(e.stack);if(t){var r=t[1],n=+t[2],o=+t[3],a=d[r];if(!a&&i&&i.existsSync(r))try{a=i.readFileSync(r,"utf8")}catch(e){a=""}if(a){var s=a.split(/(?:\r\n|\r|\n)/)[n-1];if(s)return r+":"+n+"\n"+s+"\n"+new Array(o).join(" ")+"^"}}return null}function U(e){var t=b(e),r=function(){if("object"==typeof process&&null!==process)return process.stderr}();r&&r._handle&&r._handle.setBlocking&&r._handle.setBlocking(!0),t&&(console.error(),console.error(t)),console.error(e.stack),function(e){if("object"==typeof process&&null!==process&&"function"==typeof process.exit)process.exit(e)}(1)}m.push((function(e){var t,r=function(e){var t;if(v())try{var r=new XMLHttpRequest;r.open("GET",e,!1),r.send(null),t=4===r.readyState?r.responseText:null;var i=r.getResponseHeader("SourceMap")||r.getResponseHeader("X-SourceMap");if(i)return i}catch(e){}t=C(e);for(var n,o,a=/(?:\/\/[@#][\s]*sourceMappingURL=([^\s'"]+)[\s]*$)|(?:\/\*[@#][\s]*sourceMappingURL=([^\s*'"]+)[\s]*(?:\*\/)[\s]*$)/gm;o=a.exec(t);)n=o;return n?n[1]:null}(e);if(!r)return null;if(f.test(r)){var i=r.slice(r.indexOf(",")+1);t=a(i,"base64").toString(),r=e}else r=S(e,r),t=C(r);return t?{url:r,map:t}:null}));var R=g.slice(0),O=m.slice(0);t.wrapCallSite=D,t.getErrorSource=b,t.mapSourcePosition=_,t.retrieveSourceMap=E,t.install=function(t){if((t=t||{}).environment&&(h=t.environment,-1===["node","browser","auto"].indexOf(h)))throw new Error("environment "+h+" was unknown. Available options are {auto, browser, node}");if(t.retrieveFile&&(t.overrideRetrieveFile&&(g.length=0),g.unshift(t.retrieveFile)),t.retrieveSourceMap&&(t.overrideRetrieveSourceMap&&(m.length=0),m.unshift(t.retrieveSourceMap)),t.hookRequire&&!v()){var r=s(e,"module"),i=r.prototype._compile;i.__sourceMapSupport||(r.prototype._compile=function(e,t){return d[t]=e,p[t]=void 0,i.call(this,e,t)},r.prototype._compile.__sourceMapSupport=!0)}if(l||(l="emptyCacheBetweenOperations"in t&&t.emptyCacheBetweenOperations),c||(c=!0,Error.prepareStackTrace=w),!u){var n=!("handleUncaughtExceptions"in t)||t.handleUncaughtExceptions;try{!1===s(e,"worker_threads").isMainThread&&(n=!1)}catch(e){}n&&"object"==typeof process&&null!==process&&"function"==typeof process.on&&(u=!0,o=process.emit,process.emit=function(e){if("uncaughtException"===e){var t=arguments[1]&&arguments[1].stack,r=this.listeners(e).length>0;if(t&&!r)return U(arguments[1])}return o.apply(this,arguments)})}var o},t.resetRetrieveHandlers=function(){g.length=0,m.length=0,g=R.slice(0),m=O.slice(0),E=y(m),C=y(g)}},735:(e,t,r)=>{var i=r(251),n=Object.prototype.hasOwnProperty,o="undefined"!=typeof Map;function a(){this._array=[],this._set=o?new Map:Object.create(null)}a.fromArray=function(e,t){for(var r=new a,i=0,n=e.length;i<n;i++)r.add(e[i],t);return r},a.prototype.size=function(){return o?this._set.size:Object.getOwnPropertyNames(this._set).length},a.prototype.add=function(e,t){var r=o?e:i.toSetString(e),a=o?this.has(e):n.call(this._set,r),s=this._array.length;a&&!t||this._array.push(e),a||(o?this._set.set(e,s):this._set[r]=s)},a.prototype.has=function(e){if(o)return this._set.has(e);var t=i.toSetString(e);return n.call(this._set,t)},a.prototype.indexOf=function(e){if(o){var t=this._set.get(e);if(t>=0)return t}else{var r=i.toSetString(e);if(n.call(this._set,r))return this._set[r]}throw new Error('"'+e+'" is not in the set.')},a.prototype.at=function(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)},a.prototype.toArray=function(){return this._array.slice()},t.C=a},7092:(e,t,r)=>{var i=r(2364);t.encode=function(e){var t,r="",n=function(e){return e<0?1+(-e<<1):0+(e<<1)}(e);do{t=31&n,(n>>>=5)>0&&(t|=32),r+=i.encode(t)}while(n>0);return r},t.decode=function(e,t,r){var n,o,a,s,c=e.length,u=0,l=0;do{if(t>=c)throw new Error("Expected more digits in base 64 VLQ value.");if(-1===(o=i.decode(e.charCodeAt(t++))))throw new Error("Invalid base64 digit: "+e.charAt(t-1));n=!!(32&o),u+=(o&=31)<<l,l+=5}while(n);r.value=(s=(a=u)>>1,1&~a?s:-s),r.rest=t}},2364:(e,t)=>{var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");t.encode=function(e){if(0<=e&&e<r.length)return r[e];throw new TypeError("Must be between 0 and 63: "+e)},t.decode=function(e){return 65<=e&&e<=90?e-65:97<=e&&e<=122?e-97+26:48<=e&&e<=57?e-48+52:43==e?62:47==e?63:-1}},1163:(e,t)=>{function r(e,i,n,o,a,s){var c=Math.floor((i-e)/2)+e,u=a(n,o[c],!0);return 0===u?c:u>0?i-c>1?r(c,i,n,o,a,s):s==t.LEAST_UPPER_BOUND?i<o.length?i:-1:c:c-e>1?r(e,c,n,o,a,s):s==t.LEAST_UPPER_BOUND?c:e<0?-1:e}t.GREATEST_LOWER_BOUND=1,t.LEAST_UPPER_BOUND=2,t.search=function(e,i,n,o){if(0===i.length)return-1;var a=r(-1,i.length,e,i,n,o||t.GREATEST_LOWER_BOUND);if(a<0)return-1;for(;a-1>=0&&0===n(i[a],i[a-1],!0);)--a;return a}},3302:(e,t,r)=>{var i=r(251);function n(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}n.prototype.unsortedForEach=function(e,t){this._array.forEach(e,t)},n.prototype.add=function(e){var t,r,n,o,a,s;t=this._last,r=e,n=t.generatedLine,o=r.generatedLine,a=t.generatedColumn,s=r.generatedColumn,o>n||o==n&&s>=a||i.compareByGeneratedPositionsInflated(t,r)<=0?(this._last=e,this._array.push(e)):(this._sorted=!1,this._array.push(e))},n.prototype.toArray=function(){return this._sorted||(this._array.sort(i.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},t.P=n},3801:(e,t)=>{function r(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}function i(e,t,n,o){if(n<o){var a=n-1;r(e,(l=n,h=o,Math.round(l+Math.random()*(h-l))),o);for(var s=e[o],c=n;c<o;c++)t(e[c],s)<=0&&r(e,a+=1,c);r(e,a+1,c);var u=a+1;i(e,t,n,u-1),i(e,t,u+1,o)}var l,h}t.g=function(e,t){i(e,t,0,e.length-1)}},7446:(e,t,r)=>{var i=r(251),n=r(1163),o=r(735).C,a=r(7092),s=r(3801).g;function c(e,t){var r=e;return"string"==typeof e&&(r=i.parseSourceMapInput(e)),null!=r.sections?new h(r,t):new u(r,t)}function u(e,t){var r=e;"string"==typeof e&&(r=i.parseSourceMapInput(e));var n=i.getArg(r,"version"),a=i.getArg(r,"sources"),s=i.getArg(r,"names",[]),c=i.getArg(r,"sourceRoot",null),u=i.getArg(r,"sourcesContent",null),l=i.getArg(r,"mappings"),h=i.getArg(r,"file",null);if(n!=this._version)throw new Error("Unsupported version: "+n);c&&(c=i.normalize(c)),a=a.map(String).map(i.normalize).map((function(e){return c&&i.isAbsolute(c)&&i.isAbsolute(e)?i.relative(c,e):e})),this._names=o.fromArray(s.map(String),!0),this._sources=o.fromArray(a,!0),this._absoluteSources=this._sources.toArray().map((function(e){return i.computeSourceURL(c,e,t)})),this.sourceRoot=c,this.sourcesContent=u,this._mappings=l,this._sourceMapURL=t,this.file=h}function l(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}function h(e,t){var r=e;"string"==typeof e&&(r=i.parseSourceMapInput(e));var n=i.getArg(r,"version"),a=i.getArg(r,"sections");if(n!=this._version)throw new Error("Unsupported version: "+n);this._sources=new o,this._names=new o;var s={line:-1,column:0};this._sections=a.map((function(e){if(e.url)throw new Error("Support for url field in sections not implemented.");var r=i.getArg(e,"offset"),n=i.getArg(r,"line"),o=i.getArg(r,"column");if(n<s.line||n===s.line&&o<s.column)throw new Error("Section offsets must be ordered and non-overlapping.");return s=r,{generatedOffset:{generatedLine:n+1,generatedColumn:o+1},consumer:new c(i.getArg(e,"map"),t)}}))}c.fromSourceMap=function(e,t){return u.fromSourceMap(e,t)},c.prototype._version=3,c.prototype.__generatedMappings=null,Object.defineProperty(c.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),c.prototype.__originalMappings=null,Object.defineProperty(c.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),c.prototype._charIsMappingSeparator=function(e,t){var r=e.charAt(t);return";"===r||","===r},c.prototype._parseMappings=function(e,t){throw new Error("Subclasses must implement _parseMappings")},c.GENERATED_ORDER=1,c.ORIGINAL_ORDER=2,c.GREATEST_LOWER_BOUND=1,c.LEAST_UPPER_BOUND=2,c.prototype.eachMapping=function(e,t,r){var n,o=t||null;switch(r||c.GENERATED_ORDER){case c.GENERATED_ORDER:n=this._generatedMappings;break;case c.ORIGINAL_ORDER:n=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var a=this.sourceRoot;n.map((function(e){var t=null===e.source?null:this._sources.at(e.source);return{source:t=i.computeSourceURL(a,t,this._sourceMapURL),generatedLine:e.generatedLine,generatedColumn:e.generatedColumn,originalLine:e.originalLine,originalColumn:e.originalColumn,name:null===e.name?null:this._names.at(e.name)}}),this).forEach(e,o)},c.prototype.allGeneratedPositionsFor=function(e){var t=i.getArg(e,"line"),r={source:i.getArg(e,"source"),originalLine:t,originalColumn:i.getArg(e,"column",0)};if(r.source=this._findSourceIndex(r.source),r.source<0)return[];var o=[],a=this._findMapping(r,this._originalMappings,"originalLine","originalColumn",i.compareByOriginalPositions,n.LEAST_UPPER_BOUND);if(a>=0){var s=this._originalMappings[a];if(void 0===e.column)for(var c=s.originalLine;s&&s.originalLine===c;)o.push({line:i.getArg(s,"generatedLine",null),column:i.getArg(s,"generatedColumn",null),lastColumn:i.getArg(s,"lastGeneratedColumn",null)}),s=this._originalMappings[++a];else for(var u=s.originalColumn;s&&s.originalLine===t&&s.originalColumn==u;)o.push({line:i.getArg(s,"generatedLine",null),column:i.getArg(s,"generatedColumn",null),lastColumn:i.getArg(s,"lastGeneratedColumn",null)}),s=this._originalMappings[++a]}return o},t.SourceMapConsumer=c,u.prototype=Object.create(c.prototype),u.prototype.consumer=c,u.prototype._findSourceIndex=function(e){var t,r=e;if(null!=this.sourceRoot&&(r=i.relative(this.sourceRoot,r)),this._sources.has(r))return this._sources.indexOf(r);for(t=0;t<this._absoluteSources.length;++t)if(this._absoluteSources[t]==e)return t;return-1},u.fromSourceMap=function(e,t){var r=Object.create(u.prototype),n=r._names=o.fromArray(e._names.toArray(),!0),a=r._sources=o.fromArray(e._sources.toArray(),!0);r.sourceRoot=e._sourceRoot,r.sourcesContent=e._generateSourcesContent(r._sources.toArray(),r.sourceRoot),r.file=e._file,r._sourceMapURL=t,r._absoluteSources=r._sources.toArray().map((function(e){return i.computeSourceURL(r.sourceRoot,e,t)}));for(var c=e._mappings.toArray().slice(),h=r.__generatedMappings=[],d=r.__originalMappings=[],p=0,f=c.length;p<f;p++){var g=c[p],m=new l;m.generatedLine=g.generatedLine,m.generatedColumn=g.generatedColumn,g.source&&(m.source=a.indexOf(g.source),m.originalLine=g.originalLine,m.originalColumn=g.originalColumn,g.name&&(m.name=n.indexOf(g.name)),d.push(m)),h.push(m)}return s(r.__originalMappings,i.compareByOriginalPositions),r},u.prototype._version=3,Object.defineProperty(u.prototype,"sources",{get:function(){return this._absoluteSources.slice()}}),u.prototype._parseMappings=function(e,t){for(var r,n,o,c,u,h=1,d=0,p=0,f=0,g=0,m=0,v=e.length,y=0,C={},S={},E=[],_=[];y<v;)if(";"===e.charAt(y))h++,y++,d=0;else if(","===e.charAt(y))y++;else{for((r=new l).generatedLine=h,c=y;c<v&&!this._charIsMappingSeparator(e,c);c++);if(o=C[n=e.slice(y,c)])y+=n.length;else{for(o=[];y<c;)a.decode(e,y,S),u=S.value,y=S.rest,o.push(u);if(2===o.length)throw new Error("Found a source, but no line and column");if(3===o.length)throw new Error("Found a source and line, but no column");C[n]=o}r.generatedColumn=d+o[0],d=r.generatedColumn,o.length>1&&(r.source=g+o[1],g+=o[1],r.originalLine=p+o[2],p=r.originalLine,r.originalLine+=1,r.originalColumn=f+o[3],f=r.originalColumn,o.length>4&&(r.name=m+o[4],m+=o[4])),_.push(r),"number"==typeof r.originalLine&&E.push(r)}s(_,i.compareByGeneratedPositionsDeflated),this.__generatedMappings=_,s(E,i.compareByOriginalPositions),this.__originalMappings=E},u.prototype._findMapping=function(e,t,r,i,o,a){if(e[r]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[r]);if(e[i]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[i]);return n.search(e,t,o,a)},u.prototype.computeColumnSpans=function(){for(var e=0;e<this._generatedMappings.length;++e){var t=this._generatedMappings[e];if(e+1<this._generatedMappings.length){var r=this._generatedMappings[e+1];if(t.generatedLine===r.generatedLine){t.lastGeneratedColumn=r.generatedColumn-1;continue}}t.lastGeneratedColumn=1/0}},u.prototype.originalPositionFor=function(e){var t={generatedLine:i.getArg(e,"line"),generatedColumn:i.getArg(e,"column")},r=this._findMapping(t,this._generatedMappings,"generatedLine","generatedColumn",i.compareByGeneratedPositionsDeflated,i.getArg(e,"bias",c.GREATEST_LOWER_BOUND));if(r>=0){var n=this._generatedMappings[r];if(n.generatedLine===t.generatedLine){var o=i.getArg(n,"source",null);null!==o&&(o=this._sources.at(o),o=i.computeSourceURL(this.sourceRoot,o,this._sourceMapURL));var a=i.getArg(n,"name",null);return null!==a&&(a=this._names.at(a)),{source:o,line:i.getArg(n,"originalLine",null),column:i.getArg(n,"originalColumn",null),name:a}}}return{source:null,line:null,column:null,name:null}},u.prototype.hasContentsOfAllSources=function(){return!!this.sourcesContent&&(this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some((function(e){return null==e})))},u.prototype.sourceContentFor=function(e,t){if(!this.sourcesContent)return null;var r=this._findSourceIndex(e);if(r>=0)return this.sourcesContent[r];var n,o=e;if(null!=this.sourceRoot&&(o=i.relative(this.sourceRoot,o)),null!=this.sourceRoot&&(n=i.urlParse(this.sourceRoot))){var a=o.replace(/^file:\/\//,"");if("file"==n.scheme&&this._sources.has(a))return this.sourcesContent[this._sources.indexOf(a)];if((!n.path||"/"==n.path)&&this._sources.has("/"+o))return this.sourcesContent[this._sources.indexOf("/"+o)]}if(t)return null;throw new Error('"'+o+'" is not in the SourceMap.')},u.prototype.generatedPositionFor=function(e){var t=i.getArg(e,"source");if((t=this._findSourceIndex(t))<0)return{line:null,column:null,lastColumn:null};var r={source:t,originalLine:i.getArg(e,"line"),originalColumn:i.getArg(e,"column")},n=this._findMapping(r,this._originalMappings,"originalLine","originalColumn",i.compareByOriginalPositions,i.getArg(e,"bias",c.GREATEST_LOWER_BOUND));if(n>=0){var o=this._originalMappings[n];if(o.source===r.source)return{line:i.getArg(o,"generatedLine",null),column:i.getArg(o,"generatedColumn",null),lastColumn:i.getArg(o,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},h.prototype=Object.create(c.prototype),h.prototype.constructor=c,h.prototype._version=3,Object.defineProperty(h.prototype,"sources",{get:function(){for(var e=[],t=0;t<this._sections.length;t++)for(var r=0;r<this._sections[t].consumer.sources.length;r++)e.push(this._sections[t].consumer.sources[r]);return e}}),h.prototype.originalPositionFor=function(e){var t={generatedLine:i.getArg(e,"line"),generatedColumn:i.getArg(e,"column")},r=n.search(t,this._sections,(function(e,t){var r=e.generatedLine-t.generatedOffset.generatedLine;return r||e.generatedColumn-t.generatedOffset.generatedColumn})),o=this._sections[r];return o?o.consumer.originalPositionFor({line:t.generatedLine-(o.generatedOffset.generatedLine-1),column:t.generatedColumn-(o.generatedOffset.generatedLine===t.generatedLine?o.generatedOffset.generatedColumn-1:0),bias:e.bias}):{source:null,line:null,column:null,name:null}},h.prototype.hasContentsOfAllSources=function(){return this._sections.every((function(e){return e.consumer.hasContentsOfAllSources()}))},h.prototype.sourceContentFor=function(e,t){for(var r=0;r<this._sections.length;r++){var i=this._sections[r].consumer.sourceContentFor(e,!0);if(i)return i}if(t)return null;throw new Error('"'+e+'" is not in the SourceMap.')},h.prototype.generatedPositionFor=function(e){for(var t=0;t<this._sections.length;t++){var r=this._sections[t];if(-1!==r.consumer._findSourceIndex(i.getArg(e,"source"))){var n=r.consumer.generatedPositionFor(e);if(n)return{line:n.line+(r.generatedOffset.generatedLine-1),column:n.column+(r.generatedOffset.generatedLine===n.line?r.generatedOffset.generatedColumn-1:0)}}}return{line:null,column:null}},h.prototype._parseMappings=function(e,t){this.__generatedMappings=[],this.__originalMappings=[];for(var r=0;r<this._sections.length;r++)for(var n=this._sections[r],o=n.consumer._generatedMappings,a=0;a<o.length;a++){var c=o[a],u=n.consumer._sources.at(c.source);u=i.computeSourceURL(n.consumer.sourceRoot,u,this._sourceMapURL),this._sources.add(u),u=this._sources.indexOf(u);var l=null;c.name&&(l=n.consumer._names.at(c.name),this._names.add(l),l=this._names.indexOf(l));var h={source:u,generatedLine:c.generatedLine+(n.generatedOffset.generatedLine-1),generatedColumn:c.generatedColumn+(n.generatedOffset.generatedLine===c.generatedLine?n.generatedOffset.generatedColumn-1:0),originalLine:c.originalLine,originalColumn:c.originalColumn,name:l};this.__generatedMappings.push(h),"number"==typeof h.originalLine&&this.__originalMappings.push(h)}s(this.__generatedMappings,i.compareByGeneratedPositionsDeflated),s(this.__originalMappings,i.compareByOriginalPositions)}},4041:(e,t,r)=>{var i=r(7092),n=r(251),o=r(735).C,a=r(3302).P;function s(e){e||(e={}),this._file=n.getArg(e,"file",null),this._sourceRoot=n.getArg(e,"sourceRoot",null),this._skipValidation=n.getArg(e,"skipValidation",!1),this._sources=new o,this._names=new o,this._mappings=new a,this._sourcesContents=null}s.prototype._version=3,s.fromSourceMap=function(e){var t=e.sourceRoot,r=new s({file:e.file,sourceRoot:t});return e.eachMapping((function(e){var i={generated:{line:e.generatedLine,column:e.generatedColumn}};null!=e.source&&(i.source=e.source,null!=t&&(i.source=n.relative(t,i.source)),i.original={line:e.originalLine,column:e.originalColumn},null!=e.name&&(i.name=e.name)),r.addMapping(i)})),e.sources.forEach((function(i){var o=i;null!==t&&(o=n.relative(t,i)),r._sources.has(o)||r._sources.add(o);var a=e.sourceContentFor(i);null!=a&&r.setSourceContent(i,a)})),r},s.prototype.addMapping=function(e){var t=n.getArg(e,"generated"),r=n.getArg(e,"original",null),i=n.getArg(e,"source",null),o=n.getArg(e,"name",null);this._skipValidation||this._validateMapping(t,r,i,o),null!=i&&(i=String(i),this._sources.has(i)||this._sources.add(i)),null!=o&&(o=String(o),this._names.has(o)||this._names.add(o)),this._mappings.add({generatedLine:t.line,generatedColumn:t.column,originalLine:null!=r&&r.line,originalColumn:null!=r&&r.column,source:i,name:o})},s.prototype.setSourceContent=function(e,t){var r=e;null!=this._sourceRoot&&(r=n.relative(this._sourceRoot,r)),null!=t?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[n.toSetString(r)]=t):this._sourcesContents&&(delete this._sourcesContents[n.toSetString(r)],0===Object.keys(this._sourcesContents).length&&(this._sourcesContents=null))},s.prototype.applySourceMap=function(e,t,r){var i=t;if(null==t){if(null==e.file)throw new Error('SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map\'s "file" property. Both were omitted.');i=e.file}var a=this._sourceRoot;null!=a&&(i=n.relative(a,i));var s=new o,c=new o;this._mappings.unsortedForEach((function(t){if(t.source===i&&null!=t.originalLine){var o=e.originalPositionFor({line:t.originalLine,column:t.originalColumn});null!=o.source&&(t.source=o.source,null!=r&&(t.source=n.join(r,t.source)),null!=a&&(t.source=n.relative(a,t.source)),t.originalLine=o.line,t.originalColumn=o.column,null!=o.name&&(t.name=o.name))}var u=t.source;null==u||s.has(u)||s.add(u);var l=t.name;null==l||c.has(l)||c.add(l)}),this),this._sources=s,this._names=c,e.sources.forEach((function(t){var i=e.sourceContentFor(t);null!=i&&(null!=r&&(t=n.join(r,t)),null!=a&&(t=n.relative(a,t)),this.setSourceContent(t,i))}),this)},s.prototype._validateMapping=function(e,t,r,i){if(t&&"number"!=typeof t.line&&"number"!=typeof t.column)throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if((!(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0)||t||r||i)&&!(e&&"line"in e&&"column"in e&&t&&"line"in t&&"column"in t&&e.line>0&&e.column>=0&&t.line>0&&t.column>=0&&r))throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:r,original:t,name:i}))},s.prototype._serializeMappings=function(){for(var e,t,r,o,a=0,s=1,c=0,u=0,l=0,h=0,d="",p=this._mappings.toArray(),f=0,g=p.length;f<g;f++){if(e="",(t=p[f]).generatedLine!==s)for(a=0;t.generatedLine!==s;)e+=";",s++;else if(f>0){if(!n.compareByGeneratedPositionsInflated(t,p[f-1]))continue;e+=","}e+=i.encode(t.generatedColumn-a),a=t.generatedColumn,null!=t.source&&(o=this._sources.indexOf(t.source),e+=i.encode(o-h),h=o,e+=i.encode(t.originalLine-1-u),u=t.originalLine-1,e+=i.encode(t.originalColumn-c),c=t.originalColumn,null!=t.name&&(r=this._names.indexOf(t.name),e+=i.encode(r-l),l=r)),d+=e}return d},s.prototype._generateSourcesContent=function(e,t){return e.map((function(e){if(!this._sourcesContents)return null;null!=t&&(e=n.relative(t,e));var r=n.toSetString(e);return Object.prototype.hasOwnProperty.call(this._sourcesContents,r)?this._sourcesContents[r]:null}),this)},s.prototype.toJSON=function(){var e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return null!=this._file&&(e.file=this._file),null!=this._sourceRoot&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e},s.prototype.toString=function(){return JSON.stringify(this.toJSON())},t.x=s},1683:(e,t,r)=>{var i=r(4041).x,n=r(251),o=/(\r?\n)/,a="$$$isSourceNode$$$";function s(e,t,r,i,n){this.children=[],this.sourceContents={},this.line=null==e?null:e,this.column=null==t?null:t,this.source=null==r?null:r,this.name=null==n?null:n,this[a]=!0,null!=i&&this.add(i)}s.fromStringWithSourceMap=function(e,t,r){var i=new s,a=e.split(o),c=0,u=function(){return e()+(e()||"");function e(){return c<a.length?a[c++]:void 0}},l=1,h=0,d=null;return t.eachMapping((function(e){if(null!==d){if(!(l<e.generatedLine)){var t=(r=a[c]||"").substr(0,e.generatedColumn-h);return a[c]=r.substr(e.generatedColumn-h),h=e.generatedColumn,p(d,t),void(d=e)}p(d,u()),l++,h=0}for(;l<e.generatedLine;)i.add(u()),l++;if(h<e.generatedColumn){var r=a[c]||"";i.add(r.substr(0,e.generatedColumn)),a[c]=r.substr(e.generatedColumn),h=e.generatedColumn}d=e}),this),c<a.length&&(d&&p(d,u()),i.add(a.splice(c).join(""))),t.sources.forEach((function(e){var o=t.sourceContentFor(e);null!=o&&(null!=r&&(e=n.join(r,e)),i.setSourceContent(e,o))})),i;function p(e,t){if(null===e||void 0===e.source)i.add(t);else{var o=r?n.join(r,e.source):e.source;i.add(new s(e.originalLine,e.originalColumn,o,t,e.name))}}},s.prototype.add=function(e){if(Array.isArray(e))e.forEach((function(e){this.add(e)}),this);else{if(!e[a]&&"string"!=typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);e&&this.children.push(e)}return this},s.prototype.prepend=function(e){if(Array.isArray(e))for(var t=e.length-1;t>=0;t--)this.prepend(e[t]);else{if(!e[a]&&"string"!=typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);this.children.unshift(e)}return this},s.prototype.walk=function(e){for(var t,r=0,i=this.children.length;r<i;r++)(t=this.children[r])[a]?t.walk(e):""!==t&&e(t,{source:this.source,line:this.line,column:this.column,name:this.name})},s.prototype.join=function(e){var t,r,i=this.children.length;if(i>0){for(t=[],r=0;r<i-1;r++)t.push(this.children[r]),t.push(e);t.push(this.children[r]),this.children=t}return this},s.prototype.replaceRight=function(e,t){var r=this.children[this.children.length-1];return r[a]?r.replaceRight(e,t):"string"==typeof r?this.children[this.children.length-1]=r.replace(e,t):this.children.push("".replace(e,t)),this},s.prototype.setSourceContent=function(e,t){this.sourceContents[n.toSetString(e)]=t},s.prototype.walkSourceContents=function(e){for(var t=0,r=this.children.length;t<r;t++)this.children[t][a]&&this.children[t].walkSourceContents(e);var i=Object.keys(this.sourceContents);for(t=0,r=i.length;t<r;t++)e(n.fromSetString(i[t]),this.sourceContents[i[t]])},s.prototype.toString=function(){var e="";return this.walk((function(t){e+=t})),e},s.prototype.toStringWithSourceMap=function(e){var t={code:"",line:1,column:0},r=new i(e),n=!1,o=null,a=null,s=null,c=null;return this.walk((function(e,i){t.code+=e,null!==i.source&&null!==i.line&&null!==i.column?(o===i.source&&a===i.line&&s===i.column&&c===i.name||r.addMapping({source:i.source,original:{line:i.line,column:i.column},generated:{line:t.line,column:t.column},name:i.name}),o=i.source,a=i.line,s=i.column,c=i.name,n=!0):n&&(r.addMapping({generated:{line:t.line,column:t.column}}),o=null,n=!1);for(var u=0,l=e.length;u<l;u++)10===e.charCodeAt(u)?(t.line++,t.column=0,u+1===l?(o=null,n=!1):n&&r.addMapping({source:i.source,original:{line:i.line,column:i.column},generated:{line:t.line,column:t.column},name:i.name})):t.column++})),this.walkSourceContents((function(e,t){r.setSourceContent(e,t)})),{code:t.code,map:r}}},251:(e,t)=>{t.getArg=function(e,t,r){if(t in e)return e[t];if(3===arguments.length)return r;throw new Error('"'+t+'" is a required argument.')};var r=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,i=/^data:.+\,.+$/;function n(e){var t=e.match(r);return t?{scheme:t[1],auth:t[2],host:t[3],port:t[4],path:t[5]}:null}function o(e){var t="";return e.scheme&&(t+=e.scheme+":"),t+="//",e.auth&&(t+=e.auth+"@"),e.host&&(t+=e.host),e.port&&(t+=":"+e.port),e.path&&(t+=e.path),t}function a(e){var r=e,i=n(e);if(i){if(!i.path)return e;r=i.path}for(var a,s=t.isAbsolute(r),c=r.split(/\/+/),u=0,l=c.length-1;l>=0;l--)"."===(a=c[l])?c.splice(l,1):".."===a?u++:u>0&&(""===a?(c.splice(l+1,u),u=0):(c.splice(l,2),u--));return""===(r=c.join("/"))&&(r=s?"/":"."),i?(i.path=r,o(i)):r}function s(e,t){""===e&&(e="."),""===t&&(t=".");var r=n(t),s=n(e);if(s&&(e=s.path||"/"),r&&!r.scheme)return s&&(r.scheme=s.scheme),o(r);if(r||t.match(i))return t;if(s&&!s.host&&!s.path)return s.host=t,o(s);var c="/"===t.charAt(0)?t:a(e.replace(/\/+$/,"")+"/"+t);return s?(s.path=c,o(s)):c}t.urlParse=n,t.urlGenerate=o,t.normalize=a,t.join=s,t.isAbsolute=function(e){return"/"===e.charAt(0)||r.test(e)},t.relative=function(e,t){""===e&&(e="."),e=e.replace(/\/$/,"");for(var r=0;0!==t.indexOf(e+"/");){var i=e.lastIndexOf("/");if(i<0)return t;if((e=e.slice(0,i)).match(/^([^\/]+:\/)?\/*$/))return t;++r}return Array(r+1).join("../")+t.substr(e.length+1)};var c=!("__proto__"in Object.create(null));function u(e){return e}function l(e){if(!e)return!1;var t=e.length;if(t<9)return!1;if(95!==e.charCodeAt(t-1)||95!==e.charCodeAt(t-2)||111!==e.charCodeAt(t-3)||116!==e.charCodeAt(t-4)||111!==e.charCodeAt(t-5)||114!==e.charCodeAt(t-6)||112!==e.charCodeAt(t-7)||95!==e.charCodeAt(t-8)||95!==e.charCodeAt(t-9))return!1;for(var r=t-10;r>=0;r--)if(36!==e.charCodeAt(r))return!1;return!0}function h(e,t){return e===t?0:null===e?1:null===t?-1:e>t?1:-1}t.toSetString=c?u:function(e){return l(e)?"$"+e:e},t.fromSetString=c?u:function(e){return l(e)?e.slice(1):e},t.compareByOriginalPositions=function(e,t,r){var i=h(e.source,t.source);return 0!==i||0!==(i=e.originalLine-t.originalLine)||0!==(i=e.originalColumn-t.originalColumn)||r||0!==(i=e.generatedColumn-t.generatedColumn)||0!==(i=e.generatedLine-t.generatedLine)?i:h(e.name,t.name)},t.compareByGeneratedPositionsDeflated=function(e,t,r){var i=e.generatedLine-t.generatedLine;return 0!==i||0!==(i=e.generatedColumn-t.generatedColumn)||r||0!==(i=h(e.source,t.source))||0!==(i=e.originalLine-t.originalLine)||0!==(i=e.originalColumn-t.originalColumn)?i:h(e.name,t.name)},t.compareByGeneratedPositionsInflated=function(e,t){var r=e.generatedLine-t.generatedLine;return 0!==r||0!==(r=e.generatedColumn-t.generatedColumn)||0!==(r=h(e.source,t.source))||0!==(r=e.originalLine-t.originalLine)||0!==(r=e.originalColumn-t.originalColumn)?r:h(e.name,t.name)},t.parseSourceMapInput=function(e){return JSON.parse(e.replace(/^\)]}'[^\n]*\n/,""))},t.computeSourceURL=function(e,t,r){if(t=t||"",e&&("/"!==e[e.length-1]&&"/"!==t[0]&&(e+="/"),t=e+t),r){var i=n(r);if(!i)throw new Error("sourceMapURL could not be parsed");if(i.path){var c=i.path.lastIndexOf("/");c>=0&&(i.path=i.path.substring(0,c+1))}t=s(o(i),t)}return a(t)}},9665:(e,t,r)=>{r(4041).x,t.SourceMapConsumer=r(7446).SourceMapConsumer,r(1683)},175:(e,t,r)=>{var i=r(1094),n=r(3193).StringDecoder;e.exports=function(e,t,r){var o=new n,a="",s=r&&r.maxLength,c=!r||!1!==r.trailing;"function"==typeof e&&(t=e,e=null);e||(e=/\r?\n/);function u(e,r){if(t){try{r=t(r)}catch(t){return e.emit("error",t)}void 0!==r&&e.queue(r)}else e.queue(r)}function l(t,r){var i=((null!=a?a:"")+r).split(e);if(a=i.pop(),s&&a.length>s)return t.emit("error",new Error("maximum buffer reached"));for(var n=0;n<i.length;n++){u(t,i[n])}}return i((function(e){l(this,o.write(e))}),(function(){o.end&&l(this,o.end()),c&&null!=a&&u(this,a),this.queue(null)}))}},8497:(e,t,r)=>{var i=r(4928),n=r(1094);e.exports=function(){var e;if(0==(e=1==arguments.length&&Array.isArray(arguments[0])?arguments[0]:[].slice.call(arguments)).length)return n();if(1==e.length)return e[0];var t=e[0],r=e[e.length-1],o=i(t,r);function a(){var e=[].slice.call(arguments);e.unshift("error"),o.emit.apply(o,e)}!function e(t){t.length<2||(t[0].pipe(t[1]),e(t.slice(1)))}(e);for(var s=1;s<e.length-1;s++)e[s].on("error",a);return o}},7687:(e,t,r)=>{"use strict";const i=r(857),n=r(2018),o=r(5884),{env:a}=process;let s;function c(e,{streamIsTTY:t,sniffFlags:r=!0}={}){const n=function(){if("FORCE_COLOR"in a)return"true"===a.FORCE_COLOR?1:"false"===a.FORCE_COLOR?0:0===a.FORCE_COLOR.length?1:Math.min(Number.parseInt(a.FORCE_COLOR,10),3)}();void 0!==n&&(s=n);const c=r?s:n;if(0===c)return 0;if(r){if(o("color=16m")||o("color=full")||o("color=truecolor"))return 3;if(o("color=256"))return 2}if(e&&!t&&void 0===c)return 0;const u=c||0;if("dumb"===a.TERM)return u;if("win32"===process.platform){const e=i.release().split(".");return Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in a)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE","DRONE"].some((e=>e in a))||"codeship"===a.CI_NAME?1:u;if("TEAMCITY_VERSION"in a)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(a.TEAMCITY_VERSION)?1:0;if("truecolor"===a.COLORTERM)return 3;if("TERM_PROGRAM"in a){const e=Number.parseInt((a.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(a.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(a.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(a.TERM)||"COLORTERM"in a?1:u}function u(e,t={}){return function(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}(c(e,{streamIsTTY:e&&e.isTTY,...t}))}o("no-color")||o("no-colors")||o("color=false")||o("color=never")?s=0:(o("color")||o("colors")||o("color=true")||o("color=always"))&&(s=1),e.exports={supportsColor:u,stdout:u({isTTY:n.isatty(1)}),stderr:u({isTTY:n.isatty(2)})}},1094:(e,t,r)=>{var i=r(2203);function n(e,t,r){e=e||function(e){this.queue(e)},t=t||function(){this.queue(null)};var n=!1,o=!1,a=[],s=!1,c=new i;function u(){for(;a.length&&!c.paused;){var e=a.shift();if(null===e)return c.emit("end");c.emit("data",e)}}return c.readable=c.writable=!0,c.paused=!1,c.autoDestroy=!(r&&!1===r.autoDestroy),c.write=function(t){return e.call(this,t),!c.paused},c.queue=c.push=function(e){return s||(null===e&&(s=!0),a.push(e),u()),c},c.on("end",(function(){c.readable=!1,!c.writable&&c.autoDestroy&&process.nextTick((function(){c.destroy()}))})),c.end=function(e){if(!n)return n=!0,arguments.length&&c.write(e),c.writable=!1,t.call(c),!c.readable&&c.autoDestroy&&c.destroy(),c},c.destroy=function(){if(!o)return o=!0,n=!0,a.length=0,c.writable=c.readable=!1,c.emit("close"),c},c.pause=function(){if(!c.paused)return c.paused=!0,c},c.resume=function(){return c.paused&&(c.paused=!1,c.emit("resume")),u(),c.paused||c.emit("drain"),c},c}e.exports=n,n.through=n},294:e=>{"use strict";var t=function(e,t,r){process.nextTick((function(){e(t,r)}))};function r(){}function i(e,t){e.apply(null,t)}process.nextTick((function(e){42===e&&(t=process.nextTick)}),42),e.exports=function(e){var n=function r(o){var a=[o];function s(e){a.push(e)}function c(e){var o=arguments;for(n=function(e){return"[object Error]"===Object.prototype.toString.call(e)}(e)?r:s;a.length;)s(a.shift());function s(e){t(i,e,o)}}n=s,e(c)};return function(e){n(e||r)}}},6346:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FfmpegProcess=void 0,t.sleep=y,t.fetchFffmpeg=function(e){const t=process.platform+"-"+process.arch,r=l.default.join(e,"ffmpeg");u.default.existsSync(r)&&(m(r),v(r));if(!u.default.existsSync(r)){console.info(`Could not find ffmpeg at ${r}, installing ...`);const e=f+t;let i=u.default.createWriteStream(r);switch(t){case"darwin-x64":case"linux-x64":case"linux-arm":g(e,i,(()=>{m(r),v(r)}));break;default:console.error(`Unsupported platform, install your own 'ffmpeg' binary at this path: ${r}`)}}return r},t.safeKillFFmpeg=async function(e){if(!e)return;if(null!=e.exitCode)return;await new Promise((async t=>{e.on("exit",t);try{e.stdin.on("error",(()=>{})),e.stdin.write("q\n")}catch(e){}await y(2e3);for(const t of e.stdio)try{t?.destroy()}catch(e){}e.kill(),await y(2e3),e.kill("SIGKILL")}))};const s=o(r(5317)),c=a(r(857)),u=a(r(9896)),l=a(r(6928)),h=a(r(3785)),d=a(r(5692)),p={timeout:2e3,rejectUnauthorized:!1},f="https://github.com/slyoldfox/ffmpeg-for-bticino/releases/download/v2024.5.1/ffmpeg-";function g(e,t,r){d.default.get(e,p,(e=>{if(301===e.statusCode||302===e.statusCode)return g(e.headers.location,t,r);console.log("[FFMPEG] File size is: "+e.headers["content-length"]),e.pipe(t);let i=Number(e.headers["content-length"]),n=0,o=new Date;e.on("data",(e=>{if(n+=e.length,(new Date).getTime()-o.getTime()>500){let e=Math.round(n/i*100);console.log(`[FFMPEG] Downloaded ${n}/${i} (${e}%)`),o=new Date}})),e.on("end",(()=>{t.close((()=>{r()})),t.end((()=>{console.log("[FFMPEG] Download ended.")}))}))}))}function m(e){const t=u.default.constants.S_IROTH|u.default.constants.S_IXOTH|u.default.constants.S_IRUSR|u.default.constants.S_IXUSR|u.default.constants.S_IRGRP|u.default.constants.S_IXGRP;try{u.default.accessSync(e,u.default.constants.R_OK|u.default.constants.X_OK)}catch(r){u.default.chmodSync(e,t)}}function v(e){try{if(0==u.default.statSync(e).size)u.default.rmSync(e);else{s.default.execSync(e+" -version").toString();console.log(`[FFMPEG] valid binary file at: ${e}`)}}catch(t){console.error("[FFMPEG] binary file corrupt? Removing it. Error: "+t),u.default.rmSync(e)}}async function y(e){await new Promise((t=>setTimeout(t,e)))}t.FfmpegProcess=class{constructor(e,t,r,i,n,o=!1,a,c){n.debug("Stream command: "+r+" "+i,e,o);let u=!1;const l=Date.now();this.process=(0,s.spawn)(r,i.split(/\s+/),{env:process.env}),this.stdin=this.process.stdin,this.process.stdout.on("data",(t=>{const r=this.parseProgress(t);if(r&&!u&&r.frame>0){u=!0;const t=(Date.now()-l)/1e3,r="Getting the first frames took "+t+" seconds.";t<5?n.debug(r,e,o):t<22?n.warn(r,e):n.error(r,e)}}));h.default.createInterface({input:this.process.stderr,terminal:!1}).on("line",(t=>{c&&(c(),c=void 0),o&&t.match(/\[(panic|fatal|error)\]/)?n.error(t,e):o&&n.debug(t,e,!0)})),this.process.on("error",(r=>{n.error("FFmpeg process creation failed: "+r.message,e),c&&c(new Error("FFmpeg process creation failed")),a.stopStream(t)})),this.process.on("exit",((r,i)=>{this.killTimeout&&clearTimeout(this.killTimeout);const s="FFmpeg exited with code: "+r+" and signal: "+i;this.killTimeout&&0===r?n.debug(s+" (Expected)",e,o):null==r||255===r?this.process.killed?n.debug(s+" (Forced)",e,o):n.error(s+" (Unexpected)",e):(n.error(s+" (Error)",e),a.stopStream(t),!u&&c?c(new Error(s)):a.controller.forceStopStreamingSession(t))}))}parseProgress(e){const t=e.toString();if(0==t.indexOf("frame="))try{const e=new Map;return t.split(/\r?\n/).forEach((t=>{const r=t.split("=",2);e.set(r[0],r[1])})),{frame:parseInt(e.get("frame")),fps:parseFloat(e.get("fps")),stream_q:parseFloat(e.get("stream_0_0_q")),bitrate:parseFloat(e.get("bitrate")),total_size:parseInt(e.get("total_size")),out_time_us:parseInt(e.get("out_time_us")),out_time:e.get("out_time").trim(),dup_frames:parseInt(e.get("dup_frames")),drop_frames:parseInt(e.get("drop_frames")),speed:parseFloat(e.get("speed")),progress:e.get("progress").trim()}}catch{return}}stop(){this.process.stdin.write("q"+c.default.EOL),this.killTimeout=setTimeout((()=>{this.process.kill("SIGKILL")}),2e3)}}},4790:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RecordingDelegate=void 0;const n=r(3103),o=r(4679),a=r(4434),s=r(9278),c=r(5317),u=i(r(2613)),l=r(6346);class h{constructor(e,t,r,i,n){this.debugMode=!1,this.destroyed=!1,this.debugMode=e,this.connectPromise=new Promise((e=>this.connectResolve=e)),this.server=(0,s.createServer)(this.handleConnection.bind(this)),this.ffmpegPath=t,this.args=[],this.args.push(...r),this.args.push(...i),this.args.push("-f","mp4"),this.args.push(...n),this.args.push("-fflags","+genpts","-reset_timestamps","1"),this.args.push("-movflags","frag_keyframe+empty_moov+default_base_moof+skip_sidx+skip_trailer")}async start(){const e=(0,a.once)(this.server,"listening");if(this.server.listen(),await e,this.destroyed)return;const t=this.server.address().port;this.args.push("tcp://127.0.0.1:"+t),console.log(this.ffmpegPath+" "+this.args.join(" ")),this.childProcess=(0,c.spawn)(this.ffmpegPath,this.args,{env:process.env,stdio:this.debugMode?"pipe":"ignore"}),this.childProcess||console.error("ChildProcess is undefined directly after the init!"),this.debugMode&&(this.childProcess.stdout?.on("data",(e=>console.log(e.toString()))),this.childProcess.stderr?.on("data",(e=>console.log(e.toString()))))}destroy(){(0,l.safeKillFFmpeg)(this.childProcess),this.socket?.destroy(),this.socket=void 0,this.childProcess=void 0,this.destroyed=!0}handleConnection(e){this.server.close(),this.socket=e,this.connectResolve?.()}async*generator(){if(await this.connectPromise,!this.socket||!this.childProcess)throw console.log("Socket undefined "+!!this.socket+" childProcess undefined "+!!this.childProcess),new Error("Unexpected state!");for(;;){const e=await this.read(8),t=e.readInt32BE(0)-8,r=e.slice(4).toString(),i=await this.read(t);yield{header:e,length:t,type:r,data:i}}}async read(e){if(!this.socket)throw Error("FFMPEG tried reading from closed socket!");if(!e)return Buffer.alloc(0);const t=this.socket.read(e);return t||new Promise(((t,r)=>{const i=()=>{const r=this.socket.read(e);r&&(o(),t(r))},n=()=>{o(),r(new Error(`FFMPEG socket closed during read for ${e} bytes!`))},o=()=>{this.socket?.removeListener("readable",i),this.socket?.removeListener("close",n)};if(!this.socket)throw new Error("FFMPEG socket is closed now!");this.socket.on("readable",i),this.socket.on("close",n)}))}}t.RecordingDelegate=class{constructor(e,t){this.videoConfig=e,this.camera=t,this.log=new o.Logger,this.handlingStreamingRequest=!1}updateRecordingActive(e){this.log.debug(`Recording: ${e}`,this.videoConfig.displayName)}updateRecordingConfiguration(e){this.configuration=e}async*handleRecordingStreamRequest(e){(0,u.default)(!!this.configuration);this.handlingStreamingRequest=!0,(0,u.default)(0===this.configuration.videoCodec.type);2===this.configuration.videoCodec.parameters.profile||this.configuration.videoCodec.parameters.profile,2===this.configuration.videoCodec.parameters.level||this.configuration.videoCodec.parameters.level;let t;switch(this.configuration.audioCodec.samplerate){case 0:t="8";break;case 1:t="16";break;case 2:t="24";break;case 3:t="32";break;case 4:t="44.1";break;case 5:t="48";break;default:throw new Error("Unsupported audio samplerate: "+this.configuration.audioCodec.samplerate)}const r=this.controller?.recordingManagement?.recordingManagementService.getCharacteristic(n.Characteristic.RecordingAudioActive)?["-acodec","libfdk_aac",...0===this.configuration.audioCodec.type?["-profile:a","aac_low"]:["-profile:a","aac_eld"],"-ar",`${t}k`,"-b:a",`${this.configuration.audioCodec.bitrate}k`,"-ac",`${this.configuration.audioCodec.audioChannels}`]:[];if(this.server=new h(this.videoConfig.debug,this.videoConfig.$internalVideoProcessor,("-f rtsp "+this.videoConfig.source+"-recorder").split(/\s+/g),r,["-sn","-dn","-codec:v","copy"]),await this.server.start(),!this.server||this.server.destroyed)return;const i=[];try{for await(const e of this.server.generator()){i.push(e.header,e.data);const t=this.camera.getService(n.Service.MotionSensor)?.getCharacteristic(n.Characteristic.MotionDetected).value;if(console.log("mp4 box type "+e.type+" and length "+e.length+" motion: "+t),"moov"===e.type||"mdat"===e.type){const e=Buffer.concat(i);i.splice(0,i.length);const t=false;if(yield{data:e,isLast:t},t){console.log("Ending session due to motion stopped!");break}}}}catch(e){e.message.startsWith("FFMPEG")||console.error("Encountered unexpected error on generator "+e.stack)}}acknowledgeStream(e){this.closeRecordingStream(e)}closeRecordingStream(e,t){this.server&&(this.server.destroy(),this.server=void 0),this.handlingStreamingRequest=!1}setController(e){this.controller=e}}},5592:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.StreamingDelegate=void 0;const n=r(5317),o=r(3103),a=i(r(4280)),s=r(7194),c=r(6346),u=r(4679);t.StreamingDelegate=class{constructor(e){this.log=new u.Logger,this.pendingSessions=new Map,this.ongoingSessions=new Map,this.timeouts=new Map,this.cameraName=e.displayName,this.unbridge=!0,this.videoConfig=e,this.videoProcessor=e.videoProcessor||e.$internalVideoProcessor}setController(e){this.controller=e}determineResolution(e,t){const r={width:e.width,height:e.height};t||(void 0!==this.videoConfig.maxWidth&&(this.videoConfig.forceMax||e.width>this.videoConfig.maxWidth)&&(r.width=this.videoConfig.maxWidth),void 0!==this.videoConfig.maxHeight&&(this.videoConfig.forceMax||e.height>this.videoConfig.maxHeight)&&(r.height=this.videoConfig.maxHeight));const i=this.videoConfig.videoFilter?.split(",")||[],n=i.indexOf("none");return n>=0&&i.splice(n,1),r.snapFilter=i.join(","),n<0&&(r.width>0||r.height>0)&&(r.resizeFilter="scale="+(r.width>0?"'min("+r.width+",iw)'":"iw")+":"+(r.height>0?"'min("+r.height+",ih)'":"ih")+":force_original_aspect_ratio=decrease",i.push(r.resizeFilter),i.push("scale=trunc(iw/2)*2:trunc(ih/2)*2")),i.length>0&&(r.videoFilter=i.join(",")),r}fetchSnapshot(e){const t=this.videoConfig.stillImageSourceCacheTime||3e5;return this.snapshotPromise=new Promise(((r,i)=>{const o=Date.now(),a=(this.videoConfig.stillImageSource||this.videoConfig.source)+" -frames:v 1"+(e?" -filter:v "+e:"")+" -f image2 - -hide_banner -loglevel error";this.log.debug("Snapshot command: "+this.videoProcessor+" "+a,this.cameraName,this.videoConfig.debug);const s=(0,n.spawn)(this.videoProcessor,a.split(/\s+/),{env:process.env}),u=setTimeout((()=>{(0,c.safeKillFFmpeg)(s),i(new Error("Operation timed out creating snapshot"))}),6e3);let l=Buffer.alloc(0);s.stdout.on("data",(e=>{l=Buffer.concat([l,e])})),s.on("error",(e=>{clearTimeout(u),i("FFmpeg process creation failed: "+e.message)})),s.stderr.on("data",(e=>{e.toString().split("\n").forEach((e=>{this.videoConfig.debug&&e.length>0&&this.log.error(e,this.cameraName+"] [Snapshot")}))})),s.on("close",(()=>{l.length>0?(clearTimeout(u),r(l)):(clearTimeout(u),i("Failed to fetch snapshot.")),setTimeout((()=>{this.snapshotPromise=void 0}),t);const e=(Date.now()-o)/1e3;let n="Fetching snapshot took "+e+" seconds.";e<5||(this.unbridge||(n+=" It is highly recommended you switch to unbridge mode."),e<22?this.log.warn(n,this.cameraName):(n+=" The request has timed out and the snapshot has not been refreshed in HomeKit.",this.log.error(n,this.cameraName)))}))})),this.snapshotPromise}resizeSnapshot(e,t){return new Promise(((r,i)=>{const o="-i pipe: -frames:v 1"+(t?" -filter:v "+t:"")+" -f image2 -",a=(0,n.spawn)(this.videoProcessor,o.split(/\s+/),{env:process.env});let s=Buffer.alloc(0);a.stdout.on("data",(e=>{s=Buffer.concat([s,e])})),a.on("error",(e=>{i("FFmpeg process creation failed: "+e.message)})),a.on("close",(()=>{r(s)})),a.stdin.end(e)}))}async handleSnapshotRequest(e,t){const r=this.determineResolution(e,!0);try{"event"===(1===e.reason?"event":"periodic")&&(this.snapshotPromise=void 0);const i=!!this.snapshotPromise,n=Date.now(),o=await(this.snapshotPromise||this.fetchSnapshot(r.snapFilter));i||this.log.debug("Snapshot took: "+(Date.now()-n)+"ms",this.cameraName,this.videoConfig.debug),t(void 0,o)}catch(e){this.snapshotPromise=void 0,this.log.error(e,this.cameraName),t()}}async prepareStream(e,t){const r="ipv6"===e.addressVersion,i={type:"udp",ip:r?"::":"0.0.0.0",reserveTimeout:15},n=await(0,a.default)(i),s=o.CameraController.generateSynchronisationSource(),c=await(0,a.default)(i),u=o.CameraController.generateSynchronisationSource(),l={address:e.targetAddress,ipv6:r,videoPort:e.video.port,videoReturnPort:n,videoCryptoSuite:e.video.srtpCryptoSuite,videoSRTP:Buffer.concat([e.video.srtp_key,e.video.srtp_salt]),videoSSRC:s,audioPort:e.audio.port,audioReturnPort:c,audioCryptoSuite:e.audio.srtpCryptoSuite,audioSRTP:Buffer.concat([e.audio.srtp_key,e.audio.srtp_salt]),audioSSRC:u},h={video:{port:n,ssrc:s,srtp_key:e.video.srtp_key,srtp_salt:e.video.srtp_salt},audio:{port:c,ssrc:u,srtp_key:e.audio.srtp_key,srtp_salt:e.audio.srtp_salt}};this.pendingSessions.set(e.sessionID,l),t(void 0,h)}startStream(e,t){const r=this.pendingSessions.get(e.sessionID);if(r){const i=this.videoConfig.vcodec||"libx264",n=this.videoConfig.packetSize||1316;let o=this.videoConfig.encoderOptions;o||"libx264"!==i||(o="-preset ultrafast -tune zerolatency");const a=this.determineResolution(e.video,!1);let u=void 0!==this.videoConfig.maxFPS&&(this.videoConfig.forceMax||e.video.fps>this.videoConfig.maxFPS)?this.videoConfig.maxFPS:e.video.fps,l=void 0!==this.videoConfig.maxBitrate&&(this.videoConfig.forceMax||e.video.max_bit_rate>this.videoConfig.maxBitrate)?this.videoConfig.maxBitrate:e.video.max_bit_rate;"copy"===i&&(a.width=0,a.height=0,a.videoFilter=void 0,u=0,l=0),this.log.debug("Video stream requested: "+e.video.width+" x "+e.video.height+", "+e.video.fps+" fps, "+e.video.max_bit_rate+" kbps",this.cameraName,this.videoConfig.debug),this.log.info("Starting video stream: "+(a.width>0?a.width:"native")+" x "+(a.height>0?a.height:"native")+", "+(u>0?u:"native")+" fps, "+(l>0?l:"???")+" kbps"+(this.videoConfig.audio?" ("+e.audio.codec+")":""),this.cameraName);let h=this.videoConfig.source;h+=(this.videoConfig.mapvideo?" -map "+this.videoConfig.mapvideo:" -an -sn -dn")+" -codec:v "+i+" -pix_fmt yuv420p -color_range mpeg"+(u>0?" -r "+u:"")+" -f rawvideo"+(o?" "+o:"")+(a.videoFilter?" -filter:v "+a.videoFilter:"")+(l>0?" -b:v "+l+"k":"")+" -payload_type "+e.video.pt,h+=" -ssrc "+r.videoSSRC+" -f rtp -srtp_out_suite AES_CM_128_HMAC_SHA1_80 -srtp_out_params "+r.videoSRTP.toString("base64")+" srtp://"+r.address+":"+r.videoPort+"?rtcpport="+r.videoPort+"&pkt_size="+n,this.videoConfig.audio&&("OPUS"===e.audio.codec||"AAC-eld"===e.audio.codec?(h+=(this.videoConfig.mapaudio?" -map "+this.videoConfig.mapaudio:" -vn -sn -dn")+("OPUS"===e.audio.codec?" -codec:a libopus -application lowdelay":" -codec:a libfdk_aac -profile:a aac_eld")+" -flags +global_header -f null -ar "+e.audio.sample_rate+"k -b:a "+e.audio.max_bit_rate+"k -bufsize "+4*e.audio.sample_rate+"k -ac "+e.audio.channel+" -payload_type "+e.audio.pt,h+=" -ssrc "+r.audioSSRC+" -f rtp -srtp_out_suite AES_CM_128_HMAC_SHA1_80 -srtp_out_params "+r.audioSRTP.toString("base64")+" srtp://"+r.address+":"+r.audioPort+"?rtcpport="+r.audioPort+"&pkt_size=188"):this.log.error("Unsupported audio codec requested: "+e.audio.codec,this.cameraName)),h+=" -loglevel level"+(this.videoConfig.debug?"+verbose":"")+" -progress pipe:1";const d={};if(d.socket=(0,s.createSocket)(r.ipv6?"udp6":"udp4"),d.socket.on("error",(t=>{this.log.error("Socket error: "+t.message,this.cameraName),this.stopStream(e.sessionID)})),d.socket.on("message",(()=>{d.timeout&&clearTimeout(d.timeout),d.timeout=setTimeout((()=>{this.log.info("Device appears to be inactive. Stopping stream.",this.cameraName),this.controller.forceStopStreamingSession(e.sessionID),this.stopStream(e.sessionID)}),5*e.video.rtcp_interval*1e3)})),d.socket.bind(r.videoReturnPort),d.mainProcess=new c.FfmpegProcess(this.cameraName,e.sessionID,this.videoProcessor,h,this.log,this.videoConfig.debug,this,t),this.videoConfig.returnAudioTarget){const t="-hide_banner -protocol_whitelist pipe,udp,rtp,file,crypto -f sdp -c:a libfdk_aac -i pipe: "+this.videoConfig.returnAudioTarget+" -loglevel level"+(this.videoConfig.debugReturn?"+verbose":""),i=r.ipv6?"IP6":"IP4",n="v=0\r\no=- 0 0 IN "+i+" "+r.address+"\r\ns=Talk\r\nc=IN "+i+" "+r.address+"\r\nt=0 0\r\nm=audio "+r.audioReturnPort+" RTP/AVP 110\r\nb=AS:24\r\na=rtpmap:110 MPEG4-GENERIC/16000/1\r\na=rtcp-mux\r\na=fmtp:110 profile-level-id=1;mode=AAC-hbr;sizelength=13;indexlength=3;indexdeltalength=3; config=F8F0212C00BC00\r\na=crypto:1 AES_CM_128_HMAC_SHA1_80 inline:"+r.audioSRTP.toString("base64")+"\r\n";d.returnProcess=new c.FfmpegProcess(this.cameraName+"] [Two-way",e.sessionID,this.videoProcessor,t,this.log,this.videoConfig.debugReturn,this),d.returnProcess.stdin.end(n)}this.ongoingSessions.set(e.sessionID,d),this.pendingSessions.delete(e.sessionID)}else this.log.error("Error finding session information.",this.cameraName),t(new Error("Error finding session information"))}handleStreamRequest(e,t){switch(e.type){case"start":this.startStream(e,t);break;case"reconfigure":this.log.debug("Received request to reconfigure: "+e.video.width+" x "+e.video.height+", "+e.video.fps+" fps, "+e.video.max_bit_rate+" kbps (Ignored)",this.cameraName,this.videoConfig.debug),t();break;case"stop":this.stopStream(e.sessionID),t()}}stopStream(e){const t=this.ongoingSessions.get(e);if(t){t.timeout&&clearTimeout(t.timeout);try{t.socket?.close()}catch(e){this.log.error("Error occurred closing socket: "+e,this.cameraName)}try{t.mainProcess?.stop()}catch(e){this.log.error("Error occurred terminating main FFmpeg process: "+e,this.cameraName)}try{t.returnProcess?.stop()}catch(e){this.log.error("Error occurred terminating two-way FFmpeg process: "+e,this.cameraName)}}this.ongoingSessions.delete(e),this.log.info("Stopped video stream.",this.cameraName)}}},4679:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;t.Logger=class{formatMessage(e,t){let r="";return t&&(r+="["+t+"] "),r+=e,r}info(e,t){console.info(this.formatMessage(e,t))}warn(e,t){console.warn(this.formatMessage(e,t))}error(e,t){console.error(this.formatMessage(e,t))}debug(e,t,r=!1){console.debug(this.formatMessage(e,t))}}},5920:function(e,t,r){"use strict";var i,n,o,a=this&&this.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)},s=this&&this.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r};Object.defineProperty(t,"__esModule",{value:!0}),t.HomekitManager=void 0,t.createHAPUsername=function(){const e=[];for(let t=0;t<6;t++)e.push((0,u.randomBytes)(1).toString("hex"));return e.join(":")},t.randomPinCode=function(){return`${C()}${C()}${C()}-${C()}${C()}-${C()}${C()}${C()}`};const c=r(3103),u=r(6982),l=r(5592),h=r(6346),d=r(4790);let p="0.0.0",f="0.0.0",g="C100X/C300X";function m(e){const t=e.getService(c.Service.AccessoryInformation);t.setCharacteristic(c.Characteristic.Manufacturer,"c300x-controller"),t.setCharacteristic(c.Characteristic.Model,g),t.setCharacteristic(c.Characteristic.SerialNumber,"v"+p),t.setCharacteristic(c.Characteristic.FirmwareRevision,f)}class v{constructor(e,t){i.add(this),this.name=e,this.eventbus=t;const r=c.uuid.generate("hap-nodejs:accessories:switch:"+e);this.accessory=new c.Accessory(e,r),m(this.accessory),this.switchService=this.accessory.addService(c.Service.Switch,e),this.switchService.getCharacteristic(c.Characteristic.On).on("set",((r,i)=>{r?t.emit("homekit:switch:on:"+e,this):t.emit("homekit:switch:off:"+e,this),i(null)}));const o=(s=1e3,u=1e4,Math.round(Math.random()*(u-s)+s));var s,u;setTimeout((()=>{a(this,i,"m",n).call(this)}),o)}switchedOn(e){return this.eventbus.on("homekit:switch:on:"+this.name,(()=>{e(this)})),this}switchedOff(e){return this.eventbus.on("homekit:switch:off:"+this.name,(()=>{e(this)})),this}updateState(e){return this.eventbus.on("homekit:switch:update:"+this.name,(()=>{e().then((e=>{this.switchService.getCharacteristic(c.Characteristic.On).updateValue(e)})).finally((()=>{setTimeout((()=>{a(this,i,"m",n).call(this)}),6e4)}))})),this}}i=new WeakSet,n=function(){this.eventbus.emit("homekit:switch:update:"+this.name)};class y{constructor(e,t,r){this.id=e,this.eventbus=r,o.set(this,!0);const i=c.uuid.generate("hap-nodejs:accessories:lock:"+t);this.accessory=new c.Accessory(t,i),m(this.accessory),this.lockService=this.accessory.addService(c.Service.LockMechanism,t),this.lockService.getCharacteristic(c.Characteristic.LockTargetState).on("set",((t,i)=>{t===c.Characteristic.LockTargetState.UNSECURED?(s(this,o,!1,"f"),r.emit("homekit:lock:unlock:"+e,this),i(),setTimeout((()=>{s(this,o,!0,"f"),r.emit("homekit:lock:lock:"+e,this)}),3e3)):t===c.Characteristic.LockTargetState.SECURED&&(i(),this.lockService.updateCharacteristic(c.Characteristic.LockCurrentState,c.Characteristic.LockCurrentState.SECURED))})),this.lockService.getCharacteristic(c.Characteristic.LockCurrentState).on("get",(e=>{a(this,o,"f")?e(void 0,c.Characteristic.LockCurrentState.SECURED):e(void 0,c.Characteristic.LockCurrentState.UNSECURED)})),this.lockService.updateCharacteristic(c.Characteristic.LockTargetState,c.Characteristic.LockCurrentState.SECURED)}unlocked(e){return this.eventbus.on("homekit:lock:unlock:"+this.id,(()=>{e(this)})),this}}function C(){return Math.round(1e5*Math.random())%10}o=new WeakMap;t.HomekitManager=class{constructor(e,t,r,i,n,o){this.eventbus=e,c.HAPStorage.setCustomStoragePath(t+"/storage"),i.videoProcessor||(i.$internalVideoProcessor=(0,h.fetchFffmpeg)(t)),g=o,p=n,this.bridge=new c.Bridge(r.displayName,c.uuid.generate("hap-nodejs:bridges:homebridge")),m(this.bridge),console.log("Bridge pairing code: "+r.pinCode),this.bridge.publish({advertiser:i.advertiser||"ciao",username:r.username,pincode:r.pinCode,category:2,addIdentifyingMaterial:!1})}addDoorbell(e){this.doorbell=new c.Accessory(e.displayName,c.uuid.generate("hap-nodejs:accessories:doorbell:"+e.displayName)),m(this.doorbell);const t=new l.StreamingDelegate(e),r=new d.RecordingDelegate(e,this.doorbell),i=this.doorbell.addService(c.Service.MotionSensor),n=new c.DoorbellController(this.getCameraControllerOptions(e,this.doorbell,t,r));t.setController(n),r.setController(n),this.doorbell.configureController(n);const o=this.doorbell.getService(c.Service.Doorbell);return this.eventbus.on("homekit:pressed",(()=>{console.log("HOMEKIT PRESSED EVENT AT: "+Date()),o.getCharacteristic(c.Characteristic.ProgrammableSwitchEvent).updateValue(c.Characteristic.ProgrammableSwitchEvent.SINGLE_PRESS)})),this.eventbus.on("homekit:motion",(e=>{console.log("HOMEKIT MOTION EVENT AT: "+Date()),i.getCharacteristic(c.Characteristic.MotionDetected).updateValue(!0),setTimeout((()=>{console.log("SET FALSE AT: "+Date()),i.getCharacteristic(c.Characteristic.MotionDetected).updateValue(!1)}),e||2e4)})),this.doorbell.publish({advertiser:e.advertiser||"ciao",username:e.username,pincode:e.pinCode,category:18}),console.log("Camera pairing code: "+e.pinCode),{doorbell:this.doorbell,streamingDelegate:t}}addLock(e,t){const r=new y(e,t,this.eventbus);return this.eventbus.on("homekit:locked:"+e,(e=>{!0===e?(r.lockService.updateCharacteristic(c.Characteristic.LockCurrentState,c.Characteristic.LockTargetState.SECURED),r.lockService.updateCharacteristic(c.Characteristic.LockTargetState,c.Characteristic.LockTargetState.SECURED)):!1===e&&(r.lockService.updateCharacteristic(c.Characteristic.LockCurrentState,c.Characteristic.LockTargetState.UNSECURED),r.lockService.updateCharacteristic(c.Characteristic.LockTargetState,c.Characteristic.LockTargetState.UNSECURED))})),this.bridge.addBridgedAccessory(r.accessory),r}addSwitch(e){const t=new v(e,this.eventbus);return this.bridge.addBridgedAccessory(t.accessory),t}updateFirmwareVersion(e){f=e,m(this.bridge),m(this.doorbell),this.bridge.bridgedAccessories.forEach((e=>{m(e)}))}getCameraControllerOptions(e,t,r,i){const n=e.hksv||!0,o=[[320,180,30],[320,240,15],[320,240,30],[480,270,30],[480,360,30],[640,360,30],[640,480,30],[1280,720,30],[1280,960,30],[1920,1080,30],[1600,1200,30]];return{cameraStreamCount:e.maxStreams||2,delegate:r,streamingOptions:{supportedCryptoSuites:[0],video:{resolutions:o,codec:{profiles:[0,1,2],levels:[0,1,2]}},audio:{twoWayAudio:!!e.returnAudioTarget,codecs:[{type:"AAC-eld",samplerate:16}]}},recording:n?{options:{prebufferLength:4e3,mediaContainerConfiguration:[{type:0,fragmentLength:4e3}],video:{type:0,parameters:{profiles:[0,1,2],levels:[0,1,2]},resolutions:o},audio:{codecs:{type:0,samplerate:2,bitrateMode:0,audioChannels:1}}},delegate:i}:void 0,sensors:n?{motion:t.getService(c.Service.MotionSensor),occupancy:void 0}:void 0}}}},8947:(e,t,r)=>{!function(e){"use strict";var t=function(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;t++)r[t]=e[t];return r},i=function(){throw new Error("no PRNG")},n=new Uint8Array(16),o=new Uint8Array(32);o[0]=9;var a=t(),s=t([1]),c=t([56129,1]),u=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),l=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),h=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),d=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),p=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function f(e,t,r,i){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r,e[t+4]=i>>24&255,e[t+5]=i>>16&255,e[t+6]=i>>8&255,e[t+7]=255&i}function g(e,t,r,i,n){var o,a=0;for(o=0;o<n;o++)a|=e[t+o]^r[i+o];return(1&a-1>>>8)-1}function m(e,t,r,i){return g(e,t,r,i,16)}function v(e,t,r,i){return g(e,t,r,i,32)}function y(e,t,r,i){!function(e,t,r,i){for(var n,o=255&i[0]|(255&i[1])<<8|(255&i[2])<<16|(255&i[3])<<24,a=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,s=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,c=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,u=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,l=255&i[4]|(255&i[5])<<8|(255&i[6])<<16|(255&i[7])<<24,h=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,d=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,p=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,f=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,g=255&i[8]|(255&i[9])<<8|(255&i[10])<<16|(255&i[11])<<24,m=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,v=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,y=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,C=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,S=255&i[12]|(255&i[13])<<8|(255&i[14])<<16|(255&i[15])<<24,E=o,_=a,T=s,A=c,I=u,D=l,w=h,b=d,U=p,R=f,O=g,N=m,P=v,B=y,L=C,x=S,M=0;M<20;M+=2)E^=(n=(P^=(n=(U^=(n=(I^=(n=E+P|0)<<7|n>>>25)+E|0)<<9|n>>>23)+I|0)<<13|n>>>19)+U|0)<<18|n>>>14,D^=(n=(_^=(n=(B^=(n=(R^=(n=D+_|0)<<7|n>>>25)+D|0)<<9|n>>>23)+R|0)<<13|n>>>19)+B|0)<<18|n>>>14,O^=(n=(w^=(n=(T^=(n=(L^=(n=O+w|0)<<7|n>>>25)+O|0)<<9|n>>>23)+L|0)<<13|n>>>19)+T|0)<<18|n>>>14,x^=(n=(N^=(n=(b^=(n=(A^=(n=x+N|0)<<7|n>>>25)+x|0)<<9|n>>>23)+A|0)<<13|n>>>19)+b|0)<<18|n>>>14,E^=(n=(A^=(n=(T^=(n=(_^=(n=E+A|0)<<7|n>>>25)+E|0)<<9|n>>>23)+_|0)<<13|n>>>19)+T|0)<<18|n>>>14,D^=(n=(I^=(n=(b^=(n=(w^=(n=D+I|0)<<7|n>>>25)+D|0)<<9|n>>>23)+w|0)<<13|n>>>19)+b|0)<<18|n>>>14,O^=(n=(R^=(n=(U^=(n=(N^=(n=O+R|0)<<7|n>>>25)+O|0)<<9|n>>>23)+N|0)<<13|n>>>19)+U|0)<<18|n>>>14,x^=(n=(L^=(n=(B^=(n=(P^=(n=x+L|0)<<7|n>>>25)+x|0)<<9|n>>>23)+P|0)<<13|n>>>19)+B|0)<<18|n>>>14;E=E+o|0,_=_+a|0,T=T+s|0,A=A+c|0,I=I+u|0,D=D+l|0,w=w+h|0,b=b+d|0,U=U+p|0,R=R+f|0,O=O+g|0,N=N+m|0,P=P+v|0,B=B+y|0,L=L+C|0,x=x+S|0,e[0]=E>>>0&255,e[1]=E>>>8&255,e[2]=E>>>16&255,e[3]=E>>>24&255,e[4]=_>>>0&255,e[5]=_>>>8&255,e[6]=_>>>16&255,e[7]=_>>>24&255,e[8]=T>>>0&255,e[9]=T>>>8&255,e[10]=T>>>16&255,e[11]=T>>>24&255,e[12]=A>>>0&255,e[13]=A>>>8&255,e[14]=A>>>16&255,e[15]=A>>>24&255,e[16]=I>>>0&255,e[17]=I>>>8&255,e[18]=I>>>16&255,e[19]=I>>>24&255,e[20]=D>>>0&255,e[21]=D>>>8&255,e[22]=D>>>16&255,e[23]=D>>>24&255,e[24]=w>>>0&255,e[25]=w>>>8&255,e[26]=w>>>16&255,e[27]=w>>>24&255,e[28]=b>>>0&255,e[29]=b>>>8&255,e[30]=b>>>16&255,e[31]=b>>>24&255,e[32]=U>>>0&255,e[33]=U>>>8&255,e[34]=U>>>16&255,e[35]=U>>>24&255,e[36]=R>>>0&255,e[37]=R>>>8&255,e[38]=R>>>16&255,e[39]=R>>>24&255,e[40]=O>>>0&255,e[41]=O>>>8&255,e[42]=O>>>16&255,e[43]=O>>>24&255,e[44]=N>>>0&255,e[45]=N>>>8&255,e[46]=N>>>16&255,e[47]=N>>>24&255,e[48]=P>>>0&255,e[49]=P>>>8&255,e[50]=P>>>16&255,e[51]=P>>>24&255,e[52]=B>>>0&255,e[53]=B>>>8&255,e[54]=B>>>16&255,e[55]=B>>>24&255,e[56]=L>>>0&255,e[57]=L>>>8&255,e[58]=L>>>16&255,e[59]=L>>>24&255,e[60]=x>>>0&255,e[61]=x>>>8&255,e[62]=x>>>16&255,e[63]=x>>>24&255}(e,t,r,i)}function C(e,t,r,i){!function(e,t,r,i){for(var n,o=255&i[0]|(255&i[1])<<8|(255&i[2])<<16|(255&i[3])<<24,a=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,s=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,c=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,u=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,l=255&i[4]|(255&i[5])<<8|(255&i[6])<<16|(255&i[7])<<24,h=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,d=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,p=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,f=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,g=255&i[8]|(255&i[9])<<8|(255&i[10])<<16|(255&i[11])<<24,m=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,v=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,y=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,C=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,S=255&i[12]|(255&i[13])<<8|(255&i[14])<<16|(255&i[15])<<24,E=0;E<20;E+=2)o^=(n=(v^=(n=(p^=(n=(u^=(n=o+v|0)<<7|n>>>25)+o|0)<<9|n>>>23)+u|0)<<13|n>>>19)+p|0)<<18|n>>>14,l^=(n=(a^=(n=(y^=(n=(f^=(n=l+a|0)<<7|n>>>25)+l|0)<<9|n>>>23)+f|0)<<13|n>>>19)+y|0)<<18|n>>>14,g^=(n=(h^=(n=(s^=(n=(C^=(n=g+h|0)<<7|n>>>25)+g|0)<<9|n>>>23)+C|0)<<13|n>>>19)+s|0)<<18|n>>>14,S^=(n=(m^=(n=(d^=(n=(c^=(n=S+m|0)<<7|n>>>25)+S|0)<<9|n>>>23)+c|0)<<13|n>>>19)+d|0)<<18|n>>>14,o^=(n=(c^=(n=(s^=(n=(a^=(n=o+c|0)<<7|n>>>25)+o|0)<<9|n>>>23)+a|0)<<13|n>>>19)+s|0)<<18|n>>>14,l^=(n=(u^=(n=(d^=(n=(h^=(n=l+u|0)<<7|n>>>25)+l|0)<<9|n>>>23)+h|0)<<13|n>>>19)+d|0)<<18|n>>>14,g^=(n=(f^=(n=(p^=(n=(m^=(n=g+f|0)<<7|n>>>25)+g|0)<<9|n>>>23)+m|0)<<13|n>>>19)+p|0)<<18|n>>>14,S^=(n=(C^=(n=(y^=(n=(v^=(n=S+C|0)<<7|n>>>25)+S|0)<<9|n>>>23)+v|0)<<13|n>>>19)+y|0)<<18|n>>>14;e[0]=o>>>0&255,e[1]=o>>>8&255,e[2]=o>>>16&255,e[3]=o>>>24&255,e[4]=l>>>0&255,e[5]=l>>>8&255,e[6]=l>>>16&255,e[7]=l>>>24&255,e[8]=g>>>0&255,e[9]=g>>>8&255,e[10]=g>>>16&255,e[11]=g>>>24&255,e[12]=S>>>0&255,e[13]=S>>>8&255,e[14]=S>>>16&255,e[15]=S>>>24&255,e[16]=h>>>0&255,e[17]=h>>>8&255,e[18]=h>>>16&255,e[19]=h>>>24&255,e[20]=d>>>0&255,e[21]=d>>>8&255,e[22]=d>>>16&255,e[23]=d>>>24&255,e[24]=p>>>0&255,e[25]=p>>>8&255,e[26]=p>>>16&255,e[27]=p>>>24&255,e[28]=f>>>0&255,e[29]=f>>>8&255,e[30]=f>>>16&255,e[31]=f>>>24&255}(e,t,r,i)}var S=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function E(e,t,r,i,n,o,a){var s,c,u=new Uint8Array(16),l=new Uint8Array(64);for(c=0;c<16;c++)u[c]=0;for(c=0;c<8;c++)u[c]=o[c];for(;n>=64;){for(y(l,u,a,S),c=0;c<64;c++)e[t+c]=r[i+c]^l[c];for(s=1,c=8;c<16;c++)s=s+(255&u[c])|0,u[c]=255&s,s>>>=8;n-=64,t+=64,i+=64}if(n>0)for(y(l,u,a,S),c=0;c<n;c++)e[t+c]=r[i+c]^l[c];return 0}function _(e,t,r,i,n){var o,a,s=new Uint8Array(16),c=new Uint8Array(64);for(a=0;a<16;a++)s[a]=0;for(a=0;a<8;a++)s[a]=i[a];for(;r>=64;){for(y(c,s,n,S),a=0;a<64;a++)e[t+a]=c[a];for(o=1,a=8;a<16;a++)o=o+(255&s[a])|0,s[a]=255&o,o>>>=8;r-=64,t+=64}if(r>0)for(y(c,s,n,S),a=0;a<r;a++)e[t+a]=c[a];return 0}function T(e,t,r,i,n){var o=new Uint8Array(32);C(o,i,n,S);for(var a=new Uint8Array(8),s=0;s<8;s++)a[s]=i[s+16];return _(e,t,r,a,o)}function A(e,t,r,i,n,o,a){var s=new Uint8Array(32);C(s,o,a,S);for(var c=new Uint8Array(8),u=0;u<8;u++)c[u]=o[u+16];return E(e,t,r,i,n,c,s)}var I=function(e){var t,r,i,n,o,a,s,c;this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0,t=255&e[0]|(255&e[1])<<8,this.r[0]=8191&t,r=255&e[2]|(255&e[3])<<8,this.r[1]=8191&(t>>>13|r<<3),i=255&e[4]|(255&e[5])<<8,this.r[2]=7939&(r>>>10|i<<6),n=255&e[6]|(255&e[7])<<8,this.r[3]=8191&(i>>>7|n<<9),o=255&e[8]|(255&e[9])<<8,this.r[4]=255&(n>>>4|o<<12),this.r[5]=o>>>1&8190,a=255&e[10]|(255&e[11])<<8,this.r[6]=8191&(o>>>14|a<<2),s=255&e[12]|(255&e[13])<<8,this.r[7]=8065&(a>>>11|s<<5),c=255&e[14]|(255&e[15])<<8,this.r[8]=8191&(s>>>8|c<<8),this.r[9]=c>>>5&127,this.pad[0]=255&e[16]|(255&e[17])<<8,this.pad[1]=255&e[18]|(255&e[19])<<8,this.pad[2]=255&e[20]|(255&e[21])<<8,this.pad[3]=255&e[22]|(255&e[23])<<8,this.pad[4]=255&e[24]|(255&e[25])<<8,this.pad[5]=255&e[26]|(255&e[27])<<8,this.pad[6]=255&e[28]|(255&e[29])<<8,this.pad[7]=255&e[30]|(255&e[31])<<8};function D(e,t,r,i,n,o){var a=new I(o);return a.update(r,i,n),a.finish(e,t),0}function w(e,t,r,i,n,o){var a=new Uint8Array(16);return D(a,0,r,i,n,o),m(e,t,a,0)}function b(e,t,r,i,n){var o;if(r<32)return-1;for(A(e,0,t,0,r,i,n),D(e,16,e,32,r-32,e),o=0;o<16;o++)e[o]=0;return 0}function U(e,t,r,i,n){var o,a=new Uint8Array(32);if(r<32)return-1;if(T(a,0,32,i,n),0!==w(t,16,t,32,r-32,a))return-1;for(A(e,0,t,0,r,i,n),o=0;o<32;o++)e[o]=0;return 0}function R(e,t){var r;for(r=0;r<16;r++)e[r]=0|t[r]}function O(e){var t,r,i=1;for(t=0;t<16;t++)r=e[t]+i+65535,i=Math.floor(r/65536),e[t]=r-65536*i;e[0]+=i-1+37*(i-1)}function N(e,t,r){for(var i,n=~(r-1),o=0;o<16;o++)i=n&(e[o]^t[o]),e[o]^=i,t[o]^=i}function P(e,r){var i,n,o,a=t(),s=t();for(i=0;i<16;i++)s[i]=r[i];for(O(s),O(s),O(s),n=0;n<2;n++){for(a[0]=s[0]-65517,i=1;i<15;i++)a[i]=s[i]-65535-(a[i-1]>>16&1),a[i-1]&=65535;a[15]=s[15]-32767-(a[14]>>16&1),o=a[15]>>16&1,a[14]&=65535,N(s,a,1-o)}for(i=0;i<16;i++)e[2*i]=255&s[i],e[2*i+1]=s[i]>>8}function B(e,t){var r=new Uint8Array(32),i=new Uint8Array(32);return P(r,e),P(i,t),v(r,0,i,0)}function L(e){var t=new Uint8Array(32);return P(t,e),1&t[0]}function x(e,t){var r;for(r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function M(e,t,r){for(var i=0;i<16;i++)e[i]=t[i]+r[i]}function F(e,t,r){for(var i=0;i<16;i++)e[i]=t[i]-r[i]}function k(e,t,r){var i,n,o=0,a=0,s=0,c=0,u=0,l=0,h=0,d=0,p=0,f=0,g=0,m=0,v=0,y=0,C=0,S=0,E=0,_=0,T=0,A=0,I=0,D=0,w=0,b=0,U=0,R=0,O=0,N=0,P=0,B=0,L=0,x=r[0],M=r[1],F=r[2],k=r[3],V=r[4],H=r[5],j=r[6],G=r[7],W=r[8],Y=r[9],q=r[10],K=r[11],$=r[12],z=r[13],Q=r[14],X=r[15];o+=(i=t[0])*x,a+=i*M,s+=i*F,c+=i*k,u+=i*V,l+=i*H,h+=i*j,d+=i*G,p+=i*W,f+=i*Y,g+=i*q,m+=i*K,v+=i*$,y+=i*z,C+=i*Q,S+=i*X,a+=(i=t[1])*x,s+=i*M,c+=i*F,u+=i*k,l+=i*V,h+=i*H,d+=i*j,p+=i*G,f+=i*W,g+=i*Y,m+=i*q,v+=i*K,y+=i*$,C+=i*z,S+=i*Q,E+=i*X,s+=(i=t[2])*x,c+=i*M,u+=i*F,l+=i*k,h+=i*V,d+=i*H,p+=i*j,f+=i*G,g+=i*W,m+=i*Y,v+=i*q,y+=i*K,C+=i*$,S+=i*z,E+=i*Q,_+=i*X,c+=(i=t[3])*x,u+=i*M,l+=i*F,h+=i*k,d+=i*V,p+=i*H,f+=i*j,g+=i*G,m+=i*W,v+=i*Y,y+=i*q,C+=i*K,S+=i*$,E+=i*z,_+=i*Q,T+=i*X,u+=(i=t[4])*x,l+=i*M,h+=i*F,d+=i*k,p+=i*V,f+=i*H,g+=i*j,m+=i*G,v+=i*W,y+=i*Y,C+=i*q,S+=i*K,E+=i*$,_+=i*z,T+=i*Q,A+=i*X,l+=(i=t[5])*x,h+=i*M,d+=i*F,p+=i*k,f+=i*V,g+=i*H,m+=i*j,v+=i*G,y+=i*W,C+=i*Y,S+=i*q,E+=i*K,_+=i*$,T+=i*z,A+=i*Q,I+=i*X,h+=(i=t[6])*x,d+=i*M,p+=i*F,f+=i*k,g+=i*V,m+=i*H,v+=i*j,y+=i*G,C+=i*W,S+=i*Y,E+=i*q,_+=i*K,T+=i*$,A+=i*z,I+=i*Q,D+=i*X,d+=(i=t[7])*x,p+=i*M,f+=i*F,g+=i*k,m+=i*V,v+=i*H,y+=i*j,C+=i*G,S+=i*W,E+=i*Y,_+=i*q,T+=i*K,A+=i*$,I+=i*z,D+=i*Q,w+=i*X,p+=(i=t[8])*x,f+=i*M,g+=i*F,m+=i*k,v+=i*V,y+=i*H,C+=i*j,S+=i*G,E+=i*W,_+=i*Y,T+=i*q,A+=i*K,I+=i*$,D+=i*z,w+=i*Q,b+=i*X,f+=(i=t[9])*x,g+=i*M,m+=i*F,v+=i*k,y+=i*V,C+=i*H,S+=i*j,E+=i*G,_+=i*W,T+=i*Y,A+=i*q,I+=i*K,D+=i*$,w+=i*z,b+=i*Q,U+=i*X,g+=(i=t[10])*x,m+=i*M,v+=i*F,y+=i*k,C+=i*V,S+=i*H,E+=i*j,_+=i*G,T+=i*W,A+=i*Y,I+=i*q,D+=i*K,w+=i*$,b+=i*z,U+=i*Q,R+=i*X,m+=(i=t[11])*x,v+=i*M,y+=i*F,C+=i*k,S+=i*V,E+=i*H,_+=i*j,T+=i*G,A+=i*W,I+=i*Y,D+=i*q,w+=i*K,b+=i*$,U+=i*z,R+=i*Q,O+=i*X,v+=(i=t[12])*x,y+=i*M,C+=i*F,S+=i*k,E+=i*V,_+=i*H,T+=i*j,A+=i*G,I+=i*W,D+=i*Y,w+=i*q,b+=i*K,U+=i*$,R+=i*z,O+=i*Q,N+=i*X,y+=(i=t[13])*x,C+=i*M,S+=i*F,E+=i*k,_+=i*V,T+=i*H,A+=i*j,I+=i*G,D+=i*W,w+=i*Y,b+=i*q,U+=i*K,R+=i*$,O+=i*z,N+=i*Q,P+=i*X,C+=(i=t[14])*x,S+=i*M,E+=i*F,_+=i*k,T+=i*V,A+=i*H,I+=i*j,D+=i*G,w+=i*W,b+=i*Y,U+=i*q,R+=i*K,O+=i*$,N+=i*z,P+=i*Q,B+=i*X,S+=(i=t[15])*x,a+=38*(_+=i*F),s+=38*(T+=i*k),c+=38*(A+=i*V),u+=38*(I+=i*H),l+=38*(D+=i*j),h+=38*(w+=i*G),d+=38*(b+=i*W),p+=38*(U+=i*Y),f+=38*(R+=i*q),g+=38*(O+=i*K),m+=38*(N+=i*$),v+=38*(P+=i*z),y+=38*(B+=i*Q),C+=38*(L+=i*X),o=(i=(o+=38*(E+=i*M))+(n=1)+65535)-65536*(n=Math.floor(i/65536)),a=(i=a+n+65535)-65536*(n=Math.floor(i/65536)),s=(i=s+n+65535)-65536*(n=Math.floor(i/65536)),c=(i=c+n+65535)-65536*(n=Math.floor(i/65536)),u=(i=u+n+65535)-65536*(n=Math.floor(i/65536)),l=(i=l+n+65535)-65536*(n=Math.floor(i/65536)),h=(i=h+n+65535)-65536*(n=Math.floor(i/65536)),d=(i=d+n+65535)-65536*(n=Math.floor(i/65536)),p=(i=p+n+65535)-65536*(n=Math.floor(i/65536)),f=(i=f+n+65535)-65536*(n=Math.floor(i/65536)),g=(i=g+n+65535)-65536*(n=Math.floor(i/65536)),m=(i=m+n+65535)-65536*(n=Math.floor(i/65536)),v=(i=v+n+65535)-65536*(n=Math.floor(i/65536)),y=(i=y+n+65535)-65536*(n=Math.floor(i/65536)),C=(i=C+n+65535)-65536*(n=Math.floor(i/65536)),S=(i=S+n+65535)-65536*(n=Math.floor(i/65536)),o=(i=(o+=n-1+37*(n-1))+(n=1)+65535)-65536*(n=Math.floor(i/65536)),a=(i=a+n+65535)-65536*(n=Math.floor(i/65536)),s=(i=s+n+65535)-65536*(n=Math.floor(i/65536)),c=(i=c+n+65535)-65536*(n=Math.floor(i/65536)),u=(i=u+n+65535)-65536*(n=Math.floor(i/65536)),l=(i=l+n+65535)-65536*(n=Math.floor(i/65536)),h=(i=h+n+65535)-65536*(n=Math.floor(i/65536)),d=(i=d+n+65535)-65536*(n=Math.floor(i/65536)),p=(i=p+n+65535)-65536*(n=Math.floor(i/65536)),f=(i=f+n+65535)-65536*(n=Math.floor(i/65536)),g=(i=g+n+65535)-65536*(n=Math.floor(i/65536)),m=(i=m+n+65535)-65536*(n=Math.floor(i/65536)),v=(i=v+n+65535)-65536*(n=Math.floor(i/65536)),y=(i=y+n+65535)-65536*(n=Math.floor(i/65536)),C=(i=C+n+65535)-65536*(n=Math.floor(i/65536)),S=(i=S+n+65535)-65536*(n=Math.floor(i/65536)),o+=n-1+37*(n-1),e[0]=o,e[1]=a,e[2]=s,e[3]=c,e[4]=u,e[5]=l,e[6]=h,e[7]=d,e[8]=p,e[9]=f,e[10]=g,e[11]=m,e[12]=v,e[13]=y,e[14]=C,e[15]=S}function V(e,t){k(e,t,t)}function H(e,r){var i,n=t();for(i=0;i<16;i++)n[i]=r[i];for(i=253;i>=0;i--)V(n,n),2!==i&&4!==i&&k(n,n,r);for(i=0;i<16;i++)e[i]=n[i]}function j(e,r){var i,n=t();for(i=0;i<16;i++)n[i]=r[i];for(i=250;i>=0;i--)V(n,n),1!==i&&k(n,n,r);for(i=0;i<16;i++)e[i]=n[i]}function G(e,r,i){var n,o,a=new Uint8Array(32),s=new Float64Array(80),u=t(),l=t(),h=t(),d=t(),p=t(),f=t();for(o=0;o<31;o++)a[o]=r[o];for(a[31]=127&r[31]|64,a[0]&=248,x(s,i),o=0;o<16;o++)l[o]=s[o],d[o]=u[o]=h[o]=0;for(u[0]=d[0]=1,o=254;o>=0;--o)N(u,l,n=a[o>>>3]>>>(7&o)&1),N(h,d,n),M(p,u,h),F(u,u,h),M(h,l,d),F(l,l,d),V(d,p),V(f,u),k(u,h,u),k(h,l,p),M(p,u,h),F(u,u,h),V(l,u),F(h,d,f),k(u,h,c),M(u,u,d),k(h,h,u),k(u,d,f),k(d,l,s),V(l,p),N(u,l,n),N(h,d,n);for(o=0;o<16;o++)s[o+16]=u[o],s[o+32]=h[o],s[o+48]=l[o],s[o+64]=d[o];var g=s.subarray(32),m=s.subarray(16);return H(g,g),k(m,m,g),P(e,m),0}function W(e,t){return G(e,t,o)}function Y(e,t){return i(t,32),W(e,t)}function q(e,t,r){var i=new Uint8Array(32);return G(i,r,t),C(e,n,i,S)}I.prototype.blocks=function(e,t,r){for(var i,n,o,a,s,c,u,l,h,d,p,f,g,m,v,y,C,S,E,_=this.fin?0:2048,T=this.h[0],A=this.h[1],I=this.h[2],D=this.h[3],w=this.h[4],b=this.h[5],U=this.h[6],R=this.h[7],O=this.h[8],N=this.h[9],P=this.r[0],B=this.r[1],L=this.r[2],x=this.r[3],M=this.r[4],F=this.r[5],k=this.r[6],V=this.r[7],H=this.r[8],j=this.r[9];r>=16;)d=h=0,d+=(T+=8191&(i=255&e[t+0]|(255&e[t+1])<<8))*P,d+=(A+=8191&(i>>>13|(n=255&e[t+2]|(255&e[t+3])<<8)<<3))*(5*j),d+=(I+=8191&(n>>>10|(o=255&e[t+4]|(255&e[t+5])<<8)<<6))*(5*H),d+=(D+=8191&(o>>>7|(a=255&e[t+6]|(255&e[t+7])<<8)<<9))*(5*V),h=(d+=(w+=8191&(a>>>4|(s=255&e[t+8]|(255&e[t+9])<<8)<<12))*(5*k))>>>13,d&=8191,d+=(b+=s>>>1&8191)*(5*F),d+=(U+=8191&(s>>>14|(c=255&e[t+10]|(255&e[t+11])<<8)<<2))*(5*M),d+=(R+=8191&(c>>>11|(u=255&e[t+12]|(255&e[t+13])<<8)<<5))*(5*x),d+=(O+=8191&(u>>>8|(l=255&e[t+14]|(255&e[t+15])<<8)<<8))*(5*L),p=h+=(d+=(N+=l>>>5|_)*(5*B))>>>13,p+=T*B,p+=A*P,p+=I*(5*j),p+=D*(5*H),h=(p+=w*(5*V))>>>13,p&=8191,p+=b*(5*k),p+=U*(5*F),p+=R*(5*M),p+=O*(5*x),h+=(p+=N*(5*L))>>>13,p&=8191,f=h,f+=T*L,f+=A*B,f+=I*P,f+=D*(5*j),h=(f+=w*(5*H))>>>13,f&=8191,f+=b*(5*V),f+=U*(5*k),f+=R*(5*F),f+=O*(5*M),g=h+=(f+=N*(5*x))>>>13,g+=T*x,g+=A*L,g+=I*B,g+=D*P,h=(g+=w*(5*j))>>>13,g&=8191,g+=b*(5*H),g+=U*(5*V),g+=R*(5*k),g+=O*(5*F),m=h+=(g+=N*(5*M))>>>13,m+=T*M,m+=A*x,m+=I*L,m+=D*B,h=(m+=w*P)>>>13,m&=8191,m+=b*(5*j),m+=U*(5*H),m+=R*(5*V),m+=O*(5*k),v=h+=(m+=N*(5*F))>>>13,v+=T*F,v+=A*M,v+=I*x,v+=D*L,h=(v+=w*B)>>>13,v&=8191,v+=b*P,v+=U*(5*j),v+=R*(5*H),v+=O*(5*V),y=h+=(v+=N*(5*k))>>>13,y+=T*k,y+=A*F,y+=I*M,y+=D*x,h=(y+=w*L)>>>13,y&=8191,y+=b*B,y+=U*P,y+=R*(5*j),y+=O*(5*H),C=h+=(y+=N*(5*V))>>>13,C+=T*V,C+=A*k,C+=I*F,C+=D*M,h=(C+=w*x)>>>13,C&=8191,C+=b*L,C+=U*B,C+=R*P,C+=O*(5*j),S=h+=(C+=N*(5*H))>>>13,S+=T*H,S+=A*V,S+=I*k,S+=D*F,h=(S+=w*M)>>>13,S&=8191,S+=b*x,S+=U*L,S+=R*B,S+=O*P,E=h+=(S+=N*(5*j))>>>13,E+=T*j,E+=A*H,E+=I*V,E+=D*k,h=(E+=w*F)>>>13,E&=8191,E+=b*M,E+=U*x,E+=R*L,E+=O*B,T=d=8191&(h=(h=((h+=(E+=N*P)>>>13)<<2)+h|0)+(d&=8191)|0),A=p+=h>>>=13,I=f&=8191,D=g&=8191,w=m&=8191,b=v&=8191,U=y&=8191,R=C&=8191,O=S&=8191,N=E&=8191,t+=16,r-=16;this.h[0]=T,this.h[1]=A,this.h[2]=I,this.h[3]=D,this.h[4]=w,this.h[5]=b,this.h[6]=U,this.h[7]=R,this.h[8]=O,this.h[9]=N},I.prototype.finish=function(e,t){var r,i,n,o,a=new Uint16Array(10);if(this.leftover){for(o=this.leftover,this.buffer[o++]=1;o<16;o++)this.buffer[o]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(r=this.h[1]>>>13,this.h[1]&=8191,o=2;o<10;o++)this.h[o]+=r,r=this.h[o]>>>13,this.h[o]&=8191;for(this.h[0]+=5*r,r=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=r,r=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=r,a[0]=this.h[0]+5,r=a[0]>>>13,a[0]&=8191,o=1;o<10;o++)a[o]=this.h[o]+r,r=a[o]>>>13,a[o]&=8191;for(a[9]-=8192,i=(1^r)-1,o=0;o<10;o++)a[o]&=i;for(i=~i,o=0;o<10;o++)this.h[o]=this.h[o]&i|a[o];for(this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5),n=this.h[0]+this.pad[0],this.h[0]=65535&n,o=1;o<8;o++)n=(this.h[o]+this.pad[o]|0)+(n>>>16)|0,this.h[o]=65535&n;e[t+0]=this.h[0]>>>0&255,e[t+1]=this.h[0]>>>8&255,e[t+2]=this.h[1]>>>0&255,e[t+3]=this.h[1]>>>8&255,e[t+4]=this.h[2]>>>0&255,e[t+5]=this.h[2]>>>8&255,e[t+6]=this.h[3]>>>0&255,e[t+7]=this.h[3]>>>8&255,e[t+8]=this.h[4]>>>0&255,e[t+9]=this.h[4]>>>8&255,e[t+10]=this.h[5]>>>0&255,e[t+11]=this.h[5]>>>8&255,e[t+12]=this.h[6]>>>0&255,e[t+13]=this.h[6]>>>8&255,e[t+14]=this.h[7]>>>0&255,e[t+15]=this.h[7]>>>8&255},I.prototype.update=function(e,t,r){var i,n;if(this.leftover){for((n=16-this.leftover)>r&&(n=r),i=0;i<n;i++)this.buffer[this.leftover+i]=e[t+i];if(r-=n,t+=n,this.leftover+=n,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(r>=16&&(n=r-r%16,this.blocks(e,t,n),t+=n,r-=n),r){for(i=0;i<r;i++)this.buffer[this.leftover+i]=e[t+i];this.leftover+=r}};var K=b,$=U;var z=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Q(e,t,r,i){for(var n,o,a,s,c,u,l,h,d,p,f,g,m,v,y,C,S,E,_,T,A,I,D,w,b,U,R=new Int32Array(16),O=new Int32Array(16),N=e[0],P=e[1],B=e[2],L=e[3],x=e[4],M=e[5],F=e[6],k=e[7],V=t[0],H=t[1],j=t[2],G=t[3],W=t[4],Y=t[5],q=t[6],K=t[7],$=0;i>=128;){for(_=0;_<16;_++)T=8*_+$,R[_]=r[T+0]<<24|r[T+1]<<16|r[T+2]<<8|r[T+3],O[_]=r[T+4]<<24|r[T+5]<<16|r[T+6]<<8|r[T+7];for(_=0;_<80;_++)if(n=N,o=P,a=B,s=L,c=x,u=M,l=F,k,d=V,p=H,f=j,g=G,m=W,v=Y,y=q,K,D=65535&(I=K),w=I>>>16,b=65535&(A=k),U=A>>>16,D+=65535&(I=(W>>>14|x<<18)^(W>>>18|x<<14)^(x>>>9|W<<23)),w+=I>>>16,b+=65535&(A=(x>>>14|W<<18)^(x>>>18|W<<14)^(W>>>9|x<<23)),U+=A>>>16,D+=65535&(I=W&Y^~W&q),w+=I>>>16,b+=65535&(A=x&M^~x&F),U+=A>>>16,A=z[2*_],D+=65535&(I=z[2*_+1]),w+=I>>>16,b+=65535&A,U+=A>>>16,A=R[_%16],w+=(I=O[_%16])>>>16,b+=65535&A,U+=A>>>16,b+=(w+=(D+=65535&I)>>>16)>>>16,D=65535&(I=E=65535&D|w<<16),w=I>>>16,b=65535&(A=S=65535&b|(U+=b>>>16)<<16),U=A>>>16,D+=65535&(I=(V>>>28|N<<4)^(N>>>2|V<<30)^(N>>>7|V<<25)),w+=I>>>16,b+=65535&(A=(N>>>28|V<<4)^(V>>>2|N<<30)^(V>>>7|N<<25)),U+=A>>>16,w+=(I=V&H^V&j^H&j)>>>16,b+=65535&(A=N&P^N&B^P&B),U+=A>>>16,h=65535&(b+=(w+=(D+=65535&I)>>>16)>>>16)|(U+=b>>>16)<<16,C=65535&D|w<<16,D=65535&(I=g),w=I>>>16,b=65535&(A=s),U=A>>>16,w+=(I=E)>>>16,b+=65535&(A=S),U+=A>>>16,P=n,B=o,L=a,x=s=65535&(b+=(w+=(D+=65535&I)>>>16)>>>16)|(U+=b>>>16)<<16,M=c,F=u,k=l,N=h,H=d,j=p,G=f,W=g=65535&D|w<<16,Y=m,q=v,K=y,V=C,_%16==15)for(T=0;T<16;T++)A=R[T],D=65535&(I=O[T]),w=I>>>16,b=65535&A,U=A>>>16,A=R[(T+9)%16],D+=65535&(I=O[(T+9)%16]),w+=I>>>16,b+=65535&A,U+=A>>>16,S=R[(T+1)%16],D+=65535&(I=((E=O[(T+1)%16])>>>1|S<<31)^(E>>>8|S<<24)^(E>>>7|S<<25)),w+=I>>>16,b+=65535&(A=(S>>>1|E<<31)^(S>>>8|E<<24)^S>>>7),U+=A>>>16,S=R[(T+14)%16],w+=(I=((E=O[(T+14)%16])>>>19|S<<13)^(S>>>29|E<<3)^(E>>>6|S<<26))>>>16,b+=65535&(A=(S>>>19|E<<13)^(E>>>29|S<<3)^S>>>6),U+=A>>>16,U+=(b+=(w+=(D+=65535&I)>>>16)>>>16)>>>16,R[T]=65535&b|U<<16,O[T]=65535&D|w<<16;D=65535&(I=V),w=I>>>16,b=65535&(A=N),U=A>>>16,A=e[0],w+=(I=t[0])>>>16,b+=65535&A,U+=A>>>16,U+=(b+=(w+=(D+=65535&I)>>>16)>>>16)>>>16,e[0]=N=65535&b|U<<16,t[0]=V=65535&D|w<<16,D=65535&(I=H),w=I>>>16,b=65535&(A=P),U=A>>>16,A=e[1],w+=(I=t[1])>>>16,b+=65535&A,U+=A>>>16,U+=(b+=(w+=(D+=65535&I)>>>16)>>>16)>>>16,e[1]=P=65535&b|U<<16,t[1]=H=65535&D|w<<16,D=65535&(I=j),w=I>>>16,b=65535&(A=B),U=A>>>16,A=e[2],w+=(I=t[2])>>>16,b+=65535&A,U+=A>>>16,U+=(b+=(w+=(D+=65535&I)>>>16)>>>16)>>>16,e[2]=B=65535&b|U<<16,t[2]=j=65535&D|w<<16,D=65535&(I=G),w=I>>>16,b=65535&(A=L),U=A>>>16,A=e[3],w+=(I=t[3])>>>16,b+=65535&A,U+=A>>>16,U+=(b+=(w+=(D+=65535&I)>>>16)>>>16)>>>16,e[3]=L=65535&b|U<<16,t[3]=G=65535&D|w<<16,D=65535&(I=W),w=I>>>16,b=65535&(A=x),U=A>>>16,A=e[4],w+=(I=t[4])>>>16,b+=65535&A,U+=A>>>16,U+=(b+=(w+=(D+=65535&I)>>>16)>>>16)>>>16,e[4]=x=65535&b|U<<16,t[4]=W=65535&D|w<<16,D=65535&(I=Y),w=I>>>16,b=65535&(A=M),U=A>>>16,A=e[5],w+=(I=t[5])>>>16,b+=65535&A,U+=A>>>16,U+=(b+=(w+=(D+=65535&I)>>>16)>>>16)>>>16,e[5]=M=65535&b|U<<16,t[5]=Y=65535&D|w<<16,D=65535&(I=q),w=I>>>16,b=65535&(A=F),U=A>>>16,A=e[6],w+=(I=t[6])>>>16,b+=65535&A,U+=A>>>16,U+=(b+=(w+=(D+=65535&I)>>>16)>>>16)>>>16,e[6]=F=65535&b|U<<16,t[6]=q=65535&D|w<<16,D=65535&(I=K),w=I>>>16,b=65535&(A=k),U=A>>>16,A=e[7],w+=(I=t[7])>>>16,b+=65535&A,U+=A>>>16,U+=(b+=(w+=(D+=65535&I)>>>16)>>>16)>>>16,e[7]=k=65535&b|U<<16,t[7]=K=65535&D|w<<16,$+=128,i-=128}return i}function X(e,t,r){var i,n=new Int32Array(8),o=new Int32Array(8),a=new Uint8Array(256),s=r;for(n[0]=1779033703,n[1]=3144134277,n[2]=1013904242,n[3]=2773480762,n[4]=1359893119,n[5]=2600822924,n[6]=528734635,n[7]=1541459225,o[0]=4089235720,o[1]=2227873595,o[2]=4271175723,o[3]=1595750129,o[4]=2917565137,o[5]=725511199,o[6]=4215389547,o[7]=327033209,Q(n,o,t,r),r%=128,i=0;i<r;i++)a[i]=t[s-r+i];for(a[r]=128,a[(r=256-128*(r<112?1:0))-9]=0,f(a,r-8,s/536870912|0,s<<3),Q(n,o,a,r),i=0;i<8;i++)f(e,8*i,n[i],o[i]);return 0}function J(e,r){var i=t(),n=t(),o=t(),a=t(),s=t(),c=t(),u=t(),h=t(),d=t();F(i,e[1],e[0]),F(d,r[1],r[0]),k(i,i,d),M(n,e[0],e[1]),M(d,r[0],r[1]),k(n,n,d),k(o,e[3],r[3]),k(o,o,l),k(a,e[2],r[2]),M(a,a,a),F(s,n,i),F(c,a,o),M(u,a,o),M(h,n,i),k(e[0],s,c),k(e[1],h,u),k(e[2],u,c),k(e[3],s,h)}function Z(e,t,r){var i;for(i=0;i<4;i++)N(e[i],t[i],r)}function ee(e,r){var i=t(),n=t(),o=t();H(o,r[2]),k(i,r[0],o),k(n,r[1],o),P(e,n),e[31]^=L(i)<<7}function te(e,t,r){var i,n;for(R(e[0],a),R(e[1],s),R(e[2],s),R(e[3],a),n=255;n>=0;--n)Z(e,t,i=r[n/8|0]>>(7&n)&1),J(t,e),J(e,e),Z(e,t,i)}function re(e,r){var i=[t(),t(),t(),t()];R(i[0],h),R(i[1],d),R(i[2],s),k(i[3],h,d),te(e,i,r)}function ie(e,r,n){var o,a=new Uint8Array(64),s=[t(),t(),t(),t()];for(n||i(r,32),X(a,r,32),a[0]&=248,a[31]&=127,a[31]|=64,re(s,a),ee(e,s),o=0;o<32;o++)r[o+32]=e[o];return 0}var ne=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function oe(e,t){var r,i,n,o;for(i=63;i>=32;--i){for(r=0,n=i-32,o=i-12;n<o;++n)t[n]+=r-16*t[i]*ne[n-(i-32)],r=Math.floor((t[n]+128)/256),t[n]-=256*r;t[n]+=r,t[i]=0}for(r=0,n=0;n<32;n++)t[n]+=r-(t[31]>>4)*ne[n],r=t[n]>>8,t[n]&=255;for(n=0;n<32;n++)t[n]-=r*ne[n];for(i=0;i<32;i++)t[i+1]+=t[i]>>8,e[i]=255&t[i]}function ae(e){var t,r=new Float64Array(64);for(t=0;t<64;t++)r[t]=e[t];for(t=0;t<64;t++)e[t]=0;oe(e,r)}function se(e,r,i,n){var o,a,s=new Uint8Array(64),c=new Uint8Array(64),u=new Uint8Array(64),l=new Float64Array(64),h=[t(),t(),t(),t()];X(s,n,32),s[0]&=248,s[31]&=127,s[31]|=64;var d=i+64;for(o=0;o<i;o++)e[64+o]=r[o];for(o=0;o<32;o++)e[32+o]=s[32+o];for(X(u,e.subarray(32),i+32),ae(u),re(h,u),ee(e,h),o=32;o<64;o++)e[o]=n[o];for(X(c,e,i+64),ae(c),o=0;o<64;o++)l[o]=0;for(o=0;o<32;o++)l[o]=u[o];for(o=0;o<32;o++)for(a=0;a<32;a++)l[o+a]+=c[o]*s[a];return oe(e.subarray(32),l),d}function ce(e,r,i,n){var o,c=new Uint8Array(32),l=new Uint8Array(64),h=[t(),t(),t(),t()],d=[t(),t(),t(),t()];if(i<64)return-1;if(function(e,r){var i=t(),n=t(),o=t(),c=t(),l=t(),h=t(),d=t();return R(e[2],s),x(e[1],r),V(o,e[1]),k(c,o,u),F(o,o,e[2]),M(c,e[2],c),V(l,c),V(h,l),k(d,h,l),k(i,d,o),k(i,i,c),j(i,i),k(i,i,o),k(i,i,c),k(i,i,c),k(e[0],i,c),V(n,e[0]),k(n,n,c),B(n,o)&&k(e[0],e[0],p),V(n,e[0]),k(n,n,c),B(n,o)?-1:(L(e[0])===r[31]>>7&&F(e[0],a,e[0]),k(e[3],e[0],e[1]),0)}(d,n))return-1;for(o=0;o<i;o++)e[o]=r[o];for(o=0;o<32;o++)e[o+32]=n[o];if(X(l,e,i),ae(l),te(h,d,l),re(d,r.subarray(32)),J(h,d),ee(c,h),i-=64,v(r,0,c,0)){for(o=0;o<i;o++)e[o]=0;return-1}for(o=0;o<i;o++)e[o]=r[o+64];return i}var ue=16,le=64,he=32,de=64;function pe(e,t){if(32!==e.length)throw new Error("bad key size");if(24!==t.length)throw new Error("bad nonce size")}function fe(){for(var e=0;e<arguments.length;e++)if(!(arguments[e]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function ge(e){for(var t=0;t<e.length;t++)e[t]=0}e.lowlevel={crypto_core_hsalsa20:C,crypto_stream_xor:A,crypto_stream:T,crypto_stream_salsa20_xor:E,crypto_stream_salsa20:_,crypto_onetimeauth:D,crypto_onetimeauth_verify:w,crypto_verify_16:m,crypto_verify_32:v,crypto_secretbox:b,crypto_secretbox_open:U,crypto_scalarmult:G,crypto_scalarmult_base:W,crypto_box_beforenm:q,crypto_box_afternm:K,crypto_box:function(e,t,r,i,n,o){var a=new Uint8Array(32);return q(a,n,o),K(e,t,r,i,a)},crypto_box_open:function(e,t,r,i,n,o){var a=new Uint8Array(32);return q(a,n,o),$(e,t,r,i,a)},crypto_box_keypair:Y,crypto_hash:X,crypto_sign:se,crypto_sign_keypair:ie,crypto_sign_open:ce,crypto_secretbox_KEYBYTES:32,crypto_secretbox_NONCEBYTES:24,crypto_secretbox_ZEROBYTES:32,crypto_secretbox_BOXZEROBYTES:ue,crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32,crypto_box_PUBLICKEYBYTES:32,crypto_box_SECRETKEYBYTES:32,crypto_box_BEFORENMBYTES:32,crypto_box_NONCEBYTES:24,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_sign_BYTES:le,crypto_sign_PUBLICKEYBYTES:he,crypto_sign_SECRETKEYBYTES:de,crypto_sign_SEEDBYTES:32,crypto_hash_BYTES:64,gf:t,D:u,L:ne,pack25519:P,unpack25519:x,M:k,A:M,S:V,Z:F,pow2523:j,add:J,set25519:R,modL:oe,scalarmult:te,scalarbase:re},e.randomBytes=function(e){var t=new Uint8Array(e);return i(t,e),t},e.secretbox=function(e,t,r){fe(e,t,r),pe(r,t);for(var i=new Uint8Array(32+e.length),n=new Uint8Array(i.length),o=0;o<e.length;o++)i[o+32]=e[o];return b(n,i,i.length,t,r),n.subarray(ue)},e.secretbox.open=function(e,t,r){fe(e,t,r),pe(r,t);for(var i=new Uint8Array(ue+e.length),n=new Uint8Array(i.length),o=0;o<e.length;o++)i[o+ue]=e[o];return i.length<32||0!==U(n,i,i.length,t,r)?null:n.subarray(32)},e.secretbox.keyLength=32,e.secretbox.nonceLength=24,e.secretbox.overheadLength=ue,e.scalarMult=function(e,t){if(fe(e,t),32!==e.length)throw new Error("bad n size");if(32!==t.length)throw new Error("bad p size");var r=new Uint8Array(32);return G(r,e,t),r},e.scalarMult.base=function(e){if(fe(e),32!==e.length)throw new Error("bad n size");var t=new Uint8Array(32);return W(t,e),t},e.scalarMult.scalarLength=32,e.scalarMult.groupElementLength=32,e.box=function(t,r,i,n){var o=e.box.before(i,n);return e.secretbox(t,r,o)},e.box.before=function(e,t){fe(e,t),function(e,t){if(32!==e.length)throw new Error("bad public key size");if(32!==t.length)throw new Error("bad secret key size")}(e,t);var r=new Uint8Array(32);return q(r,e,t),r},e.box.after=e.secretbox,e.box.open=function(t,r,i,n){var o=e.box.before(i,n);return e.secretbox.open(t,r,o)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(32);return Y(e,t),{publicKey:e,secretKey:t}},e.box.keyPair.fromSecretKey=function(e){if(fe(e),32!==e.length)throw new Error("bad secret key size");var t=new Uint8Array(32);return W(t,e),{publicKey:t,secretKey:new Uint8Array(e)}},e.box.publicKeyLength=32,e.box.secretKeyLength=32,e.box.sharedKeyLength=32,e.box.nonceLength=24,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(e,t){if(fe(e,t),t.length!==de)throw new Error("bad secret key size");var r=new Uint8Array(le+e.length);return se(r,e,e.length,t),r},e.sign.open=function(e,t){if(fe(e,t),t.length!==he)throw new Error("bad public key size");var r=new Uint8Array(e.length),i=ce(r,e,e.length,t);if(i<0)return null;for(var n=new Uint8Array(i),o=0;o<n.length;o++)n[o]=r[o];return n},e.sign.detached=function(t,r){for(var i=e.sign(t,r),n=new Uint8Array(le),o=0;o<n.length;o++)n[o]=i[o];return n},e.sign.detached.verify=function(e,t,r){if(fe(e,t,r),t.length!==le)throw new Error("bad signature size");if(r.length!==he)throw new Error("bad public key size");var i,n=new Uint8Array(le+e.length),o=new Uint8Array(le+e.length);for(i=0;i<le;i++)n[i]=t[i];for(i=0;i<e.length;i++)n[i+le]=e[i];return ce(o,n,n.length,r)>=0},e.sign.keyPair=function(){var e=new Uint8Array(he),t=new Uint8Array(de);return ie(e,t),{publicKey:e,secretKey:t}},e.sign.keyPair.fromSecretKey=function(e){if(fe(e),e.length!==de)throw new Error("bad secret key size");for(var t=new Uint8Array(he),r=0;r<t.length;r++)t[r]=e[32+r];return{publicKey:t,secretKey:new Uint8Array(e)}},e.sign.keyPair.fromSeed=function(e){if(fe(e),32!==e.length)throw new Error("bad seed size");for(var t=new Uint8Array(he),r=new Uint8Array(de),i=0;i<32;i++)r[i]=e[i];return ie(t,r,!0),{publicKey:t,secretKey:r}},e.sign.publicKeyLength=he,e.sign.secretKeyLength=de,e.sign.seedLength=32,e.sign.signatureLength=le,e.hash=function(e){fe(e);var t=new Uint8Array(64);return X(t,e,e.length),t},e.hash.hashLength=64,e.verify=function(e,t){return fe(e,t),0!==e.length&&0!==t.length&&(e.length===t.length&&0===g(e,0,t,0,e.length))},e.setPRNG=function(e){i=e},function(){var t="undefined"!=typeof self?self.crypto||self.msCrypto:null;if(t&&t.getRandomValues){e.setPRNG((function(e,r){var i,n=new Uint8Array(r);for(i=0;i<r;i+=65536)t.getRandomValues(n.subarray(i,i+Math.min(r-i,65536)));for(i=0;i<r;i++)e[i]=n[i];ge(n)}))}else(t=r(6982))&&t.randomBytes&&e.setPRNG((function(e,r){var i,n=t.randomBytes(r);for(i=0;i<r;i++)e[i]=n[i];ge(n)}))}()}(e.exports?e.exports:self.nacl=self.nacl||{})},1539:(e,t,r)=>{"use strict";var i=r(4761),n=r(1703),o=r(5128),a=r(3612),s=r(9803);e.exports=function(e){return null==e||"object"!=typeof e&&"function"!=typeof e?null:i(e)?"String":n(e)?"Number":o(e)?"Boolean":a(e)?"Symbol":s(e)?"BigInt":void 0}},593:(e,t,r)=>{"use strict";var i=r(3802),n=r(256),o=r(7842),a=r(2648);e.exports=function(e){if(e&&"object"==typeof e){if(i(e))return"Map";if(n(e))return"Set";if(o(e))return"WeakMap";if(a(e))return"WeakSet"}return!1}},5767:(e,t,r)=>{"use strict";var i=r(2682),n=r(9209),o=r(487),a=r(8075),s=r(5795),c=a("Object.prototype.toString"),u=r(9092)(),l="undefined"==typeof globalThis?global:globalThis,h=n(),d=a("String.prototype.slice"),p=Object.getPrototypeOf,f=a("Array.prototype.indexOf",!0)||function(e,t){for(var r=0;r<e.length;r+=1)if(e[r]===t)return r;return-1},g={__proto__:null};i(h,u&&s&&p?function(e){var t=new l[e];if(Symbol.toStringTag in t){var r=p(t),i=s(r,Symbol.toStringTag);if(!i){var n=p(r);i=s(n,Symbol.toStringTag)}g["$"+e]=o(i.get)}}:function(e){var t=new l[e],r=t.slice||t.set;r&&(g["$"+e]=o(r))});e.exports=function(e){if(!e||"object"!=typeof e)return!1;if(!u){var t=d(c(e),8,-1);return f(h,t)>-1?t:"Object"===t&&function(e){var t=!1;return i(g,(function(r,i){if(!t)try{r(e),t=d(i,1)}catch(e){}})),t}(e)}return s?function(e){var t=!1;return i(g,(function(r,i){if(!t)try{"$"+r(e)===i&&(t=d(i,1))}catch(e){}})),t}(e):null}},3177:function(e,t){(function(){"use strict";t.stripBOM=function(e){return"\ufeff"===e[0]?e.substring(1):e}}).call(this)},6712:function(e,t,r){(function(){"use strict";var e,i,n,o,a,s={}.hasOwnProperty;e=r(2046),i=r(6465).defaults,o=function(e){return"string"==typeof e&&(e.indexOf("&")>=0||e.indexOf(">")>=0||e.indexOf("<")>=0)},a=function(e){return"<![CDATA["+n(e)+"]]>"},n=function(e){return e.replace("]]>","]]]]><![CDATA[>")},t.Builder=function(){function t(e){var t,r,n;for(t in this.options={},r=i[.2])s.call(r,t)&&(n=r[t],this.options[t]=n);for(t in e)s.call(e,t)&&(n=e[t],this.options[t]=n)}return t.prototype.buildObject=function(t){var r,n,c,u,l,h;return r=this.options.attrkey,n=this.options.charkey,1===Object.keys(t).length&&this.options.rootName===i[.2].rootName?t=t[l=Object.keys(t)[0]]:l=this.options.rootName,h=this,c=function(e,t){var i,u,l,d,p,f;if("object"!=typeof t)h.options.cdata&&o(t)?e.raw(a(t)):e.txt(t);else if(Array.isArray(t)){for(d in t)if(s.call(t,d))for(p in u=t[d])l=u[p],e=c(e.ele(p),l).up()}else for(p in t)if(s.call(t,p))if(u=t[p],p===r){if("object"==typeof u)for(i in u)f=u[i],e=e.att(i,f)}else if(p===n)e=h.options.cdata&&o(u)?e.raw(a(u)):e.txt(u);else if(Array.isArray(u))for(d in u)s.call(u,d)&&(e="string"==typeof(l=u[d])?h.options.cdata&&o(l)?e.ele(p).raw(a(l)).up():e.ele(p,l).up():c(e.ele(p),l).up());else"object"==typeof u?e=c(e.ele(p),u).up():"string"==typeof u&&h.options.cdata&&o(u)?e=e.ele(p).raw(a(u)).up():(null==u&&(u=""),e=e.ele(p,u.toString()).up());return e},u=e.create(l,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),c(u,t).end(this.options.renderOpts)},t}()}).call(this)},6465:function(e,t){(function(){t.defaults={.1:{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},.2:{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:"\n"},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}}}).call(this)},1912:function(e,t,r){(function(){"use strict";var e,i,n,o,a,s,c,u,l,h=function(e,t){return function(){return e.apply(t,arguments)}},d={}.hasOwnProperty;u=r(4043),o=r(4434),e=r(3177),c=r(2114),l=r(3557).setImmediate,i=r(6465).defaults,a=function(e){return"object"==typeof e&&null!=e&&0===Object.keys(e).length},s=function(e,t,r){var i,n;for(i=0,n=e.length;i<n;i++)t=(0,e[i])(t,r);return t},n=function(e,t,r){var i;return(i=Object.create(null)).value=r,i.writable=!0,i.enumerable=!0,i.configurable=!0,Object.defineProperty(e,t,i)},t.Parser=function(r){function o(e){var r,n,o;if(this.parseStringPromise=h(this.parseStringPromise,this),this.parseString=h(this.parseString,this),this.reset=h(this.reset,this),this.assignOrPush=h(this.assignOrPush,this),this.processAsync=h(this.processAsync,this),!(this instanceof t.Parser))return new t.Parser(e);for(r in this.options={},n=i[.2])d.call(n,r)&&(o=n[r],this.options[r]=o);for(r in e)d.call(e,r)&&(o=e[r],this.options[r]=o);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(c.normalize)),this.reset()}return function(e,t){for(var r in t)d.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(o,r),o.prototype.processAsync=function(){var e,t;try{return this.remaining.length<=this.options.chunkSize?(e=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(e),this.saxParser.close()):(e=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(e),l(this.processAsync))}catch(e){if(t=e,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(t)}},o.prototype.assignOrPush=function(e,t,r){return t in e?(e[t]instanceof Array||n(e,t,[e[t]]),e[t].push(r)):this.options.explicitArray?n(e,t,[r]):n(e,t,r)},o.prototype.reset=function(){var e,t,r,i,o;return this.removeAllListeners(),this.saxParser=u.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=(o=this,function(e){if(o.saxParser.resume(),!o.saxParser.errThrown)return o.saxParser.errThrown=!0,o.emit("error",e)}),this.saxParser.onend=function(e){return function(){if(!e.saxParser.ended)return e.saxParser.ended=!0,e.emit("end",e.resultObject)}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,i=[],e=this.options.attrkey,t=this.options.charkey,this.saxParser.onopentag=function(r){return function(o){var a,c,u,l,h;if((u={})[t]="",!r.options.ignoreAttrs)for(a in h=o.attributes)d.call(h,a)&&(e in u||r.options.mergeAttrs||(u[e]={}),c=r.options.attrValueProcessors?s(r.options.attrValueProcessors,o.attributes[a],a):o.attributes[a],l=r.options.attrNameProcessors?s(r.options.attrNameProcessors,a):a,r.options.mergeAttrs?r.assignOrPush(u,l,c):n(u[e],l,c));return u["#name"]=r.options.tagNameProcessors?s(r.options.tagNameProcessors,o.name):o.name,r.options.xmlns&&(u[r.options.xmlnskey]={uri:o.uri,local:o.local}),i.push(u)}}(this),this.saxParser.onclosetag=function(e){return function(){var r,o,c,u,l,h,p,f,g,m;if(h=i.pop(),l=h["#name"],e.options.explicitChildren&&e.options.preserveChildrenOrder||delete h["#name"],!0===h.cdata&&(r=h.cdata,delete h.cdata),g=i[i.length-1],h[t].match(/^\s*$/)&&!r?(o=h[t],delete h[t]):(e.options.trim&&(h[t]=h[t].trim()),e.options.normalize&&(h[t]=h[t].replace(/\s{2,}/g," ").trim()),h[t]=e.options.valueProcessors?s(e.options.valueProcessors,h[t],l):h[t],1===Object.keys(h).length&&t in h&&!e.EXPLICIT_CHARKEY&&(h=h[t])),a(h)&&(h="function"==typeof e.options.emptyTag?e.options.emptyTag():""!==e.options.emptyTag?e.options.emptyTag:o),null!=e.options.validator&&(m="/"+function(){var e,t,r;for(r=[],e=0,t=i.length;e<t;e++)u=i[e],r.push(u["#name"]);return r}().concat(l).join("/"),function(){var t;try{return h=e.options.validator(m,g&&g[l],h)}catch(r){return t=r,e.emit("error",t)}}()),e.options.explicitChildren&&!e.options.mergeAttrs&&"object"==typeof h)if(e.options.preserveChildrenOrder){if(g){for(c in g[e.options.childkey]=g[e.options.childkey]||[],p={},h)d.call(h,c)&&n(p,c,h[c]);g[e.options.childkey].push(p),delete h["#name"],1===Object.keys(h).length&&t in h&&!e.EXPLICIT_CHARKEY&&(h=h[t])}}else u={},e.options.attrkey in h&&(u[e.options.attrkey]=h[e.options.attrkey],delete h[e.options.attrkey]),!e.options.charsAsChildren&&e.options.charkey in h&&(u[e.options.charkey]=h[e.options.charkey],delete h[e.options.charkey]),Object.getOwnPropertyNames(h).length>0&&(u[e.options.childkey]=h),h=u;return i.length>0?e.assignOrPush(g,l,h):(e.options.explicitRoot&&(f=h,n(h={},l,f)),e.resultObject=h,e.saxParser.ended=!0,e.emit("end",e.resultObject))}}(this),r=function(e){return function(r){var n,o;if(o=i[i.length-1])return o[t]+=r,e.options.explicitChildren&&e.options.preserveChildrenOrder&&e.options.charsAsChildren&&(e.options.includeWhiteChars||""!==r.replace(/\\n/g,"").trim())&&(o[e.options.childkey]=o[e.options.childkey]||[],(n={"#name":"__text__"})[t]=r,e.options.normalize&&(n[t]=n[t].replace(/\s{2,}/g," ").trim()),o[e.options.childkey].push(n)),o}}(this),this.saxParser.ontext=r,this.saxParser.oncdata=function(e){var t;if(t=r(e))return t.cdata=!0}},o.prototype.parseString=function(t,r){var i;null!=r&&"function"==typeof r&&(this.on("end",(function(e){return this.reset(),r(null,e)})),this.on("error",(function(e){return this.reset(),r(e)})));try{return""===(t=t.toString()).trim()?(this.emit("end",null),!0):(t=e.stripBOM(t),this.options.async?(this.remaining=t,l(this.processAsync),this.saxParser):this.saxParser.write(t).close())}catch(e){if(i=e,!this.saxParser.errThrown&&!this.saxParser.ended)return this.emit("error",i),this.saxParser.errThrown=!0;if(this.saxParser.ended)throw i}},o.prototype.parseStringPromise=function(e){return new Promise((t=this,function(r,i){return t.parseString(e,(function(e,t){return e?i(e):r(t)}))}));var t},o}(o),t.parseString=function(e,r,i){var n,o;return null!=i?("function"==typeof i&&(n=i),"object"==typeof r&&(o=r)):("function"==typeof r&&(n=r),o={}),new t.Parser(o).parseString(e,n)},t.parseStringPromise=function(e,r){var i;return"object"==typeof r&&(i=r),new t.Parser(i).parseStringPromise(e)}}).call(this)},2114:function(e,t){(function(){"use strict";var e;e=new RegExp(/(?!xmlns)^.*:/),t.normalize=function(e){return e.toLowerCase()},t.firstCharLowerCase=function(e){return e.charAt(0).toLowerCase()+e.slice(1)},t.stripPrefix=function(t){return t.replace(e,"")},t.parseNumbers=function(e){return isNaN(e)||(e=e%1==0?parseInt(e,10):parseFloat(e)),e},t.parseBooleans=function(e){return/^(?:true|false)$/i.test(e)&&(e="true"===e.toLowerCase()),e}}).call(this)},8805:function(e,t,r){(function(){"use strict";var e,i,n,o,a={}.hasOwnProperty;i=r(6465),e=r(6712),n=r(1912),o=r(2114),t.defaults=i.defaults,t.processors=o,t.ValidationError=function(e){function t(e){this.message=e}return function(e,t){for(var r in t)a.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,Error),t}(),t.Builder=e.Builder,t.Parser=n.Parser,t.parseString=n.parseString,t.parseStringPromise=n.parseStringPromise}).call(this)},4923:function(e){(function(){e.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(this)},1737:function(e){(function(){e.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(this)},9241:function(e){(function(){var t,r,i,n,o,a,s,c=[].slice,u={}.hasOwnProperty;t=function(){var e,t,r,i,n,a;if(a=arguments[0],n=2<=arguments.length?c.call(arguments,1):[],o(Object.assign))Object.assign.apply(null,arguments);else for(e=0,r=n.length;e<r;e++)if(null!=(i=n[e]))for(t in i)u.call(i,t)&&(a[t]=i[t]);return a},o=function(e){return!!e&&"[object Function]"===Object.prototype.toString.call(e)},a=function(e){var t;return!!e&&("function"==(t=typeof e)||"object"===t)},i=function(e){return o(Array.isArray)?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)},n=function(e){var t;if(i(e))return!e.length;for(t in e)if(u.call(e,t))return!1;return!0},s=function(e){var t,r;return a(e)&&(r=Object.getPrototypeOf(e))&&(t=r.constructor)&&"function"==typeof t&&t instanceof t&&Function.prototype.toString.call(t)===Function.prototype.toString.call(Object)},r=function(e){return o(e.valueOf)?e.valueOf():e},e.exports.assign=t,e.exports.isFunction=o,e.exports.isObject=a,e.exports.isArray=i,e.exports.isEmpty=n,e.exports.isPlainObject=s,e.exports.getValue=r}).call(this)},8753:function(e){(function(){e.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(this)},4238:function(e,t,r){(function(){var t;t=r(1737),r(468),e.exports=function(){function e(e,r,i){if(this.parent=e,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),null==r)throw new Error("Missing attribute name. "+this.debugInfo(r));this.name=this.stringify.name(r),this.value=this.stringify.attValue(i),this.type=t.Attribute,this.isId=!1,this.schemaTypeInfo=null}return Object.defineProperty(e.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(e.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(e.prototype,"textContent",{get:function(){return this.value},set:function(e){return this.value=e||""}}),Object.defineProperty(e.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(e.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(e.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(e.prototype,"specified",{get:function(){return!0}}),e.prototype.clone=function(){return Object.create(this)},e.prototype.toString=function(e){return this.options.writer.attribute(this,this.options.writer.filterOptions(e))},e.prototype.debugInfo=function(e){return null==(e=e||this.name)?"parent: <"+this.parent.name+">":"attribute: {"+e+"}, parent: <"+this.parent.name+">"},e.prototype.isEqualNode=function(e){return e.namespaceURI===this.namespaceURI&&(e.prefix===this.prefix&&(e.localName===this.localName&&e.value===this.value))},e}()}).call(this)},2691:function(e,t,r){(function(){var t,i,n={}.hasOwnProperty;t=r(1737),i=r(7457),e.exports=function(e){function r(e,i){if(r.__super__.constructor.call(this,e),null==i)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=t.CData,this.value=this.stringify.cdata(i)}return function(e,t){for(var r in t)n.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(e){return this.options.writer.cdata(this,this.options.writer.filterOptions(e))},r}(i)}).call(this)},7457:function(e,t,r){(function(){var t,i={}.hasOwnProperty;t=r(468),e.exports=function(e){function t(e){t.__super__.constructor.call(this,e),this.value=""}return function(e,t){for(var r in t)i.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this.value},set:function(e){return this.value=e||""}}),Object.defineProperty(t.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(t.prototype,"textContent",{get:function(){return this.value},set:function(e){return this.value=e||""}}),t.prototype.clone=function(){return Object.create(this)},t.prototype.substringData=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.appendData=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.insertData=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.deleteData=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.replaceData=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.isEqualNode=function(e){return!!t.__super__.isEqualNode.apply(this,arguments).isEqualNode(e)&&e.data===this.data},t}(t)}).call(this)},2679:function(e,t,r){(function(){var t,i,n={}.hasOwnProperty;t=r(1737),i=r(7457),e.exports=function(e){function r(e,i){if(r.__super__.constructor.call(this,e),null==i)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=t.Comment,this.value=this.stringify.comment(i)}return function(e,t){for(var r in t)n.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(e){return this.options.writer.comment(this,this.options.writer.filterOptions(e))},r}(i)}).call(this)},3074:function(e,t,r){(function(){var t,i;t=r(5660),i=r(2527),e.exports=function(){function e(){this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new t,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=Object.create(this.defaultParams)}return Object.defineProperty(e.prototype,"parameterNames",{get:function(){return new i(Object.keys(this.defaultParams))}}),e.prototype.getParameter=function(e){return this.params.hasOwnProperty(e)?this.params[e]:null},e.prototype.canSetParameter=function(e,t){return!0},e.prototype.setParameter=function(e,t){return null!=t?this.params[e]=t:delete this.params[e]},e}()}).call(this)},5660:function(e){(function(){e.exports=function(){function e(){}return e.prototype.handleError=function(e){throw new Error(e)},e}()}).call(this)},7260:function(e){(function(){e.exports=function(){function e(){}return e.prototype.hasFeature=function(e,t){return!0},e.prototype.createDocumentType=function(e,t,r){throw new Error("This DOM method is not implemented.")},e.prototype.createDocument=function(e,t,r){throw new Error("This DOM method is not implemented.")},e.prototype.createHTMLDocument=function(e){throw new Error("This DOM method is not implemented.")},e.prototype.getFeature=function(e,t){throw new Error("This DOM method is not implemented.")},e}()}).call(this)},2527:function(e){(function(){e.exports=function(){function e(e){this.arr=e||[]}return Object.defineProperty(e.prototype,"length",{get:function(){return this.arr.length}}),e.prototype.item=function(e){return this.arr[e]||null},e.prototype.contains=function(e){return-1!==this.arr.indexOf(e)},e}()}).call(this)},4111:function(e,t,r){(function(){var t,i,n={}.hasOwnProperty;i=r(468),t=r(1737),e.exports=function(e){function r(e,i,n,o,a,s){if(r.__super__.constructor.call(this,e),null==i)throw new Error("Missing DTD element name. "+this.debugInfo());if(null==n)throw new Error("Missing DTD attribute name. "+this.debugInfo(i));if(!o)throw new Error("Missing DTD attribute type. "+this.debugInfo(i));if(!a)throw new Error("Missing DTD attribute default. "+this.debugInfo(i));if(0!==a.indexOf("#")&&(a="#"+a),!a.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(i));if(s&&!a.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(i));this.elementName=this.stringify.name(i),this.type=t.AttributeDeclaration,this.attributeName=this.stringify.name(n),this.attributeType=this.stringify.dtdAttType(o),s&&(this.defaultValue=this.stringify.dtdAttDefault(s)),this.defaultValueType=a}return function(e,t){for(var r in t)n.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),r.prototype.toString=function(e){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(e))},r}(i)}).call(this)},7696:function(e,t,r){(function(){var t,i,n={}.hasOwnProperty;i=r(468),t=r(1737),e.exports=function(e){function r(e,i,n){if(r.__super__.constructor.call(this,e),null==i)throw new Error("Missing DTD element name. "+this.debugInfo());n||(n="(#PCDATA)"),Array.isArray(n)&&(n="("+n.join(",")+")"),this.name=this.stringify.name(i),this.type=t.ElementDeclaration,this.value=this.stringify.dtdElementValue(n)}return function(e,t){for(var r in t)n.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),r.prototype.toString=function(e){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(e))},r}(i)}).call(this)},5529:function(e,t,r){(function(){var t,i,n,o={}.hasOwnProperty;n=r(9241).isObject,i=r(468),t=r(1737),e.exports=function(e){function r(e,i,o,a){if(r.__super__.constructor.call(this,e),null==o)throw new Error("Missing DTD entity name. "+this.debugInfo(o));if(null==a)throw new Error("Missing DTD entity value. "+this.debugInfo(o));if(this.pe=!!i,this.name=this.stringify.name(o),this.type=t.EntityDeclaration,n(a)){if(!a.pubID&&!a.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(o));if(a.pubID&&!a.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(o));if(this.internal=!1,null!=a.pubID&&(this.pubID=this.stringify.dtdPubID(a.pubID)),null!=a.sysID&&(this.sysID=this.stringify.dtdSysID(a.sysID)),null!=a.nData&&(this.nData=this.stringify.dtdNData(a.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(o))}else this.value=this.stringify.dtdEntityValue(a),this.internal=!0}return function(e,t){for(var r in t)o.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),Object.defineProperty(r.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(r.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(r.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(r.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(r.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(r.prototype,"xmlVersion",{get:function(){return null}}),r.prototype.toString=function(e){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(e))},r}(i)}).call(this)},8012:function(e,t,r){(function(){var t,i,n={}.hasOwnProperty;i=r(468),t=r(1737),e.exports=function(e){function r(e,i,n){if(r.__super__.constructor.call(this,e),null==i)throw new Error("Missing DTD notation name. "+this.debugInfo(i));if(!n.pubID&&!n.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(i));this.name=this.stringify.name(i),this.type=t.NotationDeclaration,null!=n.pubID&&(this.pubID=this.stringify.dtdPubID(n.pubID)),null!=n.sysID&&(this.sysID=this.stringify.dtdSysID(n.sysID))}return function(e,t){for(var r in t)n.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),Object.defineProperty(r.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(r.prototype,"systemId",{get:function(){return this.sysID}}),r.prototype.toString=function(e){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(e))},r}(i)}).call(this)},4130:function(e,t,r){(function(){var t,i,n,o={}.hasOwnProperty;n=r(9241).isObject,i=r(468),t=r(1737),e.exports=function(e){function r(e,i,o,a){var s;r.__super__.constructor.call(this,e),n(i)&&(i=(s=i).version,o=s.encoding,a=s.standalone),i||(i="1.0"),this.type=t.Declaration,this.version=this.stringify.xmlVersion(i),null!=o&&(this.encoding=this.stringify.xmlEncoding(o)),null!=a&&(this.standalone=this.stringify.xmlStandalone(a))}return function(e,t){for(var r in t)o.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),r.prototype.toString=function(e){return this.options.writer.declaration(this,this.options.writer.filterOptions(e))},r}(i)}).call(this)},6376:function(e,t,r){(function(){var t,i,n,o,a,s,c,u,l={}.hasOwnProperty;u=r(9241).isObject,c=r(468),t=r(1737),i=r(4111),o=r(5529),n=r(7696),a=r(8012),s=r(4797),e.exports=function(e){function r(e,i,n){var o,a,s,c,l,h;if(r.__super__.constructor.call(this,e),this.type=t.DocType,e.children)for(a=0,s=(c=e.children).length;a<s;a++)if((o=c[a]).type===t.Element){this.name=o.name;break}this.documentObject=e,u(i)&&(i=(l=i).pubID,n=l.sysID),null==n&&(n=(h=[i,n])[0],i=h[1]),null!=i&&(this.pubID=this.stringify.dtdPubID(i)),null!=n&&(this.sysID=this.stringify.dtdSysID(n))}return function(e,t){for(var r in t)l.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),Object.defineProperty(r.prototype,"entities",{get:function(){var e,r,i,n,o;for(n={},r=0,i=(o=this.children).length;r<i;r++)(e=o[r]).type!==t.EntityDeclaration||e.pe||(n[e.name]=e);return new s(n)}}),Object.defineProperty(r.prototype,"notations",{get:function(){var e,r,i,n,o;for(n={},r=0,i=(o=this.children).length;r<i;r++)(e=o[r]).type===t.NotationDeclaration&&(n[e.name]=e);return new s(n)}}),Object.defineProperty(r.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(r.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(r.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),r.prototype.element=function(e,t){var r;return r=new n(this,e,t),this.children.push(r),this},r.prototype.attList=function(e,t,r,n,o){var a;return a=new i(this,e,t,r,n,o),this.children.push(a),this},r.prototype.entity=function(e,t){var r;return r=new o(this,!1,e,t),this.children.push(r),this},r.prototype.pEntity=function(e,t){var r;return r=new o(this,!0,e,t),this.children.push(r),this},r.prototype.notation=function(e,t){var r;return r=new a(this,e,t),this.children.push(r),this},r.prototype.toString=function(e){return this.options.writer.docType(this,this.options.writer.filterOptions(e))},r.prototype.ele=function(e,t){return this.element(e,t)},r.prototype.att=function(e,t,r,i,n){return this.attList(e,t,r,i,n)},r.prototype.ent=function(e,t){return this.entity(e,t)},r.prototype.pent=function(e,t){return this.pEntity(e,t)},r.prototype.not=function(e,t){return this.notation(e,t)},r.prototype.up=function(){return this.root()||this.documentObject},r.prototype.isEqualNode=function(e){return!!r.__super__.isEqualNode.apply(this,arguments).isEqualNode(e)&&(e.name===this.name&&(e.publicId===this.publicId&&e.systemId===this.systemId))},r}(c)}).call(this)},1933:function(e,t,r){(function(){var t,i,n,o,a,s,c,u={}.hasOwnProperty;c=r(9241).isPlainObject,n=r(7260),i=r(3074),o=r(468),t=r(1737),s=r(3976),a=r(382),e.exports=function(e){function r(e){r.__super__.constructor.call(this,null),this.name="#document",this.type=t.Document,this.documentURI=null,this.domConfig=new i,e||(e={}),e.writer||(e.writer=new a),this.options=e,this.stringify=new s(e)}return function(e,t){for(var r in t)u.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),Object.defineProperty(r.prototype,"implementation",{value:new n}),Object.defineProperty(r.prototype,"doctype",{get:function(){var e,r,i,n;for(r=0,i=(n=this.children).length;r<i;r++)if((e=n[r]).type===t.DocType)return e;return null}}),Object.defineProperty(r.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(r.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(r.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(r.prototype,"xmlEncoding",{get:function(){return 0!==this.children.length&&this.children[0].type===t.Declaration?this.children[0].encoding:null}}),Object.defineProperty(r.prototype,"xmlStandalone",{get:function(){return 0!==this.children.length&&this.children[0].type===t.Declaration&&"yes"===this.children[0].standalone}}),Object.defineProperty(r.prototype,"xmlVersion",{get:function(){return 0!==this.children.length&&this.children[0].type===t.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(r.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(r.prototype,"origin",{get:function(){return null}}),Object.defineProperty(r.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(r.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(r.prototype,"contentType",{get:function(){return null}}),r.prototype.end=function(e){var t;return t={},e?c(e)&&(t=e,e=this.options.writer):e=this.options.writer,e.document(this,e.filterOptions(t))},r.prototype.toString=function(e){return this.options.writer.document(this,this.options.writer.filterOptions(e))},r.prototype.createElement=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createDocumentFragment=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createTextNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createComment=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createCDATASection=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createProcessingInstruction=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createAttribute=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createEntityReference=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.importNode=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createElementNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createAttributeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagNameNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementById=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.adoptNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.normalizeDocument=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.renameNode=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByClassName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createEvent=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createRange=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createNodeIterator=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createTreeWalker=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r}(o)}).call(this)},400:function(e,t,r){(function(){var t,i,n,o,a,s,c,u,l,h,d,p,f,g,m,v,y,C,S,E,_,T,A,I={}.hasOwnProperty;A=r(9241),_=A.isObject,E=A.isFunction,T=A.isPlainObject,S=A.getValue,t=r(1737),p=r(1933),f=r(3906),o=r(2691),a=r(2679),m=r(1268),C=r(2535),g=r(5915),h=r(4130),d=r(6376),s=r(4111),u=r(5529),c=r(7696),l=r(8012),n=r(4238),y=r(3976),v=r(382),i=r(8753),e.exports=function(){function e(e,r,i){var n;this.name="?xml",this.type=t.Document,e||(e={}),n={},e.writer?T(e.writer)&&(n=e.writer,e.writer=new v):e.writer=new v,this.options=e,this.writer=e.writer,this.writerOptions=this.writer.filterOptions(n),this.stringify=new y(e),this.onDataCallback=r||function(){},this.onEndCallback=i||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return e.prototype.createChildNode=function(e){var r,i,n,o,a,s,c,u;switch(e.type){case t.CData:this.cdata(e.value);break;case t.Comment:this.comment(e.value);break;case t.Element:for(i in n={},c=e.attribs)I.call(c,i)&&(r=c[i],n[i]=r.value);this.node(e.name,n);break;case t.Dummy:this.dummy();break;case t.Raw:this.raw(e.value);break;case t.Text:this.text(e.value);break;case t.ProcessingInstruction:this.instruction(e.target,e.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+e.constructor.name)}for(a=0,s=(u=e.children).length;a<s;a++)o=u[a],this.createChildNode(o),o.type===t.Element&&this.up();return this},e.prototype.dummy=function(){return this},e.prototype.node=function(e,t,r){var i;if(null==e)throw new Error("Missing node name.");if(this.root&&-1===this.currentLevel)throw new Error("Document can only have one root node. "+this.debugInfo(e));return this.openCurrent(),e=S(e),null==t&&(t={}),t=S(t),_(t)||(r=(i=[t,r])[0],t=i[1]),this.currentNode=new f(this,e,t),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,null!=r&&this.text(r),this},e.prototype.element=function(e,r,i){var n,o,a,s,c,u;if(this.currentNode&&this.currentNode.type===t.DocType)this.dtdElement.apply(this,arguments);else if(Array.isArray(e)||_(e)||E(e))for(s=this.options.noValidation,this.options.noValidation=!0,(u=new p(this.options).element("TEMP_ROOT")).element(e),this.options.noValidation=s,o=0,a=(c=u.children).length;o<a;o++)n=c[o],this.createChildNode(n),n.type===t.Element&&this.up();else this.node(e,r,i);return this},e.prototype.attribute=function(e,t){var r,i;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(e));if(null!=e&&(e=S(e)),_(e))for(r in e)I.call(e,r)&&(i=e[r],this.attribute(r,i));else E(t)&&(t=t.apply()),this.options.keepNullAttributes&&null==t?this.currentNode.attribs[e]=new n(this,e,""):null!=t&&(this.currentNode.attribs[e]=new n(this,e,t));return this},e.prototype.text=function(e){var t;return this.openCurrent(),t=new C(this,e),this.onData(this.writer.text(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.cdata=function(e){var t;return this.openCurrent(),t=new o(this,e),this.onData(this.writer.cdata(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.comment=function(e){var t;return this.openCurrent(),t=new a(this,e),this.onData(this.writer.comment(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.raw=function(e){var t;return this.openCurrent(),t=new m(this,e),this.onData(this.writer.raw(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.instruction=function(e,t){var r,i,n,o,a;if(this.openCurrent(),null!=e&&(e=S(e)),null!=t&&(t=S(t)),Array.isArray(e))for(r=0,o=e.length;r<o;r++)i=e[r],this.instruction(i);else if(_(e))for(i in e)I.call(e,i)&&(n=e[i],this.instruction(i,n));else E(t)&&(t=t.apply()),a=new g(this,e,t),this.onData(this.writer.processingInstruction(a,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this},e.prototype.declaration=function(e,t,r){var i;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return i=new h(this,e,t,r),this.onData(this.writer.declaration(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.doctype=function(e,t,r){if(this.openCurrent(),null==e)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new d(this,t,r),this.currentNode.rootNodeName=e,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},e.prototype.dtdElement=function(e,t){var r;return this.openCurrent(),r=new c(this,e,t),this.onData(this.writer.dtdElement(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.attList=function(e,t,r,i,n){var o;return this.openCurrent(),o=new s(this,e,t,r,i,n),this.onData(this.writer.dtdAttList(o,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.entity=function(e,t){var r;return this.openCurrent(),r=new u(this,!1,e,t),this.onData(this.writer.dtdEntity(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.pEntity=function(e,t){var r;return this.openCurrent(),r=new u(this,!0,e,t),this.onData(this.writer.dtdEntity(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.notation=function(e,t){var r;return this.openCurrent(),r=new l(this,e,t),this.onData(this.writer.dtdNotation(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},e.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},e.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},e.prototype.openNode=function(e){var r,n,o,a;if(!e.isOpen){if(this.root||0!==this.currentLevel||e.type!==t.Element||(this.root=e),n="",e.type===t.Element){for(o in this.writerOptions.state=i.OpenTag,n=this.writer.indent(e,this.writerOptions,this.currentLevel)+"<"+e.name,a=e.attribs)I.call(a,o)&&(r=a[o],n+=this.writer.attribute(r,this.writerOptions,this.currentLevel));n+=(e.children?">":"/>")+this.writer.endline(e,this.writerOptions,this.currentLevel),this.writerOptions.state=i.InsideTag}else this.writerOptions.state=i.OpenTag,n=this.writer.indent(e,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+e.rootNodeName,e.pubID&&e.sysID?n+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(n+=' SYSTEM "'+e.sysID+'"'),e.children?(n+=" [",this.writerOptions.state=i.InsideTag):(this.writerOptions.state=i.CloseTag,n+=">"),n+=this.writer.endline(e,this.writerOptions,this.currentLevel);return this.onData(n,this.currentLevel),e.isOpen=!0}},e.prototype.closeNode=function(e){var r;if(!e.isClosed)return r="",this.writerOptions.state=i.CloseTag,r=e.type===t.Element?this.writer.indent(e,this.writerOptions,this.currentLevel)+"</"+e.name+">"+this.writer.endline(e,this.writerOptions,this.currentLevel):this.writer.indent(e,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(e,this.writerOptions,this.currentLevel),this.writerOptions.state=i.None,this.onData(r,this.currentLevel),e.isClosed=!0},e.prototype.onData=function(e,t){return this.documentStarted=!0,this.onDataCallback(e,t+1)},e.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},e.prototype.debugInfo=function(e){return null==e?"":"node: <"+e+">"},e.prototype.ele=function(){return this.element.apply(this,arguments)},e.prototype.nod=function(e,t,r){return this.node(e,t,r)},e.prototype.txt=function(e){return this.text(e)},e.prototype.dat=function(e){return this.cdata(e)},e.prototype.com=function(e){return this.comment(e)},e.prototype.ins=function(e,t){return this.instruction(e,t)},e.prototype.dec=function(e,t,r){return this.declaration(e,t,r)},e.prototype.dtd=function(e,t,r){return this.doctype(e,t,r)},e.prototype.e=function(e,t,r){return this.element(e,t,r)},e.prototype.n=function(e,t,r){return this.node(e,t,r)},e.prototype.t=function(e){return this.text(e)},e.prototype.d=function(e){return this.cdata(e)},e.prototype.c=function(e){return this.comment(e)},e.prototype.r=function(e){return this.raw(e)},e.prototype.i=function(e,t){return this.instruction(e,t)},e.prototype.att=function(){return this.currentNode&&this.currentNode.type===t.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},e.prototype.a=function(){return this.currentNode&&this.currentNode.type===t.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},e.prototype.ent=function(e,t){return this.entity(e,t)},e.prototype.pent=function(e,t){return this.pEntity(e,t)},e.prototype.not=function(e,t){return this.notation(e,t)},e}()}).call(this)},1218:function(e,t,r){(function(){var t,i,n={}.hasOwnProperty;i=r(468),t=r(1737),e.exports=function(e){function r(e){r.__super__.constructor.call(this,e),this.type=t.Dummy}return function(e,t){for(var r in t)n.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(e){return""},r}(i)}).call(this)},3906:function(e,t,r){(function(){var t,i,n,o,a,s,c,u,l={}.hasOwnProperty;u=r(9241),c=u.isObject,s=u.isFunction,a=u.getValue,o=r(468),t=r(1737),i=r(4238),n=r(4797),e.exports=function(e){function r(e,i,n){var o,a,s,c;if(r.__super__.constructor.call(this,e),null==i)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(i),this.type=t.Element,this.attribs={},this.schemaTypeInfo=null,null!=n&&this.attribute(n),e.type===t.Document&&(this.isRoot=!0,this.documentObject=e,e.rootObject=this,e.children))for(a=0,s=(c=e.children).length;a<s;a++)if((o=c[a]).type===t.DocType){o.name=this.name;break}}return function(e,t){for(var r in t)l.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),Object.defineProperty(r.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(r.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(r.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(r.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(r.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(r.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(r.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(r.prototype,"attributes",{get:function(){return this.attributeMap&&this.attributeMap.nodes||(this.attributeMap=new n(this.attribs)),this.attributeMap}}),r.prototype.clone=function(){var e,t,r,i;for(t in(r=Object.create(this)).isRoot&&(r.documentObject=null),r.attribs={},i=this.attribs)l.call(i,t)&&(e=i[t],r.attribs[t]=e.clone());return r.children=[],this.children.forEach((function(e){var t;return(t=e.clone()).parent=r,r.children.push(t)})),r},r.prototype.attribute=function(e,t){var r,n;if(null!=e&&(e=a(e)),c(e))for(r in e)l.call(e,r)&&(n=e[r],this.attribute(r,n));else s(t)&&(t=t.apply()),this.options.keepNullAttributes&&null==t?this.attribs[e]=new i(this,e,""):null!=t&&(this.attribs[e]=new i(this,e,t));return this},r.prototype.removeAttribute=function(e){var t,r,i;if(null==e)throw new Error("Missing attribute name. "+this.debugInfo());if(e=a(e),Array.isArray(e))for(r=0,i=e.length;r<i;r++)t=e[r],delete this.attribs[t];else delete this.attribs[e];return this},r.prototype.toString=function(e){return this.options.writer.element(this,this.options.writer.filterOptions(e))},r.prototype.att=function(e,t){return this.attribute(e,t)},r.prototype.a=function(e,t){return this.attribute(e,t)},r.prototype.getAttribute=function(e){return this.attribs.hasOwnProperty(e)?this.attribs[e].value:null},r.prototype.setAttribute=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getAttributeNode=function(e){return this.attribs.hasOwnProperty(e)?this.attribs[e]:null},r.prototype.setAttributeNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.removeAttributeNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getAttributeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.setAttributeNS=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.removeAttributeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getAttributeNodeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.setAttributeNodeNS=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagNameNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.hasAttribute=function(e){return this.attribs.hasOwnProperty(e)},r.prototype.hasAttributeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.setIdAttribute=function(e,t){return this.attribs.hasOwnProperty(e)?this.attribs[e].isId:t},r.prototype.setIdAttributeNS=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.setIdAttributeNode=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagNameNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByClassName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.isEqualNode=function(e){var t,i,n;if(!r.__super__.isEqualNode.apply(this,arguments).isEqualNode(e))return!1;if(e.namespaceURI!==this.namespaceURI)return!1;if(e.prefix!==this.prefix)return!1;if(e.localName!==this.localName)return!1;if(e.attribs.length!==this.attribs.length)return!1;for(t=i=0,n=this.attribs.length-1;0<=n?i<=n:i>=n;t=0<=n?++i:--i)if(!this.attribs[t].isEqualNode(e.attribs[t]))return!1;return!0},r}(o)}).call(this)},4797:function(e){(function(){e.exports=function(){function e(e){this.nodes=e}return Object.defineProperty(e.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),e.prototype.clone=function(){return this.nodes=null},e.prototype.getNamedItem=function(e){return this.nodes[e]},e.prototype.setNamedItem=function(e){var t;return t=this.nodes[e.nodeName],this.nodes[e.nodeName]=e,t||null},e.prototype.removeNamedItem=function(e){var t;return t=this.nodes[e],delete this.nodes[e],t||null},e.prototype.item=function(e){return this.nodes[Object.keys(this.nodes)[e]]||null},e.prototype.getNamedItemNS=function(e,t){throw new Error("This DOM method is not implemented.")},e.prototype.setNamedItemNS=function(e){throw new Error("This DOM method is not implemented.")},e.prototype.removeNamedItemNS=function(e,t){throw new Error("This DOM method is not implemented.")},e}()}).call(this)},468:function(e,t,r){(function(){var t,i,n,o,a,s,c,u,l,h,d,p,f,g,m,v,y,C={}.hasOwnProperty;y=r(9241),v=y.isObject,m=y.isFunction,g=y.isEmpty,f=y.getValue,u=null,n=null,o=null,a=null,s=null,d=null,p=null,h=null,c=null,i=null,l=null,t=null,e.exports=function(){function e(e){this.parent=e,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,u||(u=r(3906),n=r(2691),o=r(2679),a=r(4130),s=r(6376),d=r(1268),p=r(2535),h=r(5915),c=r(1218),i=r(1737),l=r(6684),r(4797),t=r(4923))}return Object.defineProperty(e.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(e.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(e.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(e.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(e.prototype,"childNodes",{get:function(){return this.childNodeList&&this.childNodeList.nodes||(this.childNodeList=new l(this.children)),this.childNodeList}}),Object.defineProperty(e.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(e.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){var e;return e=this.parent.children.indexOf(this),this.parent.children[e-1]||null}}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){var e;return e=this.parent.children.indexOf(this),this.parent.children[e+1]||null}}),Object.defineProperty(e.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(e.prototype,"textContent",{get:function(){var e,t,r,n,o;if(this.nodeType===i.Element||this.nodeType===i.DocumentFragment){for(o="",t=0,r=(n=this.children).length;t<r;t++)(e=n[t]).textContent&&(o+=e.textContent);return o}return null},set:function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),e.prototype.setParent=function(e){var t,r,i,n,o;for(this.parent=e,e&&(this.options=e.options,this.stringify=e.stringify),o=[],r=0,i=(n=this.children).length;r<i;r++)t=n[r],o.push(t.setParent(this));return o},e.prototype.element=function(e,t,r){var i,n,o,a,s,c,u,l,h,d,p;if(c=null,null===t&&null==r&&(t=(h=[{},null])[0],r=h[1]),null==t&&(t={}),t=f(t),v(t)||(r=(d=[t,r])[0],t=d[1]),null!=e&&(e=f(e)),Array.isArray(e))for(o=0,u=e.length;o<u;o++)n=e[o],c=this.element(n);else if(m(e))c=this.element(e.apply());else if(v(e)){for(s in e)if(C.call(e,s))if(p=e[s],m(p)&&(p=p.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&0===s.indexOf(this.stringify.convertAttKey))c=this.attribute(s.substr(this.stringify.convertAttKey.length),p);else if(!this.options.separateArrayItems&&Array.isArray(p)&&g(p))c=this.dummy();else if(v(p)&&g(p))c=this.element(s);else if(this.options.keepNullNodes||null!=p)if(!this.options.separateArrayItems&&Array.isArray(p))for(a=0,l=p.length;a<l;a++)n=p[a],(i={})[s]=n,c=this.element(i);else v(p)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===s.indexOf(this.stringify.convertTextKey)?c=this.element(p):(c=this.element(s)).element(p):c=this.element(s,p);else c=this.dummy()}else c=this.options.keepNullNodes||null!==r?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===e.indexOf(this.stringify.convertTextKey)?this.text(r):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&0===e.indexOf(this.stringify.convertCDataKey)?this.cdata(r):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&0===e.indexOf(this.stringify.convertCommentKey)?this.comment(r):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&0===e.indexOf(this.stringify.convertRawKey)?this.raw(r):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&0===e.indexOf(this.stringify.convertPIKey)?this.instruction(e.substr(this.stringify.convertPIKey.length),r):this.node(e,t,r):this.dummy();if(null==c)throw new Error("Could not create any elements with: "+e+". "+this.debugInfo());return c},e.prototype.insertBefore=function(e,t,r){var i,n,o,a,s;if(null!=e?e.type:void 0)return a=t,(o=e).setParent(this),a?(n=children.indexOf(a),s=children.splice(n),children.push(o),Array.prototype.push.apply(children,s)):children.push(o),o;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(e));return n=this.parent.children.indexOf(this),s=this.parent.children.splice(n),i=this.parent.element(e,t,r),Array.prototype.push.apply(this.parent.children,s),i},e.prototype.insertAfter=function(e,t,r){var i,n,o;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(e));return n=this.parent.children.indexOf(this),o=this.parent.children.splice(n+1),i=this.parent.element(e,t,r),Array.prototype.push.apply(this.parent.children,o),i},e.prototype.remove=function(){var e;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return e=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[e,e-e+1].concat([])),this.parent},e.prototype.node=function(e,t,r){var i,n;return null!=e&&(e=f(e)),t||(t={}),t=f(t),v(t)||(r=(n=[t,r])[0],t=n[1]),i=new u(this,e,t),null!=r&&i.text(r),this.children.push(i),i},e.prototype.text=function(e){var t;return v(e)&&this.element(e),t=new p(this,e),this.children.push(t),this},e.prototype.cdata=function(e){var t;return t=new n(this,e),this.children.push(t),this},e.prototype.comment=function(e){var t;return t=new o(this,e),this.children.push(t),this},e.prototype.commentBefore=function(e){var t,r;return t=this.parent.children.indexOf(this),r=this.parent.children.splice(t),this.parent.comment(e),Array.prototype.push.apply(this.parent.children,r),this},e.prototype.commentAfter=function(e){var t,r;return t=this.parent.children.indexOf(this),r=this.parent.children.splice(t+1),this.parent.comment(e),Array.prototype.push.apply(this.parent.children,r),this},e.prototype.raw=function(e){var t;return t=new d(this,e),this.children.push(t),this},e.prototype.dummy=function(){return new c(this)},e.prototype.instruction=function(e,t){var r,i,n,o,a;if(null!=e&&(e=f(e)),null!=t&&(t=f(t)),Array.isArray(e))for(o=0,a=e.length;o<a;o++)r=e[o],this.instruction(r);else if(v(e))for(r in e)C.call(e,r)&&(i=e[r],this.instruction(r,i));else m(t)&&(t=t.apply()),n=new h(this,e,t),this.children.push(n);return this},e.prototype.instructionBefore=function(e,t){var r,i;return r=this.parent.children.indexOf(this),i=this.parent.children.splice(r),this.parent.instruction(e,t),Array.prototype.push.apply(this.parent.children,i),this},e.prototype.instructionAfter=function(e,t){var r,i;return r=this.parent.children.indexOf(this),i=this.parent.children.splice(r+1),this.parent.instruction(e,t),Array.prototype.push.apply(this.parent.children,i),this},e.prototype.declaration=function(e,t,r){var n,o;return n=this.document(),o=new a(n,e,t,r),0===n.children.length?n.children.unshift(o):n.children[0].type===i.Declaration?n.children[0]=o:n.children.unshift(o),n.root()||n},e.prototype.dtd=function(e,t){var r,n,o,a,c,u,l,h,d;for(r=this.document(),n=new s(r,e,t),o=a=0,u=(h=r.children).length;a<u;o=++a)if(h[o].type===i.DocType)return r.children[o]=n,n;for(o=c=0,l=(d=r.children).length;c<l;o=++c)if(d[o].isRoot)return r.children.splice(o,0,n),n;return r.children.push(n),n},e.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},e.prototype.root=function(){var e;for(e=this;e;){if(e.type===i.Document)return e.rootObject;if(e.isRoot)return e;e=e.parent}},e.prototype.document=function(){var e;for(e=this;e;){if(e.type===i.Document)return e;e=e.parent}},e.prototype.end=function(e){return this.document().end(e)},e.prototype.prev=function(){var e;if((e=this.parent.children.indexOf(this))<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[e-1]},e.prototype.next=function(){var e;if(-1===(e=this.parent.children.indexOf(this))||e===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[e+1]},e.prototype.importDocument=function(e){var t;return(t=e.root().clone()).parent=this,t.isRoot=!1,this.children.push(t),this},e.prototype.debugInfo=function(e){var t,r;return null!=(e=e||this.name)||(null!=(t=this.parent)?t.name:void 0)?null==e?"parent: <"+this.parent.name+">":(null!=(r=this.parent)?r.name:void 0)?"node: <"+e+">, parent: <"+this.parent.name+">":"node: <"+e+">":""},e.prototype.ele=function(e,t,r){return this.element(e,t,r)},e.prototype.nod=function(e,t,r){return this.node(e,t,r)},e.prototype.txt=function(e){return this.text(e)},e.prototype.dat=function(e){return this.cdata(e)},e.prototype.com=function(e){return this.comment(e)},e.prototype.ins=function(e,t){return this.instruction(e,t)},e.prototype.doc=function(){return this.document()},e.prototype.dec=function(e,t,r){return this.declaration(e,t,r)},e.prototype.e=function(e,t,r){return this.element(e,t,r)},e.prototype.n=function(e,t,r){return this.node(e,t,r)},e.prototype.t=function(e){return this.text(e)},e.prototype.d=function(e){return this.cdata(e)},e.prototype.c=function(e){return this.comment(e)},e.prototype.r=function(e){return this.raw(e)},e.prototype.i=function(e,t){return this.instruction(e,t)},e.prototype.u=function(){return this.up()},e.prototype.importXMLBuilder=function(e){return this.importDocument(e)},e.prototype.replaceChild=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.removeChild=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.appendChild=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.hasChildNodes=function(){return 0!==this.children.length},e.prototype.cloneNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.normalize=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.isSupported=function(e,t){return!0},e.prototype.hasAttributes=function(){return 0!==this.attribs.length},e.prototype.compareDocumentPosition=function(e){var r,i;return(r=this)===e?0:this.document()!==e.document()?(i=t.Disconnected|t.ImplementationSpecific,Math.random()<.5?i|=t.Preceding:i|=t.Following,i):r.isAncestor(e)?t.Contains|t.Preceding:r.isDescendant(e)?t.Contains|t.Following:r.isPreceding(e)?t.Preceding:t.Following},e.prototype.isSameNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.lookupPrefix=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.isDefaultNamespace=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.lookupNamespaceURI=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.isEqualNode=function(e){var t,r,i;if(e.nodeType!==this.nodeType)return!1;if(e.children.length!==this.children.length)return!1;for(t=r=0,i=this.children.length-1;0<=i?r<=i:r>=i;t=0<=i?++r:--r)if(!this.children[t].isEqualNode(e.children[t]))return!1;return!0},e.prototype.getFeature=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.setUserData=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.getUserData=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.contains=function(e){return!!e&&(e===this||this.isDescendant(e))},e.prototype.isDescendant=function(e){var t,r,i,n;for(r=0,i=(n=this.children).length;r<i;r++){if(e===(t=n[r]))return!0;if(t.isDescendant(e))return!0}return!1},e.prototype.isAncestor=function(e){return e.isDescendant(this)},e.prototype.isPreceding=function(e){var t,r;return t=this.treePosition(e),r=this.treePosition(this),-1!==t&&-1!==r&&t<r},e.prototype.isFollowing=function(e){var t,r;return t=this.treePosition(e),r=this.treePosition(this),-1!==t&&-1!==r&&t>r},e.prototype.treePosition=function(e){var t,r;return r=0,t=!1,this.foreachTreeNode(this.document(),(function(i){if(r++,!t&&i===e)return t=!0})),t?r:-1},e.prototype.foreachTreeNode=function(e,t){var r,i,n,o,a;for(e||(e=this.document()),i=0,n=(o=e.children).length;i<n;i++){if(a=t(r=o[i]))return a;if(a=this.foreachTreeNode(r,t))return a}},e}()}).call(this)},6684:function(e){(function(){e.exports=function(){function e(e){this.nodes=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this.nodes.length||0}}),e.prototype.clone=function(){return this.nodes=null},e.prototype.item=function(e){return this.nodes[e]||null},e}()}).call(this)},5915:function(e,t,r){(function(){var t,i,n={}.hasOwnProperty;t=r(1737),i=r(7457),e.exports=function(e){function r(e,i,n){if(r.__super__.constructor.call(this,e),null==i)throw new Error("Missing instruction target. "+this.debugInfo());this.type=t.ProcessingInstruction,this.target=this.stringify.insTarget(i),this.name=this.target,n&&(this.value=this.stringify.insValue(n))}return function(e,t){for(var r in t)n.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(e){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(e))},r.prototype.isEqualNode=function(e){return!!r.__super__.isEqualNode.apply(this,arguments).isEqualNode(e)&&e.target===this.target},r}(i)}).call(this)},1268:function(e,t,r){(function(){var t,i,n={}.hasOwnProperty;t=r(1737),i=r(468),e.exports=function(e){function r(e,i){if(r.__super__.constructor.call(this,e),null==i)throw new Error("Missing raw text. "+this.debugInfo());this.type=t.Raw,this.value=this.stringify.raw(i)}return function(e,t){for(var r in t)n.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(e){return this.options.writer.raw(this,this.options.writer.filterOptions(e))},r}(i)}).call(this)},6775:function(e,t,r){(function(){var t,i,n,o={}.hasOwnProperty;t=r(1737),n=r(6286),i=r(8753),e.exports=function(e){function r(e,t){this.stream=e,r.__super__.constructor.call(this,t)}return function(e,t){for(var r in t)o.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),r.prototype.endline=function(e,t,n){return e.isLastRootNode&&t.state===i.CloseTag?"":r.__super__.endline.call(this,e,t,n)},r.prototype.document=function(e,t){var r,i,n,o,a,s,c,u,l;for(i=n=0,a=(c=e.children).length;n<a;i=++n)(r=c[i]).isLastRootNode=i===e.children.length-1;for(t=this.filterOptions(t),l=[],o=0,s=(u=e.children).length;o<s;o++)r=u[o],l.push(this.writeChildNode(r,t,0));return l},r.prototype.attribute=function(e,t,i){return this.stream.write(r.__super__.attribute.call(this,e,t,i))},r.prototype.cdata=function(e,t,i){return this.stream.write(r.__super__.cdata.call(this,e,t,i))},r.prototype.comment=function(e,t,i){return this.stream.write(r.__super__.comment.call(this,e,t,i))},r.prototype.declaration=function(e,t,i){return this.stream.write(r.__super__.declaration.call(this,e,t,i))},r.prototype.docType=function(e,t,r){var n,o,a,s;if(r||(r=0),this.openNode(e,t,r),t.state=i.OpenTag,this.stream.write(this.indent(e,t,r)),this.stream.write("<!DOCTYPE "+e.root().name),e.pubID&&e.sysID?this.stream.write(' PUBLIC "'+e.pubID+'" "'+e.sysID+'"'):e.sysID&&this.stream.write(' SYSTEM "'+e.sysID+'"'),e.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(e,t,r)),t.state=i.InsideTag,o=0,a=(s=e.children).length;o<a;o++)n=s[o],this.writeChildNode(n,t,r+1);t.state=i.CloseTag,this.stream.write("]")}return t.state=i.CloseTag,this.stream.write(t.spaceBeforeSlash+">"),this.stream.write(this.endline(e,t,r)),t.state=i.None,this.closeNode(e,t,r)},r.prototype.element=function(e,r,n){var a,s,c,u,l,h,d,p,f;for(d in n||(n=0),this.openNode(e,r,n),r.state=i.OpenTag,this.stream.write(this.indent(e,r,n)+"<"+e.name),p=e.attribs)o.call(p,d)&&(a=p[d],this.attribute(a,r,n));if(u=0===(c=e.children.length)?null:e.children[0],0===c||e.children.every((function(e){return(e.type===t.Text||e.type===t.Raw)&&""===e.value})))r.allowEmpty?(this.stream.write(">"),r.state=i.CloseTag,this.stream.write("</"+e.name+">")):(r.state=i.CloseTag,this.stream.write(r.spaceBeforeSlash+"/>"));else if(!r.pretty||1!==c||u.type!==t.Text&&u.type!==t.Raw||null==u.value){for(this.stream.write(">"+this.endline(e,r,n)),r.state=i.InsideTag,l=0,h=(f=e.children).length;l<h;l++)s=f[l],this.writeChildNode(s,r,n+1);r.state=i.CloseTag,this.stream.write(this.indent(e,r,n)+"</"+e.name+">")}else this.stream.write(">"),r.state=i.InsideTag,r.suppressPrettyCount++,this.writeChildNode(u,r,n+1),r.suppressPrettyCount--,r.state=i.CloseTag,this.stream.write("</"+e.name+">");return this.stream.write(this.endline(e,r,n)),r.state=i.None,this.closeNode(e,r,n)},r.prototype.processingInstruction=function(e,t,i){return this.stream.write(r.__super__.processingInstruction.call(this,e,t,i))},r.prototype.raw=function(e,t,i){return this.stream.write(r.__super__.raw.call(this,e,t,i))},r.prototype.text=function(e,t,i){return this.stream.write(r.__super__.text.call(this,e,t,i))},r.prototype.dtdAttList=function(e,t,i){return this.stream.write(r.__super__.dtdAttList.call(this,e,t,i))},r.prototype.dtdElement=function(e,t,i){return this.stream.write(r.__super__.dtdElement.call(this,e,t,i))},r.prototype.dtdEntity=function(e,t,i){return this.stream.write(r.__super__.dtdEntity.call(this,e,t,i))},r.prototype.dtdNotation=function(e,t,i){return this.stream.write(r.__super__.dtdNotation.call(this,e,t,i))},r}(n)}).call(this)},382:function(e,t,r){(function(){var t,i={}.hasOwnProperty;t=r(6286),e.exports=function(e){function t(e){t.__super__.constructor.call(this,e)}return function(e,t){for(var r in t)i.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(t,e),t.prototype.document=function(e,t){var r,i,n,o,a;for(t=this.filterOptions(t),o="",i=0,n=(a=e.children).length;i<n;i++)r=a[i],o+=this.writeChildNode(r,t,0);return t.pretty&&o.slice(-t.newline.length)===t.newline&&(o=o.slice(0,-t.newline.length)),o},t}(t)}).call(this)},3976:function(e){(function(){var t=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty;e.exports=function(){function e(e){var i,n,o;for(i in this.assertLegalName=t(this.assertLegalName,this),this.assertLegalChar=t(this.assertLegalChar,this),e||(e={}),this.options=e,this.options.version||(this.options.version="1.0"),n=e.stringify||{})r.call(n,i)&&(o=n[i],this[i]=o)}return e.prototype.name=function(e){return this.options.noValidation?e:this.assertLegalName(""+e||"")},e.prototype.text=function(e){return this.options.noValidation?e:this.assertLegalChar(this.textEscape(""+e||""))},e.prototype.cdata=function(e){return this.options.noValidation?e:(e=(e=""+e||"").replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(e))},e.prototype.comment=function(e){if(this.options.noValidation)return e;if((e=""+e||"").match(/--/))throw new Error("Comment text cannot contain double-hypen: "+e);return this.assertLegalChar(e)},e.prototype.raw=function(e){return this.options.noValidation?e:""+e||""},e.prototype.attValue=function(e){return this.options.noValidation?e:this.assertLegalChar(this.attEscape(e=""+e||""))},e.prototype.insTarget=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.insValue=function(e){if(this.options.noValidation)return e;if((e=""+e||"").match(/\?>/))throw new Error("Invalid processing instruction value: "+e);return this.assertLegalChar(e)},e.prototype.xmlVersion=function(e){if(this.options.noValidation)return e;if(!(e=""+e||"").match(/1\.[0-9]+/))throw new Error("Invalid version number: "+e);return e},e.prototype.xmlEncoding=function(e){if(this.options.noValidation)return e;if(!(e=""+e||"").match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+e);return this.assertLegalChar(e)},e.prototype.xmlStandalone=function(e){return this.options.noValidation?e:e?"yes":"no"},e.prototype.dtdPubID=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdSysID=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdElementValue=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdAttType=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdAttDefault=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdEntityValue=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdNData=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.convertAttKey="@",e.prototype.convertPIKey="?",e.prototype.convertTextKey="#text",e.prototype.convertCDataKey="#cdata",e.prototype.convertCommentKey="#comment",e.prototype.convertRawKey="#raw",e.prototype.assertLegalChar=function(e){var t,r;if(this.options.noValidation)return e;if(t="","1.0"===this.options.version){if(t=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,r=e.match(t))throw new Error("Invalid character in string: "+e+" at index "+r.index)}else if("1.1"===this.options.version&&(t=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,r=e.match(t)))throw new Error("Invalid character in string: "+e+" at index "+r.index);return e},e.prototype.assertLegalName=function(e){var t;if(this.options.noValidation)return e;if(this.assertLegalChar(e),t=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!e.match(t))throw new Error("Invalid character in name");return e},e.prototype.textEscape=function(e){var t;return this.options.noValidation?e:(t=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,e.replace(t,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))},e.prototype.attEscape=function(e){var t;return this.options.noValidation?e:(t=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,e.replace(t,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))},e}()}).call(this)},2535:function(e,t,r){(function(){var t,i,n={}.hasOwnProperty;t=r(1737),i=r(7457),e.exports=function(e){function r(e,i){if(r.__super__.constructor.call(this,e),null==i)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=t.Text,this.value=this.stringify.text(i)}return function(e,t){for(var r in t)n.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(r,e),Object.defineProperty(r.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(r.prototype,"wholeText",{get:function(){var e,t,r;for(r="",t=this.previousSibling;t;)r=t.data+r,t=t.previousSibling;for(r+=this.data,e=this.nextSibling;e;)r+=e.data,e=e.nextSibling;return r}}),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(e){return this.options.writer.text(this,this.options.writer.filterOptions(e))},r.prototype.splitText=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.replaceWholeText=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r}(i)}).call(this)},6286:function(e,t,r){(function(){var t,i,n,o={}.hasOwnProperty;n=r(9241).assign,t=r(1737),r(4130),r(6376),r(2691),r(2679),r(3906),r(1268),r(2535),r(5915),r(1218),r(4111),r(7696),r(5529),r(8012),i=r(8753),e.exports=function(){function e(e){var t,r,i;for(t in e||(e={}),this.options=e,r=e.writer||{})o.call(r,t)&&(i=r[t],this["_"+t]=this[t],this[t]=i)}return e.prototype.filterOptions=function(e){var t,r,o,a,s,c,u,l;return e||(e={}),e=n({},this.options,e),(t={writer:this}).pretty=e.pretty||!1,t.allowEmpty=e.allowEmpty||!1,t.indent=null!=(r=e.indent)?r:"  ",t.newline=null!=(o=e.newline)?o:"\n",t.offset=null!=(a=e.offset)?a:0,t.dontPrettyTextNodes=null!=(s=null!=(c=e.dontPrettyTextNodes)?c:e.dontprettytextnodes)?s:0,t.spaceBeforeSlash=null!=(u=null!=(l=e.spaceBeforeSlash)?l:e.spacebeforeslash)?u:"",!0===t.spaceBeforeSlash&&(t.spaceBeforeSlash=" "),t.suppressPrettyCount=0,t.user={},t.state=i.None,t},e.prototype.indent=function(e,t,r){var i;return!t.pretty||t.suppressPrettyCount?"":t.pretty&&(i=(r||0)+t.offset+1)>0?new Array(i).join(t.indent):""},e.prototype.endline=function(e,t,r){return!t.pretty||t.suppressPrettyCount?"":t.newline},e.prototype.attribute=function(e,t,r){var i;return this.openAttribute(e,t,r),i=" "+e.name+'="'+e.value+'"',this.closeAttribute(e,t,r),i},e.prototype.cdata=function(e,t,r){var n;return this.openNode(e,t,r),t.state=i.OpenTag,n=this.indent(e,t,r)+"<![CDATA[",t.state=i.InsideTag,n+=e.value,t.state=i.CloseTag,n+="]]>"+this.endline(e,t,r),t.state=i.None,this.closeNode(e,t,r),n},e.prototype.comment=function(e,t,r){var n;return this.openNode(e,t,r),t.state=i.OpenTag,n=this.indent(e,t,r)+"\x3c!-- ",t.state=i.InsideTag,n+=e.value,t.state=i.CloseTag,n+=" --\x3e"+this.endline(e,t,r),t.state=i.None,this.closeNode(e,t,r),n},e.prototype.declaration=function(e,t,r){var n;return this.openNode(e,t,r),t.state=i.OpenTag,n=this.indent(e,t,r)+"<?xml",t.state=i.InsideTag,n+=' version="'+e.version+'"',null!=e.encoding&&(n+=' encoding="'+e.encoding+'"'),null!=e.standalone&&(n+=' standalone="'+e.standalone+'"'),t.state=i.CloseTag,n+=t.spaceBeforeSlash+"?>",n+=this.endline(e,t,r),t.state=i.None,this.closeNode(e,t,r),n},e.prototype.docType=function(e,t,r){var n,o,a,s,c;if(r||(r=0),this.openNode(e,t,r),t.state=i.OpenTag,s=this.indent(e,t,r),s+="<!DOCTYPE "+e.root().name,e.pubID&&e.sysID?s+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(s+=' SYSTEM "'+e.sysID+'"'),e.children.length>0){for(s+=" [",s+=this.endline(e,t,r),t.state=i.InsideTag,o=0,a=(c=e.children).length;o<a;o++)n=c[o],s+=this.writeChildNode(n,t,r+1);t.state=i.CloseTag,s+="]"}return t.state=i.CloseTag,s+=t.spaceBeforeSlash+">",s+=this.endline(e,t,r),t.state=i.None,this.closeNode(e,t,r),s},e.prototype.element=function(e,r,n){var a,s,c,u,l,h,d,p,f,g,m,v,y,C;for(f in n||(n=0),g=!1,m="",this.openNode(e,r,n),r.state=i.OpenTag,m+=this.indent(e,r,n)+"<"+e.name,v=e.attribs)o.call(v,f)&&(a=v[f],m+=this.attribute(a,r,n));if(u=0===(c=e.children.length)?null:e.children[0],0===c||e.children.every((function(e){return(e.type===t.Text||e.type===t.Raw)&&""===e.value})))r.allowEmpty?(m+=">",r.state=i.CloseTag,m+="</"+e.name+">"+this.endline(e,r,n)):(r.state=i.CloseTag,m+=r.spaceBeforeSlash+"/>"+this.endline(e,r,n));else if(!r.pretty||1!==c||u.type!==t.Text&&u.type!==t.Raw||null==u.value){if(r.dontPrettyTextNodes)for(l=0,d=(y=e.children).length;l<d;l++)if(((s=y[l]).type===t.Text||s.type===t.Raw)&&null!=s.value){r.suppressPrettyCount++,g=!0;break}for(m+=">"+this.endline(e,r,n),r.state=i.InsideTag,h=0,p=(C=e.children).length;h<p;h++)s=C[h],m+=this.writeChildNode(s,r,n+1);r.state=i.CloseTag,m+=this.indent(e,r,n)+"</"+e.name+">",g&&r.suppressPrettyCount--,m+=this.endline(e,r,n),r.state=i.None}else m+=">",r.state=i.InsideTag,r.suppressPrettyCount++,g=!0,m+=this.writeChildNode(u,r,n+1),r.suppressPrettyCount--,g=!1,r.state=i.CloseTag,m+="</"+e.name+">"+this.endline(e,r,n);return this.closeNode(e,r,n),m},e.prototype.writeChildNode=function(e,r,i){switch(e.type){case t.CData:return this.cdata(e,r,i);case t.Comment:return this.comment(e,r,i);case t.Element:return this.element(e,r,i);case t.Raw:return this.raw(e,r,i);case t.Text:return this.text(e,r,i);case t.ProcessingInstruction:return this.processingInstruction(e,r,i);case t.Dummy:return"";case t.Declaration:return this.declaration(e,r,i);case t.DocType:return this.docType(e,r,i);case t.AttributeDeclaration:return this.dtdAttList(e,r,i);case t.ElementDeclaration:return this.dtdElement(e,r,i);case t.EntityDeclaration:return this.dtdEntity(e,r,i);case t.NotationDeclaration:return this.dtdNotation(e,r,i);default:throw new Error("Unknown XML node type: "+e.constructor.name)}},e.prototype.processingInstruction=function(e,t,r){var n;return this.openNode(e,t,r),t.state=i.OpenTag,n=this.indent(e,t,r)+"<?",t.state=i.InsideTag,n+=e.target,e.value&&(n+=" "+e.value),t.state=i.CloseTag,n+=t.spaceBeforeSlash+"?>",n+=this.endline(e,t,r),t.state=i.None,this.closeNode(e,t,r),n},e.prototype.raw=function(e,t,r){var n;return this.openNode(e,t,r),t.state=i.OpenTag,n=this.indent(e,t,r),t.state=i.InsideTag,n+=e.value,t.state=i.CloseTag,n+=this.endline(e,t,r),t.state=i.None,this.closeNode(e,t,r),n},e.prototype.text=function(e,t,r){var n;return this.openNode(e,t,r),t.state=i.OpenTag,n=this.indent(e,t,r),t.state=i.InsideTag,n+=e.value,t.state=i.CloseTag,n+=this.endline(e,t,r),t.state=i.None,this.closeNode(e,t,r),n},e.prototype.dtdAttList=function(e,t,r){var n;return this.openNode(e,t,r),t.state=i.OpenTag,n=this.indent(e,t,r)+"<!ATTLIST",t.state=i.InsideTag,n+=" "+e.elementName+" "+e.attributeName+" "+e.attributeType,"#DEFAULT"!==e.defaultValueType&&(n+=" "+e.defaultValueType),e.defaultValue&&(n+=' "'+e.defaultValue+'"'),t.state=i.CloseTag,n+=t.spaceBeforeSlash+">"+this.endline(e,t,r),t.state=i.None,this.closeNode(e,t,r),n},e.prototype.dtdElement=function(e,t,r){var n;return this.openNode(e,t,r),t.state=i.OpenTag,n=this.indent(e,t,r)+"<!ELEMENT",t.state=i.InsideTag,n+=" "+e.name+" "+e.value,t.state=i.CloseTag,n+=t.spaceBeforeSlash+">"+this.endline(e,t,r),t.state=i.None,this.closeNode(e,t,r),n},e.prototype.dtdEntity=function(e,t,r){var n;return this.openNode(e,t,r),t.state=i.OpenTag,n=this.indent(e,t,r)+"<!ENTITY",t.state=i.InsideTag,e.pe&&(n+=" %"),n+=" "+e.name,e.value?n+=' "'+e.value+'"':(e.pubID&&e.sysID?n+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(n+=' SYSTEM "'+e.sysID+'"'),e.nData&&(n+=" NDATA "+e.nData)),t.state=i.CloseTag,n+=t.spaceBeforeSlash+">"+this.endline(e,t,r),t.state=i.None,this.closeNode(e,t,r),n},e.prototype.dtdNotation=function(e,t,r){var n;return this.openNode(e,t,r),t.state=i.OpenTag,n=this.indent(e,t,r)+"<!NOTATION",t.state=i.InsideTag,n+=" "+e.name,e.pubID&&e.sysID?n+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.pubID?n+=' PUBLIC "'+e.pubID+'"':e.sysID&&(n+=' SYSTEM "'+e.sysID+'"'),t.state=i.CloseTag,n+=t.spaceBeforeSlash+">"+this.endline(e,t,r),t.state=i.None,this.closeNode(e,t,r),n},e.prototype.openNode=function(e,t,r){},e.prototype.closeNode=function(e,t,r){},e.prototype.openAttribute=function(e,t,r){},e.prototype.closeAttribute=function(e,t,r){},e}()}).call(this)},2046:function(e,t,r){(function(){var t,i,n,o,a,s,c,u,l,h;h=r(9241),u=h.assign,l=h.isFunction,n=r(7260),o=r(1933),a=r(400),c=r(382),s=r(6775),t=r(1737),i=r(8753),e.exports.create=function(e,t,r,i){var n,a;if(null==e)throw new Error("Root element needs a name.");return i=u({},t,r,i),a=(n=new o(i)).element(e),i.headless||(n.declaration(i),null==i.pubID&&null==i.sysID||n.dtd(i)),a},e.exports.begin=function(e,t,r){var i;return l(e)&&(t=(i=[e,t])[0],r=i[1],e={}),t?new a(e,t,r):new o(e)},e.exports.stringWriter=function(e){return new c(e)},e.exports.streamWriter=function(e,t){return new s(e,t)},e.exports.implementation=new n,e.exports.nodeType=t,e.exports.writerState=i}).call(this)},2613:e=>{"use strict";e.exports=require("assert")},181:e=>{"use strict";e.exports=require("buffer")},5317:e=>{"use strict";e.exports=require("child_process")},6982:e=>{"use strict";e.exports=require("crypto")},7194:e=>{"use strict";e.exports=require("dgram")},4434:e=>{"use strict";e.exports=require("events")},9896:e=>{"use strict";e.exports=require("fs")},8611:e=>{"use strict";e.exports=require("http")},5692:e=>{"use strict";e.exports=require("https")},9278:e=>{"use strict";e.exports=require("net")},857:e=>{"use strict";e.exports=require("os")},6928:e=>{"use strict";e.exports=require("path")},3785:e=>{"use strict";e.exports=require("readline")},2203:e=>{"use strict";e.exports=require("stream")},3193:e=>{"use strict";e.exports=require("string_decoder")},3557:e=>{"use strict";e.exports=require("timers")},2018:e=>{"use strict";e.exports=require("tty")},7016:e=>{"use strict";e.exports=require("url")},9023:e=>{"use strict";e.exports=require("util")},6094:(e,t,r)=>{var i,n=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;
/**
   * @license
   * Copyright 2009 The Closure Library Authors
   * Copyright 2020 Daniel Wirtz / The long.js Authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *
   * SPDX-License-Identifier: Apache-2.0
   */
var t=null;try{if(r(857).cpus().find((e=>cpus.model.toLowerCase().includes("armv6"))))throw new Error("Workaround for V8 crashing on ARMv6 platform when using WASM");t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function i(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function n(e){return!0===(e&&e.__isLong__)}function o(e){var t=Math.clz32(e&-e);return e?31-t:t}i.prototype.__isLong__,Object.defineProperty(i.prototype,"__isLong__",{value:!0}),i.isLong=n;var a={},s={};function c(e,t){var r,i,n;return t?(n=0<=(e>>>=0)&&e<256)&&(i=s[e])?i:(r=l(e,0,!0),n&&(s[e]=r),r):(n=-128<=(e|=0)&&e<128)&&(i=a[e])?i:(r=l(e,e<0?-1:0,!1),n&&(a[e]=r),r)}function u(e,t){if(isNaN(e))return t?C:y;if(t){if(e<0)return C;if(e>=g)return A}else{if(e<=-m)return I;if(e+1>=m)return T}return e<0?u(-e,t).neg():l(e%f|0,e/f|0,t)}function l(e,t,r){return new i(e,t,r)}i.fromInt=c,i.fromNumber=u,i.fromBits=l;var h=Math.pow;function d(e,t,r){if(0===e.length)throw Error("empty string");if("number"==typeof t?(r=t,t=!1):t=!!t,"NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t?C:y;if((r=r||10)<2||36<r)throw RangeError("radix");var i;if((i=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===i)return d(e.substring(1),t,r).neg();for(var n=u(h(r,8)),o=y,a=0;a<e.length;a+=8){var s=Math.min(8,e.length-a),c=parseInt(e.substring(a,a+s),r);if(s<8){var l=u(h(r,s));o=o.mul(l).add(u(c))}else o=(o=o.mul(n)).add(u(c))}return o.unsigned=t,o}function p(e,t){return"number"==typeof e?u(e,t):"string"==typeof e?d(e,t):l(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}i.fromString=d,i.fromValue=p;var f=4294967296,g=f*f,m=g/2,v=c(1<<24),y=c(0);i.ZERO=y;var C=c(0,!0);i.UZERO=C;var S=c(1);i.ONE=S;var E=c(1,!0);i.UONE=E;var _=c(-1);i.NEG_ONE=_;var T=l(-1,2147483647,!1);i.MAX_VALUE=T;var A=l(-1,-1,!0);i.MAX_UNSIGNED_VALUE=A;var I=l(0,-2147483648,!1);i.MIN_VALUE=I;var D=i.prototype;D.toInt=function(){return this.unsigned?this.low>>>0:this.low},D.toNumber=function(){return this.unsigned?(this.high>>>0)*f+(this.low>>>0):this.high*f+(this.low>>>0)},D.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(I)){var t=u(e),r=this.div(t),i=r.mul(t).sub(this);return r.toString(e)+i.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var n=u(h(e,6),this.unsigned),o=this,a="";;){var s=o.div(n),c=(o.sub(s.mul(n)).toInt()>>>0).toString(e);if((o=s).isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}},D.getHighBits=function(){return this.high},D.getHighBitsUnsigned=function(){return this.high>>>0},D.getLowBits=function(){return this.low},D.getLowBitsUnsigned=function(){return this.low>>>0},D.getNumBitsAbs=function(){if(this.isNegative())return this.eq(I)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return 0!=this.high?t+33:t+1},D.isZero=function(){return 0===this.high&&0===this.low},D.eqz=D.isZero,D.isNegative=function(){return!this.unsigned&&this.high<0},D.isPositive=function(){return this.unsigned||this.high>=0},D.isOdd=function(){return!(1&~this.low)},D.isEven=function(){return!(1&this.low)},D.equals=function(e){return n(e)||(e=p(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},D.eq=D.equals,D.notEquals=function(e){return!this.eq(e)},D.neq=D.notEquals,D.ne=D.notEquals,D.lessThan=function(e){return this.comp(e)<0},D.lt=D.lessThan,D.lessThanOrEqual=function(e){return this.comp(e)<=0},D.lte=D.lessThanOrEqual,D.le=D.lessThanOrEqual,D.greaterThan=function(e){return this.comp(e)>0},D.gt=D.greaterThan,D.greaterThanOrEqual=function(e){return this.comp(e)>=0},D.gte=D.greaterThanOrEqual,D.ge=D.greaterThanOrEqual,D.compare=function(e){if(n(e)||(e=p(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},D.comp=D.compare,D.negate=function(){return!this.unsigned&&this.eq(I)?I:this.not().add(S)},D.neg=D.negate,D.add=function(e){n(e)||(e=p(e));var t=this.high>>>16,r=65535&this.high,i=this.low>>>16,o=65535&this.low,a=e.high>>>16,s=65535&e.high,c=e.low>>>16,u=0,h=0,d=0,f=0;return d+=(f+=o+(65535&e.low))>>>16,h+=(d+=i+c)>>>16,u+=(h+=r+s)>>>16,u+=t+a,l((d&=65535)<<16|(f&=65535),(u&=65535)<<16|(h&=65535),this.unsigned)},D.subtract=function(e){return n(e)||(e=p(e)),this.add(e.neg())},D.sub=D.subtract,D.multiply=function(e){if(this.isZero())return this;if(n(e)||(e=p(e)),t)return l(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return this.unsigned?C:y;if(this.eq(I))return e.isOdd()?I:y;if(e.eq(I))return this.isOdd()?I:y;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(v)&&e.lt(v))return u(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,i=65535&this.high,o=this.low>>>16,a=65535&this.low,s=e.high>>>16,c=65535&e.high,h=e.low>>>16,d=65535&e.low,f=0,g=0,m=0,S=0;return m+=(S+=a*d)>>>16,g+=(m+=o*d)>>>16,m&=65535,g+=(m+=a*h)>>>16,f+=(g+=i*d)>>>16,g&=65535,f+=(g+=o*h)>>>16,g&=65535,f+=(g+=a*c)>>>16,f+=r*d+i*h+o*c+a*s,l((m&=65535)<<16|(S&=65535),(f&=65535)<<16|(g&=65535),this.unsigned)},D.mul=D.multiply,D.divide=function(e){if(n(e)||(e=p(e)),e.isZero())throw Error("division by zero");var r,i,o;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?l((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?C:y;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return C;if(e.gt(this.shru(1)))return E;o=C}else{if(this.eq(I))return e.eq(S)||e.eq(_)?I:e.eq(I)?S:(r=this.shr(1).div(e).shl(1)).eq(y)?e.isNegative()?S:_:(i=this.sub(e.mul(r)),o=r.add(i.div(e)));if(e.eq(I))return this.unsigned?C:y;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=y}for(i=this;i.gte(e);){r=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),s=a<=48?1:h(2,a-48),c=u(r),d=c.mul(e);d.isNegative()||d.gt(i);)d=(c=u(r-=s,this.unsigned)).mul(e);c.isZero()&&(c=S),o=o.add(c),i=i.sub(d)}return o},D.div=D.divide,D.modulo=function(e){return n(e)||(e=p(e)),t?l((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},D.mod=D.modulo,D.rem=D.modulo,D.not=function(){return l(~this.low,~this.high,this.unsigned)},D.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},D.clz=D.countLeadingZeros,D.countTrailingZeros=function(){return this.low?o(this.low):o(this.high)+32},D.ctz=D.countTrailingZeros,D.and=function(e){return n(e)||(e=p(e)),l(this.low&e.low,this.high&e.high,this.unsigned)},D.or=function(e){return n(e)||(e=p(e)),l(this.low|e.low,this.high|e.high,this.unsigned)},D.xor=function(e){return n(e)||(e=p(e)),l(this.low^e.low,this.high^e.high,this.unsigned)},D.shiftLeft=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):l(0,this.low<<e-32,this.unsigned)},D.shl=D.shiftLeft,D.shiftRight=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):l(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},D.shr=D.shiftRight,D.shiftRightUnsigned=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):l(32===e?this.high:this.high>>>e-32,0,this.unsigned)},D.shru=D.shiftRightUnsigned,D.shr_u=D.shiftRightUnsigned,D.rotateLeft=function(e){var t;return n(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?l(this.high,this.low,this.unsigned):e<32?(t=32-e,l(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(t=32-(e-=32),l(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))},D.rotl=D.rotateLeft,D.rotateRight=function(e){var t;return n(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?l(this.high,this.low,this.unsigned):e<32?(t=32-e,l(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(t=32-(e-=32),l(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))},D.rotr=D.rotateRight,D.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},D.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},D.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},D.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},D.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},i.fromBytes=function(e,t,r){return r?i.fromBytesLE(e,t):i.fromBytesBE(e,t)},i.fromBytesLE=function(e,t){return new i(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},i.fromBytesBE=function(e,t){return new i(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};var w=i;return e.default=w,"default"in e?e.default:e}({});void 0===(i=function(){return n}.apply(t,[]))||(e.exports=i)},26:(e,t)=>{var r,i=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.decode=function(e,t,r){if(t=~~t,(r=r||e.length-t)===i.size)return i.decode(e,t,r);if(r===n.size)return n.decode(e,t,r);throw Error(`Invalid buffer size needs to be ${i.size} for v4 or ${n.size} for v6.`)},e.encode=function(e,t,r){r=~~r;const a=o(e);"function"==typeof t&&(t=t(r+a));if(a===i.size)return i.encode(e,t,r);return n.encode(e,t,r)},e.familyOf=function(e){return o(e)===i.size?1:2},e.name=void 0,e.sizeOf=o,e.v6=e.v4=void 0;const t=/^(\d{1,3}\.){3,3}\d{1,3}$/,r=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i,i={name:"v4",size:4,isFormat:e=>t.test(e),encode(e,t,r){r=~~r,t=t||new Uint8Array(r+4);const i=e.length;let n=0;for(let o=0;o<i;){const i=e.charCodeAt(o++);46===i?(t[r++]=n,n=0):n=10*n+(i-48)}return t[r]=n,t},decode:(e,t)=>(t=~~t,`${e[t++]}.${e[t++]}.${e[t++]}.${e[t]}`)};e.v4=i;const n={name:"v6",size:16,isFormat:e=>e.length>0&&r.test(e),encode(e,t,r){let i=(r=~~r)+16,n=-1,o=0,a=0,s=!0,c=!1;t=t||new Uint8Array(r+16);for(let u=0;u<e.length;u++){let l=e.charCodeAt(u);58===l?(s?-1!==n?(r<i&&(t[r]=0),r<i-1&&(t[r+1]=0),r+=2):r<i&&(n=r):(!0===c?(r<i&&(t[r]=a),r++):(r<i&&(t[r]=o>>8),r<i-1&&(t[r+1]=255&o),r+=2),o=0,a=0),s=!0,c=!1):46===l?(r<i&&(t[r]=a),r++,a=0,o=0,s=!1,c=!0):(s=!1,l>=97?l-=87:l>=65?l-=55:(l-=48,a=10*a+l),o=(o<<4)+l)}if(!1===s)!0===c?(r<i&&(t[r]=a),r++):(r<i&&(t[r]=o>>8),r<i-1&&(t[r+1]=255&o),r+=2);else if(0===n)r<i&&(t[r]=0),r<i-1&&(t[r+1]=0),r+=2;else if(-1!==n){r+=2;for(let e=Math.min(r-1,i-1);e>=n+2;e--)t[e]=t[e-2];t[n]=0,t[n+1]=0,n=r}if(n!==r&&-1!==n)for(r>i-2&&(r=i-2);i>n;)t[--i]=r<i&&r>n?t[--r]:0;else for(;r<i;)t[r++]=0;return t},decode(e,t){t=~~t;let r="";for(let i=0;i<16;i+=2)0!==i&&(r+=":"),r+=(e[t+i]<<8|e[t+i+1]).toString(16);return r.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}};e.v6=n;function o(e){if(i.isFormat(e))return i.size;if(n.isFormat(e))return n.size;throw Error(`Invalid ip address: ${e}`)}return e.name="ip","default"in e?e.default:e}({});void 0===(r=function(){return i}.apply(t,[]))||(e.exports=r)},9209:(e,t,r)=>{"use strict";var i=r(6578),n="undefined"==typeof globalThis?global:globalThis;e.exports=function(){for(var e=[],t=0;t<i.length;t++)"function"==typeof n[i[t]]&&(e[e.length]=i[t]);return e}},1158:e=>{"use strict";var t=Symbol.iterator;e.exports=function(e){if(null!=e&&void 0!==e[t])return e[t]()}},1635:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__addDisposableResource:()=>B,__assign:()=>o,__asyncDelegator:()=>I,__asyncGenerator:()=>A,__asyncValues:()=>D,__await:()=>T,__awaiter:()=>f,__classPrivateFieldGet:()=>O,__classPrivateFieldIn:()=>P,__classPrivateFieldSet:()=>N,__createBinding:()=>m,__decorate:()=>s,__disposeResources:()=>x,__esDecorate:()=>u,__exportStar:()=>v,__extends:()=>n,__generator:()=>g,__importDefault:()=>R,__importStar:()=>U,__makeTemplateObject:()=>w,__metadata:()=>p,__param:()=>c,__propKey:()=>h,__read:()=>C,__rest:()=>a,__runInitializers:()=>l,__setFunctionName:()=>d,__spread:()=>S,__spreadArray:()=>_,__spreadArrays:()=>E,__values:()=>y,default:()=>M});var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},i(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return o=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},o.apply(this,arguments)};function a(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}function s(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,i){t(r,i,e)}}function u(e,t,r,i,n,o){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,c=i.kind,u="getter"===c?"get":"setter"===c?"set":"value",l=!t&&e?i.static?e:e.prototype:null,h=t||(l?Object.getOwnPropertyDescriptor(l,i.name):{}),d=!1,p=r.length-1;p>=0;p--){var f={};for(var g in i)f[g]="access"===g?{}:i[g];for(var g in i.access)f.access[g]=i.access[g];f.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");o.push(a(e||null))};var m=(0,r[p])("accessor"===c?{get:h.get,set:h.set}:h[u],f);if("accessor"===c){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(s=a(m.get))&&(h.get=s),(s=a(m.set))&&(h.set=s),(s=a(m.init))&&n.unshift(s)}else(s=a(m))&&("field"===c?n.unshift(s):h[u]=s)}l&&Object.defineProperty(l,i.name,h),d=!0}function l(e,t,r){for(var i=arguments.length>2,n=0;n<t.length;n++)r=i?t[n].call(e,r):t[n].call(e);return i?r:void 0}function h(e){return"symbol"==typeof e?e:"".concat(e)}function d(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((i=i.apply(e,t||[])).next())}))}function g(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(r=1,i&&(n=2&s[0]?i.return:s[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,s[1])).done)return n;switch(i=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,i=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){a.label=s[1];break}if(6===s[0]&&a.label<n[1]){a.label=n[1],n=s;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(s);break}n[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],i=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}var m=Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]};function v(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||m(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function C(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return a}function S(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(C(arguments[t]));return e}function E(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var i=Array(e),n=0;for(t=0;t<r;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,n++)i[n]=o[a];return i}function _(e,t,r){if(r||2===arguments.length)for(var i,n=0,o=t.length;n<o;n++)!i&&n in t||(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function T(e){return this instanceof T?(this.v=e,this):new T(e)}function A(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=r.apply(e,t||[]),o=[];return i={},a("next"),a("throw"),a("return",(function(e){return function(t){return Promise.resolve(t).then(e,u)}})),i[Symbol.asyncIterator]=function(){return this},i;function a(e,t){n[e]&&(i[e]=function(t){return new Promise((function(r,i){o.push([e,t,r,i])>1||s(e,t)}))},t&&(i[e]=t(i[e])))}function s(e,t){try{(r=n[e](t)).value instanceof T?Promise.resolve(r.value.v).then(c,u):l(o[0][2],r)}catch(e){l(o[0][3],e)}var r}function c(e){s("next",e)}function u(e){s("throw",e)}function l(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}}function I(e){var t,r;return t={},i("next"),i("throw",(function(e){throw e})),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,n){t[i]=e[i]?function(t){return(r=!r)?{value:T(e[i](t)),done:!1}:n?n(t):t}:n}}function D(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=e[r]&&function(t){return new Promise((function(i,n){(function(e,t,r,i){Promise.resolve(i).then((function(t){e({value:t,done:r})}),t)})(i,n,(t=e[r](t)).done,t.value)}))}}}function w(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var b=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function U(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&m(t,e,r);return b(t,e),t}function R(e){return e&&e.__esModule?e:{default:e}}function O(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)}function N(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r}function P(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function B(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var i,n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(void 0===i){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose],r&&(n=i)}if("function"!=typeof i)throw new TypeError("Object not disposable.");n&&(i=function(){try{n.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:i,async:r})}else r&&e.stack.push({async:!0});return t}var L="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var i=new Error(r);return i.name="SuppressedError",i.error=e,i.suppressed=t,i};function x(e){function t(t){e.error=e.hasError?new L(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var i=e.stack.pop();try{var n=i.dispose&&i.dispose.call(i.value);if(i.async)return Promise.resolve(n).then(r,(function(e){return t(e),r()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const M={__extends:n,__assign:o,__rest:a,__decorate:s,__param:c,__metadata:p,__awaiter:f,__generator:g,__createBinding:m,__exportStar:v,__values:y,__read:C,__spread:S,__spreadArrays:E,__spreadArray:_,__await:T,__asyncGenerator:A,__asyncDelegator:I,__asyncValues:D,__makeTemplateObject:w,__importStar:U,__importDefault:R,__classPrivateFieldGet:O,__classPrivateFieldSet:N,__classPrivateFieldIn:P,__addDisposableResource:B,__disposeResources:x}},3325:e=>{"use strict";e.exports={rE:"1.2.0"}},5783:e=>{"use strict";e.exports=JSON.parse('[{"type":"a","child":[{"type":"(","child":[{"type":"y","child":[]},{"type":"v","child":[]}]}]}]')},8389:e=>{"use strict";e.exports=JSON.parse('{"name":"hap-nodejs","version":"0.12.2","description":"HAP-NodeJS is a Node.js implementation of HomeKit Accessory Server.","main":"dist/index.js","types":"dist/index.d.ts","maintainers":["Andreas Bauer <mail@anderl-bauer.de>"],"author":"Khaos Tian <khaos.tian@gmail.com> (https://tz.is/)","homepage":"https://github.com/homebridge/HAP-NodeJS","license":"Apache-2.0","scripts":{"clean":"rimraf dist && rimraf coverage","lint":"eslint \'src/**/*.{js,ts,json}\'","build":"rimraf dist && tsc && node .github/node-persist-ignore.js","prepublishOnly":"npm run build","postpublish":"npm run clean","test":"jest","test-coverage":"jest --coverage","start":"node dist/BridgedCore.js","docs":"typedoc","lint-docs":"typedoc --emit none --treatWarningsAsErrors"},"keywords":["hap-nodejs","hap","homekit","homekit-accessory-protocol","homekit-server","homekit-protocol","homekit-device","homekit-accessory","hap-server","homekit-support","siri"],"repository":{"type":"git","url":"git+https://github.com/homebridge/HAP-NodeJS.git"},"bugs":{"url":"https://github.com/homebridge/HAP-NodeJS/issues"},"engines":{"node":"^18 || ^20"},"files":["README.md","LICENSE","dist","@types"],"dependencies":{"@homebridge/ciao":"^1.2.0","@homebridge/dbus-native":"^0.6.0","bonjour-hap":"^3.7.2","debug":"^4.3.5","fast-srp-hap":"^2.0.4","futoin-hkdf":"^1.5.3","node-persist":"^0.0.12","source-map-support":"^0.5.21","tslib":"^2.6.2","tweetnacl":"^1.0.3"},"devDependencies":{"@types/debug":"^4.1.12","@types/escape-html":"^1.0.4","@types/jest":"^29.5.12","@types/node":"^20.13.0","@types/plist":"^3.0.5","@typescript-eslint/eslint-plugin":"^7.11.0","@typescript-eslint/parser":"^7.11.0","axios":"^1.7.2","commander":"^12.1.0","escape-html":"^1.0.3","eslint":"^8.57.0","http-parser-js":"^0.5.8","jest":"^29.7.0","rimraf":"^5.0.7","semver":"^7.6.2","simple-plist":"^1.4.0-0","ts-jest":"^29.1.4","ts-node":"^10.9.2","typedoc":"^0.25.13","typescript":"^5.4.5"}}')}},t={};function r(i){var n=t[i];if(void 0!==n)return n.exports;var o=t[i]={id:i,loaded:!1,exports:{}};return e[i].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}r.d=(e,t)=>{for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var i=r(5920);for(var n in i)this[n]=i[n];i.__esModule&&Object.defineProperty(this,"__esModule",{value:!0})})();
//# sourceMappingURL=homekit-bundle.js.map